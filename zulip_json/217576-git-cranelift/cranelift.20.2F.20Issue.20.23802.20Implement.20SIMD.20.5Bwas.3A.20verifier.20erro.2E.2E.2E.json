[
    {
        "content": "<p>alexcrichton transferred <a href=\"https://github.com/bytecodealliance/cranelift/issues/802\" target=\"_blank\" title=\"https://github.com/bytecodealliance/cranelift/issues/802\">Issue #802</a>:</p>\n<blockquote>\n<p>$ cat x.clif</p>\n<div class=\"codehilite\"><pre><span></span>target x86_64 haswell\n\nfunction %vector_split_args(i32x2) -&gt; i32x2 fast {\nebb0(v0: i32x2):\n    v1 = bxor v0, v0\n    return v1\n}\n</pre></div>\n\n\n<p>$ cranelift/target/debug/clif-util compile -d x.clif</p>\n<div class=\"codehilite\"><pre><span></span>function %vector_split_arg(i32 [%rdi], i32 [%rsi]) -&gt; i32 [%rax], i32 [%rdx] fast {\n                                ebb0(v2: i32, v3: i32):\n[-]                                 v0 = vconcat v2, v3\n                                    v4, v5 = isplit v0\n                                    v6, v7 = isplit v0\n                                    v10, v11 = isplit v4\n                                    v12, v13 = isplit v6\n                                    v14 = bxor v10, v12\n                                    v15 = bxor v11, v13\n                                    v8 = iconcat v14, v15\n                                    v16, v17 = isplit v5\n                                    v18, v19 = isplit v7\n                                    v20 = bxor v16, v18\n                                    v21 = bxor v17, v19\n                                    v9 = iconcat v20, v21\n[-]                                 v1 = iconcat v8, v9\n                                    v22, v23 = vsplit v1\n[Op1ret#c3]                         return v22, v23\n;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n; error: inst1: v22 is a ghost value used by a real [Op1ret#c3] instruction\n\n}\n\n; 1 verifier error detected (see above). Compilation aborted.\n</pre></div>\n\n\n<p>It looks like vsplit/vconcat are inserted as part of ABI legalization? Are they supposed to be subsequently legalized into something else?</p>\n<p>If you use \"target arm\" it also fails but there is no vsplit of v1, it just attempts to \"return v1\" and that fails with \"Return must have an encoding\".</p>\n</blockquote>",
        "id": 189361497,
        "sender_full_name": "GitHub",
        "timestamp": 1582932366
    }
]