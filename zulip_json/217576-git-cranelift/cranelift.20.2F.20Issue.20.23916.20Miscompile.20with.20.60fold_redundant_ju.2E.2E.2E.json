[
    {
        "content": "<p>alexcrichton transferred <a href=\"https://github.com/bytecodealliance/cranelift/issues/916\" target=\"_blank\" title=\"https://github.com/bytecodealliance/cranelift/issues/916\">Issue #916</a> (assigned to sstangl):</p>\n<blockquote>\n<p>With this testcase:</p>\n<div class=\"codehilite\"><pre><span></span>(module\n  (func $dummy)\n\n  (func (export &quot;as-binary-operand&quot;) (result i32)\n    (i32.mul\n      (loop (result i32) (i32.const 3))\n      (loop (result i32) (i32.const 4))\n    )\n  )\n)\n</pre></div>\n\n\n<p>This command:</p>\n<div class=\"codehilite\"><pre><span></span>clif-util wasm -p --target x86_64 test.wast\n</pre></div>\n\n\n<p>gets this error:</p>\n<div class=\"codehilite\"><pre><span></span>function u0:1(i64 vmctx [%rdi], i64 fp [%rbp]) -&gt; i32 [%rax], i64 fp [%rbp] system_v {\n    ss0 = incoming_arg 16, offset -16\n\n                                ebb0(v0: i64 [%rdi], v7: i64 [%rbp]):\n[RexOp1pushq#50]                    x86_push v7\n[RexOp1copysp#8089]                 copy_special %rsp -&gt; %rbp\n@0036 [-]                           fallthrough ebb2\n\n                                ebb2:\n@0038 [RexOp1pu_id#b8,%rax]         v3 = iconst.i32 3\n@003a [-]                           fallthrough ebb4\n\n                                ebb4:\n@003d [RexOp1pu_id#b8,%rcx]         v5 = iconst.i32 4\n@003f [-]                           fallthrough ebb5(v5)\n\n                                ebb5(v4: i32 [%rcx]):\n@0040 [RexOp2rrx#4af,%rax]          v6 = imul.i32 v2, v4\n;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n; error: inst6: v2 is defined by ebb3 which is not in the layout\n\n@0041 [-]                           fallthrough ebb1(v6)\n\n                                ebb1(v1: i32 [%rax]):\n[RexOp1popq#58,%rbp]                v8 = x86_pop.i64\n@0041 [Op1ret#c3]                   return v1, v8\n}\n</pre></div>\n\n\n<p>Bisection points to 57fa45c8520110ee7e9b216538f1990376aed0e9, and the error goes away when I comment out the call to <code>fold_redundant_jumps</code>.</p>\n</blockquote>",
        "id": 189361555,
        "sender_full_name": "GitHub",
        "timestamp": 1582932388
    }
]