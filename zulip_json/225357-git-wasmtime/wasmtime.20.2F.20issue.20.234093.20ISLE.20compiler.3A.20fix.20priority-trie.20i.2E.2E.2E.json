[
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1115775889\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @cfallin, @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"cranelift\", \"isle\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>cfallin: isle</li>\n<li>fitzgen: isle</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 280972126,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651559049
    },
    {
        "content": "<p>uweigand <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118654081\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<blockquote>\n<p>I was worried that this might impact the size of the generated Rust code or its runtime, but In fact, to my initial surprise (but it makes sense given the above \"rarely used\" factor), the generated code with this compiler fix is _exactly the same_. I rebuilt with <code>--features rebuild-isle,all-arch</code> but... there were no diffs to commit! This is to me the simplest evidence that we didn't really need that complexity.</p>\n</blockquote>\n<p>I think this may have been simply because the input files didn't change and therefore the build was skipped?</p>\n<p>In fact, if I delete the generated files and then re-generate them, they are significantly different.  And at least on s390x, with the re-generated files codegen seems broken (even <code>cargo test</code> in the cranelift/codegen directory already fails).<br>\n</p>\n</blockquote>",
        "id": 281309989,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651762436
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118735873\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p>Urgh, sorry about that... I should have realized the hashing mechanism would prevent the actual regen. I suspect it has to do with an implicit rule ordering (one rule isn't correct on its own) in s390x. We can revert this patch in isolation I think; nothing subsequent depends on it. Or if you're able to find the issue in s390x, that may actually be better.</p>\n<p>I'm actually out-of-office (and with phone only, no laptop) for the rest of the week but can deal with this on Monday if someone else isn't able to first.</p>\n</blockquote>",
        "id": 281318839,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651766138
    },
    {
        "content": "<p>uweigand <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118756831\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p>I'll see if I can find anything.  But to be clear, the generated files for <em>all</em> three targets changes significantly, so I don't think it's just a matter of a single s390x rule.  I haven't checked if the changes on other platforms affect codegen, through.</p>\n</blockquote>",
        "id": 281321553,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651767230
    },
    {
        "content": "<p>uweigand <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118761110\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p>Oh, it turns out the regenerated aarch64 file doesn't even build:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">error</span><span class=\"p\">[</span><span class=\"n\">E0317</span><span class=\"p\">]</span>: <span class=\"err\">`</span><span class=\"k\">if</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"k\">else</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">clause</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">-</span>-&gt; <span class=\"nc\">cranelift</span><span class=\"o\">/</span><span class=\"n\">codegen</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">isa</span><span class=\"o\">/</span><span class=\"n\">aarch64</span><span class=\"o\">/</span><span class=\"n\">lower</span><span class=\"o\">/</span><span class=\"n\">isle</span><span class=\"o\">/</span><span class=\"n\">generated_code</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">3381</span>:<span class=\"mi\">33</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"o\">|</span><span class=\"w\"></span>\n<span class=\"mi\">3381</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">                   </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">pattern13_0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">closure13</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"mi\">3382</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">                       </span><span class=\"c1\">// Rule at src/isa/aarch64/inst.isle line 1993.</span>\n<span class=\"mi\">3383</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">                       </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">expr0_0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">C</span>::<span class=\"n\">put_in_reg</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">pattern2_0</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"mi\">3384</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">                       </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">expr1_0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">C</span>::<span class=\"n\">put_in_reg</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">pattern8_0</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">    </span><span class=\"o\">|</span><span class=\"w\"></span>\n<span class=\"mi\">3393</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">                       </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">expr2_0</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"mi\">3394</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\">                   </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">_______________________</span><span class=\"o\">^</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"k\">enum</span> <span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"err\">`</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"o\">|</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">note</span>: <span class=\"nc\">expected</span><span class=\"w\"> </span><span class=\"n\">unit</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"err\">`</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"></span>\n<span class=\"w\">                     </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"k\">enum</span> <span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">reg</span>::<span class=\"n\">Reg</span><span class=\"o\">&gt;</span><span class=\"err\">`</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">note</span>: <span class=\"err\">`</span><span class=\"k\">if</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">expressions</span><span class=\"w\"> </span><span class=\"n\">without</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"k\">else</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">evaluate</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">help</span>: <span class=\"nc\">consider</span><span class=\"w\"> </span><span class=\"n\">adding</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"k\">else</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">block</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">evaluates</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"k\">type</span>\n</code></pre></div>\n</blockquote>",
        "id": 281322008,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651767451
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118770783\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p>Yep, we should revert for now; I'll reland a fixed version when I'm back. Sorry again!</p>\n<p>As an aside this means that our \"regen ISLE\" CI job isn't actually doing what we think it's doing -- we should fix that too. (Probably by rm'ing the manifest files first.)</p>\n</blockquote>",
        "id": 281323162,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651767978
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118774784\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p>@fitzgen could you put up a PR to revert? I'll r+ from here if I see it in time...</p>\n</blockquote>",
        "id": 281323723,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651768207
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118804286\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p>Sure thing.</p>\n</blockquote>",
        "id": 281325492,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651768969
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093#issuecomment-1118834322\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4093\">issue #4093</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/pull/4102\">https://github.com/bytecodealliance/wasmtime/pull/4102</a></p>\n</blockquote>",
        "id": 281327629,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1651769827
    }
]