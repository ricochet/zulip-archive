[
    {
        "content": "<p>sunfishcode opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>:</p>\n<blockquote>\n<p><code>rsix</code> is a system call wrapper crate that we use in <code>wasi-common</code>,<br>\nwhich can provide the following advantages in the rest of Wasmtime:</p>\n<ul>\n<li>\n<p>It eliminates some <code>unsafe</code> blocks in Wasmtime's code. There's<br>\n   still an <code>unsafe</code> block in the library, but this way, the <code>unsafe</code><br>\n   is factored out and clearly scoped.</p>\n</li>\n<li>\n<p>And, it makes error handling more consistent, factoring out code for<br>\n   checking return values and <code>io::Error::last_os_error()</code>, and code that<br>\n   does <code>errno::set_errno(0)</code>.</p>\n</li>\n</ul>\n<p>This doesn't cover <em>all</em> system calls; <code>rsix</code> doesn't implement<br>\nsignal-handling APIs, and this doesn't cover calls made through <code>std</code> or<br>\ncrates like <code>userfaultfd</code>, <code>rand</code>, and <code>region</code>.</p>\n<p>&lt;!--</p>\n<p>Please ensure that the following steps are all taken care of before submitting<br>\nthe PR.</p>\n<ul>\n<li>\n<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>\n  here.</p>\n</li>\n<li>\n<p>[ ] A short description of what this does, why it is needed; if the<br>\n  description becomes long, the matter should probably be discussed in an issue<br>\n  first.</p>\n</li>\n<li>\n<p>[ ] This PR contains test cases, if meaningful.</p>\n</li>\n<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>\n  If you don't know who could review this, please indicate so. The list of<br>\n  suggested reviewers on the right can help you.</li>\n</ul>\n<p>Please ensure all communication adheres to the <a href=\"https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md\">code of\nconduct</a>.<br>\n--&gt;<br>\n</p>\n</blockquote>",
        "id": 253502226,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631747449
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253505149,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631749135
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253506277,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631749913
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253506584,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631750075
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253508285,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631751116
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253508686,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631751401
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253510344,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631752708
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253511298,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631753366
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253512740,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631754472
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253514358,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631755716
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253516937,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631757616
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253538482,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631776105
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756410276\">PR review</a>.</p>",
        "id": 253594990,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631804067
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756410276\">PR review</a>.</p>",
        "id": 253594991,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631804068
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710197302\">PR review comment</a>:</p>\n<blockquote>\n<p>How come this was needed with this change? I would have figured that rsix was already part of wasi-common's dep tree to have this required already...</p>\n</blockquote>",
        "id": 253594993,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631804068
    },
    {
        "content": "<p>sunfishcode submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756422289\">PR review</a>.</p>",
        "id": 253596155,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631804498
    },
    {
        "content": "<p>sunfishcode created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710205802\">PR review comment</a>:</p>\n<blockquote>\n<p>It's actually an unrelated change; a contributor recently added 32-bit ARM support in rsix, so it now needs cross tools to be cross-compiled.</p>\n</blockquote>",
        "id": 253596157,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631804498
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756433539\">PR review</a>.</p>",
        "id": 253597586,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631805031
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710213839\">PR review comment</a>:</p>\n<blockquote>\n<p>How come this is required at <code>cargo check</code>-time though? Did rsix previously not have C code to build and now it does?</p>\n</blockquote>",
        "id": 253597590,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631805032
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756437594\">PR review</a>.</p>",
        "id": 253598071,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631805231
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710216689\">PR review comment</a>:</p>\n<blockquote>\n<p>Rsix has two backends. The libc backend and the raw linux syscall backend. The latter requires compiling external assembly and is only used on supported linux targets. Previously 32-bit ARM was not one of such targets and thus would use the libc backend AFAIU.</p>\n</blockquote>",
        "id": 253598073,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631805231
    },
    {
        "content": "<p>sunfishcode updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>",
        "id": 253810632,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631914345
    },
    {
        "content": "<p>sunfishcode merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355\">PR #3355</a>.</p>",
        "id": 253816242,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1631917737
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-760047720\">PR review</a>.</p>",
        "id": 254245784,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1632245164
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r713262642\">PR review comment</a>:</p>\n<blockquote>\n<p>This adds a lot of new dependencies to cg_clif:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">errno</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">2.7</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">errno</span><span class=\"o\">-</span><span class=\"n\">dragonfly</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">1.1</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">gcc</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">3.55</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">io</span><span class=\"o\">-</span><span class=\"n\">lifetimes</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">3.1</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">itoa</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">4.8</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">raw</span><span class=\"o\">-</span><span class=\"n\">sys</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">0.28</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">rsix</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">23.5</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">rustc_version</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">4.0</span><span class=\"w\"></span>\n<span class=\"w\">      </span><span class=\"n\">Adding</span><span class=\"w\"> </span><span class=\"n\">semver</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">.</span><span class=\"mf\">0.4</span><span class=\"w\"></span>\n</code></pre></div>\n<p>This all to prevent a single libc call is not worth it IMO. Before this change cg_clif didn't depend on a C compiler on any target, now it does on some targets. It also bloats the dylib size as unused functions are still exported from the dylib and thus can't be gc'ed and increases compilation time.</p>\n</blockquote>",
        "id": 254245786,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1632245166
    },
    {
        "content": "<p>sunfishcode created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r716200729\">PR review comment</a>:</p>\n<blockquote>\n<p>Makes sense. rsix is only used for one thing in Cranelift here, so I'll submit a PR to revert that to just using libc.</p>\n</blockquote>",
        "id": 254929379,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1632661082
    },
    {
        "content": "<p>sunfishcode submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-763694424\">PR review</a>.</p>",
        "id": 254929385,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1632661082
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-763694781\">PR review</a>.</p>",
        "id": 254929662,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1632661312
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r716201272\">PR review comment</a>:</p>\n<blockquote>\n<p>Thanks!</p>\n</blockquote>",
        "id": 254929663,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1632661312
    },
    {
        "content": "<p>sunfishcode submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-787322297\">PR review</a>.</p>",
        "id": 258787167,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1634944133
    },
    {
        "content": "<p>sunfishcode created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r734883951\">PR review comment</a>:</p>\n<blockquote>\n<p>This part of the patch is now reverted, so it's not relevant at this time, but in case anyone is reading this is curious, the situation is better now:</p>\n<p>New versions of rsix no longer build-depend on gcc or any C compiler, and no longer depend on itoa by default.</p>\n<p>Also, it's worth noting that rustc_version and semver are build-time dependencies that aren't linked into the output, and linux-raw-sys doesn't contain any code.</p>\n</blockquote>",
        "id": 258787168,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1634944133
    }
]