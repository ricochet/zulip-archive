[
    {
        "content": "<p>lsm5 opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>This is a not a request for improvement in wasmtime itself, but rather in downstream ease-of-use which will need some upstream changes. I will submit a PR for this if upstream is cool with accepting it :crossed_fingers: </p>\n<h4>Feature</h4>\n<p>Enable automatic rpm package builds on every upstream PR merge.</p>\n<h4>Benefit</h4>\n<ol>\n<li>Users can conveniently use the latest features available upstream</li>\n<li>No need to wait for upstream to cut a new release</li>\n<li>Near-immediate availability to distro users</li>\n<li>Delivered way quicker compared to official distro packages</li>\n</ol>\n<h4>Implementation</h4>\n<p>This will involve:</p>\n<ol>\n<li>adding a <code>.copr/Makefile</code> and a <code>.copr/wasmtime.spec</code> such that:<br>\n<code>make -f .copr/Makefile srpm</code> generates an srpm file which the copr infrastructure can use to build rpms on their build infra.</li>\n</ol>\n<p>An example can be found for <a href=\"https://github.com/containers/crun/tree/main/rpm\">crun</a> along with a <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/build/4692536/\">successful rpm build</a>.</p>\n<p>We also build our <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/packages/\">other packages</a> including Podman, Buildah and Skopeo.</p>\n<ol start=\"2\">\n<li>adding a webhook to the wasmtime repo to trigger builds on the copr after every PR merge.</li>\n</ol>\n<h4>Alternatives</h4>\n<ol>\n<li>Get users to build from source</li>\n<li>Wait for distro package to ship required features</li>\n<li>I could do copr integration from a fork which would have to be perpetually rebased (i really hope not <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span> <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> )</li>\n</ol>\n<p>/cc @giuseppe @font </p>\n</blockquote>",
        "id": 291577768,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659361745
    },
    {
        "content": "<p>lsm5 edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>This is a not a request for improvement in wasmtime itself, but rather in downstream ease-of-use which will need some upstream changes. I will submit a PR for this if upstream is cool with accepting it :crossed_fingers: </p>\n<h4>Feature</h4>\n<p>Enable automatic rpm package builds on every upstream PR merge.</p>\n<h4>Benefit</h4>\n<ol>\n<li>Users can conveniently use the latest features available upstream</li>\n<li>No need to wait for upstream to cut a new release</li>\n<li>Near-immediate availability to distro users</li>\n<li>Delivered way quicker compared to official distro packages</li>\n</ol>\n<h4>Implementation</h4>\n<p>This will involve:</p>\n<ol>\n<li>adding a <code>.copr/Makefile</code> and a <code>.copr/wasmtime.spec</code> such that:<br>\n<code>make -f .copr/Makefile srpm</code> generates an srpm file which the copr infrastructure can use to build rpms on their build infra.</li>\n</ol>\n<p>An example can be found for <a href=\"https://github.com/containers/crun/tree/main/rpm\">crun</a> along with a <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/build/4692536/\">successful rpm build</a>.</p>\n<p>We also build our <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/packages/\">other packages</a> including Podman, Buildah and Skopeo similarly.</p>\n<ol start=\"2\">\n<li>adding a webhook to the wasmtime repo to trigger builds on the copr after every PR merge.</li>\n</ol>\n<h4>Alternatives</h4>\n<ol>\n<li>Get users to build from source</li>\n<li>Wait for distro package to ship required features</li>\n<li>I could do copr integration from a fork which would have to be perpetually rebased (i really hope not <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span> <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> )</li>\n</ol>\n<p>/cc @giuseppe @font </p>\n</blockquote>",
        "id": 291577977,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659361822
    },
    {
        "content": "<p>lsm5 edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>This is a not a request for improvement in wasmtime itself, but rather in downstream ease-of-use which will need some upstream changes. I will submit a PR for this if upstream is cool with accepting it :crossed_fingers: </p>\n<h4>Feature</h4>\n<p>Enable automatic rpm package builds on every upstream PR merge.</p>\n<h4>Benefit</h4>\n<ol>\n<li>Users can conveniently use the latest features available upstream</li>\n<li>No need to wait for upstream to cut a new release</li>\n<li>Near-immediate availability to distro users</li>\n<li>Delivered way quicker compared to official distro packages</li>\n</ol>\n<h4>Implementation</h4>\n<p>This will involve:</p>\n<ol>\n<li>adding a <code>.copr/Makefile</code> and a <code>.copr/wasmtime.spec</code> such that:<br>\n<code>make -f .copr/Makefile srpm</code> generates an srpm file which the copr infrastructure can use to build rpms on their build infra.</li>\n</ol>\n<p>An example can be found for <a href=\"https://github.com/containers/crun/tree/main/rpm\">crun</a> along with a <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/build/4692536/\">successful rpm build</a>.</p>\n<p>We also build our <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/packages/\">other packages</a> including Podman, Buildah and Skopeo similarly.</p>\n<ol start=\"2\">\n<li>adding a webhook to the wasmtime repo to trigger builds on the copr after every PR merge.</li>\n</ol>\n<h4>Alternatives</h4>\n<ol>\n<li>Get users to build from source</li>\n<li>Wait for distro package to ship required features</li>\n<li>I could do copr integration from a fork which would have to be perpetually rebased (I really hope not <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span> <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> )</li>\n</ol>\n<p>/cc @giuseppe @font </p>\n</blockquote>",
        "id": 291578491,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659362069
    },
    {
        "content": "<p>lsm5 edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>This is a not a request for improvement in wasmtime itself, but rather in downstream ease-of-use which will need some upstream changes. I will submit a PR for this if upstream is cool with accepting it :crossed_fingers: </p>\n<h4>Feature</h4>\n<p>Enable automatic rpm package builds on every upstream PR merge.</p>\n<h4>Benefit</h4>\n<ol>\n<li>Users can conveniently use the latest features available upstream</li>\n<li>No need to wait for upstream to cut a new release</li>\n<li>Near-immediate availability to distro users</li>\n<li>Delivered way quicker compared to official distro packages</li>\n</ol>\n<h4>Implementation</h4>\n<p>This will involve:</p>\n<ol>\n<li>adding a <code>.copr/Makefile</code> and a <code>.copr/wasmtime.spec</code> such that:<br>\n<code>make -f .copr/Makefile srpm</code> generates an srpm file which the copr infrastructure can use to build rpms on their build infra.</li>\n</ol>\n<p>An example can be found for <a href=\"https://github.com/containers/crun/tree/main/rpm\">crun</a> along with a <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/build/4692536/\">successful rpm build</a>.</p>\n<p>We also build our <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/packages/\">other packages</a> including Podman, Buildah and Skopeo similarly.</p>\n<ol start=\"2\">\n<li>adding a webhook to the wasmtime repo to trigger builds on the copr after every PR merge.</li>\n</ol>\n<h4>Alternatives</h4>\n<ol>\n<li>Get users to build from source</li>\n<li>Wait for distro package to ship required features</li>\n<li>I could do copr integration from a fork which would have to be perpetually rebased (I really hope not <span aria-label=\"sweat\" class=\"emoji emoji-1f613\" role=\"img\" title=\"sweat\">:sweat:</span> <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> )</li>\n</ol>\n<p>/cc @giuseppe @font @flouthoc</p>\n</blockquote>",
        "id": 291578813,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659362223
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201285612\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>Personally I think this would be reasonable to add, although I have no experience myself building rpms in CI. I'd be happy to help review a PR to do so though! I suspect this wouldn't add too much time to CI and it should be fine to throw in the set of other release artifacts generated.</p>\n</blockquote>",
        "id": 291583394,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659364319
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201316212\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<blockquote>\n<p>Personally I think this would be reasonable to add, although I have no experience myself building rpms in CI. I'd be happy to help review a PR to do so though! I suspect this wouldn't add too much time to CI and it should be fine to throw in the set of other release artifacts generated.</p>\n</blockquote>\n<p>@alexcrichton thanks a lot! RE: PR reviews, as long as we have successful copr builds with usable packages, we should be good to go. I guess @flouthoc and @font can help with testing those as well.</p>\n<p>RE: CI time, this by itself will not add any CI time because all the Copr magic will occur post-merge, unless we add a test to generate the SRPM package (would be nice to have, but no biggie)</p>\n<p>RE: artifacts, those would be generated on the Copr repo, for example: <a href=\"https://download.copr.fedorainfracloud.org/results/rhcontainerbot/podman-next/fedora-rawhide-x86_64/04692536-crun/\">https://download.copr.fedorainfracloud.org/results/rhcontainerbot/podman-next/fedora-rawhide-x86_64/04692536-crun/</a> lists the packages and logs for crun.</p>\n</blockquote>",
        "id": 291586887,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659365901
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201393537\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>Hm sorry I may not understand then. I don't know what Copr is which also may not help. Currently we produce binary artifacts in CI for all runs (it's the <code>dev</code> tag in this repository) and I naively assumed that <code>*.rpm</code> packages would be built on CI in the same manner as the release binaries. </p>\n<p>From what you mention though it may be the case that Copr is an external system which our CI/release process interacts with, but I'm not surew hat that would look like.</p>\n</blockquote>",
        "id": 291595608,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659369623
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201466871\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>Copr is a build service that the Fedora project runs for individually-maintained add-on package repos (sort of like PPAs for Ubuntu). My understanding of @lsm5 's proposal above is that we would:</p>\n<ol>\n<li>Accept some metadata (<code>.copr</code> subdirectory) into our repo;</li>\n<li>Set a webhook notification so that updates to <code>main</code> in our repo trigger the Copr system.</li>\n</ol>\n<p>@lsm5 item 1 above sounds totally reasonable to me. Re: item 2, it's technically possible, though I'm not sure how we feel about a precedent of lots of \"push notifications\" to downstream consumers (others have thoughts here?). Is there a way to set up your Copr repository so it polls our <code>main</code> branch at some interval?</p>\n</blockquote>",
        "id": 291603405,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659373071
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201513780\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<blockquote>\n<p>Copr is a build service that the Fedora project runs for individually-maintained add-on package repos (sort of like PPAs for Ubuntu).</p>\n</blockquote>\n<p>Yes, exactly. People can host rpm packages without waiting for official Fedora reviews and it also allows for a lot of build customization not available on official Fedora environments. It's a lot quicker to ship things via Copr than via official Fedora channels. </p>\n<p>Once the copr for wasmtime is in place, an interested end user would have to:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">sudo</span><span class=\"w\"> </span><span class=\"n\">dnf</span><span class=\"w\"> </span><span class=\"n\">copr</span><span class=\"w\"> </span><span class=\"n\">enable</span><span class=\"w\"> </span><span class=\"cp\">$COPR_ACCOUNT_NAME</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"w\"></span>\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">sudo</span><span class=\"w\"> </span><span class=\"n\">dnf</span><span class=\"w\"> </span><span class=\"n\">install</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"></span>\n</code></pre></div>\n<blockquote>\n<p>@lsm5 item 1 above sounds totally reasonable to me. Re: item 2, it's technically possible, though I'm not sure how we feel about a precedent of lots of \"push notifications\" to downstream consumers (others have thoughts here?). Is there a way to set up your Copr repository so it polls our <code>main</code> branch at some interval?</p>\n</blockquote>\n<p>The webhook notifications will not bother any human users. It will only trigger new builds on the Copr system. And another thing I'd like to clarify, the rpm that will be available on the Copr will <em>not</em> be the official Fedora / CentOS package. Users will have to explicitly enable it on their environments. And any users that enable it will not be bombarded with any notifications. Just that the likelihood of them finding newer wasmtime packages is high with this Copr repo enabled compared to just the default distro package repos.</p>\n<p>For the crun package, if you see the <code>Default Build Source</code> section in <a href=\"https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/package/crun/\">https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/package/crun/</a> it has <code>Committish: main</code>, so it only triggers builds after each PR merge on the main branch.</p>\n<p>So, long story short, nobody (upstream / downstream regardless) notices any difference unless they actually bother with enabling the Copr repo.</p>\n</blockquote>",
        "id": 291609197,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659375700
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201521545\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>btw, here's a relevant blog post which can give you a better idea with screenshots: <a href=\"https://hobo.house/2017/09/03/automate-rpm-builds-from-git-sources-using-copr/\">https://hobo.house/2017/09/03/automate-rpm-builds-from-git-sources-using-copr/</a></p>\n</blockquote>",
        "id": 291610223,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659376189
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1201524291\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<blockquote>\n<ol>\n<li>Accept some metadata (<code>.copr</code> subdirectory) into our repo</li>\n</ol>\n</blockquote>\n<p>@cfallin yes, I'll PR for that soon-ish.</p>\n</blockquote>",
        "id": 291610596,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1659376376
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1212130549\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>@alexcrichton @cfallin Couple of things:</p>\n<ol>\n<li>The webhook that would need to be added to wasmtime's settings will look like: </li>\n</ol>\n<p>![image](<a href=\"https://user-images.githubusercontent.com/247367/184163092-f03a254b-2627-43bb-bd21-4c0fa47f15f0.png\">https://user-images.githubusercontent.com/247367/184163092-f03a254b-2627-43bb-bd21-4c0fa47f15f0.png</a>)</p>\n<p>Of course, the exact URL would change based on the copr project which brings me to 2...</p>\n<ol start=\"2\">\n<li>I'm hoping to make a docs PR to update installation instructions once #4688 is merged. So, I'd like to check with you what copr repo <code>account_name/project_name</code> you would prefer. The current repo I used for doing test builds is my personal <code>lsm5/wasmtime</code> repo and most of the packages I maintain related to podman go to <code>rhcontainerbot/podman-next</code>. Would you prefer something like a <code>bytecodealliance/wasmtime</code> or are you ok with <code>rhcontainerbot/podman-next</code> itself?<br>\n</li>\n</ol>\n</blockquote>",
        "id": 292949760,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1660230915
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1221029392\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>@alexcrichton @cfallin @jameysharp gentle ping for thoughts on the previous comment + review on #4688 . Thanks!</p>\n</blockquote>",
        "id": 294349609,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1660937449
    },
    {
        "content": "<p>jameysharp <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1222672639\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<p>I suspect the silence here means that nobody on the core Wasmtime team wants to take responsibility for RPM builds. We try to make sure that if we merge something, we have a plan for how to maintain it. So while I think we're all interested in helping you make Wasmtime available to more people, I share some concerns that others have brought up. Let's see if we can talk through those.</p>\n<p>The first question to address is who manages the Fedora account that publishes these packages. Since I don't think any of us feel prepared to do that, it shouldn't use the Bytecode Alliance name. I guess <code>rhcontainerbot/podman-next</code> is fine. But because we aren't familiar with Copr and won't have access to the Fedora account, we can't address any packaging-related bug reports, so I think it's important that you direct users of these packages somewhere other than this repo's issue tracker.</p>\n<p>Then there's the question of the webhook configuration. I think it's a little weird if we have to manage a webhook that's sending notifications to an account that we don't control. Is it possible for you to manage the webhook without our involvement? I see GitHub supports <a href=\"https://docs.github.com/en/rest/webhooks#pubsubhubbub\">PubSubHubbub</a> which I think means you could create a webhook for any repo without needing admin access to that repo, but I haven't tried it.</p>\n<p>The easy question is what to do with #4688. Since that just adds files in an out-of-the-way directory, I don't think anybody has any objections to merging it. As long as it's not likely to change often, it's fine. And when it does need to change, it's not a big deal for us to just approve and merge PRs.</p>\n<p>In summary, if we can minimize how much the Wasmtime team has to be responsible for going forward, then we're happy to help you provide bleeding-edge packages for RPM-based distros. Thank you for your interest!</p>\n</blockquote>",
        "id": 294734443,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1661189285
    },
    {
        "content": "<p>lsm5 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570#issuecomment-1222805698\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4570\">issue #4570</a>:</p>\n<blockquote>\n<blockquote>\n<p>I suspect the silence here means that nobody on the core Wasmtime team wants to take responsibility for RPM builds. We try to make sure that if we merge something, we have a plan for how to maintain it. So while I think we're all interested in helping you make Wasmtime available to more people, I share some concerns that others have brought up. Let's see if we can talk through those.</p>\n<p>The first question to address is who manages the Fedora account that publishes these packages. Since I don't think any of us feel prepared to do that, it shouldn't use the Bytecode Alliance name. I guess <code>rhcontainerbot/podman-next</code> is fine. But because we aren't familiar with Copr and won't have access to the Fedora account, we can't address any packaging-related bug reports, so I think it's important that you direct users of these packages somewhere other than this repo's issue tracker.</p>\n<p>Then there's the question of the webhook configuration. I think it's a little weird if we have to manage a webhook that's sending notifications to an account that we don't control. Is it possible for you to manage the webhook without our involvement? I see GitHub supports <a href=\"https://docs.github.com/en/rest/webhooks#pubsubhubbub\">PubSubHubbub</a> which I think means you could create a webhook for any repo without needing admin access to that repo, but I haven't tried it.</p>\n<p>The easy question is what to do with #4688. Since that just adds files in an out-of-the-way directory, I don't think anybody has any objections to merging it. As long as it's not likely to change often, it's fine. And when it does need to change, it's not a big deal for us to just approve and merge PRs.</p>\n<p>In summary, if we can minimize how much the Wasmtime team has to be responsible for going forward, then we're happy to help you provide bleeding-edge packages for RPM-based distros. Thank you for your interest!</p>\n</blockquote>\n<p>Ack, thanks @jameysharp . Let me get back to you on this after checking with my colleagues. Might be a week or more.</p>\n</blockquote>",
        "id": 294751862,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1661195774
    }
]