[
    {
        "content": "<p>cfallin opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a> from <code>isle-docs</code> to <code>main</code>:</p>\n<blockquote>\n<p><a href=\"https://github.com/cfallin/wasmtime/blob/isle-docs/cranelift/docs/isle.md\">Markdown rendered</a></p>\n<p>This documentation provides details for all of the ISLE language<br>\nfeatures, and detailed rationale for why many of them are designed in<br>\nthe way that they are. It is hopefully both a reasonable tutorial and<br>\nreference for someone looking to understand the DSL.</p>\n<p>Note that this documentation is separate from and orthogonal to the<br>\nwork to document the Cranelift bindings and integration work that<br>\n@fitzgen has covered well in #3556. This document can link to that one<br>\nand vice-versa once they are both in-tree.</p>\n<p>In addition to @fitzgen I'm picking a few folks for reviewers who would<br>\nlikely be consumers of this doc; please do let me know if there are holes<br>\nor not-clear parts anywhere!</p>\n<p>&lt;!--</p>\n<p>Please ensure that the following steps are all taken care of before submitting<br>\nthe PR.</p>\n<ul>\n<li>\n<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>\n  here.</p>\n</li>\n<li>\n<p>[ ] A short description of what this does, why it is needed; if the<br>\n  description becomes long, the matter should probably be discussed in an issue<br>\n  first.</p>\n</li>\n<li>\n<p>[ ] This PR contains test cases, if meaningful.</p>\n</li>\n<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>\n  If you don't know who could review this, please indicate so. The list of<br>\n  suggested reviewers on the right can help you.</li>\n</ul>\n<p>Please ensure all communication adheres to the <a href=\"https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md\">code of\nconduct</a>.<br>\n--&gt;<br>\n</p>\n</blockquote>",
        "id": 262534380,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1637714875
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/abrown\">abrown</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a>.</p>",
        "id": 262534381,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1637714875
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a>.</p>",
        "id": 262534382,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1637714875
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/fitzgen\">fitzgen</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a>.</p>",
        "id": 262534384,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1637714875
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a> from <code>isle-docs</code> to <code>main</code>.</p>",
        "id": 262543033,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1637724758
    },
    {
        "content": "<p>avanhatt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-817255602\">PR review</a>.</p>",
        "id": 262950510,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-817255602\">PR review</a>.</p>",
        "id": 262950511,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757948249\">PR review comment</a>:</p>\n<blockquote>\n<p>nit: the point about \"until no more rules are applicable\" isn't necessarily a characteristic of term rewriting systems in general (many systems have rules that can apply an infinite number of times, like <code>a -&gt; -(-a)</code>. I'd suggest leaving that part out or replacing with something like \"until the term meets some application-specific end condition\".  </p>\n</blockquote>",
        "id": 262950512,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757948682\">PR review comment</a>:</p>\n<blockquote>\n<p>Could add here that programs don't need to consider the complex tree when changing a single rule, since it is auto-generated by the ISLE compiler.</p>\n</blockquote>",
        "id": 262950513,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757948625\">PR review comment</a>:</p>\n<blockquote>\n<p>I might add here that term rewriting allows a nice separation between specifying when rules are possible and when they are profitable/desired (since not all term rewriting systems choose to apply more specific rules first). </p>\n</blockquote>",
        "id": 262950514,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757947663\">PR review comment</a>:</p>\n<blockquote>\n<p>nit: closing paren</p>\n</blockquote>",
        "id": 262950515,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757951075\">PR review comment</a>:</p>\n<blockquote>\n<p>Can all ISLE terms/expressions operate on either CLIF or the machine dependent IR? That is, can we think of rules are operating on the language that is the union of the input and output languages? Or does something prevent compiler writers from adding a term that rewrites a machine dependent IR term back into a higher level term?</p>\n</blockquote>",
        "id": 262950516,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757951528\">PR review comment</a>:</p>\n<blockquote>\n<p>Give example? </p>\n</blockquote>",
        "id": 262950517,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757951624\">PR review comment</a>:</p>\n<blockquote>\n<p>And boolean constants, as below?</p>\n</blockquote>",
        "id": 262950518,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757950819\">PR review comment</a>:</p>\n<blockquote>\n<p>This is cool!</p>\n<p>Does this mean <code>(A 1 _) -&gt; ...</code> and <code>(A 2 _) -&gt; ...</code> would share the function created for <code>(A ...)</code>? </p>\n</blockquote>",
        "id": 262950519,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757949139\">PR review comment</a>:</p>\n<blockquote>\n<p>Are wildcards the same as symbolic variables here? Sorry if this if a CLIF distinction I'm just unaware of!</p>\n</blockquote>",
        "id": 262950520,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757949004\">PR review comment</a>:</p>\n<blockquote>\n<p>Again, this is system/application specific. </p>\n</blockquote>",
        "id": 262950521,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757952729\">PR review comment</a>:</p>\n<blockquote>\n<p>Maybe just me, but I don't follow the sentence starting with \"Here...\". Does here mean in the previous generic instruction selection example, or in ISEL?</p>\n</blockquote>",
        "id": 262950522,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757952334\">PR review comment</a>:</p>\n<blockquote>\n<p>Can wildcards be used as constructions if they are nested? I.e. <code>(A (_ 1 x))</code>?</p>\n</blockquote>",
        "id": 262950523,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757950077\">PR review comment</a>:</p>\n<blockquote>\n<p>Could be fun here to add a footnote that some systems (e.g., equality graphs in theorem proving) support applying multiple rules \"at once\" and only choosing the best one after exploring many possible results. Sadly, I'm not sure that there are any more general-audience-friendly write-ups of this: <a href=\"https://cseweb.ucsd.edu/~lerner/papers/popl09.html\">https://cseweb.ucsd.edu/~lerner/papers/popl09.html</a></p>\n</blockquote>",
        "id": 262950524,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757948833\">PR review comment</a>:</p>\n<blockquote>\n<p>Could call out here that <code>symbolic</code> is more special than the other primitives, since it's not a construct in the language itself (I assume?)</p>\n</blockquote>",
        "id": 262950525,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757953155\">PR review comment</a>:</p>\n<blockquote>\n<p>nit: the <code>(extern ...)</code> syntax was not introduced above but is here in the \"summary\", I would leave the syntax for the next section</p>\n</blockquote>",
        "id": 262950527,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757952637\">PR review comment</a>:</p>\n<blockquote>\n<p>nit: around</p>\n</blockquote>",
        "id": 262950528,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757955496\">PR review comment</a>:</p>\n<blockquote>\n<p>Maybe name this as the \"context trait\" here to make the rest of this section more clear?</p>\n</blockquote>",
        "id": 262950529,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757954804\">PR review comment</a>:</p>\n<blockquote>\n<p>This is a bit confusing since before in the general parts \"constructor\" was also used for LHS. I'm also not seeing yet how this works with the heuristic of precedence for more-specific rules (though maybe that's coming)</p>\n</blockquote>",
        "id": 262950530,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757952569\">PR review comment</a>:</p>\n<blockquote>\n<p>nit: spell out instruction selection</p>\n</blockquote>",
        "id": 262950531,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757951811\">PR review comment</a>:</p>\n<blockquote>\n<p>Does the system error if two rules with identical priorities both apply? Or fall back to the previous heuristic? What if both rules complete the match?</p>\n</blockquote>",
        "id": 262950532,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757954514\">PR review comment</a>:</p>\n<blockquote>\n<p>Why usually and not always?</p>\n</blockquote>",
        "id": 262950533,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757955957\">PR review comment</a>:</p>\n<blockquote>\n<p>In this case, backtracking is impossible, correct? So nodes can only be used in backtracking if they are not enum destructors?</p>\n</blockquote>",
        "id": 262950534,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757956794\">PR review comment</a>:</p>\n<blockquote>\n<p>Questions/comments at this point:</p>\n<ul>\n<li>Might be nice to show how this decision trie algorithm handles the more-and-less specific rule examples from the beginning. In practice, what does the prioritization mean for how lowering instructions are selected?</li>\n<li>Maybe add a brief reference that instruction selection is in general NP-complete, so accepting backtracking/some level of possible inefficiency is unavoidable. </li>\n<li>What should engineers consider when adding new ISEL rules? Is all of Cranelift's lowering handled by ISEL (I assume no?) and what does the interaction between ISEL and the more traditional instruction selection backend look like? On this point, might be worth clarifying which invariants are enforced by the compiler vs the engineer (as I think I commented in another place, having ISEL or the Rust compiler itself rule out side effects in the LHS seems valuable, as does enforcement of which sublanguage can be on the LHS/RHS). </li>\n</ul>\n</blockquote>",
        "id": 262950535,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757954425\">PR review comment</a>:</p>\n<blockquote>\n<p>This post is about a specific tool but a little more general-audience-friendly: <a href=\"https://blog.sigplan.org/2021/04/06/equality-saturation-with-egg/\">https://blog.sigplan.org/2021/04/06/equality-saturation-with-egg/</a></p>\n</blockquote>",
        "id": 262950536,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136652
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757956157\">PR review comment</a>:</p>\n<blockquote>\n<p>Would this be disallowed if the middle range were <code>[0, 1]</code>? Where in the system would a failure happen if this were attempted?</p>\n</blockquote>",
        "id": 262950537,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136653
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757956114\">PR review comment</a>:</p>\n<blockquote>\n<p>A range because child nodes can differ in priority?</p>\n</blockquote>",
        "id": 262950538,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136653
    },
    {
        "content": "<p>avanhatt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757955589\">PR review comment</a>:</p>\n<blockquote>\n<p>This also will make testing/fuzzing much easier, presumably :D</p>\n</blockquote>",
        "id": 262950539,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638136653
    },
    {
        "content": "<p>avanhatt edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757956794\">PR review comment</a>.</p>",
        "id": 262957842,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638147479
    },
    {
        "content": "<p>avanhatt edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r757948249\">PR review comment</a>.</p>",
        "id": 262957891,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638147507
    },
    {
        "content": "<p>abrown submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818124289\">PR review</a>.</p>",
        "id": 263047910,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638210010
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758599745\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>  interface) of sorts to allow interaction with Rust code, and\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 263047911,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638210010
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758618404\">PR review comment</a>:</p>\n<blockquote>\n<p>Is this right?</p>\n</blockquote>",
        "id": 263047913,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638210010
    },
    {
        "content": "<p>abrown submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818124289\">PR review</a>.</p>",
        "id": 263047914,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638210011
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818088539\">PR review</a>.</p>",
        "id": 263055720,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758579539\">PR review comment</a>:</p>\n<blockquote>\n<p>\"backtracking\" is a little strange to see here to me, because we specifically <em>don't</em> do any backtracking</p>\n</blockquote>",
        "id": 263055721,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818088539\">PR review</a>.</p>",
        "id": 263055722,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758577871\">PR review comment</a>:</p>\n<blockquote>\n<p>Elsewhere (and at the top of this document) we've defined it as \"instruction <strong>selection</strong> lowering expressions\"</p>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>This document will describe ISLE (Instruction Selection Lowering\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 263055723,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758573306\">PR review comment</a>:</p>\n<blockquote>\n<p>These last two bullet points are indented one space deeper than the earlier bullet points, fwiw.</p>\n</blockquote>",
        "id": 263055724,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758580279\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>  interface) of sorts to allow interacting with Rust code, and\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 263055725,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758581455\">PR review comment</a>:</p>\n<blockquote>\n<p>omg I've been writing footnotes by hand in markdown for years, I had no idea that (at least for github markdown) this existed</p>\n</blockquote>",
        "id": 263055726,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758592203\">PR review comment</a>:</p>\n<blockquote>\n<p>This file should probably belong in <code>cranelift/isle/docs/reference.md</code> or something next to the other ISLE-specific documentation that is in the isle README.md (and could probably be split out into multiple <code>.md</code> files)</p>\n<p>e.g. we don't have the ISLE compiler implementation docs under <code>cranelift/docs/*</code> and I don't think it would make sense to move them there</p>\n</blockquote>",
        "id": 263055727,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758598540\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>  the term is exactly equal to this constant.\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 263055728,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758665243\">PR review comment</a>:</p>\n<blockquote>\n<p>Does this section have any information that isn't present in that comment?</p>\n<p>This level of implementation detail seems better reserved for code comments (as linked to here) or implementation overviews (as in the README), not language reference.</p>\n<p>I think this section can probably be removed.</p>\n</blockquote>",
        "id": 263055729,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758634163\">PR review comment</a>:</p>\n<blockquote>\n<p>I personally feel like there is way more background here than necessary and it will overwhelm people who just want to learn the semantics of ISLE so they can hack on Cranelift's instruction selection.</p>\n<p>Like everything about Turing completeness seems like an aside that, while interesting, is mostly irrelevant.</p>\n</blockquote>",
        "id": 263055730,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638213757
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818225547\">PR review</a>.</p>",
        "id": 263056893,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214350
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758674074\">PR review comment</a>:</p>\n<blockquote>\n<p>Err actually this may have been a github rendering artifact</p>\n</blockquote>",
        "id": 263056894,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214350
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818225965\">PR review</a>.</p>",
        "id": 263056949,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214376
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758674398\">PR review comment</a>:</p>\n<blockquote>\n<p>We do actually, depending on how you look at it! Specifically one can see the decision-trie traversal as a depth-first attempt at finding a path to a leaf node, where we backtrack up the tree when a match op fails. In the generated Rust this manifests as a control-flow edge that falls out of the <code>if match_condition { ... }</code> without returning a <code>Some(result)</code>. The \"explicit backtracking stack pop\" step that one would see in an FSM-like implementation implicitly happens because (i) PC encodes a path through match ops, and we effectively truncate that path by falling through, and (ii) local let-bindings go out of scope, backing up our state.</p>\n</blockquote>",
        "id": 263056950,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214376
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818228817\">PR review</a>.</p>",
        "id": 263057360,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214560
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758676497\">PR review comment</a>:</p>\n<blockquote>\n<p>Apparently the syntax even allows symbolic footnote names (though I tend to just do numbers so it reads ok as plain text too)! And GitHub's markdown renderer recently started to support actually rendering them; it didn't last time I wrote an RFC :-)</p>\n</blockquote>",
        "id": 263057364,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214561
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818235959\">PR review</a>.</p>",
        "id": 263058376,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214990
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758681405\">PR review comment</a>:</p>\n<blockquote>\n<p>Maybe, but that's IMHO there is value in introducing the philosophy behind the approach and the language as well; I'm thinking a bit broader than just folks who want to hack on Cranelift, and this is meant to be reference documentation more than a tutorial. E.g. someone might not realize that it's possible to solve a problem in a certain way by recursing through term-rewrites, unless one is already familiar with the general field; one might not understand how term-rewriting came about and what it can be used for. I want to be helpful to that sort of newcomer who may not be as well-read in the field :-)</p>\n<p>Said another way, somewhere we should do a deep-dive with all the details and thinking behind ISLE; this is meant to be that deep-dive, more than a quickstart.</p>\n<p>There is definitely room for a \"learn just enough about the DSL to be proficient at instruction lowering rules\" tutorial to exist, though; or I guess it already sort of does, in the docs (README's tutorial at least) that you've written?</p>\n</blockquote>",
        "id": 263058377,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638214990
    },
    {
        "content": "<p>cfallin edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758681405\">PR review comment</a>.</p>",
        "id": 263058410,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638215006
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-818296369\">PR review</a>.</p>",
        "id": 263065806,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638218909
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r758724107\">PR review comment</a>:</p>\n<blockquote>\n<p>Thinking about this a bit more -- I can probably wrap the whole TRS section in a \"This section provides background on the general term-rewriting-system concept; please feel free to skip ahead if you just want details on ISLE\" <code>goto</code>; that gives the context and background for those who want it without making it a necessary prerequisite.</p>\n</blockquote>",
        "id": 263065807,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638218909
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a> from <code>isle-docs</code> to <code>main</code>.</p>",
        "id": 263197589,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301302
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a> from <code>isle-docs</code> to <code>main</code>.</p>",
        "id": 263198139,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301476
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a> from <code>isle-docs</code> to <code>main</code>.</p>",
        "id": 263198423,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301534
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759607085\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, OK, I was following your PR's lead (<code>cranelift/docs/isle-integration.md</code>) but I've moved both this and the ISLE-Cranelift integration doc into <code>cranelift/isle/docs/</code>. (Also renamed <code>isle-integration.md</code> to <code>cranelift-integration.md</code> since it's now within the ISLE tree.) This is nicer, agreed!</p>\n</blockquote>",
        "id": 263198561,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301591
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819484024\">PR review</a>.</p>",
        "id": 263198562,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301592
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819484424\">PR review</a>.</p>",
        "id": 263198612,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301616
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759607369\">PR review comment</a>:</p>\n<blockquote>\n<p>Computer architect muscle memory! Fixed.</p>\n</blockquote>",
        "id": 263198613,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301616
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819484931\">PR review</a>.</p>",
        "id": 263198676,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301647
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759607772\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, I think so, but I agree it's pretty terse, so I expanded it with an explanation :-)</p>\n</blockquote>",
        "id": 263198681,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301648
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819485319\">PR review</a>.</p>",
        "id": 263198736,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301672
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759608044\">PR review comment</a>:</p>\n<blockquote>\n<p>Done as above, added a reader-goto around the section \"if you just want details...\".</p>\n</blockquote>",
        "id": 263198738,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301672
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819487352\">PR review</a>.</p>",
        "id": 263199001,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301801
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759609518\">PR review comment</a>:</p>\n<blockquote>\n<p>Good point, the description of the algorithm itself is probably better left to the single canonical place in the source; removed that. I left the high-level description of the trie and added a note (\"We describe this data structure below with the intent to provide an understanding of how the DSL compiler...\") as I think it's useful to have this mental model whenever questions of how the generated code will work come up.</p>\n</blockquote>",
        "id": 263199003,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301802
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819487692\">PR review</a>.</p>",
        "id": 263199076,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301822
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759609778\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, that's a good point! Updated as suggested.</p>\n</blockquote>",
        "id": 263199077,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301822
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759609926\">PR review comment</a>:</p>\n<blockquote>\n<p>Added this point, thanks.</p>\n</blockquote>",
        "id": 263199093,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301839
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819489128\">PR review</a>.</p>",
        "id": 263199199,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301909
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759610779\">PR review comment</a>:</p>\n<blockquote>\n<p>Updated (removed \"symbolic\" here and clarified elsewhere) -- sorry for the confusion here. \"Symbolic\" in this context just meant an externally-defined, imported symbolic name for a particular concrete value; e.g. <code>$MYVALUE</code> for a <code>u32</code>. It's not actually a different type of primitive so I removed its mention here.</p>\n</blockquote>",
        "id": 263199200,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301909
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819489681\">PR review</a>.</p>",
        "id": 263199297,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301944
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759611151\">PR review comment</a>:</p>\n<blockquote>\n<p>Just a pattern-matching operator, not anything CLIF-specific!</p>\n</blockquote>",
        "id": 263199299,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301945
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819489969\">PR review</a>.</p>",
        "id": 263199323,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301961
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759611374\">PR review comment</a>:</p>\n<blockquote>\n<p>Thanks, I added a footnote on this!</p>\n</blockquote>",
        "id": 263199324,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301962
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819490397\">PR review</a>.</p>",
        "id": 263199373,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301987
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759611684\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, exactly; all of the logic to rewrite <code>(A ...)</code> is invoked from one function entry point.</p>\n</blockquote>",
        "id": 263199375,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301987
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819490567\">PR review</a>.</p>",
        "id": 263199393,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301998
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759611818\">PR review comment</a>:</p>\n<blockquote>\n<p>Done.</p>\n</blockquote>",
        "id": 263199394,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638301998
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819491231\">PR review</a>.</p>",
        "id": 263199453,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302040
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759612251\">PR review comment</a>:</p>\n<blockquote>\n<p>No, a constructor form has to have a concrete constructor name; no polymorphism in that dimension. Added clarification, thanks.</p>\n</blockquote>",
        "id": 263199454,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302040
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819491428\">PR review</a>.</p>",
        "id": 263199508,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302053
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759612397\">PR review comment</a>:</p>\n<blockquote>\n<p>Clarified, thanks.</p>\n</blockquote>",
        "id": 263199509,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302053
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819493725\">PR review</a>.</p>",
        "id": 263199792,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302198
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759614097\">PR review comment</a>:</p>\n<blockquote>\n<p>My mistake, it actually is always, in this context; I was thinking of constructor signatures in general, as they are infallible when imported (Rust code called from the RHS is not allowed to fail/backtrack). In this context we're only discussing internal constructors, so that doesn't apply; updated.</p>\n</blockquote>",
        "id": 263199793,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302198
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819493863\">PR review</a>.</p>",
        "id": 263199801,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302205
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759614192\">PR review comment</a>:</p>\n<blockquote>\n<p>Done.</p>\n</blockquote>",
        "id": 263199802,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302205
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819495813\">PR review</a>.</p>",
        "id": 263200039,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302329
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759615701\">PR review comment</a>:</p>\n<blockquote>\n<p>Indeed! No concrete plans yet to independently test the generated code but possibly we could come up with an alternate implementation of the input side (the extractors), maybe even inventing the operand tree as we go (carry the <code>arbitrary::Unstructured</code> in the context object and then generate things on demand). cc @fitzgen for possible fuzzing opportunity :-)</p>\n</blockquote>",
        "id": 263200040,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302329
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819496215\">PR review</a>.</p>",
        "id": 263200086,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302354
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759615992\">PR review comment</a>:</p>\n<blockquote>\n<p>Updated, thanks.</p>\n</blockquote>",
        "id": 263200087,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302354
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819498995\">PR review</a>.</p>",
        "id": 263200526,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302529
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759618038\">PR review comment</a>:</p>\n<blockquote>\n<p>ISLE itself is agnostic to the underlying IR, it just knows about extractors and constructors and various types that the user defines; so one could have <code>(decl compile_to_machine1 (CLIF) MachInst1)</code> and <code>(decl compile_to_machine2 (CLIF) MachInst2)</code> and <code>(decl optimize (CLIF) CLIF)</code> and define rules for each. At least with the first two, we have a type-level guarantee that lowering goes in the proper direction. The latter could have convergence issues but we could limit the number of passes rather than chase a fixpoint indefinitely. Later in the doc (\"A Note on Heterogeneous Types\") touches on this distinction from other TRS-based instruction selector systems; hopefully that clarifies a bit more!</p>\n</blockquote>",
        "id": 263200527,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302529
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819500276\">PR review</a>.</p>",
        "id": 263200694,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302608
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759618979\">PR review comment</a>:</p>\n<blockquote>\n<p>There will be an error if two rules have exactly the same LHS pattern, but not otherwise; the more-specific-first heuristic breaks the tie.</p>\n<p>I added some text about this and about how it's implementation-defined (i.e. the heuristic could change, and rules shouldn't rely on it for correctness, unlike priorities which have specifically-defined semantics).</p>\n</blockquote>",
        "id": 263200695,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302608
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819500551\">PR review</a>.</p>",
        "id": 263200728,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302625
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759619201\">PR review comment</a>:</p>\n<blockquote>\n<p>Updated language here to talk about \"terms\" instead, thanks for pointing this out!</p>\n</blockquote>",
        "id": 263200739,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302629
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819501564\">PR review</a>.</p>",
        "id": 263200853,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302689
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759619944\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, exactly. I ended up removing these few paragraphs because the code also has a similar block comment describing the trie building, but the idea is that it captures the range so that we can allow subtrees to merge as long as there is no intermediate-priority rule that has to be tried before part of the subtree and after another part.</p>\n</blockquote>",
        "id": 263200855,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638302690
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759623371\">PR review comment</a>:</p>\n<blockquote>\n<p>I created #3574 to record this.</p>\n</blockquote>",
        "id": 263201535,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638303002
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819506366\">PR review</a>.</p>",
        "id": 263201536,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638303002
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819511548\">PR review</a>.</p>",
        "id": 263202234,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638303350
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759627199\">PR review comment</a>:</p>\n<blockquote>\n<p>Backtracking (up the decision trie) is still possible if no match arm matches; e.g. one can have</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Value</span>::<span class=\"n\">A</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"k\">ref</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">ref</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"o\">..</span><span class=\"p\">.);</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Value</span>::<span class=\"n\">B</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"k\">ref</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"o\">..</span><span class=\"p\">.);</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"p\">{}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"nb\">None</span><span class=\"w\"></span>\n</code></pre></div>\n<p>We always add the <code>_ =&gt; {}</code> catch-all, as we don't do exhaustiveness checking on the match arms. (We silence the unreachable-code warning so that rustc, which does do this, doesn't complain!)</p>\n</blockquote>",
        "id": 263202235,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638303350
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819512590\">PR review</a>.</p>",
        "id": 263202370,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638303418
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759627898\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, we would avoid building a trie like that, but it wouldn't cause a failure, but rather a tree-split. The block comment in <code>trie.rs</code> covers this a bit better than this summary here (which I removed in favor of just pointing to the block comment).</p>\n</blockquote>",
        "id": 263202371,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638303418
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819522016\">PR review</a>.</p>",
        "id": 263203551,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638304059
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759634770\">PR review comment</a>:</p>\n<blockquote>\n<blockquote>\n<p>show how this decision trie algorithm handles the more-and-less specific rule examples from the beginning</p>\n</blockquote>\n<p>There's a bit more discussion in the block comment that's referenced now, but as far as the more-specific-first ordering, it's a bit subtle. IMHO the best way may not be to try to get the programmer to predict the current algorithm but just to make it a more explicit and well-defined ordering. I created #3575 for this.</p>\n<blockquote>\n<p>brief reference that instruction selection is in general NP-complete</p>\n</blockquote>\n<p>Added a note that collapsing the rule patterns to a fast-dispatch <code>match</code> is not guaranteed, and that worst-case complexity per rewrite is equivalent to a sequential attempt at each rule in turn. The way that we integrate ISLE into our lowering/isel framework I think takes care of the weighted set cover kind of NP-completeness that one generally has when doing isel over the dataflow graph (we do greedy matching) but the complexity is certainly still something to be aware of.</p>\n<blockquote>\n<p>What should engineers consider when adding new ISLE rules? [interaction between ISLE and traditional isel, other details]</p>\n</blockquote>\n<p>@fitzgen's doc I think covers this pretty well, hopefully! If not then we can definitely add more pointers/tips as we encounter/come up with them.</p>\n</blockquote>",
        "id": 263203552,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638304059
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819533475\">PR review</a>.</p>",
        "id": 263205260,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638304836
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759643145\">PR review comment</a>:</p>\n<blockquote>\n<p>Wait, but the <code>isle-integration.md</code> stuff <em>is</em> Cranelift-specific, so it does make sense to be inside <code>cranelift/docs</code>.</p>\n<p>Where as this documentation is just about ISLE and not any specific embedding, so it makes sense it should be under <code>cranelift/isle/docs</code> so it is a part of the ISLE crate/package.</p>\n</blockquote>",
        "id": 263205262,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638304836
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#pullrequestreview-819568509\">PR review</a>.</p>",
        "id": 263210508,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638307269
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560#discussion_r759669174\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, two different perspectives I guess. I had figured putting all ISLE-related documentation in one place made sense, otherwise a newcomer who just knows \"ISLE is an isel thing\" and goes looking for its documentation might miss some of it. I don't care too much either way though, so I'm happy to move it back.</p>\n</blockquote>",
        "id": 263210509,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638307269
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a> from <code>isle-docs</code> to <code>main</code>.</p>",
        "id": 263211091,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638307555
    },
    {
        "content": "<p>cfallin merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3560\">PR #3560</a>.</p>",
        "id": 263216104,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1638310206
    }
]