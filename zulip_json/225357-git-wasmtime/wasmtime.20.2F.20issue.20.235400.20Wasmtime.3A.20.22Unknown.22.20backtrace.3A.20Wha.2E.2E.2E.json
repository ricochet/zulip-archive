[
    {
        "content": "<p>mablinov opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400\">issue #5400</a>:</p>\n<blockquote>\n<p>Hi all,</p>\n<p>I've been trying to get Lua ported to wasmtime for fun and educational value, and I've gotten as far as the prompt.</p>\n<p>However, when I type something in, the interpreter explodes - which by itself is fine, but wasmtime doesn't give a terribly helpful backtrace when it happens, as illustrated below:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Lua</span><span class=\"w\"> </span><span class=\"mf\">5.4.4</span><span class=\"w\">  </span><span class=\"n\">Copyright</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"mi\">1994</span><span class=\"o\">-</span><span class=\"mi\">2022</span><span class=\"w\"> </span><span class=\"n\">Lua</span><span class=\"p\">.</span><span class=\"n\">org</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">PUC</span><span class=\"o\">-</span><span class=\"n\">Rio</span><span class=\"w\"></span>\n<span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"></span>\n<span class=\"n\">luaD_rawrunprotected</span>: <span class=\"nc\">Entered</span><span class=\"w\"></span>\n<span class=\"n\">lua_pushcclosure</span>: <span class=\"nc\">entered</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">L</span>-&gt;<span class=\"nc\">top</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mh\">0x17910</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">L</span>-&gt;<span class=\"nc\">ci</span>-&gt;<span class=\"nc\">top</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mh\">0x17a60</span><span class=\"w\"></span>\n<span class=\"n\">lua_pcallk</span><span class=\"p\">()</span>: <span class=\"nc\">entered</span><span class=\"w\"></span>\n<span class=\"n\">luaD_rawrunprotected</span>: <span class=\"nc\">Entered</span><span class=\"w\"></span>\n<span class=\"n\">lua_pcallk</span><span class=\"p\">()</span>: <span class=\"nc\">entered</span><span class=\"w\"></span>\n<span class=\"n\">luaD_rawrunprotected</span>: <span class=\"nc\">Entered</span><span class=\"w\"></span>\n<span class=\"n\">Error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">lua</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">executing</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n           <span class=\"mi\">0</span>: <span class=\"mh\">0xf2f3</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">144</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">1</span>: <span class=\"mh\">0xd9e6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">129</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">2</span>: <span class=\"mh\">0xc7a9</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">119</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">3</span>: <span class=\"mh\">0xc675</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">118</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">4</span>: <span class=\"mh\">0xd23a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">124</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">5</span>: <span class=\"mh\">0x106ab</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">154</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">6</span>: <span class=\"mh\">0x11ed6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">161</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">7</span>: <span class=\"mh\">0x12022</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">163</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">8</span>: <span class=\"mh\">0x120fe</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">164</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">9</span>: <span class=\"mh\">0x8e38</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">89</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">10</span>: <span class=\"mh\">0xf396</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">145</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">11</span>: <span class=\"mh\">0x12351</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">167</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">12</span>: <span class=\"mh\">0x8b00</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">88</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">13</span>: <span class=\"mh\">0x274d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">29</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">14</span>: <span class=\"mh\">0x2039</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">22</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">15</span>:  <span class=\"mh\">0xfdc</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">16</span>: <span class=\"mh\">0x11913</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">159</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">17</span>: <span class=\"mh\">0x11c07</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">161</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">18</span>: <span class=\"mh\">0x12022</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">163</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">19</span>: <span class=\"mh\">0x120fe</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">164</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">20</span>: <span class=\"mh\">0x8e38</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">89</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">21</span>: <span class=\"mh\">0xf396</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">145</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">22</span>: <span class=\"mh\">0x12351</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">167</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">23</span>: <span class=\"mh\">0x8b00</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">88</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">24</span>:  <span class=\"mh\">0xa2a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">11</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">25</span>: <span class=\"mh\">0x5dd98</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">686</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">26</span>: <span class=\"mh\">0x5dd2a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">685</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">2</span>: <span class=\"nc\">wasm</span><span class=\"w\"> </span><span class=\"n\">trap</span>: <span class=\"nc\">wasm</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">unreachable</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">instruction</span><span class=\"w\"> </span><span class=\"n\">executed</span><span class=\"w\"></span>\n</code></pre></div>\n<p>I've tried building the project with <code>-O0 -g3</code> flags, and launching <code>lua.wasm</code> with <code>wasmtime -g</code> flag, but I still get the un-annotated backtrace.</p>\n<p>Is there something I'm missing?</p>\n</blockquote>",
        "id": 314768278,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670532439
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400#issuecomment-1343456594\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400\">issue #5400</a>:</p>\n<blockquote>\n<p>The <code>&lt;unknown&gt;</code> in the backtrace is the module name, as listed in the core wasm's <code>name</code> section. This is almost always never specified so <code>&lt;unknown&gt;</code> there is somewhat expected.</p>\n<p>The <code>&lt;wasm function NN&gt;</code>, however, means that the <code>name</code> section probably didn't exist in the original wasm binary. How are you compiling lua to wasm? Is it possible to turn off optimizations and turn on dwarf when compiling to wasm?</p>\n<p>Note that Wasmtime's <code>-O0</code> and <code>-g</code> flags here are orthogonal mostly. The <code>-g</code> flag to <code>wasmtime</code> is pretty broken (and we should probably remove it), and <code>-O0</code> only affects cranelift code quality which doesn't affect debuggability through backtraces like this.</p>\n</blockquote>",
        "id": 314783914,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670538435
    },
    {
        "content": "<p>mablinov <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400#issuecomment-1343489952\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400\">issue #5400</a>:</p>\n<blockquote>\n<p>Hi @alexcrichton, thanks for explaining what the fields mean.</p>\n<p>I'm building the Lua object files with <code>-O0 -g3</code>. For example:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">emcc</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wall</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">g3</span><span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">Wfatal</span><span class=\"o\">-</span><span class=\"n\">errors</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wextra</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wshadow</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wsign</span><span class=\"o\">-</span><span class=\"n\">compare</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wundef</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wwrite</span><span class=\"o\">-</span><span class=\"n\">strings</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wredundant</span><span class=\"o\">-</span><span class=\"n\">decls</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wdisable</span><span class=\"w\"></span>\n<span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">optimization</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wdouble</span><span class=\"o\">-</span><span class=\"n\">promotion</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wmissing</span><span class=\"o\">-</span><span class=\"n\">declarations</span><span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">Wdeclaration</span><span class=\"o\">-</span><span class=\"n\">after</span><span class=\"o\">-</span><span class=\"n\">statement</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wmissing</span><span class=\"o\">-</span><span class=\"n\">prototypes</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wnested</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"n\">externs</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wstrict</span><span class=\"o\">-</span><span class=\"n\">prototypes</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wc</span><span class=\"o\">++-</span><span class=\"n\">compat</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wold</span><span class=\"o\">-</span><span class=\"n\">style</span><span class=\"o\">-</span><span class=\"n\">definition</span><span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">std</span><span class=\"o\">=</span><span class=\"n\">c99</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">DLUA_USE_APICHECK</span><span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">fno</span><span class=\"o\">-</span><span class=\"n\">stack</span><span class=\"o\">-</span><span class=\"n\">protector</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"k\">fn</span>\n<span class=\"nf\">o</span><span class=\"o\">-</span><span class=\"n\">common</span><span class=\"w\">   </span><span class=\"o\">-</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">lvm</span><span class=\"p\">.</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">lvm</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"></span>\n</code></pre></div>\n<p>Is the full build invocation for the <code>lvm.o</code> object file.<br>\n</p>\n</blockquote>",
        "id": 314789599,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670540899
    },
    {
        "content": "<p>mablinov <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400#issuecomment-1343508315\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400\">issue #5400</a>:</p>\n<blockquote>\n<p>Just wanted to update: I've opened a parallel issue in the emscripten-core/emscripten repo (<a href=\"https://github.com/emscripten-core/emscripten/issues/18343#issuecomment-1343504497\">here</a>), and it turns out that I just needed to build my object files with the <code>--profiling-funcs</code> flag.</p>\n<p>Sorry about the noise - I'm often not sure whether my problems have to do with the compiler, or the runtime!<br>\n</p>\n</blockquote>",
        "id": 314791918,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670542085
    },
    {
        "content": "<p>mablinov closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5400\">issue #5400</a>:</p>\n<blockquote>\n<p>Hi all,</p>\n<p>I've been trying to get Lua ported to wasmtime for fun and educational value, and I've gotten as far as the prompt.</p>\n<p>However, when I type something in, the interpreter explodes - which by itself is fine, but wasmtime doesn't give a terribly helpful backtrace when it happens, as illustrated below:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Lua</span><span class=\"w\"> </span><span class=\"mf\">5.4.4</span><span class=\"w\">  </span><span class=\"n\">Copyright</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"mi\">1994</span><span class=\"o\">-</span><span class=\"mi\">2022</span><span class=\"w\"> </span><span class=\"n\">Lua</span><span class=\"p\">.</span><span class=\"n\">org</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">PUC</span><span class=\"o\">-</span><span class=\"n\">Rio</span><span class=\"w\"></span>\n<span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"></span>\n<span class=\"n\">luaD_rawrunprotected</span>: <span class=\"nc\">Entered</span><span class=\"w\"></span>\n<span class=\"n\">lua_pushcclosure</span>: <span class=\"nc\">entered</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">L</span>-&gt;<span class=\"nc\">top</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mh\">0x17910</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">L</span>-&gt;<span class=\"nc\">ci</span>-&gt;<span class=\"nc\">top</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mh\">0x17a60</span><span class=\"w\"></span>\n<span class=\"n\">lua_pcallk</span><span class=\"p\">()</span>: <span class=\"nc\">entered</span><span class=\"w\"></span>\n<span class=\"n\">luaD_rawrunprotected</span>: <span class=\"nc\">Entered</span><span class=\"w\"></span>\n<span class=\"n\">lua_pcallk</span><span class=\"p\">()</span>: <span class=\"nc\">entered</span><span class=\"w\"></span>\n<span class=\"n\">luaD_rawrunprotected</span>: <span class=\"nc\">Entered</span><span class=\"w\"></span>\n<span class=\"n\">Error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">lua</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">executing</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n           <span class=\"mi\">0</span>: <span class=\"mh\">0xf2f3</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">144</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">1</span>: <span class=\"mh\">0xd9e6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">129</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">2</span>: <span class=\"mh\">0xc7a9</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">119</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">3</span>: <span class=\"mh\">0xc675</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">118</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">4</span>: <span class=\"mh\">0xd23a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">124</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">5</span>: <span class=\"mh\">0x106ab</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">154</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">6</span>: <span class=\"mh\">0x11ed6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">161</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">7</span>: <span class=\"mh\">0x12022</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">163</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">8</span>: <span class=\"mh\">0x120fe</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">164</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">9</span>: <span class=\"mh\">0x8e38</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">89</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">10</span>: <span class=\"mh\">0xf396</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">145</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">11</span>: <span class=\"mh\">0x12351</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">167</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">12</span>: <span class=\"mh\">0x8b00</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">88</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">13</span>: <span class=\"mh\">0x274d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">29</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">14</span>: <span class=\"mh\">0x2039</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">22</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">15</span>:  <span class=\"mh\">0xfdc</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">13</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">16</span>: <span class=\"mh\">0x11913</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">159</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">17</span>: <span class=\"mh\">0x11c07</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">161</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">18</span>: <span class=\"mh\">0x12022</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">163</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">19</span>: <span class=\"mh\">0x120fe</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">164</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">20</span>: <span class=\"mh\">0x8e38</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">89</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">21</span>: <span class=\"mh\">0xf396</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">145</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">22</span>: <span class=\"mh\">0x12351</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">167</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">23</span>: <span class=\"mh\">0x8b00</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">88</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">24</span>:  <span class=\"mh\">0xa2a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">11</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">25</span>: <span class=\"mh\">0x5dd98</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">686</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">          </span><span class=\"mi\">26</span>: <span class=\"mh\">0x5dd2a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">685</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">2</span>: <span class=\"nc\">wasm</span><span class=\"w\"> </span><span class=\"n\">trap</span>: <span class=\"nc\">wasm</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">unreachable</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">instruction</span><span class=\"w\"> </span><span class=\"n\">executed</span><span class=\"w\"></span>\n</code></pre></div>\n<p>I've tried building the project with <code>-O0 -g3</code> flags, and launching <code>lua.wasm</code> with <code>wasmtime -g</code> flag, but I still get the un-annotated backtrace.</p>\n<p>Is there something I'm missing?</p>\n</blockquote>",
        "id": 314791919,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670542086
    }
]