[
    {
        "content": "<p>jameysharp opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6717\">issue #6717</a>:</p>\n<blockquote>\n<h3>Steps to Reproduce</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">features</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"o\">-</span><span class=\"n\">arch</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">explore</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">riscv64</span><span class=\"w\"> </span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">-</span><span class=\"n\">api</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"n\">c</span><span class=\"o\">-</span><span class=\"n\">api</span><span class=\"o\">/</span><span class=\"n\">example</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n</code></pre></div>\n<p>If your native host is actually a <code>riscv64</code> system, replace the target with something else such as <code>x86_64</code>.</p>\n<h3>Expected Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Exploration</span><span class=\"w\"> </span><span class=\"n\">written</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">-</span><span class=\"n\">api</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"n\">c</span><span class=\"o\">-</span><span class=\"n\">api</span><span class=\"o\">/</span><span class=\"n\">example</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"p\">.</span><span class=\"n\">explore</span><span class=\"p\">.</span><span class=\"n\">html</span>\n</code></pre></div>\n<h3>Actual Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span>: <span class=\"nc\">compilation</span><span class=\"w\"> </span><span class=\"n\">settings</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">compatible</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">native</span><span class=\"w\"> </span><span class=\"n\">host</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"nc\">target</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">riscv64</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">specified</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">configuration</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">host</span>\n</code></pre></div>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: c34567cdddc483d6bdf6a7b04c43026174eef5bf</p>\n<p>Operating system: Linux</p>\n<p>Architecture: x86-64</p>\n<h3>Extra Info</h3>\n<p>Based on the error messages, apparently <code>wasmtime explore</code> winds up in <code>Engine::check_compatible_with_native_host</code> by way of <code>Module::from_binary</code>. I don't understand why this mode would use that path though.</p>\n<p>Found this together with @michelledaviest while trying to understand some profiling results.</p>\n</blockquote>",
        "id": 374745941,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1689196169
    },
    {
        "content": "<p><a href=\"https://github.com/jameysharp\">jameysharp</a> added the <a href=\"https://api.github.com/repos/bytecodealliance/wasmtime/labels/bug\">bug</a> label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6717\">Issue #6717</a>.</p>",
        "id": 374745942,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1689196169
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6717#issuecomment-1634282967\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6717\">issue #6717</a>:</p>\n<blockquote>\n<p>The reason for this is due to <a href=\"https://github.com/bytecodealliance/wasmtime/blob/42919fa15ac5dbb0b42d1979e8d44e6b3bd066d4/crates/explorer/src/lib.rs#L104\">this line</a> where a <code>Module</code> is created and a <code>Module</code> is \"proof of ready to run\" which in a cross-compiled case is impossible since the native platform is never ready to run a different platform. Awhile back this is why <code>Engine::precompile_module</code> was added which skips \"is this ready to run\" checks and is suitable for cross-compilation (or enabling more features than the host has, stuff like that).</p>\n<p>The problem here though is that <code>Module</code> has a good deal of useful metadata about the module that <code>precompile_module</code> doesn't return (it just returns a <code>Vec&lt;u8&gt;</code>). One option though would be to return <code>-&gt; Result&lt;PrecompiledModule&gt;</code> which packages up all the necessary information.</p>\n</blockquote>",
        "id": 374940362,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1689256187
    }
]