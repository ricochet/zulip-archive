[
    {
        "content": "<p>arihant2math opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>Currently if an explicit isle directory is found when the \"isle-in-source-tree\" feature is not enabled, the following error message is shown by the build script for cranelift-codegen:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"o\">---</span><span class=\"w\"> </span><span class=\"n\">stderr</span>\n<span class=\"w\">  </span><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">directory</span><span class=\"w\"> </span><span class=\"n\">isle_generated_code</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"w\"> </span><span class=\"n\">when</span>\n<span class=\"w\">  </span><span class=\"err\">`</span><span class=\"o\">--</span><span class=\"n\">feature</span><span class=\"w\"> </span><span class=\"n\">isle</span><span class=\"o\">-</span><span class=\"k\">in</span><span class=\"o\">-</span><span class=\"n\">source</span><span class=\"o\">-</span><span class=\"n\">tree</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">specified</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">To</span><span class=\"w\"> </span><span class=\"n\">prevent</span><span class=\"w\"> </span><span class=\"n\">confusion</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"w\"> </span><span class=\"n\">requires</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">removed</span><span class=\"w\"> </span><span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">reverting</span>\n<span class=\"w\">  </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">usual</span><span class=\"w\"> </span><span class=\"n\">generated</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">Please</span><span class=\"w\"> </span><span class=\"n\">delete</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"n\">and</span>\n<span class=\"w\">  </span><span class=\"n\">re</span><span class=\"o\">-</span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"p\">.</span>\n</code></pre></div>\n<p>as emitted by <a href=\"https://github.com/bytecodealliance/wasmtime/blob/3e0b7e501beebf5d7c094b7ac751f582ba12bc95/cranelift/codegen/build.rs#L78\">https://github.com/bytecodealliance/wasmtime/blob/3e0b7e501beebf5d7c094b7ac751f582ba12bc95/cranelift/codegen/build.rs#L78</a>.</p>\n<p>However this is misleading as deleting the <code>target/</code> directory (atleast on windows) does not fix the issue. The directory, for me, was located in <code>%HOME%\\\\.cargo\\\\registry\\\\src\\\\index.crates.io-6f17d22bba15001f\\\\cranelift-codegen-0.113.1\\\\isle_generated_code</code>. Could there possibly be a better check/error message and/or the actual directory located printed out to stderr?</p>\n</blockquote>",
        "id": 483403779,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732076650
    },
    {
        "content": "<p>arihant2math edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>Currently if an explicit isle directory is found when the \"isle-in-source-tree\" feature is not enabled, the following error message is shown by the build script for cranelift-codegen:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"o\">---</span><span class=\"w\"> </span><span class=\"n\">stderr</span>\n<span class=\"w\">  </span><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">directory</span><span class=\"w\"> </span><span class=\"n\">isle_generated_code</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"w\"> </span><span class=\"n\">when</span>\n<span class=\"w\">  </span><span class=\"err\">`</span><span class=\"o\">--</span><span class=\"n\">feature</span><span class=\"w\"> </span><span class=\"n\">isle</span><span class=\"o\">-</span><span class=\"k\">in</span><span class=\"o\">-</span><span class=\"n\">source</span><span class=\"o\">-</span><span class=\"n\">tree</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">specified</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">To</span><span class=\"w\"> </span><span class=\"n\">prevent</span><span class=\"w\"> </span><span class=\"n\">confusion</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"w\"> </span><span class=\"n\">requires</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">removed</span><span class=\"w\"> </span><span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">reverting</span>\n<span class=\"w\">  </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">usual</span><span class=\"w\"> </span><span class=\"n\">generated</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">Please</span><span class=\"w\"> </span><span class=\"n\">delete</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"n\">and</span>\n<span class=\"w\">  </span><span class=\"n\">re</span><span class=\"o\">-</span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"p\">.</span>\n</code></pre></div>\n<p>as emitted by <a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/build.rs#L78C9-L87C10\">https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/build.rs#L78C9-L87C10</a>.</p>\n<p>However this is misleading as deleting the <code>target/</code> directory (atleast on windows) does not fix the issue. The directory, for me, was located in <code>%HOME%\\\\.cargo\\\\registry\\\\src\\\\index.crates.io-6f17d22bba15001f\\\\cranelift-codegen-0.113.1\\\\isle_generated_code</code>. Could there possibly be a better check/error message and/or the actual directory located printed out to stderr?</p>\n</blockquote>",
        "id": 483403837,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732076710
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625#issuecomment-2487401317\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>This seems to be a duplicate of #9588. That directory should not ever be created inside the <code>.cargo</code> path. Could you say more about how you're building Cranelift?</p>\n</blockquote>",
        "id": 483404266,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732077042
    },
    {
        "content": "<p>arihant2math <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625#issuecomment-2487731606\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>I'm using wasmtime, so building is done because/through that. I'm not using any special features, just the default configuration. </p>\n<p>I did some digging around the code, I think the bug is around L61 when calling <code> env::current_dir()</code>, since I'm pretty sure that's inconsistent when used in build scripts, I printed it out and got   \"%HOME%\\\\.cargo\\\\registry\\src\\index.crates.io-6f17d22bba15001f\\\\cranelift-codegen-0.113.1\", which seems to be the issue.</p>\n<p>If changed to the <code>OUT_DIR</code> env variable, it would be in the target folder, which would be an improvement.</p>\n</blockquote>",
        "id": 483421059,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732088088
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625#issuecomment-2487901715\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p><code>env::current_dir()</code> is used for exactly two purposes in the build script:</p>\n<ul>\n<li>Getting the source files. Using <code>OUT_DIR</code> here would be wrong.</li>\n<li>Looking for a <code>isle_generated_code</code> directory in the source directory to use if <code>isle-in-source-tree</code> is enabled. The very intent of <code>isle-in-source-tree</code> requires this to keep using the source directory too.</li>\n</ul>\n<p>If you aren't doing development on Cranelift itself, <code>isle-in-source-tree</code> should never be enabled (and it definitively shouldn't be enabled when using it as <a href=\"http://crates.io\">crates.io</a> dependency as those are not allowed to write to their source directory) and as such <code>isle_generated_code</code> should never be generated in the source directory. We want to know why it is generated anyway. Is any project you built that depends on Cranelift using <code>isle-in-source-tree</code>?</p>\n</blockquote>",
        "id": 483430625,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732092065
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625#issuecomment-2487912206\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>So turns out until very recently Wasmer was enabling <code>isle-in-source-tree</code>: <a href=\"https://github.com/wasmerio/wasmer/pull/5202\">https://github.com/wasmerio/wasmer/pull/5202</a> Did you build Wasmer within the past couple of weeks? Note that Wasmer and Wasmtime are two entirely separate wasm engines. They just happen to share Cranelift as one of the compiler backends they use.</p>\n</blockquote>",
        "id": 483431305,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732092342
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625#issuecomment-2489045452\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>That's fairly obnoxious. Perhaps we should remove the feature altogether, unless folks are still using it -- I'll bring this up in the Cranelift meeting in a few minutes.</p>\n</blockquote>",
        "id": 483525148,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732120070
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9625\">issue #9625</a>:</p>\n<blockquote>\n<p>Currently if an explicit isle directory is found when the \"isle-in-source-tree\" feature is not enabled, the following error message is shown by the build script for cranelift-codegen:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"o\">---</span><span class=\"w\"> </span><span class=\"n\">stderr</span>\n<span class=\"w\">  </span><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">directory</span><span class=\"w\"> </span><span class=\"n\">isle_generated_code</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">exists</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"w\"> </span><span class=\"n\">when</span>\n<span class=\"w\">  </span><span class=\"err\">`</span><span class=\"o\">--</span><span class=\"n\">feature</span><span class=\"w\"> </span><span class=\"n\">isle</span><span class=\"o\">-</span><span class=\"k\">in</span><span class=\"o\">-</span><span class=\"n\">source</span><span class=\"o\">-</span><span class=\"n\">tree</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">specified</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">To</span><span class=\"w\"> </span><span class=\"n\">prevent</span><span class=\"w\"> </span><span class=\"n\">confusion</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"w\"> </span><span class=\"n\">requires</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">removed</span><span class=\"w\"> </span><span class=\"n\">when</span><span class=\"w\"> </span><span class=\"n\">reverting</span>\n<span class=\"w\">  </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">usual</span><span class=\"w\"> </span><span class=\"n\">generated</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">Please</span><span class=\"w\"> </span><span class=\"n\">delete</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"> </span><span class=\"n\">and</span>\n<span class=\"w\">  </span><span class=\"n\">re</span><span class=\"o\">-</span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"p\">.</span>\n</code></pre></div>\n<p>as emitted by <a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/build.rs#L78C9-L87C10\">https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/build.rs#L78C9-L87C10</a>.</p>\n<p>However this is misleading as deleting the <code>target/</code> directory (atleast on windows) does not fix the issue. The directory, for me, was located in <code>%HOME%\\\\.cargo\\\\registry\\\\src\\\\index.crates.io-6f17d22bba15001f\\\\cranelift-codegen-0.113.1\\\\isle_generated_code</code>. Could there possibly be a better check/error message and/or the actual directory located printed out to stderr?</p>\n</blockquote>",
        "id": 483545134,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732126523
    }
]