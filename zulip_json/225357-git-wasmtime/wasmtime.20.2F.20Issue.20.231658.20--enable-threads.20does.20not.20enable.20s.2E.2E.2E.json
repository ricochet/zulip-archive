[
    {
        "content": "<p>RReverser labeled <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">Issue #1658</a>:</p>\n<blockquote>\n<p>I'm using Wasmtime 0.16.0.</p>\n<p>I've noticed that, even with, <code>--enable-threads</code>, Wasmtime fails to parse modules defining shared memories, e.g.: <a href=\"https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat\" title=\"https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat\">https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat</a></p>\n<div class=\"codehilite\"><pre><span></span><code>(module\n  (memory 1 1 shared)\n  (func\n    i32.const 0\n    i32.atomic.load\n    drop\n  )\n)\n</code></pre></div>\n\n\n<p>results in:</p>\n<div class=\"codehilite\"><pre><span></span><code>Caused by:\n    0: failed directive on C:\\Users\\rreverser\\Projects\\wasm-feature-detect\\src\\detectors\\threads\\module.wat:5:1\n    1: WebAssembly failed to compile\n    2: WebAssembly translation error\n    3: Unsupported feature: shared memories\n</code></pre></div>\n\n\n<p>While I know this feature is experimental and currently not very useful in Wasmtime, it seems unexpected because the comment for <code>enable_threads</code> suggests this should work at this flag enables shared memory and atomics:</p>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147\" title=\"https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147\">https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147</a></p>\n</blockquote>",
        "id": 196308324,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1588685845
    },
    {
        "content": "<p>RReverser opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">Issue #1658</a>:</p>\n<blockquote>\n<p>I'm using Wasmtime 0.16.0.</p>\n<p>I've noticed that, even with, <code>--enable-threads</code>, Wasmtime fails to parse modules defining shared memories, e.g.: <a href=\"https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat\" title=\"https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat\">https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat</a></p>\n<div class=\"codehilite\"><pre><span></span><code>(module\n  (memory 1 1 shared)\n  (func\n    i32.const 0\n    i32.atomic.load\n    drop\n  )\n)\n</code></pre></div>\n\n\n<p>results in:</p>\n<div class=\"codehilite\"><pre><span></span><code>Caused by:\n    0: failed directive on C:\\Users\\rreverser\\Projects\\wasm-feature-detect\\src\\detectors\\threads\\module.wat:5:1\n    1: WebAssembly failed to compile\n    2: WebAssembly translation error\n    3: Unsupported feature: shared memories\n</code></pre></div>\n\n\n<p>While I know this feature is experimental and currently not very useful in Wasmtime, it seems unexpected because the comment for <code>enable_threads</code> suggests this should work at this flag enables shared memory and atomics:</p>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147\" title=\"https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147\">https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147</a></p>\n</blockquote>",
        "id": 196308325,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1588685845
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658#issuecomment-624065933\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1658#issuecomment-624065933\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">Issue #1658</a>:</p>\n<blockquote>\n<p>Atomics are not implemented by Cranelift at all.</p>\n</blockquote>",
        "id": 196309514,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1588686457
    },
    {
        "content": "<p>programmerjake <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658#issuecomment-790124986\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">Issue #1658</a>:</p>\n<blockquote>\n<blockquote>\n<p>Atomics are not implemented by Cranelift at all.</p>\n</blockquote>\n<p>they've since been implemented. <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1059#issuecomment-679061786\">https://github.com/bytecodealliance/wasmtime/issues/1059#issuecomment-679061786</a></p>\n</blockquote>",
        "id": 228682056,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1614811358
    }
]