[
    {
        "content": "<p>bkolobara opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>I recently run into a flaky issue running a WASM app using Externrefs under Wasmtime.<br>\nSadly, I can't share any code related to it. Either way it's a lot of code and I'm looking more at pointers how I could debug this further by myself.</p>\n<p><strong>Sometimes</strong> (8 out of 10 runs) the app would panic with the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'&lt;</span><span class=\"n\">unnamed</span><span class=\"o\">&gt;'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">every</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"o\">-</span><span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">externref</span><span class=\"w\"> </span><span class=\"n\">inside</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Wasm</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"w\"> </span><span class=\"n\">should</span><span class=\"w\"> </span><span class=\"n\">have</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">entry</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">VMExternRefActivationsTable</span><span class=\"o\">'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n   <span class=\"mi\">0</span>: <span class=\"nc\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">505</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">1</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">2</span>: <span class=\"nc\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"n\">impls</span>::<span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"nb\">FnMut</span><span class=\"o\">&lt;</span><span class=\"n\">A</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">&gt;</span>::<span class=\"n\">call_mut</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ops</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">269</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">3</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">trace_fn</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">107</span>:<span class=\"mi\">26</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">4</span>: <span class=\"nc\">__Unwind_Backtrace</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">5</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">95</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">6</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">7</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">53</span>:<span class=\"mi\">14</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">8</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1054</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">9</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">gc_and_insert_slow</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">585</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">10</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">insert_with_gc</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">575</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">11</span>: <span class=\"o\">&lt;</span><span class=\"n\">core</span>::<span class=\"n\">option</span>::<span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">wasmtime</span>::<span class=\"k\">ref</span>::<span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmTy</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_arg</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1238</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">12</span>: <span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmRet</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_ret</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1350</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">13</span>: <span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,</span><span class=\"n\">A1</span><span class=\"p\">,</span><span class=\"n\">A2</span><span class=\"p\">,</span><span class=\"n\">A3</span><span class=\"p\">),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">wasm_to_host_shim</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1624</span>:<span class=\"mi\">29</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">14</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">15</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">16</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">17</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">18</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">19</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">20</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">21</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">22</span>: <span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">host_trampoline</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1657</span>:<span class=\"mi\">31</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">23</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">620</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">24</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"n\">call_closure</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">397</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">25</span>: <span class=\"nc\">RegisterSetjmp</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">helpers</span><span class=\"p\">.</span><span class=\"n\">c</span>:<span class=\"mi\">12</span>:<span class=\"mi\">3</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">26</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">386</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">27</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">CallThreadState</span>::<span class=\"n\">with</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">442</span>:<span class=\"mi\">38</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">28</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">tls</span>::<span class=\"n\">set</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">682</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">29</span>: <span class=\"nc\">std</span>::<span class=\"n\">thread</span>::<span class=\"n\">local</span>::<span class=\"n\">LocalKey</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span>::<span class=\"n\">try_with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">thread</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">272</span>:<span class=\"mi\">16</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">30</span>: <span class=\"nc\">std</span>::<span class=\"n\">thread</span>::<span class=\"n\">local</span>::<span class=\"n\">LocalKey</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span>::<span class=\"n\">with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">thread</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">248</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">31</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">tls</span>::<span class=\"n\">set</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">674</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">32</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">CallThreadState</span>::<span class=\"n\">with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">442</span>:<span class=\"mi\">19</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">33</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">385</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">34</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">invoke_wasm_and_catch_traps</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">829</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">35</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">619</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">36</span>: <span class=\"nc\">lunatic_vm</span>::<span class=\"n\">process</span>::<span class=\"n\">Process</span>::<span class=\"n\">spawn</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">process</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">160</span>:<span class=\"mi\">25</span><span class=\"w\"></span>\n<span class=\"o\">....</span><span class=\"w\"></span>\n</code></pre></div>\n<p>The code path taken by the app should always be the same and first of all I can't figure out why it only fails sometimes. Any pointers would be appreciated. </p>\n</blockquote>",
        "id": 216116700,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604942863
    },
    {
        "content": "<p>bkolobara labeled <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>I recently run into a flaky issue running a WASM app using Externrefs under Wasmtime.<br>\nSadly, I can't share any code related to it. Either way it's a lot of code and I'm looking more at pointers how I could debug this further by myself.</p>\n<p><strong>Sometimes</strong> (8 out of 10 runs) the app would panic with the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'&lt;</span><span class=\"n\">unnamed</span><span class=\"o\">&gt;'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">every</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"o\">-</span><span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">externref</span><span class=\"w\"> </span><span class=\"n\">inside</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Wasm</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"w\"> </span><span class=\"n\">should</span><span class=\"w\"> </span><span class=\"n\">have</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">entry</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">VMExternRefActivationsTable</span><span class=\"o\">'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n   <span class=\"mi\">0</span>: <span class=\"nc\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">505</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">1</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">2</span>: <span class=\"nc\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"n\">impls</span>::<span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"nb\">FnMut</span><span class=\"o\">&lt;</span><span class=\"n\">A</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">&gt;</span>::<span class=\"n\">call_mut</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ops</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">269</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">3</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">trace_fn</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">107</span>:<span class=\"mi\">26</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">4</span>: <span class=\"nc\">__Unwind_Backtrace</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">5</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">95</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">6</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">7</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">53</span>:<span class=\"mi\">14</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">8</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1054</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">9</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">gc_and_insert_slow</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">585</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">10</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">insert_with_gc</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">575</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">11</span>: <span class=\"o\">&lt;</span><span class=\"n\">core</span>::<span class=\"n\">option</span>::<span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">wasmtime</span>::<span class=\"k\">ref</span>::<span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmTy</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_arg</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1238</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">12</span>: <span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmRet</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_ret</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1350</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">13</span>: <span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,</span><span class=\"n\">A1</span><span class=\"p\">,</span><span class=\"n\">A2</span><span class=\"p\">,</span><span class=\"n\">A3</span><span class=\"p\">),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">wasm_to_host_shim</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1624</span>:<span class=\"mi\">29</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">14</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">15</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">16</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">17</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">18</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">19</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">20</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">21</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">22</span>: <span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">host_trampoline</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1657</span>:<span class=\"mi\">31</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">23</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">620</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">24</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"n\">call_closure</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">397</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">25</span>: <span class=\"nc\">RegisterSetjmp</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">helpers</span><span class=\"p\">.</span><span class=\"n\">c</span>:<span class=\"mi\">12</span>:<span class=\"mi\">3</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">26</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">386</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">27</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">CallThreadState</span>::<span class=\"n\">with</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">442</span>:<span class=\"mi\">38</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">28</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">tls</span>::<span class=\"n\">set</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">682</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">29</span>: <span class=\"nc\">std</span>::<span class=\"n\">thread</span>::<span class=\"n\">local</span>::<span class=\"n\">LocalKey</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span>::<span class=\"n\">try_with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">thread</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">272</span>:<span class=\"mi\">16</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">30</span>: <span class=\"nc\">std</span>::<span class=\"n\">thread</span>::<span class=\"n\">local</span>::<span class=\"n\">LocalKey</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span>::<span class=\"n\">with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">thread</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">248</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">31</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">tls</span>::<span class=\"n\">set</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">674</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">32</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">CallThreadState</span>::<span class=\"n\">with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">442</span>:<span class=\"mi\">19</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">33</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">385</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">34</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">invoke_wasm_and_catch_traps</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">829</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">35</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">619</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">36</span>: <span class=\"nc\">lunatic_vm</span>::<span class=\"n\">process</span>::<span class=\"n\">Process</span>::<span class=\"n\">spawn</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">process</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">160</span>:<span class=\"mi\">25</span><span class=\"w\"></span>\n<span class=\"o\">....</span><span class=\"w\"></span>\n</code></pre></div>\n<p>The code path taken by the app should always be the same and first of all I can't figure out why it only fails sometimes. Any pointers would be appreciated. </p>\n</blockquote>",
        "id": 216116701,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604942863
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724161600\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Can you share the wasm file? That may help with debugging this problem.</p>\n</blockquote>",
        "id": 216117433,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604943180
    },
    {
        "content": "<p>bkolobara <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724164627\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Yes. This is the file.<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/files/5512287/wasm-experiment.wasm.zip\">wasm-experiment.wasm.zip</a></p>\n</blockquote>",
        "id": 216118226,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604943510
    },
    {
        "content": "<p>bkolobara edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724164627\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Yes. This is the file.<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/files/5512287/wasm-experiment.wasm.zip\">wasm-experiment.wasm.zip</a></p>\n<p>this is the <code>--release</code> build. I can also provide a debug one if it helps.</p>\n</blockquote>",
        "id": 216118290,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604943550
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724176090\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>@bkolobara to confirm, that wasm file has no <code>externref</code> in it. Is that the one you're using? It may be that we're not returning an error when you use <code>externref</code> when we otherwise should!</p>\n</blockquote>",
        "id": 216121196,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604944735
    },
    {
        "content": "<p>bkolobara <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724214898\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Sorry, I forgot that there are wrapper functions created and injected in the wasm file before it's executed. This wrapper functions save the Externref in a table and return just an index. Now that I think more about it they, didn't get much of testing and could be the issue.</p>\n<p>The transformation looks somewhat like this:</p>\n<div class=\"codehilite\" data-code-language=\"wasm\"><pre><span></span><code>;; Input\n(module\n  (import \"lunatic\" \"spawn\" (func (;0;) (param i32 i32 i64) (result i32)))\n  (func $test (result i32)\n    i32.const 0\n    i32.const 0\n    i64.const 0\n    call 0)\n)\n\n;; Transformation:\n(module\n  (type (;0;) (func))\n  (type (;1;) (func (result i32)))\n  (type (;2;) (func (param i32)))\n  (type (;3;) (func (param i32 i32 i64) (result i32)))\n  (type (;4;) (func (param i32 i32 i64) (result externref)))\n  (type (;5;) (func (param externref) (result i32)))\n\n  (import \"lunatic\" \"yield\" (func (;0;) (type 0)))\n  (import \"lunatic\" \"get_externref_free_slot\" (func (;1;) (type 1)))\n  (import \"lunatic\" \"set_externref_free_slot\" (func (;2;) (type 2)))\n  (import \"lunatic\" \"spawn\" (func (;3;) (type 4)))\n\n  (func $test (type 1) (result i32)\n    block  ;; label = @1\n      global.get 0\n      i32.const 1\n      i32.add\n      global.set 0\n      global.get 0\n      i32.const 10000\n      i32.gt_s\n      if  ;; label = @2\n        call 0\n        i32.const 0\n        global.set 0\n      else\n      end\n    end\n    i32.const 0\n    i32.const 0\n    i64.const 0\n    call 6)\n\n  ;; Save externref\n  (func (;5;) (type 5) (param externref) (result i32)\n    (local i32)\n    call 1\n    local.tee 1\n    table.size 0\n    i32.eq\n    if  ;; label = @1,\n      ref.null extern\n      table.size 0\n      table.grow 0\n      drop\n    else\n    end\n    local.get 1\n    local.get 0\n    table.set 0\n    local.get 1)\n\n  ;; Swap import wrapper\n  (func (;6;) (type 3) (param i32 i32 i64) (result i32)\n    local.get 0\n    local.get 1\n    local.get 2\n    call 3\n    call 5)\n\n  ;; Drop externref\n  (func (;7;) (type 2) (param i32)\n    local.get 0\n    ref.null extern\n    table.set 0\n    local.get 0\n    call 2)\n\n  (table (;0;) 4 externref)\n  (global (;0;) (mut i32) (i32.const 0))\n  (export \"__lunatic_externref_resource_table\" (table 0))\n  (export \"_lunatic_externref_save\" (func 5))\n  (export \"_lunatic_externref_drop\" (func 7)))\n</code></pre></div>\n<p>The <code>Save externref</code> function is the one that preserves the externref in the table. There is also the part on the host side (get_externref_free_slot, set_externref_free_slot) that keeps track of free slots in the externref table.</p>\n</blockquote>",
        "id": 216129676,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604948797
    },
    {
        "content": "<p>bkolobara edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724214898\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Sorry, I forgot that there are wrapper functions created and injected in the wasm file before it's executed. This wrapper functions save the Externref in a table and return just an index. Now that I think more about it they, didn't get much of testing and could be the issue.</p>\n<p>The transformation looks somewhat like this:</p>\n<div class=\"codehilite\" data-code-language=\"wasm\"><pre><span></span><code>;; Input\n(module\n  (import \"lunatic\" \"spawn\" (func (;0;) (param i32 i32 i64) (result i32)))\n  (func $test (result i32)\n    i32.const 0\n    i32.const 0\n    i64.const 0\n    call 0)\n)\n\n;; Transformation:\n(module\n  (type (;0;) (func))\n  (type (;1;) (func (result i32)))\n  (type (;2;) (func (param i32)))\n  (type (;3;) (func (param i32 i32 i64) (result i32)))\n  (type (;4;) (func (param i32 i32 i64) (result externref)))\n  (type (;5;) (func (param externref) (result i32)))\n\n  (import \"lunatic\" \"yield\" (func (;0;) (type 0)))\n  (import \"lunatic\" \"get_externref_free_slot\" (func (;1;) (type 1)))\n  (import \"lunatic\" \"set_externref_free_slot\" (func (;2;) (type 2)))\n  (import \"lunatic\" \"spawn\" (func (;3;) (type 4)))\n\n  (func $test (type 1) (result i32)\n    i32.const 0\n    i32.const 0\n    i64.const 0\n    call 6)\n\n  ;; Save externref\n  (func (;5;) (type 5) (param externref) (result i32)\n    (local i32)\n    call 1\n    local.tee 1\n    table.size 0\n    i32.eq\n    if  ;; label = @1,\n      ref.null extern\n      table.size 0\n      table.grow 0\n      drop\n    else\n    end\n    local.get 1\n    local.get 0\n    table.set 0\n    local.get 1)\n\n  ;; Spawn import wrapper\n  (func (;6;) (type 3) (param i32 i32 i64) (result i32)\n    local.get 0\n    local.get 1\n    local.get 2\n    call 3\n    call 5)\n\n  ;; Drop externref\n  (func (;7;) (type 2) (param i32)\n    local.get 0\n    ref.null extern\n    table.set 0\n    local.get 0\n    call 2)\n\n  (table (;0;) 4 externref)\n  (global (;0;) (mut i32) (i32.const 0))\n  (export \"__lunatic_externref_resource_table\" (table 0))\n  (export \"_lunatic_externref_save\" (func 5))\n  (export \"_lunatic_externref_drop\" (func 7)))\n</code></pre></div>\n<p>The <code>Save externref</code> function is the one that preserves the externref in the table. There is also the part on the host side (get_externref_free_slot, set_externref_free_slot) that keeps track of free slots in the externref table.</p>\n</blockquote>",
        "id": 216129875,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604948903
    },
    {
        "content": "<p>bkolobara <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724225772\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>I have published the code here: <a href=\"https://github.com/lunatic-lang/lunatic\">https://github.com/lunatic-lang/lunatic</a>. You should be able to run the .wasm file with: <code>cargo run -- wasm-experiment.wasm</code>.</p>\n<p>I just didn't test it on different operating systems and it may not work on Windows.</p>\n</blockquote>",
        "id": 216131705,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604949830
    },
    {
        "content": "<p>bkolobara edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724225772\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>I have published the code here: <a href=\"https://github.com/lunatic-lang/lunatic\">https://github.com/lunatic-lang/lunatic</a>. You should be able to run the .wasm file with: <code>cargo run -- wasm-experiment.wasm</code>.</p>\n<p>I just didn't test it on different operating systems and it may not work on Windows. Also, my usage of Wasmtime is a bit unconventional :). This could also be a source of issues.</p>\n</blockquote>",
        "id": 216132012,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604949952
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724273935\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Ok thanks for the repo! It looks like there's a number of <code>unsafe</code> blocks and it also looks like you're reaching into wasmtime internals (the <code>wasmtime-runtime</code> crate), so that may be what's going wrong here? Would it be possible to try to cut that back and see if it works better?</p>\n</blockquote>",
        "id": 216141944,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604955481
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724287130\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Thanks for filing a bug report @bkolobara.</p>\n<p>If you could create a wasm file such that running</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<p>exhibits the issue, I could take it from there and reduce the test case myself.</p>\n<p>But yeah, as @alexcrichton pointed out, using Wasmtime internals is super unsafe since we maintain all the safety invariants in the <code>wasmtime</code> crate, especially with reference types.</p>\n</blockquote>",
        "id": 216144629,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604957066
    },
    {
        "content": "<p>bkolobara <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724288387\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Yes, there is a lot going on in the codebase. It will take some time to trim back on the unsafe code. If I manage to construct a minimal reproducible example I will post an update. Thanks everyone for taking the time and looking into this!</p>\n</blockquote>",
        "id": 216144855,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1604957213
    },
    {
        "content": "<p>bkolobara <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724659862\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>@alexcrichton @fitzgen thanks again for helping me out with this. I have managed to extract just the problematic part without any unsafe code:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"p\">{</span><span class=\"n\">Config</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ExternRef</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Linker</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Store</span><span class=\"p\">,};</span><span class=\"w\"></span>\n\n<span class=\"k\">fn</span> <span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Config</span>::<span class=\"n\">new</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"n\">wasm_reference_types</span><span class=\"p\">(</span><span class=\"kc\">true</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">engine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Engine</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">config</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Module</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"</span>\n<span class=\"s\">    (module</span>\n<span class=\"s\">        (type (;0;) (func (result i32)))</span>\n<span class=\"s\">        (type (;1;) (func (param i32 i32 i64) (result externref)))</span>\n<span class=\"s\">        (type (;2;) (func (param i32 i32 i64) (result i32)))</span>\n<span class=\"s\">        (type (;3;) (func (param externref) (result i32)))</span>\n<span class=\"s\">        (type (;4;) (func))</span>\n\n<span class=\"s\">        (import </span><span class=\"se\">\\\"</span><span class=\"s\">test</span><span class=\"se\">\\\"</span><span class=\"s\"> </span><span class=\"se\">\\\"</span><span class=\"s\">spawn</span><span class=\"se\">\\\"</span><span class=\"s\"> (func $spawn (type 1)))</span>\n\n<span class=\"s\">        (func $_start (type 4)</span>\n<span class=\"s\">            (local i32)</span>\n\n<span class=\"s\">            i32.const 10000</span>\n<span class=\"s\">            local.set 0</span>\n<span class=\"s\">            loop  ;; label = @1</span>\n<span class=\"s\">                i32.const 4</span>\n<span class=\"s\">                i32.const 0</span>\n<span class=\"s\">                i64.const 0</span>\n<span class=\"s\">                call $externref_wrapper_for_spawn</span>\n<span class=\"s\">                drop</span>\n<span class=\"s\">                local.get 0</span>\n<span class=\"s\">                i32.const -1</span>\n<span class=\"s\">                i32.add</span>\n<span class=\"s\">                local.tee 0</span>\n<span class=\"s\">                br_if 0 (;@1;)</span>\n<span class=\"s\">            end)</span>\n\n<span class=\"s\">        (func $preserve_externref_in_table (type 3) (param externref) (result i32)</span>\n<span class=\"s\">            (local i32)</span>\n<span class=\"s\">            i32.const 0</span>\n<span class=\"s\">            local.tee 1</span>\n<span class=\"s\">            table.size $externref_table</span>\n<span class=\"s\">            i32.eq</span>\n<span class=\"s\">            if (result i32)  ;; label = @1</span>\n<span class=\"s\">              ref.null extern</span>\n<span class=\"s\">              table.size $externref_table</span>\n<span class=\"s\">              table.grow $externref_table</span>\n<span class=\"s\">            else</span>\n<span class=\"s\">              local.get 1</span>\n<span class=\"s\">            end</span>\n<span class=\"s\">            local.get 0</span>\n<span class=\"s\">            table.set $externref_table</span>\n<span class=\"s\">            local.get 1)</span>\n\n<span class=\"s\">        (func $externref_wrapper_for_spawn (type 2) (param i32 i32 i64) (result i32)</span>\n<span class=\"s\">            local.get 0</span>\n<span class=\"s\">            local.get 1</span>\n<span class=\"s\">            local.get 2</span>\n<span class=\"s\">            call $spawn</span>\n<span class=\"s\">            call $preserve_externref_in_table)</span>\n\n<span class=\"s\">        (table $externref_table 4 externref)</span>\n<span class=\"s\">        (export </span><span class=\"se\">\\\"</span><span class=\"s\">_start</span><span class=\"se\">\\\"</span><span class=\"s\"> (func $_start))</span>\n<span class=\"s\">    )\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">store</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Store</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">.</span><span class=\"n\">clone</span><span class=\"p\">());</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">linker</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Linker</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">store</span><span class=\"p\">);</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">linker</span><span class=\"p\">.</span><span class=\"n\">func</span><span class=\"p\">(</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"s\">\"test\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"s\">\"spawn\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"k\">move</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">index</span>: <span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument1</span>: <span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument2</span>: <span class=\"kt\">i64</span><span class=\"o\">|</span><span class=\"w\"> </span>-&gt; <span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">ExternRef</span>::<span class=\"n\">new</span><span class=\"p\">((</span><span class=\"n\">index</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument2</span><span class=\"p\">)))</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"p\">},</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">linker</span><span class=\"p\">.</span><span class=\"n\">instantiate</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">module</span><span class=\"p\">.</span><span class=\"n\">clone</span><span class=\"p\">()).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">start</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"p\">.</span><span class=\"n\">get_func</span><span class=\"p\">(</span><span class=\"s\">\"_start\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">start</span><span class=\"p\">.</span><span class=\"n\">call</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"p\">[]).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>This fails on <code>wasmtime = \"0.21\"</code> on my Macbook with </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">every</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"o\">-</span><span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">externref</span><span class=\"w\"> </span><span class=\"n\">inside</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Wasm</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"w\"> </span><span class=\"n\">should</span><span class=\"w\"> </span><span class=\"n\">have</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">entry</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">VMExternRefActivationsTable</span><span class=\"o\">'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n   <span class=\"mi\">0</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">backtrace_rs</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">hb4ff9014ec5817b3</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/../../</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">100</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">1</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">backtrace_rs</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span>::<span class=\"n\">h0d03cf0f7c5d8d01</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/../../</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">2</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print_fmt</span>::<span class=\"n\">h5b2bf2921eea85ae</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">67</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">3</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print</span>::<span class=\"n\">DisplayBacktrace</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">fmt</span>::<span class=\"n\">Display</span><span class=\"o\">&gt;</span>::<span class=\"n\">fmt</span>::<span class=\"n\">h808cc0fc691f5922</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">46</span>:<span class=\"mi\">22</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">4</span>:        <span class=\"mh\">0x10d789660</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">fmt</span>::<span class=\"n\">write</span>::<span class=\"n\">h0ce880d33cd2a300</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">fmt</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1076</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">5</span>:        <span class=\"mh\">0x10d767906</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">io</span>::<span class=\"n\">Write</span>::<span class=\"n\">write_fmt</span>::<span class=\"n\">h057e6b5365b25cdb</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">io</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1516</span>:<span class=\"mi\">15</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">6</span>:        <span class=\"mh\">0x10d76c459</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print</span>::<span class=\"n\">ha1932a5f36d2b146</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">49</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">7</span>:        <span class=\"mh\">0x10d76c459</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">print</span>::<span class=\"n\">had07999cb13bdf77</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">36</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">8</span>:        <span class=\"mh\">0x10d76c459</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">default_hook</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">hcbe1ecfff77305a1</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">208</span>:<span class=\"mi\">50</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">9</span>:        <span class=\"mh\">0x10d76c11d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">default_hook</span>::<span class=\"n\">h8422621c02c35b35</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">227</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">10</span>:        <span class=\"mh\">0x10d76ca2b</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">rust_panic_with_hook</span>::<span class=\"n\">h82b76d3adf4cbc3a</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">577</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">11</span>:        <span class=\"mh\">0x10d6da1e7</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h610cb27706798e28</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">506</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">12</span>:        <span class=\"mh\">0x10d6dcfb8</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">__rust_end_short_backtrace</span>::<span class=\"n\">h02cad55c8fedcf0f</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">141</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">13</span>:        <span class=\"mh\">0x10d79ea57</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span>::<span class=\"n\">h00999f2b800d5901</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">505</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">14</span>:        <span class=\"mh\">0x10d258ab0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">hb874548da7bd3130</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">15</span>:        <span class=\"mh\">0x10d293797</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"n\">impls</span>::<span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"nb\">FnMut</span><span class=\"o\">&lt;</span><span class=\"n\">A</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">&gt;</span>::<span class=\"n\">call_mut</span>::<span class=\"n\">h49b4b17374a4fb04</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ops</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">269</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">16</span>:        <span class=\"mh\">0x10d29356e</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">trace_fn</span>::<span class=\"n\">h5adea0a7301c455e</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">112</span>:<span class=\"mi\">26</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">17</span>:     <span class=\"mh\">0x7fff67d3313f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">__Unwind_Backtrace</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">18</span>:        <span class=\"mh\">0x10d269d1d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">hb7d773b2da24a258</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">100</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">19</span>:        <span class=\"mh\">0x10d269d1d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span>::<span class=\"n\">h51fd14a962d6e2bc</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">20</span>:        <span class=\"mh\">0x10d269de0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace</span>::<span class=\"n\">h87a228ab8df6eb34</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">53</span>:<span class=\"mi\">14</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">21</span>:        <span class=\"mh\">0x10d258340</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"n\">he8a9e6a7fbc383cf</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1054</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">22</span>:        <span class=\"mh\">0x10d256eec</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">gc_and_insert_slow</span>::<span class=\"n\">h9889192c254632da</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">585</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">23</span>:        <span class=\"mh\">0x10cba3d13</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">insert_with_gc</span>::<span class=\"n\">hd1333067f4a1dc90</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">575</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">24</span>:        <span class=\"mh\">0x10cba38fb</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">core</span>::<span class=\"n\">option</span>::<span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">wasmtime</span>::<span class=\"k\">ref</span>::<span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmTy</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_arg</span>::<span class=\"n\">hf23e691b1199274e</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1238</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">25</span>:        <span class=\"mh\">0x10cba5175</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmRet</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_ret</span>::<span class=\"n\">hb931fe5db644ccb7</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1350</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">26</span>:        <span class=\"mh\">0x10cba9d80</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,</span><span class=\"n\">A1</span><span class=\"p\">,</span><span class=\"n\">A2</span><span class=\"p\">,</span><span class=\"n\">A3</span><span class=\"p\">),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">wasm_to_host_shim</span>::<span class=\"n\">h933e81e93c4f6514</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1624</span>:<span class=\"mi\">29</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">27</span>:        <span class=\"mh\">0x10ec1a22e</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">28</span>:        <span class=\"mh\">0x10ec1a0b1</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">29</span>:        <span class=\"mh\">0x10ec1a357</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">30</span>:        <span class=\"mh\">0x10cbeaaac</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h0b827b767c43434d</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">620</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">31</span>:        <span class=\"mh\">0x10cc272c1</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"n\">call_closure</span>::<span class=\"n\">h0433cee3ab91db78</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">397</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">32</span>:        <span class=\"mh\">0x10d28f276</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">RegisterSetjmp</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">b</span><span class=\"w\"></span>\n<span class=\"p\">[</span><span class=\"n\">message</span><span class=\"w\"> </span><span class=\"n\">truncated</span><span class=\"p\">]</span><span class=\"w\"></span>\n</code></pre></div>\n</blockquote>",
        "id": 216201907,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1605009945
    },
    {
        "content": "<p>bkolobara edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724659862\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>@alexcrichton @fitzgen thanks again for helping me out with this. I have managed to extract just the problematic part without any unsafe code:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"p\">{</span><span class=\"n\">Config</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ExternRef</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Linker</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Store</span><span class=\"p\">,};</span><span class=\"w\"></span>\n\n<span class=\"k\">fn</span> <span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Config</span>::<span class=\"n\">new</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"n\">wasm_reference_types</span><span class=\"p\">(</span><span class=\"kc\">true</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">engine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Engine</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">config</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Module</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"</span>\n<span class=\"s\">    (module</span>\n<span class=\"s\">        (type (;0;) (func (result i32)))</span>\n<span class=\"s\">        (type (;1;) (func (param i32 i32 i64) (result externref)))</span>\n<span class=\"s\">        (type (;2;) (func (param i32 i32 i64) (result i32)))</span>\n<span class=\"s\">        (type (;3;) (func (param externref) (result i32)))</span>\n<span class=\"s\">        (type (;4;) (func))</span>\n\n<span class=\"s\">        (import </span><span class=\"se\">\\\"</span><span class=\"s\">test</span><span class=\"se\">\\\"</span><span class=\"s\"> </span><span class=\"se\">\\\"</span><span class=\"s\">spawn</span><span class=\"se\">\\\"</span><span class=\"s\"> (func $spawn (type 1)))</span>\n\n<span class=\"s\">        (func $_start (type 4)</span>\n<span class=\"s\">            (local i32)</span>\n\n<span class=\"s\">            i32.const 10000</span>\n<span class=\"s\">            local.set 0</span>\n<span class=\"s\">            loop  ;; label = @1</span>\n<span class=\"s\">                i32.const 4</span>\n<span class=\"s\">                i32.const 0</span>\n<span class=\"s\">                i64.const 0</span>\n<span class=\"s\">                call $externref_wrapper_for_spawn</span>\n<span class=\"s\">                drop</span>\n<span class=\"s\">                local.get 0</span>\n<span class=\"s\">                i32.const -1</span>\n<span class=\"s\">                i32.add</span>\n<span class=\"s\">                local.tee 0</span>\n<span class=\"s\">                br_if 0 (;@1;)</span>\n<span class=\"s\">            end)</span>\n\n<span class=\"s\">        (func $preserve_externref_in_table (type 3) (param externref) (result i32)</span>\n<span class=\"s\">            (local i32)</span>\n<span class=\"s\">            i32.const 0</span>\n<span class=\"s\">            local.tee 1</span>\n<span class=\"s\">            table.size $externref_table</span>\n<span class=\"s\">            i32.eq</span>\n<span class=\"s\">            if (result i32)  ;; label = @1</span>\n<span class=\"s\">              ref.null extern</span>\n<span class=\"s\">              table.size $externref_table</span>\n<span class=\"s\">              table.grow $externref_table</span>\n<span class=\"s\">            else</span>\n<span class=\"s\">              local.get 1</span>\n<span class=\"s\">            end</span>\n<span class=\"s\">            local.get 0</span>\n<span class=\"s\">            table.set $externref_table</span>\n<span class=\"s\">            local.get 1)</span>\n\n<span class=\"s\">        (func $externref_wrapper_for_spawn (type 2) (param i32 i32 i64) (result i32)</span>\n<span class=\"s\">            local.get 0</span>\n<span class=\"s\">            local.get 1</span>\n<span class=\"s\">            local.get 2</span>\n<span class=\"s\">            call $spawn</span>\n<span class=\"s\">            call $preserve_externref_in_table)</span>\n\n<span class=\"s\">        (table $externref_table 4 externref)</span>\n<span class=\"s\">        (export </span><span class=\"se\">\\\"</span><span class=\"s\">_start</span><span class=\"se\">\\\"</span><span class=\"s\"> (func $_start))</span>\n<span class=\"s\">    )\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">store</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Store</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">.</span><span class=\"n\">clone</span><span class=\"p\">());</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">linker</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Linker</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">store</span><span class=\"p\">);</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">linker</span><span class=\"p\">.</span><span class=\"n\">func</span><span class=\"p\">(</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"s\">\"test\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"s\">\"spawn\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"k\">move</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"n\">index</span>: <span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument1</span>: <span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument2</span>: <span class=\"kt\">i64</span><span class=\"o\">|</span><span class=\"w\"> </span>-&gt; <span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">ExternRef</span>::<span class=\"n\">new</span><span class=\"p\">((</span><span class=\"n\">index</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">argument2</span><span class=\"p\">)))</span><span class=\"w\"></span>\n<span class=\"w\">            </span><span class=\"p\">},</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">linker</span><span class=\"p\">.</span><span class=\"n\">instantiate</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">module</span><span class=\"p\">.</span><span class=\"n\">clone</span><span class=\"p\">()).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">start</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"p\">.</span><span class=\"n\">get_func</span><span class=\"p\">(</span><span class=\"s\">\"_start\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">start</span><span class=\"p\">.</span><span class=\"n\">call</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"p\">[]).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>This fails on <code>wasmtime = \"0.21\"</code> on my Macbook with:</p>\n<p>&lt;details&gt;&lt;summary&gt;Expend stacktrace&lt;/summary&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">every</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"o\">-</span><span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">externref</span><span class=\"w\"> </span><span class=\"n\">inside</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Wasm</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"w\"> </span><span class=\"n\">should</span><span class=\"w\"> </span><span class=\"n\">have</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">entry</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">VMExternRefActivationsTable</span><span class=\"o\">'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n   <span class=\"mi\">0</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">backtrace_rs</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">hb4ff9014ec5817b3</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/../../</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">100</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">1</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">backtrace_rs</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span>::<span class=\"n\">h0d03cf0f7c5d8d01</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/../../</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">2</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print_fmt</span>::<span class=\"n\">h5b2bf2921eea85ae</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">67</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">3</span>:        <span class=\"mh\">0x10d76a664</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print</span>::<span class=\"n\">DisplayBacktrace</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">fmt</span>::<span class=\"n\">Display</span><span class=\"o\">&gt;</span>::<span class=\"n\">fmt</span>::<span class=\"n\">h808cc0fc691f5922</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">46</span>:<span class=\"mi\">22</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">4</span>:        <span class=\"mh\">0x10d789660</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">fmt</span>::<span class=\"n\">write</span>::<span class=\"n\">h0ce880d33cd2a300</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">fmt</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1076</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">5</span>:        <span class=\"mh\">0x10d767906</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">io</span>::<span class=\"n\">Write</span>::<span class=\"n\">write_fmt</span>::<span class=\"n\">h057e6b5365b25cdb</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">io</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1516</span>:<span class=\"mi\">15</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">6</span>:        <span class=\"mh\">0x10d76c459</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print</span>::<span class=\"n\">ha1932a5f36d2b146</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">49</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">7</span>:        <span class=\"mh\">0x10d76c459</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">print</span>::<span class=\"n\">had07999cb13bdf77</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">36</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">8</span>:        <span class=\"mh\">0x10d76c459</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">default_hook</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">hcbe1ecfff77305a1</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">208</span>:<span class=\"mi\">50</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">9</span>:        <span class=\"mh\">0x10d76c11d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">default_hook</span>::<span class=\"n\">h8422621c02c35b35</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">227</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">10</span>:        <span class=\"mh\">0x10d76ca2b</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">rust_panic_with_hook</span>::<span class=\"n\">h82b76d3adf4cbc3a</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">ffa2e7ae8fbf9badc035740db949b9dae271c29f</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">577</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">11</span>:        <span class=\"mh\">0x10d6da1e7</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h610cb27706798e28</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">506</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">12</span>:        <span class=\"mh\">0x10d6dcfb8</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">__rust_end_short_backtrace</span>::<span class=\"n\">h02cad55c8fedcf0f</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">141</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">13</span>:        <span class=\"mh\">0x10d79ea57</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span>::<span class=\"n\">h00999f2b800d5901</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">505</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">14</span>:        <span class=\"mh\">0x10d258ab0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">hb874548da7bd3130</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">15</span>:        <span class=\"mh\">0x10d293797</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"n\">impls</span>::<span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"nb\">FnMut</span><span class=\"o\">&lt;</span><span class=\"n\">A</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">&gt;</span>::<span class=\"n\">call_mut</span>::<span class=\"n\">h49b4b17374a4fb04</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ops</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">269</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">16</span>:        <span class=\"mh\">0x10d29356e</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">trace_fn</span>::<span class=\"n\">h5adea0a7301c455e</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">112</span>:<span class=\"mi\">26</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">17</span>:     <span class=\"mh\">0x7fff67d3313f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">__Unwind_Backtrace</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">18</span>:        <span class=\"mh\">0x10d269d1d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">hb7d773b2da24a258</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">100</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">19</span>:        <span class=\"mh\">0x10d269d1d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span>::<span class=\"n\">h51fd14a962d6e2bc</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">20</span>:        <span class=\"mh\">0x10d269de0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace</span>::<span class=\"n\">h87a228ab8df6eb34</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.51</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">53</span>:<span class=\"mi\">14</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">21</span>:        <span class=\"mh\">0x10d258340</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"n\">he8a9e6a7fbc383cf</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1054</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">22</span>:        <span class=\"mh\">0x10d256eec</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">gc_and_insert_slow</span>::<span class=\"n\">h9889192c254632da</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">585</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">23</span>:        <span class=\"mh\">0x10cba3d13</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">insert_with_gc</span>::<span class=\"n\">hd1333067f4a1dc90</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">575</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">24</span>:        <span class=\"mh\">0x10cba38fb</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">core</span>::<span class=\"n\">option</span>::<span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">wasmtime</span>::<span class=\"k\">ref</span>::<span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmTy</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_arg</span>::<span class=\"n\">hf23e691b1199274e</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1238</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">25</span>:        <span class=\"mh\">0x10cba5175</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmRet</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_ret</span>::<span class=\"n\">hb931fe5db644ccb7</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1350</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">26</span>:        <span class=\"mh\">0x10cba9d80</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,</span><span class=\"n\">A1</span><span class=\"p\">,</span><span class=\"n\">A2</span><span class=\"p\">,</span><span class=\"n\">A3</span><span class=\"p\">),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">wasm_to_host_shim</span>::<span class=\"n\">h933e81e93c4f6514</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1624</span>:<span class=\"mi\">29</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">27</span>:        <span class=\"mh\">0x10ec1a22e</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">28</span>:        <span class=\"mh\">0x10ec1a0b1</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">29</span>:        <span class=\"mh\">0x10ec1a357</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">30</span>:        <span class=\"mh\">0x10cbeaaac</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h0b827b767c43434d</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">620</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">31</span>:        <span class=\"mh\">0x10cc272c1</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"n\">call_closure</span>::<span class=\"n\">h0433cee3ab91db78</span><span class=\"w\"></span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">runtime</span><span class=\"o\">-</span><span class=\"mf\">0.21.0</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">397</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">32</span>:        <span class=\"mh\">0x10d28f276</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">Re</span><span class=\"w\"></span>\n<span class=\"p\">[</span><span class=\"n\">message</span><span class=\"w\"> </span><span class=\"n\">truncated</span><span class=\"p\">]</span><span class=\"w\"></span>\n</code></pre></div>\n</blockquote>",
        "id": 216219944,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1605018992
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-724770850\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Perfect, thanks!</p>\n</blockquote>",
        "id": 216226315,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1605021637
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386#issuecomment-725704782\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>Thanks again for the clear test case! This should be fixed in <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2396\">https://github.com/bytecodealliance/wasmtime/pull/2396</a></p>\n</blockquote>",
        "id": 216407926,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1605135001
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2386\">Issue #2386</a>:</p>\n<blockquote>\n<p>I recently run into a flaky issue running a WASM app using Externrefs under Wasmtime.<br>\nSadly, I can't share any code related to it. Either way it's a lot of code and I'm looking more at pointers how I could debug this further by myself.</p>\n<p><strong>Sometimes</strong> (8 out of 10 runs) the app would panic with the following error:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'&lt;</span><span class=\"n\">unnamed</span><span class=\"o\">&gt;'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">every</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"o\">-</span><span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">externref</span><span class=\"w\"> </span><span class=\"n\">inside</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Wasm</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"w\"> </span><span class=\"n\">should</span><span class=\"w\"> </span><span class=\"n\">have</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"n\">entry</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">VMExternRefActivationsTable</span><span class=\"o\">'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n   <span class=\"mi\">0</span>: <span class=\"nc\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">505</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">1</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1070</span>:<span class=\"mi\">21</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">2</span>: <span class=\"nc\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"n\">impls</span>::<span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"nb\">FnMut</span><span class=\"o\">&lt;</span><span class=\"n\">A</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">&gt;</span>::<span class=\"n\">call_mut</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ops</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">269</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">3</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">trace_fn</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">107</span>:<span class=\"mi\">26</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">4</span>: <span class=\"nc\">__Unwind_Backtrace</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">5</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">95</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">6</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">7</span>: <span class=\"nc\">backtrace</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">cargo</span><span class=\"o\">/</span><span class=\"n\">registry</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">github</span><span class=\"p\">.</span><span class=\"n\">com</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"n\">ecc6299db9ec823</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">-</span><span class=\"mf\">0.3.50</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">53</span>:<span class=\"mi\">14</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">8</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">gc</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1054</span>:<span class=\"mi\">5</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mi\">9</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">gc_and_insert_slow</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">585</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">10</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">externref</span>::<span class=\"n\">VMExternRefActivationsTable</span>::<span class=\"n\">insert_with_gc</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">externref</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">575</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">11</span>: <span class=\"o\">&lt;</span><span class=\"n\">core</span>::<span class=\"n\">option</span>::<span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"n\">wasmtime</span>::<span class=\"k\">ref</span>::<span class=\"n\">ExternRef</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmTy</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_arg</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1238</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">12</span>: <span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">WasmRet</span><span class=\"o\">&gt;</span>::<span class=\"n\">into_abi_for_ret</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1350</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">13</span>: <span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,</span><span class=\"n\">A1</span><span class=\"p\">,</span><span class=\"n\">A2</span><span class=\"p\">,</span><span class=\"n\">A3</span><span class=\"p\">),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">wasm_to_host_shim</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1624</span>:<span class=\"mi\">29</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">14</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">15</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">16</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">17</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">18</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">19</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">20</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">21</span>: <span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">22</span>: <span class=\"o\">&lt;</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">IntoFunc</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Caller</span><span class=\"p\">,),</span><span class=\"n\">R</span><span class=\"o\">&gt;&gt;</span>::<span class=\"n\">into_func</span>::<span class=\"n\">host_trampoline</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1657</span>:<span class=\"mi\">31</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">23</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">620</span>:<span class=\"mi\">17</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">24</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"n\">call_closure</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">397</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">25</span>: <span class=\"nc\">RegisterSetjmp</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">helpers</span><span class=\"p\">.</span><span class=\"n\">c</span>:<span class=\"mi\">12</span>:<span class=\"mi\">3</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">26</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">386</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">27</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">CallThreadState</span>::<span class=\"n\">with</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">442</span>:<span class=\"mi\">38</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">28</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">tls</span>::<span class=\"n\">set</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">682</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">29</span>: <span class=\"nc\">std</span>::<span class=\"n\">thread</span>::<span class=\"n\">local</span>::<span class=\"n\">LocalKey</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span>::<span class=\"n\">try_with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">thread</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">272</span>:<span class=\"mi\">16</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">30</span>: <span class=\"nc\">std</span>::<span class=\"n\">thread</span>::<span class=\"n\">local</span>::<span class=\"n\">LocalKey</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span>::<span class=\"n\">with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">bkolobara</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">rustup</span><span class=\"o\">/</span><span class=\"n\">toolchains</span><span class=\"o\">/</span><span class=\"n\">nightly</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">apple</span><span class=\"o\">-</span><span class=\"n\">darwin</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">rustlib</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">thread</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">248</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">31</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">tls</span>::<span class=\"n\">set</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">674</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">32</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">CallThreadState</span>::<span class=\"n\">with</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">442</span>:<span class=\"mi\">19</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">33</span>: <span class=\"nc\">wasmtime_runtime</span>::<span class=\"n\">traphandlers</span>::<span class=\"n\">catch_traps</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">traphandlers</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">385</span>:<span class=\"mi\">12</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">34</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">invoke_wasm_and_catch_traps</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">829</span>:<span class=\"mi\">9</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">35</span>: <span class=\"nc\">wasmtime</span>::<span class=\"n\">func</span>::<span class=\"n\">Func</span>::<span class=\"n\">call</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">func</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">619</span>:<span class=\"mi\">13</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mi\">36</span>: <span class=\"nc\">lunatic_vm</span>::<span class=\"n\">process</span>::<span class=\"n\">Process</span>::<span class=\"n\">spawn</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span><span class=\"w\"></span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">process</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">160</span>:<span class=\"mi\">25</span><span class=\"w\"></span>\n<span class=\"o\">....</span><span class=\"w\"></span>\n</code></pre></div>\n<p>The code path taken by the app should always be the same and first of all I can't figure out why it only fails sometimes. Any pointers would be appreciated. </p>\n</blockquote>",
        "id": 216515468,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1605209041
    }
]