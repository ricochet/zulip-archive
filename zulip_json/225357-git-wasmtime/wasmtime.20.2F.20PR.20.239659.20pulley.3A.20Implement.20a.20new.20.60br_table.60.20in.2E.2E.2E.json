[
    {
        "content": "<p>alexcrichton opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a> from <code>alexcrichton:pulley-br-table</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>This is intended to match WebAssembly's <code>br_table</code> and Cranelift's version as well. This is implemented as a new <code>br_table32</code> opcode where a 32-bit number of branch targets are encoded after <code>br_table32</code> all as a <code>PcRelOffset</code>, a 32-bit offset. This helps bake in a more \"macro opcode\" into the interpreter rather than a handful of more primitive opcodes that would achieve the same result with loads/indirect jumps/comparisons/etc.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 483987861,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732307997
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/abrown\">abrown</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 483987863,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732307997
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 483987864,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732307997
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/pchickey\">pchickey</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 483987867,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732307998
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 483987868,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732307998
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers\">wasmtime-default-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 483987870,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732307999
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 483988324,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732308166
    },
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#issuecomment-2494911151\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @cfallin, @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"cranelift\", \"isle\", \"pulley\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>cfallin: isle</li>\n<li>fitzgen: isle, pulley</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 483996120,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732311883
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 484004642,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732316315
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 484004993,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732316505
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 484006049,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732317053
    },
    {
        "content": "<p>abrown submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459518409\">PR review</a>.</p>",
        "id": 484384654,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732566677
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857288098\">PR review comment</a>:</p>\n<blockquote>\n<p>This is confusing: if Pulley is an interpreter, we're not going to need an island for the same reasons we did during JIT compilation. I haven't looked below, but typically an interpreter sets the <code>pc</code>, the dispatch loop loads the bytecode at <code>pc</code>, etc. We don't have to jump an arbitrary <code>u32</code> amount. Or is there something that I don't understand here about the tail-calling version of Pulley?</p>\n</blockquote>",
        "id": 484384655,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732566677
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857300164\">PR review comment</a>:</p>\n<blockquote>\n<p>It seems like we're trying to only have the targets of jumps be prefixed by address labels but then the test output ends up printing labels for everything after <code>0x33</code>?</p>\n</blockquote>",
        "id": 484384656,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732566677
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857276941\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>    ;; jumps to `default` if it's out-of-bounds.\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 484384657,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732566677
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857308768\">PR review comment</a>:</p>\n<blockquote>\n<p>Not having worked on Pulley from the beginning, I'm stepping out on a limb here: it's worrying that once we introduce mutable state during codegen (and later during disassembly) we will have difficulty going back from this. This feels like a better discussion to have with @fitzgen since he may have stronger opinions about this (or not).</p>\n</blockquote>",
        "id": 484384658,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732566677
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 484402467,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732574598
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459787313\">PR review</a>.</p>",
        "id": 484403194,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732574893
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857441268\">PR review comment</a>:</p>\n<blockquote>\n<p>Heh your confusion is not unwarranted! Pulley is roughly modeled after our existing backends which is why this is still a problem. For example a jump will be \"jump this distance forward or backward\" in the bytecode stream (e.g. relative offset to pc). The jumps may have limited distance like other backends (right now they're all 32-bit jumps though) which is why islands might be necessary. Basically Pulley still has the same issues as other backends in terms of handling jumps b/c it's all relative to the current <code>pc</code> like native code and we'll probably add smaller-than-32-bit jumps at some point.</p>\n</blockquote>",
        "id": 484403196,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732574893
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459789414\">PR review</a>.</p>",
        "id": 484403430,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732574997
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857442618\">PR review comment</a>:</p>\n<blockquote>\n<p>Yeah the idea is that only the initial line has an offset and the others don't for multi-line instructions. The behavior in the test has to do with how the test disassembly tries to omit instruction offsets but then includes instruction offsets if they might be targets of a jump (so it's known where a jump is going). The logic is relatively primitive though and falls down quickly, so the all-offsets-after-0x33 isn't a result of this logic but is something preexisting.</p>\n</blockquote>",
        "id": 484403432,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732574998
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459790156\">PR review</a>.</p>",
        "id": 484403551,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732575036
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857443081\">PR review comment</a>:</p>\n<blockquote>\n<p>FWIW this is modeled after the <a href=\"https://github.com/bytecodealliance/wasmtime/blob/2af831a6defed4378a0c6a324d9ecd5fbab58eff/cranelift/codegen/src/isa/aarch64/inst/emit.rs#L720\">aarch64 backend</a></p>\n</blockquote>",
        "id": 484403552,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1732575036
    },
    {
        "content": "<p>abrown submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2473605670\">PR review</a>.</p>",
        "id": 485688681,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1733165479
    },
    {
        "content": "<p>abrown created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1866416951\">PR review comment</a>:</p>\n<blockquote>\n<p>Ok, if you're saying \"we need islands for programs with more than 4GB of Pulley bytecode\" I think I see what you mean. But... it also doesn't seem unreasonable to disallow that and avoid the island complexity. You're in the middle of this so you have a better handle on this; leaving it up to you!</p>\n</blockquote>",
        "id": 485688682,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1733165479
    },
    {
        "content": "<p>abrown submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2473608110\">PR review</a>:</p>\n<blockquote>\n<p>I don't want to stand in the way of progress: Pulley is getting better!</p>\n</blockquote>",
        "id": 485688837,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1733165531
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2473663511\">PR review</a>.</p>",
        "id": 485690204,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1733166059
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1866453269\">PR review comment</a>:</p>\n<blockquote>\n<p>For now yeah that's definitely the constraint, in the future though I think we might add 8-bit or smaller jump targets  in which case we'd definitely want the island bits. So in some sense this is future-proofing if not maintaining consistency across the backends.</p>\n</blockquote>",
        "id": 485690206,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1733166060
    },
    {
        "content": "<p>alexcrichton merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/9659\">PR #9659</a>.</p>",
        "id": 485693066,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1733167050
    }
]