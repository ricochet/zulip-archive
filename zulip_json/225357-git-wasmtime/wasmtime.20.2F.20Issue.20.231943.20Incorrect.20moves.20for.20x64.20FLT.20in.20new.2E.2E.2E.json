[
    {
        "content": "<p>jlb6740 edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1943\">Issue #1943</a>:</p>\n<blockquote>\n<p>@bnjbvr @julian-seward1</p>\n<p>Hi, I believe the recent patch <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1915\">https://github.com/bytecodealliance/wasmtime/pull/1915</a> introduce different behavior with register allocation. Before the patch a floating point add lowered to this:</p>\n<blockquote>\n<p>Disassembly of 10 bytes:<br>\n   0:   55                      push    rbp<br>\n   1:   48 89 e5                mov     rbp, rsp<br>\n   4:   f3 0f 58 c1             addss   xmm0, xmm1<br>\n   8:   5d                      pop     rbp<br>\n   9:   c3                      ret</p>\n</blockquote>\n<p>But afterwards it lowered to this:</p>\n<blockquote>\n<p>Disassembly of 18 bytes:<br>\n   0:   55                      push    rbp<br>\n   1:   48 89 e5                mov     rbp, rsp<br>\n   4:   f3 0f 10 c8             movss   xmm1, xmm0<br>\n   8:   f3 0f 58 c8             addss   xmm1, xmm0<br>\n   c:   f3 0f 10 c1             movss   xmm0, xmm1<br>\n  10:   5d                      pop     rbp<br>\n  11:   c3                      ret</p>\n</blockquote>\n<p>It is not clear to me what change in this patch introduces these moves nor how to fix them. Any suggestions?</p>\n</blockquote>",
        "id": 202468151,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1593537740
    }
]