[
    {
        "content": "<p>vedantroy opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547\">Issue #1547</a>:</p>\n<blockquote>\n<p>Thanks for opening a bug report! Please answer the questions below<br>\nif they're relevant and delete this text before submitting.</p>\n<p>Run the following file in wasmtime 0.15.0 and in whatever version of wasmer is installed with <code>curl https://get.wasmer.io -sSfL | sh</code></p>\n<p>wasmer prints the expected output:</p>\n<div class=\"codehilite\"><pre><span></span>no foo.\nbar\n</pre></div>\n\n\n<p>wasmtime prints nothing</p>\n<div class=\"codehilite\"><pre><span></span>;; Taken from: https://github.com/bytecodealliance/wasmtime/blob/master/docs/WASI-tutorial.md and modified\n(module\n    (import &quot;wasi_snapshot_preview1&quot; &quot;fd_write&quot; (func $fd_write (param i32 i32 i32 i32) (result i32)))\n\n    (memory 1)\n\n    (data (i32.const 1024) &quot;no foo.\\nbar\\n&quot;)\n\n    (func $print_msg (param $array_ptr i32)\n        (call $fd_write\n          (i32.const 1) ;; file descriptor\n          (local.get $array_ptr) ;; pointer to first iovec in array\n          (i32.const 1) ;; len of array\n          (i32.const 2048) ;; place to write number of bytes written\n        )\n        drop\n    )\n\n    (func $main (export &quot;_start&quot;)\n        ;; Creating a new io vector within linear memory\n        (i32.store (i32.const 0) (i32.const 1024))\n        (i32.store (i32.const 4) (i32.const 8))\n\n        (i32.store (i32.const 8) (i32.const 1032))\n        (i32.store (i32.const 12) (i32.const 4))\n\n        (call $print_msg (i32.const 0))\n        (call $print_msg (i32.const 8))\n    )\n)\n</pre></div>\n\n\n</blockquote>",
        "id": 194492341,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1587153505
    },
    {
        "content": "<p>vedantroy labeled <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547\">Issue #1547</a>:</p>\n<blockquote>\n<p>Thanks for opening a bug report! Please answer the questions below<br>\nif they're relevant and delete this text before submitting.</p>\n<p>Run the following file in wasmtime 0.15.0 and in whatever version of wasmer is installed with <code>curl https://get.wasmer.io -sSfL | sh</code></p>\n<p>wasmer prints the expected output:</p>\n<div class=\"codehilite\"><pre><span></span>no foo.\nbar\n</pre></div>\n\n\n<p>wasmtime prints nothing</p>\n<div class=\"codehilite\"><pre><span></span>;; Taken from: https://github.com/bytecodealliance/wasmtime/blob/master/docs/WASI-tutorial.md and modified\n(module\n    (import &quot;wasi_snapshot_preview1&quot; &quot;fd_write&quot; (func $fd_write (param i32 i32 i32 i32) (result i32)))\n\n    (memory 1)\n\n    (data (i32.const 1024) &quot;no foo.\\nbar\\n&quot;)\n\n    (func $print_msg (param $array_ptr i32)\n        (call $fd_write\n          (i32.const 1) ;; file descriptor\n          (local.get $array_ptr) ;; pointer to first iovec in array\n          (i32.const 1) ;; len of array\n          (i32.const 2048) ;; place to write number of bytes written\n        )\n        drop\n    )\n\n    (func $main (export &quot;_start&quot;)\n        ;; Creating a new io vector within linear memory\n        (i32.store (i32.const 0) (i32.const 1024))\n        (i32.store (i32.const 4) (i32.const 8))\n\n        (i32.store (i32.const 8) (i32.const 1032))\n        (i32.store (i32.const 12) (i32.const 4))\n\n        (call $print_msg (i32.const 0))\n        (call $print_msg (i32.const 8))\n    )\n)\n</pre></div>\n\n\n</blockquote>",
        "id": 194492342,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1587153505
    },
    {
        "content": "<p>vedantroy edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547\">Issue #1547</a>:</p>\n<blockquote>\n<p>Run the following file in wasmtime 0.15.0 and in whatever version of wasmer is installed with <code>curl https://get.wasmer.io -sSfL | sh</code></p>\n<p>wasmer prints the expected output:</p>\n<div class=\"codehilite\"><pre><span></span>no foo.\nbar\n</pre></div>\n\n\n<p>wasmtime prints nothing</p>\n<div class=\"codehilite\"><pre><span></span>;; Taken from: https://github.com/bytecodealliance/wasmtime/blob/master/docs/WASI-tutorial.md and modified\n(module\n    (import &quot;wasi_snapshot_preview1&quot; &quot;fd_write&quot; (func $fd_write (param i32 i32 i32 i32) (result i32)))\n\n    (memory 1)\n\n    (data (i32.const 1024) &quot;no foo.\\nbar\\n&quot;)\n\n    (func $print_msg (param $array_ptr i32)\n        (call $fd_write\n          (i32.const 1) ;; file descriptor\n          (local.get $array_ptr) ;; pointer to first iovec in array\n          (i32.const 1) ;; len of array\n          (i32.const 2048) ;; place to write number of bytes written\n        )\n        drop\n    )\n\n    (func $main (export &quot;_start&quot;)\n        ;; Creating a new io vector within linear memory\n        (i32.store (i32.const 0) (i32.const 1024))\n        (i32.store (i32.const 4) (i32.const 8))\n\n        (i32.store (i32.const 8) (i32.const 1032))\n        (i32.store (i32.const 12) (i32.const 4))\n\n        (call $print_msg (i32.const 0))\n        (call $print_msg (i32.const 8))\n    )\n)\n</pre></div>\n\n\n</blockquote>",
        "id": 194492362,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1587153518
    },
    {
        "content": "<p>vedantroy edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547\">Issue #1547</a>:</p>\n<blockquote>\n<p>Run the following file in wasmtime 0.15.0 and in whatever version of wasmer is installed with <code>curl https://get.wasmer.io -sSfL | sh</code></p>\n<p>wasmer prints the expected output:</p>\n<div class=\"codehilite\"><pre><span></span>no foo.\nbar\n</pre></div>\n\n\n<p>wasmtime prints nothing</p>\n<div class=\"codehilite\"><pre><span></span>;; Taken from: https://github.com/bytecodealliance/wasmtime/blob/master/docs/WASI-tutorial.md and modified\n(module\n    (import &quot;wasi_snapshot_preview1&quot; &quot;fd_write&quot; (func $fd_write (param i32 i32 i32 i32) (result i32)))\n\n    (memory 1)\n\n    (data (i32.const 1024) &quot;no foo.\\nbar\\n&quot;)\n\n    (func $print_msg (param $array_ptr i32)\n        (call $fd_write\n          (i32.const 1) ;; file descriptor\n          (local.get $array_ptr) ;; pointer to first iovec in array\n          (i32.const 1) ;; len of array\n          (i32.const 2048) ;; place to write number of bytes written\n        )\n        drop\n    )\n\n    (func $main (export &quot;_start&quot;)\n        ;; Creating a new io vector within linear memory\n        (i32.store (i32.const 0) (i32.const 1024))\n        (i32.store (i32.const 4) (i32.const 8))\n\n        (i32.store (i32.const 8) (i32.const 1032))\n        (i32.store (i32.const 12) (i32.const 4))\n\n        (call $print_msg (i32.const 0))\n        (call $print_msg (i32.const 8))\n    )\n)\n</pre></div>\n\n\n<p>I assume the issue is with wasmtime.</p>\n</blockquote>",
        "id": 194492388,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1587153531
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547#issuecomment-615443664\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547#issuecomment-615443664\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547\">Issue #1547</a>:</p>\n<blockquote>\n<p>Thanks for the report! The issue here is that the wasm linear memory isn't exported, but it's expected to be exported for wasi to work with it. You can fix this by replacing <code>(memory 1)</code> with <code>(memory (export \"memory\") 1)</code>.</p>\n<p>The exact particulars here are a little up-in-the-air since historically wasi implementations would use a memory without requiring it be exported, but semantically that felt a little odd and we tweaked it to require an export. The <code>fd_write</code> call in the example you've written is returning an error because <code>memory</code> isn't exported, but the error is being ignored.</p>\n</blockquote>",
        "id": 194494192,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1587154422
    },
    {
        "content": "<p>alexcrichton labeled <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1547\" title=\"https://github.com/bytecodealliance/wasmtime/issues/1547\">Issue #1547</a>:</p>\n<blockquote>\n<p>Run the following file in wasmtime 0.15.0 and in whatever version of wasmer is installed with <code>curl https://get.wasmer.io -sSfL | sh</code></p>\n<p>wasmer prints the expected output:</p>\n<div class=\"codehilite\"><pre><span></span>no foo.\nbar\n</pre></div>\n\n\n<p>wasmtime prints nothing</p>\n<div class=\"codehilite\"><pre><span></span>;; Taken from: https://github.com/bytecodealliance/wasmtime/blob/master/docs/WASI-tutorial.md and modified\n(module\n    (import &quot;wasi_snapshot_preview1&quot; &quot;fd_write&quot; (func $fd_write (param i32 i32 i32 i32) (result i32)))\n\n    (memory 1)\n\n    (data (i32.const 1024) &quot;no foo.\\nbar\\n&quot;)\n\n    (func $print_msg (param $array_ptr i32)\n        (call $fd_write\n          (i32.const 1) ;; file descriptor\n          (local.get $array_ptr) ;; pointer to first iovec in array\n          (i32.const 1) ;; len of array\n          (i32.const 2048) ;; place to write number of bytes written\n        )\n        drop\n    )\n\n    (func $main (export &quot;_start&quot;)\n        ;; Creating a new io vector within linear memory\n        (i32.store (i32.const 0) (i32.const 1024))\n        (i32.store (i32.const 4) (i32.const 8))\n\n        (i32.store (i32.const 8) (i32.const 1032))\n        (i32.store (i32.const 12) (i32.const 4))\n\n        (call $print_msg (i32.const 0))\n        (call $print_msg (i32.const 8))\n    )\n)\n</pre></div>\n\n\n<p>I assume the issue is with wasmtime.</p>\n</blockquote>",
        "id": 194494207,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1587154430
    }
]