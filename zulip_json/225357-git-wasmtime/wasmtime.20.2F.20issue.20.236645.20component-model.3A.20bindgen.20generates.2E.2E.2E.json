[
    {
        "content": "<p>xxchan edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645\">issue #6645</a>:</p>\n<blockquote>\n<p>I have WIT definitions like this:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">abc</span>: <span class=\"nc\">self</span><span class=\"p\">.</span><span class=\"n\">abc</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">interface</span><span class=\"w\"> </span><span class=\"n\">abc</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"k\">type</span> <span class=\"nc\">column</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">list</span><span class=\"o\">&lt;</span><span class=\"kt\">u8</span><span class=\"o\">&gt;</span>\n\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">record</span><span class=\"o\">-</span><span class=\"n\">batch</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">schema</span>: <span class=\"nc\">schema</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"c1\">// columns: list&lt;array-data&gt;,</span>\n<span class=\"w\">    </span><span class=\"n\">columns</span>: <span class=\"nc\">list</span><span class=\"o\">&lt;</span><span class=\"n\">column</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"c1\">// row-count: u32,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"k\">enum</span> <span class=\"nc\">data</span><span class=\"o\">-</span><span class=\"k\">type</span> <span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">i16</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">i32</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">i64</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">bool</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"n\">string</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">name</span>: <span class=\"nc\">string</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">data</span><span class=\"o\">-</span><span class=\"k\">type</span>: <span class=\"nc\">data</span><span class=\"o\">-</span><span class=\"k\">type</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">schema</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">fields</span>: <span class=\"nc\">list</span><span class=\"o\">&lt;</span><span class=\"n\">field</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"k\">enum</span> <span class=\"nc\">eval</span><span class=\"o\">-</span><span class=\"n\">errno</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">err1</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"n\">eval</span>: <span class=\"nc\">func</span><span class=\"p\">(</span><span class=\"n\">batch</span>: <span class=\"nc\">record</span><span class=\"o\">-</span><span class=\"n\">batch</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"nc\">result</span><span class=\"o\">&lt;</span><span class=\"n\">column</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">eval</span><span class=\"o\">-</span><span class=\"n\">errno</span><span class=\"o\">&gt;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>wasmtime generates <code>RecordBatch&lt;'a&gt;</code>, </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"cp\">#[derive(wasmtime::component::ComponentType, wasmtime::component::Lower)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[component(record)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Field</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"name\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">name</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">a</span> <span class=\"kt\">str</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"data-type\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">data_type</span>: <span class=\"nc\">DataType</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"cp\">#[derive(wasmtime::component::ComponentType, wasmtime::component::Lower)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[component(record)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Schema</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"fields\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">fields</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">a</span> <span class=\"p\">[</span><span class=\"n\">Field</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"p\">],</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">Column</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"kt\">u8</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n\n<span class=\"w\">    </span><span class=\"cp\">#[derive(wasmtime::component::ComponentType, wasmtime::component::Lower)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[component(record)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">RecordBatch</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"schema\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">schema</span>: <span class=\"nc\">Schema</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"columns\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">columns</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">a</span> <span class=\"p\">[</span><span class=\"o\">&amp;'</span><span class=\"na\">a</span><span class=\"w\"> </span><span class=\"n\">Column</span><span class=\"p\">],</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>while wit-bindgen generates <code>RecordBatch</code></p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Field</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">      </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">name</span>:<span class=\"nc\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">string</span>::<span class=\"nb\">String</span><span class=\"p\">,</span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">data_type</span>:<span class=\"nc\">DataType</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Schema</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">      </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">fields</span>:<span class=\"nc\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">vec</span>::<span class=\"nb\">Vec</span>::<span class=\"o\">&lt;</span><span class=\"n\">Field</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">Column</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">vec</span>::<span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"kt\">u8</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">RecordBatch</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">schema</span>: <span class=\"nc\">Schema</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">columns</span>: <span class=\"nc\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">vec</span>::<span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"n\">Column</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>Is this expected? I don't quite understand the reason and the lifetimes are not easy to work with <span aria-label=\"oh no\" class=\"emoji emoji-1f615\" role=\"img\" title=\"oh no\">:oh_no:</span></p>\n</blockquote>",
        "id": 369977521,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1687857660
    },
    {
        "content": "<p>xxchan <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645#issuecomment-1609123307\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645\">issue #6645</a>:</p>\n<blockquote>\n<p>I'm using</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"https://github.com/bytecodealliance/wasmtime\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"5b93cdb\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">features</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"w\">    </span><span class=\"s\">\"component-model\"</span><span class=\"p\">,</span>\n<span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">}</span>\n<span class=\"n\">wit</span><span class=\"o\">-</span><span class=\"n\">bindgen</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"0.6.0\"</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 369978757,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1687857882
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645#issuecomment-1609646585\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645\">issue #6645</a>:</p>\n<blockquote>\n<p>This is an old feature which I don't think makes sense any more and I believe @dicej is working on making the bindgen more like wit-bindgen.</p>\n</blockquote>",
        "id": 370090735,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1687876833
    },
    {
        "content": "<p>dicej <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645#issuecomment-1609969803\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645\">issue #6645</a>:</p>\n<blockquote>\n<p>This is the PR: <a href=\"https://github.com/bytecodealliance/wasmtime/pull/6648\">https://github.com/bytecodealliance/wasmtime/pull/6648</a>.  It actually makes <code>wasmtime-wit-bindgen</code> _less_ like <code>wit-bindgen</code>, but I'm planning to make another PR for the latter to make them behave the same if we have consensus on what that behavior should be.</p>\n</blockquote>",
        "id": 370155980,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1687888318
    },
    {
        "content": "<p>xxchan <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645#issuecomment-1610101551\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645\">issue #6645</a>:</p>\n<blockquote>\n<p>Thanks for your work! </p>\n</blockquote>",
        "id": 370184018,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1687894328
    },
    {
        "content": "<p>xxchan closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/6645\">issue #6645</a>:</p>\n<blockquote>\n<p>I have WIT definitions like this:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">default</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">abc</span>: <span class=\"nc\">self</span><span class=\"p\">.</span><span class=\"n\">abc</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">interface</span><span class=\"w\"> </span><span class=\"n\">abc</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"k\">type</span> <span class=\"nc\">column</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">list</span><span class=\"o\">&lt;</span><span class=\"kt\">u8</span><span class=\"o\">&gt;</span>\n\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">record</span><span class=\"o\">-</span><span class=\"n\">batch</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">schema</span>: <span class=\"nc\">schema</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"c1\">// columns: list&lt;array-data&gt;,</span>\n<span class=\"w\">    </span><span class=\"n\">columns</span>: <span class=\"nc\">list</span><span class=\"o\">&lt;</span><span class=\"n\">column</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"c1\">// row-count: u32,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"k\">enum</span> <span class=\"nc\">data</span><span class=\"o\">-</span><span class=\"k\">type</span> <span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">i16</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">i32</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">i64</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"kt\">bool</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">dt</span><span class=\"o\">-</span><span class=\"n\">string</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">name</span>: <span class=\"nc\">string</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"n\">data</span><span class=\"o\">-</span><span class=\"k\">type</span>: <span class=\"nc\">data</span><span class=\"o\">-</span><span class=\"k\">type</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">schema</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">fields</span>: <span class=\"nc\">list</span><span class=\"o\">&lt;</span><span class=\"n\">field</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"k\">enum</span> <span class=\"nc\">eval</span><span class=\"o\">-</span><span class=\"n\">errno</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">err1</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n\n<span class=\"w\">  </span><span class=\"n\">eval</span>: <span class=\"nc\">func</span><span class=\"p\">(</span><span class=\"n\">batch</span>: <span class=\"nc\">record</span><span class=\"o\">-</span><span class=\"n\">batch</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"nc\">result</span><span class=\"o\">&lt;</span><span class=\"n\">column</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">eval</span><span class=\"o\">-</span><span class=\"n\">errno</span><span class=\"o\">&gt;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>wasmtime generates <code>RecordBatch&lt;'a&gt;</code>, </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"cp\">#[derive(wasmtime::component::ComponentType, wasmtime::component::Lower)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[component(record)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Field</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"name\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">name</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">a</span> <span class=\"kt\">str</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"data-type\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">data_type</span>: <span class=\"nc\">DataType</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"cp\">#[derive(wasmtime::component::ComponentType, wasmtime::component::Lower)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[component(record)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Schema</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"fields\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">fields</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">a</span> <span class=\"p\">[</span><span class=\"n\">Field</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"p\">],</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">Column</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"kt\">u8</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n\n<span class=\"w\">    </span><span class=\"cp\">#[derive(wasmtime::component::ComponentType, wasmtime::component::Lower)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[component(record)]</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">RecordBatch</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"schema\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">schema</span>: <span class=\"nc\">Schema</span><span class=\"o\">&lt;'</span><span class=\"na\">a</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"cp\">#[component(name = </span><span class=\"s\">\"columns\"</span><span class=\"cp\">)]</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">columns</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">a</span> <span class=\"p\">[</span><span class=\"o\">&amp;'</span><span class=\"na\">a</span><span class=\"w\"> </span><span class=\"n\">Column</span><span class=\"p\">],</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>while wit-bindgen generates <code>RecordBatch</code></p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Field</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">      </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">name</span>:<span class=\"nc\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">string</span>::<span class=\"nb\">String</span><span class=\"p\">,</span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">data_type</span>:<span class=\"nc\">DataType</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Schema</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">      </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">fields</span>:<span class=\"nc\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">vec</span>::<span class=\"nb\">Vec</span>::<span class=\"o\">&lt;</span><span class=\"n\">Field</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">Column</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">vec</span>::<span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"kt\">u8</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"cp\">#[derive(Clone)]</span>\n<span class=\"w\">    </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">RecordBatch</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">schema</span>: <span class=\"nc\">Schema</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"n\">columns</span>: <span class=\"nc\">wit_bindgen</span>::<span class=\"n\">rt</span>::<span class=\"n\">vec</span>::<span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"n\">Column</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>Is this expected? I don't quite understand the reason and the lifetimes are not easy to work with <span aria-label=\"oh no\" class=\"emoji emoji-1f615\" role=\"img\" title=\"oh no\">:oh_no:</span></p>\n</blockquote>",
        "id": 370184020,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1687894328
    }
]