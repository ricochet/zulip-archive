[
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006233740\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @cfallin, @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"cranelift\", \"cranelift:area:x64\", \"isle\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>cfallin: isle</li>\n<li>fitzgen: isle</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 267018779,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641435932
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006786206\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<blockquote>\n<p>we are generating some unnecessary <code>movdqa</code>s now</p>\n</blockquote>\n<p>It looks like the initial <code>movdqa</code> is being inserted by move mitosis, but that the regalloc isn't coalescing and eliding the move:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">isa</span>::<span class=\"n\">x64</span>::<span class=\"n\">inst</span><span class=\"w\">       </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">mov_mitosis</span><span class=\"p\">(</span><span class=\"n\">pand</span><span class=\"w\">    </span><span class=\"o\">%</span><span class=\"n\">v1V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">isa</span>::<span class=\"n\">x64</span>::<span class=\"n\">inst</span><span class=\"w\">       </span><span class=\"o\">&gt;</span><span class=\"w\">   </span>-&gt; <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">isa</span>::<span class=\"n\">x64</span>::<span class=\"n\">inst</span><span class=\"w\">       </span><span class=\"o\">&gt;</span><span class=\"w\">   </span>-&gt; <span class=\"nc\">pand</span><span class=\"w\">    </span><span class=\"o\">%</span><span class=\"n\">v1V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"err\">```</span><span class=\"w\"></span>\n\n<span class=\"o\">@</span><span class=\"n\">cfallin</span><span class=\"w\"> </span><span class=\"n\">any</span><span class=\"w\"> </span><span class=\"n\">idea</span><span class=\"w\"> </span><span class=\"n\">why</span><span class=\"w\"> </span><span class=\"n\">regalloc</span><span class=\"w\"> </span><span class=\"n\">might</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">able</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">coalesce</span><span class=\"o\">/</span><span class=\"n\">elide</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"k\">move</span><span class=\"o\">?</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">See</span><span class=\"w\"> </span><span class=\"n\">OP</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">full</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"o\">~~~</span><span class=\"w\"></span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 267090888,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641491120
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006792254\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<p>It looks like regalloc correctly determines that these virtual registers (<code>v0V</code> and <code>v5V</code>) are in the same e-class / are connected by moves (and therefore could be coalesced?) but isn't actually coalescing them:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\">    </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vcode</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">lowering</span>:\n<span class=\"nc\">VCode_ShowWithRRU</span><span class=\"w\"> </span><span class=\"p\">{{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Entry</span><span class=\"w\"> </span><span class=\"n\">block</span>: <span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">Block</span><span class=\"w\"> </span><span class=\"mi\">0</span>:\n  <span class=\"p\">(</span><span class=\"n\">original</span><span class=\"w\"> </span><span class=\"n\">IR</span><span class=\"w\"> </span><span class=\"n\">block</span>: <span class=\"nc\">block0</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">instruction</span><span class=\"w\"> </span><span class=\"n\">range</span>: <span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">0</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">xmm0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">1</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">xmm1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v1V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">2</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">xmm2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v2V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">3</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">4</span>:   <span class=\"nc\">pand</span><span class=\"w\">    </span><span class=\"o\">%</span><span class=\"n\">v1V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">5</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v6V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">6</span>:   <span class=\"nc\">pandn</span><span class=\"w\">   </span><span class=\"o\">%</span><span class=\"n\">v2V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v6V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">7</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v3V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">8</span>:   <span class=\"nc\">por</span><span class=\"w\">     </span><span class=\"o\">%</span><span class=\"n\">v6V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v3V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">9</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v3V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v4V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">10</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v4V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm0</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">11</span>:   <span class=\"nc\">ret</span><span class=\"w\"></span>\n<span class=\"p\">}}</span><span class=\"w\"></span>\n\n<span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"></span>\n\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">do_coalescing_analysis</span>: <span class=\"nc\">begin</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i0</span><span class=\"w\"> </span><span class=\"n\">v0V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">r0V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i1</span><span class=\"w\"> </span><span class=\"n\">v1V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">r1V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i2</span><span class=\"w\"> </span><span class=\"n\">v2V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">r2V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i3</span><span class=\"w\"> </span><span class=\"n\">v5V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v0V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i5</span><span class=\"w\"> </span><span class=\"n\">v6V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v0V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">cost</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i7</span><span class=\"w\"> </span><span class=\"n\">v3V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v5V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">cost</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i9</span><span class=\"w\"> </span><span class=\"n\">v4V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v3V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">cost</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i10</span><span class=\"w\"> </span><span class=\"n\">r0V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v4V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Revised</span><span class=\"w\"> </span><span class=\"n\">VLRs</span>:\n <span class=\"nc\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.333</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i0</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i5</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr1</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v1V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.500</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i1</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i4</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr2</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v2V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.400</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i2</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i6</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v3V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.667</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i7</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i9</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v4V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.500</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i9</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i10</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v5V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.600</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i3</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i7</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v6V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.750</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i5</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"kt\">i8</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Coalescing</span><span class=\"w\"> </span><span class=\"n\">hints</span>:\n <span class=\"nc\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Exactly</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Exactly</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Exactly</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Exactly</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr1</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr2</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">vv_boundary_move</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">vv_boundary_move</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">i7</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">vv_boundary_move</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">i9</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">do_coalescing_analysis</span>: <span class=\"nc\">end</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 267091578,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641491476
    },
    {
        "content": "<p>fitzgen edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006792254\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<p>It looks like regalloc correctly determines that these virtual registers (<code>v0V</code> and <code>v5V</code>) are in the same e-class / are connected by moves (and therefore could be coalesced?) but isn't actually coalescing them:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\">    </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vcode</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">lowering</span>:\n<span class=\"nc\">VCode_ShowWithRRU</span><span class=\"w\"> </span><span class=\"p\">{{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Entry</span><span class=\"w\"> </span><span class=\"n\">block</span>: <span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">Block</span><span class=\"w\"> </span><span class=\"mi\">0</span>:\n  <span class=\"p\">(</span><span class=\"n\">original</span><span class=\"w\"> </span><span class=\"n\">IR</span><span class=\"w\"> </span><span class=\"n\">block</span>: <span class=\"nc\">block0</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">instruction</span><span class=\"w\"> </span><span class=\"n\">range</span>: <span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">0</span>:   <span class=\"nc\">load_const</span><span class=\"w\"> </span><span class=\"n\">VCodeConstant</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">1</span>:   <span class=\"nc\">load_const</span><span class=\"w\"> </span><span class=\"n\">VCodeConstant</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v1V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">2</span>:   <span class=\"nc\">load_const</span><span class=\"w\"> </span><span class=\"n\">VCodeConstant</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v2V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">3</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">4</span>:   <span class=\"nc\">pand</span><span class=\"w\">    </span><span class=\"o\">%</span><span class=\"n\">v1V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">5</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v6V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">6</span>:   <span class=\"nc\">pandn</span><span class=\"w\">   </span><span class=\"o\">%</span><span class=\"n\">v2V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v6V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">7</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v5V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v3V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">8</span>:   <span class=\"nc\">por</span><span class=\"w\">     </span><span class=\"o\">%</span><span class=\"n\">v6V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v3V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">9</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v3V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">v4V</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">10</span>:   <span class=\"nc\">movdqa</span><span class=\"w\">  </span><span class=\"o\">%</span><span class=\"n\">v4V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm0</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"n\">Inst</span><span class=\"w\"> </span><span class=\"mi\">11</span>:   <span class=\"nc\">ret</span><span class=\"w\"></span>\n<span class=\"p\">}}</span><span class=\"w\"></span>\n\n<span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"></span>\n\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">do_coalescing_analysis</span>: <span class=\"nc\">begin</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i3</span><span class=\"w\"> </span><span class=\"n\">v5V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v0V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i5</span><span class=\"w\"> </span><span class=\"n\">v6V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v0V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">cost</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i7</span><span class=\"w\"> </span><span class=\"n\">v3V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v5V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">cost</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i9</span><span class=\"w\"> </span><span class=\"n\">v4V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v3V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">cost</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">connected</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">moves</span>: <span class=\"nc\">i10</span><span class=\"w\"> </span><span class=\"n\">r0V</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">v4V</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">est_freq</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Revised</span><span class=\"w\"> </span><span class=\"n\">VLRs</span>:\n <span class=\"nc\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v0V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.333</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i0</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i5</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr1</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v1V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.500</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i1</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i4</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr2</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v2V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.400</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i2</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i6</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v3V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.667</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i7</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i9</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v4V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.500</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i9</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i10</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v5V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.600</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i3</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"n\">i7</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\">   </span><span class=\"p\">(</span><span class=\"n\">VR</span>: <span class=\"nc\">v6V</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sz</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tc</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sc</span><span class=\"o\">=</span><span class=\"mf\">0.750</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[(</span><span class=\"n\">RF</span>: <span class=\"nc\">i5</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"o\">-</span><span class=\"kt\">i8</span><span class=\"p\">.</span><span class=\"n\">u</span><span class=\"p\">)])</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Coalescing</span><span class=\"w\"> </span><span class=\"n\">hints</span>:\n <span class=\"nc\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Exactly</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">xmm0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">hintsfor</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">SameAs</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weight</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr1</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr2</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr3</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">eclassof</span><span class=\"w\"> </span><span class=\"n\">vr6</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">vr6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">vr0</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">vv_boundary_move</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">vv_boundary_move</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">i7</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"n\">vv_boundary_move</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">i9</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">do_coalescing_analysis</span>: <span class=\"nc\">end</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">regalloc</span>::<span class=\"n\">bt_coalescing_analysis</span><span class=\"w\">        </span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 267092990,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641492111
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006814612\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<p>Hmm, interesting. My understanding is that <a href=\"http://regalloc.rs\">regalloc.rs</a> computes equivalence classes to use in a strictly heuristic way during allocation (of virtual-reg ranges to registers, and then separately to spillslots). former (mainly in <a href=\"https://github.com/bytecodealliance/regalloc.rs/blob/main/lib/src/bt_main.rs\">this file</a>) traverses equivalence classes looking for register hints (move to/from fixed reg), and to avoid some evictions. But two vregs existing in the same eclass does not guarantee that the move between them will be elided; in fact, one can construct inputs where there is not possible, as liveranges in an eclass can overlap. Elements in an eclass are joined by an \"equivalence\" that's kind of misnamed, I guess: it just means that at one point, one of the vregs was assigned to the other. Consider e.g. a loop where two vregs are swapped every iteration (<code>loop(x, y): br loop(y, x)</code>). So in this case, for whatever reason, the spill weights and processing order mean that the two sides of the move get allocated to different registers, and then that's it; the heuristics weren't quite good enough.</p>\n<p>Zooming out a bit, I would expect that once in a while, we get perturbations like this as ISLE's SSA lowering works just a bit differently. As long as we don't see regressions overall, I think this is fine to accept.</p>\n</blockquote>",
        "id": 267095628,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641493418
    },
    {
        "content": "<p>cfallin edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006814612\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<p>Hmm, interesting. My understanding is that <a href=\"http://regalloc.rs\">regalloc.rs</a> computes equivalence classes to use in a strictly heuristic way during allocation (of virtual-reg ranges to registers, and then separately to spillslots). The former (mainly in <a href=\"https://github.com/bytecodealliance/regalloc.rs/blob/main/lib/src/bt_main.rs\">this file</a>) traverses equivalence classes looking for register hints (move to/from fixed reg), and to avoid some evictions. But two vregs existing in the same eclass does not guarantee that the move between them will be elided; in fact, one can construct inputs where there is not possible, as liveranges in an eclass can overlap. Elements in an eclass are joined by an \"equivalence\" that's kind of misnamed, I guess: it just means that at one point, one of the vregs was assigned to the other. Consider e.g. a loop where two vregs are swapped every iteration (<code>loop(x, y): br loop(y, x)</code>). So in this case, for whatever reason, the spill weights and processing order mean that the two sides of the move get allocated to different registers, and then that's it; the heuristics weren't quite good enough.</p>\n<p>Zooming out a bit, I would expect that once in a while, we get perturbations like this as ISLE's SSA lowering works just a bit differently. As long as we don't see regressions overall, I think this is fine to accept.</p>\n</blockquote>",
        "id": 267095662,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641493437
    },
    {
        "content": "<p>cfallin edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006814612\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<p>Hmm, interesting. My understanding is that <a href=\"http://regalloc.rs\">regalloc.rs</a> computes equivalence classes to use in a strictly heuristic way during allocation (of virtual-reg ranges to registers, and then separately to spillslots). The former (mainly in <a href=\"https://github.com/bytecodealliance/regalloc.rs/blob/main/lib/src/bt_main.rs\">this file</a>) traverses equivalence classes looking for register hints (move to/from fixed reg), and to avoid some evictions. But two vregs existing in the same eclass does not guarantee that the move between them will be elided; in fact, one can construct inputs where this is not possible, as liveranges in an eclass can overlap. Elements in an eclass are joined by an \"equivalence\" that's kind of misnamed, I guess: it just means that at one point, one of the vregs was assigned to the other. Consider e.g. a loop where two vregs are swapped every iteration (<code>loop(x, y): br loop(y, x)</code>). So in this case, for whatever reason, the spill weights and processing order mean that the two sides of the move get allocated to different registers, and then that's it; the heuristics weren't quite good enough.</p>\n<p>Zooming out a bit, I would expect that once in a while, we get perturbations like this as ISLE's SSA lowering works just a bit differently. As long as we don't see regressions overall, I think this is fine to accept.</p>\n</blockquote>",
        "id": 267095723,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641493458
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006821112\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<p>Swapped the operands to the two commutative instructions (which I noticed was the only difference between the pre-regalloc vcode on <code>main</code> vs this branch) and the moves went away.</p>\n<p>Yay <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span> </p>\n</blockquote>",
        "id": 267096850,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641494029
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006821287\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<blockquote>\n<p>Zooming out a bit, I would expect that once in a while, we get perturbations like this as ISLE's SSA lowering works just a bit differently. As long as we don't see regressions overall, I think this is fine to accept.</p>\n</blockquote>\n<p>But yeah, agreed on this point <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span> </p>\n</blockquote>",
        "id": 267096924,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641494047
    },
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653#issuecomment-1006855683\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3653\">issue #3653</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @peterhuene</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"wasmtime:api\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>peterhuene: wasmtime:api</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 267102056,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1641496706
    }
]