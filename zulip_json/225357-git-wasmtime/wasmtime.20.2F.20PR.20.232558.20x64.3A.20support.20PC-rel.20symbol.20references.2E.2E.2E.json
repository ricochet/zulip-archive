[
    {
        "content": "<p>cfallin opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558\">PR #2558</a> from <code>pic-symbol-refs</code> to <code>main</code>:</p>\n<blockquote>\n<p>The new x64 backend, up till now, was generating references to non-colocated symbols using <code>Abs8</code> relocations (i.e., place the absolute 64-bit address in a 64-bit immediate to an instruction).</p>\n<p>This works fine on Linux/x86-64, even in <code>.so</code>s as generated by Lucet, but is not actually what we want to do when the <code>is_pic</code> flag is set. macOS is more strict and fails to link object files generated with these <code>Abs8</code> relocations. Instead, we need to use the GOT (global offset table).</p>\n<p>This PR changes the lowering of <code>func_addr</code>/<code>symbol_addr</code>/<code>call</code> with non-colocated symbols to use a PC-relative load from the GOT instead, and emits the special GOTPCRel4 relocation type. This is equivalent to (in <code>gas</code> syntax) a <code>movq symbol@GOTPCREL(%rip), %dest</code> instruction.</p>\n</blockquote>",
        "id": 222041667,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610086445
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/pchickey\">pchickey</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558\">PR #2558</a>.</p>",
        "id": 222041668,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610086445
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558#pullrequestreview-564031697\">PR Review</a>.</p>",
        "id": 222042458,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610087734
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558#discussion_r553767160\">PR Review Comment</a>:</p>\n<blockquote>\n<p>i32::min_value()?</p>\n</blockquote>",
        "id": 222042459,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610087734
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558\">PR #2558</a> from <code>pic-symbol-refs</code> to <code>main</code>:</p>\n<blockquote>\n<p>The new x64 backend, up till now, was generating references to non-colocated symbols using <code>Abs8</code> relocations (i.e., place the absolute 64-bit address in a 64-bit immediate to an instruction).</p>\n<p>This works fine on Linux/x86-64, even in <code>.so</code>s as generated by Lucet, but is not actually what we want to do when the <code>is_pic</code> flag is set. macOS is more strict and fails to link object files generated with these <code>Abs8</code> relocations. Instead, we need to use the GOT (global offset table).</p>\n<p>This PR changes the lowering of <code>func_addr</code>/<code>symbol_addr</code>/<code>call</code> with non-colocated symbols to use a PC-relative load from the GOT instead, and emits the special GOTPCRel4 relocation type. This is equivalent to (in <code>gas</code> syntax) a <code>movq symbol@GOTPCREL(%rip), %dest</code> instruction.</p>\n</blockquote>",
        "id": 222042910,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610088437
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558#pullrequestreview-564035888\">PR Review</a>.</p>",
        "id": 222042960,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610088493
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558#discussion_r553770655\">PR Review Comment</a>:</p>\n<blockquote>\n<p>Done -- actually -i32::MAX is more clear (since it's a positive i32 passed as an immediate to <code>sub</code>).</p>\n</blockquote>",
        "id": 222042961,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610088493
    },
    {
        "content": "<p>pchickey submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558#pullrequestreview-564469990\">PR Review</a>.</p>",
        "id": 222105021,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610128955
    },
    {
        "content": "<p>cfallin merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/2558\">PR #2558</a>.</p>",
        "id": 222105101,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1610128991
    }
]