[
    {
        "content": "<p>TerrorJack opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3705\">issue #3705</a>:</p>\n<blockquote>\n<h4>Feature</h4>\n<p>Currently, when a <code>call_indirect</code> opcode is executed with mismatching types, <code>wasmtime</code> would display something like:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">closure</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">wasm</span><span class=\"w\"> </span><span class=\"n\">trap</span>: <span class=\"nc\">indirect</span><span class=\"w\"> </span><span class=\"n\">call</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">mismatch</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n           <span class=\"mi\">0</span>: <span class=\"mh\">0x40515a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">__main_void</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">1</span>: <span class=\"mh\">0x4051af</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">__original_main</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">2</span>: <span class=\"mh\">0x405197</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_start</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"mi\">3</span>: <span class=\"mh\">0x4078c8</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_start</span><span class=\"p\">.</span><span class=\"n\">command_export</span><span class=\"w\"></span>\n</code></pre></div>\n<p>It would be nice to have enriched error message that displays the expected/actual type signatures here, this will help debugging a lot.<br>\n</p>\n</blockquote>",
        "id": 268746251,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1642707590
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3705#issuecomment-1017921315\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3705\">issue #3705</a>:</p>\n<blockquote>\n<p>This would be nice to have IMHO. It doesn't seem like there is an obvious way to pass the id of the actual and expected signature back to the wasmtime runtime. The trap is raised using a hardware trap instruction like ud2. This doesn't allow any arguments. Using a call instead would be possible though I suspect it will cause a perf regression, but I will leave it to others to judge as I am not familiar with this part of the code.</p>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/blob/1532516a363eed88b5a36726a1710411a9883049/crates/cranelift/src/func_environ.rs#L1378\">https://github.com/bytecodealliance/wasmtime/blob/1532516a363eed88b5a36726a1710411a9883049/crates/cranelift/src/func_environ.rs#L1378</a></p>\n</blockquote>",
        "id": 268756473,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1642712268
    }
]