[
    {
        "content": "<p>jlb6740 <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095#issuecomment-882107418\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095\">issue #3095</a>:</p>\n<blockquote>\n<p>Not ready to merge but intended to fix #3089. Passes spec tests but spec tests but spec tests didn't catch the faulty lowering and so need improvements. Can't find tools wat2wasm tools that support extmul_high (wabt for example does not generate from a wat file) .. but will check against v8 implementation as soon as I can generate a wasm binary that has this instruction.</p>\n</blockquote>",
        "id": 246394752,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1626637296
    },
    {
        "content": "<p>jlb6740 <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095#issuecomment-882114965\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095\">issue #3095</a>:</p>\n<blockquote>\n<p>Ok ... checked by just decomposing the instruction and comparing results.<br>\nHere compared call to low with call to mul_widen_low_s and did the same for the high compared to mul_widen_high_s. Results were consistent. But was just due to incorrect register usage when inlining the widen part for the instructions.</p>\n<p>`(module<br>\n  (func $inputs (result v128 v128)<br>\n      v128.const i8x16 -1 -2 3 100 124 -38 33 87 92 108 22 8 -43 -128 22 0<br>\n      v128.const i8x16 -5 -2 6 10 45 -4 4 -2 0 88 92 -102 -98 83 73 54)</p>\n<p>(func $input_a (result v128)<br>\n      v128.const i8x16 -1 -2 3 100 124 -38 33 87 92 108 22 8 -43 -128 22 0)</p>\n<p>(func $input_b (result v128)<br>\n      v128.const i8x16 -5 -2 6 10 45 -4 4 -2 0 88 92 -102 -98 83 73 54)</p>\n<p>(func (export \"low\") (result v128)<br>\n      call $inputs<br>\n      i16x8.extmul_low_i8x16_s)<br>\n(func (export \"high\") (result v128)<br>\n      call $inputs<br>\n      i16x8.extmul_high_i8x16_s)</p>\n<p>(func (export \"mul_widen_low_s\") (result v128)<br>\n    call $input_a<br>\n    i16x8.extend_low_i8x16_s<br>\n    call $input_b<br>\n    i16x8.extend_low_i8x16_s<br>\n    i16x8.mul)</p>\n<p>(func (export \"mul_widen_high_s\") (result v128)<br>\n    call $input_a<br>\n    i16x8.extend_high_i8x16_s<br>\n    call $input_b<br>\n    i16x8.extend_high_i8x16_s<br>\n    i16x8.mul)<br>\n)`</p>\n</blockquote>",
        "id": 246397526,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1626641462
    },
    {
        "content": "<p>jlb6740 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095#issuecomment-882114965\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095\">issue #3095</a>:</p>\n<blockquote>\n<p>Ok ... checked by just decomposing the instruction and comparing results.<br>\nHere compared call to low with call to mul_widen_low_s and did the same for the high compared to mul_widen_high_s. Results were consistent. But was just due to incorrect register usage when inlining the widen part for the instructions.</p>\n<p>`<br>\n(module<br>\n  (func $inputs (result v128 v128)<br>\n      v128.const i8x16 -1 -2 3 100 124 -38 33 87 92 108 22 8 -43 -128 22 0<br>\n      v128.const i8x16 -5 -2 6 10 45 -4 4 -2 0 88 92 -102 -98 83 73 54)</p>\n<p>(func $input_a (result v128)<br>\n      v128.const i8x16 -1 -2 3 100 124 -38 33 87 92 108 22 8 -43 -128 22 0)</p>\n<p>(func $input_b (result v128)<br>\n      v128.const i8x16 -5 -2 6 10 45 -4 4 -2 0 88 92 -102 -98 83 73 54)</p>\n<p>(func (export \"low\") (result v128)<br>\n      call $inputs<br>\n      i16x8.extmul_low_i8x16_s)<br>\n(func (export \"high\") (result v128)<br>\n      call $inputs<br>\n      i16x8.extmul_high_i8x16_s)</p>\n<p>(func (export \"mul_widen_low_s\") (result v128)<br>\n    call $input_a<br>\n    i16x8.extend_low_i8x16_s<br>\n    call $input_b<br>\n    i16x8.extend_low_i8x16_s<br>\n    i16x8.mul)</p>\n<p>(func (export \"mul_widen_high_s\") (result v128)<br>\n    call $input_a<br>\n    i16x8.extend_high_i8x16_s<br>\n    call $input_b<br>\n    i16x8.extend_high_i8x16_s<br>\n    i16x8.mul)<br>\n)<br>\n`</p>\n</blockquote>",
        "id": 246397541,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1626641488
    },
    {
        "content": "<p>jlb6740 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095#issuecomment-882114965\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095\">issue #3095</a>:</p>\n<blockquote>\n<p>Ok ... checked by just decomposing the instruction and comparing results.<br>\nHere compared call to low with call to mul_widen_low_s and did the same for the high compared to mul_widen_high_s. Results were consistent. But was just due to incorrect register usage when inlining the widen part for the instructions.</p>\n<blockquote>\n<p>(module<br>\n  (func $inputs (result v128 v128)<br>\n      v128.const i8x16 -1 -2 3 100 124 -38 33 87 92 108 22 8 -43 -128 22 0<br>\n      v128.const i8x16 -5 -2 6 10 45 -4 4 -2 0 88 92 -102 -98 83 73 54)</p>\n<p>(func $input_a (result v128)<br>\n      v128.const i8x16 -1 -2 3 100 124 -38 33 87 92 108 22 8 -43 -128 22 0)</p>\n<p>(func $input_b (result v128)<br>\n      v128.const i8x16 -5 -2 6 10 45 -4 4 -2 0 88 92 -102 -98 83 73 54)</p>\n<p>(func (export \"low\") (result v128)<br>\n      call $inputs<br>\n      i16x8.extmul_low_i8x16_s)<br>\n(func (export \"high\") (result v128)<br>\n      call $inputs<br>\n      i16x8.extmul_high_i8x16_s)</p>\n<p>(func (export \"mul_widen_low_s\") (result v128)<br>\n    call $input_a<br>\n    i16x8.extend_low_i8x16_s<br>\n    call $input_b<br>\n    i16x8.extend_low_i8x16_s<br>\n    i16x8.mul)</p>\n<p>(func (export \"mul_widen_high_s\") (result v128)<br>\n    call $input_a<br>\n    i16x8.extend_high_i8x16_s<br>\n    call $input_b<br>\n    i16x8.extend_high_i8x16_s<br>\n    i16x8.mul)<br>\n)<br>\n</p>\n</blockquote>\n</blockquote>",
        "id": 246397581,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1626641513
    },
    {
        "content": "<p>jlb6740 <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095#issuecomment-887171459\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3095\">issue #3095</a>:</p>\n<blockquote>\n<blockquote>\n<p>LGTM; thanks for the fix!</p>\n<p>Regarding extra tests: yes, it might be nice to add some more tests here, and actually I'd prefer to get coverage via our own tests and merge this sooner (since we know we are generating incorrect code) rather than wait for improvements to the upstream spec-test suite and updating that here.</p>\n<p>IMHO a runtest might be slightly preferable over a generated-code test; especially with SIMD and FP tests, where the goal is to ensure correctness rather than to see that we're successfully using a particular instruction, I'd prefer not to overfit on particular golden machine code (which may change later with other compiler updates, e.g. regalloc or other opts).</p>\n</blockquote>\n<p>Thanks @cfallin. I'll merge this then and we can focus on a runtest as a separate commit.</p>\n</blockquote>",
        "id": 247289581,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1627355190
    }
]