[
    {
        "content": "<p><a href=\"https://github.com/brendandburns\">brendandburns</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">Issue #9174</a>.</p>",
        "id": 465529629,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724783704
    },
    {
        "content": "<p>brendandburns opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"Go\"><pre><span></span><code><span class=\"kn\">package</span><span class=\"w\"> </span><span class=\"nx\">main</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"p\">(</span>\n<span class=\"w\">    </span><span class=\"s\">\"fmt\"</span>\n<span class=\"w\">    </span><span class=\"s\">\"log\"</span>\n<span class=\"w\">    </span><span class=\"s\">\"os\"</span>\n<span class=\"p\">)</span>\n\n<span class=\"kd\">func</span><span class=\"w\"> </span><span class=\"nx\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nx\">stat</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">Stat</span><span class=\"p\">(</span><span class=\"s\">\"./\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">stat</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n\n<span class=\"w\">    </span><span class=\"nx\">entries</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">ReadDir</span><span class=\"p\">(</span><span class=\"s\">\"./\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"nx\">_</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">entry</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">range</span><span class=\"w\"> </span><span class=\"nx\">entries</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"\\t%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">entry</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"nx\">file</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">Open</span><span class=\"p\">(</span><span class=\"s\">\"main.go\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">file</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">WriteFile</span><span class=\"p\">(</span><span class=\"s\">\"test.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"nb\">byte</span><span class=\"p\">(</span><span class=\"s\">\"This is test data\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"mh\">0x777</span><span class=\"p\">);</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<ul>\n<li><code>GOOS=wasip1 GOARCH=wasm go build -o main.wasm main.go</code></li>\n<li><code>wasmtime --dir .::. main.wasm</code></li>\n</ul>\n<h3>Expected Results</h3>\n<p>Generated code should be able to open files mapped in via <code>--dir</code></p>\n<h3>Actual Results</h3>\n<p>``<br>\n...<br>\n2024/08/27 18:27:51 open main.go: Bad file number</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">###</span><span class=\"w\"> </span><span class=\"n\">Versions</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">Environment</span>\n\n<span class=\"n\">Wasmtime</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">commit</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mf\">24.0</span>\n\n<span class=\"n\">Operating</span><span class=\"w\"> </span><span class=\"n\">system</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Linux</span>\n\n<span class=\"n\">Architecture</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">x86_64</span>\n\n<span class=\"p\">###</span><span class=\"w\"> </span><span class=\"n\">Extra</span><span class=\"w\"> </span><span class=\"n\">Info</span>\n\n<span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">don</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">know</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Golang</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">issue</span><span class=\"p\">.</span>\n<span class=\"o\">~~~</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 465529633,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724783705
    },
    {
        "content": "<p>brendandburns edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"Go\"><pre><span></span><code><span class=\"kn\">package</span><span class=\"w\"> </span><span class=\"nx\">main</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"p\">(</span>\n<span class=\"w\">    </span><span class=\"s\">\"fmt\"</span>\n<span class=\"w\">    </span><span class=\"s\">\"log\"</span>\n<span class=\"w\">    </span><span class=\"s\">\"os\"</span>\n<span class=\"p\">)</span>\n\n<span class=\"kd\">func</span><span class=\"w\"> </span><span class=\"nx\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nx\">stat</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">Stat</span><span class=\"p\">(</span><span class=\"s\">\"./\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">stat</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n\n<span class=\"w\">    </span><span class=\"nx\">entries</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">ReadDir</span><span class=\"p\">(</span><span class=\"s\">\"./\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"nx\">_</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">entry</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">range</span><span class=\"w\"> </span><span class=\"nx\">entries</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"\\t%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">entry</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"nx\">file</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">Open</span><span class=\"p\">(</span><span class=\"s\">\"main.go\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">file</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">WriteFile</span><span class=\"p\">(</span><span class=\"s\">\"test.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"nb\">byte</span><span class=\"p\">(</span><span class=\"s\">\"This is test data\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"mh\">0x777</span><span class=\"p\">);</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<ul>\n<li><code>GOOS=wasip1 GOARCH=wasm go build -o main.wasm main.go</code></li>\n<li><code>wasmtime --dir .::. main.wasm</code></li>\n</ul>\n<h3>Expected Results</h3>\n<p>Generated code should be able to open files mapped in via <code>--dir</code></p>\n<h3>Actual Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"mi\">2024</span><span class=\"o\">/</span><span class=\"mi\">08</span><span class=\"o\">/</span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"p\">:</span><span class=\"mi\">27</span><span class=\"p\">:</span><span class=\"mi\">51</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">.</span><span class=\"n\">go</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Bad</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">number</span>\n</code></pre></div>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: 24.0</p>\n<p>Operating system: Linux</p>\n<p>Architecture: x86_64</p>\n<h3>Extra Info</h3>\n<p>I don't know if this is a Golang or a wasmtime issue.</p>\n</blockquote>",
        "id": 465529676,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724783724
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174#issuecomment-2313311386\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<p>Can you try running with <code>WASMTIME_LOG=wasmtime_wasi=trace</code>? That should show all wasi syscalls executed by the wasm module with all arguments and error results.</p>\n</blockquote>",
        "id": 465535988,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724785603
    },
    {
        "content": "<p>primoly <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174#issuecomment-2315787516\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<p>The issue does not occur if you use <code>wasmtime --dir .::/ main.wasm</code> (Note the <code>.::/</code> instead of <code>.::.</code>)</p>\n<p>I think Go always adds a <code>/</code> at the beginning of the path. Changing to <code>os.Open(\"./main.go\")</code> does not resolve the issue.</p>\n<p>Rustâ€™s <code>std::fs::File::open</code> works with both absolute and relative paths as it uses <a href=\"https://github.com/WebAssembly/wasi-libc\"><code>wasi-libc</code></a> which does the mapping automatically so I guess this is an issue with the Go bindings to Wasi.<br>\n</p>\n</blockquote>",
        "id": 465809034,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724862238
    },
    {
        "content": "<p>brendandburns closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"Go\"><pre><span></span><code><span class=\"kn\">package</span><span class=\"w\"> </span><span class=\"nx\">main</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"p\">(</span>\n<span class=\"w\">    </span><span class=\"s\">\"fmt\"</span>\n<span class=\"w\">    </span><span class=\"s\">\"log\"</span>\n<span class=\"w\">    </span><span class=\"s\">\"os\"</span>\n<span class=\"p\">)</span>\n\n<span class=\"kd\">func</span><span class=\"w\"> </span><span class=\"nx\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nx\">stat</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">Stat</span><span class=\"p\">(</span><span class=\"s\">\"./\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">stat</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n\n<span class=\"w\">    </span><span class=\"nx\">entries</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">ReadDir</span><span class=\"p\">(</span><span class=\"s\">\"./\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"nx\">_</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">entry</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">range</span><span class=\"w\"> </span><span class=\"nx\">entries</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"\\t%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">entry</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"nx\">file</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">Open</span><span class=\"p\">(</span><span class=\"s\">\"main.go\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">fmt</span><span class=\"p\">.</span><span class=\"nx\">Printf</span><span class=\"p\">(</span><span class=\"s\">\"%s\\n\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">file</span><span class=\"p\">.</span><span class=\"nx\">Name</span><span class=\"p\">())</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"nx\">os</span><span class=\"p\">.</span><span class=\"nx\">WriteFile</span><span class=\"p\">(</span><span class=\"s\">\"test.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"nb\">byte</span><span class=\"p\">(</span><span class=\"s\">\"This is test data\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"mh\">0x777</span><span class=\"p\">);</span><span class=\"w\"> </span><span class=\"nx\">err</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"kc\">nil</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"nx\">log</span><span class=\"p\">.</span><span class=\"nx\">Fatal</span><span class=\"p\">(</span><span class=\"nx\">err</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<ul>\n<li><code>GOOS=wasip1 GOARCH=wasm go build -o main.wasm main.go</code></li>\n<li><code>wasmtime --dir .::. main.wasm</code></li>\n</ul>\n<h3>Expected Results</h3>\n<p>Generated code should be able to open files mapped in via <code>--dir</code></p>\n<h3>Actual Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"mi\">2024</span><span class=\"o\">/</span><span class=\"mi\">08</span><span class=\"o\">/</span><span class=\"mi\">27</span><span class=\"w\"> </span><span class=\"mi\">18</span><span class=\"p\">:</span><span class=\"mi\">27</span><span class=\"p\">:</span><span class=\"mi\">51</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">.</span><span class=\"n\">go</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Bad</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">number</span>\n</code></pre></div>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: 24.0</p>\n<p>Operating system: Linux</p>\n<p>Architecture: x86_64</p>\n<h3>Extra Info</h3>\n<p>I don't know if this is a Golang or a wasmtime issue.</p>\n</blockquote>",
        "id": 465825431,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724868812
    },
    {
        "content": "<p>brendandburns <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174#issuecomment-2315979219\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<p>Changing <code>--dir .::..</code> to <code>--dir .::/</code> fixes things.</p>\n<p>I agree that this feels like a bug in the Go + Wasi bindings, I'll look into that codebase.</p>\n<p>Closing this issue here.</p>\n</blockquote>",
        "id": 465825435,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724868813
    },
    {
        "content": "<p>brendandburns edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174#issuecomment-2315979219\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9174\">issue #9174</a>:</p>\n<blockquote>\n<p>Changing <code>--dir .::.</code> to <code>--dir .::/</code> fixes things.</p>\n<p>I agree that this feels like a bug in the Go + Wasi bindings, I'll look into that codebase.</p>\n<p>Closing this issue here.</p>\n</blockquote>",
        "id": 465825452,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724868825
    }
]