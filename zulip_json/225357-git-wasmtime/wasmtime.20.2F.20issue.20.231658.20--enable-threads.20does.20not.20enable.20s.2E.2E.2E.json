[
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">issue #1658</a>:</p>\n<blockquote>\n<p>I'm using Wasmtime 0.16.0.</p>\n<p>I've noticed that, even with, <code>--enable-threads</code>, Wasmtime fails to parse modules defining shared memories, e.g.: <a href=\"https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat\">https://github.com/GoogleChromeLabs/wasm-feature-detect/blob/master/src/detectors/threads/module.wat</a></p>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"k\">module</span>\n  <span class=\"p\">(</span><span class=\"k\">memory</span> <span class=\"mf\">1 1</span> <span class=\"err\">shared</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">func</span>\n    <span class=\"nb\">i32.const</span> <span class=\"mi\">0</span>\n    <span class=\"kt\">i32</span><span class=\"err\">.atomic.load</span>\n    <span class=\"nb\">drop</span>\n  <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<p>results in:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">directive</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">C</span>:<span class=\"err\">\\</span><span class=\"n\">Users</span><span class=\"err\">\\</span><span class=\"n\">rreverser</span><span class=\"err\">\\</span><span class=\"n\">Projects</span><span class=\"err\">\\</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"n\">feature</span><span class=\"o\">-</span><span class=\"n\">detect</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">detectors</span><span class=\"err\">\\</span><span class=\"n\">threads</span><span class=\"err\">\\</span><span class=\"n\">module</span><span class=\"p\">.</span><span class=\"n\">wat</span>:<span class=\"mi\">5</span>:<span class=\"mi\">1</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">WebAssembly</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">compile</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">2</span>: <span class=\"nc\">WebAssembly</span><span class=\"w\"> </span><span class=\"n\">translation</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">3</span>: <span class=\"nc\">Unsupported</span><span class=\"w\"> </span><span class=\"n\">feature</span>: <span class=\"nc\">shared</span><span class=\"w\"> </span><span class=\"n\">memories</span><span class=\"w\"></span>\n</code></pre></div>\n<p>While I know this feature is experimental and currently not very useful in Wasmtime, it seems unexpected because the comment for <code>enable_threads</code> suggests this should work at this flag enables shared memory and atomics:</p>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147\">https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/crates/api/src/runtime.rs#L145-L147</a></p>\n</blockquote>",
        "id": 283108762,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1653071094
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658#issuecomment-1133191522\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">issue #1658</a>:</p>\n<blockquote>\n<p>I'm going to close this in favor of <a href=\"https://github.com/bytecodealliance/wasmtime/issues/888\">https://github.com/bytecodealliance/wasmtime/issues/888</a> since it's otherwise a duplicate of that in that we're just missing big pieces of the threads proposal right now</p>\n</blockquote>",
        "id": 283108765,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1653071095
    },
    {
        "content": "<p>abrown <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658#issuecomment-1133206049\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/1658\">issue #1658</a>:</p>\n<blockquote>\n<p>Just FYI: I'm working on this at the moment.</p>\n</blockquote>",
        "id": 283110874,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1653072176
    }
]