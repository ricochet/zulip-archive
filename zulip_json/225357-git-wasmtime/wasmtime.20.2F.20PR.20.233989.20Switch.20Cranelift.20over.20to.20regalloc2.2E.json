[
    {
        "content": "<p>cfallin opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>:</p>\n<blockquote>\n<p>This is a draft PR for now, meant to serve as a discussion-starter. I'll work on splitting this into logically separate commits next week, but wanted to get the initial thing up first.</p>\n<p>All tests pass on x86-64, aarch64, and s390x (at least locally on Linux, modulo any CI surprises) and performance numbers from #3942 still apply.</p>\n<p>There is a summary of the design changes in <a href=\"https://github.com/cfallin/wasmtime/blob/regalloc2-clean/cranelift/regalloc2-integration.md\">this document</a> (I'll turn that into more permanent documentation before this merges).</p>\n</blockquote>",
        "id": 277507556,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648876720
    },
    {
        "content": "<p>cfallin edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>:</p>\n<blockquote>\n<p>This is a draft PR for now, meant to serve as a discussion-starter. I'll work on splitting this into logically separate commits next week, but wanted to get the initial thing up first.</p>\n<p>All tests pass on x86-64, aarch64, and s390x (at least locally on Linux, modulo any CI surprises) and performance numbers from #3942 still apply.</p>\n<p>There is a summary of the design changes in <a href=\"https://github.com/cfallin/wasmtime/blob/regalloc2-clean/cranelift/regalloc2-integration.md\">this document</a> (I'll turn that into more permanent documentation before this merges).</p>\n<p>Closes #3942.</p>\n</blockquote>",
        "id": 277507561,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648876734
    },
    {
        "content": "<p>cfallin edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>:</p>\n<blockquote>\n<p>This is a draft PR for now, meant to serve as a discussion-starter. I'll work on splitting this into logically separate commits next week, but wanted to get the initial thing up first.</p>\n<p>All tests pass on x86-64, aarch64, and s390x (at least locally on Linux, modulo any CI surprises) and performance numbers from #3942 still apply.</p>\n<p>There is a summary of the design changes in <a href=\"https://github.com/cfallin/wasmtime/blob/regalloc2-clean/cranelift/regalloc2-integration.md\">this document</a> (I'll turn that into more permanent documentation before this merges).</p>\n<p>Closes #3942.</p>\n<p>Requires <a href=\"https://github.com/bytecodealliance/regalloc2/issues/38\">bytecodealliance/regalloc2#38</a> and subsequent crate version bump/release.</p>\n</blockquote>",
        "id": 277507630,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648876807
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-929549435\">PR review</a>.</p>",
        "id": 277516419,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648889313
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r841045351\">PR review comment</a>:</p>\n<blockquote>\n<p>How to enable the regalloc checker without this option? And what about potential other regallocs?</p>\n</blockquote>",
        "id": 277516420,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648889313
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-929607708\">PR review</a>.</p>",
        "id": 277554004,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648936719
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r841123780\">PR review comment</a>:</p>\n<blockquote>\n<blockquote>\n<p>what about potential other regallocs</p>\n</blockquote>\n<p>Right now regalloc2 doesn't have any other algorithms, but we could certainly add this option back if it gains any. (And, for maximal clarity here, retaining the existing options is unfortunately not really possible because <a href=\"http://regalloc.rs\">regalloc.rs</a> is so different in certain ways from regalloc2 -- we can't make it a runtime option, we have to switch over all at once.)</p>\n<blockquote>\n<p>How to enable the regalloc checker</p>\n</blockquote>\n<p>I actually need to do a bit more work if we want the checker enabled <em>in Cranelift</em> (as opposed to in the regalloc2 fuzzing harness) -- it doesn't support pinned vregs currently, which the Cranelift glue uses to model RealRegs. I could do that, I just haven't had time yet; not sure if it should block an initial merge or not (open to opinions on this...).</p>\n</blockquote>",
        "id": 277554005,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1648936719
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277685893,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649052582
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277686905,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649053589
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277688570,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649055309
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277793032,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649106087
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277808997,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649115799
    },
    {
        "content": "<p><strong>cfallin</strong> has marked <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> as ready for review.</p>",
        "id": 277809102,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649115860
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277809171,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649115916
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277811448,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649117852
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277926664,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649184457
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 277929701,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649185786
    },
    {
        "content": "<p>cfallin edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>:</p>\n<blockquote>\n<p>This is a draft PR for now, meant to serve as a discussion-starter. I'll work on splitting this into logically separate commits next week, but wanted to get the initial thing up first.</p>\n<p>All tests pass on x86-64, aarch64, and s390x (at least locally on Linux, modulo any CI surprises) and performance numbers from #3942 still apply.</p>\n<p>There is a summary of the design changes in <a href=\"https://github.com/cfallin/wasmtime/blob/regalloc2-clean/cranelift/regalloc2-integration.md\">this document</a> (I'll turn that into more permanent documentation before this merges).</p>\n<p>Closes #3942.</p>\n<p>~Requires <a href=\"https://github.com/bytecodealliance/regalloc2/issues/38\">bytecodealliance/regalloc2#38</a> and subsequent crate version bump/release.~ (done.)</p>\n</blockquote>",
        "id": 277930200,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649186011
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-933375430\">PR review</a>.</p>",
        "id": 278013227,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246760
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r843866472\">PR review comment</a>:</p>\n<blockquote>\n<p>Can you keep this when debug assertions are enabled?</p>\n</blockquote>",
        "id": 278013228,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246760
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r843868061\">PR review comment</a>:</p>\n<blockquote>\n<p>Will the disassembly now show virtual registers or still use physical registers?</p>\n</blockquote>",
        "id": 278013438,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246875
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-933377766\">PR review</a>.</p>",
        "id": 278013439,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246875
    },
    {
        "content": "<p>bjorn3 edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r843868061\">PR review comment</a>.</p>",
        "id": 278013541,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246915
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-933379647\">PR review</a>.</p>",
        "id": 278013623,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246973
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r843869378\">PR review comment</a>:</p>\n<blockquote>\n<p>Why did you remove those?</p>\n</blockquote>",
        "id": 278013624,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649246973
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r843872169\">PR review comment</a>:</p>\n<blockquote>\n<p>Same, why are these removed?</p>\n</blockquote>",
        "id": 278013971,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649247179
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-933383624\">PR review</a>.</p>",
        "id": 278013972,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649247179
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-933392005\">PR review</a>.</p>",
        "id": 278014693,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649247603
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r843878218\">PR review comment</a>:</p>\n<blockquote>\n<p>I see it still uses physical registers.</p>\n</blockquote>",
        "id": 278014694,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649247603
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-935712876\">PR review</a>.</p>",
        "id": 278230903,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649368168
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r845586329\">PR review comment</a>:</p>\n<blockquote>\n<p>This actually became a significant O(n^2) slowdown in debug builds because of the additional edge blocks introduced in the block-lowering order, and was causing some test timeouts. IMHO we've tested and relied on this code enough over the past almost-2-years that enabling the checks only in fuzzing and not in all debug builds is probably OK...</p>\n</blockquote>",
        "id": 278230904,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649368168
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-935713363\">PR review</a>.</p>",
        "id": 278230996,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649368209
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r845586648\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, regalloc2 currently doesn't have serde support so I removed this to get things building, and then forgot to come back to it later... I'll add this.</p>\n</blockquote>",
        "id": 278230997,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649368209
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938504898\">PR review</a>.</p>",
        "id": 278612199,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649708904
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938504898\">PR review</a>.</p>",
        "id": 278612200,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649708904
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847675326\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>/// physical registers: this means that they are always constrained\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 278612201,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649708904
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847688462\">PR review comment</a>:</p>\n<blockquote>\n<p><code>impl From&lt;VReg&gt; for Reg</code> and <code>impl From&lt;Reg&gt; for VReg</code>? This is a little bit more idiomatic and allows using it in generics, plus you get the corresponding <code>Into</code> blanket impl.</p>\n</blockquote>",
        "id": 278612202,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649708904
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847703933\">PR review comment</a>:</p>\n<blockquote>\n<p>Should this debug assert that the allocation matches the real reg?</p>\n</blockquote>",
        "id": 278612203,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649708904
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847691405\">PR review comment</a>:</p>\n<blockquote>\n<p>Rather than open coding the <code>&lt; PINNED_VREGS</code> logic here and elsewhere, can we define a helper and make this something like</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">is_pinned</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"mf\">0.</span><span class=\"n\">vreg</span><span class=\"p\">())</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">RealReg</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"p\">))</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nb\">None</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>and similar below. This way if we change how we encode pinned registers, we don't need to update a bunch of different open-coded places.</p>\n</blockquote>",
        "id": 278612204,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649708904
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938556711\">PR review</a>.</p>",
        "id": 278612704,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649709151
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847712263\">PR review comment</a>:</p>\n<blockquote>\n<p>FWIW, we see ~60x slowdown when fuzzing and only have ~1 minute per fuzz input (so roughly 1s budget on non-fuzz builds), so it seems semi-likely that these checks will be too expensive for fuzzing as well if they are too expensive for <code>debug_assert!</code>.</p>\n</blockquote>",
        "id": 278612705,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649709151
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938572639\">PR review</a>.</p>",
        "id": 278628589,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938572639\">PR review</a>.</p>",
        "id": 278628590,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847723403\">PR review comment</a>:</p>\n<blockquote>\n<p>Can we do</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">enum</span> <span class=\"nc\">VCodeDirection</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Forwards</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Backwards</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>to avoid these boolean arguments that need comments explaining what they are?</p>\n</blockquote>",
        "id": 278628591,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847747106\">PR review comment</a>:</p>\n<blockquote>\n<p>I could see this API being hard to implement with a slice return. For example, if an inst variant is like</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">clobber_a</span>: <span class=\"nc\">Writable</span><span class=\"o\">&lt;</span><span class=\"n\">Reg</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">clobber_b</span>: <span class=\"nc\">Writable</span><span class=\"o\">&lt;</span><span class=\"n\">Reg</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">},</span><span class=\"w\"></span>\n</code></pre></div>\n<p>then you can't actually return both <code>clobber_{a,b}</code> as a slice, since you have no vec or array to borrow from.</p>\n<p>Perhaps this should be a <code>SmallVec</code> return? Alternatively, the caller could pass in a <code>&amp;mut Vec</code> and let the callee fill it, and the caller could reuse the same space for every inst.</p>\n</blockquote>",
        "id": 278628593,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847748716\">PR review comment</a>:</p>\n<blockquote>\n<p>This seems like a sketchy API given that multiple types can lower to the same register class (ie both vector types and floats map to the same register class). How do callees know which type to return? How can callers communicate their expectations?</p>\n</blockquote>",
        "id": 278628594,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847761755\">PR review comment</a>:</p>\n<blockquote>\n<p>Don't want to factor this out into ranges within a single allocation like other bits have done?</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"c1\">// From instruction index to `(start, end)` indices of the clobbers in `clobber_data`.</span>\n<span class=\"n\">clobbers</span>: <span class=\"nc\">FxHashMap</span><span class=\"o\">&lt;</span><span class=\"n\">InsnIndex</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">u32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">u32</span><span class=\"p\">)</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"n\">clobber_data</span>: <span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"n\">PReg</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"></span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 278628595,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847766068\">PR review comment</a>:</p>\n<blockquote>\n<p>Also all of these <code>(start, end)</code> index pairs could be <code>u32</code>s (a <code>Vec</code> can only hold <code>usize::MAX / 2</code> items anyways; in practice we won't get anywhere near that either) and we will reduce space further.</p>\n</blockquote>",
        "id": 278628596,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847774010\">PR review comment</a>:</p>\n<blockquote>\n<p>Should this method invert <code>self.direction</code> (ne <code>self.backward</code>)? Seems like things could otherwise get out of sync.</p>\n</blockquote>",
        "id": 278628597,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847768299\">PR review comment</a>:</p>\n<blockquote>\n<p>Make this an <code>Option&lt;String&gt;</code> for clarity? I know an empty string won't heap allocate, but the API is confusing that this is a \"pretty-printed disassembly, if any\" but is non-optional.</p>\n</blockquote>",
        "id": 278628598,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847764702\">PR review comment</a>:</p>\n<blockquote>\n<p>Similar story here: we can have a single <code>vregs: Vec&lt;regalloc2::VReg&gt;</code> that both block args and block params index into.</p>\n</blockquote>",
        "id": 278628599,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847768957\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>/// This builder has the ability to accept instructions in either\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 278628600,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847763957\">PR review comment</a>:</p>\n<blockquote>\n<p>Might as well consolidate <code>block_preds</code> and <code>block_succs</code> into a single allocation, no? We never iterate over all blocks that are a predecessor to any other block, only a particular block's predecessors after we've grabbed that sub-range, and similar for successors, so it seems like they could all live in the same backing <code>Vec&lt;regalloc2::Block&gt;</code> and have just one big allocation rather than two big allocations.</p>\n</blockquote>",
        "id": 278628601,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847804613\">PR review comment</a>:</p>\n<blockquote>\n<p>This pattern is cropping up repeatedly all over the place. Might make sense to define a <code>disasm!(state, \"format string\", format_args...)</code> macro to encapsulate it.</p>\n</blockquote>",
        "id": 278628602,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847770228\">PR review comment</a>:</p>\n<blockquote>\n<p>Split into</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">debug_info</span>: <span class=\"nc\">FxHashMap</span><span class=\"o\">&lt;</span><span class=\"n\">ValueLabel</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"kt\">u32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">u32</span><span class=\"p\">)</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"n\">debug_info_data</span>: <span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"p\">(</span><span class=\"n\">InsnIndex</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">InsnIndex</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">VReg</span><span class=\"p\">)</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"></span>\n</code></pre></div>\n<p>like elsewhere?</p>\n</blockquote>",
        "id": 278628603,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649718335
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847832495\">PR review comment</a>:</p>\n<blockquote>\n<p>This one is a bit of an interesting case: it's factoring out from ad-hoc code in several places that was generating loads, stores, or moves of whole registers by choosing some appropriate type. In some sense it's a problem caused earlier in the design by writing a bunch of instruction helpers (for moves, loads, stores) that can only take <code>Type</code>s, not <code>RegClass</code>s, so when we drop down to the regalloc abstraction level and care only about whole registers, but need to insert instructions for data movement, we need to translate back.</p>\n<p>I'd be happy to rename this to something like <code>type_that_fully_contains_rc</code> or <code>canonical_type_for_rc</code> or somesuch to make that clearer, if you'd prefer!</p>\n</blockquote>",
        "id": 278632883,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649722061
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938725600\">PR review</a>.</p>",
        "id": 278632884,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649722061
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938726739\">PR review</a>.</p>",
        "id": 278633054,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649722210
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847833461\">PR review comment</a>:</p>\n<blockquote>\n<p>I was starting to write an answer here discussing allocations and how I'd prefer to avoid them, and the tradeoffs vs flexibility and maybe <code>Cow</code> but that's awkward, etc., then realized we've been down this road before -- we have all the same tradeoffs for ordinary operands. So I think maybe the better answer is to actually go through the operand-collector interface (<code>reg_clobber</code> alongside <code>reg_use</code>, <code>reg_def</code> and friends), what do you think?</p>\n</blockquote>",
        "id": 278633055,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649722211
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-938729796\">PR review</a>.</p>",
        "id": 278633560,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649722625
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r847835746\">PR review comment</a>:</p>\n<blockquote>\n<p>The intent was for it to be called only once, not for it to be possible to flip directions repeatedly; the latter would certainly break many invariants, even if we try to invert <code>self.direction</code>!</p>\n<p>This was meant to be enforced by (i) <code>reverse</code> being a private helper method, and (ii) <code>reverse</code> only being called by the build-function that consumes <code>self</code>. I'm happy to name <code>reverse</code> something better, like <code>reverse_backwards_emission_and_finalize</code> or something like that...</p>\n</blockquote>",
        "id": 278633561,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649722625
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-939858559\">PR review</a>.</p>",
        "id": 278719790,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649782048
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848653713\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, <code>reg_clobber</code> makes a lot of sense.</p>\n</blockquote>",
        "id": 278719791,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649782048
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-939859683\">PR review</a>.</p>",
        "id": 278719922,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649782099
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848654445\">PR review comment</a>:</p>\n<blockquote>\n<p>I guess <code>canonical_type_for_rc</code> makes sense.</p>\n</blockquote>",
        "id": 278719923,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649782100
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-939861418\">PR review</a>.</p>",
        "id": 278720105,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649782188
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848655666\">PR review comment</a>:</p>\n<blockquote>\n<p><code>reverse_and_finalize</code>? Maybe also some comments for the method explaining that the builder can't be used again after this method is called.</p>\n</blockquote>",
        "id": 278720107,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649782188
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-939883158\">PR review</a>.</p>",
        "id": 278723086,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649783516
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-939883158\">PR review</a>.</p>",
        "id": 278723087,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649783516
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848671064\">PR review comment</a>:</p>\n<blockquote>\n<p>Sort of strange API-wise to give a <code>Vec</code> here -- is there a reason we aren't giving a <code>&amp;[Writable&lt;RealReg&gt;]</code>? Do impls take ownership/mutate/grow the vec internally?</p>\n</blockquote>",
        "id": 278723088,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649783516
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848671593\">PR review comment</a>:</p>\n<blockquote>\n<p>ditto</p>\n</blockquote>",
        "id": 278723089,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649783516
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848671409\">PR review comment</a>:</p>\n<blockquote>\n<p>ditto</p>\n</blockquote>",
        "id": 278723090,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649783516
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848671483\">PR review comment</a>:</p>\n<blockquote>\n<p>ditto</p>\n</blockquote>",
        "id": 278723091,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649783516
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-940205526\">PR review</a>.</p>",
        "id": 278760607,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649801451
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848911386\">PR review comment</a>:</p>\n<blockquote>\n<p>I think we can remove the <code>mov_mitosis</code> function now as well.</p>\n</blockquote>",
        "id": 278760608,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649801451
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-940205526\">PR review</a>.</p>",
        "id": 278760609,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649801451
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-940211316\">PR review</a>.</p>",
        "id": 278761525,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649802112
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-940211316\">PR review</a>.</p>",
        "id": 278761527,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649802112
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r848916125\">PR review comment</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>/// this for xsp / xzr; we have two special registers for those.\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 278761529,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649802112
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278788831,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649830847
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941316012\">PR review</a>.</p>",
        "id": 278861671,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649870908
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941316012\">PR review</a>.</p>",
        "id": 278861672,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649870908
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849725238\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah okay, we remove it in this commit.</p>\n</blockquote>",
        "id": 278861674,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649870908
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941328872\">PR review</a>.</p>",
        "id": 278862486,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649871311
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941328872\">PR review</a>.</p>",
        "id": 278862487,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649871311
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849734737\">PR review comment</a>:</p>\n<blockquote>\n<p>This is out of date now. Not sure whether we want to keep this whole doc around or not?</p>\n</blockquote>",
        "id": 278862491,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649871311
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941329856\">PR review</a>.</p>",
        "id": 278862553,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649871358
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278878477,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649878190
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278879953,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649878906
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941465784\">PR review</a>.</p>",
        "id": 278879962,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649878912
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849832664\">PR review comment</a>:</p>\n<blockquote>\n<p>Fixed!</p>\n</blockquote>",
        "id": 278879963,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649878912
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278881953,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649879931
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849846139\">PR review comment</a>:</p>\n<blockquote>\n<p>Good idea; I've refactored in this direction. This particular helper (<code>pinned_vreg_to_preg</code>) is the canonical helper that defines the index split, along with <code>first_user_vreg_index()</code> below (index needed for vreg index allocation during lowering, but exposing it with this name only makes its intended use more clear).</p>\n</blockquote>",
        "id": 278882161,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649880015
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941488636\">PR review</a>.</p>",
        "id": 278882162,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649880015
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278905308,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649893299
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941656951\">PR review</a>.</p>",
        "id": 278905322,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649893308
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849976854\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 278905323,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649893308
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941657007\">PR review</a>.</p>",
        "id": 278905332,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649893317
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849976904\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, good point, done!</p>\n</blockquote>",
        "id": 278905333,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649893317
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278909282,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649896849
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278909435,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649896967
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941683247\">PR review</a>.</p>",
        "id": 278909534,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897048
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849998518\">PR review comment</a>:</p>\n<blockquote>\n<p>Done! The <code>Forward</code> option is actually dead, which totally makes sense, because we... don't have any forward VCode-to-VCode passes yet. I expect we will eventually, but IMHO it makes more sense to omit the enum arm (with a TODO explaining why) so that we can add it back only when we adequately test it.</p>\n<p>(I'd just like to note as an aside that the dead-code analysis working to find unconstructed enum variants is <em>excellent</em>.)</p>\n</blockquote>",
        "id": 278909535,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897048
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941683552\">PR review</a>.</p>",
        "id": 278909562,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897093
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849998773\">PR review comment</a>:</p>\n<blockquote>\n<p>Done! This is also actually dead right now, as calls use phantom defs (a legacy from <a href=\"http://regalloc.rs\">regalloc.rs</a>). I'll create a followup issue to track using actual clobbers, which should be very marginally faster.</p>\n</blockquote>",
        "id": 278909563,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897093
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941684155\">PR review</a>.</p>",
        "id": 278909733,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897188
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849999255\">PR review comment</a>:</p>\n<blockquote>\n<p>#4027</p>\n</blockquote>",
        "id": 278909734,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897188
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941684194\">PR review</a>.</p>",
        "id": 278909742,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897196
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849999287\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 278909743,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897196
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941684245\">PR review</a>.</p>",
        "id": 278909752,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897205
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849999324\">PR review comment</a>:</p>\n<blockquote>\n<p>Done, good idea, thanks!</p>\n</blockquote>",
        "id": 278909753,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897206
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941684289\">PR review</a>.</p>",
        "id": 278909758,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897212
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r849999355\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 278909759,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897212
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941685115\">PR review</a>.</p>",
        "id": 278909881,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897333
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000063\">PR review comment</a>:</p>\n<blockquote>\n<p>Here it's actually a little more subtle: we append to both of these separately while building a block, so it'd take a bit more state-tracking to append to one consolidated array and keep the ranges straight. I think it's technically possible but it's a bit error-prone and I think I'd prefer to keep the two arrays separate for now.</p>\n<p>That said, it might be nice to eventually have a typesafe wrapper around this idiom -- maybe with multiple range-lists pointing into one pool-list and encoding that only one appender is outstanding at a time. Building that sounds like a nice followup task at some point.</p>\n</blockquote>",
        "id": 278909882,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897333
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000102\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 278909886,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897341
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941685172\">PR review</a>.</p>",
        "id": 278909887,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897341
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941685228\">PR review</a>.</p>",
        "id": 278909893,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897349
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000137\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 278909894,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897349
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941685278\">PR review</a>.</p>",
        "id": 278909902,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897356
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000165\">PR review comment</a>:</p>\n<blockquote>\n<p>Fixed!</p>\n</blockquote>",
        "id": 278909904,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897357
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941685743\">PR review</a>.</p>",
        "id": 278910011,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897430
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000553\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 278910012,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897430
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941685808\">PR review</a>.</p>",
        "id": 278910022,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897441
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000624\">PR review comment</a>:</p>\n<blockquote>\n<p>Done, with a closure.</p>\n</blockquote>",
        "id": 278910023,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897441
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941686015\">PR review</a>.</p>",
        "id": 278910050,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897475
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000788\">PR review comment</a>:</p>\n<blockquote>\n<p>The reason is to avoid an allocation: when we compute it, we incrementally build it in a <code>Vec</code>; the only use is to call <code>set_clobbered</code>, and the ABI object needs to subsequently retain it. So if we passed a slice we'd force a copy. Slightly non-idiomatic for the general API case but here the method just ties together two specific points in the code :-)</p>\n</blockquote>",
        "id": 278910051,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897475
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941686102\">PR review</a>.</p>",
        "id": 278910064,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897486
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000864\">PR review comment</a>:</p>\n<blockquote>\n<p>Likewise, the instruction retains the register list, and we build it in a <code>Vec</code> in at least one callsite, so we want to avoid the re-allocation/copy here.</p>\n</blockquote>",
        "id": 278910065,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897486
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941686152\">PR review</a>.</p>",
        "id": 278910075,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897493
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850000910\">PR review comment</a>:</p>\n<blockquote>\n<p>Fixed!</p>\n</blockquote>",
        "id": 278910076,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897494
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850001549\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, here we actually append to arbitrary lists as we go, i.e. the ranges are not contiguous, so I think we need to keep separate vecs. We can't do the alternative \"build a commingled pool then sort\" trick either, as we need to examine the in-progress sequence when we append new content.</p>\n</blockquote>",
        "id": 278910245,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897605
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941686867\">PR review</a>.</p>",
        "id": 278910246,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897605
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941686913\">PR review</a>.</p>",
        "id": 278910248,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897612
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850001593\">PR review comment</a>:</p>\n<blockquote>\n<p>Fixed!</p>\n</blockquote>",
        "id": 278910249,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897612
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941687048\">PR review</a>.</p>",
        "id": 278910277,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897634
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850001681\">PR review comment</a>:</p>\n<blockquote>\n<p>Fixed!</p>\n</blockquote>",
        "id": 278910278,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897634
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278910367,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897684
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941687666\">PR review</a>.</p>",
        "id": 278910432,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897728
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850002198\">PR review comment</a>:</p>\n<blockquote>\n<p>Yeah, it was mostly just to help the reviewers (ie, you) as a delta, rather than a snapshot of the whole design, so I'll go ahead and delete it I think. It'll still be around in my branch (I'll delete it in a separate commit) if anyone wants to dig it up later.</p>\n</blockquote>",
        "id": 278910433,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649897728
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941689965\">PR review</a>.</p>",
        "id": 278910995,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649898075
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850004112\">PR review comment</a>:</p>\n<blockquote>\n<p>Filed #4028 for this.</p>\n</blockquote>",
        "id": 278910996,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649898075
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#pullrequestreview-941691135\">PR review</a>.</p>",
        "id": 278911210,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649898257
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989#discussion_r850005038\">PR review comment</a>:</p>\n<blockquote>\n<p>Filed <a href=\"https://github.com/bytecodealliance/regalloc2/issues/42\">bytecodealliance/regalloc2#42</a> for this.</p>\n</blockquote>",
        "id": 278911211,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649898257
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a> from <code>regalloc2-clean</code> to <code>main</code>.</p>",
        "id": 278915669,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649902886
    },
    {
        "content": "<p>cfallin merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3989\">PR #3989</a>.</p>",
        "id": 278996282,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1649957303
    }
]