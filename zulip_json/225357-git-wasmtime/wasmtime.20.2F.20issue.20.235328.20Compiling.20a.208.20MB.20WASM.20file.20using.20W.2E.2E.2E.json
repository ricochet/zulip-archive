[
    {
        "content": "<p>kpreisser edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Hi!</p>\n<p>I noticed that compiling an 8 MiB WASM module (produced by the experimental <a href=\"https://github.com/SteveSandersonMS/dotnet-wasi-sdk/\">WASI SDK for .NET</a>) when using Wasmtime from commit 28cf995fd3f9926a95036758c78390f54a0289ae (current <strong>dev</strong> release) is much slower than when using Wasmtime 3.0.0 (tested on Windows 10 x64, Build 19044).</p>\n<p>To reproduce:</p>\n<ul>\n<li>Download the WASM file as .Zip file here (note: rename the <code>.mov</code> file to <code>.zip</code> ; I renamed it to be able to upload it here): <a href=\"https://user-images.githubusercontent.com/13289184/203989968-4639d6d5-15c9-4e57-bf01-c2eccd756642.mov\">https://user-images.githubusercontent.com/13289184/203989968-4639d6d5-15c9-4e57-bf01-c2eccd756642.mov</a></li>\n<li>Download and extract <code>wasmtime-v3.0.0-x86_64-windows.zip</code></li>\n<li>Run <code>wasmtime compile dotnet-codabix-wasm-build.wasm</code></li>\n<li>Then try the same with the current <strong>dev</strong> release from commit 28cf995fd3f9926a95036758c78390f54a0289ae.</li>\n</ul>\n<p>On my system, with Wasmtime <strong>3.0.0</strong> this takes about <strong>0.7</strong> seconds, but with the build from commit 28cf995fd3f9926a95036758c78390f54a0289ae it takes about <strong>13.8</strong> seconds, which is about 20 times as long.<br>\nIs this expected?</p>\n<p>Bisecting shows that this starts to appear with commit fc62d4ad65892837a1e1af5a9d67c8b0d4310efe (#5231) - with a release build from this commit, I get the 13.8s time, but with the previous commit 33a192556e5f11ee95cffc7a90e74b78abc340c8, I get a time of about 0.7s.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: Wasmtime v3.0.0 vs 28cf995fd3f9926a95036758c78390f54a0289ae<br>\nOperating system: Windows 10 Pro x64, Build 19044<br>\nArchitecture: x64 (x86-64)</p>\n<p>Thank you!</p>\n</blockquote>",
        "id": 312524681,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669588061
    },
    {
        "content": "<p>kpreisser edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Hi!</p>\n<p>I noticed that compiling an 8 MiB WASM module (produced by the experimental <a href=\"https://github.com/SteveSandersonMS/dotnet-wasi-sdk/\">WASI SDK for .NET</a>) when using Wasmtime from commit 28cf995fd3f9926a95036758c78390f54a0289ae (current <strong>dev</strong> release) takes much longer than when using Wasmtime 3.0.0 (tested on Windows 10 x64, Build 19044).</p>\n<p>To reproduce:</p>\n<ul>\n<li>Download the WASM file as .Zip file here (note: rename the <code>.mov</code> file to <code>.zip</code> ; I renamed it to be able to upload it here): <a href=\"https://user-images.githubusercontent.com/13289184/203989968-4639d6d5-15c9-4e57-bf01-c2eccd756642.mov\">https://user-images.githubusercontent.com/13289184/203989968-4639d6d5-15c9-4e57-bf01-c2eccd756642.mov</a></li>\n<li>Download and extract <code>wasmtime-v3.0.0-x86_64-windows.zip</code></li>\n<li>Run <code>wasmtime compile dotnet-codabix-wasm-build.wasm</code></li>\n<li>Then try the same with the current <strong>dev</strong> release from commit 28cf995fd3f9926a95036758c78390f54a0289ae.</li>\n</ul>\n<p>On my system, with Wasmtime <strong>3.0.0</strong> this takes about <strong>0.7</strong> seconds, but with the build from commit 28cf995fd3f9926a95036758c78390f54a0289ae it takes about <strong>13.8</strong> seconds, which is about 20 times as long.<br>\nIs this expected?</p>\n<p>Bisecting shows that this starts to appear with commit fc62d4ad65892837a1e1af5a9d67c8b0d4310efe (#5231) - with a release build from this commit, I get the 13.8s time, but with the previous commit 33a192556e5f11ee95cffc7a90e74b78abc340c8, I get a time of about 0.7s.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: Wasmtime v3.0.0 vs 28cf995fd3f9926a95036758c78390f54a0289ae<br>\nOperating system: Windows 10 Pro x64, Build 19044<br>\nArchitecture: x64 (x86-64)</p>\n<p>Thank you!</p>\n</blockquote>",
        "id": 312524741,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669588093
    },
    {
        "content": "<p>kpreisser <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1328750433\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Additionally, starting with the above mentioned commit 28cf995fd3f9926a95036758c78390f54a0289ae, we get an <strong>access violation</strong> in our application in <code>wasmtime_func_call</code> (via <code>Wasmtime.Dotnet</code>, for wasm function <code>\"_start\"</code>) when using the above mentioned <code>dotnet-codabix-wasm-build.wasm</code> (on Windows 10 x64 buil 19044) (Output/Callstack from Visual Studio 2022):</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Exception</span><span class=\"w\"> </span><span class=\"n\">thrown</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"mh\">0x000001C8322DBC49</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">codabix</span><span class=\"p\">.</span><span class=\"n\">exe</span>: <span class=\"mh\">0xC0000005</span>: <span class=\"nc\">Access</span><span class=\"w\"> </span><span class=\"n\">violation</span><span class=\"w\"> </span><span class=\"n\">writing</span><span class=\"w\"> </span><span class=\"n\">location</span><span class=\"w\"> </span><span class=\"mh\">0x0000007915423870</span><span class=\"p\">.</span><span class=\"w\"></span>\n\n<span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"mi\">000001</span><span class=\"n\">c8322dbc49</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832811490</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280d273</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323e68fc</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323019df</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832811490</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280d273</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83227a9d3</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323dc621</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323a77ec</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832811490</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280d273</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83227a9d3</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323dc621</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323a77ec</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280a735</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832478e00</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832472f78</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c448f0</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c8f1b4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83245a43f</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8321d174a</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8321d10d4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832e7f3cc</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832e7f9cb</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">wasmtime_setjmp</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN16wasmtime_runtime12traphandlers84_</span><span class=\"cp\">$LT$impl$u20$wasmtime_runtime</span><span class=\"o\">..</span><span class=\"n\">traphandlers</span><span class=\"o\">..</span><span class=\"n\">call_thread_state</span><span class=\"o\">..</span><span class=\"n\">CallThreadState</span><span class=\"cp\">$GT$</span><span class=\"mi\">4</span><span class=\"n\">with17hdfcdc5819fd3d891E</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN16wasmtime_runtime12traphandlers11catch_traps17h264d3d0c425ce7faE</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">    </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN8wasmtime4func4Func18call_unchecked_raw17h5925ade4c0f7f70cE</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"p\">.</span><span class=\"mi\">9894362628245677377</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN8wasmtime4func4Func9call_impl17h082023ddfcd49e51E</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"p\">.</span><span class=\"mi\">9894362628245677377</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">   </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">wasmtime_func_call</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41c1e6</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41bfac</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41bca1</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41bb35</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d419cdb</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41930b</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d35bc32</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d352d94</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d3495ff</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8cbfd678</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8cbfd53d</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8cbfd359</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">System</span><span class=\"p\">.</span><span class=\"n\">Private</span><span class=\"p\">.</span><span class=\"n\">CoreLib</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fff4f18274f</span><span class=\"p\">()</span><span class=\"w\">   </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec2eaac3</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1e6d9c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec2cc413</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1c36f5</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1c35fa</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1c3419</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">kernel32</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">ff80b6e74b4</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">ntdll</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">ff80c3026a1</span><span class=\"p\">()</span><span class=\"w\">    </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n</code></pre></div>\n<p>Using the previous commit (<a href=\"https://github.com/bytecodealliance/wasmtime/commit/33a192556e5f11ee95cffc7a90e74b78abc340c8\">https://github.com/bytecodealliance/wasmtime/commit/33a192556e5f11ee95cffc7a90e74b78abc340c8</a>), the accesss violation does not occur.</p>\n<p>While I can consistently reproduce the access violation in our application, it seems a bit hard to reproduce in a simple console app; also I can only reproduce it with a Wasmtime release build, bot nut with a debug build.<br>\nHowever, since it seems to have the same root cause as the excess compilation time, maybe it will automatically fixed together with this issue.</p>\n<p>Thanks!</p>\n</blockquote>",
        "id": 312581750,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669626421
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329261757\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>cc @fitzgen for the slowdown here</p>\n<p>For the crash you mention that the commit prior to 28cf995fd3f9926a95036758c78390f54a0289ae doesn't have the issue, but you also mention that it seems to have the same root cause with compliation time, and I'm curious what leads you to that conclusion? Additionally would you be able to share the .NET reproduction, even if it's tough to minimize further at this time?</p>\n</blockquote>",
        "id": 312648775,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669647950
    },
    {
        "content": "<p>kpreisser <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329283502\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Hi @alexcrichton,</p>\n<p>sorry, the \"same root cause\" was probably  a bit overstatement - I just noticed the crash starts happening together with the compilation slowdown, but I'm not actually sure if it really has the same root cause.</p>\n<p>I will try to isolate a .NET repro case of this crash, but it may take a while (I think a few days).</p>\n<p>Thank you!</p>\n</blockquote>",
        "id": 312651573,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669648752
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329457467\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>For the compile-time regression <a href=\"https://github.com/bytecodealliance/wasmtime/files/10106032/gc.wasm.gz\">gc.wasm.gz</a> is a single-function reproduction of the issue, taking 16s to compile locally on <code>main</code> and 252ms on 3.0.0 (I'm assuming the above bisection still stands, these just happened to be the builds I had on hand)</p>\n</blockquote>",
        "id": 312677278,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669655665
    },
    {
        "content": "<p>kpreisser edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1328750433\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Additionally, starting with the above mentioned commit 28cf995fd3f9926a95036758c78390f54a0289ae, we get an <strong>access violation</strong> in our application in <code>wasmtime_func_call</code> (via <code>Wasmtime.Dotnet</code>, for wasm function <code>\"_start\"</code>) when using the above mentioned <code>dotnet-codabix-wasm-build.wasm</code> (on Windows 10 x64 buil 19044) (Output/Callstack from Visual Studio 2022):</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Exception</span><span class=\"w\"> </span><span class=\"n\">thrown</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"mh\">0x000001C8322DBC49</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">codabix</span><span class=\"p\">.</span><span class=\"n\">exe</span>: <span class=\"mh\">0xC0000005</span>: <span class=\"nc\">Access</span><span class=\"w\"> </span><span class=\"n\">violation</span><span class=\"w\"> </span><span class=\"n\">writing</span><span class=\"w\"> </span><span class=\"n\">location</span><span class=\"w\"> </span><span class=\"mh\">0x0000007915423870</span><span class=\"p\">.</span><span class=\"w\"></span>\n\n<span class=\"o\">&gt;</span><span class=\"w\">   </span><span class=\"mi\">000001</span><span class=\"n\">c8322dbc49</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832811490</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280d273</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323e68fc</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323019df</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832811490</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280d273</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83227a9d3</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323dc621</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323a77ec</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832811490</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280d273</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83227a9d3</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323dc621</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8323a77ec</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8322db7f4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c4b87c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280b082</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83280a735</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832478e00</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832472f78</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c448f0</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832c8f1b4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c83245a43f</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8321d174a</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c8321d10d4</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832e7f3cc</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">000001</span><span class=\"n\">c832e7f9cb</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">wasmtime_setjmp</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN16wasmtime_runtime12traphandlers84_</span><span class=\"cp\">$LT$impl$u20$wasmtime_runtime</span><span class=\"o\">..</span><span class=\"n\">traphandlers</span><span class=\"o\">..</span><span class=\"n\">call_thread_state</span><span class=\"o\">..</span><span class=\"n\">CallThreadState</span><span class=\"cp\">$GT$</span><span class=\"mi\">4</span><span class=\"n\">with17hdfcdc5819fd3d891E</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN16wasmtime_runtime12traphandlers11catch_traps17h264d3d0c425ce7faE</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">    </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN8wasmtime4func4Func18call_unchecked_raw17h5925ade4c0f7f70cE</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"p\">.</span><span class=\"mi\">9894362628245677377</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">_ZN8wasmtime4func4Func9call_impl17h082023ddfcd49e51E</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"p\">.</span><span class=\"mi\">9894362628245677377</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">   </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">wasmtime</span><span class=\"p\">.</span><span class=\"n\">DLL</span><span class=\"o\">!</span><span class=\"n\">wasmtime_func_call</span><span class=\"w\"></span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41c1e6</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41bfac</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41bca1</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41bb35</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d419cdb</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d41930b</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d35bc32</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d352d94</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8d3495ff</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8cbfd678</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8cbfd53d</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">00007</span><span class=\"n\">fff8cbfd359</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">System</span><span class=\"p\">.</span><span class=\"n\">Private</span><span class=\"p\">.</span><span class=\"n\">CoreLib</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fff4f18274f</span><span class=\"p\">()</span><span class=\"w\">   </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec2eaac3</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1e6d9c</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec2cc413</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1c36f5</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1c35fa</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">coreclr</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">fffec1c3419</span><span class=\"p\">()</span><span class=\"w\">  </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">kernel32</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">ff80b6e74b4</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">ntdll</span><span class=\"p\">.</span><span class=\"n\">dll</span><span class=\"o\">!</span><span class=\"mi\">00007</span><span class=\"n\">ff80c3026a1</span><span class=\"p\">()</span><span class=\"w\">    </span><span class=\"n\">Unknown</span><span class=\"w\"></span>\n</code></pre></div>\n<p>Using the previous commit (<a href=\"https://github.com/bytecodealliance/wasmtime/commit/33a192556e5f11ee95cffc7a90e74b78abc340c8\">https://github.com/bytecodealliance/wasmtime/commit/33a192556e5f11ee95cffc7a90e74b78abc340c8</a>), the accesss violation does not occur.</p>\n<p>While I can consistently reproduce the access violation in our application, it seems a bit hard to reproduce in a simple console app; also I can only reproduce it with a Wasmtime release build, bot nut with a debug build.<br>\n&lt;del&gt;However, since it seems to have the same root cause as the excess compilation time, maybe it will automatically fixed together with this issue.&lt;/del&gt;</p>\n<p>Thanks!</p>\n</blockquote>",
        "id": 312684951,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669657534
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329503948\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Thanks for filing this bug @kpreisser! And thanks for the reproducer, Alex. Digging in.</p>\n</blockquote>",
        "id": 312685421,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669657678
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329518710\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>All the compilation time is in regalloc:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">RUST_LOG</span><span class=\"o\">=</span><span class=\"n\">wasmtime_cranelift</span><span class=\"o\">=</span><span class=\"n\">trace</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">release</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">disable</span><span class=\"o\">-</span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"o\">~/</span><span class=\"n\">scratch</span><span class=\"o\">/</span><span class=\"n\">slow</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"n\">release</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">optimized</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">debuginfo</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.16</span><span class=\"n\">s</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">release</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">disable</span><span class=\"o\">-</span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">nick</span><span class=\"o\">/</span><span class=\"n\">scratch</span><span class=\"o\">/</span><span class=\"n\">slow</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">wasmtime_cranelift</span>::<span class=\"n\">compiler</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">FuncIndex</span><span class=\"p\">(</span><span class=\"mi\">171</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">translated</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">11.172192689</span><span class=\"n\">s</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">wasmtime_cranelift</span>::<span class=\"n\">compiler</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">FuncIndex</span><span class=\"p\">(</span><span class=\"mi\">171</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">timing</span><span class=\"w\"> </span><span class=\"n\">info</span><span class=\"w\"></span>\n<span class=\"o\">========</span><span class=\"w\"> </span><span class=\"o\">========</span><span class=\"w\">  </span><span class=\"o\">==================================</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"n\">Total</span><span class=\"w\">     </span><span class=\"bp\">Self</span><span class=\"w\">  </span><span class=\"n\">Pass</span><span class=\"w\"></span>\n<span class=\"o\">--------</span><span class=\"w\"> </span><span class=\"o\">--------</span><span class=\"w\">  </span><span class=\"o\">----------------------------------</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.094</span><span class=\"w\">    </span><span class=\"mf\">0.094</span><span class=\"w\">  </span><span class=\"n\">Translate</span><span class=\"w\"> </span><span class=\"n\">WASM</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mf\">22.156</span><span class=\"w\">    </span><span class=\"mf\">0.087</span><span class=\"w\">  </span><span class=\"n\">Compilation</span><span class=\"w\"> </span><span class=\"n\">passes</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.003</span><span class=\"w\">    </span><span class=\"mf\">0.003</span><span class=\"w\">  </span><span class=\"n\">Control</span><span class=\"w\"> </span><span class=\"n\">flow</span><span class=\"w\"> </span><span class=\"n\">graph</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.013</span><span class=\"w\">    </span><span class=\"mf\">0.013</span><span class=\"w\">  </span><span class=\"n\">Dominator</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.001</span><span class=\"w\">    </span><span class=\"mf\">0.001</span><span class=\"w\">  </span><span class=\"n\">Loop</span><span class=\"w\"> </span><span class=\"n\">analysis</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.001</span><span class=\"w\">    </span><span class=\"mf\">0.001</span><span class=\"w\">  </span><span class=\"n\">Pre</span><span class=\"o\">-</span><span class=\"n\">legalization</span><span class=\"w\"> </span><span class=\"n\">rewriting</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.003</span><span class=\"w\">    </span><span class=\"mf\">0.003</span><span class=\"w\">  </span><span class=\"n\">Dead</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"n\">elimination</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.023</span><span class=\"w\">    </span><span class=\"mf\">0.023</span><span class=\"w\">  </span><span class=\"n\">Global</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">numbering</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.208</span><span class=\"w\">    </span><span class=\"mf\">0.026</span><span class=\"w\">  </span><span class=\"n\">Loop</span><span class=\"w\"> </span><span class=\"n\">invariant</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"n\">motion</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.000</span><span class=\"w\">    </span><span class=\"mf\">0.000</span><span class=\"w\">  </span><span class=\"n\">Remove</span><span class=\"w\"> </span><span class=\"n\">unreachable</span><span class=\"w\"> </span><span class=\"n\">blocks</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.003</span><span class=\"w\">    </span><span class=\"mf\">0.003</span><span class=\"w\">  </span><span class=\"n\">Remove</span><span class=\"w\"> </span><span class=\"n\">constant</span><span class=\"w\"> </span><span class=\"n\">phi</span><span class=\"o\">-</span><span class=\"n\">nodes</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.051</span><span class=\"w\">    </span><span class=\"mf\">0.051</span><span class=\"w\">  </span><span class=\"n\">VCode</span><span class=\"w\"> </span><span class=\"n\">lowering</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.018</span><span class=\"w\">    </span><span class=\"mf\">0.018</span><span class=\"w\">  </span><span class=\"n\">VCode</span><span class=\"w\"> </span><span class=\"n\">emission</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.001</span><span class=\"w\">    </span><span class=\"mf\">0.001</span><span class=\"w\">  </span><span class=\"n\">VCode</span><span class=\"w\"> </span><span class=\"n\">emission</span><span class=\"w\"> </span><span class=\"n\">finalization</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"mf\">10.673</span><span class=\"w\">   </span><span class=\"mf\">10.673</span><span class=\"w\">  </span><span class=\"n\">Register</span><span class=\"w\"> </span><span class=\"n\">allocation</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"mf\">0.176</span><span class=\"w\">    </span><span class=\"mf\">0.176</span><span class=\"w\">  </span><span class=\"n\">Layout</span><span class=\"w\"> </span><span class=\"n\">full</span><span class=\"w\"> </span><span class=\"n\">renumbering</span><span class=\"w\"></span>\n<span class=\"o\">========</span><span class=\"w\"> </span><span class=\"o\">========</span><span class=\"w\">  </span><span class=\"o\">==================================</span><span class=\"w\"></span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 312687944,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669658420
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329551724\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Added some logging for the number of vcode instructions and blocks we get after lowering.</p>\n<p>Before:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">lowered</span><span class=\"w\"> </span><span class=\"n\">vcode</span><span class=\"w\"> </span><span class=\"n\">instructions</span>: <span class=\"mi\">35194</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">lowered</span><span class=\"w\"> </span><span class=\"n\">vcode</span><span class=\"w\"> </span><span class=\"n\">blocks</span>: <span class=\"mi\">3972</span><span class=\"w\"></span>\n</code></pre></div>\n<p>After:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">lowered</span><span class=\"w\"> </span><span class=\"n\">vcode</span><span class=\"w\"> </span><span class=\"n\">instructions</span>: <span class=\"mi\">149067</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">lowered</span><span class=\"w\"> </span><span class=\"n\">vcode</span><span class=\"w\"> </span><span class=\"n\">blocks</span>: <span class=\"mi\">38237</span><span class=\"w\"></span>\n</code></pre></div>\n<p>So 4.2x more instructions and 9.6x more blocks. That's... more than expected.</p>\n</blockquote>",
        "id": 312693425,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669660029
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329585437\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>And the number of CLIF instructions and blocks we lower:</p>\n<p>Before:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">CLIF</span><span class=\"w\"> </span><span class=\"n\">instructions</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">lower</span>: <span class=\"mi\">98854</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">CLIF</span><span class=\"w\"> </span><span class=\"n\">blocks</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">lower</span>: <span class=\"mi\">2446</span><span class=\"w\"></span>\n</code></pre></div>\n<p>After:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">CLIF</span><span class=\"w\"> </span><span class=\"n\">instructions</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">lower</span>: <span class=\"mi\">279615</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"n\">DEBUG</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">compile</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Number</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">CLIF</span><span class=\"w\"> </span><span class=\"n\">blocks</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">lower</span>: <span class=\"mi\">36468</span><span class=\"w\"></span>\n</code></pre></div>\n<p>So 2.8x more clif instructions and 14.9x more clif blocks.</p>\n</blockquote>",
        "id": 312697772,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669661389
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329643481\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Okay so I took a look at the following Wasm, which does an identical load 20 times:</p>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"k\">module</span>\n  <span class=\"p\">(</span><span class=\"k\">memory</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"memory\"</span><span class=\"p\">)</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"f\"</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">result</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span><span class=\"p\">)</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n    <span class=\"nb\">local.get</span> <span class=\"mi\">0</span>\n    <span class=\"nb\">i32.load</span>\n  <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<p>Here is the final CLIF from before:</p>\n<p>&lt;details&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">lower</span><span class=\"w\">      </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">about</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">lower</span><span class=\"w\"> </span><span class=\"n\">function</span>: <span class=\"nc\">function</span><span class=\"w\"> </span><span class=\"n\">u0</span>:<span class=\"mi\">0</span><span class=\"p\">(</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">vmctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">wasmtime_system_v</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">vmctx</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">readonly</span><span class=\"w\"> </span><span class=\"n\">gv0</span><span class=\"o\">+</span><span class=\"mi\">8</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">gv1</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">vmctx</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">readonly</span><span class=\"w\"> </span><span class=\"n\">gv3</span><span class=\"o\">+</span><span class=\"mi\">80</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">heap0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">static</span><span class=\"w\"> </span><span class=\"n\">gv4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">bound</span><span class=\"w\"> </span><span class=\"mh\">0x0001_0000_0000</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">offset_guard</span><span class=\"w\"> </span><span class=\"mh\">0x8000_0000</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">index_type</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">stack_limit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">gv2</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block0</span><span class=\"p\">(</span><span class=\"n\">v0</span>: <span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v1</span>: <span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v2</span>: <span class=\"kt\">i32</span><span class=\"p\">)</span>:\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v63</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">uextend</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v2</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v64</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">readonly</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"o\">+</span><span class=\"mi\">80</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v23</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iadd</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v63</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v24</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v23</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">00</span><span class=\"n\">a5</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block1</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block1</span>:\n<span class=\"o\">@</span><span class=\"mi\">00</span><span class=\"n\">a5</span><span class=\"w\">                               </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v24</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>And here is the final clif after:</p>\n<p>&lt;details&gt;</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">TRACE</span><span class=\"w\"> </span><span class=\"n\">cranelift_codegen</span>::<span class=\"n\">machinst</span>::<span class=\"n\">lower</span><span class=\"w\">      </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">about</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">lower</span><span class=\"w\"> </span><span class=\"n\">function</span>: <span class=\"nc\">function</span><span class=\"w\"> </span><span class=\"n\">u0</span>:<span class=\"mi\">0</span><span class=\"p\">(</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">vmctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">wasmtime_system_v</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">vmctx</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">readonly</span><span class=\"w\"> </span><span class=\"n\">gv0</span><span class=\"o\">+</span><span class=\"mi\">8</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">gv1</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">vmctx</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">gv4</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">readonly</span><span class=\"w\"> </span><span class=\"n\">gv3</span><span class=\"o\">+</span><span class=\"mi\">80</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">heap0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">static</span><span class=\"w\"> </span><span class=\"n\">gv4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">min</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">bound</span><span class=\"w\"> </span><span class=\"mh\">0x0001_0000_0000</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">offset_guard</span><span class=\"w\"> </span><span class=\"mh\">0x8000_0000</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">index_type</span><span class=\"w\"> </span><span class=\"kt\">i32</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">stack_limit</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">gv2</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block0</span><span class=\"p\">(</span><span class=\"n\">v0</span>: <span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v1</span>: <span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v2</span>: <span class=\"kt\">i32</span><span class=\"p\">)</span>:\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v63</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">uextend</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v2</span><span class=\"w\"></span>\n<span class=\"w\">                                    </span><span class=\"n\">v70</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iconst</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"mh\">0xffff_fffc</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v64</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">icmp</span><span class=\"w\"> </span><span class=\"n\">ugt</span><span class=\"w\"> </span><span class=\"n\">v63</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v70</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v70</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mh\">0xffff_fffc</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block3</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block2</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block2</span>:\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block3</span>:\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v66</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">notrap</span><span class=\"w\"> </span><span class=\"n\">aligned</span><span class=\"w\"> </span><span class=\"n\">readonly</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"o\">+</span><span class=\"mi\">80</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v67</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iadd</span><span class=\"w\"> </span><span class=\"n\">v66</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v63</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iconst</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v23</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0043</span><span class=\"w\">                               </span><span class=\"n\">v24</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v23</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0048</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block5</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0048</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block4</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block4</span>:\n<span class=\"o\">@</span><span class=\"mi\">0048</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block5</span>:\n<span class=\"o\">@</span><span class=\"mi\">0048</span><span class=\"w\">                               </span><span class=\"n\">v25</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0048</span><span class=\"w\">                               </span><span class=\"n\">v26</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v25</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">004</span><span class=\"n\">d</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block7</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">004</span><span class=\"n\">d</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block6</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block6</span>:\n<span class=\"o\">@</span><span class=\"mi\">004</span><span class=\"n\">d</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block7</span>:\n<span class=\"o\">@</span><span class=\"mi\">004</span><span class=\"n\">d</span><span class=\"w\">                               </span><span class=\"n\">v27</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">004</span><span class=\"n\">d</span><span class=\"w\">                               </span><span class=\"n\">v28</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v27</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0052</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block9</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0052</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block8</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block8</span>:\n<span class=\"o\">@</span><span class=\"mi\">0052</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block9</span>:\n<span class=\"o\">@</span><span class=\"mi\">0052</span><span class=\"w\">                               </span><span class=\"n\">v29</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0052</span><span class=\"w\">                               </span><span class=\"n\">v30</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v29</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0057</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block11</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0057</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block10</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block10</span>:\n<span class=\"o\">@</span><span class=\"mi\">0057</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block11</span>:\n<span class=\"o\">@</span><span class=\"mi\">0057</span><span class=\"w\">                               </span><span class=\"n\">v31</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0057</span><span class=\"w\">                               </span><span class=\"n\">v32</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v31</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">005</span><span class=\"n\">c</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block13</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">005</span><span class=\"n\">c</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block12</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block12</span>:\n<span class=\"o\">@</span><span class=\"mi\">005</span><span class=\"n\">c</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block13</span>:\n<span class=\"o\">@</span><span class=\"mi\">005</span><span class=\"n\">c</span><span class=\"w\">                               </span><span class=\"n\">v33</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">005</span><span class=\"n\">c</span><span class=\"w\">                               </span><span class=\"n\">v34</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v33</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0061</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block15</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0061</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block14</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block14</span>:\n<span class=\"o\">@</span><span class=\"mi\">0061</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block15</span>:\n<span class=\"o\">@</span><span class=\"mi\">0061</span><span class=\"w\">                               </span><span class=\"n\">v35</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0061</span><span class=\"w\">                               </span><span class=\"n\">v36</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v35</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0066</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block17</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0066</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block16</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block16</span>:\n<span class=\"o\">@</span><span class=\"mi\">0066</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block17</span>:\n<span class=\"o\">@</span><span class=\"mi\">0066</span><span class=\"w\">                               </span><span class=\"n\">v37</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0066</span><span class=\"w\">                               </span><span class=\"n\">v38</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v37</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">006</span><span class=\"n\">b</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block19</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">006</span><span class=\"n\">b</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block18</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block18</span>:\n<span class=\"o\">@</span><span class=\"mi\">006</span><span class=\"n\">b</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block19</span>:\n<span class=\"o\">@</span><span class=\"mi\">006</span><span class=\"n\">b</span><span class=\"w\">                               </span><span class=\"n\">v39</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">006</span><span class=\"n\">b</span><span class=\"w\">                               </span><span class=\"n\">v40</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v39</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0070</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block21</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0070</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block20</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block20</span>:\n<span class=\"o\">@</span><span class=\"mi\">0070</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block21</span>:\n<span class=\"o\">@</span><span class=\"mi\">0070</span><span class=\"w\">                               </span><span class=\"n\">v41</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0070</span><span class=\"w\">                               </span><span class=\"n\">v42</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v41</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0075</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block23</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0075</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block22</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block22</span>:\n<span class=\"o\">@</span><span class=\"mi\">0075</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block23</span>:\n<span class=\"o\">@</span><span class=\"mi\">0075</span><span class=\"w\">                               </span><span class=\"n\">v43</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0075</span><span class=\"w\">                               </span><span class=\"n\">v44</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v43</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">a</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block25</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">a</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block24</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block24</span>:\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">a</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block25</span>:\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">a</span><span class=\"w\">                               </span><span class=\"n\">v45</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">a</span><span class=\"w\">                               </span><span class=\"n\">v46</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v45</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">f</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block27</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">f</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block26</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block26</span>:\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">f</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block27</span>:\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">f</span><span class=\"w\">                               </span><span class=\"n\">v47</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">007</span><span class=\"n\">f</span><span class=\"w\">                               </span><span class=\"n\">v48</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v47</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0084</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block29</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0084</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block28</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block28</span>:\n<span class=\"o\">@</span><span class=\"mi\">0084</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block29</span>:\n<span class=\"o\">@</span><span class=\"mi\">0084</span><span class=\"w\">                               </span><span class=\"n\">v49</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0084</span><span class=\"w\">                               </span><span class=\"n\">v50</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v49</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0089</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block31</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0089</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block30</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block30</span>:\n<span class=\"o\">@</span><span class=\"mi\">0089</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block31</span>:\n<span class=\"o\">@</span><span class=\"mi\">0089</span><span class=\"w\">                               </span><span class=\"n\">v51</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0089</span><span class=\"w\">                               </span><span class=\"n\">v52</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v51</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">008</span><span class=\"n\">e</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block33</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">008</span><span class=\"n\">e</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block32</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block32</span>:\n<span class=\"o\">@</span><span class=\"mi\">008</span><span class=\"n\">e</span><span class=\"w\">                               </span><span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"n\">heap_oob</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block33</span>:\n<span class=\"o\">@</span><span class=\"mi\">008</span><span class=\"n\">e</span><span class=\"w\">                               </span><span class=\"n\">v53</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">select_spectre_guard</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v67</span><span class=\"w\">  </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">v68</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">008</span><span class=\"n\">e</span><span class=\"w\">                               </span><span class=\"n\">v54</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">heap</span><span class=\"w\"> </span><span class=\"n\">v53</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0093</span><span class=\"w\">                               </span><span class=\"n\">brz</span><span class=\"p\">.</span><span class=\"kt\">i8</span><span class=\"w\"> </span><span class=\"n\">v64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">block35</span><span class=\"w\"></span>\n<span class=\"o\">@</span><span class=\"mi\">0093</span><span class=\"w\">                               </span><span class=\"n\">jump</span><span class=\"w\"> </span><span class=\"n\">block34</span><span class=\"w\"></span>\n\n<span class=\"w\">                                </span><span class=\"n\">block34</span>:\n<span class=\"o\">@</span><span class=\"mi\">0093</span><span class=\"w\"></span>\n<span class=\"p\">[</span><span class=\"n\">message</span><span class=\"w\"> </span><span class=\"n\">truncated</span><span class=\"p\">]</span><span class=\"w\"></span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 312706154,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669664056
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329663659\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Ah, the Spectre guard isn't needed in this case because the guard region is large enough: for any value in 0..2^32-1 of v2, the base+index will land in the guard. So it seems with the patch we are unnecessarily re-introducing Spectre guards; that's the problem, rather than something about the way we lower them.</p>\n</blockquote>",
        "id": 312708233,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669664773
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329738271\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Okay, before the heap access size is being reported as <code>1</code> which makes no sense since an <code>i32</code> is being loaded. In after, it is correctly reported as <code>4</code>. This pushes the limit just below the <code>0xffff_ffff</code> threshold where explicit bounds checks are needed.</p>\n<p>Trying to figure out why the access size changed at all here.</p>\n</blockquote>",
        "id": 312717266,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669668110
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329748369\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>The offset guard is sufficient for that, though, no? The heap is specified as 4GiB size plus 2GiB offset guard; so in the worst case if the inbound Wasm pointer (<code>v2</code> in CLIF) is <code>0xffff_ffff</code>, we will access up to <code>0x1_0000_0003</code> (inclusive), but that's within the +2GiB guard.</p>\n</blockquote>",
        "id": 312718974,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669668768
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329749052\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Yeah it seems this logic for factoring in guard page sizes was in <code>cranelift-wasm</code> rather than <code>heap_addr</code>. Trying to untangle now...</p>\n</blockquote>",
        "id": 312719076,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669668819
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1329881594\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Okay I've put up <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5335\">https://github.com/bytecodealliance/wasmtime/pull/5335</a> and also double checked that it returns us to our original compile times for this issue's test case.</p>\n</blockquote>",
        "id": 312740605,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669678061
    },
    {
        "content": "<p>kpreisser <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1330616441\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<blockquote>\n<p>I will try to isolate a .NET repro case of this crash, but it may take a while (I think a few days).</p>\n</blockquote>\n<p>I have now managed to isolate the .NET code required to reproduce the access violation with <code>Wasmtime.Dotnet</code>. I think I will create a new issue for that, as I'm not sure if it is actually related to the regression of the compile time.<br>\nThanks!</p>\n</blockquote>",
        "id": 312836563,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669726747
    },
    {
        "content": "<p>fitzgen closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Hi!</p>\n<p>I noticed that compiling an 8 MiB WASM module (produced by the experimental <a href=\"https://github.com/SteveSandersonMS/dotnet-wasi-sdk/\">WASI SDK for .NET</a>) when using Wasmtime from commit 28cf995fd3f9926a95036758c78390f54a0289ae (current <strong>dev</strong> release) takes much longer than when using Wasmtime 3.0.0 (tested on Windows 10 x64, Build 19044).</p>\n<p>To reproduce:</p>\n<ul>\n<li>Download the WASM file as .Zip file here (note: rename the <code>.mov</code> file to <code>.zip</code> ; I renamed it to be able to upload it here): <a href=\"https://user-images.githubusercontent.com/13289184/203989968-4639d6d5-15c9-4e57-bf01-c2eccd756642.mov\">https://user-images.githubusercontent.com/13289184/203989968-4639d6d5-15c9-4e57-bf01-c2eccd756642.mov</a></li>\n<li>Download and extract <code>wasmtime-v3.0.0-x86_64-windows.zip</code></li>\n<li>Run <code>wasmtime compile dotnet-codabix-wasm-build.wasm</code></li>\n<li>Then try the same with the current <strong>dev</strong> release from commit 28cf995fd3f9926a95036758c78390f54a0289ae.</li>\n</ul>\n<p>On my system, with Wasmtime <strong>3.0.0</strong> this takes about <strong>0.7</strong> seconds, but with the build from commit 28cf995fd3f9926a95036758c78390f54a0289ae it takes about <strong>13.8</strong> seconds, which is about 20 times as long.<br>\nIs this expected?</p>\n<p>Bisecting shows that this starts to appear with commit fc62d4ad65892837a1e1af5a9d67c8b0d4310efe (#5231) - with a release build from this commit, I get the 13.8s time, but with the previous commit 33a192556e5f11ee95cffc7a90e74b78abc340c8, I get a time of about 0.7s.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: Wasmtime v3.0.0 vs 28cf995fd3f9926a95036758c78390f54a0289ae<br>\nOperating system: Windows 10 Pro x64, Build 19044<br>\nArchitecture: x64 (x86-64)</p>\n<p>Thank you!</p>\n</blockquote>",
        "id": 312925552,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669751667
    },
    {
        "content": "<p>kpreisser <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328#issuecomment-1331969541\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/5328\">issue #5328</a>:</p>\n<blockquote>\n<p>Thank you for the quick fix of this issue!</p>\n</blockquote>",
        "id": 313032022,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1669805748
    }
]