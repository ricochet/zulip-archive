[
    {
        "content": "<p>fitzgen opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>:</p>\n<blockquote>\n<p>Still need to port filetests that use heaps over to a new thing, which I need to build and will land as a PR before this one.</p>\n</blockquote>",
        "id": 314318584,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670357872
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 314318763,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670357930
    },
    {
        "content": "<p>fitzgen edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>:</p>\n<blockquote>\n<p>Still need to port filetests that use heaps over to a new thing, which I need to build and will land as a PR before this one.</p>\n<p>Fixes #5823</p>\n</blockquote>",
        "id": 314324057,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670359804
    },
    {
        "content": "<p>fitzgen edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>:</p>\n<blockquote>\n<p>Still need to port filetests that use heaps over to a new thing, which I need to build and will land as a PR before this one.</p>\n<p>Fixes #5283</p>\n</blockquote>",
        "id": 314324090,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670359819
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315676843,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670962193
    },
    {
        "content": "<p><strong>fitzgen</strong> has marked <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> as ready for review.</p>",
        "id": 315677083,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670962255
    },
    {
        "content": "<p><strong>fitzgen</strong> requested <a href=\"https://github.com/cfallin\">cfallin</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a>.</p>",
        "id": 315677105,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670962260
    },
    {
        "content": "<p>afonso360 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216357370\">PR review</a>.</p>",
        "id": 315678316,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670962688
    },
    {
        "content": "<p>afonso360 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047691824\">PR review comment</a>:</p>\n<blockquote>\n<p>Was this file (and <code>fpromote</code>) removed by accident?</p>\n</blockquote>",
        "id": 315678317,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670962688
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315681267,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670963847
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315682651,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670964396
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216395195\">PR review</a>.</p>",
        "id": 315682659,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670964401
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216395195\">PR review</a>.</p>",
        "id": 315682660,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670964401
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047725897\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah good catch, I didn't realize there were non-heap bits in here too.</p>\n</blockquote>",
        "id": 315682661,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670964401
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315699227,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670970553
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216524742\">PR review</a>.</p>",
        "id": 315708038,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216524742\">PR review</a>.</p>",
        "id": 315708039,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047823503\">PR review comment</a>:</p>\n<blockquote>\n<p>Can we delete <code>heap.svg</code> (and <code>heap.dot</code>, which I think it was derived from) as well?</p>\n</blockquote>",
        "id": 315708040,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047839895\">PR review comment</a>:</p>\n<blockquote>\n<p>Can we document here what a <code>None</code> return value means? (I also looked in <code>bounds_checks</code> and <code>prepare_addr</code> doesn't seem to say either.) Does it mean that the access always traps (as one might infer from the \"set unreachable and return\" above)? Or something else?</p>\n</blockquote>",
        "id": 315708041,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047842444\">PR review comment</a>:</p>\n<blockquote>\n<p>minor nit: I think the <code>spectre</code> local makes the cases a bit more readable below, vs. expanding out <code>env.enable_heap_access_spectre_mitigation()</code> everywhere, but I don't feel too strongly about it if you want to inline it...</p>\n</blockquote>",
        "id": 315708042,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047827122\">PR review comment</a>:</p>\n<blockquote>\n<p>It's great that we have all of these tests now. One thought: could you say a bit more about what level of scrutiny all of the golden outputs have had? E.g. did you spot-check, or systematically check one variant for each axis, or read every golden output in this diff (props if so!), or...? To be clear I'm totally fine with checking one variant on each axis, given the size of the space we're spanning, I'm just curious for the review-record here.</p>\n</blockquote>",
        "id": 315708043,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047830897\">PR review comment</a>:</p>\n<blockquote>\n<p>The lack of heaps for interpreter tests is somewhat unfortunate; though we still do have stackslots (and tables and global values) in the <a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/interpreter/src/address.rs\">memory scheme</a> that the interpreter uses. I wonder if this test (and fpromote below) could be rewritten to use a stackslot and <code>stack_addr</code>, rather than deleted entirely, since the important bit seems to be a test of how certain ops combine with loads/stores?</p>\n</blockquote>",
        "id": 315708044,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047840329\">PR review comment</a>:</p>\n<blockquote>\n<p>Can we comment <em>why</em> we determine that the fallthrough point is unreachable here? (This goes along with the request to document what <code>None</code> means below.)</p>\n</blockquote>",
        "id": 315708045,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047852344\">PR review comment</a>:</p>\n<blockquote>\n<p>A bit more documentation might be good here; otherwise this API is a bit perplexing at first glance (below there is <code>make_heap</code>, so the translator is telling the environment about heaps, but here we provide information about heaps back to the translator, which is kind of subtle).</p>\n<p>Something like: \"The returned map should provide heap format details (encoded in <code>HeapData</code>) for each <code>Heap</code> that was previously returned by <code>make_heap()</code>. The translator will first call <code>make_heap</code> for each Wasm memory, and then later when translating code, will invoke <code>heaps()</code> to learn how to access the environment's implementation of each memory.\"</p>\n</blockquote>",
        "id": 315708046,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047854332\">PR review comment</a>:</p>\n<blockquote>\n<p>Also, I'm going back and forth on whether I like having so many individual files or larger consolidated files. On the one hand, I understand why you did it this way (easier to write the shell script to generate them, and it's nice to have separate test cases in separate files for running them individually, and it's easier to write the parser to get the settings once from the top of the file). On the other hand, it might be more approachable overall to have a single large file of autogenerated test cases, rather than a massive directory with intimidating filenames. Thoughts?</p>\n</blockquote>",
        "id": 315708047,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047841066\">PR review comment</a>:</p>\n<blockquote>\n<p>Can we document what a <code>None</code> return value means?</p>\n</blockquote>",
        "id": 315708049,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670974385
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315715407,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978236
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047892154\">PR review comment</a>:</p>\n<blockquote>\n<p>Done.</p>\n</blockquote>",
        "id": 315715417,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978246
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216617857\">PR review</a>.</p>",
        "id": 315715418,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978246
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216619953\">PR review</a>.</p>",
        "id": 315715728,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978448
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047893690\">PR review comment</a>:</p>\n<blockquote>\n<p>I vastly prefer many small files to one large file. Just so much easier to reason about and debug.</p>\n<p>I tried to hide them in their own dedicated directories to at least isolate the \"ahhhh!!! so many files!!!!\" reaction.</p>\n</blockquote>",
        "id": 315715729,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978448
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047895765\">PR review comment</a>:</p>\n<blockquote>\n<blockquote>\n<p>One thought: could you say a bit more about what level of scrutiny all of the golden outputs have had?</p>\n</blockquote>\n<p>I've spot checked a few of them, mostly Wasm-to-CLIF outputs, definitely haven't gone through all of them.</p>\n<p>I think the primary value is for the future: they really shouldn't change unless we expect them to, and when we do improve these sequences we can give the ones that changed a deeper level of scrutiny.</p>\n</blockquote>",
        "id": 315716173,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978723
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216622970\">PR review</a>.</p>",
        "id": 315716174,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978723
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216623581\">PR review</a>.</p>",
        "id": 315716298,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978783
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047896213\">PR review comment</a>:</p>\n<blockquote>\n<p>Yeah, it means the access always traps. Will add comments.</p>\n</blockquote>",
        "id": 315716300,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670978783
    },
    {
        "content": "<p>jameysharp submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1216630705\">PR review</a>.</p>",
        "id": 315717375,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670979430
    },
    {
        "content": "<p>jameysharp created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1047901629\">PR review comment</a>:</p>\n<blockquote>\n<p>A suggestion: It might help to land as many of the wasm tests as possible separately, before this PR removes Cranelift's heap support, so we can see whether this PR changes the generated sequences. I think we can't merge any test changes involving the existing <code>heap_addr</code> CLIF instruction.</p>\n<p>But filetests which go from .wat to native assembly should provide good information about the effect of this PR. That way the golden outputs initially are \"whatever we do today\", and their value as regression tests begins immediately.</p>\n<p>Can filetests invoke specific legalization passes? The new wasm-to-CLIF filetests in this PR could also be added beforehand if we can test what the generated CLIF looks like after legalizing heap instructions.</p>\n</blockquote>",
        "id": 315717376,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1670979430
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1217002567\">PR review</a>.</p>",
        "id": 315761414,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671007108
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1048158328\">PR review comment</a>:</p>\n<blockquote>\n<p>I don't think it can invoke specific legalization passes, but it can test the output of legalization as a whole if you input clif ir rather than wasm.</p>\n</blockquote>",
        "id": 315761416,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671007108
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#pullrequestreview-1218176794\">PR review</a>.</p>",
        "id": 315905828,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671048367
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386#discussion_r1048926402\">PR review comment</a>:</p>\n<blockquote>\n<p>I've pulled out the tests to <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5439\">https://github.com/bytecodealliance/wasmtime/pull/5439</a> so we can check for regressions and perturbations in this PR after I rebase.</p>\n</blockquote>",
        "id": 315905829,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671048367
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315922334,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671054959
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315925318,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671056182
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315926777,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671056882
    },
    {
        "content": "<p>fitzgen has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a>.</p>",
        "id": 315926865,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671056904
    },
    {
        "content": "<p>fitzgen updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a> from <code>no-heaps-in-clif</code> to <code>main</code>.</p>",
        "id": 315936767,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671061931
    },
    {
        "content": "<p>fitzgen merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5386\">PR #5386</a>.</p>",
        "id": 315940295,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1671064011
    }
]