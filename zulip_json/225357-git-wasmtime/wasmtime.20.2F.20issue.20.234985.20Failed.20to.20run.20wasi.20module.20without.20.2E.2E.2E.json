[
    {
        "content": "<p>12101111 opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>Compile this C code using wasi-sdk (wasi-libc is compiled with <code>THREAD_MODEL=posix</code>)</p>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"kt\">int</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">pthread</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wl</span><span class=\"p\">,</span><span class=\"o\">--</span><span class=\"n\">import</span><span class=\"o\">-</span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Os</span><span class=\"w\"> </span><span class=\"n\">hello</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n<span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"n\">dis</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"k\">module</span>\n <span class=\"p\">(</span><span class=\"k\">type</span> <span class=\"nv\">$i32_=&gt;_none</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n <span class=\"p\">(</span><span class=\"k\">type</span> <span class=\"nv\">$none_=&gt;_none</span> <span class=\"p\">(</span><span class=\"k\">func</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"wasi_snapshot_preview1\"</span> <span class=\"s2\">\"proc_exit\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$fimport$0</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"_start\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$0</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$0</span>\n  <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$fimport$0</span>\n   <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">42</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">unreachable</span><span class=\"p\">)</span>\n <span class=\"p\">)</span>\n <span class=\"c1\">;; custom section \"producers\", size 108</span>\n <span class=\"c1\">;; features section: threads, mutable-globals, bulk-memory, sign-ext</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>Exit with code 42</p>\n<h3>Actual Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">missing</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n           <span class=\"mi\">0</span>:   <span class=\"mh\">0x4f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n</code></pre></div>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: <code>wasmtime-cli 1.0.1</code></p>\n<p>Operating system: macOS 12.6</p>\n<p>Architecture: aarch64<br>\n</p>\n</blockquote>",
        "id": 301583764,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664522058
    },
    {
        "content": "<p>12101111 labeled <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>Compile this C code using wasi-sdk (wasi-libc is compiled with <code>THREAD_MODEL=posix</code>)</p>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"kt\">int</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">pthread</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wl</span><span class=\"p\">,</span><span class=\"o\">--</span><span class=\"n\">import</span><span class=\"o\">-</span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Os</span><span class=\"w\"> </span><span class=\"n\">hello</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n<span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"n\">dis</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"k\">module</span>\n <span class=\"p\">(</span><span class=\"k\">type</span> <span class=\"nv\">$i32_=&gt;_none</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n <span class=\"p\">(</span><span class=\"k\">type</span> <span class=\"nv\">$none_=&gt;_none</span> <span class=\"p\">(</span><span class=\"k\">func</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"wasi_snapshot_preview1\"</span> <span class=\"s2\">\"proc_exit\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$fimport$0</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"_start\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$0</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$0</span>\n  <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$fimport$0</span>\n   <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">42</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">unreachable</span><span class=\"p\">)</span>\n <span class=\"p\">)</span>\n <span class=\"c1\">;; custom section \"producers\", size 108</span>\n <span class=\"c1\">;; features section: threads, mutable-globals, bulk-memory, sign-ext</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>Exit with code 42</p>\n<h3>Actual Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">missing</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n           <span class=\"mi\">0</span>:   <span class=\"mh\">0x4f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n</code></pre></div>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: <code>wasmtime-cli 1.0.1</code></p>\n<p>Operating system: macOS 12.6</p>\n<p>Architecture: aarch64<br>\n</p>\n</blockquote>",
        "id": 301583765,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664522058
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985#issuecomment-1263235721\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<p>Wasi requires the wasm module to export the linear memory, not import it.</p>\n</blockquote>",
        "id": 301589370,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664524520
    },
    {
        "content": "<p>12101111 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985#issuecomment-1263292198\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<p>When threads is enabled, the linear memory should import from host, otherwise there is no way to share single memory across threads.</p>\n<p>And in this case, the linear memory is not used. It should be valid for wasi.</p>\n</blockquote>",
        "id": 301597148,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664527637
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985#issuecomment-1263367397\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<p>Wasi currently doesn't support threads.</p>\n</blockquote>",
        "id": 301608568,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664532061
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>Compile this C code using wasi-sdk (wasi-libc is compiled with <code>THREAD_MODEL=posix</code>)</p>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"kt\">int</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">pthread</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wl</span><span class=\"p\">,</span><span class=\"o\">--</span><span class=\"n\">import</span><span class=\"o\">-</span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Os</span><span class=\"w\"> </span><span class=\"n\">hello</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n<span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"n\">dis</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"k\">module</span>\n <span class=\"p\">(</span><span class=\"k\">type</span> <span class=\"nv\">$i32_=&gt;_none</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n <span class=\"p\">(</span><span class=\"k\">type</span> <span class=\"nv\">$none_=&gt;_none</span> <span class=\"p\">(</span><span class=\"k\">func</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"wasi_snapshot_preview1\"</span> <span class=\"s2\">\"proc_exit\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$fimport$0</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"_start\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$0</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$0</span>\n  <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$fimport$0</span>\n   <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">42</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">unreachable</span><span class=\"p\">)</span>\n <span class=\"p\">)</span>\n <span class=\"c1\">;; custom section \"producers\", size 108</span>\n <span class=\"c1\">;; features section: threads, mutable-globals, bulk-memory, sign-ext</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"></span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>Exit with code 42</p>\n<h3>Actual Results</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span><span class=\"w\"></span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"n\">default</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">missing</span><span class=\"w\"> </span><span class=\"n\">required</span><span class=\"w\"> </span><span class=\"n\">memory</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n           <span class=\"mi\">0</span>:   <span class=\"mh\">0x4f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n</code></pre></div>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: <code>wasmtime-cli 1.0.1</code></p>\n<p>Operating system: macOS 12.6</p>\n<p>Architecture: aarch64<br>\n</p>\n</blockquote>",
        "id": 301660128,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664548093
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985#issuecomment-1263649419\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/4985\">issue #4985</a>:</p>\n<blockquote>\n<p>This is an expected result of the WASI implementation today which is that despite some hostcalls not needing access to the wasm module's linear memory they all require access anyway. This ends up not being much of a problem in practice since modules which don't use a linear memory tend to not be too interesting. Solving this issue has been punted to the component model.</p>\n<p>Otherwise as mentioned WASI doesn't support shared linear memory today with threads. Additionally Wasmtime does not have a complete implementation of the threads proposal.</p>\n</blockquote>",
        "id": 301660129,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664548093
    }
]