[
    {
        "content": "<p>darinmorrison opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a> from <code>ci-cargo-audit</code> to <code>master</code>:</p>\n<blockquote>\n<p>This PR adds a <a href=\"https://github.com/RustSec/cargo-audit\" target=\"_blank\" title=\"https://github.com/RustSec/cargo-audit\"><code>cargo-audit</code></a> job to the github actions workflow to scan <code>Cargo.lock</code> for crates with known security vulnerabilities.</p>\n<p>The first time the job is run, or whenever a new <code>cargo-audit</code> release is published, the job will take a few minutes since it has to fetch and build the binary. However, the binary is cached so subsequent runs will only take a few seconds.</p>\n</blockquote>",
        "id": 190554190,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584133285
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-374622805\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-374622805\">PR Review</a>.</p>",
        "id": 190555457,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584133970
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r392480433\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r392480433\">PR Review Comment</a>:</p>\n<blockquote>\n<p>This seems like it's a lot of stuff to skip <code>cargo install</code>, is this all necessary? Most of our CI jobs aren't exactly speedy, how long does <code>cargo install</code> take on CI without caching?</p>\n<p>Another alternative here is that Cargo now caches by default, so we could <code>cargo install</code> with a custom <code>--root</code> and cache that directory. Cargo will then automatically only update if necessary.</p>\n</blockquote>",
        "id": 190555458,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584133971
    },
    {
        "content": "<p>darinmorrison submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-374748930\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-374748930\">PR Review</a>.</p>",
        "id": 190610779,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584214490
    },
    {
        "content": "<p>darinmorrison created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r392613379\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r392613379\">PR Review Comment</a>:</p>\n<blockquote>\n<blockquote>\n<p>This seems like it's a lot of stuff to skip <code>cargo install</code>, is this all necessary? Most of our CI jobs aren't exactly speedy, how long does <code>cargo install</code> take on CI without caching?</p>\n</blockquote>\n<p>When the job ran this time it took <code>5m 40s</code>. Most of the time I've seen the cached job run (on my other projects) it usually takes less than <code>15s</code>.</p>\n<blockquote>\n<p>Another alternative here is that Cargo now caches by default, so we could <code>cargo install</code> with a custom <code>--root</code> and cache that directory. Cargo will then automatically only update if necessary.</p>\n</blockquote>\n<p>Hmm, what would that look like?</p>\n<p>The way the github actions caching works is you have to provide a key to retrieve the cache. In this case, the key is calculated by hashing <code>.github/caching/cargo-audit.lock</code>, which in turn is generated by fetching the current release version of <code>cargo-audit</code>. So the key will only change when the version changes, which results in rebuilding the binary (and saving a new cache).</p>\n<p>What would you use for the key in this alternative approach?</p>\n<p>You could use a constant value that would result in the cache always being restored but then it wouldn't save any new changes to the cache from <code>cargo install</code>, as far as I understand.</p>\n<p>Instead you'd always get something like this:</p>\n<div class=\"codehilite\"><pre><span></span>Cache hit occurred on the primary key &lt;some constant value&gt;, not saving cache.\n</pre></div>\n\n\n</blockquote>",
        "id": 190610780,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584214490
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r392613844\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r392613844\">PR Review Comment</a>:</p>\n<blockquote>\n<p>You could use the contents of <code>~/.cargo/.crates2.json</code> as cache key to cache <code>~/.cargo/bin</code>. You do need to run <code>sudo chown -R $(whoami):$(id -ng) ~/.cargo/</code> (including trailing <code>/</code>!) to prevent permission problems when restoring the cache. See <a href=\"https://github.com/actions/cache/issues/133#issuecomment-599102035\" target=\"_blank\" title=\"https://github.com/actions/cache/issues/133#issuecomment-599102035\">https://github.com/actions/cache/issues/133#issuecomment-599102035</a> and the rest of the issue for more info.</p>\n</blockquote>",
        "id": 190611098,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584214921
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-374749307\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-374749307\">PR Review</a>.</p>",
        "id": 190611099,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584214921
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-376119443\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-376119443\">PR Review</a>.</p>",
        "id": 190860113,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584457326
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r393745079\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r393745079\">PR Review Comment</a>:</p>\n<blockquote>\n<p>I think the key here doesn't need to matter so much because Cargo does its own internal caching now. This could <code>cargo install --root /path/to/custom</code>, and cache <code>/path/to/custom</code>, and Cargo should take care of the rest. (and this should be simplified by quite a bit)</p>\n</blockquote>",
        "id": 190860114,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584457326
    },
    {
        "content": "<p>darinmorrison created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r393898837\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r393898837\">PR Review Comment</a>:</p>\n<blockquote>\n<p>@alexcrichton the part about Cargo doing it's own caching makes sense to me but I don't understand how we could take advantage of that in GitHub actions. The GitHub actions caching (unlike Travis) doesn't automatically save changes to cached directories each run; it generates an entirely new cache but only when there is a miss from looking up a new key. (You can observe whether or not it saves the caches for a given run in the <code>Post Cache</code> steps for the job).</p>\n<p>So the way I understand it is that even if Cargo is making incremental changes to a cache, those won't be saved until the key changes. There may be a way to work around this by saving and restoring the cached directories as an <em>artifact</em> but I think that would be more complicated.</p>\n<p>But even if we were able to use Cargo's internal caching, wouldn't we need to cache <code>~/.cargo</code> as well as the custom root?</p>\n</blockquote>",
        "id": 190894456,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584471031
    },
    {
        "content": "<p>darinmorrison submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-376315120\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-376315120\">PR Review</a>.</p>",
        "id": 190894457,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584471031
    },
    {
        "content": "<p>darinmorrison updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a> from <code>ci-cargo-audit</code> to <code>master</code>:</p>\n<blockquote>\n<p>This PR adds a <a href=\"https://github.com/RustSec/cargo-audit\" target=\"_blank\" title=\"https://github.com/RustSec/cargo-audit\"><code>cargo-audit</code></a> job to the github actions workflow to scan <code>Cargo.lock</code> for crates with known security vulnerabilities.</p>\n<p>The first time the job is run, or whenever a new <code>cargo-audit</code> release is published, the job will take a few minutes since it has to fetch and build the binary. However, the binary is cached so subsequent runs will only take a few seconds.</p>\n</blockquote>",
        "id": 191188810,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584661765
    },
    {
        "content": "<p>darinmorrison updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a> from <code>ci-cargo-audit</code> to <code>master</code>:</p>\n<blockquote>\n<p>This PR adds a <a href=\"https://github.com/RustSec/cargo-audit\" target=\"_blank\" title=\"https://github.com/RustSec/cargo-audit\"><code>cargo-audit</code></a> job to the github actions workflow to scan <code>Cargo.lock</code> for crates with known security vulnerabilities.</p>\n<p>The first time the job is run, or whenever a new <code>cargo-audit</code> release is published, the job will take a few minutes since it has to fetch and build the binary. However, the binary is cached so subsequent runs will only take a few seconds.</p>\n</blockquote>",
        "id": 191271066,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584723475
    },
    {
        "content": "<p>darinmorrison updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a> from <code>ci-cargo-audit</code> to <code>master</code>:</p>\n<blockquote>\n<p>This PR adds a <a href=\"https://github.com/RustSec/cargo-audit\" target=\"_blank\" title=\"https://github.com/RustSec/cargo-audit\"><code>cargo-audit</code></a> job to the github actions workflow to scan <code>Cargo.lock</code> for crates with known security vulnerabilities.</p>\n<p>The first time the job is run, or whenever a new <code>cargo-audit</code> release is published, the job will take a few minutes since it has to fetch and build the binary. However, the binary is cached so subsequent runs will only take a few seconds.</p>\n</blockquote>",
        "id": 191273876,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584724655
    },
    {
        "content": "<p>darinmorrison updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a> from <code>ci-cargo-audit</code> to <code>master</code>:</p>\n<blockquote>\n<p>This PR adds a <a href=\"https://github.com/RustSec/cargo-audit\" target=\"_blank\" title=\"https://github.com/RustSec/cargo-audit\"><code>cargo-audit</code></a> job to the github actions workflow to scan <code>Cargo.lock</code> for crates with known security vulnerabilities.</p>\n<p>The first time the job is run, or whenever a new <code>cargo-audit</code> release is published, the job will take a few minutes since it has to fetch and build the binary. However, the binary is cached so subsequent runs will only take a few seconds.</p>\n</blockquote>",
        "id": 191280508,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584727596
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-379457852\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-379457852\">PR Review</a>.</p>",
        "id": 191476753,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584972192
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r396473604\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r396473604\">PR Review Comment</a>:</p>\n<blockquote>\n<p>I think this will want to use <code>--vers</code> to install the version in <code>CARGO_AUDIT_VERSION</code>?</p>\n</blockquote>",
        "id": 191476754,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584972192
    },
    {
        "content": "<p>darinmorrison updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a> from <code>ci-cargo-audit</code> to <code>master</code>:</p>\n<blockquote>\n<p>This PR adds a <a href=\"https://github.com/RustSec/cargo-audit\" target=\"_blank\" title=\"https://github.com/RustSec/cargo-audit\"><code>cargo-audit</code></a> job to the github actions workflow to scan <code>Cargo.lock</code> for crates with known security vulnerabilities.</p>\n<p>The first time the job is run, or whenever a new <code>cargo-audit</code> release is published, the job will take a few minutes since it has to fetch and build the binary. However, the binary is cached so subsequent runs will only take a few seconds.</p>\n</blockquote>",
        "id": 191506105,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584983671
    },
    {
        "content": "<p>darinmorrison submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-379661616\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-379661616\">PR Review</a>.</p>",
        "id": 191508570,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584984713
    },
    {
        "content": "<p>darinmorrison created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r396629632\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#discussion_r396629632\">PR Review Comment</a>:</p>\n<blockquote>\n<p>Oops, forgot about that. Fixed in the recent push.</p>\n</blockquote>",
        "id": 191508571,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1584984714
    },
    {
        "content": "<p>sunfishcode submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-380558651\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314#pullrequestreview-380558651\">PR Review</a>.</p>",
        "id": 191648833,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1585072290
    },
    {
        "content": "<p>alexcrichton merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/1314\" target=\"_blank\" title=\"https://github.com/bytecodealliance/wasmtime/pull/1314\">PR #1314</a>.</p>",
        "id": 191649577,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1585072637
    }
]