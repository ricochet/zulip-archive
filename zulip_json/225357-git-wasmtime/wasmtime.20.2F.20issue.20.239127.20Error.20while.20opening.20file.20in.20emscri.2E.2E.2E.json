[
    {
        "content": "<p><a href=\"https://github.com/himakshi25\">himakshi25</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">Issue #9127</a>.</p>",
        "id": 462349977,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723643307
    },
    {
        "content": "<p>himakshi25 opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Created a wasm of a simple c program with command: <code>emcc main.c -o file.wasm</code>.<br>\nProgram is trying to open a file present in test directory.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"c1\">// main.c</span>\n<span class=\"p\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdio</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"Hello world!</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">FILE</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">fopen</span><span class=\"p\">(</span><span class=\"s\">\"test/hello_world_file.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"rb\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">file</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"cannot open file</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">feof</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"kt\">char</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">fgetc</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"n\">EOF</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">            </span><span class=\"n\">putchar</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"n\">fclose</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>On running file.wasm with wasmtime with command <code>wasmtime file.wasm</code> got the below error</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Hello</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"o\">!</span>\n<span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">file</span>\n</code></pre></div>\n<p>Also, tried giving directory as well in wasmtime but didn't work and got same error.<br>\ncommand <code>wasmtime --dir=test file.wasm</code></p>\n<p>Is there any way to allow wasmtimes to access or mount local directory for file read and write?</p>\n</blockquote>",
        "id": 462349980,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723643307
    },
    {
        "content": "<p>himakshi25 edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Created a wasm of a simple c program with command: <code>emcc main.c -o file.wasm</code>.<br>\nProgram is trying to open a file present in test directory.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"c1\">// main.c</span>\n<span class=\"p\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdio</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"Hello world!</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">FILE</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">fopen</span><span class=\"p\">(</span><span class=\"s\">\"test/hello_world_file.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"rb\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">file</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"cannot open file</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">feof</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"kt\">char</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">fgetc</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"n\">EOF</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">            </span><span class=\"n\">putchar</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"n\">fclose</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>On running file.wasm with wasmtime with command <code>wasmtime file.wasm</code> got the below error</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Hello</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"o\">!</span>\n<span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">file</span>\n</code></pre></div>\n<p>Also, tried giving directory as well in wasmtime but didn't work and got same error.<br>\ncommand <code>wasmtime --dir=test file.wasm</code></p>\n<p>Is there any way to allow wasmtime to access or mount local directory for file read and write?</p>\n</blockquote>",
        "id": 462350047,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723643339
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2288824574\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Unless you enabled the <code>PURE_WASI</code> mode, Emscripten compiled modules are not guaranteed to be WASI compatible. I don't know if that is the reason it failed here, but it is something to keep in mind.</p>\n</blockquote>",
        "id": 462350806,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723643642
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2289023862\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Have you tried <code>--dir .</code> perhaps? By default guests have no access to the filesystem so <code>wasmtime file.wasm</code> won't work. The <code>--dir test</code> argument I don't think will work because that makes <code>test</code> the root of the filesystem where the program wants to open a directory called <code>test</code> so the root needs to be one level higher. If that doesn't work casn you upload the wasm binary here?</p>\n</blockquote>",
        "id": 462361235,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723646841
    },
    {
        "content": "<p>himakshi25 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2292064058\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Yeah, I tried without <code>PURE_WASI</code> mode and this might be the possible reason, Sharing file below to confirm.<br>\n<a href=\"https://github.com/user-attachments/files/16628956/wasm.zip\">wasm.zip</a></p>\n<p>As suggested, tried with <code>PURE_WASI</code> mode. <br>\ncommand: <code>emcc main.cpp -o file.wasm -s PURE_WASI</code><br>\nGetting same error, sharing the wasm binary as well.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Hello</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"o\">!</span>\n<span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">file</span>\n</code></pre></div>\n<p><a href=\"https://github.com/user-attachments/files/16629595/wasm_pure_wasi.zip\">wasm_pure_wasi.zip</a></p>\n<p>Could you please help to know if I am missing any other argument here?</p>\n</blockquote>",
        "id": 462625512,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723750888
    },
    {
        "content": "<p>himakshi25 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2292064058\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>@bjorn3 Yeah, I tried without <code>PURE_WASI</code> mode and this might be the possible reason, Sharing file below to confirm.<br>\n<a href=\"https://github.com/user-attachments/files/16628956/wasm.zip\">wasm.zip</a></p>\n<p>As suggested, tried with <code>PURE_WASI</code> mode. <br>\ncommand: <code>emcc main.cpp -o file.wasm -s PURE_WASI</code><br>\nGetting same error, sharing the wasm binary as well.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Hello</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"o\">!</span>\n<span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">file</span>\n</code></pre></div>\n<p><a href=\"https://github.com/user-attachments/files/16629595/wasm_pure_wasi.zip\">wasm_pure_wasi.zip</a></p>\n<p>Could you please help to know if I am missing any other argument here?</p>\n</blockquote>",
        "id": 462625568,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723750908
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2292270134\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>I think this is an issue with a flag needing to be passed to emscripten or similar. The wasm binaries here have these imports:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"s\">\"wasi_snapshot_preview1\"</span><span class=\"w\"> </span><span class=\"s\">\"proc_exit\"</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"p\">(;</span><span class=\"mi\">0</span><span class=\"p\">;)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"k\">type</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"p\">)))</span>\n<span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"s\">\"wasi_snapshot_preview1\"</span><span class=\"w\"> </span><span class=\"s\">\"fd_write\"</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"p\">(;</span><span class=\"mi\">1</span><span class=\"p\">;)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"k\">type</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"p\">)))</span>\n<span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"s\">\"wasi_snapshot_preview1\"</span><span class=\"w\"> </span><span class=\"s\">\"fd_read\"</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"p\">(;</span><span class=\"mi\">2</span><span class=\"p\">;)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"k\">type</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"p\">)))</span>\n<span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"s\">\"wasi_snapshot_preview1\"</span><span class=\"w\"> </span><span class=\"s\">\"fd_close\"</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"p\">(;</span><span class=\"mi\">3</span><span class=\"p\">;)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"k\">type</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">)))</span>\n<span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"s\">\"wasi_snapshot_preview1\"</span><span class=\"w\"> </span><span class=\"s\">\"fd_seek\"</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"w\"> </span><span class=\"p\">(;</span><span class=\"mi\">4</span><span class=\"p\">;)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"k\">type</span><span class=\"w\"> </span><span class=\"mi\">12</span><span class=\"p\">)))</span>\n</code></pre></div>\n<p>but none of those are the import to open a host file. This means that the wasm binary is not even trying to open a host file. This makes me think the issue is with the binary itself (e.g. configuration of emscripten) rather than Wasmtime.</p>\n</blockquote>",
        "id": 462642050,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1723756412
    },
    {
        "content": "<p>rggaur789 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296079709\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Hi @alexcrichton ,<br>\nI have tried the below simple c++ code</p>\n<p>#include &lt;iostream&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">std</span><span class=\"p\">::</span><span class=\"n\">cout</span><span class=\"w\"> </span><span class=\"o\">&lt;&lt;</span><span class=\"w\"> </span><span class=\"s\">\"Hello World!</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>with command <code>emcc main.cpp -o file.wasm -s PURE_WASI</code></p>\n<p>and <code>wasmtime file.wasm</code></p>\n<p>but I am getting</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">file</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">instantiate</span><span class=\"w\"> </span><span class=\"s\">\"file.wasm\"</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">unknown</span><span class=\"w\"> </span><span class=\"n\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">env</span><span class=\"p\">::</span><span class=\"n\">_tzset_js</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">defined</span>\n</code></pre></div>\n<p>I am using emscripten and wasmtime latest versions. Can you please help what I am doing wrong here?</p>\n</blockquote>",
        "id": 463354257,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724059022
    },
    {
        "content": "<p>rggaur789 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296079709\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Hi @alexcrichton ,<br>\nI have tried the below simple c++ code</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">iostream</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">std</span><span class=\"p\">::</span><span class=\"n\">cout</span><span class=\"w\"> </span><span class=\"o\">&lt;&lt;</span><span class=\"w\"> </span><span class=\"s\">\"Hello World!</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>with command <code>emcc main.cpp -o file.wasm -s PURE_WASI</code></p>\n<p>and <code>wasmtime file.wasm</code></p>\n<p>but I am getting</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">file</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">instantiate</span><span class=\"w\"> </span><span class=\"s\">\"file.wasm\"</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">unknown</span><span class=\"w\"> </span><span class=\"n\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">env</span><span class=\"p\">::</span><span class=\"n\">_tzset_js</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">defined</span>\n</code></pre></div>\n<p>I am using emscripten and wasmtime latest versions. Can you please help what I am doing wrong here?</p>\n</blockquote>",
        "id": 463354356,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724059059
    },
    {
        "content": "<p>rggaur789 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296079709\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Hi @alexcrichton / @bjorn3  ,<br>\nI have tried the below simple c++ code</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">iostream</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">std</span><span class=\"p\">::</span><span class=\"n\">cout</span><span class=\"w\"> </span><span class=\"o\">&lt;&lt;</span><span class=\"w\"> </span><span class=\"s\">\"Hello World!</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>with command <code>emcc main.cpp -o file.wasm -s PURE_WASI</code></p>\n<p>and <code>wasmtime file.wasm</code></p>\n<p>but I am getting</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">file</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">instantiate</span><span class=\"w\"> </span><span class=\"s\">\"file.wasm\"</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">unknown</span><span class=\"w\"> </span><span class=\"n\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">env</span><span class=\"p\">::</span><span class=\"n\">_tzset_js</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">defined</span>\n</code></pre></div>\n<p>I am using emscripten and wasmtime latest versions. Can you please help what I am doing wrong here?</p>\n</blockquote>",
        "id": 463354512,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724059105
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296085858\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>It may be the case that the PURE_WASI mode of Emscripten is broken. It is marked as experimental anyway.</p>\n<p>You may have more luck using wasi-sdk instead of Emscripten: <a href=\"https://github.com/webassembly/wasi-sdk\">https://github.com/webassembly/wasi-sdk</a></p>\n</blockquote>",
        "id": 463354775,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724059206
    },
    {
        "content": "<p>rggaur789 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296088619\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>@bjorn3 I have tried with -s STANDALONE_WASM also but the result is same.</p>\n</blockquote>",
        "id": 463354996,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724059293
    },
    {
        "content": "<p>rggaur789 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296088619\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>@bjorn3 I have tried with -s STANDALONE_WASM also but the result is same,<br>\nalso in wasi-sdk c++ exception is not supported so it will not be compatible with our uses cases</p>\n</blockquote>",
        "id": 463386123,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724069631
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2296758362\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>@rggaur789 you're asking questions here that require a deeper knowledge of Emscripten than I think many of us have. I'd recommend raising questions with the Emscripten side of things for answers</p>\n</blockquote>",
        "id": 463423897,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724078729
    },
    {
        "content": "<p>himakshi25 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2298213344\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Thanks @bjorn3 @alexcrichton for inputs.<br>\nOne related query, <br>\nI also tried by using <code>--embed-file</code> of emscripten <a href=\"https://emscripten.org/docs/porting/files/packaging_files.html\">https://emscripten.org/docs/porting/files/packaging_files.html</a> <br>\ncommand : <code>emcc file.cpp -o file.wasm --embed-file test/hello_world_file.txt -s STANDALONE_WASM</code><br>\nand while executing with wasmtime getting error</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">file</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">instantiate</span><span class=\"w\"> </span><span class=\"s\">\"file.wasm\"</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">unknown</span><span class=\"w\"> </span><span class=\"n\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">env</span><span class=\"p\">::</span><span class=\"n\">_emscripten_fs_load_embedded_files</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">been</span><span class=\"w\"> </span><span class=\"n\">defined</span>\n</code></pre></div>\n<p><a href=\"https://github.com/user-attachments/files/16671134/embed_file.zip\">embed_file.zip</a></p>\n<p>Is the wasmtime not supporting this emscripten file packaging feature or is there any plan to support this.</p>\n</blockquote>",
        "id": 463623842,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724140655
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127#issuecomment-2298358687\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Wasmtime doesn't support Emscripten's ABI. Said ABI is not even stable anyway AFAIK. It seems <code>--embed-file</code> depends on Emscripten's ABI and as such is incompatible with STANDALONE_WASM.</p>\n</blockquote>",
        "id": 463640339,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724144839
    },
    {
        "content": "<p>himakshi25 closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9127\">issue #9127</a>:</p>\n<blockquote>\n<p>Created a wasm of a simple c program with command: <code>emcc main.c -o file.wasm</code>.<br>\nProgram is trying to open a file present in test directory.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"c1\">// main.c</span>\n<span class=\"p\">#</span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdio</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"Hello world!</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">FILE</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">fopen</span><span class=\"p\">(</span><span class=\"s\">\"test/hello_world_file.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"rb\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">file</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"cannot open file</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"n\">feof</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"kt\">char</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">fgetc</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"n\">EOF</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">            </span><span class=\"n\">putchar</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"n\">fclose</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>On running file.wasm with wasmtime with command <code>wasmtime file.wasm</code> got the below error</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Hello</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"o\">!</span>\n<span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">file</span>\n</code></pre></div>\n<p>Also, tried giving directory as well in wasmtime but didn't work and got same error.<br>\ncommand <code>wasmtime --dir=test file.wasm</code></p>\n<p>Is there any way to allow wasmtime to access or mount local directory for file read and write?</p>\n</blockquote>",
        "id": 463650446,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724147075
    }
]