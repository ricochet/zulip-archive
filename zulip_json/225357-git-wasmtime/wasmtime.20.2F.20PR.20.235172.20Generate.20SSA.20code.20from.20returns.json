[
    {
        "content": "<p>elliottt opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>:</p>\n<blockquote>\n<p>Modify return pseudoinstructions to have pairs of registers: virtual and real. This allows us to constrain the virtual registers to the real ones specified by the abi, instead of directly emitting moves to those real regisers.</p>\n<p>Additionally, this PR marks <code>r14</code> on s390x as non-allocatable, as it's used as the link register in the return instruction.<br>\n&lt;!--</p>\n<p>Please ensure that the following steps are all taken care of before submitting<br>\nthe PR.</p>\n<ul>\n<li>\n<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>\n  here.</p>\n</li>\n<li>\n<p>[ ] A short description of what this does, why it is needed; if the<br>\n  description becomes long, the matter should probably be discussed in an issue<br>\n  first.</p>\n</li>\n<li>\n<p>[ ] This PR contains test cases, if meaningful.</p>\n</li>\n<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>\n  If you don't know who could review this, please indicate so. The list of<br>\n  suggested reviewers on the right can help you.</li>\n</ul>\n<p>Please ensure all communication adheres to the <a href=\"https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md\">code of\nconduct</a>.<br>\n--&gt;<br>\n</p>\n</blockquote>",
        "id": 307418609,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667343664
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307423450,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667346422
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1165687160\">PR review</a>.</p>",
        "id": 307575656,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667409146
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1012071668\">PR review comment</a>:</p>\n<blockquote>\n<p>This is going to make things a little interesting too: properly speaking, an extend should allocate a new temp for fully SSA output, rather than coerce the preg to a Writable and extend into it.</p>\n</blockquote>",
        "id": 307575657,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667409146
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1165687160\">PR review</a>.</p>",
        "id": 307575658,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667409146
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307590827,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667413286
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307616020,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667422192
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307808480,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667499194
    },
    {
        "content": "<p><strong>elliottt</strong> has marked <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> as ready for review.</p>",
        "id": 307809459,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667499489
    },
    {
        "content": "<p>elliottt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167545762\">PR review</a>.</p>",
        "id": 307821449,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667503476
    },
    {
        "content": "<p>elliottt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1013315161\">PR review comment</a>:</p>\n<blockquote>\n<p>Neat, we avoided a move <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> </p>\n</blockquote>",
        "id": 307821450,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667503476
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307837278,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667508896
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307838506,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667509292
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167668584\">PR review</a>.</p>",
        "id": 307840268,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667509922
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167668584\">PR review</a>.</p>",
        "id": 307840287,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667509924
    },
    {
        "content": "<p>uweigand created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1013401370\">PR review comment</a>:</p>\n<blockquote>\n<p>Hi @elliottt  this seems a bug: the <code>lgr</code> overwrites the effect of the <code>llgfr</code>.   Is there some problem with the extension handling on return values?</p>\n</blockquote>",
        "id": 307840306,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667509931
    },
    {
        "content": "<p>uweigand created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1013400953\">PR review comment</a>:</p>\n<blockquote>\n<p>Hi @elliottt this seems a bug: the <code>lgr</code> overwrites the effect of the <code>llgfr</code>.   Is there some problem with the extension handling on return values?</p>\n</blockquote>",
        "id": 307840317,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667509938
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167694864\">PR review</a>.</p>",
        "id": 307844277,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667511494
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167694864\">PR review</a>.</p>",
        "id": 307844278,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667511494
    },
    {
        "content": "<p>uweigand created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1013419845\">PR review comment</a>:</p>\n<blockquote>\n<p>Doesn't this now violate the x64 ABI?  I thought this requires the struct-ret pointer to be returned in %rax, that was the whole point of the logic of adding a <code>StructReturn</code> element to the return values?</p>\n</blockquote>",
        "id": 307844280,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667511494
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 307857096,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667517188
    },
    {
        "content": "<p>elliottt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167791344\">PR review</a>.</p>",
        "id": 307860817,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667519622
    },
    {
        "content": "<p>elliottt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1013494745\">PR review comment</a>:</p>\n<blockquote>\n<p>There are currently some problems with struct-return that I'm tracking down. I think all the comments you added are directly related.</p>\n</blockquote>",
        "id": 307860818,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667519622
    },
    {
        "content": "<p>elliottt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1013503521\">PR review comment</a>:</p>\n<blockquote>\n<p>@uweigand: I think that Chris's comment here is the same problem you noticed with extension on returns.</p>\n</blockquote>",
        "id": 307862937,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667521033
    },
    {
        "content": "<p>elliottt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1167802520\">PR review</a>.</p>",
        "id": 307862939,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667521033
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308052223,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667597291
    },
    {
        "content": "<p>elliottt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1169210077\">PR review</a>.</p>",
        "id": 308052350,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667597359
    },
    {
        "content": "<p>elliottt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1014479133\">PR review comment</a>:</p>\n<blockquote>\n<p>@uweigand could you take another look? After the change to introduce a temporary for the extension, these tests also lack the initial <code>lgr</code> instruction, turning into just <code>llgfr %r2, %r2</code>.</p>\n</blockquote>",
        "id": 308052351,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667597359
    },
    {
        "content": "<p>uweigand created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1014487925\">PR review comment</a>:</p>\n<blockquote>\n<p>That's even better, removes an unnecessary copy and just zero-extends <code>%r2</code> in place.   The s390x test changes look all good to me now.  (Mostly just renamed registers; in several cases we get better code by eliminating register copies or spills, and a few cases -notably relating to divide instructions- we get slightly worse code.  Overall still good though.)</p>\n</blockquote>",
        "id": 308054968,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667598496
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1169222015\">PR review</a>.</p>",
        "id": 308054969,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667598496
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308064661,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667602844
    },
    {
        "content": "<p>elliottt edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>:</p>\n<blockquote>\n<p>Modify return pseudoinstructions to have pairs of registers: virtual and real. This allows us to constrain the virtual registers to the real ones specified by the abi, instead of directly emitting moves to those real regisers.<br>\n&lt;!--</p>\n<p>Please ensure that the following steps are all taken care of before submitting<br>\nthe PR.</p>\n<ul>\n<li>\n<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>\n  here.</p>\n</li>\n<li>\n<p>[ ] A short description of what this does, why it is needed; if the<br>\n  description becomes long, the matter should probably be discussed in an issue<br>\n  first.</p>\n</li>\n<li>\n<p>[ ] This PR contains test cases, if meaningful.</p>\n</li>\n<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>\n  If you don't know who could review this, please indicate so. The list of<br>\n  suggested reviewers on the right can help you.</li>\n</ul>\n<p>Please ensure all communication adheres to the <a href=\"https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md\">code of\nconduct</a>.<br>\n--&gt;<br>\n</p>\n</blockquote>",
        "id": 308325580,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667796297
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308468092,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667853001
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308639923,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667929922
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308642887,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667930861
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308650469,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667932968
    },
    {
        "content": "<p>elliottt created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#discussion_r1016996069\">PR review comment</a>:</p>\n<blockquote>\n<p>This should be fixed now.</p>\n</blockquote>",
        "id": 308650721,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667933027
    },
    {
        "content": "<p>elliottt submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1172663750\">PR review</a>.</p>",
        "id": 308650725,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667933027
    },
    {
        "content": "<p><strong>elliottt</strong> requested <a href=\"https://github.com/cfallin\">cfallin</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a>.</p>",
        "id": 308651131,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667933159
    },
    {
        "content": "<p>elliottt updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a> from <code>trevor/ret-ssa</code> to <code>main</code>.</p>",
        "id": 308653070,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667933767
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172#pullrequestreview-1172875503\">PR review</a>.</p>",
        "id": 308678388,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667943598
    },
    {
        "content": "<p>elliottt merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/5172\">PR #5172</a>.</p>",
        "id": 308695000,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1667952050
    }
]