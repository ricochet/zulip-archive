[
    {
        "content": "<p>afonso360 opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958\">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>:</p>\n<blockquote>\n<p><span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> Hey,</p>\n<p>Following up from #4884 (Thanks!) this PR introduces <code>fcvt_*</code> ops to the fuzzer. Additionally it also adds a pass to minimize the number of traps generated by these ops.</p>\n<p>Like the <code>int_divz</code> pass, the number of traps generated doesn't seem to correspond with the amount requested in the config.  I think I've actually figured out something here, if I limit the amount of bytes the fuzzer uses the amount of traps is reduced by a  lot.  (I got 0.4% <code>int_ovf</code> with <code>-max_len=2048</code>)</p>\n<p>That leads me to believe that we get such a high number of traps due to executing a lot of inputs. This is something that I want to look further into since I think there could actually be a performance benefit from limiting this.</p>\n<p>As a sanity check I also tried to benchmark with 100% insertion rate, and as expected we don't get the other traps.</p>\n<h3>Benchmarks</h3>\n<p>&lt;details&gt;<br>\n&lt;summary&gt;&lt;h3&gt;Baseline&lt;/h3&gt;&lt;/summary&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"mi\">92127</span><span class=\"w\">  </span><span class=\"n\">REDUCE</span><span class=\"w\"> </span><span class=\"n\">cov</span>: <span class=\"mi\">30535</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">173903</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4510</span><span class=\"o\">/</span><span class=\"mi\">10465</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">393617</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">24</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2448</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">124</span><span class=\"o\">/</span><span class=\"mi\">393581</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">EraseBytes</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">FuzzGen</span><span class=\"w\"> </span><span class=\"n\">Statistics</span><span class=\"w\">  </span><span class=\"o\">====================</span><span class=\"w\"></span>\n<span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Inputs</span>: <span class=\"mi\">50000</span><span class=\"w\"></span>\n<span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1469777</span><span class=\"w\"></span>\n<span class=\"n\">Successful</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1415404</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">96.3</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">425</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Traps</span>:\n        <span class=\"nc\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_divz</span>: <span class=\"mi\">53948</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">3.7</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n#<span class=\"mi\">92200</span><span class=\"w\">  </span><span class=\"n\">NEW</span><span class=\"w\">    </span><span class=\"n\">cov</span>: <span class=\"mi\">30535</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">173904</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4511</span><span class=\"o\">/</span><span class=\"mi\">10470</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">393617</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">23</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2448</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">4614</span><span class=\"o\">/</span><span class=\"mi\">393581</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">ChangeASCIIInt</span><span class=\"o\">-</span><span class=\"n\">ChangeByte</span><span class=\"o\">-</span><span class=\"n\">CMP</span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">DE</span>: <span class=\"s\">\"</span><span class=\"se\">\\x1e\\x00\\x00\\x00</span><span class=\"s\">\"</span><span class=\"o\">-</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>&lt;details&gt;<br>\n&lt;summary&gt;&lt;h3&gt;This PR&lt;/h3&gt;&lt;/summary&gt;</p>\n<p>I've seen the <code>int_ovf</code> trap count vary a lot while testing, from 0.4% up to almost 7%.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"mi\">86636</span><span class=\"w\">  </span><span class=\"n\">NEW</span><span class=\"w\">    </span><span class=\"n\">cov</span>: <span class=\"mi\">31377</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">178040</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4651</span><span class=\"o\">/</span><span class=\"mi\">8643</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">119720</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2375</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">4548</span><span class=\"o\">/</span><span class=\"mi\">65539</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">ChangeASCIIInt</span><span class=\"o\">-</span><span class=\"n\">CopyPart</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">FuzzGen</span><span class=\"w\"> </span><span class=\"n\">Statistics</span><span class=\"w\">  </span><span class=\"o\">====================</span><span class=\"w\"></span>\n<span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Inputs</span>: <span class=\"mi\">50000</span><span class=\"w\"></span>\n<span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1184585</span><span class=\"w\"></span>\n<span class=\"n\">Successful</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1099371</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">92.8</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1066</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Traps</span>:\n        <span class=\"nc\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_ovf</span>: <span class=\"mi\">40522</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">3.4</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_divz</span>: <span class=\"mi\">33112</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">2.8</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">bad_toint</span>: <span class=\"mi\">10514</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.9</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n#<span class=\"mi\">86713</span><span class=\"w\">  </span><span class=\"n\">REDUCE</span><span class=\"w\"> </span><span class=\"n\">cov</span>: <span class=\"mi\">31377</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">178042</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4652</span><span class=\"o\">/</span><span class=\"mi\">8645</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">119720</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2375</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">1761</span><span class=\"o\">/</span><span class=\"mi\">65539</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">InsertRepeatedBytes</span><span class=\"o\">-</span><span class=\"n\">InsertRepeatedBytes</span><span class=\"o\">-</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>&lt;details&gt;<br>\n&lt;summary&gt;&lt;h3&gt;This PR while always applying the trap pass&lt;/h3&gt;&lt;/summary&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"mi\">89715</span><span class=\"w\">  </span><span class=\"n\">REDUCE</span><span class=\"w\"> </span><span class=\"n\">cov</span>: <span class=\"mi\">31208</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">177781</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4618</span><span class=\"o\">/</span><span class=\"mi\">8793</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">136654</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2342</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">2397</span><span class=\"o\">/</span><span class=\"mi\">136620</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">PersAutoDict</span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">DE</span>: <span class=\"s\">\"</span><span class=\"se\">\\x00\\x00\\x00</span><span class=\"s\">Y\"</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">FuzzGen</span><span class=\"w\"> </span><span class=\"n\">Statistics</span><span class=\"w\">  </span><span class=\"o\">====================</span><span class=\"w\"></span>\n<span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Inputs</span>: <span class=\"mi\">50000</span><span class=\"w\"></span>\n<span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1315468</span><span class=\"w\"></span>\n<span class=\"n\">Successful</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1273898</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">96.8</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1016</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Traps</span>:\n        <span class=\"nc\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_divz</span>: <span class=\"mi\">40554</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">3.1</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n#<span class=\"mi\">89889</span><span class=\"w\">  </span><span class=\"n\">NEW</span><span class=\"w\">    </span><span class=\"n\">cov</span>: <span class=\"mi\">31208</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">177782</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4619</span><span class=\"o\">/</span><span class=\"mi\">8808</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">136654</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2342</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">15765</span><span class=\"o\">/</span><span class=\"mi\">136620</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">CopyPart</span><span class=\"o\">-</span><span class=\"n\">CopyPart</span><span class=\"o\">-</span><span class=\"n\">InsertByte</span><span class=\"o\">-</span><span class=\"n\">CrossOver</span><span class=\"o\">-</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>cc: @jameysharp </p>\n</blockquote>",
        "id": 300660982,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664118347
    },
    {
        "content": "<p>afonso360 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958\">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>.</p>",
        "id": 300662149,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664119102
    },
    {
        "content": "<p>afonso360 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958\">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>.</p>",
        "id": 300662512,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664119339
    },
    {
        "content": "<p>afonso360 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958\">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>.</p>",
        "id": 300662601,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664119438
    },
    {
        "content": "<p>afonso360 edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958\">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>:</p>\n<blockquote>\n<p><span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> Hey,</p>\n<p>Following up from #4884 (Thanks!) this PR introduces <code>fcvt_*</code> ops to the fuzzer. Additionally it also adds a pass to minimize the number of traps generated by these ops.</p>\n<p>Like the <code>int_divz</code> pass, the number of traps generated doesn't seem to correspond with the amount requested in the config.  I think I've actually figured out something here, if I limit the amount of bytes the fuzzer uses, the amount of traps is reduced by a  lot.  (I got 0.4% <code>int_ovf</code> with <code>-max_len=2048</code>)</p>\n<p>That leads me to believe that we get such a high number of traps due to executing a lot of inputs. This is something that I want to look further into since I think there could actually be a performance benefit from limiting this.</p>\n<p>As a sanity check I also tried to benchmark with 100% insertion rate, and as expected we don't get the other traps.</p>\n<h3>Benchmarks</h3>\n<p>&lt;details&gt;<br>\n&lt;summary&gt;&lt;h3&gt;Baseline&lt;/h3&gt;&lt;/summary&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"mi\">92127</span><span class=\"w\">  </span><span class=\"n\">REDUCE</span><span class=\"w\"> </span><span class=\"n\">cov</span>: <span class=\"mi\">30535</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">173903</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4510</span><span class=\"o\">/</span><span class=\"mi\">10465</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">393617</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">24</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2448</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">124</span><span class=\"o\">/</span><span class=\"mi\">393581</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">EraseBytes</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">FuzzGen</span><span class=\"w\"> </span><span class=\"n\">Statistics</span><span class=\"w\">  </span><span class=\"o\">====================</span><span class=\"w\"></span>\n<span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Inputs</span>: <span class=\"mi\">50000</span><span class=\"w\"></span>\n<span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1469777</span><span class=\"w\"></span>\n<span class=\"n\">Successful</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1415404</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">96.3</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">425</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Traps</span>:\n        <span class=\"nc\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_divz</span>: <span class=\"mi\">53948</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">3.7</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n#<span class=\"mi\">92200</span><span class=\"w\">  </span><span class=\"n\">NEW</span><span class=\"w\">    </span><span class=\"n\">cov</span>: <span class=\"mi\">30535</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">173904</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4511</span><span class=\"o\">/</span><span class=\"mi\">10470</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">393617</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">23</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2448</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">4614</span><span class=\"o\">/</span><span class=\"mi\">393581</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">ChangeASCIIInt</span><span class=\"o\">-</span><span class=\"n\">ChangeByte</span><span class=\"o\">-</span><span class=\"n\">CMP</span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">DE</span>: <span class=\"s\">\"</span><span class=\"se\">\\x1e\\x00\\x00\\x00</span><span class=\"s\">\"</span><span class=\"o\">-</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>&lt;details&gt;<br>\n&lt;summary&gt;&lt;h3&gt;This PR&lt;/h3&gt;&lt;/summary&gt;</p>\n<p>I've seen the <code>int_ovf</code> trap count vary a lot while testing, from 0.4% up to almost 7%.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"mi\">86636</span><span class=\"w\">  </span><span class=\"n\">NEW</span><span class=\"w\">    </span><span class=\"n\">cov</span>: <span class=\"mi\">31377</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">178040</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4651</span><span class=\"o\">/</span><span class=\"mi\">8643</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">119720</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2375</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">4548</span><span class=\"o\">/</span><span class=\"mi\">65539</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">ChangeASCIIInt</span><span class=\"o\">-</span><span class=\"n\">CopyPart</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">FuzzGen</span><span class=\"w\"> </span><span class=\"n\">Statistics</span><span class=\"w\">  </span><span class=\"o\">====================</span><span class=\"w\"></span>\n<span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Inputs</span>: <span class=\"mi\">50000</span><span class=\"w\"></span>\n<span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1184585</span><span class=\"w\"></span>\n<span class=\"n\">Successful</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1099371</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">92.8</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1066</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Traps</span>:\n        <span class=\"nc\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_ovf</span>: <span class=\"mi\">40522</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">3.4</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_divz</span>: <span class=\"mi\">33112</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">2.8</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">bad_toint</span>: <span class=\"mi\">10514</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.9</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n#<span class=\"mi\">86713</span><span class=\"w\">  </span><span class=\"n\">REDUCE</span><span class=\"w\"> </span><span class=\"n\">cov</span>: <span class=\"mi\">31377</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">178042</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4652</span><span class=\"o\">/</span><span class=\"mi\">8645</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">119720</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2375</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">1761</span><span class=\"o\">/</span><span class=\"mi\">65539</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">InsertRepeatedBytes</span><span class=\"o\">-</span><span class=\"n\">InsertRepeatedBytes</span><span class=\"o\">-</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>&lt;details&gt;<br>\n&lt;summary&gt;&lt;h3&gt;This PR while always applying the trap pass&lt;/h3&gt;&lt;/summary&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"mi\">89715</span><span class=\"w\">  </span><span class=\"n\">REDUCE</span><span class=\"w\"> </span><span class=\"n\">cov</span>: <span class=\"mi\">31208</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">177781</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4618</span><span class=\"o\">/</span><span class=\"mi\">8793</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">136654</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2342</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">2397</span><span class=\"o\">/</span><span class=\"mi\">136620</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">PersAutoDict</span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">DE</span>: <span class=\"s\">\"</span><span class=\"se\">\\x00\\x00\\x00</span><span class=\"s\">Y\"</span><span class=\"o\">-</span><span class=\"w\"></span>\n<span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">FuzzGen</span><span class=\"w\"> </span><span class=\"n\">Statistics</span><span class=\"w\">  </span><span class=\"o\">====================</span><span class=\"w\"></span>\n<span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Inputs</span>: <span class=\"mi\">50000</span><span class=\"w\"></span>\n<span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1315468</span><span class=\"w\"></span>\n<span class=\"n\">Successful</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1273898</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">96.8</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">Runs</span>: <span class=\"mi\">1016</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">Traps</span>:\n        <span class=\"nc\">user</span><span class=\"w\"> </span><span class=\"n\">code</span>: <span class=\"nc\">int_divz</span>: <span class=\"mi\">40554</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">3.1</span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">Total</span><span class=\"w\"> </span><span class=\"n\">Runs</span><span class=\"p\">)</span><span class=\"w\"></span>\n#<span class=\"mi\">89889</span><span class=\"w\">  </span><span class=\"n\">NEW</span><span class=\"w\">    </span><span class=\"n\">cov</span>: <span class=\"mi\">31208</span><span class=\"w\"> </span><span class=\"n\">ft</span>: <span class=\"mi\">177782</span><span class=\"w\"> </span><span class=\"n\">corp</span>: <span class=\"mi\">4619</span><span class=\"o\">/</span><span class=\"mi\">8808</span><span class=\"n\">Kb</span><span class=\"w\"> </span><span class=\"n\">lim</span>: <span class=\"mi\">136654</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"o\">/</span><span class=\"n\">s</span>: <span class=\"mi\">25</span><span class=\"w\"> </span><span class=\"n\">rss</span>: <span class=\"mi\">2342</span><span class=\"n\">Mb</span><span class=\"w\"> </span><span class=\"n\">L</span>: <span class=\"mi\">15765</span><span class=\"o\">/</span><span class=\"mi\">136620</span><span class=\"w\"> </span><span class=\"n\">MS</span>: <span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">CopyPart</span><span class=\"o\">-</span><span class=\"n\">CopyPart</span><span class=\"o\">-</span><span class=\"n\">InsertByte</span><span class=\"o\">-</span><span class=\"n\">CrossOver</span><span class=\"o\">-</span><span class=\"w\"></span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>cc: @jameysharp </p>\n</blockquote>",
        "id": 300753061,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664185862
    },
    {
        "content": "<p>jameysharp submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958#pullrequestreview-1122352687\">PR review</a>.</p>",
        "id": 301060911,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664297550
    },
    {
        "content": "<p>jameysharp merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/4958\">PR #4958</a>.</p>",
        "id": 301061025,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1664297579
    }
]