[
    {
        "content": "<p><a href=\"https://github.com/orangeC23\">orangeC23</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">Issue #7420</a>.</p>",
        "id": 399517142,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698757486
    },
    {
        "content": "<p>orangeC23 opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">issue #7420</a>:</p>\n<blockquote>\n<h1>Steps to Reproduce</h1>\n<p>(1) The cfile is :</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"n\">define</span><span class=\"w\"> </span><span class=\"n\">_POSIX_C_SOURCE</span><span class=\"w\"> </span><span class=\"mi\">199309</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"c1\">// 用于启用 clock_gettime 函数</span>\n\n#<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdio</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n#<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdlib</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n#<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">clock_time_get</span><span class=\"p\">(</span><span class=\"n\">clockid_t</span><span class=\"w\"> </span><span class=\"n\">clock_id</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">struct</span> <span class=\"nc\">timespec</span><span class=\"w\"> </span><span class=\"n\">tp</span><span class=\"p\">;</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">clock_gettime</span><span class=\"p\">(</span><span class=\"n\">clock_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">tp</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"Successfully get the clock time.</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"seconds: %ld</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tp</span><span class=\"p\">.</span><span class=\"n\">tv_sec</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"nano seconds: %ld</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tp</span><span class=\"p\">.</span><span class=\"n\">tv_nsec</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">perror</span><span class=\"p\">(</span><span class=\"s\">\"Failed to get the clock time.</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">clock_time_getyq5TE7BLv8</span><span class=\"w\"> </span><span class=\"p\">(){</span>\n<span class=\"w\">    </span><span class=\"n\">clockid_t</span><span class=\"w\"> </span><span class=\"n\">clock_id</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CLOCK_PROCESS_CPUTIME_ID</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">clock_time_get</span><span class=\"p\">(</span><span class=\"n\">clock_id</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">clock_time_getyq5TE7BLv8</span><span class=\"w\"> </span><span class=\"p\">();</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>(2)compile the c file into wasm: <code>./wasi-sdk-16.0/bin/clang --target=wasm32-unkown-wasi --sysroot=./wasi-sdk-16.0/share/wasi-sysroot clock2.c -o clock2.wasm</code><br>\n(3)exeute clock.wasm<br>\n<code>wasmtime run clock2.wasm</code></p>\n<h1>Expected Results</h1>\n<p>Using <code>gcc clock2.c -o clock2</code> and <code>./clock2</code> to execute get the following result:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Successfully</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">clock</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"p\">.</span>\n<span class=\"n\">seconds</span>: <span class=\"mi\">0</span>\n<span class=\"n\">nano</span><span class=\"w\"> </span><span class=\"n\">seconds</span>: <span class=\"mi\">6283516</span>\n</code></pre></div>\n<p>And wamr, wasmedge,wasmer also print the above message.</p>\n<h1>Actual Results</h1>\n<p>wasmtime prints:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">clock</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"p\">.</span>\n: <span class=\"nc\">Bad</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">descriptor</span>\n</code></pre></div>\n<p>I'm not sure whether this is a bug. Maybe this is related to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7419\">https://github.com/bytecodealliance/wasmtime/issues/7419</a><br>\nSorry for bothering you. Thanks a lot !</p>\n<p>Versions and Environment<br>\nwasmtime 13.0.0<br>\nOperating system: Ubuntu 20.04</p>\n<p>Architecture: x86_64</p>\n</blockquote>",
        "id": 399517145,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698757487
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420#issuecomment-1787209407\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">issue #7420</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/blob/2f83f97c9f4f7f98750eb2be19a336339da931e2/crates/wasi-common/src/snapshots/preview_1.rs#L74\">https://github.com/bytecodealliance/wasmtime/blob/2f83f97c9f4f7f98750eb2be19a336339da931e2/crates/wasi-common/src/snapshots/preview_1.rs#L74</a></p>\n<blockquote>\n<p>process and thread clocks are not supported</p>\n</blockquote>\n</blockquote>",
        "id": 399520116,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698758536
    },
    {
        "content": "<p>orangeC23 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420#issuecomment-1787210582\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">issue #7420</a>:</p>\n<blockquote>\n<p>Thanks a lot !</p>\n</blockquote>",
        "id": 399520215,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698758579
    },
    {
        "content": "<p>orangeC23 closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">issue #7420</a>:</p>\n<blockquote>\n<h1>Steps to Reproduce</h1>\n<p>(1) The cfile is :</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>#<span class=\"n\">define</span><span class=\"w\"> </span><span class=\"n\">_POSIX_C_SOURCE</span><span class=\"w\"> </span><span class=\"mi\">199309</span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"c1\">// 用于启用 clock_gettime 函数</span>\n\n#<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdio</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n#<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">stdlib</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n#<span class=\"n\">include</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">h</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">clock_time_get</span><span class=\"p\">(</span><span class=\"n\">clockid_t</span><span class=\"w\"> </span><span class=\"n\">clock_id</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">struct</span> <span class=\"nc\">timespec</span><span class=\"w\"> </span><span class=\"n\">tp</span><span class=\"p\">;</span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">clock_gettime</span><span class=\"p\">(</span><span class=\"n\">clock_id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">tp</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"Successfully get the clock time.</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"seconds: %ld</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tp</span><span class=\"p\">.</span><span class=\"n\">tv_sec</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"n\">printf</span><span class=\"p\">(</span><span class=\"s\">\"nano seconds: %ld</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">tp</span><span class=\"p\">.</span><span class=\"n\">tv_nsec</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">perror</span><span class=\"p\">(</span><span class=\"s\">\"Failed to get the clock time.</span><span class=\"se\">\\n</span><span class=\"s\">\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">clock_time_getyq5TE7BLv8</span><span class=\"w\"> </span><span class=\"p\">(){</span>\n<span class=\"w\">    </span><span class=\"n\">clockid_t</span><span class=\"w\"> </span><span class=\"n\">clock_id</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CLOCK_PROCESS_CPUTIME_ID</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">clock_time_get</span><span class=\"p\">(</span><span class=\"n\">clock_id</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">clock_time_getyq5TE7BLv8</span><span class=\"w\"> </span><span class=\"p\">();</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>(2)compile the c file into wasm: <code>./wasi-sdk-16.0/bin/clang --target=wasm32-unkown-wasi --sysroot=./wasi-sdk-16.0/share/wasi-sysroot clock2.c -o clock2.wasm</code><br>\n(3)exeute clock.wasm<br>\n<code>wasmtime run clock2.wasm</code></p>\n<h1>Expected Results</h1>\n<p>Using <code>gcc clock2.c -o clock2</code> and <code>./clock2</code> to execute get the following result:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Successfully</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">clock</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"p\">.</span>\n<span class=\"n\">seconds</span>: <span class=\"mi\">0</span>\n<span class=\"n\">nano</span><span class=\"w\"> </span><span class=\"n\">seconds</span>: <span class=\"mi\">6283516</span>\n</code></pre></div>\n<p>And wamr, wasmedge,wasmer also print the above message.</p>\n<h1>Actual Results</h1>\n<p>wasmtime prints:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">clock</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"p\">.</span>\n: <span class=\"nc\">Bad</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">descriptor</span>\n</code></pre></div>\n<p>I'm not sure whether this is a bug. Maybe this is related to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7419\">https://github.com/bytecodealliance/wasmtime/issues/7419</a><br>\nSorry for bothering you. Thanks a lot !</p>\n<p>Versions and Environment<br>\nwasmtime 13.0.0<br>\nOperating system: Ubuntu 20.04</p>\n<p>Architecture: x86_64</p>\n</blockquote>",
        "id": 399520222,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698758581
    },
    {
        "content": "<p>bjorn3 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420#issuecomment-1787209407\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">issue #7420</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/blob/2f83f97c9f4f7f98750eb2be19a336339da931e2/crates/wasi-common/src/snapshots/preview_1.rs#L103\">https://github.com/bytecodealliance/wasmtime/blob/2f83f97c9f4f7f98750eb2be19a336339da931e2/crates/wasi-common/src/snapshots/preview_1.rs#L103</a></p>\n<blockquote>\n<p>process and thread clocks are not supported</p>\n</blockquote>\n</blockquote>",
        "id": 399520227,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698758582
    },
    {
        "content": "<p>pchickey <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420#issuecomment-1787579989\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/7420\">issue #7420</a>:</p>\n<blockquote>\n<p>@orangeC23 Can you please perform some investigation of your own into these issues before filing them? You are filing more issues than any other contributor, in a manner which appears to be the result of some automated system, and as far as I can tell, all of these issues have trivial answers which would only require you to examine a small amount of code.</p>\n<p>We appreciate that @bjorn3 and @alexcrichton and others have taken a look at these, but it isn't very fair for you to consume their time and attention if you aren't showing that you are putting time and attention into these issues yourself.</p>\n</blockquote>",
        "id": 399561077,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1698770164
    }
]