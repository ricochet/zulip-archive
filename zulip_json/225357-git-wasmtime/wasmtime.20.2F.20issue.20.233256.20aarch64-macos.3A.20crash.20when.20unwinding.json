[
    {
        "content": "<p>bnjbvr opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3256\">issue #3256</a>:</p>\n<blockquote>\n<p>Our internal wasmtime testing on aarch64-darwin shows that something broke around July 17th: <a href=\"https://buildkite.com/embark-studios/wasmtime-aarch64-apple-darwin/builds?branch=main&amp;page=5\">https://buildkite.com/embark-studios/wasmtime-aarch64-apple-darwin/builds?branch=main&amp;page=5</a></p>\n<p>When running <code>cargo test -p wasmtime-cli --test all</code>, I see a segfault. LLDB shows libunwind in the backtrace, then the <code>backtrace</code> crate, then <code>wasmtime::trap::Trap::new</code> as the first wasmtime function. It seems that it happens when we're creating to create a backtrace after resuming a fiber from another thread.</p>\n<p>Unfortunately, I've been trying to chase down a commit that would have introduced this failure, with no success: I can get back to wasmtime as of June 1st (last time I remember manually running tests on this machine), and reproduce that crash. So it could be that the system, distributed version of libunwind has changed after an upgrade of MacOS, and that it is now not working with our unwinding methods anymore.</p>\n<p>I'll try to investigate a bit more, and report about what I've found, and if there are workarounds.</p>\n</blockquote>",
        "id": 250909753,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1630059058
    },
    {
        "content": "<p>bnjbvr labeled <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3256\">issue #3256</a>:</p>\n<blockquote>\n<p>Our internal wasmtime testing on aarch64-darwin shows that something broke around July 17th: <a href=\"https://buildkite.com/embark-studios/wasmtime-aarch64-apple-darwin/builds?branch=main&amp;page=5\">https://buildkite.com/embark-studios/wasmtime-aarch64-apple-darwin/builds?branch=main&amp;page=5</a></p>\n<p>When running <code>cargo test -p wasmtime-cli --test all</code>, I see a segfault. LLDB shows libunwind in the backtrace, then the <code>backtrace</code> crate, then <code>wasmtime::trap::Trap::new</code> as the first wasmtime function. It seems that it happens when we're creating to create a backtrace after resuming a fiber from another thread.</p>\n<p>Unfortunately, I've been trying to chase down a commit that would have introduced this failure, with no success: I can get back to wasmtime as of June 1st (last time I remember manually running tests on this machine), and reproduce that crash. So it could be that the system, distributed version of libunwind has changed after an upgrade of MacOS, and that it is now not working with our unwinding methods anymore.</p>\n<p>I'll try to investigate a bit more, and report about what I've found, and if there are workarounds.</p>\n</blockquote>",
        "id": 250909754,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1630059058
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3256#issuecomment-907300747\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3256\">issue #3256</a>:</p>\n<blockquote>\n<p>Digging through those logs it looks like when wasmtime is checked out it doesn't print the revision (would y'all be up for changing it to print this?) but assuming that the dates roughly line up with GitHub's dates I'm seeing I think the range for the regression is probably somewhere in here -- </p>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/compare/73fd702bb7cabdff156eaf4ef8db5b92b098583e...f628d06118ecde14e429fe1f4538831a51a1e75a\">https://github.com/bytecodealliance/wasmtime/compare/73fd702bb7cabdff156eaf4ef8db5b92b098583e...f628d06118ecde14e429fe1f4538831a51a1e75a</a></p>\n<p>All of that looks pretty benign though. <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3082\">https://github.com/bytecodealliance/wasmtime/pull/3082</a> and <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3074\">https://github.com/bytecodealliance/wasmtime/pull/3074</a> are arm64 specific but unrelated to unwinding. <a href=\"https://github.com/bytecodealliance/wasmtime/pull/3088\">https://github.com/bytecodealliance/wasmtime/pull/3088</a> is related to async and stack checks but which also makes it suspicious, but I also have a hard time seeing how that would cause something like this...</p>\n</blockquote>",
        "id": 250951784,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1630079471
    },
    {
        "content": "<p>bnjbvr <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3256#issuecomment-908173535\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/3256\">issue #3256</a>:</p>\n<blockquote>\n<blockquote>\n<p>would y'all be up for changing it to print this?</p>\n</blockquote>\n<p>Good idea, added this <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span> </p>\n<blockquote>\n<p>All of that looks pretty benign though.</p>\n</blockquote>\n<p>Yeah, I've tried to git bisect but even the oldest commit I've tried, one I wrote and which I tested manually at the time (and for which I could remember that all the tests were passing), even that commit was failing. Hence my suspicion of a system-wide change. Will try to investigate a bit more this week.</p>\n</blockquote>",
        "id": 251201792,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1630314295
    }
]