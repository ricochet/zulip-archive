[
    {
        "content": "<p>abc767234318 opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149\">issue #9149</a>:</p>\n<blockquote>\n<p>When I used cranelift-reader to read the functions of Cranelift IR, the following error occurred:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">parsing</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">ParseError</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">location</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Location</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">line_number</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"p\">},</span><span class=\"w\"> </span><span class=\"n\">message</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s\">\"expected block header\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">is_warning</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">false</span><span class=\"w\"> </span><span class=\"p\">}</span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">std</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">begin_panic_handler</span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"mi\">3</span><span class=\"n\">f5fd8dd41153bc5fdca9427e9e05be2c767ba23</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"err\">\\</span><span class=\"n\">std</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">652</span>\n<span class=\"w\">   </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic_fmt</span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"mi\">3</span><span class=\"n\">f5fd8dd41153bc5fdca9427e9e05be2c767ba23</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"err\">\\</span><span class=\"n\">core</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">72</span>\n<span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">result</span><span class=\"p\">::</span><span class=\"n\">unwrap_failed</span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"mi\">3</span><span class=\"n\">f5fd8dd41153bc5fdca9427e9e05be2c767ba23</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"err\">\\</span><span class=\"n\">core</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">result</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">1679</span>\n<span class=\"w\">   </span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">enum2</span><span class=\"cp\">$</span><span class=\"o\">&lt;</span><span class=\"n\">core</span><span class=\"p\">::</span><span class=\"n\">result</span><span class=\"p\">::</span><span class=\"nb\">Result</span><span class=\"o\">&lt;</span><span class=\"n\">alloc</span><span class=\"p\">::</span><span class=\"n\">vec</span><span class=\"p\">::</span><span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"n\">cranelift_codegen</span><span class=\"p\">::</span><span class=\"n\">ir</span><span class=\"p\">::</span><span class=\"n\">function</span><span class=\"p\">::</span><span class=\"n\">Function</span><span class=\"p\">,</span><span class=\"n\">alloc</span><span class=\"p\">::</span><span class=\"n\">alloc</span><span class=\"p\">::</span><span class=\"n\">Global</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"n\">cranelift_reader</span><span class=\"p\">::</span><span class=\"n\">error</span><span class=\"p\">::</span><span class=\"n\">ParseError</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"n\">expect</span><span class=\"o\">&lt;</span><span class=\"n\">alloc</span><span class=\"p\">::</span><span class=\"n\">vec</span><span class=\"p\">::</span><span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"n\">cranelift_codegen</span><span class=\"p\">::</span><span class=\"n\">ir</span><span class=\"p\">::</span><span class=\"n\">function</span><span class=\"p\">::</span><span class=\"n\">Fun</span>\n<span class=\"n\">ction</span><span class=\"p\">,</span><span class=\"n\">alloc</span><span class=\"p\">::</span><span class=\"n\">alloc</span><span class=\"p\">::</span><span class=\"n\">Global</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"n\">cranelift_reader</span><span class=\"p\">::</span><span class=\"n\">err</span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"mi\">3</span><span class=\"n\">f5fd8dd41153bc5fdca9427e9e05be2c767ba23</span><span class=\"err\">\\</span><span class=\"n\">library</span><span class=\"err\">\\</span><span class=\"n\">core</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">result</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">1059</span>\n<span class=\"mi\">4</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">ir_serde</span><span class=\"p\">::</span><span class=\"n\">main</span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">bin</span><span class=\"err\">\\</span><span class=\"n\">ir_serde</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">27</span>\n<span class=\"w\">   </span><span class=\"mi\">5</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">ops</span><span class=\"p\">::</span><span class=\"n\">function</span><span class=\"p\">::</span><span class=\"nb\">FnOnce</span><span class=\"p\">::</span><span class=\"n\">call_once</span><span class=\"o\">&lt;</span><span class=\"n\">enum2</span><span class=\"cp\">$</span><span class=\"o\">&lt;</span><span class=\"n\">core</span><span class=\"p\">::</span><span class=\"n\">result</span><span class=\"p\">::</span><span class=\"nb\">Result</span><span class=\"o\">&lt;</span><span class=\"n\">tuple</span><span class=\"cp\">$</span><span class=\"o\">&lt;&gt;</span><span class=\"p\">,</span><span class=\"n\">anyhow</span><span class=\"p\">::</span><span class=\"n\">Error</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"p\">)(),</span><span class=\"n\">tuple</span><span class=\"cp\">$</span><span class=\"o\">&lt;&gt;</span><span class=\"w\"> </span><span class=\"o\">&gt;</span>\n<span class=\"w\">             </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"mi\">3</span><span class=\"n\">f5fd8dd41153bc5fdca9427e9e05be2c767ba23</span><span class=\"err\">\\</span><span class=\"n\">library</span><span class=\"err\">\\</span><span class=\"n\">core</span><span class=\"err\">\\</span><span class=\"n\">src</span><span class=\"err\">\\</span><span class=\"n\">ops</span><span class=\"err\">\\</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">250</span>\n<span class=\"n\">note</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"w\"> </span><span class=\"nc\">details</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">omitted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">RUST_BACKTRACE</span><span class=\"o\">=</span><span class=\"n\">full</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">verbose</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">.</span>\n</code></pre></div>\n<p>And the error is caused by this line of code:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">ir_funcs</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">parse_functions</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">ir_str</span><span class=\"p\">).</span><span class=\"n\">expect</span><span class=\"p\">(</span><span class=\"s\">\"parsing error\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p><a href=\"https://github.com/user-attachments/files/16667431/wasm_func_27.zip\">wasm_func_27.zip</a><br>\n</p>\n</blockquote>",
        "id": 463552199,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724116613
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149#issuecomment-2299105567\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149\">issue #9149</a>:</p>\n<blockquote>\n<p>This is failing to parse the line <code>table0 = dynamic gv5, min 0, bound gv6, element_size 8, index_type i32</code> and it appears that cranelift-reader does not have support for this.</p>\n</blockquote>",
        "id": 463730312,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724166759
    },
    {
        "content": "<p>abc767234318 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149#issuecomment-2301482343\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149\">issue #9149</a>:</p>\n<blockquote>\n<blockquote>\n<p>This is failing to parse the line <code>table0 = dynamic gv5, min 0, bound gv6, element_size 8, index_type i32</code> and it appears that cranelift-reader does not have support for this.</p>\n</blockquote>\n<p>Thank you for your response. Is there any plan to add support for this format in the future? </p>\n</blockquote>",
        "id": 463983180,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724229374
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149#issuecomment-2302866413\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/9149\">issue #9149</a>:</p>\n<blockquote>\n<p>I don't think anyone's actively planning to work on this. In fact the rough goal is to remove table support from Cranelift and require frontends to handle the lowering instead. That being said if you'd like a PR to implement support for this also seems reasonable.</p>\n</blockquote>",
        "id": 464148448,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1724268707
    }
]