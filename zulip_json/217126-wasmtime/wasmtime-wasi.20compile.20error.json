[
    {
        "content": "<p>Hi guys, I saw issue when compiling wasmtime-wasi on my macos laptop</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Result</span>::<span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Err</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>: <span class=\"nc\">NotPresent</span><span class=\"o\">'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">external</span><span class=\"o\">/</span><span class=\"n\">wasm_crate_index__wasmtime</span><span class=\"o\">-</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"mf\">6.0.1</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">3</span>:<span class=\"mi\">62</span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n   <span class=\"mi\">0</span>:        <span class=\"mh\">0x1053eaba6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">backtrace_rs</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">libunwind</span>::<span class=\"n\">trace</span>::<span class=\"n\">h310cbd77a7d2ae59</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/../../</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">libunwind</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">93</span>:<span class=\"mi\">5</span>\n<span class=\"w\">   </span><span class=\"mi\">1</span>:        <span class=\"mh\">0x1053eaba6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">backtrace_rs</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">trace_unsynchronized</span>::<span class=\"n\">h5768bae568840507</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/../../</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">66</span>:<span class=\"mi\">5</span>\n<span class=\"w\">   </span><span class=\"mi\">2</span>:        <span class=\"mh\">0x1053eaba6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print_fmt</span>::<span class=\"n\">hd104a205649a2ffb</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">65</span>:<span class=\"mi\">5</span>\n<span class=\"w\">   </span><span class=\"mi\">3</span>:        <span class=\"mh\">0x1053eaba6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print</span>::<span class=\"n\">DisplayBacktrace</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">fmt</span>::<span class=\"n\">Display</span><span class=\"o\">&gt;</span>::<span class=\"n\">fmt</span>::<span class=\"n\">h521420ec33f3769d</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">44</span>:<span class=\"mi\">22</span>\n<span class=\"w\">   </span><span class=\"mi\">4</span>:        <span class=\"mh\">0x1053fe6da</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">fmt</span>::<span class=\"n\">write</span>::<span class=\"n\">h694a0d7c23f57ada</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">fmt</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1208</span>:<span class=\"mi\">17</span>\n<span class=\"w\">   </span><span class=\"mi\">5</span>:        <span class=\"mh\">0x1053e89bc</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">io</span>::<span class=\"n\">Write</span>::<span class=\"n\">write_fmt</span>::<span class=\"n\">h1920a3973ad439e5</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">io</span><span class=\"o\">/</span><span class=\"k\">mod</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1682</span>:<span class=\"mi\">15</span>\n<span class=\"w\">   </span><span class=\"mi\">6</span>:        <span class=\"mh\">0x1053ea98a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">_print</span>::<span class=\"n\">h75582c4ed1a04abb</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">47</span>:<span class=\"mi\">5</span>\n<span class=\"w\">   </span><span class=\"mi\">7</span>:        <span class=\"mh\">0x1053ea98a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">print</span>::<span class=\"n\">hef1aa4dbdc07ee06</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">34</span>:<span class=\"mi\">9</span>\n<span class=\"w\">   </span><span class=\"mi\">8</span>:        <span class=\"mh\">0x1053ebfe3</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">default_hook</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h529701a1070b4ce0</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">267</span>:<span class=\"mi\">22</span>\n<span class=\"w\">   </span><span class=\"mi\">9</span>:        <span class=\"mh\">0x1053ebd38</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">default_hook</span>::<span class=\"n\">hfeeab2c667b2d7c2</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">286</span>:<span class=\"mi\">9</span>\n<span class=\"w\">  </span><span class=\"mi\">10</span>:        <span class=\"mh\">0x1053ec713</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">rust_panic_with_hook</span>::<span class=\"n\">h1b5245192f90251d</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">688</span>:<span class=\"mi\">13</span>\n<span class=\"w\">  </span><span class=\"mi\">11</span>:        <span class=\"mh\">0x1053ec4e4</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"n\">begin_panic_handler</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h3658f3a9566379d4</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">579</span>:<span class=\"mi\">13</span>\n<span class=\"w\">  </span><span class=\"mi\">12</span>:        <span class=\"mh\">0x1053eb048</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">__rust_end_short_backtrace</span>::<span class=\"n\">h9e01645d962f8882</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">sys_common</span><span class=\"o\">/</span><span class=\"n\">backtrace</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">137</span>:<span class=\"mi\">18</span>\n<span class=\"w\">  </span><span class=\"mi\">13</span>:        <span class=\"mh\">0x1053ec1ad</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">rust_begin_unwind</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">575</span>:<span class=\"mi\">5</span>\n<span class=\"w\">  </span><span class=\"mi\">14</span>:        <span class=\"mh\">0x105405bc3</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">panicking</span>::<span class=\"n\">panic_fmt</span>::<span class=\"n\">h0097ad8ec0b07517</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">64</span>:<span class=\"mi\">14</span>\n<span class=\"w\">  </span><span class=\"mi\">15</span>:        <span class=\"mh\">0x105405f65</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">result</span>::<span class=\"n\">unwrap_failed</span>::<span class=\"n\">h2a0ffdcdbffb9262</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">result</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">1791</span>:<span class=\"mi\">5</span>\n<span class=\"w\">  </span><span class=\"mi\">16</span>:        <span class=\"mh\">0x1053cc19d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">build_script_build</span>::<span class=\"n\">main</span>::<span class=\"n\">h743d52c6546314e2</span>\n<span class=\"w\">  </span><span class=\"mi\">17</span>:        <span class=\"mh\">0x1053cc046</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">sys_common</span>::<span class=\"n\">backtrace</span>::<span class=\"n\">__rust_begin_short_backtrace</span>::<span class=\"n\">h2a02803064f971be</span>\n<span class=\"w\">  </span><span class=\"mi\">18</span>:        <span class=\"mh\">0x1053cc01c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">rt</span>::<span class=\"n\">lang_start</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h243f097924dd9fbc</span>\n<span class=\"w\">  </span><span class=\"mi\">19</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"n\">impls</span>::<span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">core</span>::<span class=\"n\">ops</span>::<span class=\"n\">function</span>::<span class=\"nb\">FnOnce</span><span class=\"o\">&lt;</span><span class=\"n\">A</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">F</span><span class=\"o\">&gt;</span>::<span class=\"n\">call_once</span>::<span class=\"n\">h2302f1d25ef2ca9b</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ops</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">606</span>:<span class=\"mi\">13</span>\n<span class=\"w\">  </span><span class=\"mi\">20</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"kr\">try</span>::<span class=\"n\">do_call</span>::<span class=\"n\">h6695e32a593de2cc</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">483</span>:<span class=\"mi\">40</span>\n<span class=\"w\">  </span><span class=\"mi\">21</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"kr\">try</span>::<span class=\"n\">hd4a93095627721a9</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">447</span>:<span class=\"mi\">19</span>\n<span class=\"w\">  </span><span class=\"mi\">22</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panic</span>::<span class=\"n\">catch_unwind</span>::<span class=\"n\">he41b3dba63feca94</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panic</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">137</span>:<span class=\"mi\">14</span>\n<span class=\"w\">  </span><span class=\"mi\">23</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">rt</span>::<span class=\"n\">lang_start_internal</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">hbf45583011495a61</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rt</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">148</span>:<span class=\"mi\">48</span>\n<span class=\"w\">  </span><span class=\"mi\">24</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"kr\">try</span>::<span class=\"n\">do_call</span>::<span class=\"n\">ha3e6b3edab7da449</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">483</span>:<span class=\"mi\">40</span>\n<span class=\"w\">  </span><span class=\"mi\">25</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panicking</span>::<span class=\"kr\">try</span>::<span class=\"n\">hd4e0f354bf7022b9</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panicking</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">447</span>:<span class=\"mi\">19</span>\n<span class=\"w\">  </span><span class=\"mi\">26</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">panic</span>::<span class=\"n\">catch_unwind</span>::<span class=\"n\">h1035b163871a4269</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">panic</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">137</span>:<span class=\"mi\">14</span>\n<span class=\"w\">  </span><span class=\"mi\">27</span>:        <span class=\"mh\">0x1053e6064</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">rt</span>::<span class=\"n\">lang_start_internal</span>::<span class=\"n\">hd56d2fa7efb2dd60</span>\n<span class=\"w\">                               </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">rustc</span><span class=\"o\">/</span><span class=\"n\">fc594f15669680fa70d255faec3ca3fb507c3405</span><span class=\"o\">/</span><span class=\"n\">library</span><span class=\"o\">/</span><span class=\"n\">std</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rt</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">148</span>:<span class=\"mi\">20</span>\n<span class=\"w\">  </span><span class=\"mi\">28</span>:        <span class=\"mh\">0x1053cc1fc</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">_main</span>\n<span class=\"w\">  </span><span class=\"mi\">29</span>:     <span class=\"mh\">0x7ff81769d310</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;</span>\n</code></pre></div>\n<p>I don't have a clue of why this is happening, any suggestions?</p>",
        "id": 345553049,
        "sender_full_name": "Wilson Wang",
        "timestamp": 1680145607
    },
    {
        "content": "<p>That error comes from DEP_WASI_COMMON_19_WASI not being set. Cargo should set this thanks to wasi-common's build script printing <code>cargo:rustc-env=WASI_ROOT=...</code> to stdout. I see that the panic location has a different path from what I would expect for a regular cargo build. How are you building it? Are you using cargo or another build tool? Are you using a custom registry?</p>",
        "id": 345608238,
        "sender_full_name": "bjorn3",
        "timestamp": 1680167228
    },
    {
        "content": "<p>I am using rules_rust to build it</p>",
        "id": 345710947,
        "sender_full_name": "Wilson Wang",
        "timestamp": 1680189956
    },
    {
        "content": "<p>I guess rules_rust is not handling this correctly. Let me contact them and see what i need to do to fix this</p>",
        "id": 345721802,
        "sender_full_name": "Wilson Wang",
        "timestamp": 1680192100
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253994\">@Alex Crichton</span>  Hi Alex, I saw you made the change in this part. are we able to use cargo:rustc-env instead of cargo:wasi in this <a href=\"http://build.rs\">build.rs</a>?</p>",
        "id": 345772250,
        "sender_full_name": "Wilson Wang",
        "timestamp": 1680205645
    },
    {
        "content": "<p>(Alex is on vacation for the rest of the week so you won't get a quick reply; just fyi, I don't have answers to your questions sorry!)</p>",
        "id": 345772509,
        "sender_full_name": "Chris Fallin",
        "timestamp": 1680205734
    },
    {
        "content": "<p>No, cargo:rustc-env only applies to the package that contains the build script. We instead need to get the value from a crate that depends on wasi-common, which is done through <code>cargo:wasi</code>. I'm not aware of any other option existing.</p>",
        "id": 345772737,
        "sender_full_name": "bjorn3",
        "timestamp": 1680205824
    },
    {
        "content": "<p>I c. This is really tricky now....</p>",
        "id": 345773488,
        "sender_full_name": "Wilson Wang",
        "timestamp": 1680206054
    }
]