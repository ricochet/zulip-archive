[
    {
        "content": "<p>In our cargo-vet configuration we have a few crates which we have decided we trust without auditing them because we trust the person who publishes them. But there are a few dozen crates which Mozilla has declared they trust and we haven't. We should collectively decide if we want to trust the same people that Mozilla does, without reviewing their code. Here's a rough count of how many crates we could avoid reviewing by following Mozilla's lead:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">     </span><span class=\"mi\">11</span><span class=\"w\"> </span><span class=\"n\">isrg</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trust</span><span class=\"w\"> </span><span class=\"n\">Andrew</span><span class=\"w\"> </span><span class=\"n\">Gallant</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">BurntSushi</span><span class=\"p\">)</span>\n<span class=\"w\">     </span><span class=\"mi\">11</span><span class=\"w\"> </span><span class=\"n\">isrg</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trust</span><span class=\"w\"> </span><span class=\"n\">David</span><span class=\"w\"> </span><span class=\"n\">Tolnay</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">dtolnay</span><span class=\"p\">)</span>\n<span class=\"w\">     </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">isrg</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trust</span><span class=\"w\"> </span><span class=\"n\">Alex</span><span class=\"w\"> </span><span class=\"n\">Crichton</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">alexcrichton</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"n\">isrg</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trust</span><span class=\"w\"> </span><span class=\"n\">Amanieu</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">'</span><span class=\"na\">Antras</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Amanieu</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"n\">isrg</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trust</span><span class=\"w\"> </span><span class=\"n\">Sean</span><span class=\"w\"> </span><span class=\"n\">McArthur</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">seanmonstar</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trusts</span><span class=\"w\"> </span><span class=\"n\">Ed</span><span class=\"w\"> </span><span class=\"n\">Page</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">epage</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trusts</span><span class=\"w\"> </span><span class=\"n\">Carl</span><span class=\"w\"> </span><span class=\"n\">Lerche</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">carllerche</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trusts</span><span class=\"w\"> </span><span class=\"n\">Josh</span><span class=\"w\"> </span><span class=\"n\">Stone</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">cuviper</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trusts</span><span class=\"w\"> </span><span class=\"n\">Alice</span><span class=\"w\"> </span><span class=\"n\">Ryhl</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Darksonn</span><span class=\"p\">)</span>\n<span class=\"w\">      </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">mozilla</span><span class=\"w\"> </span><span class=\"n\">trusts</span><span class=\"w\"> </span><span class=\"n\">Matt</span><span class=\"w\"> </span><span class=\"n\">Brubeck</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">mbrubeck</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>I'm adding this to tomorrow's Wasmtime meeting agenda in case anyone would prefer to discuss it there.</p>",
        "id": 372734811,
        "sender_full_name": "Jamey Sharp",
        "timestamp": 1688602024
    },
    {
        "content": "<p>I just ran into an issue with the \"trusted crates\" idea that I don't understand: in <a href=\"https://github.com/bytecodealliance/wasmtime/pull/7846\">#7846</a>, I trusted the <code>windows</code> crate, which matches the current policy we have for all the <code>windows-*</code> crates. But when we run <code>cargo vet --locked</code> on the branch that uses this, <a href=\"https://github.com/bytecodealliance/wasmtime/pull/7807\">#7807</a>, we still get:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Vetting</span><span class=\"w\"> </span><span class=\"n\">Failed</span><span class=\"o\">!</span>\n\n<span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"n\">unvetted</span><span class=\"w\"> </span><span class=\"n\">dependencies</span>:\n  <span class=\"nc\">windows</span>:<span class=\"mf\">0.52.0</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows</span><span class=\"o\">-</span><span class=\"n\">core</span>:<span class=\"mf\">0.51.1</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows</span><span class=\"o\">-</span><span class=\"n\">targets</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_aarch64_gnullvm</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_aarch64_msvc</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_i686_gnu</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_i686_msvc</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_x86_64_gnu</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_x86_64_gnullvm</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n<span class=\"w\">  </span><span class=\"n\">windows_x86_64_msvc</span>:<span class=\"mf\">0.48.5</span><span class=\"w\"> </span><span class=\"n\">missing</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"s\">\"safe-to-deploy\"</span><span class=\"p\">]</span>\n</code></pre></div>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wasmtime/pull/7846\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/4e16009df98a84c56aaf283031ab85a8334a9b85\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f336338366562346234613433393034303732616165333139313232356661316635323730343035306139643039353930383963643239636237653232623733372f62797465636f6465616c6c69616e63652f7761736d74696d652f70756c6c2f37383436)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wasmtime/pull/7846\" title=\"vet: trust the `windows` crates by abrown · Pull Request #7846 · bytecodealliance/wasmtime\">vet: trust the `windows` crates by abrown · Pull Request #7846 · bytecodealliance/wasmtime</a></div><div class=\"message_embed_description\">Like the rest of the windows-* crates published by Kenny Kerr, this change also adds the windows crate itself to the trusted list. This is necessary for use in #7807.</div></div></div><div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wasmtime/pull/7807\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/476c68cf4af0e9acb7aff44d8f14f5bb21212114\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f633063383865666232383861393533666161666161373537396136346430623963386338383236333262653930383534356632366436386632623962373131362f62797465636f6465616c6c69616e63652f7761736d74696d652f70756c6c2f37383037)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wasmtime/pull/7807\" title=\"WinML backend for wasi-nn by jianjunz · Pull Request #7807 · bytecodealliance/wasmtime\">WinML backend for wasi-nn by jianjunz · Pull Request #7807 · bytecodealliance/wasmtime</a></div><div class=\"message_embed_description\">This change adds Windows Machine Learning backend for wasi-nn. Since WinML is a built-in feature of Windows, this change makes it possible to run wasi-nn on Windows without a third-party machine le...</div></div></div>",
        "id": 420346796,
        "sender_full_name": "Andrew Brown",
        "timestamp": 1707341695
    },
    {
        "content": "<p>What is going on? I thought trusted crates would pass vetting?</p>",
        "id": 420346849,
        "sender_full_name": "Andrew Brown",
        "timestamp": 1707341712
    },
    {
        "content": "<p>I can reproduce this locally on the PR branch, where I observe that indeed the Windows crate is trusted:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">[[</span><span class=\"n\">trusted</span><span class=\"p\">.</span><span class=\"n\">windows</span><span class=\"p\">]]</span>\n<span class=\"n\">criteria</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"safe-to-deploy\"</span>\n<span class=\"n\">user</span><span class=\"o\">-</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">64539</span><span class=\"w\"> </span>#<span class=\"w\"> </span><span class=\"n\">Kenny</span><span class=\"w\"> </span><span class=\"n\">Kerr</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">kennykerr</span><span class=\"p\">)</span>\n<span class=\"n\">start</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"2021-01-15\"</span>\n<span class=\"n\">end</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"2025-01-30\"</span>\n</code></pre></div>\n<p>And Kenny Kerr has apparently <a href=\"https://crates.io/crates/windows/versions\">published it</a>.</p>",
        "id": 420347696,
        "sender_full_name": "Andrew Brown",
        "timestamp": 1707342044
    },
    {
        "content": "<p>cc: <span class=\"user-mention\" data-user-id=\"253990\">@fitzgen (he/him)</span>, <span class=\"user-mention\" data-user-id=\"504918\">@Jamey Sharp</span></p>",
        "id": 420348173,
        "sender_full_name": "Andrew Brown",
        "timestamp": 1707342247
    },
    {
        "content": "<p>Oh I think you'll need to run <code>cargo vet</code> after adding the trusted entry. Executing that adds new \"lock file entries\" which need to then get checked in. The trusted entry enables auto-adding new lock entries I believe</p>",
        "id": 420379939,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1707361293
    },
    {
        "content": "<p>if I run <code>cargo vet</code> on the winml branch everything passes but it updates <code>supply-chain/imports.lock</code> which is what <code>--locked</code> is preventing in CI</p>",
        "id": 420379966,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1707361320
    },
    {
        "content": "<p>Ah, thanks! That was exactly it: opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/7900\">#7900</a>.</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wasmtime/pull/7900\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/bc26ae50ccfa4f42526c29798298c26dd16dfb00\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f613964343931663661336362353630393131393133373331656263383663316638636331333161643833633532623265356165663832326639303035333030332f62797465636f6465616c6c69616e63652f7761736d74696d652f70756c6c2f37393030)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wasmtime/pull/7900\" title=\"vet: update lock file for trusted `windows` crates by abrown · Pull Request #7900 · bytecodealliance/wasmtime\">vet: update lock file for trusted `windows` crates by abrown · Pull Request #7900 · bytecodealliance/wasmtime</a></div><div class=\"message_embed_description\">In #7846 I added cargo-vet entries to trust the windows crate, just like we already trust several related windows-* crates. I did not, however, update the lockfile, which means that #7807 continued...</div></div></div>",
        "id": 420547686,
        "sender_full_name": "Andrew Brown",
        "timestamp": 1707428917
    }
]