[
    {
        "content": "<p><a href=\"#narrow/channel/409526-jco/topic/Issues.20using.20Rust.20component.20from.20JS/near/485532523\">A message</a> was moved here from <a class=\"stream-topic\" data-stream-id=\"409526\" href=\"/#narrow/channel/409526-jco/topic/Does.20jco.20always.20add.20import.20on.20wasi_cli.20terminal-\">#jco &gt; Does jco always add import on wasi_cli terminal-</a>* by <span class=\"user-mention silent\" data-user-id=\"598440\">Victor Adossi</span>.</p>",
        "id": 485556860,
        "sender_full_name": "Notification Bot",
        "timestamp": 1733123007
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"647375\">@Cameron Taggart</span> moved the issue in here, hopefully that's fine! </p>\n<p>I noticed that <a href=\"https://github.com/cataggar/StarlingMonkey15/blob/rs-ts-rs/typescript/wit/world.wit#L14\">you currently have the import commented out</a>, why is that? I assume you commented it out because things failed to build. </p>\n<p>It's just a guess but you <em>MIGHT</em> be running into issues trying to import and export the same interface. The <code>ts:typescript-system/types@0.1.0;</code> import tries to make use of the <code>system</code> type, but then that is <em>part of</em> the export (<code>typescript</code> which contains that resource you're building, which would use<code>system</code> in the constructor). </p>\n<p>The problem is complex, but <a href=\"https://github.com/bytecodealliance/wit-bindgen/issues/1043\">in the past this has been solved by exporting more things</a> (which in your case might be <code>ts:typescript-system/types@0.1.0</code> itself?)</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/cataggar/StarlingMonkey15/blob/rs-ts-rs/typescript/wit/world.wit#L14\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/fd473091a2c74d0dca782d30090e221b0ed599b8/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663863376439303131643038326432316365306539326132636661316166613362316564336132343038303333353735626665396531386431323261343136352f63617461676761722f537461726c696e674d6f6e6b65793135&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/cataggar/StarlingMonkey15/blob/rs-ts-rs/typescript/wit/world.wit#L14\" title=\"StarlingMonkey15/typescript/wit/world.wit at rs-ts-rs · cataggar/StarlingMonkey15\">StarlingMonkey15/typescript/wit/world.wit at rs-ts-rs · cataggar/StarlingMonkey15</a></div><div class=\"message_embed_description\">https://github.com/bytecodealliance/StarlingMonkey/issues/15 - cataggar/StarlingMonkey15</div></div></div><div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wit-bindgen/issues/1043\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/b46dca510017d9c81550a68c62b1d379549f5d39/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663561393330363966373162313062613337666238393434353764666663323433376237363365626336313366373230386530343237393062303333656561302f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f31303433&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wit-bindgen/issues/1043\" title=\"Rust: `interface transitively depends on an interface in incompatible ways` · Issue #1043 · bytecodealliance/wit-bindgen\">Rust: `interface transitively depends on an interface in incompatible ways` · Issue #1043 · bytecodealliance/wit-bindgen</a></div><div class=\"message_embed_description\">Given following WIT: package repro:component@0.1.0; world component { export wasi:io/poll@0.2.1; export wasi:http/types@0.2.1; } And following lib.rs: mod bindings { use super::Component; wit_bindg...</div></div></div>",
        "id": 485558130,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1733123724
    },
    {
        "content": "<p>Do you know how the Rust component should be imported into the JavaScript component? If I do <a href=\"https://github.com/cataggar/StarlingMonkey15/blob/rs-ts-rs/typescript/src/world.ts#L1\">this</a> <code>import { TsTypescriptSystemTypes as tssystem } from 'ts-typescript-system-types';</code>, I end up with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">bunx</span><span class=\"w\"> </span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"w\"> </span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">world</span><span class=\"p\">.</span><span class=\"n\">js</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">all</span>\n<span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"n\">opening</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"o\">-</span><span class=\"n\">types</span><span class=\"p\">.</span><span class=\"n\">js</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">resolved</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">var</span><span class=\"o\">/</span><span class=\"n\">folders</span><span class=\"o\">/</span><span class=\"n\">xm</span><span class=\"o\">/</span><span class=\"n\">hr4sq0d567vfs0xdth9t38zc0000gn</span><span class=\"o\">/</span><span class=\"n\">T</span><span class=\"o\">/</span><span class=\"n\">d8c2e742d292</span><span class=\"o\">/</span><span class=\"n\">sources</span><span class=\"o\">/</span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"o\">-</span><span class=\"n\">types</span><span class=\"p\">.</span><span class=\"n\">js</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"nc\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span>\n<span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">evaluating</span><span class=\"w\"> </span><span class=\"n\">top</span><span class=\"o\">-</span><span class=\"n\">level</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">pending</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">Aborting</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">since</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">doesn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">seem</span><span class=\"w\"> </span><span class=\"n\">recoverable</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"p\">.</span>\n<span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">the</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">componentize</span><span class=\"p\">.</span><span class=\"n\">wizer</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">trapped</span>\n</code></pre></div>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/cataggar/StarlingMonkey15/blob/rs-ts-rs/typescript/src/world.ts#L1\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/fd473091a2c74d0dca782d30090e221b0ed599b8/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663863376439303131643038326432316365306539326132636661316166613362316564336132343038303333353735626665396531386431323261343136352f63617461676761722f537461726c696e674d6f6e6b65793135&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/cataggar/StarlingMonkey15/blob/rs-ts-rs/typescript/src/world.ts#L1\" title=\"StarlingMonkey15/typescript/src/world.ts at rs-ts-rs · cataggar/StarlingMonkey15\">StarlingMonkey15/typescript/src/world.ts at rs-ts-rs · cataggar/StarlingMonkey15</a></div><div class=\"message_embed_description\">https://github.com/bytecodealliance/StarlingMonkey/issues/15 - cataggar/StarlingMonkey15</div></div></div>",
        "id": 485665549,
        "sender_full_name": "Cameron Taggart",
        "timestamp": 1733157558
    },
    {
        "content": "<p>If I bundle the JavaScript and do a workaround for <a href=\"https://github.com/oven-sh/bun/issues/15537\">https://github.com/oven-sh/bun/issues/15537</a> , then I get the error about needing to export the components from the Rust component:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">bunx</span><span class=\"w\"> </span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"p\">.</span><span class=\"n\">js</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">all</span>\n<span class=\"n\">ComponentError</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">encode</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">module</span>\n<span class=\"cp\">$failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">decode</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">module</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">module</span><span class=\"w\"> </span><span class=\"n\">was</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">valid</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">interface</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">ts</span><span class=\"p\">:</span><span class=\"nc\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"o\">/</span><span class=\"n\">types</span><span class=\"o\">@</span><span class=\"mf\">0.1.0</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"p\">[</span><span class=\"n\">method</span><span class=\"p\">]</span><span class=\"n\">system</span><span class=\"p\">.</span><span class=\"n\">get</span><span class=\"o\">-</span><span class=\"n\">arguments</span><span class=\"err\">`</span>\n</code></pre></div>\n<p>If I add the export to the wit:</p>\n<div class=\"codehilite\" data-code-language=\"wit\"><pre><span></span><code>world root {\n  import ts:typescript-system/types@0.1.0;\n  export ts:typescript-system/types@0.1.0;\n</code></pre></div>\n<p>it fails with this error, which I don't know how to resolve:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">bunx</span><span class=\"w\"> </span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"p\">.</span><span class=\"n\">js</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">all</span>\n<span class=\"n\">ComponentError</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Expected</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">JS</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">definition</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">types</span><span class=\"o\">'</span>\n<span class=\"w\">    </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">spliceBindings</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">:</span><span class=\"sd\">///Users/cataggar/ms/StarlingMonkey15/typescript/node_modules/@bytecodealliance/componentize-js/lib/spidermonkey-embedding-splicer.js:3959:11)</span>\n<span class=\"w\">    </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">:</span><span class=\"sd\">///Users/cataggar/ms/StarlingMonkey15/typescript/node_modules/@bytecodealliance/componentize-js/src/componentize.js:87:64)</span>\n<span class=\"w\">    </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"k\">async</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">:</span><span class=\"sd\">///Users/cataggar/ms/StarlingMonkey15/typescript/node_modules/@bytecodealliance/jco/src/cmd/componentize.js:11:25)</span>\n<span class=\"w\">    </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"k\">async</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"p\">:</span><span class=\"sd\">///Users/cataggar/ms/StarlingMonkey15/typescript/node_modules/@bytecodealliance/jco/src/jco.js:200:9</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">script</span><span class=\"w\"> </span><span class=\"s\">\"componentize\"</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"p\">(</span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"p\">)</span>\n<span class=\"n\">In</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">typescript</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">componentize</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/oven-sh/bun/issues/15537\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/99142b4acf3d57b49ad66a0faa93bfa83d63d98f/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f616665313264303634363336303431306635386166373265646463343362626664353265623531333739313366336330636366643034643430303435323535612f6f76656e2d73682f62756e2f6973737565732f3135353337&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/oven-sh/bun/issues/15537\" title=\"bundler creates invalid js from ts: An export declaration can only be used at the top level of a module.ts(1474) · Issue #15537 · oven-sh/bun\">bundler creates invalid js from ts: An export declaration can only be used at the top level of a module.ts(1474) · Issue #15537 · oven-sh/bun</a></div><div class=\"message_embed_description\">What version of Bun is running? 1.1.33+247456b67 What platform is your computer? Darwin 24.1.0 arm64 arm What steps can reproduce the bug? git clone git@github.com:cataggar/StarlingMonkey15.git --n...</div></div></div>",
        "id": 485672040,
        "sender_full_name": "Cameron Taggart",
        "timestamp": 1733159565
    },
    {
        "content": "<p>I commented out the potential fixes, so having it print \"todo\" should work again. Just run <code>bun run build.ts</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">~/</span><span class=\"n\">ms</span><span class=\"o\">/</span><span class=\"n\">StarlingMonkey15</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">bun</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"p\">.</span><span class=\"n\">ts</span>\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wkg</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">fetch</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"w\">  </span><span class=\"n\">Generating</span><span class=\"w\"> </span><span class=\"n\">bindings</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">bindings</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">)</span>\n<span class=\"w\">   </span><span class=\"n\">Compiling</span><span class=\"w\"> </span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">1.0</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">cataggar</span><span class=\"o\">/</span><span class=\"n\">ms</span><span class=\"o\">/</span><span class=\"n\">StarlingMonkey15</span><span class=\"o\">/</span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">dev</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">profile</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">unoptimized</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">debuginfo</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.28</span><span class=\"n\">s</span>\n<span class=\"w\">    </span><span class=\"n\">Creating</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip1</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">typescript_system</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wkg</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">fetch</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">bunx</span><span class=\"w\"> </span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">types</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"p\">.</span>\n\n<span class=\"w\">  </span><span class=\"n\">Generated</span><span class=\"w\"> </span><span class=\"n\">Type</span><span class=\"w\"> </span><span class=\"n\">Files</span><span class=\"p\">:</span>\n\n<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">interfaces</span><span class=\"o\">/</span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">ts</span><span class=\"w\">  </span><span class=\"mf\">0.17</span><span class=\"w\"> </span><span class=\"n\">KiB</span>\n<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">interfaces</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">io</span><span class=\"o\">-</span><span class=\"n\">poll</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">ts</span><span class=\"w\">              </span><span class=\"mf\">1.36</span><span class=\"w\"> </span><span class=\"n\">KiB</span>\n<span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">wit</span><span class=\"p\">.</span><span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">ts</span><span class=\"w\">                                  </span><span class=\"mf\">0.19</span><span class=\"w\"> </span><span class=\"n\">KiB</span>\n\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">bun</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">bundle</span><span class=\"p\">.</span><span class=\"n\">ts</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">bunx</span><span class=\"w\"> </span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">componentize</span><span class=\"w\"> </span><span class=\"n\">world</span><span class=\"p\">.</span><span class=\"n\">js</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">all</span>\n<span class=\"n\">OK</span><span class=\"w\"> </span><span class=\"n\">Successfully</span><span class=\"w\"> </span><span class=\"n\">written</span><span class=\"w\"> </span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wkg</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"w\"> </span><span class=\"n\">fetch</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"w\">  </span><span class=\"n\">Generating</span><span class=\"w\"> </span><span class=\"n\">bindings</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">-</span><span class=\"n\">rs</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">bindings</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">)</span>\n<span class=\"w\">   </span><span class=\"n\">Compiling</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"o\">-</span><span class=\"n\">rs</span><span class=\"w\"> </span><span class=\"n\">v0</span><span class=\"p\">.</span><span class=\"mf\">1.0</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">cataggar</span><span class=\"o\">/</span><span class=\"n\">ms</span><span class=\"o\">/</span><span class=\"n\">StarlingMonkey15</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"o\">-</span><span class=\"n\">rs</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">dev</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">profile</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">unoptimized</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">debuginfo</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.16</span><span class=\"n\">s</span>\n<span class=\"w\">    </span><span class=\"n\">Creating</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip1</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"o\">-</span><span class=\"n\">rs</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wac</span><span class=\"w\"> </span><span class=\"n\">plug</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip1</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"o\">-</span><span class=\"n\">rs</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">plug</span><span class=\"w\"> </span><span class=\"o\">../</span><span class=\"n\">typescript</span><span class=\"o\">/</span><span class=\"n\">ts</span><span class=\"o\">-</span><span class=\"n\">typescript</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">plug</span><span class=\"w\"> </span><span class=\"o\">../</span><span class=\"n\">typescript</span><span class=\"o\">-</span><span class=\"n\">system</span><span class=\"o\">/</span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip1</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">typescript_system</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n\n<span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">arguments</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">todo</span>\n</code></pre></div>",
        "id": 485678209,
        "sender_full_name": "Cameron Taggart",
        "timestamp": 1733161627
    },
    {
        "content": "<p>So making it use the Rust component and print <code>a__b__c</code> instead of <code>todo</code> may be reverting some of these <a href=\"https://github.com/cataggar/StarlingMonkey15/commit/28687c70773456f89a8c311630190a7e816078a1\">changes</a> and something else.</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/cataggar/StarlingMonkey15/commit/28687c70773456f89a8c311630190a7e816078a1\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/21df4c0b32cec4687972b1ceaaa409e67c15ca8c/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f386465373663303461613162633866666237386235303362653439333262393238373565656138623164373362323937666363636637616234396437336433652f63617461676761722f537461726c696e674d6f6e6b657931352f636f6d6d69742f32383638376337303737333435366638396138633331313633303139306137653831363037386131&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/cataggar/StarlingMonkey15/commit/28687c70773456f89a8c311630190a7e816078a1\" title=\"put todo back · cataggar/StarlingMonkey15@28687c7\">put todo back · cataggar/StarlingMonkey15@28687c7</a></div><div class=\"message_embed_description\">https://github.com/bytecodealliance/StarlingMonkey/issues/15 - put todo back · cataggar/StarlingMonkey15@28687c7</div></div></div>",
        "id": 485682061,
        "sender_full_name": "Cameron Taggart",
        "timestamp": 1733162991
    },
    {
        "content": "<p>I got the all-rust equivalent working.  One surprise was needing to <code>wac plug</code> twice. Otherwise not too difficult. It is in the <a href=\"https://github.com/cataggar/StarlingMonkey15/tree/rs-rs-rs\">rs-rs-rs branch</a>. Now back to hacking the rs-ts-rs branch.</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/cataggar/StarlingMonkey15/tree/rs-rs-rs\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/fd473091a2c74d0dca782d30090e221b0ed599b8/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663863376439303131643038326432316365306539326132636661316166613362316564336132343038303333353735626665396531386431323261343136352f63617461676761722f537461726c696e674d6f6e6b65793135&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/cataggar/StarlingMonkey15/tree/rs-rs-rs\" title=\"GitHub - cataggar/StarlingMonkey15 at rs-rs-rs\">GitHub - cataggar/StarlingMonkey15 at rs-rs-rs</a></div><div class=\"message_embed_description\">https://github.com/bytecodealliance/StarlingMonkey/issues/15 - GitHub - cataggar/StarlingMonkey15 at rs-rs-rs</div></div></div>",
        "id": 485743374,
        "sender_full_name": "Cameron Taggart",
        "timestamp": 1733194502
    },
    {
        "content": "<p>I created <a href=\"https://github.com/bytecodealliance/jco/issues/534\">https://github.com/bytecodealliance/jco/issues/534</a> for this.</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/jco/issues/534\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/4b96ed8fcfc895a625bb84b01a86daebc49d8f71/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f396438393639373336626335343333653464636236356437386663353235623062343261653162303736366461623565663532333638363039393464613133632f62797465636f6465616c6c69616e63652f6a636f2f6973737565732f353334&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/jco/issues/534\" title=\"&quot;module is invalid&quot;, &quot;failed to find export of interface&quot; of the imported interface · Issue #534 · bytecodealliance/jco\">\"module is invalid\", \"failed to find export of interface\" of the imported interface · Issue #534 · bytecodealliance/jco</a></div><div class=\"message_embed_description\">When I add import ts:typescript-system/types@0.1.0;, I get an error that the \"module is invalid\" and it \"failed to find export of interface\": $ bunx jco componentize world.js --wit wit -o ts-typesc...</div></div></div>",
        "id": 485749644,
        "sender_full_name": "Cameron Taggart",
        "timestamp": 1733198928
    },
    {
        "content": "<p>Ah thanks for filing an issue to cover this!</p>",
        "id": 485895915,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1733242994
    }
]