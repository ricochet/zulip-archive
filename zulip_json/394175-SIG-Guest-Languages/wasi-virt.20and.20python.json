[
    {
        "content": "<p>I've tried virtualizing /usr/local/lib/python* with wasi-virt so wasi python can find site-packages</p>\n<p>the example runs if I don't use wasi-virt but provide wasmtime preopened dirs, I'm pretty sure wasi-virt just doesn't provide some method python uses to guess encodings.</p>\n<p>with wasi-virt, python fails during initialization (<code>Fatal Python error: init_fs_encoding: failed to get the Python codec of the filesystem encoding</code>)</p>\n<p>I can confirm with std::fs that the files are readable, any directions how I can debug this further?</p>",
        "id": 395690994,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696855419
    },
    {
        "content": "<p>If you haven't already, make sure the PYTHONHOME and PYTHONPATH environment variables are set correctly in the guest, i.e. that they're pointing to the guest directory where the CPython system files reside.</p>",
        "id": 395698421,
        "sender_full_name": "Joel Dice",
        "timestamp": 1696857708
    },
    {
        "content": "<p>what should PYTHONPATH be if there is no python executable?</p>",
        "id": 395698930,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696857847
    },
    {
        "content": "<p>but I should print those two variables to see what they are set to in the happy path with preopen</p>",
        "id": 395699136,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696857919
    },
    {
        "content": "<p>(I didn't set them in either version)</p>",
        "id": 395699326,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696857968
    },
    {
        "content": "<p>This is how <code>componentize-py</code> sets up directories and env variables during pre-initialization, FWIW: <a href=\"https://github.com/bytecodealliance/componentize-py/blob/243c4bf62a5a4286e261c10e4cb2897b16c3b3dd/src/lib.rs#L163-L390\">https://github.com/bytecodealliance/componentize-py/blob/243c4bf62a5a4286e261c10e4cb2897b16c3b3dd/src/lib.rs#L163-L390</a>.  Note that <code>python-lib.tar.zst</code> is created from the lib/python3.11 directory here: <a href=\"https://github.com/bytecodealliance/componentize-py/blob/243c4bf62a5a4286e261c10e4cb2897b16c3b3dd/build.rs#L173-L186\">https://github.com/bytecodealliance/componentize-py/blob/243c4bf62a5a4286e261c10e4cb2897b16c3b3dd/build.rs#L173-L186</a></p>",
        "id": 395701213,
        "sender_full_name": "Joel Dice",
        "timestamp": 1696858592
    },
    {
        "content": "<p>(got distracted by work) that is the part that works for both of us, wasictx with preopened dirs is how I currently run my python components, but when I use no preopened_dirs and instead pre-bundle the component with wasi-virt, I can read the python files but I get the same error you would see if you comment out your preopened_dir calls</p>",
        "id": 395708810,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696860894
    },
    {
        "content": "<p>with \"i can read the files\" I mean std::fs::read gives me the expected data but there must be something else python expects during init_fs_encoding</p>",
        "id": 395709228,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696860998
    },
    {
        "content": "<p>Strange.  Maybe there's a bug in <code>wasi-virt</code>related to e.g. <code>stat</code>ing files</p>",
        "id": 395709375,
        "sender_full_name": "Joel Dice",
        "timestamp": 1696861044
    },
    {
        "content": "<p>I have to reduce the example to something manageable and then I'll see if some form of debugging can find out what exactly python tries to do</p>",
        "id": 395709592,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696861095
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> if you're able to share any test binary at all I'd be happy to look into it</p>",
        "id": 395729331,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696867432
    },
    {
        "content": "<p>that, uh, took longer than expected</p>\n<p><span class=\"user-mention\" data-user-id=\"553681\">@Guy Bedford</span> <a href=\"https://github.com/Gentle/repro-wasi-virt-python\">https://github.com/Gentle/repro-wasi-virt-python</a></p>\n<p><a href=\"http://build.sh\">build.sh</a> does all the steps to run the good and the sad example</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/Gentle/repro-wasi-virt-python\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/3aae08bca955a5b569404d883490d8c6e7b0ec2d\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323664613661313166643834643334333934323635303933383763353838333738316535366532326330656237653636323633323937666364393461363534322f47656e746c652f726570726f2d776173692d766972742d707974686f6e)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/Gentle/repro-wasi-virt-python\" title=\"GitHub - Gentle/repro-wasi-virt-python\">GitHub - Gentle/repro-wasi-virt-python</a></div><div class=\"message_embed_description\">Contribute to Gentle/repro-wasi-virt-python development by creating an account on GitHub.</div></div></div>",
        "id": 395753863,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696879938
    },
    {
        "content": "<p>(I do not know how to write or run command components so I made a simple host for a reactor)</p>",
        "id": 395754734,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696880498
    },
    {
        "content": "<p>thank you <span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> will take a look soon</p>",
        "id": 395754854,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696880560
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> just tried this example but I get:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span>: <span class=\"nc\">Unable</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">compose</span><span class=\"w\"> </span><span class=\"n\">virtualized</span><span class=\"w\"> </span><span class=\"n\">adapter</span><span class=\"w\"> </span><span class=\"n\">into</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"p\">.</span>\n<span class=\"n\">Make</span><span class=\"w\"> </span><span class=\"n\">sure</span><span class=\"w\"> </span><span class=\"n\">virtualizations</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">enabled</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">being</span><span class=\"w\"> </span><span class=\"n\">used</span><span class=\"p\">.</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n    <span class=\"mi\">0</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"cp\">$input</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">definition</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"o\">/</span><span class=\"n\">var</span><span class=\"o\">/</span><span class=\"n\">folders</span><span class=\"o\">/</span><span class=\"n\">m4</span><span class=\"o\">/</span><span class=\"n\">hc32lfnd57d208n1w_v_5nvw0000gp</span><span class=\"o\">/</span><span class=\"n\">T</span><span class=\"o\">/</span><span class=\"n\">virt</span><span class=\"p\">.</span><span class=\"mf\">1696971376.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"nc\">source</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">compatible</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"w\"> </span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span><span class=\"err\">`</span>\n</code></pre></div>",
        "id": 395962251,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696972846
    },
    {
        "content": "<p>so it seems like we're hitting the wit version mismatch stuff</p>",
        "id": 395962275,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696972857
    },
    {
        "content": "<p>is there some way I can lock to the same version you're using?</p>",
        "id": 395962293,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696972865
    },
    {
        "content": "<p>alternatively if you can somehow point me to the wit version being used to generate your component / if we can figure out an upgrade path in wasi virt that can work for both</p>",
        "id": 395962432,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696972927
    },
    {
        "content": "<p>wasi-virt now has the problem itself that wasm-compose doesn't support resources so we will be stuck to the version just prior</p>",
        "id": 395962463,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696972946
    },
    {
        "content": "<p>hm I've used the release version of wasm-tools and a current version of wasi-virt cargo installed from git and the wit-bindgen revision is in Cargo.lock</p>",
        "id": 395963935,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696973774
    },
    {
        "content": "<p>and 13.0.0 wasi_snapshot_preview1.reactor.wasm</p>",
        "id": 395963982,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696973807
    },
    {
        "content": "<p>either way that's not the error I expected</p>",
        "id": 395966836,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696975494
    },
    {
        "content": "<p>ahh, I was able to replicate it with the global wasi-virt install updated, thanks for clarifying</p>",
        "id": 395968438,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1696976521
    },
    {
        "content": "<p>:) I hope it helps</p>",
        "id": 395970154,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1696977772
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> I created a debugging build for Wasi-VIRT in <a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/23\">https://github.com/bytecodealliance/WASI-Virt/pull/23</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/WASI-Virt/pull/23\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/f3b410fea7228d00ea96bb64aa9ff6957c789342\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f396437346431663862386636633336383437323366326465336265663063383736366264623962366362353161383933393830396562306464393961613962322f62797465636f6465616c6c69616e63652f574153492d566972742f70756c6c2f3233)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/23\" title=\"feat: debug build by guybedford 路 Pull Request #23 路 bytecodealliance/WASI-Virt\">feat: debug build by guybedford 路 Pull Request #23 路 bytecodealliance/WASI-Virt</a></div><div class=\"message_embed_description\">This adds a new --debug build flag to WASI-Virt, which when set uses a different debug version of the virtual adapater, that contains tracing logs for all calls.\nVery much needed for debugging virt...</div></div></div>",
        "id": 396574121,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233019
    },
    {
        "content": "<p>Using this debug build against your replication then gives the following output:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">OK1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">open_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_via_stream</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_descriptor</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">open_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_directory_entry_stream</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_descriptor</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">open_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_directory_entry_stream</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span><span class=\"n\">empty</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_descriptor</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">configuration</span>:\n<span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">PYTHONHOME</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"p\">(</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"p\">)</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">PYTHONPATH</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"p\">(</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"p\">)</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">program</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">pCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">yCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">tCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">hCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">oCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">nCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"mi\">3</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">isolated</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">safe_path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">stdlib</span><span class=\"w\"> </span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">uCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">sCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">rCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">lCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">oCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">cCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">aCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">lCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">lCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">iCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">bCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">pCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">yCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">tCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">hCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">oCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">nCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"mi\">3</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"p\">.</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"mi\">1</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"mi\">1</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">_base_executable</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">''</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">base_prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">base_exec_prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">platlibdir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'</span><span class=\"na\">lib</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">executable</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">''</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">exec_prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">    </span><span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span><span class=\"o\">'</span><span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">    </span><span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">'</span><span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">    </span><span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span><span class=\"o\">'</span><span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"p\">]</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">Fatal</span><span class=\"w\"> </span><span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">error</span>: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">init_fs_encodingCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">codec</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">filesystem</span><span class=\"w\"> </span><span class=\"n\">encodingCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">runtime</span><span class=\"w\"> </span><span class=\"n\">state</span>: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">initializedCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">ModuleNotFoundErrorCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"n\">named</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">encodings</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"n\">Current</span><span class=\"w\"> </span><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"mh\">0xCA</span><span class=\"n\">LL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"mi\">00000000</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">most</span><span class=\"w\"> </span><span class=\"n\">recent</span><span class=\"w\"> </span><span class=\"n\">call</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"p\">)</span>:\n<span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span>\n<span class=\"w\">  </span><span class=\"o\">&lt;</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"o\">&gt;</span>\n</code></pre></div>",
        "id": 396574240,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233086
    },
    {
        "content": "<p>Without knowing the details of the Python error further it is difficult to tell where the issue is</p>",
        "id": 396574266,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233107
    },
    {
        "content": "<p>but I hope that at least helps to start to narrow it down further</p>",
        "id": 396574277,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233114
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"509936\">@Joel Dice</span> if you say this might be a stat issue - note that virtualied files in Wasi VIRT currently return times that are at the epoch</p>",
        "id": 396574380,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233184
    },
    {
        "content": "<p>not sure if that would affect things</p>",
        "id": 396574386,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233188
    },
    {
        "content": "<p>and here's a version with even more argument context included:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">OK1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">open_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_via_stream</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">OFFSET</span><span class=\"o\">=</span><span class=\"mi\">4107234</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_descriptor</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">open_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_directory_entry_stream</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"p\">.</span><span class=\"n\">py</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_descriptor</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_flags</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">open_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">4</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span><span class=\"n\">empty</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">read_directory_entry</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">4</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_directory_entry_stream</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">4</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">stat_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span><span class=\"n\">empty</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">metadata_hash_at</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span><span class=\"n\">empty</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">drop_descriptor</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">3</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">configuration</span>:\n<span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">PYTHONHOME</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">(</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"p\">)</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">PYTHONPATH</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">(</span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">set</span><span class=\"p\">)</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">program</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">pCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">yCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">tCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">hCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">oCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">nCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"mi\">3</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">isolated</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">safe_path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">stdlib</span><span class=\"w\"> </span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">uCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">sCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">rCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">lCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">oCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">cCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">aCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">lCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">lCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">iCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">bCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">/</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">pCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">yCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">tCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">hCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">oCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">nCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"mi\">3</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">.</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"mi\">1</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"mi\">1</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">_base_executable</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">''</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">base_prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">base_exec_prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">platlibdir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'</span><span class=\"na\">lib</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">executable</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">''</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">exec_prefix</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">sys</span><span class=\"p\">.</span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">    </span><span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python311</span><span class=\"p\">.</span><span class=\"n\">zip</span><span class=\"o\">'</span><span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">    </span><span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">'</span><span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">    </span><span class=\"o\">'/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"p\">.</span><span class=\"mi\">11</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">-</span><span class=\"n\">dynload</span><span class=\"o\">'</span><span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"p\">]</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">Fatal</span><span class=\"w\"> </span><span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">error</span>: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">init_fs_encodingCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">codec</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">filesystem</span><span class=\"w\"> </span><span class=\"n\">encodingCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">runtime</span><span class=\"w\"> </span><span class=\"n\">state</span>: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">initializedCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">ModuleNotFoundErrorCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n: <span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"n\">named</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">encodings</span><span class=\"o\">'</span><span class=\"na\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">Current</span><span class=\"w\"> </span><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"mh\">0xCA</span><span class=\"n\">LL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"mi\">00000000</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">most</span><span class=\"w\"> </span><span class=\"n\">recent</span><span class=\"w\"> </span><span class=\"n\">call</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"p\">)</span>:\n<span class=\"nc\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"o\">&lt;</span><span class=\"n\">no</span><span class=\"w\"> </span><span class=\"n\">Python</span><span class=\"w\"> </span><span class=\"n\">frame</span><span class=\"o\">&gt;</span>\n</code></pre></div>",
        "id": 396575356,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697233825
    },
    {
        "content": "<p>Am I reading correctly that the guest only ever seems to <code>stat</code> with a path that starts with <code>local/</code>?  It never seems to look at the <code>/usr</code> directory where the files actually are.  My guess is that in the non-virt case, the current working directory defaults to the first (and only) preopen, i.e. <code>/usr</code>, whereas in the virt case the current working directory is something else, e.g. <code>/</code>.  Is that plausible?</p>",
        "id": 396575739,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697234088
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"509936\">@Joel Dice</span> the preopen would be <code>/</code> in this case</p>",
        "id": 396575794,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697234125
    },
    {
        "content": "<p>but yes, that's correct</p>",
        "id": 396575808,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697234133
    },
    {
        "content": "<p>but I did find it odd too that all paths start with local but it's not apparent if the workdis is /usr</p>",
        "id": 396575880,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697234173
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"509936\">@Joel Dice</span> but yeah, I switched from mounting usr/ to /usr and instead mounting root/ to / during writing the example, didn't change the behaviour so I left it at mounting /</p>",
        "id": 396576470,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697234557
    },
    {
        "content": "<p>Am I looking at out-of-date code, then? Looks like it's still /usr here: <a href=\"https://github.com/Gentle/repro-wasi-virt-python/blob/main/build.sh#L19\">https://github.com/Gentle/repro-wasi-virt-python/blob/main/build.sh#L19</a></p>",
        "id": 396576717,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697234752
    },
    {
        "content": "<p>oh you're right, now I'm unsure if I did test that, sec</p>",
        "id": 396576892,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697234853
    },
    {
        "content": "<p>it might also be enlightening to print <code>std::env::current_dir()</code> in the guest to see what the values are in the virt and non-virt cases.</p>",
        "id": 396577057,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697234949
    },
    {
        "content": "<p>(guess who has a 7 year old CPU... but I added the current_dir print before starting the build too)</p>",
        "id": 396577401,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697235164
    },
    {
        "content": "<p>ok so if you wasi-virt virtualize / it crashes earlier and actually in wasi-virt code</p>",
        "id": 396579181,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697236452
    },
    {
        "content": "<p>current_dir is always / though, no matter if I mount /usr or /</p>",
        "id": 396579198,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697236484
    },
    {
        "content": "<p>what is current_dir in the non-virt case?</p>",
        "id": 396579209,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697236500
    },
    {
        "content": "<p>(i.e. when everything works correctly)?</p>",
        "id": 396579232,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697236521
    },
    {
        "content": "<p>it's always <code>/</code> in all 4 cases (with/without wasi-virt and with <code>/</code> or with <code>/usr</code> mounted)</p>",
        "id": 396579341,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697236618
    },
    {
        "content": "<p>this example is using a precompiled libpython in release mode, would linking against a debug build of python result in better backtraces? I still haven't fully grasped your <a href=\"http://build.rs\">build.rs</a></p>",
        "id": 396579513,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697236801
    },
    {
        "content": "<p>Not sure.  It's worth a shot.  Might also be worth reading through the CPython source code and adding log statements to it.<br>\nBTW, did you ever try setting <code>PYTHONPATH</code> and <code>PYTHONHOME</code>?  I realize that won't help us understand difference in virt vs. non-virt behavior, but it might get you unstuck at least.</p>",
        "id": 396579904,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697237149
    },
    {
        "content": "<p>again, what is PYTHONPATH if no python binary exists?<br>\nstill <code>/usr/local/bin</code>?</p>",
        "id": 396579985,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697237195
    },
    {
        "content": "<p><code>componentize-py</code> sets PYTHONHOME to a mount of cpython/builddir/wasi/install/lib/python3.11 and sets PYTHONPATH to that same mount, plus any other directories that contain Python dependencies.</p>",
        "id": 396580169,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697237392
    },
    {
        "content": "<p>so if cpython/builddir/wasi/install/lib/python3.11  is mounted at /python, then PYTHONHOME=/python and PYTHONPATH=/python:/foo:/bar, where /foo and /bar might contain other .py files, etc.</p>",
        "id": 396580276,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697237469
    },
    {
        "content": "<p>replace <code>cpython/builddir/wasi/install</code> in the above with whatever you set <code>--prefix</code> to when you built CPython for WASI</p>",
        "id": 396580413,
        "sender_full_name": "Joel Dice",
        "timestamp": 1697237588
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"553681\">@Guy Bedford</span> I'm curious, why do some of these paths start with // and some with /?</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Virtualized</span><span class=\"w\"> </span><span class=\"n\">files</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">local</span><span class=\"w\"> </span><span class=\"n\">filesystem</span>:\n\n  <span class=\"o\">-</span><span class=\"w\"> </span><span class=\"c1\">//usr/local/lib : wasi-root/usr/local/lib</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"c1\">//usr/local/lib/python3.11 : wasi-root/usr/local/lib/python3.11</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"c1\">//usr/local/lib/python3.11/lib-dynload : wasi-root/usr/local/lib/python3.11/lib-dynload</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"c1\">//usr/local/lib/python3.11/lib-dynload/.empty : wasi-root/usr/local/lib/python3.11/lib-dynload/.empty</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"c1\">//usr/local/lib/python3.11/os.py : wasi-root/usr/local/lib/python3.11/os.py</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"c1\">//usr/local/lib/python311.zip : wasi-root/usr/local/lib/python311.zip</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"w\"> </span>: <span class=\"nc\">wasi</span><span class=\"o\">-</span><span class=\"n\">root</span><span class=\"o\">/</span><span class=\"n\">usr</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span><span class=\"w\"> </span>: <span class=\"nc\">wasi</span><span class=\"o\">-</span><span class=\"n\">root</span><span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">local</span>\n</code></pre></div>\n<p>this is the output for <code>--mount /=wasi-root/</code></p>",
        "id": 396581215,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697238296
    },
    {
        "content": "<p>I've pushed the version that mounts / and crashes even before python prints the error message</p>",
        "id": 396581525,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697238533
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">get_type</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">[</span><span class=\"n\">guest</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">12</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">env</span>::<span class=\"n\">current_dir</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">OkCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">(</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"w\">    </span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"s\">\"CALL wasi:io/streams#blocking_write_and_flush SID=2</span>\n<span class=\"s\">/CALL wasi:io/streams#blocking_write_and_flush SID=2</span>\n<span class=\"s\">\"</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">,</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"p\">)</span><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">host</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">main</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">92</span>:<span class=\"mi\">54</span>:\n<span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Result</span>::<span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Err</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>: <span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">executing</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>:\n    <span class=\"mi\">0</span>: <span class=\"mh\">0x20dc735</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">110</span><span class=\"o\">&gt;</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span>: <span class=\"mh\">0x40d7</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">68</span><span class=\"o\">&gt;</span>\n<span class=\"w\">    </span><span class=\"mi\">2</span>: <span class=\"mh\">0x20cbcfb</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"o\">-</span><span class=\"n\">component</span>:<span class=\"nc\">shim</span><span class=\"o\">!</span><span class=\"n\">indirect</span><span class=\"o\">-</span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span><span class=\"o\">-</span><span class=\"n\">readlink</span><span class=\"o\">-</span><span class=\"n\">at</span>\n<span class=\"w\">    </span><span class=\"mi\">3</span>: <span class=\"mh\">0x20c8570</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"o\">-</span><span class=\"n\">component</span>:<span class=\"nc\">adapter</span>:<span class=\"nc\">wasi_snapshot_preview1</span><span class=\"o\">!</span><span class=\"n\">wasi_snapshot_preview1</span>::<span class=\"n\">bindings</span>::<span class=\"n\">wasi</span>::<span class=\"n\">filesystem</span>::<span class=\"n\">types</span>::<span class=\"n\">readlink_at</span>::<span class=\"n\">he5ee92fe9a3edb88</span>\n<span class=\"w\">    </span><span class=\"mi\">4</span>: <span class=\"mh\">0x20c48fb</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"o\">-</span><span class=\"n\">component</span>:<span class=\"nc\">adapter</span>:<span class=\"nc\">wasi_snapshot_preview1</span><span class=\"o\">!</span><span class=\"n\">path_readlink</span>\n<span class=\"w\">    </span><span class=\"mi\">5</span>: <span class=\"mh\">0x20cbfc9</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">wit</span><span class=\"o\">-</span><span class=\"n\">component</span>:<span class=\"nc\">shim</span><span class=\"o\">!</span><span class=\"n\">adapt</span><span class=\"o\">-</span><span class=\"n\">wasi_snapshot_preview1</span><span class=\"o\">-</span><span class=\"n\">path_readlink</span>\n<span class=\"w\">    </span><span class=\"mi\">6</span>: <span class=\"mh\">0xc52568</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">__wasi_path_readlink</span>\n<span class=\"w\">    </span><span class=\"mi\">7</span>: <span class=\"mh\">0xc5296e</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">__wasilibc_nocwd_readlinkat</span>\n<span class=\"w\">    </span><span class=\"mi\">8</span>: <span class=\"mh\">0xc539ee</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">readlink</span>\n<span class=\"w\">    </span><span class=\"mi\">9</span>: <span class=\"mh\">0x2cca68</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_Py_wreadlink</span>\n<span class=\"w\">   </span><span class=\"mi\">10</span>: <span class=\"mh\">0x2ad007</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">getpath_realpath</span>\n<span class=\"w\">   </span><span class=\"mi\">11</span>: <span class=\"mh\">0x47bc0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">cfunction_call</span>\n<span class=\"w\">   </span><span class=\"mi\">12</span>: <span class=\"mh\">0x2f4a6f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyObject_MakeTpCall</span>\n<span class=\"w\">   </span><span class=\"mi\">13</span>: <span class=\"mh\">0x2f43f9</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyObject_VectorcallTstate</span>\n<span class=\"w\">   </span><span class=\"mi\">14</span>: <span class=\"mh\">0x2f5a8c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">PyObject_Vectorcall</span>\n<span class=\"w\">   </span><span class=\"mi\">15</span>: <span class=\"mh\">0x28dad4</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyEval_EvalFrameDefault</span>\n<span class=\"w\">   </span><span class=\"mi\">16</span>: <span class=\"mh\">0x26bd41</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyEval_EvalFrame</span>\n<span class=\"w\">   </span><span class=\"mi\">17</span>: <span class=\"mh\">0x26b701</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyEval_Vector</span>\n<span class=\"w\">   </span><span class=\"mi\">18</span>: <span class=\"mh\">0x26b402</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">PyEval_EvalCode</span>\n<span class=\"w\">   </span><span class=\"mi\">19</span>: <span class=\"mh\">0x2a9fac</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyConfig_InitPathConfig</span>\n<span class=\"w\">   </span><span class=\"mi\">20</span>: <span class=\"mh\">0x2be0c2</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">config_init_import</span>\n<span class=\"w\">   </span><span class=\"mi\">21</span>: <span class=\"mh\">0x2be04a</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">_PyConfig_InitImportConfig</span>\n<span class=\"w\">   </span><span class=\"mi\">22</span>: <span class=\"mh\">0xbe69e6</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">init_interp_main</span>\n<span class=\"w\">   </span><span class=\"mi\">23</span>: <span class=\"mh\">0xbe605d</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">pyinit_main</span>\n<span class=\"w\">   </span><span class=\"mi\">24</span>: <span class=\"mh\">0xbe5b95</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">Py_InitializeFromConfig</span>\n<span class=\"w\">   </span><span class=\"mi\">25</span>: <span class=\"mh\">0xbe7513</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">Py_InitializeEx</span>\n<span class=\"w\">   </span><span class=\"mi\">26</span>: <span class=\"mh\">0xc2dcbb</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">pyo3</span>::<span class=\"n\">gil</span>::<span class=\"n\">prepare_freethreaded_python</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h7c6b1ea7a1e67b74</span>\n<span class=\"w\">   </span><span class=\"mi\">27</span>: <span class=\"mh\">0xc2bf27</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">parking_lot</span>::<span class=\"n\">once</span>::<span class=\"n\">Once</span>::<span class=\"n\">call_once_force</span>::<span class=\"p\">{{</span><span class=\"n\">closure</span><span class=\"p\">}}</span>::<span class=\"n\">h5c081b1fa0024754</span>\n<span class=\"w\">   </span><span class=\"mi\">28</span>: <span class=\"mh\">0xc3a82b</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">parking_lot</span>::<span class=\"n\">once</span>::<span class=\"n\">Once</span>::<span class=\"n\">call_once_slow</span>::<span class=\"n\">h6ee34d935790bed0</span>\n<span class=\"w\">   </span><span class=\"mi\">29</span>: <span class=\"mh\">0xc2bdbe</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">parking_lot</span>::<span class=\"n\">once</span>::<span class=\"n\">Once</span>::<span class=\"n\">call_once_force</span>::<span class=\"n\">h0586f871a09e24ad</span>\n<span class=\"w\">   </span><span class=\"mi\">30</span>: <span class=\"mh\">0xc2dc79</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">pyo3</span>::<span class=\"n\">gil</span>::<span class=\"n\">prepare_freethreaded_python</span>::<span class=\"n\">hf2c84c00e83d0f7e</span>\n<span class=\"w\">   </span><span class=\"mi\">31</span>: <span class=\"mh\">0xb85f</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!&lt;</span><span class=\"n\">guest</span>::<span class=\"n\">Repro</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">guest</span>::<span class=\"n\">Guest</span><span class=\"o\">&gt;</span>::<span class=\"n\">version</span>::<span class=\"n\">h50616f722a26c1a7</span>\n<span class=\"w\">   </span><span class=\"mi\">32</span>: <span class=\"mh\">0xb8bf</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">unknown</span><span class=\"o\">&gt;!</span><span class=\"n\">version</span>\n</code></pre></div>",
        "id": 396582895,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697239789
    },
    {
        "content": "<p>I think I've found the or at least a culprit<br>\nthere's diverging behaviour in readlink</p>\n<p>without wasi-virt:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">[</span><span class=\"n\">guest</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">13</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">fs</span>::<span class=\"n\">read_link</span><span class=\"p\">(</span><span class=\"s\">\".\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nb\">Err</span><span class=\"p\">(</span>\n<span class=\"w\">    </span><span class=\"n\">Os</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">code</span>: <span class=\"mi\">28</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"n\">kind</span>: <span class=\"nc\">InvalidInput</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"n\">message</span>: <span class=\"s\">\"Invalid argument\"</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">},</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<p>with wasi-virt:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">[</span><span class=\"n\">guest</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">13</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">std</span>::<span class=\"n\">fs</span>::<span class=\"n\">read_link</span><span class=\"p\">(</span><span class=\"s\">\".\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nb\">Err</span><span class=\"p\">(</span>\n<span class=\"w\">    </span><span class=\"n\">Os</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"n\">code</span>: <span class=\"mi\">44</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"n\">kind</span>: <span class=\"nc\">NotFound</span><span class=\"p\">,</span>\n<span class=\"w\">        </span><span class=\"n\">message</span>: <span class=\"s\">\"No such file or directory\"</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"p\">},</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<p>and Python happens to excessively use readlin to check if any filename is a link <a href=\"https://github.com/python/cpython/blob/main/Python/fileutils.c#L2049-L2093\">https://github.com/python/cpython/blob/main/Python/fileutils.c#L2049-L2093</a></p>",
        "id": 396587070,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697242878
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> I've posted a fix for the double slashing in <a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/27\">https://github.com/bytecodealliance/WASI-Virt/pull/27</a>. For the issue you've traced down, have you tried mounting the <code>.</code> preopen itself? There might be some subtleties here around current directory handling. The other thing to note is that the FS virtualization doesn't currently support symlinks at all. </p>\n<p>Between current dir handling and symlinks support it sounds like that is where the issue lies. I'm happy to look into directions further, but also don't want to speculate on the solution either.</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/WASI-Virt/pull/27\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/8fb3c3131d3edcc22c8ba291c6475babd33ab6c0\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643865623462396534643731333636623934346663333664376661326132356635643936396264653564626265343437393837333135306535383038346232342f62797465636f6465616c6c69616e63652f574153492d566972742f70756c6c2f3237)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/27\" title=\"fix: double slashing preopens by guybedford 路 Pull Request #27 路 bytecodealliance/WASI-Virt\">fix: double slashing preopens by guybedford 路 Pull Request #27 路 bytecodealliance/WASI-Virt</a></div><div class=\"message_embed_description\">Fixes an issue where preopens with a trailing / would lead to double-slashed paths.</div></div></div>",
        "id": 396969290,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697486387
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"553681\">@Guy Bedford</span> fully agreed, I think if anything this shows how far you've come, it doesn't crash, just answers wrongly to some api calls</p>\n<p>for now I'm glad with how far it gets already, it's not a show stopper for me personally since I can deploy the wasi-root directory, and I don't think it's wise to brute force the specific issue right now instead of properly designing symlink support at the right time</p>",
        "id": 396970563,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697486996
    },
    {
        "content": "<p>about mounting something to <code>.</code>, pythin still seems to call readlink_ as first call, but I'll try it when I have time</p>",
        "id": 396971051,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697487242
    },
    {
        "content": "<p>I've created <a href=\"https://github.com/bytecodealliance/WASI-Virt/issues/28\">https://github.com/bytecodealliance/WASI-Virt/issues/28</a> to track</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/WASI-Virt/issues/28\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/d094b3b0b067ab4101f8c5f1008bfdf35b027aa8\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f646565336135353938333231613034333835623936643433653362613164653133373834636136363337366662636262373231613336376438353837313230662f62797465636f6465616c6c69616e63652f574153492d566972742f6973737565732f3238)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/WASI-Virt/issues/28\" title=\"Symlink support 路 Issue #28 路 bytecodealliance/WASI-Virt\">Symlink support 路 Issue #28 路 bytecodealliance/WASI-Virt</a></div><div class=\"message_embed_description\">We should add support for symlink mounting in WASI-Virt.</div></div></div>",
        "id": 396971480,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697487449
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> here's a PR that removes the panic on a readlink call - <a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\">https://github.com/bytecodealliance/WASI-Virt/pull/30</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/dee362308292392a1ceebf231feb2626b4b4bfeb\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643038633630373333613863633761303466646166633332383534616137646638356166613565306131363565306531623664623031303431656633336262312f62797465636f6465616c6c69616e63652f574153492d566972742f70756c6c2f3330)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\" title=\"fix: dont throw on readlink_at by guybedford 路 Pull Request #30 路 bytecodealliance/WASI-Virt\">fix: dont throw on readlink_at by guybedford 路 Pull Request #30 路 bytecodealliance/WASI-Virt</a></div><div class=\"message_embed_description\">While we still don't support symlinks, this at least avoids bailing out readlink_at calls.</div></div></div>",
        "id": 396979619,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697491627
    },
    {
        "content": "<p>installing</p>",
        "id": 396979978,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697491872
    },
    {
        "content": "<p>I've added some further commits which fix some intermediate issues as well</p>",
        "id": 396980783,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697492361
    },
    {
        "content": "<p>progress :D</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"p\">.</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">filesystem</span><span class=\"o\">/</span><span class=\"n\">types</span>#<span class=\"n\">readlink_</span><span class=\"w\"> </span><span class=\"n\">FD</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..</span>\n<span class=\"n\">CALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n<span class=\"n\">Exception</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"w\"> </span><span class=\"n\">evaluating</span><span class=\"w\"> </span><span class=\"n\">pathCALL</span><span class=\"w\"> </span><span class=\"n\">wasi</span>:<span class=\"nc\">io</span><span class=\"o\">/</span><span class=\"n\">streams</span>#<span class=\"n\">blocking_write_and_flush</span><span class=\"w\"> </span><span class=\"n\">SID</span><span class=\"o\">=</span><span class=\"mi\">2</span>\n</code></pre></div>",
        "id": 396981636,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697492893
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> make sure to pull the latest - I already fixed that one :)</p>",
        "id": 396981884,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697493052
    },
    {
        "content": "<p>damn you wasm-opt-sys, I'm still waiting on the new build and having a C++ dependency doesn't help ;)</p>",
        "id": 396982997,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697493670
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"550770\">@Ramon Klass</span> I just got it working against <a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\">https://github.com/bytecodealliance/WASI-Virt/pull/30</a> I think actually</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/dee362308292392a1ceebf231feb2626b4b4bfeb\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643038633630373333613863633761303466646166633332383534616137646638356166613565306131363565306531623664623031303431656633336262312f62797465636f6465616c6c69616e63652f574153492d566972742f70756c6c2f3330)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\" title=\"fix: dont throw on readlink_at by guybedford 路 Pull Request #30 路 bytecodealliance/WASI-Virt\">fix: dont throw on readlink_at by guybedford 路 Pull Request #30 路 bytecodealliance/WASI-Virt</a></div><div class=\"message_embed_description\">While we still don't support symlinks, this at least avoids bailing out readlink_at calls.</div></div></div>",
        "id": 396983227,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697493836
    },
    {
        "content": "<p>with the latest changes again</p>",
        "id": 396983232,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697493840
    },
    {
        "content": "<p>please try that out and let me know if that seems like it's working</p>",
        "id": 396983279,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697493847
    },
    {
        "content": "<p>kinda exciting if it is!</p>",
        "id": 396983290,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697493851
    },
    {
        "content": "<p>side question while it rebuilds, why do you have binaries commited in lib/?</p>",
        "id": 396983785,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697494162
    },
    {
        "content": "<p>actually now that I think about it, cargo install can't run preinstall scripts unless there's some way I don't know, and youi can't run cargo in <a href=\"http://build.rs\">build.rs</a> so I think I answered my question myself</p>",
        "id": 396983992,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697494275
    },
    {
        "content": "<p>good point, added <a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\">https://github.com/bytecodealliance/WASI-Virt/pull/30</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/dee362308292392a1ceebf231feb2626b4b4bfeb\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643038633630373333613863633761303466646166633332383534616137646638356166613565306131363565306531623664623031303431656633336262312f62797465636f6465616c6c69616e63652f574153492d566972742f70756c6c2f3330)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/WASI-Virt/pull/30\" title=\"fix: dont throw on readlink_at by guybedford 路 Pull Request #30 路 bytecodealliance/WASI-Virt\">fix: dont throw on readlink_at by guybedford 路 Pull Request #30 路 bytecodealliance/WASI-Virt</a></div><div class=\"message_embed_description\">While we still don't support symlinks, this at least avoids bailing out readlink_at calls.</div></div></div>",
        "id": 396983997,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697494279
    },
    {
        "content": "<p>oh wait yeah that's the reason</p>",
        "id": 396984032,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697494299
    },
    {
        "content": "<p>well, you CAN set CARGO_TARGET_DIR in <a href=\"http://build.rs\">build.rs</a> and then run cargo but that then creates two independant compiler caches</p>",
        "id": 396984142,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697494341
    },
    {
        "content": "<p>once it's published to cargo we can remove that</p>",
        "id": 396984215,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697494384
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Initializing</span><span class=\"w\"> </span><span class=\"n\">non</span><span class=\"o\">-</span><span class=\"n\">virtualized</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">preopened</span><span class=\"w\"> </span><span class=\"n\">dir</span>\n<span class=\"n\">Response</span>: <span class=\"mf\">3.11.4</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">tags</span><span class=\"o\">/</span><span class=\"n\">v3</span><span class=\"p\">.</span><span class=\"mf\">11.4</span>:<span class=\"nc\">d2340ef</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Jul</span><span class=\"w\"> </span><span class=\"mi\">14</span><span class=\"w\"> </span><span class=\"mi\">2023</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">11</span>:<span class=\"mi\">21</span>:<span class=\"mi\">37</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">Clang</span><span class=\"w\"> </span><span class=\"mf\">16.0.0</span><span class=\"w\"> </span><span class=\"p\">]</span>\n<span class=\"n\">Initializing</span><span class=\"w\"> </span><span class=\"n\">virtualized</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"w\"> </span><span class=\"n\">without</span><span class=\"w\"> </span><span class=\"n\">preopened</span><span class=\"w\"> </span><span class=\"n\">dir</span>\n<span class=\"n\">Response</span>: <span class=\"mf\">3.11.4</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">tags</span><span class=\"o\">/</span><span class=\"n\">v3</span><span class=\"p\">.</span><span class=\"mf\">11.4</span>:<span class=\"nc\">d2340ef</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">Jul</span><span class=\"w\"> </span><span class=\"mi\">14</span><span class=\"w\"> </span><span class=\"mi\">2023</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">11</span>:<span class=\"mi\">21</span>:<span class=\"mi\">37</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">Clang</span><span class=\"w\"> </span><span class=\"mf\">16.0.0</span><span class=\"w\"> </span><span class=\"p\">]</span>\n</code></pre></div>\n<p>this is amazing</p>",
        "id": 396984950,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697494777
    },
    {
        "content": "<p>are you merging pull/30 or should I depend on the symlinks branch now? :D</p>",
        "id": 396985434,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697495048
    },
    {
        "content": "<p>so uh, since we now have a python component that doesn't need a filesystem anymore, we have to run that on jco next, right? ;)</p>",
        "id": 396986104,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697495459
    },
    {
        "content": "<p>it's a 37 MB static website but it does just work</p>",
        "id": 396990300,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697497596
    },
    {
        "content": "<p>amazing, the pieces do work :)</p>",
        "id": 396991184,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1697498006
    },
    {
        "content": "<p>Congratulations to everyone discovering that CPython is one of the best POSIX (and C standard compiler) test suites out there. <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>\n<p>It sounds like nothing needs to change in how CPython is built, correct?</p>",
        "id": 397178016,
        "sender_full_name": "Brett Cannon",
        "timestamp": 1697574599
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"553681\">@Guy Bedford</span>  I have updated the repro, importing a pure python module from site-packages fails to read the files, I've added the two versions to the host again to see what it should do <a href=\"https://github.com/Gentle/repro-wasi-virt-python/\">https://github.com/Gentle/repro-wasi-virt-python/</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/Gentle/repro-wasi-virt-python/\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/3aae08bca955a5b569404d883490d8c6e7b0ec2d\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323664613661313166643834643334333934323635303933383763353838333738316535366532326330656237653636323633323937666364393461363534322f47656e746c652f726570726f2d776173692d766972742d707974686f6e)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/Gentle/repro-wasi-virt-python/\" title=\"GitHub - Gentle/repro-wasi-virt-python\">GitHub - Gentle/repro-wasi-virt-python</a></div><div class=\"message_embed_description\">Contribute to Gentle/repro-wasi-virt-python development by creating an account on GitHub.</div></div></div>",
        "id": 397375372,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697658982
    },
    {
        "content": "<p>wait the debug output looks like it did interpret some of the code, it reads the files in order of imports<br>\nalso sorry for highlighting</p>",
        "id": 397377160,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1697659838
    }
]