[
    {
        "content": "<p>Hi, is there examples of linking two wasm component in the wasmtime?<br>\nIn my example, 2nd component imports interface from 1st component.<br>\nfirst wit</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">acme</span>:<span class=\"nc\">first</span>\n<span class=\"n\">interface</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"o\">-</span><span class=\"n\">service</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">     </span><span class=\"n\">hello</span>: <span class=\"nc\">func</span><span class=\"p\">(</span><span class=\"n\">msg</span>: <span class=\"nc\">string</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"o\">-</span><span class=\"n\">world</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"o\">-</span><span class=\"n\">service</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>2nd wit depends on first</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">acme</span>:<span class=\"nc\">second</span>\n<span class=\"n\">interface</span><span class=\"w\"> </span><span class=\"n\">second</span><span class=\"o\">-</span><span class=\"n\">service</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">     </span><span class=\"n\">hello</span>: <span class=\"nc\">drive</span><span class=\"p\">()</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">second</span><span class=\"o\">-</span><span class=\"n\">world</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">   </span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"n\">first</span><span class=\"o\">-</span><span class=\"n\">service</span>\n<span class=\"w\">    </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">second</span><span class=\"o\">-</span><span class=\"n\">service</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>I tried something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">....</span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">first_comp</span><span class=\"w\">  </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Component</span>::<span class=\"n\">from_file</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">path1</span><span class=\"p\">)</span><span class=\"o\">?</span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">second_comp</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Component</span>::<span class=\"n\">from_file</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">path2</span><span class=\"p\">)</span><span class=\"o\">?</span><span class=\"p\">;</span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">first_instance</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">linker</span><span class=\"p\">.</span><span class=\"n\">instantiate</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">store</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">first_comp</span><span class=\"p\">)</span><span class=\"o\">?</span><span class=\"p\">;</span><span class=\"w\">   </span><span class=\"c1\">// this works</span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">second_instance</span><span class=\"w\">  </span><span class=\"o\">=</span><span class=\"w\">  </span><span class=\"n\">linker</span><span class=\"p\">.</span><span class=\"n\">instantiate</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">store</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">second_comp</span><span class=\"p\">)</span><span class=\"o\">?</span><span class=\"p\">;.</span><span class=\"w\">  </span><span class=\"c1\">// this doesn't work</span>\n</code></pre></div>\n<p>but result in error message something like<br>\nError: import <code>acme:first/first-service</code> has the wrong type</p>\n<p>Caused by:<br>\n    0: instance export <code>hello</code> has the wrong type<br>\n    1: expected func found nothing</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code>\n</code></pre></div>",
        "id": 394019803,
        "sender_full_name": "Sehyo Chang",
        "timestamp": 1696031093
    },
    {
        "content": "<p>nope, unlike the wasmtime module linker, the only thing the wasmtime component linker can do is link a component to host function definitions.</p>",
        "id": 394020547,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1696031732
    },
    {
        "content": "<p>if you need to link components, we recommend you use <code>wasm-tools compose</code> or the <code>wasm-compose</code> crate</p>",
        "id": 394020558,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1696031745
    },
    {
        "content": "<p>Got it.  Linking thru compose works.  Thanks</p>",
        "id": 394025483,
        "sender_full_name": "Sehyo Chang",
        "timestamp": 1696034882
    },
    {
        "content": "<p>Hi bro. I'm got this error too. but I'm a newer for wasmtime and wasm. please help me. how to use it link to wasmtime</p>",
        "id": 405311816,
        "sender_full_name": "Banna Jack",
        "timestamp": 1701419958
    }
]