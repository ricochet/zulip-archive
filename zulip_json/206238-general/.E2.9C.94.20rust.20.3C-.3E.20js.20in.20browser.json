[
    {
        "content": "<p>I'm toying around with a simple wit definition and it's generated code: I implemented the Rust side, and a way to call it from js (in the browser):</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">FeatureDescription</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">name</span>: <span class=\"nc\">string</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">description</span>: <span class=\"nc\">string</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"c1\">// Return the list of supported features.</span>\n<span class=\"n\">get_features</span>: <span class=\"nc\">function</span><span class=\"p\">()</span><span class=\"w\"> </span>-&gt; <span class=\"nc\">list</span><span class=\"o\">&lt;</span><span class=\"n\">FeatureDescription</span><span class=\"o\">&gt;</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code>  <span class=\"kd\">let</span> <span class=\"nx\">plugins</span> <span class=\"o\">=</span> <span class=\"ow\">new</span> <span class=\"nx\">Plugins</span><span class=\"p\">();</span>\n  <span class=\"k\">await</span> <span class=\"nx\">plugins</span><span class=\"p\">.</span><span class=\"nx\">instantiate</span><span class=\"p\">(</span>\n    <span class=\"nx\">fetch</span><span class=\"p\">(</span><span class=\"s2\">\"./target/wasm32-unknown-unknown/release/witplugins.wasm\"</span><span class=\"p\">)</span>\n  <span class=\"p\">);</span>\n  <span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"sb\">`Features: `</span><span class=\"p\">,</span> <span class=\"nx\">plugins</span><span class=\"p\">.</span><span class=\"nx\">getFeatures</span><span class=\"p\">());</span>\n</code></pre></div>\n<p>the <code>getFeatures()</code> call fails because the JS side expects a \"canonical_abi_free\" export which is not provided. What am I missing on the Rust side?</p>\n<p>Thanks!</p>",
        "id": 265373522,
        "sender_full_name": "Fabrice Desré",
        "timestamp": 1639781969
    },
    {
        "content": "<p>Nevermind, I figured it out thanks to the discussion in <a href=\"https://github.com/bytecodealliance/wit-bindgen/issues/59\">https://github.com/bytecodealliance/wit-bindgen/issues/59</a> : using <code>wit_bindgen_rust::export!(...)</code> instead of manually importing the Rust generated code does the trick!</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wit-bindgen/issues/59\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/874613bd9fd025f6811d971f675d3222a8ac4ef5\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333763333632626530383063623836373735376234633764633038626334343763306461663333376465646264363339333361373465393731366631326238632f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f3539)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wit-bindgen/issues/59\" title=\"Using linked module from the Wasmtime generated code results in missing `canonical_abi_free` export · Issue #59 · bytecodealliance/wit-bindgen\">Using linked module from the Wasmtime generated code results in missing `canonical_abi_free` export · Issue #59 · bytecodealliance/wit-bindgen</a></div><div class=\"message_embed_description\">The use case is the following: I am using the generated export Wasmtime bindings to execute a specific function through Wasmtime. This works fine for modules that have not been linked, but fails fo...</div></div></div>",
        "id": 265375738,
        "sender_full_name": "Fabrice Desré",
        "timestamp": 1639783608
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"465306\">Fabrice Desré</span> has marked this topic as resolved.</p>",
        "id": 265428878,
        "sender_full_name": "Notification Bot",
        "timestamp": 1639847328
    }
]