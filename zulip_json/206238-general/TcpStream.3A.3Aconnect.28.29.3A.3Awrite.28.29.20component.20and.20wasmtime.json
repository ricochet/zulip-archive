[
    {
        "content": "<p>I get PermissionDenied when trying to wasmtime run a component built with Rust. It doesn't have any dependencies.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">     </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">std</span><span class=\"p\">::</span><span class=\"n\">io</span><span class=\"p\">::</span><span class=\"n\">Write</span><span class=\"p\">;</span>\n<span class=\"w\">     </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">std</span><span class=\"p\">::</span><span class=\"n\">net</span><span class=\"p\">::</span><span class=\"n\">TcpStream</span><span class=\"p\">;</span>\n\n<span class=\"w\">     </span><span class=\"k\">fn</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">         </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">TcpStream</span><span class=\"p\">::</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"s\">\"127.0.0.1:8080\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">().</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s\">\"what up\"</span><span class=\"p\">.</span><span class=\"n\">as_bytes</span><span class=\"p\">());</span>\n<span class=\"w\">     </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>Not clear whether it's a sandbox security privilege issue and I'm missing a config to let the component use network features when hosted by wasmtime or if the component being built is bad. The Rust equivalent connects to a local TCP socket just fine.</p>\n<p>Stack trace starts with <code>wit-component:adapter:wasi_snapshot_preview1!wasi:cli/run@0.2.0#run</code></p>\n<p><code>cargo build --target wasm32-wasip2</code></p>\n<p>I thought this was the simplest recreation of a wasi p2 feature I could attempt so I must be missing a step. Components without the TcpStream run just fine.</p>",
        "id": 490566098,
        "sender_full_name": "adam",
        "timestamp": 1734979801
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"703445\">@adam</span> what does the command (or code?) that you're using to run the component look like?</p>",
        "id": 490629014,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1735014323
    },
    {
        "content": "<p>If you're using <code>wasmtime run</code>, are you enabling the right WASI options? </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">help</span>\n<span class=\"n\">Available</span><span class=\"w\"> </span><span class=\"n\">wasi</span><span class=\"w\"> </span><span class=\"n\">options</span><span class=\"p\">:</span>\n\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                            </span><span class=\"n\">cli</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">CLI</span><span class=\"w\"> </span><span class=\"n\">APIs</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">including</span><span class=\"w\"> </span><span class=\"n\">filesystems</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sockets</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">clocks</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">random</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">             </span><span class=\"n\">cli</span><span class=\"o\">-</span><span class=\"n\">exit</span><span class=\"o\">-</span><span class=\"n\">with</span><span class=\"o\">-</span><span class=\"n\">code</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">APIs</span><span class=\"w\"> </span><span class=\"n\">marked</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">@</span><span class=\"n\">unstable</span><span class=\"p\">(</span><span class=\"n\">feature</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">cli</span><span class=\"o\">-</span><span class=\"n\">exit</span><span class=\"o\">-</span><span class=\"n\">with</span><span class=\"o\">-</span><span class=\"n\">code</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                         </span><span class=\"n\">common</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Deprecated</span><span class=\"w\"> </span><span class=\"n\">alias</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">cli</span><span class=\"err\">`</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                             </span><span class=\"n\">nn</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">neural</span><span class=\"w\"> </span><span class=\"n\">network</span><span class=\"w\"> </span><span class=\"n\">API</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">experimental</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                        </span><span class=\"n\">threads</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">threading</span><span class=\"w\"> </span><span class=\"n\">API</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">experimental</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                           </span><span class=\"n\">http</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">HTTP</span><span class=\"w\"> </span><span class=\"n\">API</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">experimental</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                         </span><span class=\"n\">config</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"n\">API</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">experimental</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                       </span><span class=\"n\">keyvalue</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">key</span><span class=\"o\">-</span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">API</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">experimental</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                       </span><span class=\"n\">listenfd</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Inherit</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">variables</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">descriptors</span><span class=\"w\"> </span><span class=\"n\">following</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">systemd</span><span class=\"w\"> </span><span class=\"n\">listen</span><span class=\"w\"> </span><span class=\"n\">fd</span><span class=\"w\"> </span><span class=\"n\">specification</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">UNIX</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                        </span><span class=\"n\">tcplisten</span><span class=\"o\">=</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Grant</span><span class=\"w\"> </span><span class=\"n\">access</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">given</span><span class=\"w\"> </span><span class=\"n\">TCP</span><span class=\"w\"> </span><span class=\"n\">listen</span><span class=\"w\"> </span><span class=\"n\">socket</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                       </span><span class=\"n\">preview2</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Implement</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">CLI</span><span class=\"w\"> </span><span class=\"n\">APIs</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">preview2</span><span class=\"w\"> </span><span class=\"n\">primitives</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">experimental</span><span class=\"p\">).</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">             </span><span class=\"n\">nn</span><span class=\"o\">-</span><span class=\"n\">graph</span><span class=\"o\">=&lt;</span><span class=\"n\">format</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"n\">dir</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Pre</span><span class=\"o\">-</span><span class=\"n\">load</span><span class=\"w\"> </span><span class=\"n\">machine</span><span class=\"w\"> </span><span class=\"n\">learning</span><span class=\"w\"> </span><span class=\"n\">graphs</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">.</span><span class=\"n\">e</span><span class=\"p\">.,</span><span class=\"w\"> </span><span class=\"n\">models</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">nn</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                </span><span class=\"n\">inherit</span><span class=\"o\">-</span><span class=\"n\">network</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Flag</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">preview2</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">inherit</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">host</span><span class=\"o\">'</span><span class=\"na\">s</span><span class=\"w\"> </span><span class=\"n\">network</span><span class=\"w\"> </span><span class=\"n\">within</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">guest</span><span class=\"w\"> </span><span class=\"n\">so</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">full</span><span class=\"w\"> </span><span class=\"n\">access</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">addresses</span><span class=\"o\">/</span><span class=\"n\">ports</span><span class=\"o\">/</span><span class=\"n\">etc</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">           </span><span class=\"n\">allow</span><span class=\"o\">-</span><span class=\"n\">ip</span><span class=\"o\">-</span><span class=\"n\">name</span><span class=\"o\">-</span><span class=\"n\">lookup</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Indicates</span><span class=\"w\"> </span><span class=\"n\">whether</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">sockets</span><span class=\"o\">/</span><span class=\"n\">ip</span><span class=\"o\">-</span><span class=\"n\">name</span><span class=\"o\">-</span><span class=\"n\">lookup</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">enabled</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                            </span><span class=\"n\">tcp</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Indicates</span><span class=\"w\"> </span><span class=\"n\">whether</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">sockets</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">TCP</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">enabled</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                            </span><span class=\"n\">udp</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Indicates</span><span class=\"w\"> </span><span class=\"n\">whether</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">sockets</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">UDP</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">enabled</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">             </span><span class=\"n\">network</span><span class=\"o\">-</span><span class=\"n\">error</span><span class=\"o\">-</span><span class=\"n\">code</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Enable</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">APIs</span><span class=\"w\"> </span><span class=\"n\">marked</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">@</span><span class=\"n\">unstable</span><span class=\"p\">(</span><span class=\"n\">feature</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">network</span><span class=\"o\">-</span><span class=\"n\">error</span><span class=\"o\">-</span><span class=\"n\">code</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                       </span><span class=\"n\">preview0</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Allows</span><span class=\"w\"> </span><span class=\"n\">imports</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi_unstable</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">                    </span><span class=\"n\">inherit</span><span class=\"o\">-</span><span class=\"n\">env</span><span class=\"p\">[</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"o\">|</span><span class=\"n\">n</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Inherit</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">variables</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">parent</span><span class=\"w\"> </span><span class=\"n\">process</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\">              </span><span class=\"n\">config</span><span class=\"o\">-</span><span class=\"n\">var</span><span class=\"o\">=&lt;</span><span class=\"n\">name</span><span class=\"o\">&gt;=&lt;</span><span class=\"n\">val</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Pass</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">wasi</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">program</span><span class=\"p\">.</span>\n<span class=\"w\">  </span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">keyvalue</span><span class=\"o\">-</span><span class=\"k\">in</span><span class=\"o\">-</span><span class=\"n\">memory</span><span class=\"o\">-</span><span class=\"n\">data</span><span class=\"o\">=&lt;</span><span class=\"n\">name</span><span class=\"o\">&gt;=&lt;</span><span class=\"n\">val</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">Preset</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">In</span><span class=\"o\">-</span><span class=\"n\">Memory</span><span class=\"w\"> </span><span class=\"n\">provider</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">WASI</span><span class=\"w\"> </span><span class=\"n\">key</span><span class=\"o\">-</span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">API</span><span class=\"p\">.</span>\n\n<span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"o\">-</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">help</span><span class=\"o\">-</span><span class=\"n\">long</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">see</span><span class=\"w\"> </span><span class=\"n\">longer</span><span class=\"o\">-</span><span class=\"n\">form</span><span class=\"w\"> </span><span class=\"n\">explanations</span>\n</code></pre></div>",
        "id": 490629108,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1735014403
    },
    {
        "content": "<p>(and if you're doing this with code, then you'll need to customize the runtime similarly)</p>",
        "id": 490629668,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1735014772
    },
    {
        "content": "<p>Here's an example repo with your example working:</p>\n<p><a href=\"https://github.com/vados-cosmonic/wasmtime-rust-wasi-run-tcp-example\">https://github.com/vados-cosmonic/wasmtime-rust-wasi-run-tcp-example</a></p>\n<p>(note that I use <code>.cargo/config.toml</code> to configure the <code>runner</code> so that <code>cargo run</code> works -- when running from CLI obviously you'd have to do that yourself)</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/vados-cosmonic/wasmtime-rust-wasi-run-tcp-example\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/7ccc14abb5a6700cf0dd680119510c8d79b98dd3/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f626266363564646262366464616531623266393631623039316231336635656361626437646532376165393263653032393632616633306462326563313030392f7661646f732d636f736d6f6e69632f7761736d74696d652d727573742d776173692d72756e2d7463702d6578616d706c65&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/vados-cosmonic/wasmtime-rust-wasi-run-tcp-example\" title=\"GitHub - vados-cosmonic/wasmtime-rust-wasi-run-tcp-example: Example of building a wasi:cli/run-able WebAssembly component using TCP\">GitHub - vados-cosmonic/wasmtime-rust-wasi-run-tcp-example: Example of building a wasi:cli/run-able WebAssembly component using TCP</a></div><div class=\"message_embed_description\">Example of building a wasi:cli/run-able WebAssembly component using TCP - vados-cosmonic/wasmtime-rust-wasi-run-tcp-example</div></div></div>",
        "id": 490630309,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1735015369
    }
]