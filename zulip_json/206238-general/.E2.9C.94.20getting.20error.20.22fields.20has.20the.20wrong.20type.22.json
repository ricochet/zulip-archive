[
    {
        "content": "<p>I am trying to run a cli component using wasmtime, which has following wit file:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">:</span><span class=\"nc\">bar</span><span class=\"o\">@</span><span class=\"mf\">0.1.0</span><span class=\"p\">;</span>\n\n<span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">cli</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">include</span><span class=\"w\"> </span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">cli</span><span class=\"o\">/</span><span class=\"n\">imports</span><span class=\"o\">@</span><span class=\"mf\">0.2.0</span><span class=\"p\">;</span>\n<span class=\"w\">  </span><span class=\"n\">import</span><span class=\"w\"> </span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">http</span><span class=\"o\">/</span><span class=\"n\">outgoing</span><span class=\"o\">-</span><span class=\"n\">handler</span><span class=\"o\">@</span><span class=\"mf\">0.2.0</span><span class=\"p\">;</span>\n<span class=\"w\">  </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">cli</span><span class=\"o\">/</span><span class=\"n\">run</span><span class=\"o\">@</span><span class=\"mf\">0.2.0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>and a simple main function that makes an outbound request (I am using tinygo for it). </p>\n<p>When I run it, I get following error:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">main</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">component</span><span class=\"w\"> </span><span class=\"n\">imports</span><span class=\"w\"> </span><span class=\"n\">instance</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi</span><span class=\"p\">:</span><span class=\"nc\">http</span><span class=\"o\">/</span><span class=\"n\">types</span><span class=\"o\">@</span><span class=\"mf\">0.2.0</span><span class=\"err\">`</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">matching</span><span class=\"w\"> </span><span class=\"n\">implementation</span><span class=\"w\"> </span><span class=\"n\">was</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">linker</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">instance</span><span class=\"w\"> </span><span class=\"n\">export</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">fields</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">wrong</span><span class=\"w\"> </span><span class=\"k\">type</span>\n<span class=\"w\">    </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">resource</span><span class=\"w\"> </span><span class=\"n\">implementation</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">missing</span>\n</code></pre></div>\n<p>Any pointers on what I might be missing here. </p>\n<p>Thanks</p>",
        "id": 449009317,
        "sender_full_name": "Rajat Jindal",
        "timestamp": 1720073329
    },
    {
        "content": "<p>I just tried this with rust and ran into same problem.</p>",
        "id": 449022029,
        "sender_full_name": "Rajat Jindal",
        "timestamp": 1720078734
    },
    {
        "content": "<p>i found a similar comment here: <a href=\"https://github.com/bytecodealliance/wasi-rs/issues/87#issuecomment-2099616901\">https://github.com/bytecodealliance/wasi-rs/issues/87#issuecomment-2099616901</a></p>\n<p>but i am trying to run a cli command that makes an outbound http request. </p>\n<p>I tried with <code>-Scli</code> and <code>-Shttp</code>, but none of them helped</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wasi-rs/issues/87#issuecomment-2099616901\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/7f1a2e006ae9445d3516de8d5b3b483b6a580fe1/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f653833333161303536626366633131333730346537326465633139653133303438303732643462373839346562373232633338623839656130313830383833632f62797465636f6465616c6c69616e63652f776173692d72732f6973737565732f3837&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wasi-rs/issues/87#issuecomment-2099616901\" title=\"module does not export a function named `cabi_realloc` 路 Issue #87 路 bytecodealliance/wasi-rs\">module does not export a function named `cabi_realloc` 路 Issue #87 路 bytecodealliance/wasi-rs</a></div><div class=\"message_embed_description\">Hi, I'm trying to build the examples here for the wasm32-wasip2 target. The cli-command example works fine, but the http-proxy example fails while linking with module does not export a function nam...</div></div></div>",
        "id": 449023918,
        "sender_full_name": "Rajat Jindal",
        "timestamp": 1720079077
    },
    {
        "content": "<p>nevermind, found the issue. I was running <code>wasmtime run main.wasm -Shttp</code> while I should have used <code>wasmtime run -Shttp main.wasm</code> </p>\n<p>The position of <code>-Shttp</code> mattered.</p>",
        "id": 449032853,
        "sender_full_name": "Rajat Jindal",
        "timestamp": 1720081775
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"646597\">Rajat Jindal</span> has marked this topic as resolved.</p>",
        "id": 449032915,
        "sender_full_name": "Notification Bot",
        "timestamp": 1720081793
    }
]