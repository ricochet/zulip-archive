[
    {
        "content": "<p>I am trying to use <code>preview2</code> of WASI and working on implementing <code>wasi-io::write(this: output-stream, buf: list&lt;u8&gt;) -&gt; result&lt;u64, stream-error&gt;</code>. <code>stream-error</code> is currently defined as <code>(record)</code> (see <a href=\"https://github.com/bytecodealliance/preview2-prototyping/blob/main/wit/wasi-io.wit.md\">here</a>, and as such <code>wit-bindgen</code> generates <code>struct StreamError {}</code>. However, it seems that the struct does not implement <code>Lower</code>, which means I cannot use it in <code>wasmtime::LinkerInstance::func_wrap()</code>. Am I doing something wrong or has that just not been implemented yet?</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"k\">trait</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasmtime</span>::<span class=\"n\">component</span>::<span class=\"n\">Lower</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">implemented</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">wasi_io</span>::<span class=\"n\">StreamError</span><span class=\"err\">`</span>\n</code></pre></div>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/preview2-prototyping/blob/main/wit/wasi-io.wit.md\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/3e02534907adfe141338b2b91709bf65cd279dd7\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f383864363433643832303063336638393232303837363231366361613961386262613534643536303237623838333135343337373964633864656163373738642f62797465636f6465616c6c69616e63652f70726576696577322d70726f746f747970696e67)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/preview2-prototyping/blob/main/wit/wasi-io.wit.md\" title=\"preview2-prototyping/wasi-io.wit.md at main · bytecodealliance/preview2-prototyping\">preview2-prototyping/wasi-io.wit.md at main · bytecodealliance/preview2-prototyping</a></div><div class=\"message_embed_description\">Polyfill adapter for preview1-using wasm modules to call preview2 functions. - preview2-prototyping/wasi-io.wit.md at main · bytecodealliance/preview2-prototyping</div></div></div>",
        "id": 339402535,
        "sender_full_name": "Surma",
        "timestamp": 1677864085
    },
    {
        "content": "<p>Oooh I just now realized that <code>Lower</code> is not _actually_ an empty trait. I guess I can just manually implement it for now (esp. for an empty struct)</p>",
        "id": 339404843,
        "sender_full_name": "Surma",
        "timestamp": 1677864706
    }
]