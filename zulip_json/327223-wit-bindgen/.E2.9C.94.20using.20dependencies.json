[
    {
        "content": "<p>I'm having trouble to use <code>generate!</code> for the following <code>wit</code> files.<br>\nReduced example:</p>\n<p>wit a</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">mynamespace</span>:<span class=\"nc\">a</span>\n\n<span class=\"n\">world</span><span class=\"w\"> </span><span class=\"n\">myworld</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\"> </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">mynamespace</span>:<span class=\"nc\">b</span><span class=\"o\">/</span><span class=\"n\">types</span><span class=\"p\">.{</span><span class=\"n\">my</span><span class=\"o\">-</span><span class=\"k\">type</span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>wit b</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">mynamespace</span>:<span class=\"nc\">b</span>\n\n<span class=\"n\">interface</span><span class=\"w\"> </span><span class=\"n\">types</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">record</span><span class=\"w\"> </span><span class=\"n\">my</span><span class=\"o\">-</span><span class=\"k\">type</span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">field</span>: <span class=\"nc\">string</span><span class=\"p\">,</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>They're both in the <code>wit</code> folder.</p>\n<p><code>generate!(\"myworld\")</code> macro errors with</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">       </span><span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n           <span class=\"nc\">package</span><span class=\"w\"> </span><span class=\"n\">identifier</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">mynamespace</span>:<span class=\"nc\">b</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">mynamespace</span>:<span class=\"nc\">a</span><span class=\"err\">`</span>\n<span class=\"w\">                </span><span class=\"o\">-</span>-&gt; <span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"w\">                 </span><span class=\"o\">|</span>\n<span class=\"w\">              </span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">mynamespace</span>:<span class=\"nc\">b</span>\n<span class=\"w\">                 </span><span class=\"o\">|</span><span class=\"w\">         </span><span class=\"o\">^------</span>\n</code></pre></div>\n<p>This is a pattern which I've also seen in wasi wit files depending on eachother. <br>\nWhat am I doing wrong here?</p>\n<p>Thanks <span aria-label=\"pray\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"pray\">:pray:</span></p>",
        "id": 372331876,
        "sender_full_name": "alisomay",
        "timestamp": 1688481315
    },
    {
        "content": "<p>The problem seems to be the package name.<br>\nIf I change <code>package mynamespace:b</code> to <code>package mynamespace:a</code> then it resolves.<br>\nOn the other hand that is the whole purpose.<br>\nHere I see that this scenario is documented as a valid test. I'm a bit confused.<br>\n<a href=\"https://github.com/bytecodealliance/wasm-tools/blob/main/crates/wit-parser/tests/ui/foreign-deps/root.wit\">https://github.com/bytecodealliance/wasm-tools/blob/main/crates/wit-parser/tests/ui/foreign-deps/root.wit</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wasm-tools/blob/main/crates/wit-parser/tests/ui/foreign-deps/root.wit\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/fc273a3e57261db1eae85ad433391a54120884f4\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323931326332383730363462366362653732393736666634353036386638353536303862613637393735386463373237323735323764656439316637633931612f62797465636f6465616c6c69616e63652f7761736d2d746f6f6c73)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wasm-tools/blob/main/crates/wit-parser/tests/ui/foreign-deps/root.wit\" title=\"wasm-tools/crates/wit-parser/tests/ui/foreign-deps/root.wit at main · bytecodealliance/wasm-tools\">wasm-tools/crates/wit-parser/tests/ui/foreign-deps/root.wit at main · bytecodealliance/wasm-tools</a></div><div class=\"message_embed_description\">Low level tooling for WebAssembly in Rust. Contribute to bytecodealliance/wasm-tools development by creating an account on GitHub.</div></div></div>",
        "id": 372350616,
        "sender_full_name": "alisomay",
        "timestamp": 1688484760
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"628731\">@alisomay</span> wit packages are supposed to be in separate folders, otherwise you can also just use separate files in the same folder and refer to the interface by the same name.</p>",
        "id": 372372704,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1688490123
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"553681\">Guy Bedford</span> <a href=\"#narrow/stream/327223-wit-bindgen/topic/using.20dependencies/near/372372704\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"628731\">alisomay</span> wit packages are supposed to be in separate folders, otherwise you can also just use separate files in the same folder and refer to the interface by the same name.</p>\n</blockquote>\n<p>Thank you!<br>\nThis is crucial information. I might have missed it in the documentation.<br>\nIt seems that also the folder should be named <code>deps</code>.<br>\nPlacing <code>a.wit</code> in the root and <code>b.wit</code> at  <code>deps/mynamespace/wit.b</code> yields a different error which is rather cryptic. </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">error</span>: <span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">parse</span><span class=\"w\"> </span><span class=\"n\">package</span>: <span class=\"o\">..</span>\n<span class=\"w\">       </span><span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n           <span class=\"nc\">no</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">package</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">header</span><span class=\"w\"> </span><span class=\"n\">was</span><span class=\"w\"> </span><span class=\"n\">found</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">any</span><span class=\"w\"> </span><span class=\"n\">WIT</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"w\"> </span><span class=\"n\">package</span>\n</code></pre></div>\n<p>I'd be grateful if you point me to the right place in a documentation which explains the necessary structure to achieve this.</p>",
        "id": 372378451,
        "sender_full_name": "alisomay",
        "timestamp": 1688491769
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"628731\">@alisomay</span> when having separate folders, you must include the <code>package mynamespace:a</code> declaration at the top of at least one wit file in the folder</p>",
        "id": 372378681,
        "sender_full_name": "Guy Bedford",
        "timestamp": 1688491822
    },
    {
        "content": "<p>Thank you. <br>\nI made it work with your suggestions.<br>\nI had also another issue since my real package name was annotated with a semver that also was creating an issue with the use statement.<br>\nWhat is a good way to import packages with semver annotations?</p>\n<p><code>use foo:bar@0.1.0/an-interface.{a-type}</code> does not work. (syntax error)</p>\n<p>If we use </p>\n<p><code>use foo:bar/an-interface.{a-type}</code><br>\nthen the package can not be found.</p>",
        "id": 372388289,
        "sender_full_name": "alisomay",
        "timestamp": 1688494714
    },
    {
        "content": "<p>I think there is info here<br>\n<a href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#top-level-use\">https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#top-level-use</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#top-level-use\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/0cf5d54e33d9bf408d2e5eb4c3a0d01df093eee2\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f343562343233326231653132393738356635623938363038303733346231663764333663346135336530613833306135623533323766656163393132653737632f576562417373656d626c792f636f6d706f6e656e742d6d6f64656c)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#top-level-use\" title=\"component-model/design/mvp/WIT.md at main · WebAssembly/component-model\">component-model/design/mvp/WIT.md at main · WebAssembly/component-model</a></div><div class=\"message_embed_description\">Repository for design and specification of the Component Model - component-model/design/mvp/WIT.md at main · WebAssembly/component-model</div></div></div>",
        "id": 372391476,
        "sender_full_name": "alisomay",
        "timestamp": 1688495788
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"628731\">alisomay</span> has marked this topic as resolved.</p>",
        "id": 372391703,
        "sender_full_name": "Notification Bot",
        "timestamp": 1688495863
    }
]