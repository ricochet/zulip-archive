[
    {
        "content": "<p>Hi there, we're considering depending on wit-bindgen at my project, and <a href=\"https://github.com/bytecodealliance/wit-bindgen\">https://github.com/bytecodealliance/wit-bindgen</a> suggested we reach out here first.</p>\n<p>We have what looks to be a very well known problem: I'd like to build a wasm binary from rust code, but it contains C++ dependencies (built with the wasi-sdk clang toolchain). wasm-bindgen is effectively not an option in this case (right?), so wit-bindgen appears to be the main alternative.</p>\n<p>And I love what I see with wit-bindgen, in fact I'd prefer its over wasm-bindgen, but it feels like it's in rapid development mode now and fairly <br>\nunstable (last release was v0.2.0 from August 2022).</p>\n<p>So I had a couple questions,</p>\n<p>1. v0.2.0 seems like it's not emitting any bindings for <code>resource</code> methods, is that feature known to be missing in v0.2.0?<br>\n  2. Having support for callbacks in the interface is important for us, but I don't see that mentioned in <a href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md\">the spec</a>, am I missing something or is it just not spec'd yet?<br>\n  3. Are there any known stable commits more recent than v0.2.0 I could use?<br>\n  4. If wit-bindgen doesn't make sense for me, does anyone have any suggestions for building rust+c wasm packages?</p>\n<p>Thanks!</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wit-bindgen\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/febe7b8698833592a207ed55322ae53406a110ba\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f626431333761376435613862313537643332623366643632373637326338373134626339643032376535313438333633616166663531333264353463613662642f62797465636f6465616c6c69616e63652f7769742d62696e6467656e)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wit-bindgen\" title=\"GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types\">GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types</a></div><div class=\"message_embed_description\">A language binding generator for WebAssembly interface types - GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types</div></div></div><div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/a7c1806b5da01c059958c2117d209059fa667619\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f363932343666656632366665613430633266393762356238343931633233363735623332373132613332663039633632363132633137383464376364653764392f576562417373656d626c792f636f6d706f6e656e742d6d6f64656c)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md\" title=\"component-model/WIT.md at main · WebAssembly/component-model\">component-model/WIT.md at main · WebAssembly/component-model</a></div><div class=\"message_embed_description\">Repository for design and specification of the Component Model - component-model/WIT.md at main · WebAssembly/component-model</div></div></div>",
        "id": 323917731,
        "sender_full_name": "Andrew Top",
        "timestamp": 1674770593
    },
    {
        "content": "<p>The tests are failing while running <em>cargo test --workspace</em> (commit <a href=\"https://github.com/bytecodealliance/wit-bindgen/tree/98c2b1e4cb10d3757114b7524d112511a4c7459e\">https://github.com/bytecodealliance/wit-bindgen/tree/98c2b1e4cb10d3757114b7524d112511a4c7459e</a>) in the devcontainer. Any idea?</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wit-bindgen/tree/98c2b1e4cb10d3757114b7524d112511a4c7459e\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/febe7b8698833592a207ed55322ae53406a110ba\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f626431333761376435613862313537643332623366643632373637326338373134626339643032376535313438333633616166663531333264353463613662642f62797465636f6465616c6c69616e63652f7769742d62696e6467656e)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wit-bindgen/tree/98c2b1e4cb10d3757114b7524d112511a4c7459e\" title=\"GitHub - bytecodealliance/wit-bindgen at 98c2b1e4cb10d3757114b7524d112511a4c7459e\">GitHub - bytecodealliance/wit-bindgen at 98c2b1e4cb10d3757114b7524d112511a4c7459e</a></div><div class=\"message_embed_description\">A language binding generator for WebAssembly interface types - GitHub - bytecodealliance/wit-bindgen at 98c2b1e4cb10d3757114b7524d112511a4c7459e</div></div></div>",
        "id": 323921092,
        "sender_full_name": "Toni Bofarull",
        "timestamp": 1674771924
    },
    {
        "content": "<ol>\n<li>For your first question, yes. I believe the team is working on bringing <code>resource</code> back to wit. </li>\n<li>The callbacks are not in the spec of wit. This issue might be relevent <a href=\"https://github.com/bytecodealliance/wit-bindgen/issues/268\">https://github.com/bytecodealliance/wit-bindgen/issues/268</a>. </li>\n<li>I am not aware of any stable commits after v0.2.0. wit-bindgen is undergoing a huge change to adapt to the wasm component model.</li>\n</ol>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/wit-bindgen/issues/268\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/249af087c74f516a73012920f4bd33435ec9f516\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f373461376638326631663163656138393166343330653935363535353031303866646639376666356235633538623164313963396661663766343939306332392f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f323638)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/wit-bindgen/issues/268\" title=\"Design discussion: host with access to `&amp;mut T` in `Store&lt;T&gt;` · Issue #268 · bytecodealliance/wit-bindgen\">Design discussion: host with access to `&amp;mut T` in `Store&lt;T&gt;` · Issue #268 · bytecodealliance/wit-bindgen</a></div><div class=\"message_embed_description\">This is a follow-up question regarding why wit-bindgen does not generate host trait with access to Store&lt;T&gt;. @alexcrichton explained in a Zulip chat: the wit-bindgen-generated bindings don&amp;#3...</div></div></div>",
        "id": 323948418,
        "sender_full_name": "Mossaka (Joe)",
        "timestamp": 1674787748
    },
    {
        "content": "<p>Thanks!</p>\n<p>It sounds like it's going to be a bit of a rollercoaster ride while the wasm component model changes are happening, so I'll leave trunk alone.</p>\n<p>Maybe I can make v0.2 work for me. Feels like this is almost the only option for creating wasm bindings for Rust when it's compiled under <code>wasm32-wasi</code>.</p>",
        "id": 324129531,
        "sender_full_name": "Andrew Top",
        "timestamp": 1674845087
    },
    {
        "content": "<p>You can take a look at <a href=\"https://github.com/fermyon/wit-bindgen-backport\">https://github.com/fermyon/wit-bindgen-backport</a> as an example of backporting dependency updates to v0.2. That repo in particular has no stability guarantees though so you may want to fork it if its useful to you.</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/fermyon/wit-bindgen-backport\" style=\"background-image: url(https\\:\\/\\/uploads\\.zulipusercontent\\.net\\/d32d66be22c5935ee334e994c26fd7b617531b45\\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663935396331313336333239383862343561646563653964353265356332336662633564303533356334363336353563336561356333343334653865346330662f6665726d796f6e2f7769742d62696e6467656e2d6261636b706f7274)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/fermyon/wit-bindgen-backport\" title=\"GitHub - fermyon/wit-bindgen-backport: A language binding generator for WebAssembly interface types\">GitHub - fermyon/wit-bindgen-backport: A language binding generator for WebAssembly interface types</a></div><div class=\"message_embed_description\">A language binding generator for WebAssembly interface types - GitHub - fermyon/wit-bindgen-backport: A language binding generator for WebAssembly interface types</div></div></div>",
        "id": 324131848,
        "sender_full_name": "Lann Martin",
        "timestamp": 1674845814
    },
    {
        "content": "<p>Ahh, thanks, good to know.</p>\n<p>Is there a list of projects that are depending on wit-bindgen (either v0.2 or otherwise) that I might use as reference?</p>",
        "id": 324141980,
        "sender_full_name": "Andrew Top",
        "timestamp": 1674849211
    },
    {
        "content": "<p>Not that I'm aware of. Sourcegraph or github search are probably your best bet for that.</p>",
        "id": 324142346,
        "sender_full_name": "Lann Martin",
        "timestamp": 1674849355
    }
]