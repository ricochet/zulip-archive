<html>
<head><meta charset="utf-8"><title>✔ Binary format is unknown error when compiling Cranelift IR · cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/index.html">cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html">✔ Binary format is unknown error when compiling Cranelift IR</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="423338764"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423338764" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Wei <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423338764">(Feb 26 2024 at 07:47)</a>:</h4>
<p>Hello! I'm building my toy compiler with Cranelift as my backend.<br>
I'm getting binary format unknown error with the following command (tried this command on both Linux and MacOS):</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">clif</span><span class="o">-</span><span class="n">util</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="o">--</span><span class="n">target</span><span class="w"> </span><span class="n">x86_64</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">test</span><span class="p">.</span><span class="n">o</span><span class="w"> </span><span class="n">filetests</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="n">clif</span>
<span class="n">Error</span>: <span class="nc">Backend</span><span class="w"> </span><span class="n">error</span>: <span class="nc">binary</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unknown</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="nc">binary</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unknown</span>
</code></pre></div>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// main.clif</span>
<span class="n">test</span><span class="w"> </span><span class="n">run</span>
<span class="n">target</span><span class="w"> </span><span class="n">x86_64</span>

<span class="n">function</span><span class="w"> </span><span class="o">%</span><span class="n">main</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span>
<span class="n">block0</span>:
    <span class="nc">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i32</span><span class="w"> </span><span class="mi">42</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">v0</span>
<span class="p">}</span>
<span class="p">;</span><span class="w"> </span><span class="n">print</span>: <span class="o">%</span><span class="n">main</span><span class="p">()</span>
<span class="p">;</span><span class="w"> </span><span class="n">run</span>: <span class="o">%</span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span>
</code></pre></div>
<p>Can anyone give me some hints for this issue? Both <code>clif-util test</code> and <code>clif-util run</code> can execute perfectly.<br>
Right now, I'm thinking to compile Cranelift IR into object file, and then link it with dynamic library with gcc, so that I can get an executable.  Or maybe there are alternatives to achieve this goal? Thanks in advanced!</p>



<a name="423339306"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423339306" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423339306">(Feb 26 2024 at 07:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="689928">Lee Wei</span> has marked this topic as resolved.</p>



<a name="423339313"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423339313" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423339313">(Feb 26 2024 at 07:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="689928">Lee Wei</span> has marked this topic as unresolved.</p>



<a name="423374409"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423374409" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423374409">(Feb 26 2024 at 11:17)</a>:</h4>
<p>You need to specify the full target I think rather than just the architecture. Otherwise it wouldn't know if the correct object file format to use should be ELF, Mach-O or COFF. Try <code>clif-util compile --target x86_64-apple-darwin -o test.o filetests/main.clif</code> if you want a Mach-O object file.</p>



<a name="423374464"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423374464" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423374464">(Feb 26 2024 at 11:17)</a>:</h4>
<p>On linux you did use <code>x86_64-unknown-linux-gnu</code> as target.</p>



<a name="423374669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423374669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423374669">(Feb 26 2024 at 11:19)</a>:</h4>
<p><span class="user-mention" data-user-id="689928">@Lee Wei</span></p>



<a name="423386709"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423386709" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lee Wei <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423386709">(Feb 26 2024 at 12:37)</a>:</h4>
<p><span class="user-mention" data-user-id="264278">@bjorn3</span> Thanks! It worked!</p>



<a name="423386724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/%E2%9C%94%20Binary%20format%20is%20unknown%20error%20when%20compiling%20Cranelift%20IR/near/423386724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/.E2.9C.94.20Binary.20format.20is.20unknown.20error.20when.20compiling.20Cranelift.20IR.html#423386724">(Feb 26 2024 at 12:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="689928">Lee Wei</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>