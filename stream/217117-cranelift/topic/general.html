<html>
<head><meta charset="utf-8"><title>general · cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/index.html">cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html">general</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="188737505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188737505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188737505">(Feb 21 2020 at 14:47)</a>:</h4>
<p>Starting a new topic for general chatting, as a possible starting point for beginners and newcomers in the Cranelift stream, and so we can get a link to it and put it in README etc.</p>



<a name="188776516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188776516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188776516">(Feb 21 2020 at 21:29)</a>:</h4>
<p>Has anyone successfully cross-compiled wasmtime / Cranelift with <code>cargo --target ...</code>? I'm trying to build an aarch64 binary and run it with qemu-aarch64, to avoid slow CPU on my physical aarch64 machine (RPi4). I'm running into an issue where some part of the build system is invoking native (x86) <code>cc</code>. I've never cross-compiled with the Cargo toolchain in general and I'm curious if this is supposed to be supported...</p>



<a name="188776769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188776769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188776769">(Feb 21 2020 at 21:32)</a>:</h4>
<p>What crate invokes cc?</p>



<a name="188776823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188776823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188776823">(Feb 21 2020 at 21:33)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="253994">@Alex Crichton</span>: see cross compilation question above ^</p>



<a name="188776931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188776931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188776931">(Feb 21 2020 at 21:34)</a>:</h4>
<p><span class="user-mention" data-user-id="254389">@Chris Fallin</span> in theory it should work just fine with the right configuration, but compiling for aarch64 won't succeed for wasmtime at least because it has x86/x86_64-specific things and will liekly fail to link/resolve/etc</p>



<a name="188776950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188776950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188776950">(Feb 21 2020 at 21:35)</a>:</h4>
<p>cranelift however should be comipleable to aarch64 (I think?), but can you gist the error you're seeing?</p>



<a name="188777277"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188777277" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188777277">(Feb 21 2020 at 21:39)</a>:</h4>
<p>Ah, I just discovered I needed some config in <code>~/.cargo/config</code> (as per <a href="https://github.com/japaric/rust-cross" target="_blank" title="https://github.com/japaric/rust-cross">japaric/rust-cross</a>), namely</p>
<div class="codehilite"><pre><span></span>[target.aarch64-unknown-linux-gnu]
linker = &quot;aarch64-linux-gnu-gcc&quot;
</pre></div>


<p>I'm now just seeing a missing symbol <code>__chkstk</code> in <code>wasmtime_jit::link::link_module</code>, which I suppose is some of the platform-specific glue you mentioned. How difficult do you think it would be to stub things out? (I just want to get far enough to try a "hello world" and shake out all my <code>unimplemented!()</code>'s in my new arm64 backend...)</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/japaric/rust-cross" style="background-image: url(https://avatars2.githubusercontent.com/u/5018213?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/japaric/rust-cross" target="_blank" title="japaric/rust-cross">japaric/rust-cross</a></div><div class="message_embed_description">Everything you need to know about cross compiling Rust programs! - japaric/rust-cross</div></div></div>



<a name="188777533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188777533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188777533">(Feb 21 2020 at 21:43)</a>:</h4>
<p><span class="user-mention" data-user-id="254389">@Chris Fallin</span> to get things working at all you can use stubs like in <a href="https://github.com/bytecodealliance/wasmtime/pull/943" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/943">https://github.com/bytecodealliance/wasmtime/pull/943</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/943" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/943" target="_blank" title="Fix compilation for armv7 by pepyakin · Pull Request #943 · bytecodealliance/wasmtime">Fix compilation for armv7 by pepyakin · Pull Request #943 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Provide a dummy symbol for PROBESTACK to make wasmtime compile on armv7.</div></div></div>



<a name="188777541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188777541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188777541">(Feb 21 2020 at 21:43)</a>:</h4>
<p>which will likely merge soon anyway</p>



<a name="188777561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188777561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188777561">(Feb 21 2020 at 21:43)</a>:</h4>
<p>and yeah there you need to configure the linker for cargo to pass to rustc to use</p>



<a name="188777637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/188777637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#188777637">(Feb 21 2020 at 21:44)</a>:</h4>
<p>Excellent, will take a look -- thanks very much!</p>



<a name="189137532"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137532" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137532">(Feb 26 2020 at 17:39)</a>:</h4>
<p>is "v0 -&gt; v1" a regmove? I can't find where that syntax is printed</p>



<a name="189137546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137546">(Feb 26 2020 at 17:39)</a>:</h4>
<p>hard to search for -&gt; in rust code :P</p>



<a name="189137599"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137599" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137599">(Feb 26 2020 at 17:39)</a>:</h4>
<p>its what happens when <code>v0</code> becomes an alias for <code>v1</code></p>



<a name="189137699"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137699" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137699">(Feb 26 2020 at 17:40)</a>:</h4>
<p>I see, I guess those are skipped when iterating over insts in a block?</p>



<a name="189137726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137726">(Feb 26 2020 at 17:40)</a>:</h4>
<p>With <code>for inst in f.layout.block_insts(bb) {</code></p>



<a name="189137918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137918">(Feb 26 2020 at 17:42)</a>:</h4>
<p>or maybe there is something which replaces the aliases with the actual value</p>



<a name="189137923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137923">(Feb 26 2020 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> Right. They're not instructions, they're just aliases.</p>



<a name="189137998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189137998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189137998">(Feb 26 2020 at 17:43)</a>:</h4>
<p>see <a href="https://docs.rs/cranelift-codegen/0.59.0/cranelift_codegen/ir/dfg/struct.DataFlowGraph.html#method.change_to_alias" target="_blank" title="https://docs.rs/cranelift-codegen/0.59.0/cranelift_codegen/ir/dfg/struct.DataFlowGraph.html#method.change_to_alias">https://docs.rs/cranelift-codegen/0.59.0/cranelift_codegen/ir/dfg/struct.DataFlowGraph.html#method.change_to_alias</a> and related methods</p>



<a name="189138124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189138124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189138124">(Feb 26 2020 at 17:44)</a>:</h4>
<p>is there a reason they need to stay around, rather than the instructions being updated?</p>



<a name="189138207"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189138207" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189138207">(Feb 26 2020 at 17:45)</a>:</h4>
<p>I think the main reason is that this design avoids the need for def-to-use linkage -- otherwise one needs to find all uses to do the rewrite.</p>



<a name="189138309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189138309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189138309">(Feb 26 2020 at 17:46)</a>:</h4>
<p>ah good point. <span class="user-mention" data-user-id="254389">@Chris Fallin</span> I think some of the new backend code is wrong then, because it is not following the aliases</p>



<a name="189138406"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189138406" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189138406">(Feb 26 2020 at 17:47)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> I see, details welcome if you've found a bug :-)</p>



<a name="189138489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189138489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189138489">(Feb 26 2020 at 17:48)</a>:</h4>
<p>You can call <code>DataFlowGraph::resolve_aliases</code> on a value if you want to look through aliases</p>



<a name="189138663"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189138663" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189138663">(Feb 26 2020 at 17:50)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> ah, I've found at least one case in <code>LowerCtx</code> where it doesn't resolve aliases. I'll audit for this, but specifics of what you ran into would be useful as well, thanks!</p>



<a name="189139185"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189139185" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189139185">(Feb 26 2020 at 17:55)</a>:</h4>
<p>The one I found was in the edge-blocks phi parts</p>



<a name="189139248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189139248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189139248">(Feb 26 2020 at 17:56)</a>:</h4>
<p><span class="user-mention" data-user-id="254389">@Chris Fallin</span> the best way to do this would be to replace all value_regs[] lookup with a function that calls <code>DataFlowGraph::resolve_aliases</code></p>



<a name="189139280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189139280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189139280">(Feb 26 2020 at 17:56)</a>:</h4>
<p>Yup, on it -- thanks for finding this!</p>



<a name="189204230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189204230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189204230">(Feb 27 2020 at 11:08)</a>:</h4>
<p><span class="user-mention" data-user-id="254389">@Chris Fallin</span> <code>DataFlowGraph::value_def()</code> already resolves aliases, so you did it eagerly in a few places, not a big deal though</p>



<a name="189302660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189302660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189302660">(Feb 28 2020 at 11:42)</a>:</h4>
<p>Does <code>clif-util wasm</code>translate the entire wasm module to CLIF and then compile it? Does it translate per-function or?<br>
edit: I think it's eager, I found <code>src/wasm.rs</code>.</p>



<a name="189328282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189328282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189328282">(Feb 28 2020 at 16:58)</a>:</h4>
<p><span class="user-mention" data-user-id="254083">@Dan Gohman</span> why are the aliases printed per block?</p>



<a name="189328447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189328447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189328447">(Feb 28 2020 at 17:00)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> The aliases don't have an inherent location, so they could go anywhere.</p>



<a name="189328517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189328517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189328517">(Feb 28 2020 at 17:01)</a>:</h4>
<p>Ok, that's what I expected. Just surprising to see them in random blocks</p>



<a name="189328530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189328530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189328530">(Feb 28 2020 at 17:01)</a>:</h4>
<p>It's not always at the top of a block, although that's common because the SSA algorithm oftgen emits aliases for block parameters.</p>



<a name="189328613"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189328613" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189328613">(Feb 28 2020 at 17:02)</a>:</h4>
<p>For aliases of instruction values, we print them immediately after the instructions whose values they're aliasing</p>



<a name="189328658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189328658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189328658">(Feb 28 2020 at 17:03)</a>:</h4>
<p>Ah I see that now. I was mostly seeing them at the start of the block, due to large numbers of block arguments</p>



<a name="189882223"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189882223" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189882223">(Mar 06 2020 at 11:15)</a>:</h4>
<p>Why does rust code compiled to wasm, have vmctx params in the clif?</p>



<a name="189882346"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189882346" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189882346">(Mar 06 2020 at 11:17)</a>:</h4>
<p>The <code>vmctx</code> is necessary to get for example the location of the heap</p>



<a name="189882369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189882369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189882369">(Mar 06 2020 at 11:17)</a>:</h4>
<p>Ah, for example wasmtime will setup something to pass there?</p>



<a name="189882415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189882415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189882415">(Mar 06 2020 at 11:18)</a>:</h4>
<p>Yes</p>



<a name="189883024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189883024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189883024">(Mar 06 2020 at 11:28)</a>:</h4>
<p>With <code>fn0 = u0:827 sig0</code>, is that u0:827 actually an entity reference to another function? I thought clif functions were insulated from all other functions</p>



<a name="189883247"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189883247" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189883247">(Mar 06 2020 at 11:32)</a>:</h4>
<p><code>u0:827</code> is a number that doesn't have any meaning during compilation. After compilation the user of cranelift-codegen (for example cranelift-module, or wasmtime) interprets it to determine what the target of a relocations is.</p>



<a name="189883298"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189883298" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189883298">(Mar 06 2020 at 11:33)</a>:</h4>
<p>Aha, so the user has to keep track of which functions CLIF functions are which numbers</p>



<a name="189883392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189883392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189883392">(Mar 06 2020 at 11:34)</a>:</h4>
<p>Yes, except when using cranelift-module, in which case cranelift-module does it for you.</p>



<a name="189920742"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/189920742" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#189920742">(Mar 06 2020 at 18:29)</a>:</h4>
<p>Can anyone online give me a quick review of a refactoring PR? No functionality changed... <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">https://github.com/bytecodealliance/wasmtime/pull/1246</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1246" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="Refactor SIMD implementation by abrown · Pull Request #1246 · bytecodealliance/wasmtime">Refactor SIMD implementation by abrown · Pull Request #1246 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Before adding the remaining SIMD instructions, I thought it would be good to clean up the current implementation. I have tried to be very careful to avoid any change to behavior when renaming/movin...</div></div></div>



<a name="195734444"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/195734444" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#195734444">(Apr 29 2020 at 16:15)</a>:</h4>
<p>Hello. Could someone review/merge my PRs (<a href="https://github.com/bytecodealliance/wasmtime/pull/1382" title="https://github.com/bytecodealliance/wasmtime/pull/1382">https://github.com/bytecodealliance/wasmtime/pull/1382</a>, <a href="https://github.com/bytecodealliance/wasmtime/pull/1534" title="https://github.com/bytecodealliance/wasmtime/pull/1534">https://github.com/bytecodealliance/wasmtime/pull/1534</a>, <a href="https://github.com/bytecodealliance/wasmtime/pull/1510" title="https://github.com/bytecodealliance/wasmtime/pull/1510">https://github.com/bytecodealliance/wasmtime/pull/1510</a>)?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1382" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1382" title="Support sealing blocks created by cranelift_frontend::Switch by teapotd · Pull Request #1382 · bytecodealliance/wasmtime">Support sealing blocks created by cranelift_frontend::Switch by teapotd · Pull Request #1382 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">This PR introduces a method to seal generated blocks during emit in cranelift_frontend::Switch. Fixes #1323.</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1534" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1534" title="[bugpoint] Remove block params by teapotd · Pull Request #1534 · bytecodealliance/wasmtime">[bugpoint] Remove block params by teapotd · Pull Request #1534 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">This PR adds a mutator for bugpoint that attempts to replace block params with constants. Fixes #1142.</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1510" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1510" title="Always check if struct-return parameter is needed by teapotd · Pull Request #1510 · bytecodealliance/wasmtime">Always check if struct-return parameter is needed by teapotd · Pull Request #1510 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Current implementation of legalize_signature for x86 ABI assumes struct-return parameters can be generated only for multi-return functions. This is incorrect: functions can become multi-return afte...</div></div></div>



<a name="195735020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/195735020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#195735020">(Apr 29 2020 at 16:19)</a>:</h4>
<p>I'll take a look at #1382</p>



<a name="198816881"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198816881" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198816881">(May 26 2020 at 20:24)</a>:</h4>
<p>What are valid values for <code>b8/16/32/64</code> types? According to <a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/docs/ir.md#boolean-types">Cranelift IR docs</a>, they are either all zeros or all ones, but when I tried <code>bconst.b8 true</code> I got <code>1</code>, not <code>0xFF</code>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/docs/ir.md#boolean-types" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/docs/ir.md#boolean-types" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="198819657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198819657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198819657">(May 26 2020 at 20:49)</a>:</h4>
<p>On the other hand, <code>bnot</code> for <code>b32</code> negates all bits and <code>icmp</code> for vector types yields masks filled with zeroes or ones on x86, as boolean vector type.</p>



<a name="198829945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198829945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198829945">(May 26 2020 at 22:35)</a>:</h4>
<blockquote>
<p>Several larger boolean types are also defined, primarily to be used as SIMD element types. They can be stored in memory, and are represented as either all zero bits or all one bits.</p>
</blockquote>



<a name="198829971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198829971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198829971">(May 26 2020 at 22:35)</a>:</h4>
<p>So, I read that as: the SIMD types do have a defined representation but the scalar types may not</p>



<a name="198830079"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198830079" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198830079">(May 26 2020 at 22:36)</a>:</h4>
<p>i.e. you have to use <code>bint</code> to get an integer value out of a <code>b8</code> but if you extracted a lane of a <code>b8x16</code> it would be either <code>0x00</code> or <code>0xff</code></p>



<a name="198830584"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198830584" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198830584">(May 26 2020 at 22:43)</a>:</h4>
<p>Hm, if you create a boolean vector with <code>vconst</code> it's using <code>0</code>/<code>1</code>: <a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/filetests/filetests/isa/x86/simd-vconst-rodata.clif#L13-L19">https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/filetests/filetests/isa/x86/simd-vconst-rodata.clif#L13-L19</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/filetests/filetests/isa/x86/simd-vconst-rodata.clif#L13-L19" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/filetests/filetests/isa/x86/simd-vconst-rodata.clif#L13-L19" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="198831066"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198831066" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198831066">(May 26 2020 at 22:49)</a>:</h4>
<p><span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span> then something is not right: perhaps the documentation should change or perhaps <code>vconst.BxN</code> should change... since I don't do a lot with the <code>BxN</code> types I haven't noticed any issues</p>



<a name="198831211"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198831211" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198831211">(May 26 2020 at 22:50)</a>:</h4>
<p>And, thinking about it more, it is the documentation that is correct: it should match the Wasm SIMD spec which says</p>
<blockquote>
<p>The comparison operations all compare two vectors lane-wise, and produce a mask vector with the same number of lanes as the input interpretation where the bits in each lane are 0 for false and all ones for true.</p>
</blockquote>



<a name="198831260"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198831260" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198831260">(May 26 2020 at 22:51)</a>:</h4>
<p><a href="https://github.com/WebAssembly/simd/blob/master/proposals/simd/SIMD.md#comparisons">https://github.com/WebAssembly/simd/blob/master/proposals/simd/SIMD.md#comparisons</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/simd/blob/master/proposals/simd/SIMD.md#comparisons" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/simd/blob/master/proposals/simd/SIMD.md#comparisons" title="WebAssembly/simd">WebAssembly/simd</a></div><div class="message_embed_description">Branch of the spec repo scoped to discussion of SIMD in WebAssembly  - WebAssembly/simd</div></div></div>



<a name="198831352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198831352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198831352">(May 26 2020 at 22:52)</a>:</h4>
<p>This should be a relatively simple fix but feel free to open an issue if it wasn't the main point of what you were getting at... your question was more about scalar types?</p>



<a name="198831898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198831898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198831898">(May 26 2020 at 22:57)</a>:</h4>
<p>No, I was interested in vector types, as I was looking into <a href="https://github.com/bytecodealliance/wasmtime/issues/1187">#1187</a>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/issues/1187" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/issues/1187" title="Improve bitselect codegen with knowledge of operand origin · Issue #1187 · bytecodealliance/wasmtime">Improve bitselect codegen with knowledge of operand origin · Issue #1187 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Feature As discussed in WebAssembly/simd#192, the Wasm SIMD bitselect instruction could be lowered to one of the x86 BLEND* family of instructions instead using 3-4 instructions. Benefit Potentiall...</div></div></div>



<a name="198832402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198832402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198832402">(May 26 2020 at 23:02)</a>:</h4>
<p>There's a <a href="https://docs.rs/cranelift-codegen/0.63.0/cranelift_codegen/ir/trait.InstBuilder.html#method.vselect"><code>vselect</code></a> instruction in Cranelift that currently has no encoding and it could be encoded as <code>blend</code> on x86. We could then use <code>vselect</code> instead of <code>bitselect</code> directly in wasm code translator or replace it in preopt.</p>



<a name="198832506"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198832506" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> teapotd <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198832506">(May 26 2020 at 23:04)</a>:</h4>
<p>I'll make fix for vconst</p>



<a name="198833076"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/198833076" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#198833076">(May 26 2020 at 23:11)</a>:</h4>
<p>Sounds good; just a heads up that at least PBLENDW should be coming soon-ish: <a href="https://github.com/bytecodealliance/wasmtime/pull/1765/commits/66216fc1f5f133ebffdba42bf075da6b5cc3c634">https://github.com/bytecodealliance/wasmtime/pull/1765/commits/66216fc1f5f133ebffdba42bf075da6b5cc3c634</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1765/commits/66216fc1f5f133ebffdba42bf075da6b5cc3c634" style="background-image: url(https://avatars0.githubusercontent.com/u/541880?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1765/commits/66216fc1f5f133ebffdba42bf075da6b5cc3c634" title="Implement fcvt_from_uint (i32x4 -&gt; f32x4) for x86 by abrown · Pull Request #1765 · bytecodealliance/wasmtime">Implement fcvt_from_uint (i32x4 -&gt; f32x4) for x86 by abrown · Pull Request #1765 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">This converts an i32x4 into an f32x4 with some rounding either by using an AVX512VL/F instruction--VCVTUDQ2PS--or a long sequence of SSE4.1 compatible instructions.
It is still a draft as it depend...</div></div></div>



<a name="203020973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203020973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203020973">(Jul 06 2020 at 17:58)</a>:</h4>
<p>does anyone know why cranelift got merged into wasmtime? Just curious really.</p>



<a name="203022046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203022046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203022046">(Jul 06 2020 at 18:07)</a>:</h4>
<p><span class="user-mention" data-user-id="295546">@Carlo Kok</span> I wrote a comment explaining the reasoning here: <a href="https://github.com/bytecodealliance/wasmtime/issues/1185#issuecomment-591050388">https://github.com/bytecodealliance/wasmtime/issues/1185#issuecomment-591050388</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/issues/1185#issuecomment-591050388" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/issues/1185#issuecomment-591050388" title="Tracking issue for merging the cranelift and wasmtime repositories · Issue #1185 · bytecodealliance/wasmtime">Tracking issue for merging the cranelift and wasmtime repositories · Issue #1185 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Discussed at yesterday&#39;s meeting I wanted to open an issue tracking progress for merging the wasmtime/cranelift repositories. I think there are three major work items that need to happen: Perfo...</div></div></div>



<a name="203022081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203022081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203022081">(Jul 06 2020 at 18:07)</a>:</h4>
<p>thanks! note that I wasn't complaining. Just curious</p>



<a name="203022217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203022217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203022217">(Jul 06 2020 at 18:08)</a>:</h4>
<p>good read. Thanks</p>



<a name="203023825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203023825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203023825">(Jul 06 2020 at 18:24)</a>:</h4>
<blockquote>
<p>note that I wasn't complaining. Just curious<br>
Understood, yes, but thank you for emphasizing it! <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>
</blockquote>



<a name="203024527"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203024527" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203024527">(Jul 06 2020 at 18:30)</a>:</h4>
<p>is there a list of supported triples ?</p>



<a name="203025271"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203025271" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203025271">(Jul 06 2020 at 18:37)</a>:</h4>
<p>So feature wise, things I currently use in LLVM that cranelift doesn't have yet: Exception handling, COMDAT; So I'd say cranelift already has a fairly impressive set of features.</p>



<a name="203027183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027183">(Jul 06 2020 at 18:55)</a>:</h4>
<p>x86_64 is the most complete target. aarch64 comes next. x86 is a little worse. risc-v and arm32 are just stubs.</p>



<a name="203027233"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027233" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027233">(Jul 06 2020 at 18:55)</a>:</h4>
<p>oh arm32 isn't done at all? IT's a bit hard to see from the codegen repo</p>



<a name="203027402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027402">(Jul 06 2020 at 18:57)</a>:</h4>
<p>yes, there are literally no instruction encodings: <a href="https://github.com/bytecodealliance/wasmtime/blob/c91a9313b532067bb53eea44a182bb0c5bd2ebf4/cranelift/codegen/meta/src/isa/arm32/mod.rs#L73-L77">https://github.com/bytecodealliance/wasmtime/blob/c91a9313b532067bb53eea44a182bb0c5bd2ebf4/cranelift/codegen/meta/src/isa/arm32/mod.rs#L73-L77</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/c91a9313b532067bb53eea44a182bb0c5bd2ebf4/cranelift/codegen/meta/src/isa/arm32/mod.rs#L73-L77" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/c91a9313b532067bb53eea44a182bb0c5bd2ebf4/cranelift/codegen/meta/src/isa/arm32/mod.rs#L73-L77" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="203027450"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027450" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027450">(Jul 06 2020 at 18:57)</a>:</h4>
<p>risc-v at least has some: <a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/codegen/meta/src/isa/riscv/encodings.rs">https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/codegen/meta/src/isa/riscv/encodings.rs</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/codegen/meta/src/isa/riscv/encodings.rs" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/codegen/meta/src/isa/riscv/encodings.rs" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="203027689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027689">(Jul 06 2020 at 18:59)</a>:</h4>
<blockquote>
<blockquote>
<p>So feature wise, things I currently use in LLVM that cranelift doesn't have yet: arm(32), Exception handling, COMDAT; So I'd say cranelift already has a fairly impressive set of features.</p>
</blockquote>
</blockquote>



<a name="203027692"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027692" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027692">(Jul 06 2020 at 18:59)</a>:</h4>
<p>updated :)</p>



<a name="203027810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027810">(Jul 06 2020 at 19:00)</a>:</h4>
<p>cranelift is currently transitioning to a new framework for backends. the aarch64 backend has been created using that new framework. the x86_64 backend is currently using the old framework. a new x86_64 backend is being developed, but it is still in a relatively early stage.</p>



<a name="203027944"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203027944" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203027944">(Jul 06 2020 at 19:01)</a>:</h4>
<p>dwarf unwinding support would be useful for <a href="https://github.com/bjorn3/rustc_codegen_cranelift/">https://github.com/bjorn3/rustc_codegen_cranelift/</a> too. there is already an issue for it: <a href="https://github.com/bytecodealliance/wasmtime/issues/1677">https://github.com/bytecodealliance/wasmtime/issues/1677</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bjorn3/rustc_codegen_cranelift/" style="background-image: url(https://avatars0.githubusercontent.com/u/17426603?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bjorn3/rustc_codegen_cranelift/" title="bjorn3/rustc_codegen_cranelift">bjorn3/rustc_codegen_cranelift</a></div><div class="message_embed_description">Cranelift based backend for rustc. Contribute to bjorn3/rustc_codegen_cranelift development by creating an account on GitHub.</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/issues/1677" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/issues/1677" title="Support cleanup during unwinding · Issue #1677 · bytecodealliance/wasmtime">Support cleanup during unwinding · Issue #1677 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Feature Currently the generated unwinding information only restores registers. This issue proposes to make it possible to also run cleanup actions like running destructors during unwinding. Benefit...</div></div></div>



<a name="203028019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203028019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203028019">(Jul 06 2020 at 19:02)</a>:</h4>
<p>I read that yes (new framework) but i do know x86-32 works too (old backend though)</p>



<a name="203028124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203028124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203028124">(Jul 06 2020 at 19:03)</a>:</h4>
<p>yeah. Just unwinding has some concerns though: win32 is vastly different than win64; and there's exception handling itself too</p>



<a name="203028289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203028289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203028289">(Jul 06 2020 at 19:04)</a>:</h4>
<p>Exception handling and unwinding isn't that different though. At least not on the targets I saw.</p>



<a name="203028299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203028299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203028299">(Jul 06 2020 at 19:05)</a>:</h4>
<p>Cranelift can already generate SEH and .eh_frame tables. They are just treated as not requiring any cleanup.</p>



<a name="203028448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203028448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203028448">(Jul 06 2020 at 19:06)</a>:</h4>
<p>ah cool</p>



<a name="203028539"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203028539" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203028539">(Jul 06 2020 at 19:07)</a>:</h4>
<p>Wasmtime uses them to unwind back to the caller when the wasm code traps or a called rust function panics.</p>



<a name="203029273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203029273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203029273">(Jul 06 2020 at 19:14)</a>:</h4>
<p>And this works with win32 seh too?</p>



<a name="203029291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203029291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203029291">(Jul 06 2020 at 19:14)</a>:</h4>
<p>That is impressive</p>



<a name="203029460"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203029460" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203029460">(Jul 06 2020 at 19:16)</a>:</h4>
<p>I don't know if it works on win32 SEH. As far as I know Wasmtime doesn't work on 32bit yet.</p>



<a name="203029484"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203029484" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203029484">(Jul 06 2020 at 19:16)</a>:</h4>
<p>Ah</p>



<a name="203255032"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203255032" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203255032">(Jul 08 2020 at 11:11)</a>:</h4>
<p>I want to  tackle COMDAT myself once it's supported in the object code</p>



<a name="203255054"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203255054" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203255054">(Jul 08 2020 at 11:11)</a>:</h4>
<p>would a feature reqeust for SEH and arm32 be welcome? so there's some place to track and gauge interest?</p>



<a name="203258652"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203258652" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203258652">(Jul 08 2020 at 11:57)</a>:</h4>
<p>hi! I think there's already an issue open for supporting arm32: <a href="https://github.com/bytecodealliance/wasmtime/issues/1173">https://github.com/bytecodealliance/wasmtime/issues/1173</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/issues/1173" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/issues/1173" title="arm32 support · Issue #1173 · bytecodealliance/wasmtime">arm32 support · Issue #1173 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">What is the feature or code improvement you would like to do in Cranelift? I would like to add ARM support by implementing ARM (not Thumb) encodings/recipes and abi. I am especially interested in a...</div></div></div>



<a name="203259180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/203259180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carlo Kok <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#203259180">(Jul 08 2020 at 12:04)</a>:</h4>
<p>thanx! Missed that one</p>



<a name="204555124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204555124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204555124">(Jul 21 2020 at 14:37)</a>:</h4>
<p>a boolean vector's elements are meant to be all 0 or all 1 right?</p>



<a name="204558586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204558586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204558586">(Jul 21 2020 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> they at least encode false or true (i.e., are not vectors of false/true):</p>
<div class="codehilite"><pre><span></span><code>/// Boolean types: `B1`, `B8`, `B16`, `B32`, `B64`, and `B128`. These all encode &#39;true&#39; or &#39;false&#39;. The
/// larger types use redundant bits.
</code></pre></div>



<a name="204558613"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204558613" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204558613">(Jul 21 2020 at 15:01)</a>:</h4>
<p>(from codegen/src/ir/types.rs)</p>



<a name="204558716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204558716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204558716">(Jul 21 2020 at 15:02)</a>:</h4>
<p>I'm not sure whether a <code>true</code> B128 is meant to be 0....001 or 1...111 though</p>



<a name="204558977"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204558977" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204558977">(Jul 21 2020 at 15:04)</a>:</h4>
<p>I can't seem to find anything in the old x86 backend that would imply either way... continuing to look</p>



<a name="204559139"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204559139" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204559139">(Jul 21 2020 at 15:05)</a>:</h4>
<p>Sorry what I meant was that each element was 0x00... or 0xff...</p>



<a name="204559152"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204559152" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204559152">(Jul 21 2020 at 15:05)</a>:</h4>
<p>Ah, OK, it seems that it must be numeric <code>0</code> or <code>1</code>, because we use a simple zero-extension to go from e.g. <code>B8</code> to <code>I8</code> and the latter must be 0 or 1</p>



<a name="204559248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204559248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204559248">(Jul 21 2020 at 15:06)</a>:</h4>
<p>Look at <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/src/simple_preopt.rs#L956">https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/src/simple_preopt.rs#L956</a> for example</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/src/simple_preopt.rs#L956" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/codegen/src/simple_preopt.rs#L956" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="204559285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204559285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204559285">(Jul 21 2020 at 15:06)</a>:</h4>
<p>Ah, well that is interesting indeed</p>



<a name="204559562"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204559562" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204559562">(Jul 21 2020 at 15:08)</a>:</h4>
<p><span class="user-mention" data-user-id="254393">@Benjamin Bouvier</span> or <span class="user-mention" data-user-id="254083">@Dan Gohman</span> do you know more?</p>



<a name="204559621"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204559621" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204559621">(Jul 21 2020 at 15:08)</a>:</h4>
<p>I suppose it has to be 0 / -1 (ff...) given the masking above -- but then that means we have to be careful with <code>bint</code> of the result of that must be 0 / 1</p>



<a name="204560986"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204560986" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204560986">(Jul 21 2020 at 15:19)</a>:</h4>
<p>I seem to recall that true lanes are all ones, while false lanes are all zeroes, i don't know if it's guaranteed though</p>



<a name="204561044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204561044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204561044">(Jul 21 2020 at 15:19)</a>:</h4>
<p><span class="user-mention" data-user-id="254110">@Andrew Brown</span> you might know ^?</p>



<a name="204561379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204561379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204561379">(Jul 21 2020 at 15:21)</a>:</h4>
<p>Yeah, I think what Benjamin said is correct: the vector booleans have to be all 0s or all 1s... There was an issue about this, let me dig it up.</p>



<a name="204562317"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204562317" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204562317">(Jul 21 2020 at 15:27)</a>:</h4>
<p>Here it is: <a href="https://github.com/bytecodealliance/wasmtime/pull/1769">https://github.com/bytecodealliance/wasmtime/pull/1769</a>. This fixed a bug where boolean vector lanes were not all 0s or all 1s. The Cranelift IR documentation describing this is here: <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/docs/ir.md#boolean-types">https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/docs/ir.md#boolean-types</a>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1769" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1769" title="Make vconst BxN match specification by teapotd · Pull Request #1769 · bytecodealliance/wasmtime">Make vconst BxN match specification by teapotd · Pull Request #1769 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">Cranelift IR docs for boolean types say:

Several larger boolean types are also defined, primarily to be used as SIMD element types. They can be stored in memory, and are represented as either all ...</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/docs/ir.md#boolean-types" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/docs/ir.md#boolean-types" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="204563688"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204563688" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204563688">(Jul 21 2020 at 15:37)</a>:</h4>
<p>Thanks for the links Andrew!</p>



<a name="204564002"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204564002" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204564002">(Jul 21 2020 at 15:39)</a>:</h4>
<p><span class="user-mention" data-user-id="254389">@Chris Fallin</span> looks like aarch64's Bint lowering is wrong?</p>



<a name="204564151"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204564151" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204564151">(Jul 21 2020 at 15:40)</a>:</h4>
<p>Yes, given the above, it should mask down to the LSB</p>



<a name="204564189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204564189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204564189">(Jul 21 2020 at 15:40)</a>:</h4>
<p>I'll put together a patch unless you want to include this in yours</p>



<a name="204564298"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204564298" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204564298">(Jul 21 2020 at 15:42)</a>:</h4>
<p>Also icmp / fcmp -- they use <code>cset</code> which yields 0/1. If dest type is &gt; <code>b1</code> then we need a negation</p>



<a name="204564646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204564646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204564646">(Jul 21 2020 at 15:44)</a>:</h4>
<p>Vector comparisons don't use cset</p>



<a name="204565563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204565563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204565563">(Jul 21 2020 at 15:51)</a>:</h4>
<p>Two separate issues I guess -- there's the question of vector lane values (your immediate question) but then there's also the representation of scalar <code>b8</code> / <code>b16</code> / ...</p>



<a name="204565651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204565651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204565651">(Jul 21 2020 at 15:52)</a>:</h4>
<p>For the latter, we should also use the 0 / -1 representation</p>



<a name="204565899"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204565899" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204565899">(Jul 21 2020 at 15:54)</a>:</h4>
<p>Oh silly me, I was thinking you meant <code>bNxM</code> when you said &gt;<code>b1</code></p>



<a name="204567528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204567528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204567528">(Jul 21 2020 at 16:06)</a>:</h4>
<p>Yup no worries! I'll patch the scalar case</p>



<a name="204568044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/204568044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#204568044">(Jul 21 2020 at 16:10)</a>:</h4>
<p>Thanks! And the original reason I went looking into this was a mistake on my side anyway, but Im happy we found this issue due to it :)</p>



<a name="205352295"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205352295" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205352295">(Jul 29 2020 at 13:00)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> Not sure where this message has gone, but: yesterday i had to pin the version of rustc nightly because staticvec doesn't compile in rustc nightly anymore, and this was breaking the build.</p>



<a name="205352430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205352430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205352430">(Jul 29 2020 at 13:01)</a>:</h4>
<p>opened a PR for static vec, but it's not sufficient as staticvec's CI relies on miri, thus the latest rustc nightly version that supports miri, which is currently 2 weeks old... <a href="https://github.com/slightlyoutofphase/staticvec/pull/39">https://github.com/slightlyoutofphase/staticvec/pull/39</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/slightlyoutofphase/staticvec/pull/39" style="background-image: url(https://avatars3.githubusercontent.com/u/47403582?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/slightlyoutofphase/staticvec/pull/39" title="Remove rustc compiler features to unbreak rustc nightly build by bnjbvr · Pull Request #39 · slightlyoutofphase/staticvec">Remove rustc compiler features to unbreak rustc nightly build by bnjbvr · Pull Request #39 · slightlyoutofphase/staticvec</a></div><div class="message_embed_description">following landing of rust-lang/rust#73858,
the const_saturing_int_methods feature is in a weird nonexisting
state (stabilized in a future Rust version), so remove it from the list
to unblock compil...</div></div></div>



<a name="205353304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205353304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205353304">(Jul 29 2020 at 13:08)</a>:</h4>
<p>Bah, I'll work on updating our CI to be green soon</p>



<a name="205354788"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354788" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354788">(Jul 29 2020 at 13:20)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="205354803"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354803" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354803">(Jul 29 2020 at 13:20)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> since you're around, can i bother you with more CI questions?</p>



<a name="205354835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354835">(Jul 29 2020 at 13:21)</a>:</h4>
<p>Sure yeah what's up?</p>



<a name="205354847"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354847" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354847">(Jul 29 2020 at 13:21)</a>:</h4>
<p>I'm trying to mark the cranelift filetests as should_panic with the experimental_x64 feature, but it doesn't seem to be taken into account when i run the tests, unfortunately.</p>



<a name="205354892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354892">(Jul 29 2020 at 13:21)</a>:</h4>
<p>What's the marker look like?</p>



<a name="205354902"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354902" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354902">(Jul 29 2020 at 13:21)</a>:</h4>
<p>i've added <code>#[cfg_attr(feature = "experimental_x64", should_panic)</code> above the test in cranelift/tests/filetests.rs, but it does nothing.</p>



<a name="205354946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354946">(Jul 29 2020 at 13:21)</a>:</h4>
<p>I'm running the tests with <code>cargo --features experimental_x64 --all --exclude lightbeam</code> (+ peepmatic exclusions)</p>



<a name="205354947"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354947" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354947">(Jul 29 2020 at 13:22)</a>:</h4>
<p>Is it a #[test] function?</p>



<a name="205354994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205354994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205354994">(Jul 29 2020 at 13:22)</a>:</h4>
<p>yes it is</p>



<a name="205355027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355027">(Jul 29 2020 at 13:22)</a>:</h4>
<p>And that crate has that feature in cargo.toml?</p>



<a name="205355085"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355085" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355085">(Jul 29 2020 at 13:22)</a>:</h4>
<p>yes</p>



<a name="205355133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355133">(Jul 29 2020 at 13:23)</a>:</h4>
<p>Hm weird... Wanna gist your patch and I'll take a look?</p>



<a name="205355422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355422">(Jul 29 2020 at 13:25)</a>:</h4>
<p>Sure, thanks!</p>



<a name="205355423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355423">(Jul 29 2020 at 13:25)</a>:</h4>
<p><a href="https://paste.mozilla.org/ryemqRPh">https://paste.mozilla.org/ryemqRPh</a></p>



<a name="205355579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355579">(Jul 29 2020 at 13:26)</a>:</h4>
<p>Hm and you're not getting compile.failures?</p>



<a name="205355591"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355591" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355591">(Jul 29 2020 at 13:27)</a>:</h4>
<p>Nope</p>



<a name="205355620"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355620" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355620">(Jul 29 2020 at 13:27)</a>:</h4>
<p>If so then cranelift/cargo.toml may not have the feature?</p>



<a name="205355633"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355633" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355633">(Jul 29 2020 at 13:27)</a>:</h4>
<p>I'll dig a bit more in in a sec</p>



<a name="205355691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355691">(Jul 29 2020 at 13:28)</a>:</h4>
<p>it is there, though: <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/Cargo.toml#L51">https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/Cargo.toml#L51</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/Cargo.toml#L51" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/Cargo.toml#L51" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="205355991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205355991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205355991">(Jul 29 2020 at 13:30)</a>:</h4>
<p>ok, so new fact: if i run the tests from wasmtime root dir, it doesn't happen. If i run from the wasmtime/cranelift directory, the compile error happens, and the test isn't run if i remove the body addends</p>



<a name="205356609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356609">(Jul 29 2020 at 13:35)</a>:</h4>
<p>aha</p>



<a name="205356622"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356622" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356622">(Jul 29 2020 at 13:35)</a>:</h4>
<p>if you do <code>cargo test -p cranelift-tools --feature ...</code> that doesn't actually do what you would expect</p>



<a name="205356626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356626">(Jul 29 2020 at 13:35)</a>:</h4>
<p>it's basically a bug in Cargo</p>



<a name="205356644"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356644" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356644">(Jul 29 2020 at 13:35)</a>:</h4>
<p>it applies the features to w/e is in the current directory, not the target of <code>-p</code></p>



<a name="205356710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356710">(Jul 29 2020 at 13:36)</a>:</h4>
<p>aha! and if i run in wasmtime with --all, it'll work? let me try this!</p>



<a name="205356713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356713">(Jul 29 2020 at 13:36)</a>:</h4>
<p>you'll need to do <code>--manifest-path cranelift/Cargo.toml</code> or change the cwd</p>



<a name="205356720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356720">(Jul 29 2020 at 13:36)</a>:</h4>
<p>nah it won't workwith <code>--all</code> either</p>



<a name="205356790"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205356790" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205356790">(Jul 29 2020 at 13:36)</a>:</h4>
<p>there's a bit more info <a href="https://doc.rust-lang.org/nightly/cargo/reference/unstable.html#resolver">here</a> about the unstable feature to fix this</p>



<a name="205357046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205357046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205357046">(Jul 29 2020 at 13:38)</a>:</h4>
<p>oh well, thanks it works with this!</p>



<a name="205357063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205357063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205357063">(Jul 29 2020 at 13:39)</a>:</h4>
<p>i'll split the CI steps then</p>



<a name="205360771"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205360771" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205360771">(Jul 29 2020 at 14:05)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> well, does it mean that we should be able to run the tests with experimental_x64 in CI? i'm a bit lost regarding how to do this, then</p>



<a name="205360895"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205360895" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205360895">(Jul 29 2020 at 14:06)</a>:</h4>
<p>I'd probably limit this to a nightly rustc which executes Cargo with the relevant <code>-Z</code> flag</p>



<a name="205360909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205360909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205360909">(Jul 29 2020 at 14:06)</a>:</h4>
<p>so that way we don't have to bend over backwards for this</p>



<a name="205362060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362060">(Jul 29 2020 at 14:15)</a>:</h4>
<p>great idea!</p>



<a name="205362091"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362091" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362091">(Jul 29 2020 at 14:15)</a>:</h4>
<p>but it causes new compile time errors that i don't quite understand <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p>



<a name="205362196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362196">(Jul 29 2020 at 14:16)</a>:</h4>
<p><a href="https://paste.mozilla.org/BtuHrkxb">https://paste.mozilla.org/BtuHrkxb</a></p>



<a name="205362319"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362319" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362319">(Jul 29 2020 at 14:17)</a>:</h4>
<p>hm interesting</p>



<a name="205362358"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362358" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362358">(Jul 29 2020 at 14:17)</a>:</h4>
<p>so what's happening in cargo is that the behavior of the feature resolver is different, where features are less eagerly unified</p>



<a name="205362392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362392">(Jul 29 2020 at 14:17)</a>:</h4>
<p>I think that means the wiggle crate depends on <code>syn</code> but doesn't activate the right set of features</p>



<a name="205362418"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362418" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362418">(Jul 29 2020 at 14:17)</a>:</h4>
<p>er, no</p>



<a name="205362483"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362483" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362483">(Jul 29 2020 at 14:18)</a>:</h4>
<p>hm I'll have to dig into that later</p>



<a name="205362495"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205362495" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205362495">(Jul 29 2020 at 14:18)</a>:</h4>
<p>that may actually be a bug in cargo? unsure</p>



<a name="205366478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205366478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205366478">(Jul 29 2020 at 14:48)</a>:</h4>
<p>oops, sorry to cause more work</p>



<a name="205366941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205366941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205366941">(Jul 29 2020 at 14:51)</a>:</h4>
<p>heh no worries</p>



<a name="205366968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205366968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205366968">(Jul 29 2020 at 14:51)</a>:</h4>
<p><span class="user-mention" data-user-id="254393">@Benjamin Bouvier</span> btw it looks like wasmtime CI is green, what was the failure you were seeing again?</p>



<a name="205367451"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205367451" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205367451">(Jul 29 2020 at 14:54)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> oh yeah i added a commit that pinned the version of rustc nightly, let me find that</p>



<a name="205367542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205367542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205367542">(Jul 29 2020 at 14:55)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/2c1d3704653f094a93848a87f79361bca511392b">https://github.com/bytecodealliance/wasmtime/commit/2c1d3704653f094a93848a87f79361bca511392b</a> was the commit, but i can see there was another CI failure</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/commit/2c1d3704653f094a93848a87f79361bca511392b" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/commit/2c1d3704653f094a93848a87f79361bca511392b" title="CI: use fixed version of Rust nightly following build failures in sta… · bytecodealliance/wasmtime@2c1d370">CI: use fixed version of Rust nightly following build failures in sta… · bytecodealliance/wasmtime@2c1d370</a></div><div class="message_embed_description">…ticvec</div></div></div>



<a name="205367750"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205367750" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205367750">(Jul 29 2020 at 14:56)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasmtime/runs/918219496?check_suite_focus=true">https://github.com/bytecodealliance/wasmtime/runs/918219496?check_suite_focus=true</a> was one of the CI failures with staticvec</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/runs/918219496?check_suite_focus=true" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/runs/918219496?check_suite_focus=true" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="205367863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205367863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205367863">(Jul 29 2020 at 14:57)</a>:</h4>
<p>hm did you bump a staticvec version?</p>



<a name="205367898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205367898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205367898">(Jul 29 2020 at 14:57)</a>:</h4>
<p>b/c CI for the main branch came back green a few hour sago</p>



<a name="205368422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368422">(Jul 29 2020 at 15:01)</a>:</h4>
<p>no, i did pin the version of rustc nightly running in wasmtime (first link above)</p>



<a name="205368469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368469">(Jul 29 2020 at 15:01)</a>:</h4>
<p>hm ok well I can try to help with a PR</p>



<a name="205368531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368531">(Jul 29 2020 at 15:02)</a>:</h4>
<p>but it sounds like local changes may have necessitated a pin</p>



<a name="205368549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368549">(Jul 29 2020 at 15:02)</a>:</h4>
<p>I don't know what to debug if main CI isn't failing</p>



<a name="205368571"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368571" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368571">(Jul 29 2020 at 15:02)</a>:</h4>
<p>see also <a href="https://github.com/slightlyoutofphase/staticvec/pull/39">https://github.com/slightlyoutofphase/staticvec/pull/39</a>, but it seems that it requires a miri in rustc nightly to work</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/slightlyoutofphase/staticvec/pull/39" style="background-image: url(https://avatars3.githubusercontent.com/u/47403582?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/slightlyoutofphase/staticvec/pull/39" title="Remove rustc compiler features to unbreak rustc nightly build by bnjbvr · Pull Request #39 · slightlyoutofphase/staticvec">Remove rustc compiler features to unbreak rustc nightly build by bnjbvr · Pull Request #39 · slightlyoutofphase/staticvec</a></div><div class="message_embed_description">following landing of rust-lang/rust#73858,
the const_saturing_int_methods feature is in a weird nonexisting
state (stabilized in a future Rust version), so remove it from the list
to unblock compil...</div></div></div>



<a name="205368614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368614">(Jul 29 2020 at 15:02)</a>:</h4>
<p>it makes sense that it'd break, but I don't know why main CI isn't failing in tha tcase</p>



<a name="205368646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368646">(Jul 29 2020 at 15:03)</a>:</h4>
<p>Reverting 2c1d3704653f094a93848a87f79361bca511392b should make the CI fail</p>



<a name="205368674"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368674" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368674">(Jul 29 2020 at 15:03)</a>:</h4>
<p>oooh wait I see</p>



<a name="205368680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368680">(Jul 29 2020 at 15:03)</a>:</h4>
<p>you landed that on <code>main</code></p>



<a name="205368695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368695">(Jul 29 2020 at 15:03)</a>:</h4>
<p>sorry I see now</p>



<a name="205368705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368705">(Jul 29 2020 at 15:03)</a>:</h4>
<p>no worries</p>



<a name="205368707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368707">(Jul 29 2020 at 15:03)</a>:</h4>
<p>I thought this was just in your PR</p>



<a name="205368734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368734">(Jul 29 2020 at 15:03)</a>:</h4>
<p>i did it a bit preemptively because it was blocking a PR landing in spidermonkey</p>



<a name="205368740"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368740" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368740">(Jul 29 2020 at 15:03)</a>:</h4>
<p>ah ok, in any case that's all I would have done, we can't do much until staticvec updates</p>



<a name="205368751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368751">(Jul 29 2020 at 15:03)</a>:</h4>
<p>nah no worries</p>



<a name="205368764"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205368764" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205368764">(Jul 29 2020 at 15:03)</a>:</h4>
<p>just got mixed up what was landed where</p>



<a name="205369001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205369001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205369001">(Jul 29 2020 at 15:05)</a>:</h4>
<p><span class="user-mention" data-user-id="254393">@Benjamin Bouvier</span> I think it'd be good to do these kinds of things in their own PR, or at least mention the pinning in the PR they're included in</p>



<a name="205369296"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205369296" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205369296">(Jul 29 2020 at 15:07)</a>:</h4>
<p><span class="user-mention" data-user-id="234973">@Till Schneidereit</span> yeah, i mentioned it here on zulip with a mention to Alex, but this message disappeared in the meanwhile, not sure what happened...</p>



<a name="205369311"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205369311" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205369311">(Jul 29 2020 at 15:07)</a>:</h4>
<p>i'll put a message in the PR next time</p>



<a name="205369481"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205369481" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205369481">(Jul 29 2020 at 15:08)</a>:</h4>
<p>ah, yeah, the vanished message is very strange. But documenting things like this in a PR is good practice anyway, I think. Though really I'd prefer it to be its own PR, and an issue opened about reverting it at the same time</p>



<a name="205371935"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205371935" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205371935">(Jul 29 2020 at 15:24)</a>:</h4>
<p>Right. There's also a speed vs process tradeoff here: opening a new PR would have taken two more CI runs (one for the PR, one to rebase the other PR on top of the first one). And, this is not the first time this is happening after the merger of Wasmtime and Cranelift repositories (i can recall at least two other instances, last being last week, so third time this is happening to me), and because of time zones, people working in europe are more likely to hit the "unrelated CI failures because of a rustc nightly change" before anyone else...</p>



<a name="205372071"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205372071" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205372071">(Jul 29 2020 at 15:25)</a>:</h4>
<p><span class="user-mention" data-user-id="254393">@Benjamin Bouvier</span> ok I <a href="https://github.com/rust-lang/cargo/issues/8563">opened a Cargo issue</a> for the wiggle problem you're seeing</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rust-lang/cargo/issues/8563" style="background-image: url(https://avatars1.githubusercontent.com/u/5430905?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rust-lang/cargo/issues/8563" title="Testing a proc macro may build with the wrong crates with -Zfeatures=all · Issue #8563 · rust-lang/cargo">Testing a proc macro may build with the wrong crates with -Zfeatures=all · Issue #8563 · rust-lang/cargo</a></div><div class="message_embed_description">This is unfortunately a bit of a complicated issue. This came up when we tested out using -Zfeatures=all on the wasmtime repository where we got an error that looked like: error[E0277]: the trait b...</div></div></div>



<a name="205372094"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205372094" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205372094">(Jul 29 2020 at 15:25)</a>:</h4>
<p>in the meantime you can use <code>doctest = false</code> in <code>crates/wiggle/macro/Cargo.toml</code></p>



<a name="205372140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205372140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205372140">(Jul 29 2020 at 15:26)</a>:</h4>
<p>and still use <code>-Zfeatures=all</code> i think</p>



<a name="205374739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205374739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205374739">(Jul 29 2020 at 15:46)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> Thanks a lot! I can run all the tests! (with a few annotations to skip some)</p>



<a name="205374799"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205374799" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205374799">(Jul 29 2020 at 15:47)</a>:</h4>
<p>that being said, if i try to run a particular test by adding its name to the CLI command, i run into a similar compile error as above, again</p>



<a name="205374838"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205374838" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205374838">(Jul 29 2020 at 15:47)</a>:</h4>
<p>it's probably a later problem, though, as long as we can run something in the meanwhile</p>



<a name="205614085"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205614085" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205614085">(Jul 31 2020 at 16:52)</a>:</h4>
<p>Just a heads up: it seems the test_x64 CI has an intermittent failure, not sure yet what causes it, and I won't be around or have time today to investigate it too much, unfortunately.</p>



<a name="205616867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205616867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205616867">(Jul 31 2020 at 17:18)</a>:</h4>
<p>I observed something similar in #2060 but thought it was due to rebasing. It's a bit hard to figure out what is going wrong because all the <code>should_panic</code> tests emit backtraces so there are a lot errors in the logs--is there a way to mute those somehow?</p>



<a name="205617156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205617156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205617156">(Jul 31 2020 at 17:21)</a>:</h4>
<p><span class="user-mention" data-user-id="254389">@Chris Fallin</span>, <span class="user-mention" data-user-id="253994">@Alex Crichton</span>: I think #2071 looks like a good change if we overlook the intermittent CI issues--with Benjamin out, should we merge it or look into the CI issues first?</p>



<a name="205617563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205617563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205617563">(Jul 31 2020 at 17:25)</a>:</h4>
<p>seems fine by me, but I don't know much about the components in play here</p>



<a name="205617653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205617653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205617653">(Jul 31 2020 at 17:26)</a>:</h4>
<p>It seems this is good to merge, but I also think we should address the CI intermittent failure somehow; slippery slope to "manually ignore" tests</p>



<a name="205620374"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205620374" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205620374">(Jul 31 2020 at 17:50)</a>:</h4>
<p>i managed to catch the crash in rr, that i packed so one can reproduce it on a similar CPU (machine cpuinfo is there: <a href="https://benj.me/pub/cpuinfo">https://benj.me/pub/cpuinfo</a>)<br>
Here's the packed trace directory, to be unzipped and then run with <code>rr replay $trace_dir</code>: <a href="https://benj.me/pub/rr-trace.zip">https://benj.me/pub/rr-trace.zip</a></p>



<a name="205620428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205620428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205620428">(Jul 31 2020 at 17:51)</a>:</h4>
<p>We should probably disable the x64 CI if it's too buggy, though</p>



<a name="205620435"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205620435" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205620435">(Jul 31 2020 at 17:51)</a>:</h4>
<p>/me disappears</p>



<a name="205632515"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/205632515" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#205632515">(Jul 31 2020 at 19:35)</a>:</h4>
<p>I see someone restarted the CI and this time the new backend step passed; I'll merge #2071 since I can use Benjamin's changes and we can talk more about troubleshooting or disabling the new backend step if it keeps happening (any objections?)</p>



<a name="208955060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/208955060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#208955060">(Sep 03 2020 at 11:53)</a>:</h4>
<p>Fwiw, Cranelift has been shipped in Firefox and will be used for wasm compilation on aarch64 devices! Thanks to all who contributed making this possible! cc <span class="user-mention" data-user-id="265780">@Joey Gouly</span> <span class="user-mention" data-user-id="300050">@Anton Kirilov</span> etc.</p>



<a name="208955209"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/208955209" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#208955209">(Sep 03 2020 at 11:55)</a>:</h4>
<p>(Also: these two days are company-wide PTO for Mozillians, so Mozillians' activity might be low!)</p>



<a name="208956449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/208956449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#208956449">(Sep 03 2020 at 12:07)</a>:</h4>
<p><span class="user-mention" data-user-id="254393">@Benjamin Bouvier</span> awesome!</p>



<a name="209016163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/209016163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#209016163">(Sep 03 2020 at 19:14)</a>:</h4>
<p><span aria-label="rocket" class="emoji emoji-1f680" role="img" title="rocket">:rocket:</span> <span aria-label="confetti" class="emoji emoji-1f38a" role="img" title="confetti">:confetti:</span> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> <span aria-label="ship" class="emoji emoji-1f6a2" role="img" title="ship">:ship:</span> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> <span aria-label="confetti" class="emoji emoji-1f38a" role="img" title="confetti">:confetti:</span> <span aria-label="rocket" class="emoji emoji-1f680" role="img" title="rocket">:rocket:</span></p>



<a name="210539923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210539923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210539923">(Sep 18 2020 at 15:59)</a>:</h4>
<p><span class="user-mention" data-user-id="253990">@fitzgen (he/him)</span> Hi, I think changing from String -&gt; anyhow broke some of the usefulness of clif-utils errors</p>



<a name="210540164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540164">(Sep 18 2020 at 16:01)</a>:</h4>
<p>previously when it failed, it printed out what it matched / what it missed, but I dont seem to get that now</p>



<a name="210540256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540256">(Sep 18 2020 at 16:01)</a>:</h4>
<p>oh? which ones? <code>anyhow</code> has lots of ability to annotate errors with extra context, and its possible I accidentally forgot to translate some string concatenation into annotated context</p>



<a name="210540428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540428">(Sep 18 2020 at 16:02)</a>:</h4>
<p>for example: <code>cargo run -p cranelift-tools -- test cranelift/filetests/filetests/vcode/aarch64/reftypes.clif</code></p>



<a name="210540517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540517">(Sep 18 2020 at 16:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="265780">Joey Gouly</span> <a href="#narrow/stream/217117-cranelift/topic/general/near/210540164">said</a>:</p>
<blockquote>
<p>previously when it failed, it printed out what it matched / what it missed, but I dont seem to get that now</p>
</blockquote>
<p>for filetests? its possible that I messed up the <code>if &lt;condition&gt; { print() }</code> logic when translating CLI flags, which should be unrelated to anyhow, although it was the same PR. some of them used <code>flag_print</code> and others used <code>flag_verbose</code>, and I might have messed some of them up</p>



<a name="210540530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540530">(Sep 18 2020 at 16:03)</a>:</h4>
<p>if you delete one of the <code>nextln</code> checks, the output you get is: <code>FAIL reftypes.clif: compile</code></p>



<a name="210540542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540542">(Sep 18 2020 at 16:03)</a>:</h4>
<p>let me look into it</p>



<a name="210540882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210540882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210540882">(Sep 18 2020 at 16:06)</a>:</h4>
<p>thanks!</p>



<a name="210554052"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210554052" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210554052">(Sep 18 2020 at 17:55)</a>:</h4>
<p>Fix over here: <a href="https://github.com/bytecodealliance/wasmtime/pull/2207">https://github.com/bytecodealliance/wasmtime/pull/2207</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/2207" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/2207" title="Make filetest errors report full context by fitzgen · Pull Request #2207 · bytecodealliance/wasmtime">Make filetest errors report full context by fitzgen · Pull Request #2207 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">This provides the full error context, not just the source error&#39;s message. The anyhow::Error&#39;s Display implementation just shows the source error&#39;s message, not any of its context. The ...</div></div></div>



<a name="210847941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/210847941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#210847941">(Sep 22 2020 at 09:45)</a>:</h4>
<p>Thanks!</p>



<a name="213581482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/213581482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#213581482">(Oct 16 2020 at 16:17)</a>:</h4>
<p><span class="user-mention" data-user-id="253990">@fitzgen (he/him)</span> Hi, I was wondering in general what the plans for peepomatic were? Is the aim to turn it on by default?</p>



<a name="213584031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/213584031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#213584031">(Oct 16 2020 at 16:38)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> </p>
<p>The most immediate plan is to demonstrate better codegen while not sacrificing compilation time (very much, since peepmatic is currently a little slower than the hand-written simple preopt pass) by creating peephole passes from superoptimizations synthesized by <a href="https://github.com/google/souper">Souper</a>. See the recent work to add <code>clif-util souper-harvest</code> and <code>clif-util souper-to-peepmatic</code> commands.</p>
<p>After that is successful, we can start talking about when it makes sense to turn on custom Peepmatic passes for which Cranelift embeddings. For example, it likely makes sense for Lucet before it makes sense for SpiderMonkey.</p>
<p>Eventually I would like to replace the hand written simple preopt with the peepmatic version. There are a few open questions here. First is the question of compile times: peepmatic is currently a little slower than the hand written pass. There's certainly more room for improvement here. But it is also easier to add new optimizations via peepmatic DSL than via open coding matches on <code>InstructionData</code>, and peepmatic is designed such that its performance scales as the number of optimizations in a peephole pass grows. When do we cross the line from "not worth it" to "worth it" when balancing compile times and code quality? I'm not sure. That's kind of why I've been declining to add anything to the peepmatic version of simple-preopt that isn't already in the hand-written version. At least this way we are comparing apples to apples, even if we are leaving peepmatic's biggest strengths on the floor.</p>
<p>This sort of ties into having a better benchmark suite as well, so we can have concrete numbers to work with. A benchmark suite that doesn't require a Web embedding. I want to start work on this soon because it is so hard to evaluate any decisions we make related to this stuff without it.</p>
<p>More things I'd like Peepmatic to do eventually:</p>
<ul>
<li>
<p>vcode peephole optimizations (it is already generic over the IR it is optimizing in anticipation of this, but we need a simple reaching defs analysis so we can determine whether two uses of some virtual register are the same value or not)</p>
</li>
<li>
<p>clif -&gt; vcode lowering</p>
</li>
<li>
<p>perhaps even instruction selection (the go compiler uses their equivalent DSL for instruction selection and I find it very nice, but other folks might have other feelings on this topic)</p>
</li>
<li>
<p>perhaps port LLVM's inst combine pass over to peepmatic</p>
</li>
</ul>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/google/souper" style="background-image: url(https://avatars0.githubusercontent.com/u/1342004?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/google/souper" title="google/souper">google/souper</a></div><div class="message_embed_description">A superoptimizer for LLVM IR. Contribute to google/souper development by creating an account on GitHub.</div></div></div>



<a name="213894524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/213894524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#213894524">(Oct 20 2020 at 09:33)</a>:</h4>
<p><span class="user-mention" data-user-id="253990">@fitzgen (he/him)</span> thanks for the explanation!</p>



<a name="222995877"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/222995877" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> carado <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#222995877">(Jan 16 2021 at 17:59)</a>:</h4>
<p>hi! i was wondering if there is documentation somewhere for cranelift_frontend's FuncInstBuilder ? it seems to be where the logic for instructions is, but <a href="http://docs.rs">docs.rs</a> doesn't seem to have generated documentation for it (indeed, searching a function used in the example on <a href="https://docs.rs/cranelift-frontend/0.69.0/cranelift_frontend/index.html">https://docs.rs/cranelift-frontend/0.69.0/cranelift_frontend/index.html</a> such as <code>iconst</code> doesn't yield any results)</p>



<a name="222995958"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/222995958" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> carado <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#222995958">(Jan 16 2021 at 18:00)</a>:</h4>
<p>(FuncInstBuilder being what is returned by <code>cranelift_frontend::FunctionBuilder::ins()</code>)</p>



<a name="223002066"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/223002066" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#223002066">(Jan 16 2021 at 19:45)</a>:</h4>
<p>FuncInstBuilder implements the InstBuilder trait: <a href="https://docs.rs/cranelift-codegen/0.66.0/cranelift_codegen/ir/trait.InstBuilder.html">https://docs.rs/cranelift-codegen/0.66.0/cranelift_codegen/ir/trait.InstBuilder.html</a></p>



<a name="223002075"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/223002075" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#223002075">(Jan 16 2021 at 19:45)</a>:</h4>
<p><span class="user-mention" data-user-id="380969">@carado</span></p>



<a name="223002321"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/223002321" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> carado <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#223002321">(Jan 16 2021 at 19:51)</a>:</h4>
<p>oh cool, thanks!</p>



<a name="223855479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/223855479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anhad Singh <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#223855479">(Jan 25 2021 at 04:54)</a>:</h4>
<p>Hello! <br>
I am getting (exit code: 0xc0000005, STATUS_ACCESS_VIOLATION) when trying to Linkage::Import </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[no_mangle]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">extern</span><span class="w"> </span><span class="s">"C"</span><span class="w"> </span><span class="k">fn</span> <span class="nf">ello_world</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i64</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">"Ello World!"</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="mi">0</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="223859078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/general/near/223859078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anhad Singh <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/general.html#223859078">(Jan 25 2021 at 06:15)</a>:</h4>
<p>Nvm I fixed it. Is there a way to do overloaded functions in module.symobl() as the docs say that the one last created is accepted</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>