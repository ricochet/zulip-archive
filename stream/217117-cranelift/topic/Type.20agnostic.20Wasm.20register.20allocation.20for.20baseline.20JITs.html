<html>
<head><meta charset="utf-8"><title>Type agnostic Wasm register allocation for baseline JITs · cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/index.html">cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/Type.20agnostic.20Wasm.20register.20allocation.20for.20baseline.20JITs.html">Type agnostic Wasm register allocation for baseline JITs</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="404646533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/Type%20agnostic%20Wasm%20register%20allocation%20for%20baseline%20JITs/near/404646533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Freyler <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/Type.20agnostic.20Wasm.20register.20allocation.20for.20baseline.20JITs.html#404646533">(Nov 28 2023 at 14:25)</a>:</h4>
<p>I don't really know where to ask this or if this is even a genuinely good questions but here we go.<br>
(Note: I am not a compiler expert and may therefore lack basic knowledge.)</p>
<p>In Wasm everything is typed as per Wasm validation. This means also local variables are typed and locals with different typed cannot share the same variable which makes sense with respect to Wasm validation.</p>
<p>A naive baseline JIT compiler or rewriting interpreter may simply allocate a virtual register per Wasm local variable. However, a register might fit different types of values and thus doesn't require this typed duplication on a technical level. (E.g. at least in <code>wasmi</code> registers fit any 64-bit Wasm type.)</p>
<p>So ideally we want to allocate registers based on their respective lifetimes instead of type.<br>
Fast compilation requirements disallow SSA based IR.</p>
<p>Are there  known techniques for dealing with allocation of virtual register slots that are applicable for singlepass JITs or rewriting interpreters optimized for fast compilation? Happy about links or papers or search hints. :)</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>