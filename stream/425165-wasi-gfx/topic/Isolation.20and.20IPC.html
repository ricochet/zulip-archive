<html>
<head><meta charset="utf-8"><title>Isolation and IPC · wasi-gfx · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/index.html">wasi-gfx</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html">Isolation and IPC</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="429735001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429735001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429735001">(Mar 26 2024 at 20:34)</a>:</h4>
<p>Just spoke to the primary maintainer of wgpu (Connor Fitzgerald), he confirmed <span class="user-mention" data-user-id="569660">@Sean Isom</span>'s nightmare, wgpu doesn't isolate between gpu resources.<br>
Now the question is if the component-model's isolation is enough.<br>
(cc <span class="user-mention" data-user-id="254083">@Dan Gohman</span> )</p>



<a name="429740380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429740380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429740380">(Mar 26 2024 at 21:08)</a>:</h4>
<p>Maybe this becomes the host runtime's problem (in this case, the wrapper around WebGPU). It would be difficult to implement runtime behavior in terms of the standard that is based on WIT, I would say?</p>



<a name="429744531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429744531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429744531">(Mar 26 2024 at 21:41)</a>:</h4>
<p>When wgpu is used in Firefox, how do they keep GPU resources isolated?</p>



<a name="429744880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429744880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429744880">(Mar 26 2024 at 21:44)</a>:</h4>
<p>My (basic) understanding is that it is cross-origin resource isolation. It checks origin ownership before allowing the content process to communicate with the GPU process. Once IPC to the GPU process occurs, everything in the GPU process is untrusted (just runs native WGPU)</p>



<a name="429744967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429744967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429744967">(Mar 26 2024 at 21:45)</a>:</h4>
<p>Would be helpful for someone from Mozilla to validate that and maybe provide more detail</p>



<a name="429749864"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429749864" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429749864">(Mar 26 2024 at 22:27)</a>:</h4>
<p><span class="user-mention" data-user-id="419274">@Mendy Berger</span> The component model itself only isolates Wasm code, so it doesn't help for isolating things happening on the GPU.</p>



<a name="429753941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429753941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429753941">(Mar 26 2024 at 23:09)</a>:</h4>
<p>So it sounds like, in addition to the question of whether we need a GPU-process architecture, we'll also need to figure out validation.</p>



<a name="429754127"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429754127" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429754127">(Mar 26 2024 at 23:11)</a>:</h4>
<p>Is there anything in WASI previously that architecturally required IPC that could be used as a starting point? I feel like validation is a cumbersome but easier problem to solve.</p>



<a name="429754344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429754344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429754344">(Mar 26 2024 at 23:13)</a>:</h4>
<p>Not "architecturally", per se. In theory if someone wanted extra defense-in-depth they might want to run wasi-filesystem isolated in its own process, but I'm not aware of anyone having done that yet.</p>



<a name="429754516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429754516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429754516">(Mar 26 2024 at 23:15)</a>:</h4>
<p>There have been people investigating mapping WIt interefaces to IPC/RPC protocols, though at this time I don't know of anything out-of-the-box that we could use.</p>



<a name="429776022"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429776022" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429776022">(Mar 27 2024 at 03:34)</a>:</h4>
<p>I’ll drop Thomas Steiner a note and see if he has thoughts from the Chrome side. I don’t know the right point of contact at Mozilla</p>



<a name="429776172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429776172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429776172">(Mar 27 2024 at 03:36)</a>:</h4>
<p>I’m inclined to think validation is more important for an MVP than process sandboxing, as I think that is as much for host process stability as security, but I’m not an SME in browser design</p>



<a name="429787341"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429787341" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429787341">(Mar 27 2024 at 05:41)</a>:</h4>
<p>I asked a similar thing on the <code>wgpu</code> repo, but nobody answered. I did find <a href="https://github.com/gfx-rs/wgpu/discussions/2792">this though</a>. So it seems process isolation is optional, as long as you'd stick to the safe <code>wgpu</code> APIs. I don't know about <code>wgpu-core</code> though.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/gfx-rs/wgpu/discussions/2792" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/e147df2235b20f49e272e7ac6dc7f2f18cb56c1b\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f623665643730613538323734393437343362643636333566663339333266383534353832663462313138346636636365336461333232306362326365353361322f6766782d72732f776770752f64697363757373696f6e732f32373932)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/gfx-rs/wgpu/discussions/2792" title="Suitable for use with untrusted code? · gfx-rs wgpu · Discussion #2792">Suitable for use with untrusted code? · gfx-rs wgpu · Discussion #2792</a></div><div class="message_embed_description">Hi there! 👋 I've been thinking about a use case in which a native host application creates a render target, and then exposes a rendering API to untrusted code running in a Wasm VM. However, I could...</div></div></div>



<a name="429787599"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429787599" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429787599">(Mar 27 2024 at 05:43)</a>:</h4>
<p>Naga does shader validation already, and inserts bounds checks and things if needed, so that should be reasonably safe on the GPU side, too.</p>



<a name="429928900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429928900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bailey Hayes <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429928900">(Mar 27 2024 at 19:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="254083">Dan Gohman</span> <a href="#narrow/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC/near/429754516">said</a>:</p>
<blockquote>
<p>There have been people investigating mapping WIt interefaces to IPC/RPC protocols, though at this time I don't know of anything out-of-the-box that we could use.</p>
</blockquote>
<p><a href="https://github.com/rvolosatovs/wrpc/">https://github.com/rvolosatovs/wrpc/</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rvolosatovs/wrpc/" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/b1ec631a1ce5faf30b8b80090d81cf737f70b32a\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f666230333735333634363063643939313563373634626264313436663563356163636639333663363930313338373436396230363133663463343036303934392f72766f6c6f7361746f76732f77727063)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rvolosatovs/wrpc/" title="GitHub - rvolosatovs/wrpc: Wasm component-native RPC framework">GitHub - rvolosatovs/wrpc: Wasm component-native RPC framework</a></div><div class="message_embed_description">Wasm component-native RPC framework. Contribute to rvolosatovs/wrpc development by creating an account on GitHub.</div></div></div>



<a name="429942759"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429942759" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429942759">(Mar 27 2024 at 20:29)</a>:</h4>
<p>I'm more than a little our of my depth here, and this is about security, so don't trust me more than any self important rando...</p>
<p>IIUC wgpu does do shader code bounds checking, so we don't have to do any validation.<br>
They're just not doing resource checking, i.e. checking if a resource belongs to a specific caller before accessing it. But I think the runtimes are expected to do that, aren't they? </p>
<p>Again, don't trust a word I just said!</p>



<a name="429946020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429946020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429946020">(Mar 27 2024 at 20:46)</a>:</h4>
<p>I think not checking the caller is natural for <code>wgpu</code>: There's only one caller, the program that uses <code>wgpu</code> as a library. I looked and yes, it seems IDs are shared among all instances for a given backend, though the ID is an index into a vector (or something like it) of resources, so at least the type would be right. So the only thing to secure that would be to make the IDs opaque and inaccessible to WASM: Keep them in the host resource for each WebGPU object, and when calling <code>wgpu</code> just extract the IDs. The WASI implementation then assigns its own IDs for the "WASI" backend resources.</p>



<a name="429946541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429946541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429946541">(Mar 27 2024 at 20:48)</a>:</h4>
<p><span class="user-mention" data-user-id="695664">@Tarek Sander</span> exactly! This is why I don't think this is a real problem, the wasm module doesn't have access to the underlying wgpu IDs.</p>



<a name="429946674"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429946674" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429946674">(Mar 27 2024 at 20:49)</a>:</h4>
<p>This would mean the Rust implementation of the WASI API would lie in <code>wgpu-hal</code>, that works with graphics API types instead of IDs.</p>



<a name="429947767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429947767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429947767">(Mar 27 2024 at 20:54)</a>:</h4>
<p>Additional process isolation would be good, but I think for most uses cases being less paranoid about security that browsers is OK. It could be a vulnerability if the graphics API implementation <code>wgpu</code> in the host uses has a vulnerability for memory read/write, use that to run custom assembly or modify arguments to get access to other component's GPU resources, but seeing as these APIs are quite well tested and <code>wgpu</code> is used by Firefox, I don't think that's a big issue.</p>



<a name="429947829"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429947829" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429947829">(Mar 27 2024 at 20:55)</a>:</h4>
<p><span class="user-mention" data-user-id="695664">@Tarek Sander</span> what's the problem with sharing IDs if they're opaque to the wasm guest?</p>



<a name="429948252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429948252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429948252">(Mar 27 2024 at 20:58)</a>:</h4>
<p>The thing about <code>wgpu-core</code> IDs is that they can be explicitly set on resource creation by the client, I don't know if an ID being already used is handled, I don't think so. So the easiest option is to go to the <code>wgpu-hal</code> level where there are  no IDs and let <code>wgpu-core</code> on top assign IDs like it wants to.</p>



<a name="429948533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429948533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429948533">(Mar 27 2024 at 21:00)</a>:</h4>
<p>Not totally following, are you saying that we should build directly on top of wgpu-hal?</p>



<a name="429949861"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429949861" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429949861">(Mar 27 2024 at 21:09)</a>:</h4>
<p>No, I say we should <em>provide</em> a wgpu HAL.</p>



<a name="429950014"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429950014" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429950014">(Mar 27 2024 at 21:10)</a>:</h4>
<p>You mean 'hal-like', right?</p>



<a name="429950833"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429950833" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429950833">(Mar 27 2024 at 21:16)</a>:</h4>
<p>Yeah, that level also has to be the same as the WebGPU bindings in <code>wgpu</code>, since WebGPU has no mention of IDs either.</p>



<a name="429951044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429951044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429951044">(Mar 27 2024 at 21:17)</a>:</h4>
<p>Right.<br>
So I think that's what we're doing already, we don't expose any IDs to the wasm guest, only resources/types.</p>



<a name="429951481"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/429951481" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#429951481">(Mar 27 2024 at 21:20)</a>:</h4>
<p>Then I think we should be fine isolation-wise. Configuring a sandbox where you can still access the GPU is a nightmare, at least when I tried doing it on Android. Each driver implementation can use different system calls with different ioctls and device file paths, it's not good to manage with something like seccomp filters. And the host-API to WASM was supposed to be the replacement to sandboxing anyways, if the API is secure, you don't need an additional sandbox.</p>



<a name="431500592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/431500592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#431500592">(Apr 05 2024 at 11:06)</a>:</h4>
<p>Hey y'all, <span class="user-mention" data-user-id="270639">@Deian Stefan</span> - a security researcher - will likely be able to provide feedback here.</p>



<a name="433902011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/433902011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#433902011">(Apr 18 2024 at 01:51)</a>:</h4>
<p>Just had a conversation with <span class="user-mention" data-user-id="270639">@Deian Stefan</span>, here's what I learned:</p>
<p>level 1 security:<br>
On a very basic level, the shader bounds check and the wasmtime resource isolation should be enough.</p>
<p>Level 2 security:<br>
However, gpu driver code is often unsafe and buggy, so for any real world use case we'd wanna isolate the gpu into it's own process. Just like browsers do.</p>
<p>Level 3 security:<br>
Once we have process isolation, we should consider even further restrictions with seccomp.</p>
<p>Level 4 security:<br>
Browsers have runtime checks that they do on the gpu code. We should see if we can steel or replicate that.</p>
<p>He also told me to ask Tal Garfinkel for his opinion on the matter.</p>
<p>Helpful link from Chromium team: <a href="https://chromium.googlesource.com/chromium/src/+/main/docs/security/research/graphics/webgpu_technical_report.md">https://chromium.googlesource.com/chromium/src/+/main/docs/security/research/graphics/webgpu_technical_report.md</a></p>
<p>He also brought up the point that GPUs often don't do a good job isolating code, especially the older ones and there's not much we can do about that. It's a risk browsers have to accept as well.</p>
<p><span class="user-mention" data-user-id="270639">@Deian Stefan</span> hope I didn't butcher any of your points.</p>



<a name="433952474"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/433952474" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#433952474">(Apr 18 2024 at 06:39)</a>:</h4>
<p>The APIs <code>wgpu</code> is built upon have extensions for robust buffer access extensions, which ensures the driver handles out-of-bounds shader accesses: <a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/html/chap47.html#features-robustBufferAccess">Vulkan</a> <a href="https://registry.khronos.org/OpenGL/extensions/KHR/KHR_robust_buffer_access_behavior.txt">GL</a>. The GL extension is also used to secure WebGL in browsers AFAIK. Depending on security paranoia, you could refuse running webgpu code without these extensions.</p>
<p>Process sandboxes are tricky if you really want to drop as much privileges as you can. E.g. Chromium on Linux has a setuid <code>chromium-sandbox</code> binary, because you need root to change the process's namespaces, user and filesystem root. I wanted to build a sandbox library for Rust before, but I just couldn't find any information on how to do process sandboxing on Windows. I guess replicating/using the <a href="https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/sandbox/">chromium</a> or <a href="https://searchfox.org/mozilla-central/source/security/sandbox">Firefox</a> sandbox is the best bet.</p>
<p>Seccomp is only available on Linux and Android, I don't know if other platforms have a way to restrict system calls.</p>



<a name="433952731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/433952731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#433952731">(Apr 18 2024 at 06:42)</a>:</h4>
<p>An <code>--unsafe-webgpu</code> flags like browsers had for the early days of WebGPU implementations is also an option until all the sandboxing is implemented. If you're just running your own code in WASM and just use it for easy cross-platform deployment, sandboxing is not an issue.</p>



<a name="434009107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434009107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434009107">(Apr 18 2024 at 09:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="695664">Tarek Sander</span> <a href="#narrow/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC/near/433952474">said</a>:</p>
<blockquote>
<p>The APIs <code>wgpu</code> is built upon have extensions for robust buffer access extensions, which ensures the driver handles out-of-bounds shader accesses: <a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/html/chap47.html#features-robustBufferAccess">Vulkan</a> <a href="https://registry.khronos.org/OpenGL/extensions/KHR/KHR_robust_buffer_access_behavior.txt">GL</a>. The GL extension is also used to secure WebGL in browsers AFAIK. Depending on security paranoia, you could refuse running webgpu code without these extensions.</p>
<p>Process sandboxes are tricky if you really want to drop as much privileges as you can. E.g. Chromium on Linux has a setuid <code>chromium-sandbox</code> binary, because you need root to change the process's namespaces, user and filesystem root. I wanted to build a sandbox library for Rust before, but I just couldn't find any information on how to do process sandboxing on Windows. I guess replicating/using the <a href="https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/sandbox/">chromium</a> or <a href="https://searchfox.org/mozilla-central/source/security/sandbox">Firefox</a> sandbox is the best bet.</p>
<p>Seccomp is only available on Linux and Android, I don't know if other platforms have a way to restrict system calls.</p>
</blockquote>
<p>just ask! I'll find the windows person who knows and get you the answers if you want them.</p>



<a name="434016839"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434016839" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434016839">(Apr 18 2024 at 10:35)</a>:</h4>
<p><span class="user-mention" data-user-id="268586">@Ralph</span> I guess my question is about the permission system in Windows in general: How are the permissions of a process determined? How granular can you change them? The only documentation I can find is about the high level stuf like group policies or the Windows sandbox feature that just runs Windows inside a VM. The <a href="https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/docs/design/sandbox.md">chromium page</a> gives a good overview, but has not much links the the Microsoft documentation (if any exists).</p>



<a name="434017140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434017140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434017140">(Apr 18 2024 at 10:37)</a>:</h4>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights">https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights</a> is one place</p>
<div class="message_embed"><a class="message_embed_image" href="https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/3ce17f2b2911dcb735720cc46e75758679339053\/68747470733a2f2f6c6561726e2e6d6963726f736f66742e636f6d2f656e2d75732f6d656469612f6f70656e2d67726170682d696d6167652e706e67)"></a><div class="data-container"><div class="message_embed_title"><a href="https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights" title="Process Security and Access Rights - Win32 apps">Process Security and Access Rights - Win32 apps</a></div><div class="message_embed_description">The Microsoft Windows security model enables you to control access to process objects. For more information about security, see Access-Control Model.</div></div></div>



<a name="434017285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434017285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434017285">(Apr 18 2024 at 10:38)</a>:</h4>
<p>however, I'm not yet sure that's what you're looking for.</p>



<a name="434017384"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434017384" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434017384">(Apr 18 2024 at 10:38)</a>:</h4>
<p>the windows lead I know lives in EDT, so we can chat with him about 3 pm or so CET</p>



<a name="434018114"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434018114" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434018114">(Apr 18 2024 at 10:43)</a>:</h4>
<p>That link looks promising, at has links to the security architecture of Windows in general. Detailed information would be great! Last I checked there was no Rust process sandboxing library that supported Windows, so maybe the sandboxing solution we'll need could also benefit other projects as a library.</p>



<a name="434018217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434018217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434018217">(Apr 18 2024 at 10:44)</a>:</h4>
<p>yeah, the windows peeps would know: they're all about rust these days</p>



<a name="434018228"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434018228" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434018228">(Apr 18 2024 at 10:44)</a>:</h4>
<p>which, good</p>



<a name="434119193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434119193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434119193">(Apr 18 2024 at 15:28)</a>:</h4>
<p>I browsed the sandbox tag on <a href="http://crates.io">crates.io</a> again now and yep, none of the crates seem to support Windows.</p>
<div class="message_embed"><a class="message_embed_image" href="http://crates.io" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/75f8c66509c680a2345cca9b6adaf7e2cdb6f41b\/68747470733a2f2f6372617465732e696f2f6173736574732f6f672d696d6167652e706e67)"></a><div class="data-container"><div class="message_embed_title"><a href="http://crates.io" title="crates.io: Rust Package Registry">crates.io: Rust Package Registry</a></div></div></div>



<a name="434122051"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434122051" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434122051">(Apr 18 2024 at 15:32)</a>:</h4>
<p>Would y'all have a preference for the data format for IPC between the processes? If not I'd make a flexbuffers crate with strict bounds checks, the validation is sadly only in the C++ lib and even validation doesn't help in case we use a shared memory buffer, where the compromised side could change the offsets anytime.</p>



<a name="434127746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434127746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434127746">(Apr 18 2024 at 15:40)</a>:</h4>
<p>Is there a reason for flexbuffers instead of flatbuffers? I imagine you'd be generating the IPC code from the Wit definitions, so you'll know all the types of everything up front.</p>



<a name="434155962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434155962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434155962">(Apr 18 2024 at 16:04)</a>:</h4>
<p>I'd like the sandbox library to be independent of WASI (so there is finally one that support Windows in the ecosystem), and I don't think flatbuffers would work with serde, as there's no schema with that. I could make a flatbuffers compiler that uses strict bounds checks, but integrating with serde is a better goal than support for flatbuffer schemas IMO.</p>



<a name="434161018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434161018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434161018">(Apr 18 2024 at 16:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="268586">Ralph</span> <a href="#narrow/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC/near/434018217">said</a>:</p>
<blockquote>
<p>yeah, the windows peeps would know: they're all about rust these days</p>
</blockquote>
<p>Which is why it surprises me that there is no sandbox library with support for Windows. Maybe I'm just bad at searching, but I haven't found one, y'all can look too if you want, maybe you're better at searching than me.</p>



<a name="434163993"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434163993" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434163993">(Apr 18 2024 at 16:09)</a>:</h4>
<p>I'm using "y'all" as a non-notifying replacement for something like @all by the way, I don't know of a better term.</p>



<a name="434165216"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434165216" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434165216">(Apr 18 2024 at 16:10)</a>:</h4>
<p>I have also looked in the past, and not found any.</p>



<a name="434185266"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434185266" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434185266">(Apr 18 2024 at 16:25)</a>:</h4>
<p>I think if you're using flatbuffers, then you just wouldn't use serde. Remoting a WebGPU API doesn't depend on serializing arbitrary user types, or serializing to arbitrary formats, so the main strengths of serde wouldn't apply.</p>



<a name="434188214"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434188214" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434188214">(Apr 18 2024 at 16:27)</a>:</h4>
<p>It sounds like there are multiple possible goals here. If you're interested in building a Windows sandboxing library, you're certainly welcome to build that. That said, I don't think that's a critical path for wasi-gfx per se.</p>



<a name="434190038"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434190038" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434190038">(Apr 18 2024 at 16:29)</a>:</h4>
<p>I've asked a windows distinguished arch to point me to the logical solutions/information about this are, per this conversation. Let's see what he says relative to Windows.</p>



<a name="434192373"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434192373" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434192373">(Apr 18 2024 at 16:30)</a>:</h4>
<p>I agree with that Dan. I certainly see the argument and value of process sandboxing like in a web browser,  and how the wasi-gfx standard should allow for that use case, but I don’t think that needs to be a requirement or part of the core</p>



<a name="434194443"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434194443" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434194443">(Apr 18 2024 at 16:32)</a>:</h4>
<p>It'd be long before my library would be finished anyways.</p>
<p><span class="user-mention silent" data-user-id="254083">Dan Gohman</span> <a href="#narrow/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC/near/434188214">said</a>:</p>
<blockquote>
<p>It sounds like there are multiple possible goals here. If you're interested in building a Windows sandboxing library, you're certainly welcome to build that. That said, I don't think that's a critical path for wasi-gfx per se.</p>
</blockquote>
<p>I agree that library doesn't belong in this subgroup specifically, but hopefully that could be adopted as an optional layer of security in wasmtime or the wasi implementation, because such an undertaking should not be done by just one person anyways. With more WASI proposals, process sandboxing may be necessary for more proposals than this for adequate security. Should I ask in <a class="stream" data-stream-id="206238" href="/#narrow/stream/206238-general">#general</a> about thoughts for a sandboxing library/layer?</p>



<a name="434194581"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434194581" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434194581">(Apr 18 2024 at 16:32)</a>:</h4>
<p>There is already a lot of implicit trust in host-side code in the wasi ecosystem (although to Deian’s point, GPU drivers may be buggier than average), so it feels like that decision should be left up to the implementer</p>



<a name="434195797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434195797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Isom <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434195797">(Apr 18 2024 at 16:33)</a>:</h4>
<p>Yeah, that makes sense to me. I see this being more generic of a problem than just for gpu processes</p>



<a name="434199882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434199882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434199882">(Apr 18 2024 at 16:38)</a>:</h4>
<p>So for now if this proposal lands in wasmtime, at least the webgpu implementation (the raw framebuffer and window access would still be useful, there are CPU drawing libraries aplenty) should be gated behind a disabled-by-default enable_unsafe_webgpu config field. The host can enable it, but it signifies that the code is trusted, at least to the extent of running it on the GPU.</p>



<a name="434217234"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434217234" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434217234">(Apr 18 2024 at 18:30)</a>:</h4>
<p>Definitely should be up to the implementer and not part of the actual spec.<br>
I think Deian’s point was that most implementations that run untrusted code will <strong>want</strong> it, so we should have it in mind when designing the spec.</p>



<a name="434232517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434232517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434232517">(Apr 18 2024 at 20:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="268586">Ralph</span> <a href="#narrow/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC/near/434190038">said</a>:</p>
<blockquote>
<p>I've asked a windows distinguished arch to point me to the logical solutions/information about this are, per this conversation. Let's see what he says relative to Windows.</p>
</blockquote>
<p><a href="https://github.com/microsoft/windows-rs/blob/master/crates/libs/sys">https://github.com/microsoft/windows-rs/blob/master/crates/libs/sys</a> is the answer, possibly, says the windows dude.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/microsoft/windows-rs/blob/master/crates/libs/sys" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/09ccd0546a789f360cc6a38328a5e16af482a821\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f313462623935616662623734623838643436353732313462363830333631356332343435323766383130363963356630356439363366383938626633613564302f6d6963726f736f66742f77696e646f77732d7273)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/microsoft/windows-rs/blob/master/crates/libs/sys" title="windows-rs/crates/libs/sys at master · microsoft/windows-rs">windows-rs/crates/libs/sys at master · microsoft/windows-rs</a></div><div class="message_embed_description">Rust for Windows. Contribute to microsoft/windows-rs development by creating an account on GitHub.</div></div></div>



<a name="434233774"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434233774" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434233774">(Apr 18 2024 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="695664">@Tarek Sander</span> the windows team is interested in finding you what you need here. They think they've got all win32 sdk apis in the windows-sys crate, but they wanna know, if there's something <em>specific</em> you're expecting to find, and they can make it easier, let me know.</p>



<a name="434234984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434234984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434234984">(Apr 18 2024 at 20:42)</a>:</h4>
<p>they mention:</p>



<a name="434235034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434235034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434235034">(Apr 18 2024 at 20:42)</a>:</h4>
<p>Windows doesn't exactly do seccomp. You can do things like it by restricting priveleges, creating a process with a limited token, etc...</p>
<p>And there is the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setprocessmitigationpolicy">SetProcessMitigationPolicy function (processthreadsapi.h) - Win32 apps | Microsoft Learn</a></p>
<p>SetProcessMitigationPolicy function (processthreadsapi.h) - Win32 apps</p>
<p>Sets a mitigation policy for the calling process. Mitigation policies enable a process to harden itself against various types of attacks.</p>
<p>Its just not as granular or clean as Linux.</p>
<div class="message_embed"><a class="message_embed_image" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setprocessmitigationpolicy" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/3ce17f2b2911dcb735720cc46e75758679339053\/68747470733a2f2f6c6561726e2e6d6963726f736f66742e636f6d2f656e2d75732f6d656469612f6f70656e2d67726170682d696d6167652e706e67)"></a><div class="data-container"><div class="message_embed_title"><a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setprocessmitigationpolicy" title="SetProcessMitigationPolicy function (processthreadsapi.h) - Win32 apps">SetProcessMitigationPolicy function (processthreadsapi.h) - Win32 apps</a></div><div class="message_embed_description">Sets a mitigation policy for the calling process. Mitigation policies enable a process to harden itself against various types of attacks.</div></div></div>



<a name="434235091"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434235091" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434235091">(Apr 18 2024 at 20:43)</a>:</h4>
<p>again, if you have specific questions, lemme know and I'll find the correct resource</p>



<a name="434250258"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/425165-wasi-gfx/topic/Isolation%20and%20IPC/near/434250258" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tarek Sander <a href="https://bytecodealliance.github.io/zulip-archive/stream/425165-wasi-gfx/topic/Isolation.20and.20IPC.html#434250258">(Apr 18 2024 at 22:46)</a>:</h4>
<p>I was asking more about the process tokens themselves, and generally access control of resources, essentially what I'd need to implement what's described for the <a href="https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/docs/design/sandbox.md">chromium sandbox</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>