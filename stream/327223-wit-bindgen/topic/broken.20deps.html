<html>
<head><meta charset="utf-8"><title>broken deps · wit-bindgen · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/index.html">wit-bindgen</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html">broken deps</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="396351967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396351967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396351967">(Oct 12 2023 at 19:30)</a>:</h4>
<p>If there are any wit-bindgen repo maintainers around, <code>main</code> is currently broken due to incompatible deps: <a href="https://github.com/bytecodealliance/wit-bindgen/pull/698">https://github.com/bytecodealliance/wit-bindgen/pull/698</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/pull/698" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/c6e7fc51e877c6f20ee29560933b2747a1c13aa5\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f383765616266343532346635633339343934376139346538626163636631663535346465643866306264643338633130636465636235376330643437316638302f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f70756c6c2f363938)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/pull/698" title="chore: bump workspace dependencies to make wit-bindgen compile by morenol · Pull Request #698 · bytecodealliance/wit-bindgen">chore: bump workspace dependencies to make wit-bindgen compile by morenol · Pull Request #698 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">Fixes #697</div></div></div>



<a name="396354412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396354412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396354412">(Oct 12 2023 at 19:48)</a>:</h4>
<p>merged</p>



<a name="396358506"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396358506" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396358506">(Oct 12 2023 at 20:19)</a>:</h4>
<p>One more tweak needed, apparently: <a href="https://github.com/bytecodealliance/wit-bindgen/pull/700">https://github.com/bytecodealliance/wit-bindgen/pull/700</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/pull/700" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/0e160a02515f38b4d9a31d2c8522155b79d4e8df\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f343132323135393932633065623135626461396433303033306561643532376565653462313364353866393466343537646338333039623864306533633634312f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f70756c6c2f373030)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/pull/700" title="chore: update `wasm-metadata` dep by dicej · Pull Request #700 · bytecodealliance/wit-bindgen">chore: update `wasm-metadata` dep by dicej · Pull Request #700 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">This is a follow-up to #698 to make all the versions line up, given that wit-component 0.14.6 depends on wasm-metadata 0.10.8.</div></div></div>



<a name="396380750"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396380750" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396380750">(Oct 12 2023 at 23:22)</a>:</h4>
<p>Merged</p>



<a name="396894468"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396894468" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396894468">(Oct 16 2023 at 12:43)</a>:</h4>
<p>Should it be surprising to us that these incompatible versions made it through CI?</p>



<a name="396905815"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396905815" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396905815">(Oct 16 2023 at 13:41)</a>:</h4>
<p>Unfortunately no it's not surprising because the wasm-tools repo itself was always "self consistent" since everything is tested against itself. The problem is that the wit-component released bumped its dependency on wit-parser from 0.11 to 0.12, and so downstream applications that used wit-component 0.14 and wit-parser 0.11, the prior latest, all of a sudden would no longer compile due to the version mismatch in wit-parser. Effectively downstream applications had no way of depending on the latest correctly.</p>
<p>One possible way to catch this on CI would be to have automatic validation that a minor version bump is indeed a minor bump, but I'm not sure if such tooling in Rust has progressed to that point.</p>



<a name="396913347"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396913347" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396913347">(Oct 16 2023 at 14:17)</a>:</h4>
<p>Right, but I'm thinking about <code>wit-bindgen</code>'s CI. Based on <a href="https://github.com/bytecodealliance/wit-bindgen/issues/697">https://github.com/bytecodealliance/wit-bindgen/issues/697</a> it appears that <code>wit-bindgen-rust</code> became unbuildable when the wit-component dep was bumped.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/issues/697" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/8840b17a04be0e54a76097affca36a1023f1c1e5\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f303735383461323862393435396632323165303133313664333766363934316165343730396538653834663830333466663565306234386531623336373839642f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f363937)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/issues/697" title="`wit-bindgen-rust` failing to compile · Issue #697 · bytecodealliance/wit-bindgen">`wit-bindgen-rust` failing to compile · Issue #697 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">Beginning this morning wit-bindgen-rust is failing to compile for me. This happens when my only dependency is wit-bindgen and it happens with both version 0.11.0 and 0.12.0 of that crate. Seems lik...</div></div></div>



<a name="396916732"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396916732" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396916732">(Oct 16 2023 at 14:32)</a>:</h4>
<p>oh <code>wit-bindgen</code> would have caught it I think if there were a PR or something, but this is a publication of <code>wit-component</code> that broke preexisting <code>wit-bindgen</code> so I'm not sure there's much that could be done about that</p>



<a name="396917516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/396917516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#396917516">(Oct 16 2023 at 14:36)</a>:</h4>
<p>ah thanks; I had been under the vague impression that the breakage was caused by a dep change in wit-bindgen, but that makes sense</p>



<a name="397197981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397197981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397197981">(Oct 17 2023 at 23:51)</a>:</h4>
<p>Would it be worth it to write some E2E tests that run from places like <code>wit-component</code> -- I'd love to take this on if so.</p>
<p>The simplest version, adding tests to <code>wit-component</code> (since that's where things actually broke) that build it locally and use it in concert with downstream stuff. We could limit these tests to release PRs only (or even PRs with semver minor changes).</p>
<p>A slightly more complex version of this would be creating an <code>e2e-tests</code>/<code>ecosystem-tests</code>/<code>ecosystem-stability</code> repo that is triggerable from other actions -- some upstream dep can provide a version/git SHA/etc and be compiled in/used from a supported use case/build process.</p>
<p>I personally like the second approach (I could also create it without much upstreaming initially until the prototype is ready/complete), because I think it would be a good place to point people for examples and a (possibly generated!) support matrix.</p>



<a name="397304279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397304279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397304279">(Oct 18 2023 at 12:42)</a>:</h4>
<p>I believe <span class="user-mention" data-user-id="477605">@Kyle Brown</span> has been working on some sort of similar test suite.</p>



<a name="397328453"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397328453" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397328453">(Oct 18 2023 at 14:40)</a>:</h4>
<p>I think it'd be reasonable to have such tests, yeah, but I'm not sure how they would be integrated in to the release process for wasm-tools</p>



<a name="397360298"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397360298" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robin Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397360298">(Oct 18 2023 at 17:54)</a>:</h4>
<p>I've done some design and prototyping for a Guest Language test suite but haven't had time to work on it lately. The design document can be found here: <a href="https://hackmd.io/qeVkBYYWQ1C1uiKYk-HzZw">https://hackmd.io/qeVkBYYWQ1C1uiKYk-HzZw</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://hackmd.io/qeVkBYYWQ1C1uiKYk-HzZw" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/b37ce5483ca5f88093e39486a76c6a2b768cd6a5\/68747470733a2f2f6861636b6d642e696f2f696d616765732f6d656469612f4861636b4d442d6f672e6a7067)"></a><div class="data-container"><div class="message_embed_title"><a href="https://hackmd.io/qeVkBYYWQ1C1uiKYk-HzZw" title="Guest Language Test Suite - HackMD">Guest Language Test Suite - HackMD</a></div><div class="message_embed_description">or</div></div></div>



<a name="397457921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397457921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397457921">(Oct 19 2023 at 08:40)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="477605">@Kyle Brown</span>! Taking a look at what you have, I think it's <em>slightly</em> different from what I want to build -- I want tests that are guest language independent -- basically testing the <em>tooling</em> that is being produced. It's less of a conformance suite (forgive me if I misread your intent there!) and more of a have-a-machine-make-sure-everything-works repo, along with a place we can point new people for setups that work (ex. <em>exactly</em> which adapter version, with exactly which release of <code>wasmtime</code>, etc.)</p>
<p>Likely these tests will have a very large matrix, so we can know which combinations of versions of which tooling work together, essentially. </p>
<p>The way I'm envisioning it is that it's a repo with as much up-to-date information as possible on what works together, possibly automatically updated, <em>and</em> other repos could <a href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow">trigger workflows on it</a> to test downstream usability.</p>
<p>Alternativley, the primary output of the crate might even be a Github Action, that's callable from other projects -- but the basic point is to start from near nothing (as a downstream user with) and use the tooling in the ecosystem at various versions.</p>
<div class="message_embed"><a class="message_embed_image" href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/9584cd39a683b9a4afc1c82dcfd92b6f7dc45189\/68747470733a2f2f6769746875622e6769746875626173736574732e636f6d2f696d616765732f6d6f64756c65732f6f70656e5f67726170682f6769746875622d6c6f676f2e706e67)"></a><div class="data-container"><div class="message_embed_title"><a href="https://docs.github.com/en/actions/using-workflows/triggering-a-workflow" title="Triggering a workflow - GitHub Docs">Triggering a workflow - GitHub Docs</a></div><div class="message_embed_description">How to automatically trigger GitHub Actions workflows</div></div></div>



<a name="397458400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397458400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397458400">(Oct 19 2023 at 08:43)</a>:</h4>
<p>It's probably easier to show rather than tell, so I'll try to put something together and show that</p>



<a name="397531531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/broken%20deps/near/397531531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/broken.20deps.html#397531531">(Oct 19 2023 at 15:37)</a>:</h4>
<p>ah yeah if you've got a proof-of-concept that'd be great to look at!</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>