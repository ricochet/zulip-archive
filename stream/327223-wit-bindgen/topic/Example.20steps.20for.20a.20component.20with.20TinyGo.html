<html>
<head><meta charset="utf-8"><title>Example steps for a component with TinyGo · wit-bindgen · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/index.html">wit-bindgen</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html">Example steps for a component with TinyGo</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="428438399"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/428438399" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> adam <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#428438399">(Mar 23 2024 at 03:17)</a>:</h4>
<p>Hey. Following along the instructions at <a href="https://github.com/bytecodealliance/wit-bindgen?tab=readme-ov-file#guest-tinygo">https://github.com/bytecodealliance/wit-bindgen?tab=readme-ov-file#guest-tinygo</a></p>
<p>I'm not sure how to tinygo build if my-component.go is using package main, because then I can't access the wit-bindgen generated Go types in the package matching the interface name in my wit file. I'm using wit-bindgen to generate in the same directory as my-component.go, even though the example uses a subdirectory called gen. Am I supposed to generate the subpackage and install it in $GOPATH and resolve with a full repository/module url?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen?tab=readme-ov-file#guest-tinygo" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/ea3b94af8d16079aa0b69d30dae0644345d945db\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f366635363166326630636438363738383239616533356461653130643063366534336362383462363763393737313263643665303430653363373964346536642f62797465636f6465616c6c69616e63652f7769742d62696e6467656e)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen?tab=readme-ov-file#guest-tinygo" title="GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types">GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types</a></div><div class="message_embed_description">A language binding generator for WebAssembly interface types - bytecodealliance/wit-bindgen</div></div></div>



<a name="428441556"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/428441556" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> adam <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#428441556">(Mar 23 2024 at 04:02)</a>:</h4>
<p>Got it working by treating it like a separate Go package. Derp.</p>



<a name="429168323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/429168323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Randy Reddig <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#429168323">(Mar 24 2024 at 07:52)</a>:</h4>
<p>We’re working on pure Go bindings for TinyGo: <a href="https://github.com/ydnar/wasm-tools-go">https://github.com/ydnar/wasm-tools-go</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/ydnar/wasm-tools-go" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/0cbb3e8525726261c2ba1737fcfbe95a36164850\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f316662363332376262313233336530306461396434303730313030613563323539613066386231633964626464383561386261383137333639666338626136622f79646e61722f7761736d2d746f6f6c732d676f)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/ydnar/wasm-tools-go" title="GitHub - ydnar/wasm-tools-go: WebAssembly + Component Model tools for Go">GitHub - ydnar/wasm-tools-go: WebAssembly + Component Model tools for Go</a></div><div class="message_embed_description">WebAssembly + Component Model tools for Go. Contribute to ydnar/wasm-tools-go development by creating an account on GitHub.</div></div></div>



<a name="429168669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/429168669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Randy Reddig <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#429168669">(Mar 24 2024 at 07:55)</a>:</h4>
<p>Currently it can generate Go bindings for imports, but not (yet) exports. It maps WIT types to their equivalent Go types where possible (e.g. enum-&gt;constants, records-&gt;structs, resources-&gt;handle types with methods).</p>



<a name="430613061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/430613061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rajat Jindal <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#430613061">(Apr 01 2024 at 15:35)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="639636">@Randy Reddig</span> , I was trying out this binding generator, and ran into a issue. it is quite possible that it is due to WIP support for exports in wasm-tools-go, in which case I apologize to waste your time in advance:</p>
<p>foo.wit</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">interface</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">greet</span>: <span class="nc">func</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>from running <code>wasm-tools component wit ./foo-wit -j &gt; wit.json</code></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="s">"name"</span>: <span class="s">"foo"</span><span class="p">,</span>
<span class="w">      </span><span class="s">"types"</span>: <span class="p">{},</span>
<span class="w">      </span><span class="s">"functions"</span>: <span class="p">{</span>
<span class="w">        </span><span class="s">"greet"</span>: <span class="p">{</span>
<span class="w">          </span><span class="s">"name"</span>: <span class="s">"greet"</span><span class="p">,</span>
<span class="w">          </span><span class="s">"kind"</span>: <span class="s">"freestanding"</span><span class="p">,</span>
<span class="w">          </span><span class="s">"params"</span>: <span class="p">[],</span>
<span class="w">          </span><span class="s">"results"</span>: <span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">              </span><span class="s">"type"</span>: <span class="s">"string"</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="s">"package"</span>: <span class="mi">7</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>Then on trying to build using tinygo (using branch from here: <a href="https://github.com/dgryski/tinygo/tree/dgryski/wasi-preview-2">https://github.com/dgryski/tinygo/tree/dgryski/wasi-preview-2</a>):</p>
<p><code>tinygo build -target=wasip2 -wit-package ./foo-wit -wit-world foo-namespace:pkg/foo-world -o main.wasm -x -work main.go</code></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">module</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="mi">0</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">decode</span><span class="w"> </span><span class="n">world</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">module</span>
<span class="w">    </span><span class="mi">1</span>: <span class="nc">module</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">valid</span>
<span class="w">    </span><span class="mi">2</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">validate</span><span class="w"> </span><span class="n">exported</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="err">`</span><span class="n">foo</span><span class="o">-</span><span class="n">namespace</span>:<span class="nc">pkg</span><span class="o">/</span><span class="n">foo</span><span class="o">@</span><span class="mf">2.0.0</span><span class="err">`</span>
<span class="w">    </span><span class="mi">3</span>: <span class="nc">type</span><span class="w"> </span><span class="n">mismatch</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">greet</span><span class="err">`</span>: <span class="nc">expected</span><span class="w"> </span><span class="err">`</span><span class="p">[]</span><span class="w"> </span>-&gt; <span class="p">[</span><span class="n">I32</span><span class="p">]</span><span class="err">`</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">`</span><span class="p">[</span><span class="n">I32</span><span class="p">,</span><span class="w"> </span><span class="n">I32</span><span class="p">]</span><span class="w"> </span>-&gt; <span class="p">[]</span><span class="err">`</span>
<span class="n">error</span>: <span class="nc">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>
<p>On trying to use <code>wasm-tools</code> to check the intermediary wasm file:</p>
<p>from running: <code>wasm-tools mutate /var/folders/5r/6y6fr12x1dq6qnt74zn4_1wm0000gn/T/tinygo226195887/main -t | grep -i greet | head -1</code>:</p>
<p>(Notice the <code>param i32 i32</code>, I was expecting it to be something like <code>(param i32) (result i32)</code></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">  </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="cp">$foo</span><span class="o">-</span><span class="n">namespace</span>:<span class="nc">pkg</span><span class="o">/</span><span class="n">foo</span><span class="o">@</span><span class="mf">2.0.0</span>#<span class="n">greet</span><span class="w"> </span><span class="p">(;</span><span class="mi">259</span><span class="p">;)</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="kt">i32</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span>
</code></pre></div>
<p>The repo where I was trying this out is here: <a href="https://github.com/rajatjindal/foo-wasip2">https://github.com/rajatjindal/foo-wasip2</a></p>
<p>is it possibly by any chance to workaround this prob or should I wait for <code>wasm-tools-go</code> to have complete exports support.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/dgryski/tinygo/tree/dgryski/wasi-preview-2" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/61cf0681afd9e3e8ccb559564a271685f6bd1115\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f653761366537333731353630346438346261343164656435623835666164623165376435363133373138383534336261616466646330393165623034343364312f64677279736b692f74696e79676f)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/dgryski/tinygo/tree/dgryski/wasi-preview-2" title="GitHub - dgryski/tinygo at dgryski/wasi-preview-2">GitHub - dgryski/tinygo at dgryski/wasi-preview-2</a></div><div class="message_embed_description">Go compiler for small places. Microcontrollers, WebAssembly, and command-line tools. Based on LLVM. - GitHub - dgryski/tinygo at dgryski/wasi-preview-2</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/rajatjindal/foo-wasip2" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/5ed104c3cf5d7030254811046b9a79960c94c8a1\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f633134333062363836323931323464363239636261663462333030383932353839646437376663363036636535323337623730656163613437303563656334622f72616a61746a696e64616c2f666f6f2d776173697032)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rajatjindal/foo-wasip2" title="GitHub - rajatjindal/foo-wasip2">GitHub - rajatjindal/foo-wasip2</a></div><div class="message_embed_description">Contribute to rajatjindal/foo-wasip2 development by creating an account on GitHub.</div></div></div>



<a name="430622180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/430622180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Randy Reddig <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#430622180">(Apr 01 2024 at 16:24)</a>:</h4>
<p>Exports aren’t working yet</p>



<a name="430622181"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/430622181" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Randy Reddig <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#430622181">(Apr 01 2024 at 16:24)</a>:</h4>
<p>You can write them by hand with //export in TinyGo</p>



<a name="430622182"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/430622182" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Randy Reddig <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#430622182">(Apr 01 2024 at 16:24)</a>:</h4>
<p>with the fully-qualified namespace:package/interface#function name</p>



<a name="430623279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/430623279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rajat Jindal <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#430623279">(Apr 01 2024 at 16:29)</a>:</h4>
<p>thank you for your reply. I did try that, but still got same error (tried with both with <code>init</code> and without it):</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">foo</span>

<span class="k">type</span> <span class="nc">Impl</span><span class="w"> </span><span class="k">struct</span><span class="p">{}</span>

<span class="c1">//export foo-namespace:pkg/foo@2.0.0#greet</span>
<span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="n">Impl</span><span class="p">)</span><span class="w"> </span><span class="n">Greet</span><span class="p">()</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"hello from greet"</span>
<span class="p">}</span>

<span class="n">func</span><span class="w"> </span><span class="n">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Impl</span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div>



<a name="431184034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431184034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mossaka (Joe) <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431184034">(Apr 03 2024 at 22:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="703445">adam</span> <a href="#narrow/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo/near/428438399">said</a>:</p>
<blockquote>
<p>Hey. Following along the instructions at <a href="https://github.com/bytecodealliance/wit-bindgen?tab=readme-ov-file#guest-tinygo">https://github.com/bytecodealliance/wit-bindgen?tab=readme-ov-file#guest-tinygo</a></p>
<p>I'm not sure how to tinygo build if my-component.go is using package main, because then I can't access the wit-bindgen generated Go types in the package matching the interface name in my wit file. I'm using wit-bindgen to generate in the same directory as my-component.go, even though the example uses a subdirectory called gen. Am I supposed to generate the subpackage and install it in $GOPATH and resolve with a full repository/module url?</p>
</blockquote>
<p>In the latest release of <code>wit-bindgen-cli</code>, I've included a flag to rename the package name of generated Go code to an user provided one. Hope that helps</p>
<p>e.g. </p>
<p><code>wit-bindgen tiny-go wasi-http/wit --world proxy --rename-package=test</code></p>



<a name="431187682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431187682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mossaka (Joe) <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431187682">(Apr 03 2024 at 22:25)</a>:</h4>
<p>I made some modification to the README and updated the example code: <a href="https://github.com/bytecodealliance/wit-bindgen/pull/921">https://github.com/bytecodealliance/wit-bindgen/pull/921</a></p>
<p>Hopefully it should clarify things a bit :)</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/pull/921" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/3d13899b7e0b6d73b3960ad04cc72cca605a6b85\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f363365333937626630353339386566636234386164383438363161653463643862383663656533303638356363666131633131326466393162346561633731312f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f70756c6c2f393231)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/pull/921" title="docs: make the Go section of the readme clearer by Mossaka · Pull Request #921 · bytecodealliance/wit-bindgen">docs: make the Go section of the readme clearer by Mossaka · Pull Request #921 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">adds a command to initialize the Go directory and repalces Pirnt to HostPrint in the eample code.</div></div></div>



<a name="431189516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431189516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> adam <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431189516">(Apr 03 2024 at 22:39)</a>:</h4>
<p>I think in my case I didn't have a valid golang module. Do you know why components compiled with TinyGo are 10-12 times smaller than compiled Rust components? Also, if I compiled a golang function with TinyGo that just adds two numbers, why does it need to have all the WASI imports in the component for a full fledge application?</p>
<p>A single line fn that just uses s32 and mod operator has all these imports. Filesystem and Stdio seem unnecessary.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">root</span>:<span class="nc">component</span><span class="p">;</span>

<span class="n">world</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">io</span><span class="o">/</span><span class="n">error</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">io</span><span class="o">/</span><span class="n">streams</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">cli</span><span class="o">/</span><span class="n">stdin</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">cli</span><span class="o">/</span><span class="n">stdout</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">cli</span><span class="o">/</span><span class="n">stderr</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">clocks</span><span class="o">/</span><span class="n">wall</span><span class="o">-</span><span class="n">clock</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">filesystem</span><span class="o">/</span><span class="n">types</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">wasi</span>:<span class="nc">filesystem</span><span class="o">/</span><span class="n">preopens</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">is</span><span class="o">-</span><span class="n">odd</span><span class="o">-</span><span class="n">or</span><span class="o">-</span><span class="n">even</span>: <span class="nc">func</span><span class="p">(</span><span class="n">number</span>: <span class="nc">s32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>



<a name="431189794"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431189794" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Randy Reddig <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431189794">(Apr 03 2024 at 22:41)</a>:</h4>
<p>You’ve got it partially right. The function signature of the export needs to match what’s in the WIT.</p>
<p>Are you using <code>wit-bindgen</code> or <code>wit-bindgen-go</code>?</p>
<p><span class="user-mention silent" data-user-id="646597">Rajat Jindal</span> <a href="#narrow/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo/near/430623279">said</a>:</p>
<blockquote>
<p>thank you for your reply. I did try that, but still got same error (tried with both with <code>init</code> and without it):</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">foo</span>

<span class="k">type</span> <span class="nc">Impl</span><span class="w"> </span><span class="k">struct</span><span class="p">{}</span>

<span class="c1">//export foo-namespace:pkg/foo@2.0.0#greet</span>
<span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="n">Impl</span><span class="p">)</span><span class="w"> </span><span class="n">Greet</span><span class="p">()</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"hello from greet"</span>
<span class="p">}</span>

<span class="n">func</span><span class="w"> </span><span class="n">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Impl</span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="431239049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431239049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rajat Jindal <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431239049">(Apr 04 2024 at 07:13)</a>:</h4>
<blockquote>
<p>Are you using <code>wit-bindgen</code> or <code>wit-bindgen-go</code>?</p>
</blockquote>
<p>I am trying out wit-bindgen-go</p>



<a name="431279734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431279734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rajat Jindal <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431279734">(Apr 04 2024 at 10:30)</a>:</h4>
<p>thank you for the pointer. i was able to fix that by changing def to:</p>
<div class="codehilite" data-code-language="Go"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">foo</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">instance</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">Impl</span><span class="p">{}</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">Impl</span><span class="w"> </span><span class="kd">struct</span><span class="p">{}</span>

<span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">*</span><span class="nx">Impl</span><span class="p">)</span><span class="w"> </span><span class="nx">Greet</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"hello from greet"</span>
<span class="p">}</span>

<span class="c1">//export foo-namespace:pkg/foo@2.0.0#greet</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">GreetExported</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">instance</span><span class="p">.</span><span class="nx">Greet</span><span class="p">()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">x</span>
<span class="p">}</span>
</code></pre></div>
<p>this atleast get post the <code>export error</code> i was getting earlier.</p>



<a name="431360124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Example%20steps%20for%20a%20component%20with%20TinyGo/near/431360124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rajat Jindal <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Example.20steps.20for.20a.20component.20with.20TinyGo.html#431360124">(Apr 04 2024 at 16:51)</a>:</h4>
<p>I tried implementing the export bindings for response-outparam (for inbound-http), but that seemed quite involved. I will try it again over the weekend.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>