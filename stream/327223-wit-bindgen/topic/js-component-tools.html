<html>
<head><meta charset="utf-8"><title>js-component-tools · wit-bindgen · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/index.html">wit-bindgen</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html">js-component-tools</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="326491423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/326491423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#326491423">(Feb 08 2023 at 01:46)</a>:</h4>
<p>Been playing around with js-component-tools to interact with wasm components.  The js that is produced from transpilation seems to be making an attempt to import from packages that I don't believe I have access to.  Is there a way that one is able to access these imports?  Here are the import statements that appear to be problematic.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering3Callee</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">'</span><span class="na">wasi</span><span class="o">-</span><span class="n">exit</span><span class="o">'</span><span class="p">;</span>
<span class="n">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">dropInputStream</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering0Callee</span><span class="p">,</span><span class="w"> </span><span class="n">dropOutputStream</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering1Callee</span><span class="p">,</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering5Callee</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">'</span><span class="na">wasi</span><span class="o">-</span><span class="n">io</span><span class="o">'</span><span class="p">;</span>
<span class="n">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering4Callee</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">'</span><span class="na">print</span><span class="o">'</span><span class="p">;</span>
<span class="n">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering8Callee</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">'</span><span class="na">wasi</span><span class="o">-</span><span class="n">stderr</span><span class="o">'</span><span class="p">;</span>
<span class="n">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering2Callee</span><span class="p">,</span><span class="w"> </span><span class="n">writeViaStream</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering6Callee</span><span class="p">,</span><span class="w"> </span><span class="n">appendViaStream</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lowering7Callee</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">'</span><span class="na">wasi</span><span class="o">-</span><span class="n">filesystem</span><span class="o">'</span><span class="p">;</span>
</code></pre></div>



<a name="326595744"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/326595744" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#326595744">(Feb 08 2023 at 14:06)</a>:</h4>
<p>I believe the CLI should have various options to map these to different imports or local files, but I don't know the names of the options off-hand myself</p>



<a name="326629489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/326629489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#326629489">(Feb 08 2023 at 16:21)</a>:</h4>
<p>Thanks!  I'll try looking into that</p>



<a name="326847915"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/326847915" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#326847915">(Feb 09 2023 at 15:42)</a>:</h4>
<p>So I see how to use the cli options to map to local files and things... but are there recommended implementations of these things to point to locally from this js setting?</p>



<a name="329274300"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/329274300" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eduardo Rodrigues <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#329274300">(Feb 21 2023 at 19:29)</a>:</h4>
<p>You can find a shim (that implements the most basic functionality) for this here: <a href="https://github.com/bytecodealliance/jco/tree/main/packages/preview2-shim">https://github.com/bytecodealliance/jco/tree/main/packages/preview2-shim</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/tree/main/packages/preview2-shim" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/80d0a3505d935e43e896e4a90948ef9df89277e8\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f306261626135383862313630616332326432306133633664633939616131353762346433333761663531656231383366623138383161636339303232356639342f62797465636f6465616c6c69616e63652f6a636f)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/tree/main/packages/preview2-shim" title="jco/packages/preview2-shim at main · bytecodealliance/jco">jco/packages/preview2-shim at main · bytecodealliance/jco</a></div><div class="message_embed_description">JavaScript tooling for working with WebAssembly Components - jco/packages/preview2-shim at main · bytecodealliance/jco</div></div></div>



<a name="329485631"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/329485631" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#329485631">(Feb 22 2023 at 17:20)</a>:</h4>
<p><span class="user-mention" data-user-id="506572">@Eduardo Rodrigues</span> Thanks!  great to know.  Will have to tinker a bit with providing the shim implementations to the transpiled js now</p>



<a name="329488299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/329488299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#329488299">(Feb 22 2023 at 17:31)</a>:</h4>
<p>After some more experimentation, I noticed that when using the mapping flag to point to the local shim, that the import paths seem to be relative to the transpiled js file.  Found the easiest way to make things work was to copy/paste the shim into the generated js, so as to avoid referencing file paths outside of the generated code.  Would it be helpful to include the shim in the transpilation output? Or to make the possibility configurable?</p>



<a name="329488810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/329488810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#329488810">(Feb 22 2023 at 17:33)</a>:</h4>
<p>If it's helpful, I could open a PR</p>



<a name="329588642"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/js-component-tools/near/329588642" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eduardo Rodrigues <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/js-component-tools.html#329588642">(Feb 22 2023 at 21:22)</a>:</h4>
<p>I agree is a little bit annoying, but we probably need to wait for more implementation coverage as well as stabilization of the WASI preview2 definition.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>