<html>
<head><meta charset="utf-8"><title>✔ module requires import named `__wbindgen_placeholder__` · wit-bindgen · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/index.html">wit-bindgen</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html">✔ module requires import named `__wbindgen_placeholder__`</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="403720309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403720309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403720309">(Nov 23 2023 at 05:54)</a>:</h4>
<p>When building my component with <code>wasm-tools component new</code>, I get an error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">module</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="err">`</span><span class="n">__wbindgen_placeholder__</span><span class="err">`</span>
</code></pre></div>
<p>This only occurs when I include a local crate as a dependency (and use it).<br>
I'm not sure what part of this dependency is causing this issue, but the dependency itself has nothing to do with wasm, and is just a regular rust crate.</p>
<p>From digging into the code of wasm bindgen, it seems like <code>__wbindgen_placeholder__</code> is supposed to get replaced with something, however in my case it isn't?</p>



<a name="403721649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403721649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403721649">(Nov 23 2023 at 06:04)</a>:</h4>
<p>Sorry it doesn't work, here's the current output:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="err">❯</span><span class="w"> </span><span class="n">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasi</span><span class="o">/</span><span class="n">release</span><span class="o">/</span><span class="n">game</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">game</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">--</span><span class="n">adapt</span><span class="w"> </span><span class="p">.</span><span class="o">/../../../</span><span class="n">thalo</span><span class="o">-</span><span class="n">rs</span><span class="o">/</span><span class="n">thalo</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">thalo_cli</span><span class="o">/</span><span class="n">wasi_snapshot_preview1</span><span class="p">.</span><span class="n">wasm</span>
<span class="n">error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">module</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="mi">0</span>: <span class="nc">module</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="err">`</span><span class="n">__wbindgen_placeholder__</span><span class="err">`</span>
</code></pre></div>



<a name="403723239"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403723239" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403723239">(Nov 23 2023 at 06:21)</a>:</h4>
<p>This indicates that wasm bindgen is being used but that's not compatible with components so the only fix will be to figure out what's depending on wasm bindgen and to either update or remove that dependency</p>



<a name="403723854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403723854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403723854">(Nov 23 2023 at 06:28)</a>:</h4>
<p>That's strange, it would make sense however when I do <code>cargo tree -p game</code> or <code>cargo tree -i wasm-bindgen</code>, it's not a dependency of the <code>game</code> wasm component being generated.</p>
<p>It is a dependency used within the cargo workspace I'm in, but I don't think that should import wasm bindgen</p>



<a name="403724218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403724218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403724218">(Nov 23 2023 at 06:32)</a>:</h4>
<p><a href="/user_uploads/15107/jKPnV8pJ5qsz8u8jESpeOHl_/output.txt">output.txt</a></p>



<a name="403724258"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403724258" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403724258">(Nov 23 2023 at 06:32)</a>:</h4>
<p>I've just posted the output of running <code>cargo tree -p game</code></p>



<a name="403732608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403732608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403732608">(Nov 23 2023 at 07:40)</a>:</h4>
<p>Ah I forgot to do <code>--target wasm32-wasi</code> when creating the tree! Looks like the <code>bson</code> crate was the issue, using wasm-bindgen.</p>



<a name="403732617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403732617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403732617">(Nov 23 2023 at 07:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="474928">Ari Seyhun</span> has marked this topic as resolved.</p>



<a name="403734507"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/%E2%9C%94%20module%20requires%20import%20named%20%60__wbindgen_placeholder__%60/near/403734507" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ari Seyhun <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/.E2.9C.94.20module.20requires.20import.20named.20.60__wbindgen_placeholder__.60.html#403734507">(Nov 23 2023 at 07:53)</a>:</h4>
<p><a href="https://github.com/mongodb/bson-rust/issues/441">https://github.com/mongodb/bson-rust/issues/441</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/mongodb/bson-rust/issues/441" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/d213bca62b03bbd3490af6cb85f9a9f35c5b74f2\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f343431366331623330336235653138323966353933633439396461363231643962383063613965346365646161373534336336633663643731366639353833632f6d6f6e676f64622f62736f6e2d727573742f6973737565732f343431)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/mongodb/bson-rust/issues/441" title="`js-sys` should not be used when targeting `wasm32-wasi` · Issue #441 · mongodb/bson-rust">`js-sys` should not be used when targeting `wasm32-wasi` · Issue #441 · mongodb/bson-rust</a></div><div class="message_embed_description">Describe the bug js-sys brings in wasm-bindgen when targeting wasm32 architechture. However, wasm32-wasi targets should not use js-sys not wasm-bindgen. The cargo toml should be updated to be somet...</div></div></div>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>