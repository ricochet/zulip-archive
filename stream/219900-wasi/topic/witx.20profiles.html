<html>
<head><meta charset="utf-8"><title>witx profiles · wasi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html">witx profiles</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="195605164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195605164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195605164">(Apr 28 2020 at 18:16)</a>:</h4>
<p>one thing that has come up a few times, including in the last wasi call, is that witx is able to describe the type signatures of modules that a wasi executable may import, but it doesnt describe 1. what the requirements for a module to export are, which is required to specify reactors like proxy-wasm, and 2. which modules in particular are available for import, which will be useful once there are multiple modules being considered</p>



<a name="195605703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195605703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195605703">(Apr 28 2020 at 18:21)</a>:</h4>
<p>so im going to work on an addition to witx that is a <code>(profile $identifier ...)</code> which allows you to specify export functions  &amp; memory using the same syntax as modules do, and use <code>(import $modulename)</code> to specify that an import is available</p>



<a name="195605726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195605726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195605726">(Apr 28 2020 at 18:21)</a>:</h4>
<p>it should be pretty straightforward, and i hope that it will be useful. I plan to use it in lucet immediately, but ideally it would be useful by others as well.</p>



<a name="195605798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195605798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195605798">(Apr 28 2020 at 18:21)</a>:</h4>
<p>one idea i had that makes it nontrivial (and wouldnt be part of the initial implementation) is that one desirable profile we might specify is a module which makes multiple wasi snapshots available for import</p>



<a name="195605954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195605954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195605954">(Apr 28 2020 at 18:23)</a>:</h4>
<p>currently, because snapshot 0 and 1 use the same typenames in the global scope, we cant do a <code>(use ...)</code> of both snapshots into the same .witx doc so they can both be included in a profile</p>



<a name="195606088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195606088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195606088">(Apr 28 2020 at 18:24)</a>:</h4>
<p>so this may end up being a forcing function for a suggestion i made a long time ago, which is to introduce scopes to witx somehow, so that theres some hierarchy besides one big top-level scope.</p>



<a name="195606184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195606184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195606184">(Apr 28 2020 at 18:24)</a>:</h4>
<p>i don't have any strong ideas for how to do that, its a bit of a bikeshed</p>



<a name="195606340"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195606340" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195606340">(Apr 28 2020 at 18:25)</a>:</h4>
<p>i'd welcome feedback and suggestions on how to do that, and anything else related to profiles.</p>



<a name="195613172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613172">(Apr 28 2020 at 19:20)</a>:</h4>
<p>one thing that's initially unclear to me is what motivates <code>profile</code>, rather than using <code>export</code> to indicate things you can import from and <code>import</code> to indicate things you're supposed to export</p>



<a name="195613374"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613374" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613374">(Apr 28 2020 at 19:22)</a>:</h4>
<p><code>profile</code> is really for a world in which you have specified a significant number of modules in witx, and want a way to express what subset of them you actually support</p>



<a name="195613536"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613536" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613536">(Apr 28 2020 at 19:24)</a>:</h4>
<p>ah, makes sense. I think I just misread your comment :-}</p>



<a name="195613563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613563">(Apr 28 2020 at 19:24)</a>:</h4>
<p>it also allows us to decouple executables and reactors specifications from import module specifications. if we added <code>export "_start"</code> to the existing wasi snapshot 1 module today, that raises the question of how a reactor uses that</p>



<a name="195613577"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613577" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613577">(Apr 28 2020 at 19:24)</a>:</h4>
<p>and where that export belongs in ephemeral</p>



<a name="195613601"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613601" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613601">(Apr 28 2020 at 19:25)</a>:</h4>
<p>do you mean <code>import</code> there?</p>



<a name="195613638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613638">(Apr 28 2020 at 19:25)</a>:</h4>
<p>yes, thats what i meant, sorry</p>



<a name="195613643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613643">(Apr 28 2020 at 19:25)</a>:</h4>
<p>We already have an <code>import</code> for "memory", and I agree adding a witx description of <code>_start</code> and now <code>_initialize</code> makes sense</p>



<a name="195613650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613650">(Apr 28 2020 at 19:25)</a>:</h4>
<p>cool</p>



<a name="195613819"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613819" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613819">(Apr 28 2020 at 19:27)</a>:</h4>
<p>yes, we should retain the import of memory in every module which requires it (i expect this is all of them until interface types lands)</p>



<a name="195613856"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195613856" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195613856">(Apr 28 2020 at 19:27)</a>:</h4>
<p>but i guess you could theoretically have some witx-specified module that just sends atoms back and forth and doesnt need to share memory.</p>



<a name="195614888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195614888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195614888">(Apr 28 2020 at 19:36)</a>:</h4>
<p>wasi_ephemeral_sched.witx totally doesn't need memory <span aria-label="clown" class="emoji emoji-1f921" role="img" title="clown">:clown:</span></p>



<a name="195614958"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195614958" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195614958">(Apr 28 2020 at 19:36)</a>:</h4>
<p>hmm yeah maybe only modules that use @witx pointer and const_pointer actually <em>need</em> it</p>



<a name="195756857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195756857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195756857">(Apr 29 2020 at 19:14)</a>:</h4>
<p>ive turned this into a PR</p>



<a name="195756860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195756860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195756860">(Apr 29 2020 at 19:14)</a>:</h4>
<p><a href="https://github.com/WebAssembly/WASI/pull/267" title="https://github.com/WebAssembly/WASI/pull/267">https://github.com/WebAssembly/WASI/pull/267</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/WASI/pull/267" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/WASI/pull/267" title="Introduce witx profiles by pchickey · Pull Request #267 · WebAssembly/WASI">Introduce witx profiles by pchickey · Pull Request #267 · WebAssembly/WASI</a></div><div class="message_embed_description">Prior to this patch, a witx file describes a collection of interfaces that a module can import. However, we don&#39;t have a way to describe completely[1] what a module must export, or which of man...</div></div></div>



<a name="195757047"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195757047" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195757047">(Apr 29 2020 at 19:16)</a>:</h4>
<p>initially i allowed <code>(export (memory))</code> to be specified in a <code>profile</code>, but i realized that this requirement is already covered by  the <code>(import (memory))</code> of the modules available for import. So, I decided that profiles are just a collection of <code>(import $modulename)</code> and <code>(@interface func (export "funcname") &lt;func type information&gt;)</code>.</p>



<a name="195759249"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195759249" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195759249">(Apr 29 2020 at 19:32)</a>:</h4>
<p>awesome, I'll take a look later today</p>



<a name="195772439"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/witx%20profiles/near/195772439" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/witx.20profiles.html#195772439">(Apr 29 2020 at 21:27)</a>:</h4>
<p>initial comments posted!</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>