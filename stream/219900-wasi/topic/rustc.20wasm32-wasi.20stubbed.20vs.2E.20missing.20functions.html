<html>
<head><meta charset="utf-8"><title>rustc wasm32-wasi stubbed vs. missing functions · wasi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html">rustc wasm32-wasi stubbed vs. missing functions</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="192295022"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192295022" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192295022">(Mar 30 2020 at 18:04)</a>:</h4>
<p>Some of our users have been struggling with figuring out whether or not a particular crate is good to go on wasm32-wasi. Much of that is due to crates that build/link native code, but some of it is also the fact that some of the functions in <code>std</code> are present but panic when called. I'm wondering just how bad an idea it'd be to omit the functions we don't support, rather than having them fail at runtime, so that these would be compile-time failures instead?</p>



<a name="192298576"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298576" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298576">(Mar 30 2020 at 18:32)</a>:</h4>
<p><span class="user-mention" data-user-id="253993">@acfoltzer</span> this is definitely a topic of historical hot debate in rust</p>



<a name="192298604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298604">(Mar 30 2020 at 18:32)</a>:</h4>
<p>it's unfortunately a pretty tricky one though</p>



<a name="192298628"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298628" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298628">(Mar 30 2020 at 18:32)</a>:</h4>
<p>the short answer is that this wouldn't be easily done, but it's certainly possible</p>



<a name="192298676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298676">(Mar 30 2020 at 18:33)</a>:</h4>
<p>this'd be something to bring up w/ the libs team or on users.r-l.o</p>



<a name="192298683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298683">(Mar 30 2020 at 18:33)</a>:</h4>
<p>most likely</p>



<a name="192298888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298888">(Mar 30 2020 at 18:34)</a>:</h4>
<p>thanks. yeah, I figured there was some story about it. I'm guessing the horse is probably out of the barn but I'll poke around a bit further</p>



<a name="192298921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192298921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192298921">(Mar 30 2020 at 18:35)</a>:</h4>
<p>I've already poked one hornet's nest with FFI-unwind, not sure I'm up for another one until that's resolved :)</p>



<a name="192301461"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301461" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301461">(Mar 30 2020 at 18:55)</a>:</h4>
<p><span class="user-mention" data-user-id="253993">@acfoltzer</span> do you have an idea of what sort of apis folks are most surprised don't work?</p>



<a name="192301487"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301487" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301487">(Mar 30 2020 at 18:55)</a>:</h4>
<p>like is it all one set of APIs? or is it basically a smattering all over?</p>



<a name="192301544"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301544" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301544">(Mar 30 2020 at 18:55)</a>:</h4>
<p>I think it's mostly the one in <code>Thread::new()</code>, where a library spins up a worker thread or something</p>



<a name="192301562"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301562" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301562">(Mar 30 2020 at 18:55)</a>:</h4>
<p>they're not really encountering it in code they write directly</p>



<a name="192301675"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301675" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301675">(Mar 30 2020 at 18:56)</a>:</h4>
<p>or something tries to get its threadid</p>



<a name="192301713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301713">(Mar 30 2020 at 18:56)</a>:</h4>
<p>ah ok makes sense</p>



<a name="192301724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301724">(Mar 30 2020 at 18:56)</a>:</h4>
<p>we can probably fix the threadid thing</p>



<a name="192301743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301743">(Mar 30 2020 at 18:56)</a>:</h4>
<p><code>Thread::new()</code> is pretty fundamental though :(</p>



<a name="192301747"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301747" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301747">(Mar 30 2020 at 18:56)</a>:</h4>
<p>(we are still on 1.40.0 for WASI snapshot reasons, so this may be out of date feedback)</p>



<a name="192301832"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/rustc%20wasm32-wasi%20stubbed%20vs.%20missing%20functions/near/192301832" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> acfoltzer <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/rustc.20wasm32-wasi.20stubbed.20vs.2E.20missing.20functions.html#192301832">(Mar 30 2020 at 18:57)</a>:</h4>
<p>yeah definitely. probably don't want to mess with that one till coroutines land</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>