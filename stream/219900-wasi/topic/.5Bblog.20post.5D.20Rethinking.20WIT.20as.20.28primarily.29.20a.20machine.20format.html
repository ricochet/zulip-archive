<html>
<head><meta charset="utf-8"><title>[blog post] Rethinking WIT as (primarily) a machine format · wasi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html">[blog post] Rethinking WIT as (primarily) a machine format</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="403000857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403000857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403000857">(Nov 19 2023 at 11:15)</a>:</h4>
<p>Hey all, I wrote a (short) post today about WIT, and how a change in how we expect people to interact with it may change the way we evaluate design tradeoffs. I've talked with some folks about this over the past few weeks, and I figured it might be interesting to write my thoughts down for others to read too.</p>
<p><a href="https://blog.yoshuawuyts.com/rethinking-wit-as-a-machine-format/">Rethinking WIT as (primarily) a machine format</a></p>



<a name="403001173"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403001173" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403001173">(Nov 19 2023 at 11:18)</a>:</h4>
<p>(In case anyone is worried about the post prior to reading it: I'm not pressing for any immediate calls to action in this post. It's mostly musings about perspectives and how a reframing might lead us to evaluate decisions differently. None of this should be directly relevant to our ongoing Preview 2 sprint.)</p>



<a name="403001274"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403001274" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403001274">(Nov 19 2023 at 11:19)</a>:</h4>
<p>On a meta-note: is this a good channel to post things like this? I figured this was directly relevant to the component model and this felt like the best channel for that?</p>



<a name="403007212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403007212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403007212">(Nov 19 2023 at 12:43)</a>:</h4>
<p><span class="user-mention" data-user-id="344849">@Yoshua Wuyts</span> thank you for writing this, and sharing it here! <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>
<p>For some historical context, I originally started pushing for a richer syntax for WIT because I came to the conclusion that it'd be too highly visible for any foreseeable future for s-expressions to be sufficient. I strongly believe that structured syntax is important for usability of any text format that is read by humans to a meaningful degree—in particular if the people producing and consuming it aren't necessarily deep experts in the system behind the format.</p>
<p>Based on that, I don't agree with <em>your framing</em> of WIT as (primarily) a machine format. However! I entirely agree with everything you say in the post about how the ecosystem should ideally develop. In particular, deep integration of Components into existing workflows, ecosystems, and platforms are without a doubt crucial to the component model being successful. For that reason I very much like the term "meta-ecosystem" for what we're building with Components and component tooling: we should have a layer of tooling that is low-level and language-/platform-agnostic enough to layer on top of in ways that work well for as many language and platform workflows as possible. Producing and consuming components should indeed feel no different from producing and consuming artifacts, modules, etc that are native to the respective ecosystem.</p>
<p>In practice that means when using Rust, having as workspace of components that can be linked together should feel the same as having a workspace of (non-component) crates as much as possible. Same for JS and npm, Python and PyPI, Ruby and Gems, etc. And yes, I agree that that should as much as possible mean that when in Rust, you should write Rust and a WIT file should be derived from that, and same for JS and <code>d.ts</code> files, etc.</p>
<p>Your example of auto-generating interfaces for different languages as part of component docs is something we've long wanted to have, and I strongly believe it should be a key part of warg registries: you should be able to set as a global flag what language to show all interface docs in, and what package manager to use in showing instructions for how to add a component as a dependency, etc.</p>
<p>And I think we're in pretty good shape for all of this. Restrictions like kebap-case-plus-acronyms are meant just for this, as is the requirement to name return values if there's more than one of them. I think the one key thing we're missing from WIT right now to make this work as well as possible is to define a structure for doc comments that will enable us to convert them into language-native doc comments with high quality.</p>



<a name="403007442"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403007442" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403007442">(Nov 19 2023 at 12:47)</a>:</h4>
<p>so why am I saying that I disagree with the title? Because of what I mentioned at the beginning: I believe that for any foreseeable future too many people will be exposed to WIT directly for us to not treat human producers/consumers as a first-class concern for the format. I think it needs to be both: a human-readable format, but with enough structure enforced to derive other formats with highest fidelity. And I also don't think these requirements are at odds with each other. A key reason is that we don't have to do things like optimize for size or processing speed. And we can afford to make it a little more complicated to write good tooling, if that's what's required to retain some property that's only useful for humans. We always have the isomorphic binary encoding that can be fully optimized for machines</p>



<a name="403009390"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403009390" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403009390">(Nov 19 2023 at 13:16)</a>:</h4>
<p>(reading what you wrote here)</p>



<a name="403009399"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403009399" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403009399">(Nov 19 2023 at 13:17)</a>:</h4>
<p>heh, yeah I guess the title was the part of the post I was least sure about</p>



<a name="403012342"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403012342" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403012342">(Nov 19 2023 at 13:58)</a>:</h4>
<p>(got a phone call mid-reading the comments; continuing now)</p>



<a name="403012435"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403012435" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403012435">(Nov 19 2023 at 14:00)</a>:</h4>
<p>Heh, okay read it all</p>



<a name="403012452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403012452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403012452">(Nov 19 2023 at 14:00)</a>:</h4>
<p>Yeah I basically agree with everything you wrote</p>



<a name="403012477"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403012477" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403012477">(Nov 19 2023 at 14:00)</a>:</h4>
<p>I feel like maybe the title of my post is somewhat at odds with the actual content of it?</p>



<a name="403012867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403012867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403012867">(Nov 19 2023 at 14:05)</a>:</h4>
<blockquote>
<p>I strongly believe that structured syntax is important for usability of any text format that is read by humans to a meaningful degree—in particular if the people producing and consuming it aren't necessarily deep experts in the system behind the format.</p>
</blockquote>
<p>This makes a lot of sense to me. Having used WinMD for the <code>windows-rs</code> project; I'm so glad WIT is actually easy to understand by humans. Needing to load <a href="https://github.com/icsharpcode/ILSpy">ILSpy</a> to do even the most basic introspection into WinMD definitions really didn't feel good. And I'm glad we didn't take that path!</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/icsharpcode/ILSpy" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/240b7d277549888d8d45fa10953830cf348bf97e\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f613838393864653463316365323965623739353663633362396236303530663865383834333166336663396262613232323637646232333462333934656633342f69637368617270636f64652f494c537079)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/icsharpcode/ILSpy" title="GitHub - icsharpcode/ILSpy: .NET Decompiler with support for PDB generation, ReadyToRun, Metadata (&amp;more) - cross-platform!">GitHub - icsharpcode/ILSpy: .NET Decompiler with support for PDB generation, ReadyToRun, Metadata (&amp;more) - cross-platform!</a></div><div class="message_embed_description">.NET Decompiler with support for PDB generation, ReadyToRun, Metadata (&amp;more) - cross-platform! - GitHub - icsharpcode/ILSpy: .NET Decompiler with support for PDB generation, ReadyToRun, Metada...</div></div></div>



<a name="403013607"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403013607" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403013607">(Nov 19 2023 at 14:12)</a>:</h4>
<p>Or wait, I guess I wasn't decompiling <code>winmd</code> definitions directly - but using it to extract the definitions from shared libraries. That's not quite the same. Though I'm happy WIT is written with humans in mind nevertheless <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="403013975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403013975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403013975">(Nov 19 2023 at 14:16)</a>:</h4>
<p>Anyway, changed the title from "rethinking WIT" (implying a potential big change) to "reframing WIT" (merely a change of perspective). And I've added a clarifying note at the start of the post. I hope that will make the title be more in line with the actual post.</p>



<a name="403023710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403023710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403023710">(Nov 19 2023 at 15:48)</a>:</h4>
<p>To emphasize that again: I also basically agree with everything you wrote! I wanted to give some context on where WIT came from, why it has the shape it has, and what I personally believe is critically important about its function and how it functions. I guess to me the key part is that people generally associate "machine format" with "prioritizes ease of parsing and semantic (machine) analysis over human consumption", and that's the part I feel strongly mustn't be the case for WIT.</p>
<p>A recent example of where this comes into play is adding required semicolons. The initial motivation was to  make parsing easier, and I was against this change based on that motivation. However, <span class="user-mention" data-user-id="253998">@Luke Wagner</span> made the great point that semicolons also make it much much easier to extend the syntax later on—which makes them directly supportive of what I think should be the most important property</p>



<a name="403036082"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403036082" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403036082">(Nov 19 2023 at 17:49)</a>:</h4>
<p>I appreciate you adding context!</p>



<a name="403504415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403504415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403504415">(Nov 22 2023 at 02:45)</a>:</h4>
<p>Awesome blog post -- it was a great read, I really like the idea of bridging that UX gap between WIT and the code by making WIT code-driven. It's really exciting to think about and I think it maps pretty cleanly in Rust to one more more proc macros +/- <a href="http://build.rs">build.rs</a> stuff.</p>
<p>Maybe a reasonable first step to thinking about how this would work is gathering places where other IDLs went code-first, and trying to map the feature sets/matrix</p>
<blockquote>
<p>The other thing I think we should explore is a native wit-doc tool which can be used to render WIT definitions to HTML. My thinking is that this should be modeled loosely after rustdoc or Swift's DocC. </p>
</blockquote>
<p>Are you aware of  <a href="https://github.com/bytecodealliance/wit-bindgen/tree/main/crates/markdown"><code>wit-bindgen</code>'s markdown generator?</a></p>



<a name="403507526"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403507526" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403507526">(Nov 22 2023 at 03:07)</a>:</h4>
<p>.75 seconds of googling and there's <a href="https://learn.microsoft.com/en-us/aspnet/core/grpc/code-first?view=aspnetcore-8.0">ASP.NET's code-first gRPC</a>. I also remember some Java Spring stuff that was "code-first" (and painful) from a past life, but there are probably a bunch of other reasonable examples</p>
<div class="message_embed"><a class="message_embed_image" href="https://learn.microsoft.com/en-us/aspnet/core/grpc/code-first?view=aspnetcore-8.0" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/b391ffb5bbb07ec8f5a5d07ecf15c20cfdd88b70\/68747470733a2f2f6c6561726e2e6d6963726f736f66742e636f6d2f646f746e65742f6d656469612f646f746e65742d6c6f676f2e706e67)"></a><div class="data-container"><div class="message_embed_title"><a href="https://learn.microsoft.com/en-us/aspnet/core/grpc/code-first?view=aspnetcore-8.0" title="Code-first gRPC services and clients with .NET">Code-first gRPC services and clients with .NET</a></div><div class="message_embed_description">Learn the basic concepts when writing code-first gRPC with .NET.</div></div></div>



<a name="403541256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%5Bblog%20post%5D%20Rethinking%20WIT%20as%20%28primarily%29%20a%20machine%20format/near/403541256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.5Bblog.20post.5D.20Rethinking.20WIT.20as.20.28primarily.29.20a.20machine.20format.html#403541256">(Nov 22 2023 at 08:18)</a>:</h4>
<p>Oh I had not seen the markdown generator. That’s useful, thank you!</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>