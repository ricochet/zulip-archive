<html>
<head><meta charset="utf-8"><title>preview2 in wasmtime 10.0 release · wasi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html">preview2 in wasmtime 10.0 release</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="364067517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364067517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364067517">(Jun 06 2023 at 17:19)</a>:</h4>
<p>Hi folks - preview2 support will be available in the wasmtime-wasi crate as part of the 10.0 release, which was cut a few days ago and will be released on the 20th. however, there are known bugs in the implementation, and it is not ready for production use. So, despite being "on by default" in the cargo features, we are treating it like an off-by-default feature in that we wont be doing patch releases for bugs.</p>



<a name="364067616"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364067616" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364067616">(Jun 06 2023 at 17:20)</a>:</h4>
<p>same for the component adapter (though there are no known bugs in there at the moment)</p>



<a name="364068004"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364068004" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364068004">(Jun 06 2023 at 17:22)</a>:</h4>
<p>in general, since the preview2 definition is still a moving target (and wasmtime's use of preview2 doesn't have perfect fidelity with upstream in the standards repos yet) it will be difficult to treat preview2 support as stable, and provide api-compatible patches, until we finalize those definitions. we are hoping to settle those by the fall of this year.</p>



<a name="364068065"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364068065" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fitzgen (he/him) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364068065">(Jun 06 2023 at 17:22)</a>:</h4>
<p>it relies on component support right? which is off by default, so preview2 would also be off by default, right?</p>



<a name="364068074"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364068074" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364068074">(Jun 06 2023 at 17:22)</a>:</h4>
<p>but, please do start using it in non-production contexts and report bugs!</p>



<a name="364068203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364068203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364068203">(Jun 06 2023 at 17:22)</a>:</h4>
<p>it does, but the wasmtime-wasi crate will turn on the wasmtime crate's (off by default) component-model feature. components are still off by default in wasmtime::Config.</p>



<a name="364572379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364572379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> DougAnderson444 | PeerPiper.io <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364572379">(Jun 08 2023 at 14:02)</a>:</h4>
<p><span class="user-mention" data-user-id="253992">@Pat Hickey</span> is there a "Hello World" of the latest config and versions we could use as a starting point? One with both a Component and a Host using that component? Would go a long way as I know a bunch of us are still having trouble getting something up and running with all the changes. Thanks!</p>



<a name="364927312"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364927312" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364927312">(Jun 09 2023 at 17:40)</a>:</h4>
<p>the closest thing to a hello world at the moment is the contents of test-programs/tests/command.rs</p>



<a name="364927348"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/364927348" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#364927348">(Jun 09 2023 at 17:40)</a>:</h4>
<p>and building your guests according to test-programs/build.rs</p>



<a name="367966843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/367966843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Waye <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#367966843">(Jun 20 2023 at 15:22)</a>:</h4>
<p>not really related but does wasmtime 10.0. have wasm exception support?</p>



<a name="367967478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/367967478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#367967478">(Jun 20 2023 at 15:24)</a>:</h4>
<p>No, we haven't built that yet; it's quite a complex feature and relies on underlying support in the compiler (which, last I had heard, <span class="user-mention" data-user-id="264278">@bjorn3</span> was working on) as well</p>



<a name="367978269"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/367978269" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#367978269">(Jun 20 2023 at 15:57)</a>:</h4>
<p>I have the cranelift side working for aarch64. I won't be working on implementing it in wasmtime though. Adding support for working with exception tags and handling lowering of new control flow instructions in cranelift-wasm turned out to be a lot more involved than I thought. It is probably best if someone with more experience with wasmtime implements those things. I have implemented it in both cg_clif and cranelift-jit-demo and plan to work on them and then do the experiments for my thesis and after I'm done with my thesis I'm going to open a couple of PRs.</p>



<a name="367984132"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/preview2%20in%20wasmtime%2010.0%20release/near/367984132" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/preview2.20in.20wasmtime.2010.2E0.20release.html#367984132">(Jun 20 2023 at 16:14)</a>:</h4>
<p>very excited to see your work <span class="user-mention" data-user-id="264278">@bjorn3</span> !</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>