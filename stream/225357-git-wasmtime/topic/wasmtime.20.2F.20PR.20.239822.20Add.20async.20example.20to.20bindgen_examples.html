<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9822 Add async example to bindgen_examples · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html">wasmtime / PR #9822 Add async example to bindgen_examples</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="489002213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489002213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489002213">(Dec 14 2024 at 15:12)</a>:</h4>
<p><strong>ifsheldon</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<a name="489002214"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489002214" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489002214">(Dec 14 2024 at 15:12)</a>:</h4>
<p><strong>ifsheldon</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<a name="489002215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489002215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489002215">(Dec 14 2024 at 15:12)</a>:</h4>
<p>ifsheldon opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a> from <code>ifsheldon:async_example</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Closes #9776</p>
<p>I reused most of example 4 to avoid extra complication. Also adds a reference to code example <code>wasi_async</code>, so it'd better if this gets merged after #9788.</p>
<p>cc @alexcrichton </p>
</blockquote>



<a name="489268948"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489268948" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489268948">(Dec 16 2024 at 15:37)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2545955709">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>Thanks, and looks good to me! I think there's some errors on CI though?</p>
</blockquote>



<a name="489294234"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489294234" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489294234">(Dec 16 2024 at 17:19)</a>:</h4>
<p>ifsheldon <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2546203522">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>Can you take a look into the clippy error please? The error seems to originate from <code>bindgen!</code>. I suspect that some code in <code>bindgen!</code> forgets to import <code>Box</code> when a WIT spec is inlined. In my own example that imports from a WIT file, there's no problem. In the example 4 where async is not used, it's also fine. I have no clue why that happened. The difference between <code>_7_async.rs</code> and <code>_4_imported_resources.rs</code> is just the line <code>async: true,</code></p>
</blockquote>



<a name="489347790"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489347790" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489347790">(Dec 16 2024 at 21:34)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2546851949">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>Ah I believe this is exposing a preexisting bug in the <code>bindgen!</code> macro, notably the async output is not compatible with <code>#![no_std]</code> crates. The <code>wasmtime</code> crate itself is such a crate which is where this is coming from. </p>
<p>I'm not sure of a way to work around this other than fixing the issue at hand (tracking down the <code>Box</code> and importing it from <code>wasmtime::component::__internal::Box</code>)</p>
</blockquote>



<a name="489391221"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489391221" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489391221">(Dec 17 2024 at 02:41)</a>:</h4>
<p>ifsheldon <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2547381689">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>I think for the purpose of documentation, it's okay to let clippy skip this file. </p>
<blockquote>
<p>this is exposing a preexisting bug in the bindgen! macro, notably the async output is not compatible with #![no_std] crates. The wasmtime crate itself is such a crate which is where this is coming from.</p>
</blockquote>
<p>IIUC, #9823 maybe unblock this?</p>
<blockquote>
<p>I'm not sure of a way to work around this other than fixing the issue at hand </p>
</blockquote>
<p>Can you try to fix this please? I'm not very familiar proc_macros or bindgen internals.</p>
</blockquote>



<a name="489552111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489552111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489552111">(Dec 17 2024 at 18:56)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2549346706">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>Yes #9823 would probably help. Unfortunately I don't have time right now to fix this myself, and this can't land unless it's passing CI.</p>
</blockquote>



<a name="489608086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489608086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489608086">(Dec 18 2024 at 02:42)</a>:</h4>
<p>ifsheldon <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2550186976">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>OK...... Can you find the issue tracking the "preexisting bug" you mentioned? I can't find one to link here. Or, I can file a new one.</p>
</blockquote>



<a name="489821768"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489821768" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489821768">(Dec 18 2024 at 18:52)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2552046905">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>I don't believe there's a preexisting issue since this is I think the first time it's come up, but feel free to file an issue of course</p>
</blockquote>



<a name="489987335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/489987335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#489987335">(Dec 19 2024 at 15:26)</a>:</h4>
<p>ifsheldon <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2554611001">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>OK, let's take a step back. Why need to build bindgen_examples inside <code>wasmtime</code> anyway? I think we can just move all the bindgen examples out of <code>wasmtime</code> crate.</p>
</blockquote>



<a name="490058783"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490058783" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490058783">(Dec 19 2024 at 22:23)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2555876438">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>It's not necessarily strictly required, but it's quite useful to be distributed as part of <a href="http://docs.rs">docs.rs</a> integration. That gives nice API docs all in one place. Personally I think it'd probably be less effort to fix the code generation than it would be to move all the documentation somewhere else.</p>
</blockquote>



<a name="490180962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490180962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490180962">(Dec 20 2024 at 15:17)</a>:</h4>
<p>ifsheldon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<a name="490181542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490181542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490181542">(Dec 20 2024 at 15:20)</a>:</h4>
<p>ifsheldon <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2557207929">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>OK, fine. I made a new commit which fixes the bug of bindgen. I know I should have open another PR/issue but it seems I need to provide an example to reproduce the bug, which is this very example, so I think it's okay to just fix it in this PR.</p>
</blockquote>



<a name="490189834"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490189834" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490189834">(Dec 20 2024 at 16:04)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#issuecomment-2557281896">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>:</p>
<blockquote>
<p>Thanks! I think some test expectations may need an update, but otherwise looks good <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="490204218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490204218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490204218">(Dec 20 2024 at 17:35)</a>:</h4>
<p>ifsheldon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<a name="490205867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490205867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490205867">(Dec 20 2024 at 17:48)</a>:</h4>
<p>ifsheldon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<a name="490207540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490207540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490207540">(Dec 20 2024 at 18:01)</a>:</h4>
<p>ifsheldon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<a name="490219571"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490219571" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490219571">(Dec 20 2024 at 19:34)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9822#pullrequestreview-2518220088">PR review</a>.</p>



<a name="490221780"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239822%20Add%20async%20example%20to%20bindgen_examples/near/490221780" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239822.20Add.20async.20example.20to.20bindgen_examples.html#490221780">(Dec 20 2024 at 19:52)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9822">PR #9822</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>