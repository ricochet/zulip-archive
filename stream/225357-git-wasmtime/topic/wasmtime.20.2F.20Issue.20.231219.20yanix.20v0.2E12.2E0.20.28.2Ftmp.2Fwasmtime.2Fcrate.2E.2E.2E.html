<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1219 yanix v0.12.0 (/tmp/wasmtime/crate... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html">wasmtime / Issue #1219 yanix v0.12.0 (/tmp/wasmtime/crate...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189713651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189713651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189713651">(Mar 04 2020 at 17:22)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594678577" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594678577">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>okay, that very error already is underway to get fixed in <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">https://github.com/bytecodealliance/wasmtime/pull/1226</a></p>
</blockquote>



<a name="189722916"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189722916" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189722916">(Mar 04 2020 at 18:57)</a>:</h4>
<p>kubkon <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594751983" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594751983">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>Hey @stefson, thanks for the report. Could you do me a favour actually, and rebase onto #1226 and see if it indeed fixes the error (unless you've already done it of course)?</p>
</blockquote>



<a name="189724575"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189724575" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189724575">(Mar 04 2020 at 19:14)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594764921" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594764921">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>ok, so I git cloned your fork and did <code>git checkout yanix-error-cleanup</code>, followed by <code>cd crates/wasi-common/yanix</code> and cargo build. It turns out that with the commits you added plus my patch from above, there's a new error now: </p>
<div class="codehilite"><pre><span></span>cargo build --target armv7-unknown-linux-gnueabihf
   Compiling yanix v0.12.0 (/tmp/wasmtime/crates/wasi-common/yanix)
error[E0433]: failed to resolve: use of undeclared type or module `Errno`
   --&gt; crates/wasi-common/yanix/src/file.rs:247:23
    |
247 |     let offset: i64 = Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?.into();
    |                       ^^^^^ use of undeclared type or module `Errno`

error[E0277]: the trait bound `i32: std::convert::From&lt;i64&gt;` is not satisfied
  --&gt; crates/wasi-common/yanix/src/sys/linux/mod.rs:10:17
   |
10 |         Ok(Self(loc))
   |                 ^^^ the trait `std::convert::From&lt;i64&gt;` is not implemented for `i32`
   |
   = help: the following implementations were found:
             &lt;i32 as std::convert::From&lt;bool&gt;&gt;
             &lt;i32 as std::convert::From&lt;i16&gt;&gt;
             &lt;i32 as std::convert::From&lt;i8&gt;&gt;
             &lt;i32 as std::convert::From&lt;std::num::NonZeroI32&gt;&gt;
           and 2 others
   = note: required because of the requirements on the impl of `std::convert::Into&lt;i32&gt;` for `i64`

error: aborting due to 2 previous errors

Some errors have detailed explanations: E0277, E0433.
For more information about an error, try `rustc --explain E0277`.
error: could not compile `yanix`.
</pre></div>


<p>and I think that's due to you changing from Errno to Error in that line, right? </p>
</blockquote>



<a name="189725170"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189725170" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189725170">(Mar 04 2020 at 19:20)</a>:</h4>
<p>kubkon labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>git clone the repo, cd wasmtime/crates/wasi-common/yanix and execute cargo build fails with this beauty: </p>
<div class="codehilite"><pre><span></span>crates/wasi-common/yanix $ cargo build
    Updating crates.io index
  Downloaded cfg-if v0.1.10
  Downloaded thiserror v1.0.11
  Downloaded libc v0.2.67
  Downloaded log v0.4.8
  Downloaded bitflags v1.2.1
  Downloaded thiserror-impl v1.0.11
  Downloaded proc-macro2 v1.0.8
  Downloaded quote v1.0.2
  Downloaded unicode-xid v0.2.0
  Downloaded syn v1.0.15
   Compiling proc-macro2 v1.0.8
   Compiling unicode-xid v0.2.0
   Compiling syn v1.0.15
   Compiling bitflags v1.2.1
   Compiling libc v0.2.67
   Compiling log v0.4.8
   Compiling cfg-if v0.1.10
   Compiling quote v1.0.2
   Compiling thiserror-impl v1.0.11
   Compiling thiserror v1.0.11
   Compiling yanix v0.12.0 (/home/tim/wasmtime/crates/wasi-common/yanix)
error[E0308]: try expression alternatives have incompatible types
   --&gt; crates/wasi-common/yanix/src/file.rs:247:23
    |
247 |     let offset: i64 = Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?;
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |                       |
    |                       expected `i64`, found `i32`
    |                       help: you can convert an `i32` to `i64`: `Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?.into()`

error[E0277]: the trait bound `i32: std::convert::From&lt;i64&gt;` is not satisfied
  --&gt; crates/wasi-common/yanix/src/sys/linux/mod.rs:10:17
   |
10 |         Ok(Self(loc))
   |                 ^^^ the trait `std::convert::From&lt;i64&gt;` is not implemented for `i32`
   |
   = help: the following implementations were found:
             &lt;i32 as std::convert::From&lt;bool&gt;&gt;
             &lt;i32 as std::convert::From&lt;i16&gt;&gt;
             &lt;i32 as std::convert::From&lt;i8&gt;&gt;
             &lt;i32 as std::convert::From&lt;std::num::NonZeroI32&gt;&gt;
           and 2 others
   = note: required because of the requirements on the impl of `std::convert::Into&lt;i32&gt;` for `i64`

error: aborting due to 2 previous errors

Some errors have detailed explanations: E0277, E0308.
For more information about an error, try `rustc --explain E0277`.
error: could not compile `yanix`.
</pre></div>


<p>aarch64 seems fine. </p>
<p>rustc is v1.41.1 with llvm-9</p>
</blockquote>



<a name="189725375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189725375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189725375">(Mar 04 2020 at 19:22)</a>:</h4>
<p>kubkon <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594771893" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594771893">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>Yep, looks like it! So the general gist now is to re-use <code>std::io::Error</code> to spawn and wrap raw OS errno values instead of maintaining yet another mapping between errno values and some enum type. Anyhow, thanks for looking into it! After we land #1226, I'll be happy to help you out in weeding out any errors that might have left over.</p>
</blockquote>



<a name="189725561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189725561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189725561">(Mar 04 2020 at 19:24)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594773795" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594773795">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>ok, sweet, so here's the rebased patch for your branch, please simply add it if it's to your liking: </p>
<div class="codehilite"><pre><span></span>--- a/crates/wasi-common/yanix/src/file.rs
+++ b/crates/wasi-common/yanix/src/file.rs
@@ -244,6 +244,6 @@ pub unsafe fn fionread(fd: RawFd) -&gt; Result&lt;u32&gt; {
 /// This function is unsafe because it operates on a raw file descriptor.
 /// It&#39;s provided, because std::io::Seek requires a mutable borrow.
 pub unsafe fn tell(fd: RawFd) -&gt; Result&lt;u64&gt; {

-    let offset: i64 = Error::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?;
+    let offset: i64 = Error::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?.into();
     Ok(offset.try_into()?)
 }
</pre></div>


<p>and thank you for the offer, I'm totally new to rust and might need a bit of help with the other error. The first one was simple, since the compiler error message told me exactly what to do. </p>
</blockquote>



<a name="189733717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189733717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189733717">(Mar 04 2020 at 20:52)</a>:</h4>
<p>kubkon <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594832211" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-594832211">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>No probs, perfect opportunity to learn some Rust then!</p>
<p>Actually, I'd prefer if you submitted a separate PR either with #1226 as base, or waited until that one lands (which should be sometime today/tomorrow). This way we'd have contexts separated which should aid the readability of what's going on in <code>wasmtime</code> :-)</p>
</blockquote>



<a name="189772004"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189772004" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189772004">(Mar 05 2020 at 09:13)</a>:</h4>
<p>kubkon assigned <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a> (assigned to kubkon):</p>
<blockquote>
<p>git clone the repo, cd wasmtime/crates/wasi-common/yanix and execute cargo build fails with this beauty: </p>
<div class="codehilite"><pre><span></span>crates/wasi-common/yanix $ cargo build
    Updating crates.io index
  Downloaded cfg-if v0.1.10
  Downloaded thiserror v1.0.11
  Downloaded libc v0.2.67
  Downloaded log v0.4.8
  Downloaded bitflags v1.2.1
  Downloaded thiserror-impl v1.0.11
  Downloaded proc-macro2 v1.0.8
  Downloaded quote v1.0.2
  Downloaded unicode-xid v0.2.0
  Downloaded syn v1.0.15
   Compiling proc-macro2 v1.0.8
   Compiling unicode-xid v0.2.0
   Compiling syn v1.0.15
   Compiling bitflags v1.2.1
   Compiling libc v0.2.67
   Compiling log v0.4.8
   Compiling cfg-if v0.1.10
   Compiling quote v1.0.2
   Compiling thiserror-impl v1.0.11
   Compiling thiserror v1.0.11
   Compiling yanix v0.12.0 (/home/tim/wasmtime/crates/wasi-common/yanix)
error[E0308]: try expression alternatives have incompatible types
   --&gt; crates/wasi-common/yanix/src/file.rs:247:23
    |
247 |     let offset: i64 = Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?;
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |                       |
    |                       expected `i64`, found `i32`
    |                       help: you can convert an `i32` to `i64`: `Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?.into()`

error[E0277]: the trait bound `i32: std::convert::From&lt;i64&gt;` is not satisfied
  --&gt; crates/wasi-common/yanix/src/sys/linux/mod.rs:10:17
   |
10 |         Ok(Self(loc))
   |                 ^^^ the trait `std::convert::From&lt;i64&gt;` is not implemented for `i32`
   |
   = help: the following implementations were found:
             &lt;i32 as std::convert::From&lt;bool&gt;&gt;
             &lt;i32 as std::convert::From&lt;i16&gt;&gt;
             &lt;i32 as std::convert::From&lt;i8&gt;&gt;
             &lt;i32 as std::convert::From&lt;std::num::NonZeroI32&gt;&gt;
           and 2 others
   = note: required because of the requirements on the impl of `std::convert::Into&lt;i32&gt;` for `i64`

error: aborting due to 2 previous errors

Some errors have detailed explanations: E0277, E0308.
For more information about an error, try `rustc --explain E0277`.
error: could not compile `yanix`.
</pre></div>


<p>aarch64 seems fine. </p>
<p>rustc is v1.41.1 with llvm-9</p>
</blockquote>



<a name="189779151"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/189779151" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#189779151">(Mar 05 2020 at 10:54)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-595165685" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-595165685">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>with the rebased source tree, and when #1231 is applied, the second error remains: </p>
<div class="codehilite"><pre><span></span>error[E0277]: the trait bound `i32: std::convert::From&lt;i64&gt;` is not satisfied
  --&gt; crates/wasi-common/yanix/src/sys/linux/mod.rs:10:17
   |
10 |         Ok(Self(loc))
   |                 ^^^ the trait `std::convert::From&lt;i64&gt;` is not implemented for `i32`
   |
   = help: the following implementations were found:
             &lt;i32 as std::convert::From&lt;bool&gt;&gt;
             &lt;i32 as std::convert::From&lt;i16&gt;&gt;
             &lt;i32 as std::convert::From&lt;i8&gt;&gt;
             &lt;i32 as std::convert::From&lt;std::num::NonZeroI32&gt;&gt;
           and 2 others
   = note: required because of the requirements on the impl of `std::convert::Into&lt;i32&gt;` for `i64`

error: aborting due to previous error

For more information about this error, try `rustc --explain E0277`.
</pre></div>


<p>I tried to switch to <code>from_raw(loc: i32)</code> in that line, since i64 seems to be wrong, but that doesn't seem to solve anything :/</p>
</blockquote>



<a name="190094069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190094069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190094069">(Mar 09 2020 at 17:18)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596663896" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596663896">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>still struggeling, five new regressions since <a href="https://github.com/bytecodealliance/wasmtime/commit/061390ee1b1085a2191019d2219da730ec62485f" target="_blank" title="https://github.com/bytecodealliance/wasmtime/commit/061390ee1b1085a2191019d2219da730ec62485f">https://github.com/bytecodealliance/wasmtime/commit/061390ee1b1085a2191019d2219da730ec62485f</a></p>
<div class="codehilite"><pre><span></span>/tmp/wasmtime/crates/wasi-common/yanix $ cargo build --target armv7-unknown-linux-gnueabihf
   Compiling libc v0.2.67
   Compiling cfg-if v0.1.10
   Compiling bitflags v1.2.1
   Compiling log v0.4.8
   Compiling filetime v0.2.8
   Compiling yanix v0.12.0 (/tmp/wasmtime/crates/wasi-common/yanix)
error[E0308]: mismatched types
  --&gt; crates/wasi-common/yanix/src/filetime.rs:18:29
   |
18 |                     tv_sec: ft.seconds(),
   |                             ^^^^^^^^^^^^ expected `i32`, found `i64`

error[E0308]: mismatched types
  --&gt; crates/wasi-common/yanix/src/filetime.rs:19:30
   |
19 |                     tv_nsec: i64::from(ft.nanoseconds()),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `i32`, found `i64`

error[E0308]: mismatched types
  --&gt; crates/wasi-common/yanix/src/filetime.rs:72:22
   |
72 |             tv_nsec: UTIME_NOW,
   |                      ^^^^^^^^^ expected `i32`, found `i64`

error[E0308]: mismatched types
  --&gt; crates/wasi-common/yanix/src/filetime.rs:76:22
   |
76 |             tv_nsec: UTIME_OMIT,
   |                      ^^^^^^^^^^ expected `i32`, found `i64`

error[E0277]: the trait bound `i32: std::convert::From&lt;i64&gt;` is not satisfied
  --&gt; crates/wasi-common/yanix/src/sys/linux/mod.rs:13:17
   |
13 |         Ok(Self(loc))
   |                 ^^^ the trait `std::convert::From&lt;i64&gt;` is not implemented for `i32`
   |
   = help: the following implementations were found:
             &lt;i32 as std::convert::From&lt;bool&gt;&gt;
             &lt;i32 as std::convert::From&lt;i16&gt;&gt;
             &lt;i32 as std::convert::From&lt;i8&gt;&gt;
             &lt;i32 as std::convert::From&lt;std::num::NonZeroI32&gt;&gt;
           and 2 others
   = note: required because of the requirements on the impl of `std::convert::Into&lt;i32&gt;` for `i64`

error[E0308]: mismatched types
  --&gt; crates/wasi-common/yanix/src/sys/linux/utimesat.rs:39:17
   |
39 |         tv_sec: ft.seconds(),
   |                 ^^^^^^^^^^^^ expected `i32`, found `i64`

error: aborting due to 6 previous errors

Some errors have detailed explanations: E0277, E0308.
For more information about an error, try `rustc --explain E0277`.
error: could not compile `yanix`.

To learn more, run the command again with --verbose.
</pre></div>


</blockquote>



<a name="190095104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190095104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190095104">(Mar 09 2020 at 17:27)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596669014" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596669014">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>@kubkon if you happen to commit further changes to yanix, can you please do a testrun with <code>cargo build --target armv7-unknown-linux-gnueabihf</code> before you push the changes, to prevent further breakage? </p>
</blockquote>



<a name="190116655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190116655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190116655">(Mar 09 2020 at 20:54)</a>:</h4>
<p>kubkon <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596774259" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596774259">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>@stefson OK, it's good that these have surfaced now. It looks like we might have to make certain targeted adjustments for <code>armv7-unknown-linux-gnueabihf</code>. Is this a 32bit architecture?</p>
</blockquote>



<a name="190117825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190117825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190117825">(Mar 09 2020 at 21:07)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596779506" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-596779506">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>yes, it is 32bit, with hardfloat. </p>
<p>64bit is aarch64-unknown-linux-gnu (passes fine) </p>
</blockquote>



<a name="190166961"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190166961" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190166961">(Mar 10 2020 at 12:39)</a>:</h4>
<p>kubkon <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-597064014" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-597064014">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>Should now be fixed with #1269 :-)</p>
</blockquote>



<a name="190167775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190167775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190167775">(Mar 10 2020 at 12:51)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-597068623" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219#issuecomment-597068623">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a>:</p>
<blockquote>
<p>That's right, the yanix crate does now compile just fine. Thank you for helping with this! <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="190206853"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231219%20yanix%20v0.12.0%20%28/tmp/wasmtime/crate.../near/190206853" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231219.20yanix.20v0.2E12.2E0.20.28.2Ftmp.2Fwasmtime.2Fcrate.2E.2E.2E.html#190206853">(Mar 10 2020 at 18:19)</a>:</h4>
<p>kubkon closed <a href="https://github.com/bytecodealliance/wasmtime/issues/1219" target="_blank" title="https://github.com/bytecodealliance/wasmtime/issues/1219">Issue #1219</a> (assigned to kubkon):</p>
<blockquote>
<p>git clone the repo, cd wasmtime/crates/wasi-common/yanix and execute cargo build fails with this beauty: </p>
<div class="codehilite"><pre><span></span>crates/wasi-common/yanix $ cargo build
    Updating crates.io index
  Downloaded cfg-if v0.1.10
  Downloaded thiserror v1.0.11
  Downloaded libc v0.2.67
  Downloaded log v0.4.8
  Downloaded bitflags v1.2.1
  Downloaded thiserror-impl v1.0.11
  Downloaded proc-macro2 v1.0.8
  Downloaded quote v1.0.2
  Downloaded unicode-xid v0.2.0
  Downloaded syn v1.0.15
   Compiling proc-macro2 v1.0.8
   Compiling unicode-xid v0.2.0
   Compiling syn v1.0.15
   Compiling bitflags v1.2.1
   Compiling libc v0.2.67
   Compiling log v0.4.8
   Compiling cfg-if v0.1.10
   Compiling quote v1.0.2
   Compiling thiserror-impl v1.0.11
   Compiling thiserror v1.0.11
   Compiling yanix v0.12.0 (/home/tim/wasmtime/crates/wasi-common/yanix)
error[E0308]: try expression alternatives have incompatible types
   --&gt; crates/wasi-common/yanix/src/file.rs:247:23
    |
247 |     let offset: i64 = Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?;
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |                       |
    |                       expected `i64`, found `i32`
    |                       help: you can convert an `i32` to `i64`: `Errno::from_result(libc::lseek(fd, 0, libc::SEEK_CUR))?.into()`

error[E0277]: the trait bound `i32: std::convert::From&lt;i64&gt;` is not satisfied
  --&gt; crates/wasi-common/yanix/src/sys/linux/mod.rs:10:17
   |
10 |         Ok(Self(loc))
   |                 ^^^ the trait `std::convert::From&lt;i64&gt;` is not implemented for `i32`
   |
   = help: the following implementations were found:
             &lt;i32 as std::convert::From&lt;bool&gt;&gt;
             &lt;i32 as std::convert::From&lt;i16&gt;&gt;
             &lt;i32 as std::convert::From&lt;i8&gt;&gt;
             &lt;i32 as std::convert::From&lt;std::num::NonZeroI32&gt;&gt;
           and 2 others
   = note: required because of the requirements on the impl of `std::convert::Into&lt;i32&gt;` for `i64`

error: aborting due to 2 previous errors

Some errors have detailed explanations: E0277, E0308.
For more information about an error, try `rustc --explain E0277`.
error: could not compile `yanix`.
</pre></div>


<p>aarch64 seems fine. </p>
<p>rustc is v1.41.1 with llvm-9</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>