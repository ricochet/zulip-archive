<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9659 pulley: Implement a new `br_table` in... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html">wasmtime / PR #9659 pulley: Implement a new `br_table` in...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="483987861"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483987861" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483987861">(Nov 22 2024 at 20:39)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a> from <code>alexcrichton:pulley-br-table</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This is intended to match WebAssembly's <code>br_table</code> and Cranelift's version as well. This is implemented as a new <code>br_table32</code> opcode where a 32-bit number of branch targets are encoded after <code>br_table32</code> all as a <code>PcRelOffset</code>, a 32-bit offset. This helps bake in a more "macro opcode" into the interpreter rather than a handful of more primitive opcodes that would achieve the same result with loads/indirect jumps/comparisons/etc.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="483987863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483987863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483987863">(Nov 22 2024 at 20:39)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/abrown">abrown</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="483987864"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483987864" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483987864">(Nov 22 2024 at 20:39)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="483987867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483987867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483987867">(Nov 22 2024 at 20:39)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="483987868"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483987868" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483987868">(Nov 22 2024 at 20:39)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="483987870"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483987870" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483987870">(Nov 22 2024 at 20:39)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="483988324"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483988324" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483988324">(Nov 22 2024 at 20:42)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="483996120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/483996120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#483996120">(Nov 22 2024 at 21:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#issuecomment-2494911151">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @cfallin, @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift", "isle", "pulley"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>cfallin: isle</li>
<li>fitzgen: isle, pulley</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="484004642"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484004642" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484004642">(Nov 22 2024 at 22:58)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="484004993"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484004993" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484004993">(Nov 22 2024 at 23:01)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="484006049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484006049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484006049">(Nov 22 2024 at 23:10)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="484384654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484384654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484384654">(Nov 25 2024 at 20:31)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459518409">PR review</a>.</p>



<a name="484384655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484384655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484384655">(Nov 25 2024 at 20:31)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857288098">PR review comment</a>:</p>
<blockquote>
<p>This is confusing: if Pulley is an interpreter, we're not going to need an island for the same reasons we did during JIT compilation. I haven't looked below, but typically an interpreter sets the <code>pc</code>, the dispatch loop loads the bytecode at <code>pc</code>, etc. We don't have to jump an arbitrary <code>u32</code> amount. Or is there something that I don't understand here about the tail-calling version of Pulley?</p>
</blockquote>



<a name="484384656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484384656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484384656">(Nov 25 2024 at 20:31)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857300164">PR review comment</a>:</p>
<blockquote>
<p>It seems like we're trying to only have the targets of jumps be prefixed by address labels but then the test output ends up printing labels for everything after <code>0x33</code>?</p>
</blockquote>



<a name="484384657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484384657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484384657">(Nov 25 2024 at 20:31)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857276941">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>    ;; jumps to `default` if it's out-of-bounds.
</code></pre></div><br>
</p>
</blockquote>



<a name="484384658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484384658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484384658">(Nov 25 2024 at 20:31)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857308768">PR review comment</a>:</p>
<blockquote>
<p>Not having worked on Pulley from the beginning, I'm stepping out on a limb here: it's worrying that once we introduce mutable state during codegen (and later during disassembly) we will have difficulty going back from this. This feels like a better discussion to have with @fitzgen since he may have stronger opinions about this (or not).</p>
</blockquote>



<a name="484402467"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484402467" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484402467">(Nov 25 2024 at 22:43)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<a name="484403194"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484403194" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484403194">(Nov 25 2024 at 22:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459787313">PR review</a>.</p>



<a name="484403196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484403196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484403196">(Nov 25 2024 at 22:48)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857441268">PR review comment</a>:</p>
<blockquote>
<p>Heh your confusion is not unwarranted! Pulley is roughly modeled after our existing backends which is why this is still a problem. For example a jump will be "jump this distance forward or backward" in the bytecode stream (e.g. relative offset to pc). The jumps may have limited distance like other backends (right now they're all 32-bit jumps though) which is why islands might be necessary. Basically Pulley still has the same issues as other backends in terms of handling jumps b/c it's all relative to the current <code>pc</code> like native code and we'll probably add smaller-than-32-bit jumps at some point.</p>
</blockquote>



<a name="484403430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484403430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484403430">(Nov 25 2024 at 22:49)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459789414">PR review</a>.</p>



<a name="484403432"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484403432" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484403432">(Nov 25 2024 at 22:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857442618">PR review comment</a>:</p>
<blockquote>
<p>Yeah the idea is that only the initial line has an offset and the others don't for multi-line instructions. The behavior in the test has to do with how the test disassembly tries to omit instruction offsets but then includes instruction offsets if they might be targets of a jump (so it's known where a jump is going). The logic is relatively primitive though and falls down quickly, so the all-offsets-after-0x33 isn't a result of this logic but is something preexisting.</p>
</blockquote>



<a name="484403551"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484403551" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484403551">(Nov 25 2024 at 22:50)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2459790156">PR review</a>.</p>



<a name="484403552"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/484403552" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#484403552">(Nov 25 2024 at 22:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1857443081">PR review comment</a>:</p>
<blockquote>
<p>FWIW this is modeled after the <a href="https://github.com/bytecodealliance/wasmtime/blob/2af831a6defed4378a0c6a324d9ecd5fbab58eff/cranelift/codegen/src/isa/aarch64/inst/emit.rs#L720">aarch64 backend</a></p>
</blockquote>



<a name="485688681"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/485688681" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#485688681">(Dec 02 2024 at 18:51)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2473605670">PR review</a>.</p>



<a name="485688682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/485688682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#485688682">(Dec 02 2024 at 18:51)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1866416951">PR review comment</a>:</p>
<blockquote>
<p>Ok, if you're saying "we need islands for programs with more than 4GB of Pulley bytecode" I think I see what you mean. But... it also doesn't seem unreasonable to disallow that and avoid the island complexity. You're in the middle of this so you have a better handle on this; leaving it up to you!</p>
</blockquote>



<a name="485688837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/485688837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#485688837">(Dec 02 2024 at 18:52)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2473608110">PR review</a>:</p>
<blockquote>
<p>I don't want to stand in the way of progress: Pulley is getting better!</p>
</blockquote>



<a name="485690204"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/485690204" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#485690204">(Dec 02 2024 at 19:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#pullrequestreview-2473663511">PR review</a>.</p>



<a name="485690206"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/485690206" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#485690206">(Dec 02 2024 at 19:01)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9659#discussion_r1866453269">PR review comment</a>:</p>
<blockquote>
<p>For now yeah that's definitely the constraint, in the future though I think we might add 8-bit or smaller jump targets  in which case we'd definitely want the island bits. So in some sense this is future-proofing if not maintaining consistency across the backends.</p>
</blockquote>



<a name="485693066"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239659%20pulley%3A%20Implement%20a%20new%20%60br_table%60%20in.../near/485693066" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239659.20pulley.3A.20Implement.20a.20new.20.60br_table.60.20in.2E.2E.2E.html#485693066">(Dec 02 2024 at 19:17)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9659">PR #9659</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>