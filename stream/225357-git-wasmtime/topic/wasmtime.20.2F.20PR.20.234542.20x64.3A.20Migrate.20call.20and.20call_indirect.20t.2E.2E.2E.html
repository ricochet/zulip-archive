<html>
<head><meta charset="utf-8"><title>wasmtime / PR #4542 x64: Migrate call and call_indirect t... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html">wasmtime / PR #4542 x64: Migrate call and call_indirect t...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="291085974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291085974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291085974">(Jul 27 2022 at 18:01)</a>:</h4>
<p>elliottt opened <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> from <code>trevor/x64-lower-call</code> to <code>main</code>:</p>
<blockquote>
<ul>
<li>Migrate call and call_indirect to ISLE</li>
<li>Update tests</li>
</ul>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="291086405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291086405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291086405">(Jul 27 2022 at 18:04)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> from <code>trevor/x64-lower-call</code> to <code>main</code>.</p>



<a name="291086890"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291086890" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291086890">(Jul 27 2022 at 18:07)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> from <code>trevor/x64-lower-call</code> to <code>main</code>.</p>



<a name="291087385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291087385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291087385">(Jul 27 2022 at 18:10)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> from <code>trevor/x64-lower-call</code> to <code>main</code>:</p>
<blockquote>
<p>Migrate the lowerings for <code>call</code> and <code>call_indirect</code> to ISLE. This is a less thorough embedding of those two lowerings in ISLE than the s390x backend, but we can re-evaluate that decision later.<br>
&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="291100190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291100190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291100190">(Jul 27 2022 at 19:41)</a>:</h4>
<p><strong>elliottt</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> as ready for review.</p>



<a name="291127377"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291127377" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291127377">(Jul 28 2022 at 00:21)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a>.</p>



<a name="291128720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291128720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291128720">(Jul 28 2022 at 00:46)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4542#pullrequestreview-1053364846">PR review</a>.</p>



<a name="291128721"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291128721" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291128721">(Jul 28 2022 at 00:46)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4542#pullrequestreview-1053364846">PR review</a>.</p>



<a name="291128722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291128722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291128722">(Jul 28 2022 at 00:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/4542#discussion_r931689025">PR review comment</a>:</p>
<blockquote>
<p>It doesn't look like this is actually invoked from ISLE -- I guess it's here so it can be in the <code>Context</code> trait and so the impl can sit next to its user in <code>isle.rs</code>?</p>
<p>I think I'd prefer to move it to a separate <code>impl IsleContext</code> block (ie not the trait impl) and avoid listing it here, just to avoid confusion ("why is this an extractor, where is it used?") if for no other reason...</p>
</blockquote>



<a name="291128723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291128723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291128723">(Jul 28 2022 at 00:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/4542#discussion_r931688068">PR review comment</a>:</p>
<blockquote>
<p>Let's have a <code>panic</code> here instead: in theory we could have a larger number if we have a narrower machine (<code>I128</code> on a 32-bit architecture) or larger type. Otherwise we just fail isel in a hard-to-debug way...</p>
</blockquote>



<a name="291133032"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291133032" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291133032">(Jul 28 2022 at 02:16)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/4542#discussion_r931722023">PR review comment</a>:</p>
<blockquote>
<p>When my previous attempt had more of the lowering implemented in ISLE, I was using it there. I agree that it's odd to see it here, only to be used from the rust side -- we can always add it back to the prelude if it turns out it's necessary.</p>
</blockquote>



<a name="291133033"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291133033" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291133033">(Jul 28 2022 at 02:16)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4542#pullrequestreview-1053407090">PR review</a>.</p>



<a name="291133160"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291133160" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291133160">(Jul 28 2022 at 02:18)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> from <code>trevor/x64-lower-call</code> to <code>main</code>.</p>



<a name="291133281"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291133281" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291133281">(Jul 28 2022 at 02:21)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a> from <code>trevor/x64-lower-call</code> to <code>main</code>.</p>



<a name="291245410"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234542%20x64%3A%20Migrate%20call%20and%20call_indirect%20t.../near/291245410" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234542.20x64.3A.20Migrate.20call.20and.20call_indirect.20t.2E.2E.2E.html#291245410">(Jul 28 2022 at 20:10)</a>:</h4>
<p>elliottt merged <a href="https://github.com/bytecodealliance/wasmtime/pull/4542">PR #4542</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>