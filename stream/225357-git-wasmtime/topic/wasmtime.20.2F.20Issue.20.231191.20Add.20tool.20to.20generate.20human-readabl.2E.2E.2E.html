<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1191 Add tool to generate human-readabl... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html">wasmtime / Issue #1191 Add tool to generate human-readabl...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189802769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/189802769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#189802769">(Mar 05 2020 at 15:30)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-595290261" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-595290261">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<p>I think it was #1113.</p>
</blockquote>



<a name="189839690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/189839690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#189839690">(Mar 05 2020 at 21:41)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-595461665" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-595461665">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<blockquote>
<p>Why do we want this?</p>
</blockquote>
<p>When adding new instructions to Cranelift, I have frequently found errors of the "no encoding found" sort. Sometimes a type is not bound correctly, sometimes a predicate is preventing the compiler from seeing the encoding, sometimes the instruction is in the wrong CPU mode, etc. Looking through the generated Rust code to figure out why no encoding is found is very difficult, mostly because of the lookup table structures. If we could at least see a list of all encodings, their recipes, types, and (eventually) predicates, then we could more quickly troubleshoot the above errors.</p>
<p>I don't have all the information that might be useful in this PR (e.g. predicates) but I was trying to get something in place and then iterate. I am displaying the information I care about--is there something else that should be added? Or is a different format more helpful?</p>
<blockquote>
<p>Is there a way we could not generate this by default? </p>
</blockquote>
<p>Yes, we could. I like the idea of adding a <code>clif-util encodings</code> command to print this information to stdout and then the user can do what they want with it. Does that sound good?</p>
</blockquote>



<a name="189879046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/189879046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#189879046">(Mar 06 2020 at 10:24)</a>:</h4>
<p>bnjbvr <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-595703618" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-595703618">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<blockquote>
<p>I don't have all the information that might be useful in this PR (e.g. predicates) but I was trying to get something in place and then iterate. I am displaying the information I care about--is there something else that should be added? Or is a different format more helpful?</p>
</blockquote>
<p>This sounds good as a first iteration!</p>
<blockquote>
<p>adding a clif-util encodings command to print this information to stdout and then the user can do what they want with it. Does that sound good?</p>
</blockquote>
<p>Sounds good to me too!</p>
</blockquote>



<a name="190195991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/190195991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#190195991">(Mar 10 2020 at 16:48)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-597192206" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-597192206">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<p>@bnjbvr, looking at this again today and I realized that if we add a <code>clif-util encodings</code> command then we will end up having to write some information out somewhere (a text file, a Rust file, etc.) during the compilation of <code>cranelift-codegen</code>. That sort of defeats the purpose of avoiding a compile-time cost so I wanted to confirm we still want to do this. I measured it and when I tried <code>cargo clean &amp;&amp; cargo build -p cranelift-codegen -vv</code> I see a total compile time of ~34s and of that this listing code takes ~14ms. That doesn't seem over-large but we could still put it behind a feature flag for users who may want to disable it, though I would think this would be the type of thing that could be enabled by default.</p>
</blockquote>



<a name="190416714"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/190416714" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#190416714">(Mar 12 2020 at 17:11)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-598306914" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-598306914">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>This issue or pull request has been labeled: "c", "r", "a", "n", "e", "l", "i", "f", "t"</p>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action" target="_blank" title="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a></p>
</blockquote>



<a name="190416729"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/190416729" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#190416729">(Mar 12 2020 at 17:11)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-598306947" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-598306947">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>This issue or pull request has been labeled: "c", "r", "a", "n", "e", "l", "i", "f", "t"</p>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action" target="_blank" title="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a></p>
</blockquote>



<a name="190832039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/190832039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#190832039">(Mar 17 2020 at 10:52)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-600004698" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-600004698">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>This issue or pull request has been labeled: "cranelift", "cranelift:meta"</p>
<p>&lt;details&gt; &lt;summary&gt;Users Subscribed to "cranelift"&lt;/summary&gt;</p>
<ul>
<li>@bnjbvr</li>
</ul>
<p>&lt;/details&gt;</p>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action" target="_blank" title="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a></p>
</blockquote>



<a name="195447758"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/195447758" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#195447758">(Apr 27 2020 at 17:12)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-620116962" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-620116962">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<p>@bnjbvr, thanks for reviewing... but I probably should have closed this: yes, this will likely not be necessary with the new backend. It is solving a problem introduced at the meta-level (e.g. why is cranelift telling me that it can't find an encoding for this instruction?!?) which the new backend may not have. I'll re-open and modify as needed if I am still running into that type of issue once I am a bit more familiar with the new backend.</p>
</blockquote>



<a name="195451900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231191%20Add%20tool%20to%20generate%20human-readabl.../near/195451900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231191.20Add.20tool.20to.20generate.20human-readabl.2E.2E.2E.html#195451900">(Apr 27 2020 at 17:43)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-620133059" title="https://github.com/bytecodealliance/wasmtime/pull/1191#issuecomment-620133059">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1191" title="https://github.com/bytecodealliance/wasmtime/pull/1191">Issue #1191</a>:</p>
<blockquote>
<p>The new backend just uses a big <code>match</code> on the instruction. If there is an instruction without encoding, it panics.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>