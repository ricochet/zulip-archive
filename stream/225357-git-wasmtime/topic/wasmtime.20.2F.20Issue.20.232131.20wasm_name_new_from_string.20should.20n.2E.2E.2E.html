<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2131 wasm_name_new_from_string should n... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html">wasmtime / Issue #2131 wasm_name_new_from_string should n...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="206857043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/206857043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#206857043">(Aug 13 2020 at 19:11)</a>:</h4>
<p>craigsteyn opened <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameWrong</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new_from_string</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameWrong</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameRight</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameRight</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>


<p>first one didnt work when adding to the linker.<br>
second one did. <br>
Issue was caused by <code>wasm_name_new_from_string</code> adding to the length.</p>
</blockquote>



<a name="206857044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/206857044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#206857044">(Aug 13 2020 at 19:11)</a>:</h4>
<p>craigsteyn labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameWrong</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new_from_string</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameWrong</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameRight</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameRight</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>


<p>first one didnt work when adding to the linker.<br>
second one did. <br>
Issue was caused by <code>wasm_name_new_from_string</code> adding to the length.</p>
</blockquote>



<a name="208451282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/208451282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#208451282">(Aug 29 2020 at 20:01)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/2131#issuecomment-683335947">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<p>Sorry for the delay in getting to this, but thanks for the report! This is a discrepancy with the upstream C API in <a href="https://github.com/WebAssembly/wasm-c-api">https://github.com/WebAssembly/wasm-c-api</a>. The problem is that some string lengths include the nul terminator and some do not. Most Wasmtime APIs do not take into account the nul terminator, except for those that the wasm-c-api specifies should do so. Depending on the constructor you use you get a +1 or not as well.</p>
<p>It's pretty confusing, but at this time the upstream C API needs to change to make the situation better I believe.</p>
</blockquote>



<a name="208595811"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/208595811" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#208595811">(Aug 31 2020 at 18:20)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/2131#issuecomment-683947400">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<p><a href="https://github.com/WebAssembly/wasm-c-api/pull/151">https://github.com/WebAssembly/wasm-c-api/pull/151</a> was made to help distinguish the fact that this function will add a null terminator to the string, which makes it unsuitable for a use such as resolving module imports.</p>
<p>We should update our API to match the new name.</p>
</blockquote>



<a name="208595893"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/208595893" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#208595893">(Aug 31 2020 at 18:21)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/2131#issuecomment-683947400">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<p><a href="https://github.com/WebAssembly/wasm-c-api/pull/151">https://github.com/WebAssembly/wasm-c-api/pull/151</a> was made to help distinguish the fact that this function will add a null terminator to the string, which makes it unsuitable for a use such as resolving module imports.</p>
<p>We should update our API to match the new name, at which time <code>wasm_name_new_from_string</code> should start working.</p>
</blockquote>



<a name="208595981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/208595981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#208595981">(Aug 31 2020 at 18:22)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/2131#issuecomment-683947400">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<p><a href="https://github.com/WebAssembly/wasm-c-api/pull/151">https://github.com/WebAssembly/wasm-c-api/pull/151</a> was made to help distinguish the fact that this function (renamed to <code>wasm_name_new_from_string_nt</code> will add a null terminator to the string, which makes it unsuitable for a use such as resolving module imports.</p>
<p>We should update our API to match the new name, at which time <code>wasm_name_new_from_string</code> should start working.</p>
</blockquote>



<a name="208595995"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/208595995" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#208595995">(Aug 31 2020 at 18:22)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/2131#issuecomment-683947400">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a>:</p>
<blockquote>
<p><a href="https://github.com/WebAssembly/wasm-c-api/pull/151">https://github.com/WebAssembly/wasm-c-api/pull/151</a> was made to help distinguish the fact that this function (renamed to <code>wasm_name_new_from_string_nt</code>) will add a null terminator to the string, which makes it unsuitable for a use such as resolving module imports.</p>
<p>We should update our API to match the new name, at which time <code>wasm_name_new_from_string</code> should start working.</p>
</blockquote>



<a name="222530755"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/222530755" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#222530755">(Jan 13 2021 at 04:08)</a>:</h4>
<p>peterhuene assigned <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a> (assigned to peterhuene):</p>
<blockquote>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameWrong</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new_from_string</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameWrong</span><span class="p">,</span><span class="w"> </span><span class="s">"hello"</span><span class="p">);</span><span class="w"></span>
<span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameRight</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameRight</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">"hello"</span><span class="p">),</span><span class="w"> </span><span class="s">"hello"</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>first one didnt work when adding to the linker.<br>
second one did. <br>
Issue was caused by <code>wasm_name_new_from_string</code> adding to the length.<br>
</p>
</blockquote>



<a name="222733857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232131%20wasm_name_new_from_string%20should%20n.../near/222733857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232131.20wasm_name_new_from_string.20should.20n.2E.2E.2E.html#222733857">(Jan 14 2021 at 15:36)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/2131">Issue #2131</a> (assigned to peterhuene):</p>
<blockquote>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameWrong</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new_from_string</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameWrong</span><span class="p">,</span><span class="w"> </span><span class="s">"hello"</span><span class="p">);</span><span class="w"></span>
<span class="n">wasm_name_t</span><span class="w"> </span><span class="n">nameRight</span><span class="p">;</span><span class="w"></span>
<span class="n">wasm_name_new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nameRight</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">"hello"</span><span class="p">),</span><span class="w"> </span><span class="s">"hello"</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>first one didnt work when adding to the linker.<br>
second one did. <br>
Issue was caused by <code>wasm_name_new_from_string</code> adding to the length.<br>
</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>