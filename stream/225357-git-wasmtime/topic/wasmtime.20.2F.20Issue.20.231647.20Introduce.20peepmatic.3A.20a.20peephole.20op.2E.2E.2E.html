<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1647 Introduce peepmatic: a peephole op... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html">wasmtime / Issue #1647 Introduce peepmatic: a peephole op...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="196024558"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/196024558" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#196024558">(May 02 2020 at 00:42)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622632876" title="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622632876">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647" title="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @bnjbvr</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>bnjbvr: cranelift</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action" title="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="196038354"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/196038354" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#196038354">(May 02 2020 at 07:23)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622785581" title="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622785581">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647" title="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>Cool! By the way does this fix the bug where preopt forgets to sign extend <code>imm</code> when optimizing <code>v1 = iconst.i8 imm; v2 = icmp sgt v0, v1</code> to <code>v2 = icmp_imm sgt v0, imm</code>?</p>
</blockquote>



<a name="196046893"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/196046893" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#196046893">(May 02 2020 at 11:13)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622937235" title="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622937235">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647" title="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>Can you add the commit messages introducing a new crate to a top level doc comment in the respective crate?</p>
</blockquote>



<a name="196049775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/196049775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#196049775">(May 02 2020 at 12:35)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622785581" title="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622785581">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647" title="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>Cool! By the way does this fix the bug where preopt forgets to sign extend <code>imm</code> when optimizing <code>v1 = iconst.i8 imm; v2 = icmp sgt v0, v1</code> to <code>v2 = icmp_imm sgt v0, imm</code>?</p>
<p>Edit: It doesn't. Left a comment at the place it should sign extend.</p>
</blockquote>



<a name="196050642"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/196050642" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#196050642">(May 02 2020 at 13:01)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622950243" title="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-622950243">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647" title="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>This is very well documented and structured code!</p>
</blockquote>



<a name="196975633"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/196975633" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#196975633">(May 09 2020 at 05:59)</a>:</h4>
<p>Techcable <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-626111962" title="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-626111962">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647" title="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>Super cool! <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> How does this compare to <a href="https://github.com/LuaJIT/LuaJIT/blob/87b111f/src/lj_opt_fold.c" title="https://github.com/LuaJIT/LuaJIT/blob/87b111f/src/lj_opt_fold.c">LuaJIT's FOLD optimization</a> and their perfect-hash system? I know their trace compiler has a simpler IR than crenelift, but what is the motivation of using a fst over perfect hash map? Does it enable more complex matching?</p>
</blockquote>



<a name="197112386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197112386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197112386">(May 11 2020 at 08:03)</a>:</h4>
<p>bnjbvr <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-626541280">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>This is exciting! A few high-level questions that I think would be important to answer before merging:</p>
<ul>
<li>does this replace the existing <code>simple_preopt</code>, or is this something that ought to be disabled until it has feature parity with the current <code>simple_preopt</code>? I would advocate not enabling this by default if this isn't at feature parity with the existing system, since the current system was actually useful.</li>
<li>if this is at feature parity and we plan to enable it by default, can you provide performance data, please? (comparisons of before/after for: wallclocks compile run time + total number of executed instructions through Valgrind/perf) If this is a slowdown considering one of these two measures, I would strongly advocate not enabling it by default and keeping the existing system in the meanwhile.</li>
<li>(Less important, mostly for my personal curiosity but this doesn't have to block anything) do we have any ideas of what the (Rust) compile time difference would be, with this new system? (Auto-generated code tends to create large functions which are quite slow to compile.)</li>
</ul>
</blockquote>



<a name="197128908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197128908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197128908">(May 11 2020 at 11:01)</a>:</h4>
<p>froydnj <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-626633456">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<blockquote>
<div class="codehilite"><pre><span></span><code>* (Less important, mostly for my personal curiosity but this doesn&#39;t have to block anything) do we have any ideas of what the (Rust) compile time difference would be, with this new system? (Auto-generated code tends to create large functions which are quite slow to compile.)
</code></pre></div>


</blockquote>
<p>Something that would be nice to have sorted (pun intended) prior to merge is whether the auto-generated code is the same over multiple compilations of the crate, so <code>sccache</code> works correctly.</p>
</blockquote>



<a name="197217876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197217876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197217876">(May 11 2020 at 23:22)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-627017306">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>@Techcable </p>
<blockquote>
<p>How does this compare to <a href="https://github.com/LuaJIT/LuaJIT/blob/87b111f/src/lj_opt_fold.c">LuaJIT's FOLD optimization</a> and their perfect-hash system?</p>
</blockquote>
<p>I'm not really familiar with LuaJIT's FOLD optimizations, but reading through that comment, it seems a little less general (can only match three operations at most?). The idea of combining three opcode checks into a single check via perfect hashing is something we could investigate and add as a new <code>MatchOp</code>, perhaps.</p>
<hr>
<p>@bnjbvr, as you know, we talked a bit about this at the Cranelift meeting today, but for posterity I'll put them in a comment again.</p>
<blockquote>
<p>does this replace the existing <code>simple_preopt</code>, or is this something that ought to be disabled until it has feature parity with the current <code>simple_preopt</code>? I would advocate not enabling this by default if this isn't at feature parity with the existing system, since the current system was actually useful.</p>
</blockquote>
<p>Yes, this is feature-gated behind the <code>"enable-peepmatic"</code> cargo feature right now, and the feature is not enabled by default.</p>
<blockquote>
<p>can you provide performance data, please?</p>
</blockquote>
<p>Performance doesn't quite match the hand-coded peephole optimizer yet. This is one reason why it makes sense to land this off-by-default. This is unsurprising, since I haven't spent time on perf and optimization yet, other than the big picture design.</p>
<p>&lt;details&gt;&lt;summary&gt;&lt;b&gt;Graphs of wall time, instructions retired, cache misses, and branch misses&lt;/b&gt;&lt;/summary&gt;</p>
<p>The following examples are for running <code>wasmtime markdown.wasm '# Hello, World!'</code> where <code>markdown.wasm</code> is internally using <code>pulldown-cmark</code>. This is a 272KiB wasm file.</p>
<h3>Wall Time</h3>
<p>![time](<a href="https://user-images.githubusercontent.com/74571/81618958-59905080-939d-11ea-921a-9193334a841f.png">https://user-images.githubusercontent.com/74571/81618958-59905080-939d-11ea-921a-9193334a841f.png</a>)</p>
<h3>Instructions Retired</h3>
<p>![instructions](<a href="https://user-images.githubusercontent.com/74571/81618946-4f6e5200-939d-11ea-8961-097e7d1a078e.png">https://user-images.githubusercontent.com/74571/81618946-4f6e5200-939d-11ea-8961-097e7d1a078e.png</a>)</p>
<h3>Branch Misses</h3>
<p>![branch-misses](<a href="https://user-images.githubusercontent.com/74571/81618997-762c8880-939d-11ea-93de-c93451f84cf2.png">https://user-images.githubusercontent.com/74571/81618997-762c8880-939d-11ea-93de-c93451f84cf2.png</a>)</p>
<h3>Cache Misses</h3>
<p>![cache-misses](<a href="https://user-images.githubusercontent.com/74571/81619012-7b89d300-939d-11ea-8fe2-98fb6bc55716.png">https://user-images.githubusercontent.com/74571/81619012-7b89d300-939d-11ea-8fe2-98fb6bc55716.png</a>)</p>
<p>&lt;/details&gt;</p>
<p>I have many ideas for perf improvements, but I'd like to land this PR first, and then start investigating perf in follow ups. Since peepmatic is not enabled by default, this shouldn't be risky.</p>
<blockquote>
<p>do we have any ideas of what the (Rust) compile time difference would be, with this new system?</p>
</blockquote>
<p>The vast majority of peepmatic code is not necessary to compile unless you're changing the set of peephole optimizations. This is the motivation for the split between the <code>peepmatic</code> crate (the compiler, only run at build time if the <code>"rebuild-peephole-optimizers"</code> feature is enabled) and the <code>peepmatic-runtime</code> crate (just the things needed to <em>use</em> a peepmatic-generated peephole optimizer.</p>
<p>&lt;details&gt;&lt;summary&gt;&lt;b&gt;Timings of Cranelift's compile time&lt;/b&gt;&lt;/summary&gt;</p>
<h3>Without Peepmatic</h3>
<div class="codehilite"><pre><span></span><code>fitzgen@erdos :: (master) :: ~/wasmtime/cranelift/codegen
    $ cargo clean; time cargo build --quiet

real    0m24.207s
user    1m13.714s
sys     0m4.391s

fitzgen@erdos :: (master) :: ~/wasmtime/cranelift/codegen
    $ echo &quot;// comment&quot; &gt;&gt; src/lib.rs

fitzgen@erdos :: (master *) :: ~/wasmtime/cranelift/codegen
    $ time cargo build --quiet

real    0m2.424s
user    0m1.962s
sys     0m0.559s
</code></pre></div>


<h3>With Peepmatic (Not Rebuilding Peephole Optimizers)</h3>
<div class="codehilite"><pre><span></span><code>fitzgen@erdos :: (integrate-peepmatic) :: ~/wasmtime/cranelift/codegen
    $ cargo clean; time cargo build --quiet --features enable-peepmatic

real    0m31.580s
user    1m44.893s
sys     0m6.192s

fitzgen@erdos :: (integrate-peepmatic) :: ~/wasmtime/cranelift/codegen
    $ echo &quot;// comment&quot; &gt;&gt; src/lib.rs

fitzgen@erdos :: (integrate-peepmatic *) :: ~/wasmtime/cranelift/codegen
    $ time cargo build --quiet --features enable-peepmatic

real    0m2.491s
user    0m1.988s
sys     0m0.604s
</code></pre></div>


<h3>With Peepmatic (With Rebuilding Peephole Optimizers)</h3>
<div class="codehilite"><pre><span></span><code>fitzgen@erdos :: (integrate-peepmatic) :: ~/wasmtime/cranelift/codegen
    $ cargo clean; time cargo build --quiet --features &#39;enable-peepmatic rebuild-peephole-optimizers&#39;

real    3m35.014s
user    20m46.827s
sys     1m40.616s

fitzgen@erdos :: (integrate-peepmatic) :: ~/wasmtime/cranelift/codegen
    $ echo &quot;// comment&quot; &gt;&gt; src/lib.rs

fitzgen@erdos :: (integrate-peepmatic *) :: ~/wasmtime/cranelift/codegen
    $ time cargo build --quiet --features &#39;enable-peepmatic rebuild-peephole-optimizers&#39;

real    0m2.649s
user    0m2.187s
sys     0m0.563s
</code></pre></div>


<p>&lt;/details&gt;</p>
<p>Incremental builds are unaffected.</p>
<p>Clean builds without rebuilding the peephole optimizers take a little bit longer (24 -&gt; 31 seconds).</p>
<p>Clean builds with rebuilding the peephole optimizers take ~3.5 minutes. This is mainly due to building and statically linking Z3. We could also shared link the system Z3 to avoid much of this overhead, but this has other problems, namely old Z3s that are missing some exported symbols (e.g. Ubuntu's packaged Z3).</p>
<hr>
<p>@froydnj </p>
<blockquote>
<p>whether the auto-generated code is the same over multiple compilations of the crate, so <code>sccache</code> works correctly.</p>
</blockquote>
<p>(There is currently no generated Rust code, only a generated automaton that is then interpreted. This may change in the future. Sorry to nitpick.)</p>
<p>Yes, builds are deterministic, producing the same automaton bit-for-bit given the same DSL input. CI is checking this, and one of the fuzz targets is also checking this.</p>
</blockquote>



<a name="197219429"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197219429" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197219429">(May 11 2020 at 23:43)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-627023813">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>Oh, also, there was a question at the Cranelift meeting about how many optimizations we can expect to get out of Souper.</p>
<p>@jubitaneja harvested candidate left-hand sides from <code>rustfmt</code> compiled to Wasm with LLVM optimizations and then ran them through Souper. Souper successfully synthesized 836 optimizations, of which 221 are reducing the whole LHS to a constant.</p>
<p>I think we can expect to see roughly similar results, with a couple caveats:</p>
<ul>
<li>
<p>First, she was harvesting LHS candidates from the Wasm, not the clif that the Wasm gets translated into. On the one hand, it isn't clear how many of these synthesized optimizations are subsumed by our existing preopt pass. On the other, these candidates are harvested <em>after</em> LLVM optimizations, and I'm pretty sure LLVM's optimizations largely subsume our preopt pass's, so maybe these <em>are</em> new/unique/missing optimizations?</p>
</li>
<li>
<p>Second, choosing a corpus of benchmark Wasms to harvest LHSes from is tricky, but I am pretty sure we will have more than a single file in the corpus from more than just a single toolchain. So I'd suspect that we would synthesize even more optimizations than this.</p>
</li>
</ul>
</blockquote>



<a name="197253054"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197253054" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197253054">(May 12 2020 at 09:45)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-627233544">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>It would be nice to also harvested candidate left-hand sides from cg_clif generated clif ir. Maybe add a way for a user to provide it's own set of peephole optimizations to Cranelift?</p>
</blockquote>



<a name="197294717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197294717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197294717">(May 12 2020 at 15:36)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-627422337">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<blockquote>
<p>It would be nice to also harvested candidate left-hand sides from cg_clif generated clif ir. Maybe add a way for a user to provide it's own set of peephole optimizations to Cranelift?</p>
</blockquote>
<p>Yep, this is definitely something we could do in the future.</p>
</blockquote>



<a name="197334317"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231647%20Introduce%20peepmatic%3A%20a%20peephole%20op.../near/197334317" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231647.20Introduce.20peepmatic.3A.20a.20peephole.20op.2E.2E.2E.html#197334317">(May 12 2020 at 20:28)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/1647#issuecomment-627575862">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1647">Issue #1647</a>:</p>
<blockquote>
<p>Finally got windows CI green, so now all CI is green!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>