<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2020 Serialize and deserialize compilation... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html">wasmtime / PR #2020 Serialize and deserialize compilation...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="203895339"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/203895339" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#203895339">(Jul 14 2020 at 22:19)</a>:</h4>
<p>yurydelendik opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> from <code>serde-module-example</code> to <code>main</code>:</p>
<blockquote>
<p>Fixes #1779 </p>
<p>This is final patch in series to allow direct access to the compiled code.</p>
<ul>
<li>Added <code>compile_and_serialize</code> API function that allows to save <code>CompilationArtifacts</code> object in binary format (+target/config fingerprint)</li>
<li>Added unsafe <code>Module::deserialize</code> API function that allows to read the above data and create <code>Module</code> object. Marked unsafe since it does not provide any guarantees for safety of the ingested code.</li>
<li>Portability limitation is that producer and consumer's<code>Config</code>s must have the same host triple, codegen flags, and <code>Tunables</code>. (Can we ignore <code>CompilerStrategy</code>?)</li>
</ul>
<p>PR opened for feedback.</p>
</blockquote>



<a name="203996734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/203996734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#203996734">(Jul 15 2020 at 18:49)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> from <code>serde-module-example</code> to <code>main</code>:</p>
<blockquote>
<p>Fixes #1779 </p>
<p>This is final patch in series to allow direct access to the compiled code.</p>
<ul>
<li>Added <code>compile_and_serialize</code> API function that allows to save <code>CompilationArtifacts</code> object in binary format (+target/config fingerprint)</li>
<li>Added unsafe <code>Module::deserialize</code> API function that allows to read the above data and create <code>Module</code> object. Marked unsafe since it does not provide any guarantees for safety of the ingested code.</li>
<li>Portability limitation is that producer and consumer's<code>Config</code>s must have the same host triple, codegen flags, and <code>Tunables</code>. (Can we ignore <code>CompilerStrategy</code>?)</li>
</ul>
<p>PR opened for feedback.</p>
</blockquote>



<a name="204000064"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204000064" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204000064">(Jul 15 2020 at 19:16)</a>:</h4>
<p><strong>yurydelendik</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> as ready for review.</p>



<a name="204002440"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002440" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002440">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449266678">PR Review</a>.</p>



<a name="204002442"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002442" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002442">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449266678">PR Review</a>.</p>



<a name="204002443"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002443" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002443">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455291377">PR Review Comment</a>:</p>
<blockquote>
<p>Would it be possible to add this as a method as <code>Module::serialize</code> instead of a top-level function?</p>
<p>Additionally, I think it may be best to stick to in-memory buffers for now since the entire <code>Module</code> has to be resident in memory anyway. Using <code>Read</code> and <code>Write</code> can be somewhat tricky so I'm not sure we want to go there just yet (we could always add support later though if needed)</p>
</blockquote>



<a name="204002444"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002444" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002444">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455292972">PR Review Comment</a>:</p>
<blockquote>
<p>Also like serialize I think it may be best to be conservative and start out with a byte slice instead of a <code>Read</code></p>
</blockquote>



<a name="204002445"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002445" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002445">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455291845">PR Review Comment</a>:</p>
<blockquote>
<p>Could this include <code>env!("CARGO_PKG_VERSION")</code> as well to catch accidental bugs of reusing across wasmtime versions?</p>
</blockquote>



<a name="204002446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002446">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455292320">PR Review Comment</a>:</p>
<blockquote>
<p>Is this intended to be <code>unsafe</code>? Ideally we'd have this be a safe function I think.</p>
</blockquote>



<a name="204002448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002448">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455292095">PR Review Comment</a>:</p>
<blockquote>
<p>s/tripple/triple/</p>
</blockquote>



<a name="204002449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204002449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204002449">(Jul 15 2020 at 19:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455293464">PR Review Comment</a>:</p>
<blockquote>
<p>IIRC the C API already has <code>wasm_module_{serialize,deserialize}</code> so could those be implemented instead? (although these may also be good to keep around for better error messages)</p>
</blockquote>



<a name="204004593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204004593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204004593">(Jul 15 2020 at 19:56)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449283816">PR Review</a>.</p>



<a name="204004594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204004594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204004594">(Jul 15 2020 at 19:56)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455305292">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>Would it be possible to add this as a method as Module::serialize instead of a top-level function?</p>
</blockquote>
<p>Currently, I'm discarding some artifacts once <code>CompiledModule</code> is created due to memory usage. Keeping them around maybe wasteful at the moment. Also it is why I chose <code>wasmtime_compile_and_serialize</code> instead of <code>wasmtime_module_serialize</code>.</p>
</blockquote>



<a name="204004944"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204004944" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204004944">(Jul 15 2020 at 19:59)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449285807">PR Review</a>.</p>



<a name="204004945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204004945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204004945">(Jul 15 2020 at 19:59)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455306857">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>Is this intended to be <code>unsafe</code>? Ideally we'd have this be a safe function I think.</p>
</blockquote>
<p>I mentioned that it is marked unsafe since it does not provide any guarantees for safety of the ingested code. We don't want deal with code signing and currently rely on caller to that.</p>
</blockquote>



<a name="204069133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204069133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204069133">(Jul 16 2020 at 10:57)</a>:</h4>
<p>tschneidereit submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449739186">PR Review</a>.</p>



<a name="204069134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204069134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204069134">(Jul 16 2020 at 10:57)</a>:</h4>
<p>tschneidereit created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455701948">PR Review Comment</a>:</p>
<blockquote>
<p>I wonder if we really want to mark this as unsafe. I get the intent behind it, but it's worth noting that the current API that transparently loads a cache entry if that exists has the same issue: since anybody could put whatever they want into the cache, the same "unsafety" exists.</p>
<p>@sunfishcode what's your take on this, do we have enough of a secure setup in place for the case where we are fully in control of the pipeline from compiling a wasm file to running it that we should call out the gap in safety like this?</p>
</blockquote>



<a name="204105026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204105026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204105026">(Jul 16 2020 at 16:04)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449995591">PR Review</a>.</p>



<a name="204105027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204105027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204105027">(Jul 16 2020 at 16:04)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455899553">PR Review Comment</a>:</p>
<blockquote>
<p>Oh sorry I missed the comment in the PR description! I would personally feel though that we shouldn't have <code>unsafe</code> here. I think it's a good point to document that arbitrary bytes here is not truly safe and this shouldn't be fed untrusted code, but that feels like such a far away enough use case that it's not worth making this <code>unsafe</code> as a result.</p>
</blockquote>



<a name="204105105"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204105105" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204105105">(Jul 16 2020 at 16:04)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-449996306">PR Review</a>.</p>



<a name="204105106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204105106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204105106">(Jul 16 2020 at 16:05)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455900020">PR Review Comment</a>:</p>
<blockquote>
<p>Could you expand a bit on what's not kept in memory? What's the scale of the memory usage improvement as well?</p>
</blockquote>



<a name="204107478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204107478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204107478">(Jul 16 2020 at 16:22)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-450011707">PR Review</a>.</p>



<a name="204107479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204107479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204107479">(Jul 16 2020 at 16:22)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455912109">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>Could you expand a bit on what's not kept in memory?</p>
</blockquote>
<p>Currently the answer is ELF image is modified by fixing relocation, so I'm just patching data directly. That makes image non-serializable as is. It needs to be re-cloned and "unpatched" to be serializable. Also there unwind_info we don't need to keep after <code>CompiledModule</code>. FWIW I'm currently working on both of these problems, but there are require some time and code to address.</p>
</blockquote>



<a name="204107620"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204107620" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204107620">(Jul 16 2020 at 16:23)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r455912109">PR Review Comment</a>.</p>



<a name="204132319"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204132319" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204132319">(Jul 16 2020 at 19:36)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-450157731">PR Review</a>.</p>



<a name="204132320"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204132320" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204132320">(Jul 16 2020 at 19:36)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r456028114">PR Review Comment</a>:</p>
<blockquote>
<p>Hm ok from an API perspective I think it'd be best to have <code>Module::serialize</code> for now, and perhaps we can address the performance issues later?</p>
</blockquote>



<a name="204146195"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204146195" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204146195">(Jul 16 2020 at 21:34)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> from <code>serde-module-example</code> to <code>main</code>:</p>
<blockquote>
<p>Fixes #1779 </p>
<p>This is final patch in series to allow direct access to the compiled code.</p>
<ul>
<li>Added <code>compile_and_serialize</code> API function that allows to save <code>CompilationArtifacts</code> object in binary format (+target/config fingerprint)</li>
<li>Added unsafe <code>Module::deserialize</code> API function that allows to read the above data and create <code>Module</code> object. Marked unsafe since it does not provide any guarantees for safety of the ingested code.</li>
<li>Portability limitation is that producer and consumer's<code>Config</code>s must have the same host triple, codegen flags, and <code>Tunables</code>. (Can we ignore <code>CompilerStrategy</code>?)</li>
</ul>
<p>PR opened for feedback.</p>
</blockquote>



<a name="204150767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204150767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204150767">(Jul 16 2020 at 22:21)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> from <code>serde-module-example</code> to <code>main</code>:</p>
<blockquote>
<p>Fixes #1779 </p>
<p>This is final patch in series to allow direct access to the compiled code.</p>
<ul>
<li>Added <code>compile_and_serialize</code> API function that allows to save <code>CompilationArtifacts</code> object in binary format (+target/config fingerprint)</li>
<li>Added unsafe <code>Module::deserialize</code> API function that allows to read the above data and create <code>Module</code> object. Marked unsafe since it does not provide any guarantees for safety of the ingested code.</li>
<li>Portability limitation is that producer and consumer's<code>Config</code>s must have the same host triple, codegen flags, and <code>Tunables</code>. (Can we ignore <code>CompilerStrategy</code>?)</li>
</ul>
<p>PR opened for feedback.</p>
</blockquote>



<a name="204150952"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204150952" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204150952">(Jul 16 2020 at 22:23)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-450256916">PR Review</a>.</p>



<a name="204150954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204150954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204150954">(Jul 16 2020 at 22:23)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#discussion_r456111901">PR Review Comment</a>:</p>
<blockquote>
<p>I took shortcut and start keeping data in <code>CompiledModule</code> that allows implement <code>Module::serialize</code>. I'll continue working on optimizing this part independent of this PR.</p>
</blockquote>



<a name="204154989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204154989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204154989">(Jul 16 2020 at 23:20)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> from <code>serde-module-example</code> to <code>main</code>:</p>
<blockquote>
<p>Fixes #1779 </p>
<p>This is final patch in series to allow direct access to the compiled code.</p>
<ul>
<li>Added <code>compile_and_serialize</code> API function that allows to save <code>CompilationArtifacts</code> object in binary format (+target/config fingerprint)</li>
<li>Added unsafe <code>Module::deserialize</code> API function that allows to read the above data and create <code>Module</code> object. Marked unsafe since it does not provide any guarantees for safety of the ingested code.</li>
<li>Portability limitation is that producer and consumer's<code>Config</code>s must have the same host triple, codegen flags, and <code>Tunables</code>. (Can we ignore <code>CompilerStrategy</code>?)</li>
</ul>
<p>PR opened for feedback.</p>
</blockquote>



<a name="204155042"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204155042" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204155042">(Jul 16 2020 at 23:21)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a> from <code>serde-module-example</code> to <code>main</code>:</p>
<blockquote>
<p>Fixes #1779 </p>
<p>This is final patch in series to allow direct access to the compiled code.</p>
<ul>
<li>Added <code>compile_and_serialize</code> API function that allows to save <code>CompilationArtifacts</code> object in binary format (+target/config fingerprint)</li>
<li>Added unsafe <code>Module::deserialize</code> API function that allows to read the above data and create <code>Module</code> object. Marked unsafe since it does not provide any guarantees for safety of the ingested code.</li>
<li>Portability limitation is that producer and consumer's<code>Config</code>s must have the same host triple, codegen flags, and <code>Tunables</code>. (Can we ignore <code>CompilerStrategy</code>?)</li>
</ul>
<p>PR opened for feedback.</p>
</blockquote>



<a name="204587761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204587761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204587761">(Jul 21 2020 at 18:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2020#pullrequestreview-452741918">PR Review</a>.</p>



<a name="204596745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232020%20Serialize%20and%20deserialize%20compilation.../near/204596745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232020.20Serialize.20and.20deserialize.20compilation.2E.2E.2E.html#204596745">(Jul 21 2020 at 20:05)</a>:</h4>
<p>yurydelendik merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2020">PR #2020</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>