<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4669 wasmtime run -g fails with &#x27;assert... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html">wasmtime / issue #4669 wasmtime run -g fails with &#x27;assert...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="292692154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/292692154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#292692154">(Aug 10 2022 at 04:32)</a>:</h4>
<p>tiran opened <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="292692155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/292692155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#292692155">(Aug 10 2022 at 04:32)</a>:</h4>
<p>tiran labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="292794687"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/292794687" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#292794687">(Aug 10 2022 at 17:01)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/4669#issuecomment-1210997950">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>@tiran thanks for the report!</p>
<p>We currently don't have anyone on the project who understands our DWARF-handling code well  and has time to work on it; so while this is definitely a bug, it's not likely to have a fast resolution. We do have an intent to have someone eventually focus on this, as priorities allow, so we should keep this issue open. Just wanted to give some context on the current situation...</p>
</blockquote>



<a name="296620646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/296620646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#296620646">(Sep 01 2022 at 15:41)</a>:</h4>
<p>jameysharp pinned <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="299215989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/299215989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#299215989">(Sep 16 2022 at 18:11)</a>:</h4>
<p>akirilov-arm unpinned <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="299216293"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/299216293" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#299216293">(Sep 16 2022 at 18:13)</a>:</h4>
<p>akirilov-arm pinned <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="302347446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/302347446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#302347446">(Oct 04 2022 at 21:08)</a>:</h4>
<p>alexcrichton unpinned <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="313402636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/313402636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#313402636">(Dec 02 2022 at 00:02)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>wasmtime panics and fails for me every time I try to run Python's WASI builds with <code>wasmtime run -g</code> (Generate debug information).</p>
<h3>Test Case</h3>
<p><a href="https://github.com/tiran/cpython-wasm-test/releases/download/v3.11.0rc1/Python-3.11.0rc1-wasm32-wasi-16.zip">Python-3.11.0rc1-wasm32-wasi-16.zip</a></p>
<h3>Steps to Reproduce</h3>
<p><code>wasmtime run -g --dir . -- python.wasm -c pass</code></p>
<h3>Expected Results</h3>
<p>I'm able to execute Python 3.11 WASI build with DWARF debug symbols.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">python</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">pass</span><span class="w"></span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">817</span><span class="err">`</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">816</span><span class="err">`</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">transform</span><span class="o">/</span><span class="n">expression</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">690</span>:<span class="mi">13</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">584</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">e092d0b6b43f2de967af0887873151bb1c0b18d3</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">ValueLabelRangesBuilder</span>::<span class="n">process_label</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">expression</span>::<span class="n">CompiledExpression</span>::<span class="n">build_with_locals</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">attr</span>::<span class="n">clone_die_attributes</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">unit</span>::<span class="n">clone_unit</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">transform</span>::<span class="n">transform_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_cranelift</span>::<span class="n">debug</span>::<span class="n">write_debuginfo</span>::<span class="n">emit_dwarf</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="o">&lt;</span><span class="n">wasmtime_cranelift</span>::<span class="n">compiler</span>::<span class="n">Compiler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_environ</span>::<span class="n">compilation</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">emit_obj</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">build_artifacts</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime_cache</span>::<span class="n">ModuleCacheEntry</span>::<span class="n">get_data_raw</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_file</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">load_module</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">wasmtime_cli</span>::<span class="n">commands</span>::<span class="n">run</span>::<span class="n">RunCommand</span>::<span class="n">execute</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">wasmtime</span>::<span class="n">main</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 0.39.1</p>
<p>Operating system: Fedora</p>
<p>Architecture: x86_64</p>
<p>WASI-SDK: 16.0</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="313402637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234669%20wasmtime%20run%20-g%20fails%20with%20%27assert.../near/313402637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234669.20wasmtime.20run.20-g.20fails.20with.20.27assert.2E.2E.2E.html#313402637">(Dec 02 2022 at 00:02)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/4669#issuecomment-1334597136">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4669">issue #4669</a>:</p>
<blockquote>
<p>Closing as a duplicate of <a href="https://github.com/bytecodealliance/wasmtime/issues/3999">https://github.com/bytecodealliance/wasmtime/issues/3999</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>