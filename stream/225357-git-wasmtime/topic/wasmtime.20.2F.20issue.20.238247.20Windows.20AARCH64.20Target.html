<html>
<head><meta charset="utf-8"><title>wasmtime / issue #8247 Windows AARCH64 Target · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html">wasmtime / issue #8247 Windows AARCH64 Target</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="429794424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/429794424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#429794424">(Mar 27 2024 at 06:48)</a>:</h4>
<p>andrewmd5 edited <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>Thanks for filing a feature request! Please fill out the TODOs below.</p>
<h4>Feature</h4>
<p>Compile the C API and produce ARM64 builds for Windows</p>
<h4>Benefit</h4>
<p>Will unblock <a href="http://this%20issue">https://github.com/bytecodealliance/wasmtime-dotnet/issues/298</a> in the wasmtime-dotnet package</p>
<p>Not sure if the wheel exist for this yet; in terms of infrastructure cross compilation on Github Actions should be possible, but if necessary I’m happy to deploy some new self-hosted runners to power this feature.</p>
</blockquote>



<a name="429794737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/429794737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#429794737">(Mar 27 2024 at 06:51)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2022076515">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>This depends on #4992 -- a little bit of core runtime functionality (trap handling, unwind info generation) necessary for this OS/architecture pair. If you're willing to work on this, we'd be happy to review a PR!</p>
</blockquote>



<a name="429800162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/429800162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#429800162">(Mar 27 2024 at 07:41)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Compile the C API and produce ARM64 builds for Windows</p>
<h4>Benefit</h4>
<p>Will unblock <a href="https://github.com/bytecodealliance/wasmtime-dotnet/issues/298">this issue</a> in the wasmtime-dotnet package</p>
<p>Not sure if the wheel exist for this yet; in terms of infrastructure cross compilation on Github Actions should be possible, but if necessary I’m happy to deploy some new self-hosted runners to power this feature.</p>
</blockquote>



<a name="429801098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/429801098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#429801098">(Mar 27 2024 at 07:49)</a>:</h4>
<p>andrewmd5 <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2022143782">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<blockquote>
<p>This depends on #4992 -- a little bit of core runtime functionality (trap handling, unwind info generation) necessary for this OS/architecture pair. If you're willing to work on this, we'd be happy to review a PR!</p>
</blockquote>
<p>Thank you for linking the relevant issue; I’ll take a look and see about submitting a PR.</p>
</blockquote>



<a name="429871404"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/429871404" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#429871404">(Mar 27 2024 at 14:25)</a>:</h4>
<p><a href="https://github.com/alexcrichton">alexcrichton</a> added the wasmtime:platform-support label to <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">Issue #8247</a>.</p>



<a name="473866281"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/473866281" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#473866281">(Sep 30 2024 at 21:48)</a>:</h4>
<p>dpaoliello <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2384213910">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>I've been trying to get <code>rustc_codegen_cranelift</code> working with Windows ARM64, but I've run into an issue with alignment.</p>
<p>My work-in-progress branch is available at &lt;<a href="https://github.com/dpaoliello/wasmtime/tree/arm64wip">https://github.com/dpaoliello/wasmtime/tree/arm64wip</a>&gt;</p>
<p>Current, when I run <code>y build</code>, a bunch of linker errors from link.exe complaining about the alignment of symbols:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">std</span><span class="o">-</span><span class="mi">0891</span><span class="n">cada1b439ffb</span><span class="p">.</span><span class="n">dq2m4pkr5rfjx0xrog6ne1sfh</span><span class="p">.</span><span class="n">rcgu</span><span class="p">.</span><span class="n">o</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nc">error</span><span class="w"> </span><span class="n">LNK2048</span><span class="p">:</span><span class="w"> </span><span class="nc">relocation</span><span class="w"> </span><span class="n">PAGEOFFSET_12L</span><span class="w"> </span><span class="n">targeting</span><span class="w"> </span><span class="o">'</span><span class="na">memcpy</span><span class="o">'</span><span class="w"> </span><span class="p">(</span><span class="mi">0019</span><span class="n">EE84</span><span class="p">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="p">(</span><span class="n">F9400084</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">RVA</span><span class="w"> </span><span class="mi">000</span><span class="n">D6C84</span><span class="p">)</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="mh">0x1</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="mh">0x137C</span><span class="p">,</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="n">alignment</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">(</span><span class="n">E84</span><span class="p">);</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">aligned</span>
</code></pre></div>
<p>Import thing from that output is that <code>memcpy</code> is being located at <code>0019EE84</code>, which is not 8 byte aligned.</p>
<p>I've tried setting the function alignment to 8: &lt;<a href="https://github.com/dpaoliello/wasmtime/blob/e7184160fe909864c767177de17729f876c0da60/cranelift/codegen/src/isa/aarch64/inst/mod.rs#L1184">https://github.com/dpaoliello/wasmtime/blob/e7184160fe909864c767177de17729f876c0da60/cranelift/codegen/src/isa/aarch64/inst/mod.rs#L1184</a>&gt;</p>
<p>And the symbol alignment to 8:<br>
&lt;<a href="https://github.com/dpaoliello/wasmtime/blob/e7184160fe909864c767177de17729f876c0da60/cranelift/codegen/src/isa/mod.rs#L430">https://github.com/dpaoliello/wasmtime/blob/e7184160fe909864c767177de17729f876c0da60/cranelift/codegen/src/isa/mod.rs#L430</a>&gt;</p>
<p>But neither seems to have fixed this - any idea what I'm doing wrong?</p>
</blockquote>



<a name="473879520"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/473879520" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#473879520">(Sep 30 2024 at 22:56)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2384316525">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>I think <code>memcpy</code> would be defined in the libc-equivalent-windows-has, which might be why changing Cranelift's function/symbol alignment didn't work? How sure are you the <code>memcpy</code> function itself is created by Cranelift?</p>
<p>If it's not created by Cranelift this might be something where we're generating the wrong relocation against <code>memcpy</code> perhaps? Where the one we're generating requires 8-byte alignment but we should be using something else that doesn't require 8-byte alignment?</p>
</blockquote>



<a name="474631202"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/474631202" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#474631202">(Oct 03 2024 at 16:13)</a>:</h4>
<p>dpaoliello <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2391811165">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>It's not <code>memcpy</code> specifically, I'm also seeing a bunch of Win32 function, so it's likely any external symbol that the obj is referencing. I'm not familiar with how external symbols are represented in obj files, or how cranelift places them there, so I'll have to dig into this further when I have time.</p>
</blockquote>



<a name="482912784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/482912784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#482912784">(Nov 18 2024 at 01:21)</a>:</h4>
<p>dpaoliello <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2481742291">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>Ok, I finally understand what's happening here.</p>
<p>When emitting a call, wasmtime emits it as <code>LoadExtName</code> then the call indirect:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/e56ffd77f1fb2240e163b7f840f8c4e728c98434/cranelift/codegen/src/isa/aarch64/abi.rs#L1041-L1045">https://github.com/bytecodealliance/wasmtime/blob/e56ffd77f1fb2240e163b7f840f8c4e728c98434/cranelift/codegen/src/isa/aarch64/abi.rs#L1041-L1045</a></p>
<p><code>LoadExtName</code> always get lowered and the page base + page offset reloc:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/e56ffd77f1fb2240e163b7f840f8c4e728c98434/cranelift/codegen/src/isa/aarch64/inst/emit.rs#L3165-L3185">https://github.com/bytecodealliance/wasmtime/blob/e56ffd77f1fb2240e163b7f840f8c4e728c98434/cranelift/codegen/src/isa/aarch64/inst/emit.rs#L3165-L3185</a></p>
<p>That type of reloc needs to be 8 byte aligned, however functions (at least on Windows, not sure about other platforms) aren't guaranteed to be 8 byte aligned, thus the linker complains.</p>
<p>When I look at code generated by LLVM, I see branch26 relocs being emitted for called functions, which seems to be generated by this:<br>
<a href="https://github.com/llvm/llvm-project/blob/18ee00323f5fc22d32a74b636fcac84e697241f3/llvm/lib/Target/AArch64/MCTargetDesc/AArch64MCCodeEmitter.cpp#L459-L478">https://github.com/llvm/llvm-project/blob/18ee00323f5fc22d32a74b636fcac84e697241f3/llvm/lib/Target/AArch64/MCTargetDesc/AArch64MCCodeEmitter.cpp#L459-L478</a></p>
<p>I'm not entirely sure how to handle implementing this in wasmtime with the abstraction between <a href="http://abi.rs">abi.rs</a> and <a href="http://emit.rs">emit.rs</a>.</p>
</blockquote>



<a name="482913262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/482913262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#482913262">(Nov 18 2024 at 01:27)</a>:</h4>
<p>dpaoliello <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2481746556">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>And, just to confound things, sometimes LLVM will generate a page base + page offset for a call: &lt;<a href="https://godbolt.org/z/3c7ce1vP4">https://godbolt.org/z/3c7ce1vP4</a>&gt;</p>
</blockquote>



<a name="483071518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/483071518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#483071518">(Nov 18 2024 at 16:46)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2483574196">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>Is there a relocation that doesn't need to be 8-byte aligned we could use? I'm a bit surprised by that godbolt link because</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">example</span><span class="p">::</span><span class="n">call_yep</span><span class="p">::</span><span class="n">h3f70d43527bee11a</span><span class="p">:</span>
<span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w">     </span><span class="kt">str</span><span class="w">     </span><span class="nc">x30</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="p">#</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span><span class="o">!</span>
<span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w">     </span><span class="nc">adrp</span><span class="w">    </span><span class="n">x8</span><span class="p">,</span><span class="w"> </span><span class="n">__imp_yep</span>
<span class="w"> </span><span class="mi">8</span><span class="p">:</span><span class="w">     </span><span class="nc">ldr</span><span class="w">     </span><span class="n">x8</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x8</span><span class="p">,</span><span class="w"> </span><span class="p">:</span><span class="nc">lo12</span><span class="p">:</span><span class="nc">__imp_yep</span><span class="p">]</span>
<span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="w">     </span><span class="nc">blr</span><span class="w">     </span><span class="n">x8</span>
<span class="mi">10</span><span class="p">:</span><span class="w">     </span><span class="nc">adrp</span><span class="w">    </span><span class="n">x8</span><span class="p">,</span><span class="w"> </span><span class="n">__imp_X</span>
<span class="mi">14</span><span class="p">:</span><span class="w">     </span><span class="nc">ldr</span><span class="w">     </span><span class="n">x8</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x8</span><span class="p">,</span><span class="w"> </span><span class="p">:</span><span class="nc">lo12</span><span class="p">:</span><span class="nc">__imp_X</span><span class="p">]</span>
<span class="mi">18</span><span class="p">:</span><span class="w">     </span><span class="nc">ldr</span><span class="w">     </span><span class="n">w8</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">x8</span><span class="p">]</span>
<span class="mi">1</span><span class="n">c</span><span class="p">:</span><span class="w">     </span><span class="nc">madd</span><span class="w">    </span><span class="n">w0</span><span class="p">,</span><span class="w"> </span><span class="n">w8</span><span class="p">,</span><span class="w"> </span><span class="n">w8</span><span class="p">,</span><span class="w"> </span><span class="n">w0</span>
<span class="mi">20</span><span class="p">:</span><span class="w">     </span><span class="nc">ldr</span><span class="w">     </span><span class="n">x30</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">sp</span><span class="p">],</span><span class="w"> </span><span class="p">#</span><span class="mi">16</span>
<span class="mi">24</span><span class="p">:</span><span class="w">     </span><span class="nc">ret</span>
</code></pre></div>
<p>Here <code>adrp</code> falls on both an 8-byte and non-8-byte aligned boundary (0x4/0x10). How does that work if it's required to be 8-byte aligned? Or is the assembler hiding a <code>nop</code> instruction or something like that? </p>
<p>If we need these relocations to be 8-byte aligned in Cranelift it would probably look like:</p>
<ul>
<li>Guarantee all functions are 8-byte-aligned (I think some are 4-byte-aligned right now)</li>
<li>When emitting this relocation if the current offset is 4-byte aligned then emit a nop to make it 8-byte aligned.</li>
</ul>
<p>I'm mostly surprised that LLVM doesn't seem to be doing anything with nops but from what you're saying it should work?</p>
</blockquote>



<a name="483083720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/483083720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#483083720">(Nov 18 2024 at 17:44)</a>:</h4>
<p>dpaoliello <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2483715772">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>Sorry, bit of confusion, the <em>target</em> of the reloc needs to be 8 byte aligned, not the reloc or consuming instruction.</p>
</blockquote>



<a name="483085336"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/483085336" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#483085336">(Nov 18 2024 at 17:51)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2483731088">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>Aha that makes more sense! (I should also read more carefully...)</p>
<p>This might be as simple as <a href="https://github.com/bytecodealliance/wasmtime/blob/d79555add5b0d457362af46538af6209c1e057d7/cranelift/codegen/src/isa/aarch64/inst/mod.rs#L1173">updating this value</a>? That could perhaps have a comment for now saying only Windows so far requires 8-byte alignment but it's easier to bump all platforms to 8-byte so that's why it's unconditionally a minimum of 8 for now.</p>
</blockquote>



<a name="483086349"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/483086349" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#483086349">(Nov 18 2024 at 17:56)</a>:</h4>
<p>dpaoliello <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2483741172">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>That helps: it at least means that any function in the current compilation can be the target of a reloc.<br>
But I'm also seeing the linker complain about Win32 functions and parts of the CRT.</p>
</blockquote>



<a name="483088966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238247%20Windows%20AARCH64%20Target/near/483088966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238247.20Windows.20AARCH64.20Target.html#483088966">(Nov 18 2024 at 18:09)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/8247#issuecomment-2483775461">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8247">issue #8247</a>:</p>
<blockquote>
<p>Oh dear sorry I'm being particularly slow at understanding this, you've already told me that historically as well...</p>
<p>Is this perhaps something related to dllimport or something like that? Where memcpy should be imported via dllimport and some slightly different form of relocation is something the linker handles when fixing it up? Otherwise I'll probably step aside as I'm probably out of my depth here...</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>