<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5581 winch: Use cranelift-codegen x64 back... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html">wasmtime / PR #5581 winch: Use cranelift-codegen x64 back...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="321847236"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321847236" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321847236">(Jan 17 2023 at 14:45)</a>:</h4>
<p>saulecabrera opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5581">PR #5581</a> from <code>winch-codegen-use-x64-backend</code> to <code>main</code>:</p>
<blockquote>
<p>This change substitutes the string based emission mechanism with cranelift-codegen's x64 backend.</p>
<p>This change _does not_:</p>
<ul>
<li>Introduce new functionality in terms of supported instructions.</li>
<li>Change the semantics of the assembler/macroassembler in terms of the logic to emit instructions.</li>
</ul>
<p>The most notable differences between this change and the previous version are:</p>
<ul>
<li>Handling of shared flags and ISA-specific flags, which for now are left with the default value.</li>
<li>Simplification of instruction emission per operand size: previously the assembler defined different methods depending on the operand size (e.g. <code>mov</code> for 64 bits, and <code>movl</code> for 32 bits). This change updates such approach so that each assembler method takes an operand size as a parameter, reducing duplication and making the code more concise and easier to integrate with the x64's <code>Inst</code> enum.</li>
<li>Introduction of a disassembler for testing purposes.</li>
</ul>
<p>As of this change, Winch generates the following code for the following test programs:</p>
<div class="codehilite" data-code-language="WebAssembly"><pre><span></span><code><span class="p">(</span><span class="k">module</span>
  <span class="p">(</span><span class="k">export</span> <span class="s2">"main"</span> <span class="p">(</span><span class="k">func</span> <span class="nv">$main</span><span class="p">))</span>

  <span class="p">(</span><span class="k">func</span> <span class="nv">$main</span> <span class="p">(</span><span class="k">result</span> <span class="kt">i32</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">i32.const</span> <span class="mi">10</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">i32.const</span> <span class="mi">20</span><span class="p">)</span>
        <span class="nb">i32.add</span>
        <span class="p">))</span>
</code></pre></div>
<div class="codehilite" data-code-language="GAS"><pre><span></span><code><span class="w">   </span><span class="err">0:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span><span class="w"></span>
<span class="w">   </span><span class="err">1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="w"></span>
<span class="w">   </span><span class="err">4:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">0</span><span class="no">a</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0xa</span><span class="w"></span>
<span class="w">   </span><span class="err">9:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">14</span><span class="w">                </span><span class="no">add</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0x14</span><span class="w"></span>
<span class="w">   </span><span class="nl">c:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w"> </span><span class="no">rbp</span><span class="w"></span>
<span class="w">   </span><span class="nl">d:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"></span>
</code></pre></div>
<div class="codehilite" data-code-language="WebAssembly"><pre><span></span><code><span class="p">(</span><span class="k">module</span>
  <span class="p">(</span><span class="k">export</span> <span class="s2">"main"</span> <span class="p">(</span><span class="k">func</span> <span class="nv">$main</span><span class="p">))</span>

  <span class="p">(</span><span class="k">func</span> <span class="nv">$main</span> <span class="p">(</span><span class="k">result</span> <span class="kt">i32</span><span class="p">)</span>
        <span class="p">(</span><span class="k">local</span> <span class="nv">$foo</span> <span class="kt">i32</span><span class="p">)</span>
    <span class="p">(</span><span class="k">local</span> <span class="nv">$bar</span> <span class="kt">i32</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">i32.const</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">local.set</span> <span class="nv">$foo</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">i32.const</span> <span class="mi">20</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">local.set</span> <span class="nv">$bar</span><span class="p">)</span>

        <span class="p">(</span><span class="nb">local.get</span> <span class="nv">$foo</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">local.get</span> <span class="nv">$bar</span><span class="p">)</span>
        <span class="nb">i32.add</span>
        <span class="p">))</span>
</code></pre></div>
<div class="codehilite" data-code-language="GAS"><pre><span></span><code><span class="w">   </span><span class="err">0:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span><span class="w"></span>
<span class="w">   </span><span class="err">1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="w"></span>
<span class="w">   </span><span class="err">4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">sub</span><span class="w"> </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">   </span><span class="err">8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c7</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="no">mov</span><span class="w"> </span><span class="no">qword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">  </span><span class="err">10:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">0</span><span class="no">a</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0xa</span><span class="w"></span>
<span class="w">  </span><span class="err">15:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">44</span><span class="w"> </span><span class="err">24</span><span class="w"> </span><span class="err">04</span><span class="w">             </span><span class="nf">mov</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="w">  </span><span class="err">19:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0x14</span><span class="w"></span>
<span class="w">  </span><span class="err">1</span><span class="nl">e:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">04</span><span class="w"> </span><span class="err">24</span><span class="w">                </span><span class="nf">mov</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="w">  </span><span class="err">21:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">24</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="err">24:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">mov</span><span class="w"> </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="err">28:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c1</span><span class="w">                   </span><span class="no">add</span><span class="w"> </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="w">  </span><span class="err">2</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c8</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">rcx</span><span class="w"></span>
<span class="w">  </span><span class="err">2</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w"> </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">  </span><span class="err">31:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w"> </span><span class="no">rbp</span><span class="w"></span>
<span class="w">  </span><span class="err">32:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"></span>
</code></pre></div>
<div class="codehilite" data-code-language="WebAssembly"><pre><span></span><code><span class="p">(</span><span class="k">module</span>
  <span class="p">(</span><span class="k">export</span> <span class="s2">"main"</span> <span class="p">(</span><span class="k">func</span> <span class="nv">$main</span><span class="p">))</span>

  <span class="p">(</span><span class="k">func</span> <span class="nv">$main</span> <span class="p">(</span><span class="k">param</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">(</span><span class="k">param</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">(</span><span class="k">result</span> <span class="kt">i32</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">local.get</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">local.get</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">i32.add</span>
        <span class="p">))</span>
</code></pre></div>
<div class="codehilite" data-code-language="GAS"><pre><span></span><code><span class="w">   </span><span class="err">0:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span><span class="w"></span>
<span class="w">   </span><span class="err">1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="w"></span>
<span class="w">   </span><span class="err">4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">sub</span><span class="w"> </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">   </span><span class="err">8:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">mov</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="no">edi</span><span class="w"></span>
<span class="w">   </span><span class="nl">c:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">34</span><span class="w"> </span><span class="err">24</span><span class="w">                </span><span class="nf">mov</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="p">],</span><span class="w"> </span><span class="no">esi</span><span class="w"></span>
<span class="w">   </span><span class="nl">f:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">24</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="err">12:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">mov</span><span class="w"> </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="err">16:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c1</span><span class="w">                   </span><span class="no">add</span><span class="w"> </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w"></span>
<span class="w">  </span><span class="err">18:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c8</span><span class="w">                </span><span class="no">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="no">rcx</span><span class="w"></span>
<span class="w">  </span><span class="err">1</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w"> </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">  </span><span class="err">1</span><span class="nl">f:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w"> </span><span class="no">rbp</span><span class="w"></span>
<span class="w">  </span><span class="err">20:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"></span>
</code></pre></div>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</li>
<li>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</li>
<li>[ ] This PR contains test cases, if meaningful.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="321847255"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321847255" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321847255">(Jan 17 2023 at 14:45)</a>:</h4>
<p><strong>saulecabrera</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/5581">PR #5581</a>.</p>



<a name="321854211"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321854211" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321854211">(Jan 17 2023 at 15:14)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1251756605">PR review</a>.</p>



<a name="321854212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321854212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321854212">(Jan 17 2023 at 15:14)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072337244">PR review comment</a>:</p>
<blockquote>
<p><code>isa::Builder</code> has a <code>triple()</code> method.</p>
</blockquote>



<a name="321937275"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321937275" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321937275">(Jan 17 2023 at 22:23)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252538694">PR review</a>.</p>



<a name="321937276"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321937276" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321937276">(Jan 17 2023 at 22:23)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252538694">PR review</a>.</p>



<a name="321937278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321937278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321937278">(Jan 17 2023 at 22:23)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072885569">PR review comment</a>:</p>
<blockquote>
<p>Could this dep be defined at the workspace level (and shared with clif-util) similar to the others above?</p>
</blockquote>



<a name="321937279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321937279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321937279">(Jan 17 2023 at 22:23)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072886352">PR review comment</a>:</p>
<blockquote>
<p>pre-existing but do we want to use <code>.and_then(|| self.emit_body(...))</code> and similar below as well? Otherwise if there's an error emitting the prologue we still emit the rest, then eventually return the error.</p>
</blockquote>



<a name="321937280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321937280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321937280">(Jan 17 2023 at 22:23)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072887781">PR review comment</a>:</p>
<blockquote>
<p>s/Crate/Create/ (and s/a x64/an x64/ if I'm being pedantic, though not too important!)</p>
</blockquote>



<a name="321947003"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321947003" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321947003">(Jan 17 2023 at 23:33)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252620936">PR review</a>.</p>



<a name="321947005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321947005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321947005">(Jan 17 2023 at 23:33)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072942980">PR review comment</a>:</p>
<blockquote>
<p>I considered it, but didn't because clif-util <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/Cargo.toml#L39">declares capstone as optional</a>, bound to the <code>disas</code> feature, and as far as I know workspace dependencies can't be optional. </p>
</blockquote>



<a name="321947423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321947423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321947423">(Jan 17 2023 at 23:37)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252623216">PR review</a>.</p>



<a name="321947424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321947424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321947424">(Jan 17 2023 at 23:37)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072944724">PR review comment</a>:</p>
<blockquote>
<p>Yeah, I noticed that, but I don't have a concrete use-case for it at the moment. I'll add one when needed. </p>
</blockquote>



<a name="321947538"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321947538" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321947538">(Jan 17 2023 at 23:38)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252623700">PR review</a>.</p>



<a name="321947540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321947540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321947540">(Jan 17 2023 at 23:38)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072945122">PR review comment</a>:</p>
<blockquote>
<p>Ah, right, that's fine then.</p>
</blockquote>



<a name="321949351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949351">(Jan 17 2023 at 23:55)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5581">PR #5581</a> from <code>winch-codegen-use-x64-backend</code> to <code>main</code>.</p>



<a name="321949538"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949538" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949538">(Jan 17 2023 at 23:56)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252635647">PR review</a>.</p>



<a name="321949539"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949539" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949539">(Jan 17 2023 at 23:56)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072954046">PR review comment</a>:</p>
<blockquote>
<p>Actually upon verification it works fine, my bad. I confused using a workspace dependency as optional vs _declaring_ a workspace dependency as optional; and the latter is what doesn't work. </p>
</blockquote>



<a name="321949557"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949557" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949557">(Jan 17 2023 at 23:57)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252635723">PR review</a>.</p>



<a name="321949558"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949558" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949558">(Jan 17 2023 at 23:57)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072954096">PR review comment</a>:</p>
<blockquote>
<p>Fixed!</p>
</blockquote>



<a name="321949565"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949565" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949565">(Jan 17 2023 at 23:57)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#pullrequestreview-1252635814">PR review</a>.</p>



<a name="321949567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/321949567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#321949567">(Jan 17 2023 at 23:57)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/5581#discussion_r1072954167">PR review comment</a>:</p>
<blockquote>
<p>Fixed!</p>
</blockquote>



<a name="322034405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235581%20winch%3A%20Use%20cranelift-codegen%20x64%20back.../near/322034405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235581.20winch.3A.20Use.20cranelift-codegen.20x64.20back.2E.2E.2E.html#322034405">(Jan 18 2023 at 11:58)</a>:</h4>
<p>saulecabrera merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5581">PR #5581</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>