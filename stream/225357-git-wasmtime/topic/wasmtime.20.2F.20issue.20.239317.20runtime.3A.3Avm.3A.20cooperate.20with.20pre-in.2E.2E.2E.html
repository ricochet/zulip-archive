<html>
<head><meta charset="utf-8"><title>wasmtime / issue #9317 runtime::vm: cooperate with pre-in... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239317.20runtime.3A.3Avm.3A.20cooperate.20with.20pre-in.2E.2E.2E.html">wasmtime / issue #9317 runtime::vm: cooperate with pre-in...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="472984176"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239317%20runtime%3A%3Avm%3A%20cooperate%20with%20pre-in.../near/472984176" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239317.20runtime.3A.3Avm.3A.20cooperate.20with.20pre-in.2E.2E.2E.html#472984176">(Sep 26 2024 at 22:43)</a>:</h4>
<p>ajwerner opened <a href="https://github.com/bytecodealliance/wasmtime/issues/9317">issue #9317</a>:</p>
<blockquote>
<h4>Feature</h4>
<p><code>wasmtime</code> today installs signal handlers that it uses to recover from traps that occur during the execution of a wasm program. This is very legit -- no problems there. The issue I have is that it appears that the signal handler installation throws away the existing signal handlers. That means if anybody else wants to interact with that signal, and, say, it occurs not when running wasm, they cannot. Instead, wasmtime should detect via some tls state whether the signal has occurred while inside a wasm call, and if not it should call through to the previous handler.</p>
<h4>Benefit</h4>
<p>This will allow wasmtime to be used in applications which themselves have signal handlers for various faults.</p>
<h4>Implementation</h4>
<p>A global variable to store the next signal handlers to call and some logic to decide whether the signal occurred within wasm.</p>
</blockquote>



<a name="472984336"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239317%20runtime%3A%3Avm%3A%20cooperate%20with%20pre-in.../near/472984336" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239317.20runtime.3A.3Avm.3A.20cooperate.20with.20pre-in.2E.2E.2E.html#472984336">(Sep 26 2024 at 22:44)</a>:</h4>
<p>ajwerner closed <a href="https://github.com/bytecodealliance/wasmtime/issues/9317">issue #9317</a>:</p>
<blockquote>
<h4>Feature</h4>
<p><code>wasmtime</code> today installs signal handlers that it uses to recover from traps that occur during the execution of a wasm program. This is very legit -- no problems there. The issue I have is that it appears that the signal handler installation throws away the existing signal handlers. That means if anybody else wants to interact with that signal, and, say, it occurs not when running wasm, they cannot. Instead, wasmtime should detect via some tls state whether the signal has occurred while inside a wasm call, and if not it should call through to the previous handler.</p>
<h4>Benefit</h4>
<p>This will allow wasmtime to be used in applications which themselves have signal handlers for various faults.</p>
<h4>Implementation</h4>
<p>A global variable to store the next signal handlers to call and some logic to decide whether the signal occurred within wasm.</p>
</blockquote>



<a name="472984337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239317%20runtime%3A%3Avm%3A%20cooperate%20with%20pre-in.../near/472984337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239317.20runtime.3A.3Avm.3A.20cooperate.20with.20pre-in.2E.2E.2E.html#472984337">(Sep 26 2024 at 22:44)</a>:</h4>
<p>ajwerner <a href="https://github.com/bytecodealliance/wasmtime/issues/9317#issuecomment-2378075097">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9317">issue #9317</a>:</p>
<blockquote>
<p>My mistake, got confused looking at <a href="https://github.com/bytecodealliance/wasmtime/blob/110e70f30e34b9df5ed4aaf401c8818c23204ca2/examples/min-platform/embedding/wasmtime-platform.c#L99-L119">https://github.com/bytecodealliance/wasmtime/blob/110e70f30e34b9df5ed4aaf401c8818c23204ca2/examples/min-platform/embedding/wasmtime-platform.c#L99-L119</a>. It does the right thing! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> </p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>