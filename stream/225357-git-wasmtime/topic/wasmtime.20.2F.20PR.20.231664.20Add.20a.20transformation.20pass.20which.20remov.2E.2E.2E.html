<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1664 Add a transformation pass which remov... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html">wasmtime / PR #1664 Add a transformation pass which remov...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="196595803"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196595803" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196595803">(May 06 2020 at 07:17)</a>:</h4>
<p>julian-seward1 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1664" title="https://github.com/bytecodealliance/wasmtime/pull/1664">PR #1664</a> from <code>remove-constant-phis</code> to <code>master</code>:</p>
<blockquote>
<p>…onstrate</p>
<p>that only one value ever flows.  Has been observed to improve generated code<br>
run times by up to 8%.  Compilation cost increases by about 0.6%, but up to 7%<br>
total cost has been observed to be saved; iow it can be a significant win in<br>
terms of compilation time, overall.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="196595804"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196595804" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196595804">(May 06 2020 at 07:17)</a>:</h4>
<p><strong>julian-seward1</strong> requested <a href="https://github.com/cfallin" title="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1664" title="https://github.com/bytecodealliance/wasmtime/pull/1664">PR #1664</a>.</p>



<a name="196660680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660680">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-406761661" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-406761661">PR Review</a>.</p>



<a name="196660681"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660681" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660681">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-406761661" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-406761661">PR Review</a>.</p>



<a name="196660682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660682">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420908406" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420908406">PR Review Comment</a>:</p>
<blockquote>
<p>tiny, tiny nit: s/arm64/AArch64/ (we did a bulk find/replace during merge and have tried to standardize on the official name as far as we can)</p>
</blockquote>



<a name="196660683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660683">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420909080" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420909080">PR Review Comment</a>:</p>
<blockquote>
<p>since <code>AbstractValue</code> is <code>Copy</code>, the params can be <code>self, other: AbstractValue</code> and the dereferences below can be removed.</p>
</blockquote>



<a name="196660684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660684">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420909904" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420909904">PR Review Comment</a>:</p>
<blockquote>
<p>We should be able to just add <code>PartialEq, Eq</code> to the <code>#[derive(...)]</code> and get equality automatically, no?</p>
</blockquote>



<a name="196660686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660686">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420913914" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420913914">PR Review Comment</a>:</p>
<blockquote>
<p>It sounds like in practice this converges quickly, but I wonder if it might be worth using a worklist-of-blocks-with-changed-input-state algorithm instead (see e.g. the dataflow analysis in the regalloc checker) to avoid a potential worst case where a small subgraph takes a while to converge within a large function body?</p>
</blockquote>



<a name="196660687"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660687" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660687">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420912369" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420912369">PR Review Comment</a>:</p>
<blockquote>
<p>Might be worth a comment here that multi-dest transfers (i.e., branch tables) don't carry parameters in our IR, so we only have to care about <code>SingleDest</code> here. (At least my intuition from most analyses otherwise is that one has to consider every CFG edge, which of course isn't the case here.)</p>
</blockquote>



<a name="196660688"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660688" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660688">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420924566" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420924566">PR Review Comment</a>:</p>
<blockquote>
<p><code>for absval in state.absvals.values()</code>?</p>
</blockquote>



<a name="196660689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196660689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196660689">(May 06 2020 at 16:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420914714" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r420914714">PR Review Comment</a>:</p>
<blockquote>
<p><code>for (formal, actual) in dst_formals.iter().zip(src_actuals.iter())</code>?</p>
</blockquote>



<a name="196727133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196727133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196727133">(May 07 2020 at 04:54)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407147938" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407147938">PR Review</a>.</p>



<a name="196727134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196727134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196727134">(May 07 2020 at 04:54)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421238557" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421238557">PR Review Comment</a>:</p>
<blockquote>
<p>I was being paranoid here .. I wanted to be certain that nothing would mess up join and equality operations on the abstract values.  Could use derived Eq I suppose.</p>
</blockquote>



<a name="196727842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196727842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196727842">(May 07 2020 at 05:12)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407152963" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407152963">PR Review</a>.</p>



<a name="196727843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196727843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196727843">(May 07 2020 at 05:12)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421243208" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421243208">PR Review Comment</a>:</p>
<blockquote>
<p>For the liveness analysis in the register allocator, I used a worklist initialised in reverse postorder, plus a mechanism to avoid duplicates in the worklist (== all bells and whistles I could think of).  That achieves around 1.8-2.8 evaluations per block on average, for large functions.  From those experiments I saw that the by far the most important factor was to initialise the worklist in reverse postorder, and operate it as a queue thereafter.</p>
<p>This one does something simpler, which is to repeatedly visit the blocks in reverse postorder, until there are no changes.  Many inputs require 3 passes (3.0 evaluations per block), and the worst I saw, for <code>joey_big.clif</code>, required 4 passes.  For the following reasons, I concluded that using a worklist wasn't worth the extra complexity:</p>
<ul>
<li>
<p>given the above numbers, using a worklist wouldn't give a big reduction in the average evals per block</p>
</li>
<li>
<p>the worklist itself adds some overhead, and so does having an auxiliary mapping of block to bool, so as to be able to efficiently avoid inserting the same item in the worklist if it is already there</p>
</li>
<li>
<p>more than half the expense lies in Phase 1 (building the summaries) and in particular Phase 3 (editing the result); in particular removing formal parameters is expensive because CL's cost for removing just one formal parameter is linear in the number of formals, and that adds up when blocks have 300+ formals.</p>
</li>
<li>
<p>for a nonoptimising CLIF-&gt;aarch64 translation, this pass costs circa 0.6% in instruction counts, and will be correspondingly less in the opt_level=speed case.</p>
</li>
</ul>
<p>One simple thing I could do is to filter out summaries for blocks that have neither formal parameters nor actual parameters in their jumps, before iterating.  From what I've seen there are many such blocks and they can't possibly contribute anything to the overall result.</p>
</blockquote>



<a name="196746605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196746605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196746605">(May 07 2020 at 09:34)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421371064" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421371064">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>One simple thing I could do is to filter out summaries for blocks that have neither formal parameters nor actual parameters in their jumps, before iterating.</p>
</blockquote>
<p>I tried that.  For a couple of large tests, it roughly halved the number of summaries (meaning, from around 1/2 the number of blocks to around 1/4 the number of blocks) but reduced the overall insn count for the pass only by around 3%.  And the fixpointing is done over the summaries.  So the fixpointing cost must be pretty minimal already.</p>
<p>I'll leave this refinement in the respin patch.</p>
</blockquote>



<a name="196746606"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196746606" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196746606">(May 07 2020 at 09:34)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407305927" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407305927">PR Review</a>.</p>



<a name="196747716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196747716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196747716">(May 07 2020 at 09:45)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407314482" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407314482">PR Review</a>.</p>



<a name="196747717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196747717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196747717">(May 07 2020 at 09:45)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421378061" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421378061">PR Review Comment</a>:</p>
<blockquote>
<p>Good point.  Added.</p>
</blockquote>



<a name="196748334"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196748334" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196748334">(May 07 2020 at 09:51)</a>:</h4>
<p>julian-seward1 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421243208" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421243208">PR Review Comment</a>.</p>



<a name="196749031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196749031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196749031">(May 07 2020 at 09:59)</a>:</h4>
<p>julian-seward1 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1664" title="https://github.com/bytecodealliance/wasmtime/pull/1664">PR #1664</a> from <code>remove-constant-phis</code> to <code>master</code>:</p>
<blockquote>
<p>…onstrate</p>
<p>that only one value ever flows.  Has been observed to improve generated code<br>
run times by up to 8%.  Compilation cost increases by about 0.6%, but up to 7%<br>
total cost has been observed to be saved; iow it can be a significant win in<br>
terms of compilation time, overall.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="196753597"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196753597" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196753597">(May 07 2020 at 10:48)</a>:</h4>
<p><strong>julian-seward1</strong> requested <a href="https://github.com/cfallin" title="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1664" title="https://github.com/bytecodealliance/wasmtime/pull/1664">PR #1664</a>.</p>



<a name="196798809"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196798809" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196798809">(May 07 2020 at 16:50)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407652756" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407652756">PR Review</a>.</p>



<a name="196798810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196798810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196798810">(May 07 2020 at 16:50)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407652756" title="https://github.com/bytecodealliance/wasmtime/pull/1664#pullrequestreview-407652756">PR Review</a>.</p>



<a name="196798812"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196798812" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196798812">(May 07 2020 at 16:50)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421646048" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421646048">PR Review Comment</a>:</p>
<blockquote>
<p>Sounds good -- thanks for the detailed analysis!</p>
</blockquote>



<a name="196798813"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196798813" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196798813">(May 07 2020 at 16:50)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421648826" title="https://github.com/bytecodealliance/wasmtime/pull/1664#discussion_r421648826">PR Review Comment</a>:</p>
<blockquote>
<p>(detached from other thread because this line changed -- related to <code>Eq</code> discussion)</p>
<p>Yup, I'd prefer to stay idiomatic here and remove <code>fn equals</code>, using the derived <code>Eq</code> instead -- if the derived code isn't doing the right thing then we have bigger problems (and others who maintain the code in the future might expect to use <code>==</code> anyway).</p>
</blockquote>



<a name="196864043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196864043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196864043">(May 08 2020 at 07:08)</a>:</h4>
<p>julian-seward1 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1664" title="https://github.com/bytecodealliance/wasmtime/pull/1664">PR #1664</a> from <code>remove-constant-phis</code> to <code>master</code>:</p>
<blockquote>
<p>…onstrate</p>
<p>that only one value ever flows.  Has been observed to improve generated code<br>
run times by up to 8%.  Compilation cost increases by about 0.6%, but up to 7%<br>
total cost has been observed to be saved; iow it can be a significant win in<br>
terms of compilation time, overall.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="196866260"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231664%20Add%20a%20transformation%20pass%20which%20remov.../near/196866260" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231664.20Add.20a.20transformation.20pass.20which.20remov.2E.2E.2E.html#196866260">(May 08 2020 at 07:41)</a>:</h4>
<p>julian-seward1 merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1664" title="https://github.com/bytecodealliance/wasmtime/pull/1664">PR #1664</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>