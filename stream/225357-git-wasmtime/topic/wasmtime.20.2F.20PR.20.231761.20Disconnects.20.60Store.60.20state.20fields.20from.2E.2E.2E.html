<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1761 Disconnects `Store` state fields from... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html">wasmtime / PR #1761 Disconnects `Store` state fields from...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="198813195"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198813195" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198813195">(May 26 2020 at 19:54)</a>:</h4>
<p>yurydelendik opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompileModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompileModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198813942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198813942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198813942">(May 26 2020 at 20:00)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompileModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompileModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198813955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198813955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198813955">(May 26 2020 at 20:00)</a>:</h4>
<p><strong>yurydelendik</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a>.</p>



<a name="198823273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198823273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198823273">(May 26 2020 at 21:21)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompileModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompileModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198824191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198824191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198824191">(May 26 2020 at 21:30)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompileModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompileModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198824566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198824566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198824566">(May 26 2020 at 21:34)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompileModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompileModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198826617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198826617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198826617">(May 26 2020 at 21:56)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompileModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompileModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198826887"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198826887" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198826887">(May 26 2020 at 21:59)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompiledModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198829006"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198829006" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198829006">(May 26 2020 at 22:23)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Preliminary marked <code>CompiledModule</code> as <code>Send</code>+<code>Sync</code> for "<a href="http://frame_info.rs">frame_info.rs</a>" -- probably needs to be changed</li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198829016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198829016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198829016">(May 26 2020 at 22:23)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198831210"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198831210" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198831210">(May 26 2020 at 22:50)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198831999"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198831999" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198831999">(May 26 2020 at 22:58)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198905795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905795">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-419304003">PR Review</a>.</p>



<a name="198905796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905796">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-419304003">PR Review</a>.</p>



<a name="198905798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905798">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431209125">PR Review Comment</a>:</p>
<blockquote>
<p>The <code>Store</code> here internally looks to be the only reason that this is non-<code>Send</code>, right? If that's the case can we move the <code>Store</code> out, or better yet only take an <code>Engine</code> to compile a <code>module</code>?</p>
<p>This would require taking a <code>Store</code> argument to create an <code>Instance</code> but I think that's ok since <code>Linker</code> is the "ergonomic" way to create instances.</p>
<p>Additionally this would require, on instantiation, registration of JIT code ranges within a <code>Store</code> if a module hasn't previously been registered there, but I think that's ok?</p>
</blockquote>



<a name="198905799"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905799" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905799">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431206854">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW this is breaking on Windows, but I think it's fine to just skip this example and compile it as a no-op on Windows</p>
</blockquote>



<a name="198905800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905800">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431199590">PR Review Comment</a>:</p>
<blockquote>
<p>I'm personaly pretty wary of <code>Deref</code> unless it's used for smart pointers, so could this be removed to instead use <code>self.module</code> where necessary?</p>
</blockquote>



<a name="198905801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905801">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431211151">PR Review Comment</a>:</p>
<blockquote>
<p>This makes me a little uncomfortable using <code>Deref</code> like this. </p>
<p>The only reason for this, I believe, is keeping the <code>CodeMemory</code> alive, right? Since the memory management of <code>InstanceHandle</code> is detached from the handle itself (it happens in <code>Store</code> for the <code>wasmtime</code> crate), could the managment of <code>CodeMemory</code> move into <code>Store</code> as well?</p>
<p>For example could each <code>CompiledModule</code> store an <code>Arc&lt;CodeMemory&gt;</code>, and then we push a strong reference of that into a <code>Store</code> whenever a module is instantiated within a <code>Store</code>?</p>
</blockquote>



<a name="198905804"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905804" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905804">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431212114">PR Review Comment</a>:</p>
<blockquote>
<p><code>.find(...).is_some()</code> can be replaced with <code>.any(...)</code> as well</p>
</blockquote>



<a name="198905805"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905805" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905805">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431214547">PR Review Comment</a>:</p>
<blockquote>
<p>IIRC <code>SignatureRegistry</code> has a lock internally, could that be removed now in favor of just using the <code>RefCell</code> here for mutability?</p>
<p>I think that there's no need for <code>SignatureRegistry</code> to be synchronized, even in a shared memory world I think instances are still disconnected in that they can have different signature registries on each thread.</p>
</blockquote>



<a name="198905806"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198905806" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198905806">(May 27 2020 at 15:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431212821">PR Review Comment</a>:</p>
<blockquote>
<p>I think in general this probably isn't necessary if we do this registration at instantiation time instead of compile time for a <code>Module</code>. Once a <code>Module</code> is instantiated into a <code>Store</code> we never drop the <code>InstanceHandle</code> anyway, so it's permanently registered within a store, which means there's no need to remove.</p>
</blockquote>



<a name="198913572"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198913572" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198913572">(May 27 2020 at 16:03)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198916222"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198916222" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198916222">(May 27 2020 at 16:22)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198923283"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198923283" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198923283">(May 27 2020 at 17:16)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198923385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198923385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198923385">(May 27 2020 at 17:17)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198924062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198924062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198924062">(May 27 2020 at 17:22)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-419448223">PR Review</a>.</p>



<a name="198924063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198924063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198924063">(May 27 2020 at 17:22)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431313957">PR Review Comment</a>:</p>
<blockquote>
<p>I replaced <code>Deref&lt;Target = Module&gt;</code> with <code>InstanceContext</code>. I'm not convinced that <code>Store</code> is good location for <code>CodeMemory</code>. I understand that the end goal is to be capable to ditch entire <code>Module</code>/<code>CodeModule</code> even if <code>Instance</code> or its exports are present, but keep <code>CodeMemory</code> alive. Can we do it in follow up PRs?</p>
</blockquote>



<a name="198941696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198941696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198941696">(May 27 2020 at 19:37)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198941730"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198941730" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198941730">(May 27 2020 at 19:37)</a>:</h4>
<p><strong>yurydelendik</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> as ready for review.</p>



<a name="198941743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198941743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198941743">(May 27 2020 at 19:37)</a>:</h4>
<p><strong>yurydelendik</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a>.</p>



<a name="198941954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198941954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198941954">(May 27 2020 at 19:39)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-419550965">PR Review</a>.</p>



<a name="198941955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198941955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198941955">(May 27 2020 at 19:39)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r431397829">PR Review Comment</a>:</p>
<blockquote>
<p>I redesigned API to remove <code>Store</code> from <code>Module</code>. @alexcrichton can you take a look at this change before I proceed any further?</p>
</blockquote>



<a name="198944297"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198944297" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198944297">(May 27 2020 at 19:55)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="198954035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/198954035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#198954035">(May 27 2020 at 21:12)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199175180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175180">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-421076069">PR Review</a>.</p>



<a name="199175181"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175181" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175181">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-421076069">PR Review</a>.</p>



<a name="199175182"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175182" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175182">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432576334">PR Review Comment</a>:</p>
<blockquote>
<p>Since the <code>store</code> is now passed int to <code>Instance::new</code> I think this check for same-store-ness can be removed?</p>
</blockquote>



<a name="199175183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175183">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432581050">PR Review Comment</a>:</p>
<blockquote>
<p>One of the worries I have about this is that while an instance is alive it retains the entire <code>CompiledModule</code>. Not everything in <code>CompiledModule</code>, however, is used throughout the liftime of the instance. For example I think a number of internal maps here are also copied to the <code>InstanceHandle</code>. I think it'd be best if we could split this into two parts:</p>
<ul>
<li>Parts needed for the lifetime of the <code>InstanceHandle</code>. Some of this is required by the handle itself (like <code>Module</code>), others are simply required to stay alive for the duration of the instance (e.g. <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li>Other parts are only needed for introspection and instantiation. For example I think the <code>trampolines</code> map and <code>finished_functions</code> lists here are only needed temporarily, since their relevant bits are copied into the <code>InstanceHandle</code>.</li>
</ul>
<p>This is a relatively niche concern though and it's not like it's a radical change from what we have here. Could a FIXME and/or issue be left though for this future refactoring?</p>
</blockquote>



<a name="199175184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175184">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432576604">PR Review Comment</a>:</p>
<blockquote>
<p>I think this can probably be removed since it's only used for the one check in <code>wasm_instance_new</code> which I think we can also remove now too.</p>
</blockquote>



<a name="199175185"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175185" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175185">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432582073">PR Review Comment</a>:</p>
<blockquote>
<p>Could the deallocation that happens inside here happen outside of the logkc?</p>
</blockquote>



<a name="199175186"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175186" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175186">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432582317">PR Review Comment</a>:</p>
<blockquote>
<p>IIRC <code>let _ = foo</code> is a special idiom in Rust where it will run the dtor for <code>foo</code> immediately, rather than defer it to the end of the block. I think that means that the lock isn't held for the duration of this block?</p>
</blockquote>



<a name="199175187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175187">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432581907">PR Review Comment</a>:</p>
<blockquote>
<p>Could this allocation happen before the synchronization of the lock?</p>
</blockquote>



<a name="199175188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175188">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432582832">PR Review Comment</a>:</p>
<blockquote>
<p>I don't think that the <code>u32</code> here is used, right?</p>
<p>Also could this have documentation as to its purpose?</p>
</blockquote>



<a name="199175189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175189">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432585314">PR Review Comment</a>:</p>
<blockquote>
<p>Could an instance of <code>Compiler</code> be stored within the <code>Engine</code> itself, so the same instance is reused across all compilations? I think <code>Compiler</code> should be <code>Send</code> and <code>Sync</code> now right?</p>
</blockquote>



<a name="199175190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175190">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432584177">PR Review Comment</a>:</p>
<blockquote>
<p>How come this changed to <code>CompiledModule</code>? That's retaining a lot more information here than <code>Module</code> previously was</p>
</blockquote>



<a name="199175191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199175191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199175191">(May 29 2020 at 16:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r432583689">PR Review Comment</a>:</p>
<blockquote>
<p>Also as another note, this technically is still unsafe since we're not synchronized with anything else in the process that may be frobbing these symbols. Is there really no way we can rely on a gdb thing to do the synchronization for us?</p>
</blockquote>



<a name="199382718"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199382718" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199382718">(Jun 01 2020 at 15:27)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-421948219">PR Review</a>.</p>



<a name="199382719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199382719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199382719">(Jun 01 2020 at 15:27)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433302903">PR Review Comment</a>:</p>
<blockquote>
<p>No. This process shall control access to __jit_debug_descriptor -- added comment</p>
</blockquote>



<a name="199382745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199382745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199382745">(Jun 01 2020 at 15:27)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199383376"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199383376" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199383376">(Jun 01 2020 at 15:32)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-421952534">PR Review</a>.</p>



<a name="199383377"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199383377" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199383377">(Jun 01 2020 at 15:32)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433307447">PR Review Comment</a>:</p>
<blockquote>
<p>The gdb only known about <code>__jit_debug_descriptor</code> and sets breakpoint at <code>__jit_debug_register_code</code>. Locking access to __jit_debug_descriptor is the process chore -- gdb will traverse its data once process in the __jit_debug_register_code.</p>
</blockquote>



<a name="199383943"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199383943" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199383943">(Jun 01 2020 at 15:36)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199389732"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199389732" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199389732">(Jun 01 2020 at 16:22)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199406612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199406612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199406612">(Jun 01 2020 at 18:40)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199409217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199409217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199409217">(Jun 01 2020 at 19:03)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433429656">PR Review Comment</a>:</p>
<blockquote>
<p>Theoretically, yes, we can remove. It will drive wasmtime_instance_new signature change too, and renders wasm_module_share / wasm_module_obtain useless. I would like to defer this change for future work.</p>
</blockquote>



<a name="199409218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199409218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199409218">(Jun 01 2020 at 19:03)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422103604">PR Review</a>.</p>



<a name="199418111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418111">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422150528">PR Review</a>.</p>



<a name="199418112"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418112" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418112">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422150528">PR Review</a>.</p>



<a name="199418113"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418113" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418113">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433465935">PR Review Comment</a>:</p>
<blockquote>
<p>This might be best as a private method on <code>Config</code>?</p>
</blockquote>



<a name="199418114"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418114" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418114">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433465750">PR Review Comment</a>:</p>
<blockquote>
<p>Could these two fields be wrapped up in one <code>Arc</code> allocation?</p>
</blockquote>



<a name="199418115"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418115" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418115">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433466325">PR Review Comment</a>:</p>
<blockquote>
<p>Could <code>Default for Store</code> delegate to this now that it exists?</p>
</blockquote>



<a name="199418116"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418116" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418116">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433466932">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW now that we're doubling down on <code>Rc</code> inside of <code>Store</code>, I think we should remove these methods. It's too easy, at callsites, to forget these methods are related to <code>RefCell</code> and can introduce panics.</p>
</blockquote>



<a name="199418117"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418117" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418117">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433467963">PR Review Comment</a>:</p>
<blockquote>
<p>Or, alternatively, all accesses to these fields would be scoped inside of methods on this type, where each method doesn't leak borrowed <code>RefCell</code>s through returns</p>
</blockquote>



<a name="199418118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418118">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433467569">PR Review Comment</a>:</p>
<blockquote>
<p>Could this have a comment for what's going on here? Without that it's a bit cryptic what this check is doing</p>
</blockquote>



<a name="199418120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418120">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433468493">PR Review Comment</a>:</p>
<blockquote>
<p>I think changing signatures is fine, but if you'd prefer to defer that's ok too. Can you be sure an issue is filed about this?</p>
</blockquote>



<a name="199418121"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418121" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418121">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433467019">PR Review Comment</a>:</p>
<blockquote>
<p>(removed in favor of direct field access at callsites, that is)</p>
</blockquote>



<a name="199418122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418122">(Jun 01 2020 at 20:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433469360">PR Review Comment</a>:</p>
<blockquote>
<p>Er sorry I mean thte literal call to malloc, not the reading/writing of the global.</p>
</blockquote>



<a name="199418690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199418690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199418690">(Jun 01 2020 at 20:28)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199419266"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199419266" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199419266">(Jun 01 2020 at 20:33)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422160590">PR Review</a>.</p>



<a name="199419267"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199419267" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199419267">(Jun 01 2020 at 20:33)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433473513">PR Review Comment</a>:</p>
<blockquote>
<p>Returned back to store only Module, and added ModuleCode (which is only CodeMemory + GdbJitRegistration)</p>
</blockquote>



<a name="199422165"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199422165" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199422165">(Jun 01 2020 at 20:57)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199428713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199428713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199428713">(Jun 01 2020 at 21:53)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199429798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199429798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199429798">(Jun 01 2020 at 22:05)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422214283">PR Review</a>.</p>



<a name="199429799"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199429799" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199429799">(Jun 01 2020 at 22:05)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r433515220">PR Review Comment</a>:</p>
<blockquote>
<p>Not sure how to do it: <code>Engine::new</code> and <code>Store::new</code> have some additional logic that needs to be run.</p>
</blockquote>



<a name="199429920"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199429920" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199429920">(Jun 01 2020 at 22:06)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199431911"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199431911" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199431911">(Jun 01 2020 at 22:32)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199432277"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199432277" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199432277">(Jun 01 2020 at 22:38)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199435618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199435618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199435618">(Jun 01 2020 at 23:26)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199435671"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199435671" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199435671">(Jun 01 2020 at 23:27)</a>:</h4>
<p><strong>yurydelendik</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a>.</p>



<a name="199522218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199522218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199522218">(Jun 02 2020 at 17:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422876045">PR Review</a>.</p>



<a name="199522220"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199522220" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199522220">(Jun 02 2020 at 17:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#pullrequestreview-422876045">PR Review</a>.</p>



<a name="199522221"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199522221" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199522221">(Jun 02 2020 at 17:00)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r434030952">PR Review Comment</a>:</p>
<blockquote>
<p>Long-term it feels weird to have two <code>dyn Any</code> in this <code>Instance</code>, instead ideally we'd just have one <code>Box&lt;dyn Any&gt;</code> and shove everything in there. I don't want to iterate too much on this, it's pretty unimportant at this time. Just something to keep in mind for the future, this is more than ok for now.</p>
</blockquote>



<a name="199522222"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199522222" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199522222">(Jun 02 2020 at 17:00)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1761#discussion_r434029972">PR Review Comment</a>:</p>
<blockquote>
<p>Instead of embedding the <code>.unwrap()</code> here, could this return <code>Option&lt;&amp;mut Module&gt;</code>? It's only used in one location right now which is fine, but I'd prefer to avoid proliferating users of this API</p>
</blockquote>



<a name="199527901"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199527901" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199527901">(Jun 02 2020 at 17:44)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199531288"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199531288" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199531288">(Jun 02 2020 at 18:12)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a> from <code>mv-sig-registry</code> to <code>master</code>:</p>
<blockquote>
<p>To make wasmtime more threads friendly, this PR:</p>
<ul>
<li>Moves <code>CodeMemory</code>, <code>VMInterrupts</code> and <code>SignatureRegistry</code> from <code>Compiler</code></li>
<li><code>CompiledModule</code> holds <code>CodeMemory</code> and <code>GdbJitImageRegistration</code></li>
<li><code>Store</code> keeps track of its JIT code</li>
<li>Makes "<a href="http://jit_int.rs">jit_int.rs</a>" stuff <code>Send</code>+<code>Sync</code></li>
<li>Adds the threads example.</li>
</ul>
</blockquote>



<a name="199535643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231761%20Disconnects%20%60Store%60%20state%20fields%20from.../near/199535643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231761.20Disconnects.20.60Store.60.20state.20fields.20from.2E.2E.2E.html#199535643">(Jun 02 2020 at 18:44)</a>:</h4>
<p>yurydelendik merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">PR #1761</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>