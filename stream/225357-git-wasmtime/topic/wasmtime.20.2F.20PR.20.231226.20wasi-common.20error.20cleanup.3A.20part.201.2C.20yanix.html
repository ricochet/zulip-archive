<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1226 wasi-common error cleanup: part 1, yanix · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html">wasmtime / PR #1226 wasi-common error cleanup: part 1, yanix</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189679696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189679696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189679696">(Mar 04 2020 at 10:56)</a>:</h4>
<p>kubkon opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">PR #1226</a> from <code>yanix-error-cleanup</code> to <code>master</code>:</p>
<blockquote>
<p>This is the first PR in a series of PRs aiming at streamlining and future-proofing <code>wasi-common</code>'s error handling. Changes included in this part of the series:</p>
<ul>
<li>remove custom <code>yanix::Errno</code> and instead (as was previously suggested) reuse <code>std::io::Error</code> to generate and wrap raw *nix errno value</li>
<li>update <code>wasi-common</code> to use new way of handling raw OS error in <code>yanix</code>; i.e., via re-use of <code>std::io::Error</code> instead of a custom <code>Errno</code> enum</li>
</ul>
</blockquote>



<a name="189679697"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189679697" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189679697">(Mar 04 2020 at 10:56)</a>:</h4>
<p><strong>kubkon</strong> requested <a href="https://github.com/alexcrichton" target="_blank" title="https://github.com/alexcrichton">alexcrichton</a>, and <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">PR #1226</a>.</p>



<a name="189679698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189679698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189679698">(Mar 04 2020 at 10:56)</a>:</h4>
<p><strong>kubkon</strong> requested <a href="https://github.com/alexcrichton" target="_blank" title="https://github.com/alexcrichton">alexcrichton</a>, and <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">PR #1226</a>.</p>



<a name="189679863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189679863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189679863">(Mar 04 2020 at 10:58)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">PR #1226</a> from <code>yanix-error-cleanup</code> to <code>master</code>:</p>
<blockquote>
<p>This is the first PR in a series of PRs aiming at streamlining and future-proofing <code>wasi-common</code>'s error handling. Changes included in this part of the series:</p>
<ul>
<li>remove custom <code>yanix::Errno</code> and instead (as was previously suggested) reuse <code>std::io::Error</code> to generate and wrap raw *nix errno value</li>
<li>update <code>wasi-common</code> to use new way of handling raw OS error in <code>yanix</code>; i.e., via re-use of <code>std::io::Error</code> instead of a custom <code>Errno</code> enum</li>
</ul>
</blockquote>



<a name="189698489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189698489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189698489">(Mar 04 2020 at 14:55)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368834621" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368834621">PR Review</a>.</p>



<a name="189698490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189698490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189698490">(Mar 04 2020 at 14:55)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368834621" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368834621">PR Review</a>.</p>



<a name="189698491"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189698491" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189698491">(Mar 04 2020 at 14:55)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387710350" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387710350">PR Review Comment</a>:</p>
<blockquote>
<p><code>raw_os_error</code> will <a href="https://doc.rust-lang.org/std/io/struct.Error.html#method.raw_os_error" target="_blank" title="https://doc.rust-lang.org/std/io/struct.Error.html#method.raw_os_error">always</a> return <code>Some</code> when the error comes from <code>last_os_error</code>, so you can just <code>unwrap()</code> it here, and same for the other places in the code where this comes up.</p>
</blockquote>



<a name="189702153"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189702153" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189702153">(Mar 04 2020 at 15:31)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368875154" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368875154">PR Review</a>.</p>



<a name="189702154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189702154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189702154">(Mar 04 2020 at 15:31)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387742216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387742216">PR Review Comment</a>:</p>
<blockquote>
<p>Or actually, given what this code is doing, this should fall-through to returning <code>err</code> as usual?</p>
</blockquote>



<a name="189702155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189702155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189702155">(Mar 04 2020 at 15:31)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368875154" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-368875154">PR Review</a>.</p>



<a name="189702156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189702156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189702156">(Mar 04 2020 at 15:31)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387741239" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387741239">PR Review Comment</a>:</p>
<blockquote>
<p>I realize that this was already existing code, but I dont understand why this is calling <code>last_os_error</code> vs just using the <code>Err</code> payload of the previous call to <code>fstatat</code>?</p>
</blockquote>



<a name="189723445"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189723445" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189723445">(Mar 04 2020 at 19:02)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369041086" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369041086">PR Review</a>.</p>



<a name="189723448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189723448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189723448">(Mar 04 2020 at 19:02)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387870553" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387870553">PR Review Comment</a>:</p>
<blockquote>
<p>So the reason we make another call to <code>errno</code> here is since <code>fstatat</code> can fail as well, so we've got a dilemma whether 1. we should throw the original <code>err</code> (and perhaps that's the right thing to do), and 2. report the latest <code>errno</code> instead (the one generated by <code>fstatat</code>). Thoughts?</p>
</blockquote>



<a name="189723511"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189723511" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189723511">(Mar 04 2020 at 19:02)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387870972" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387870972">PR Review Comment</a>:</p>
<blockquote>
<p>Makes sense, I'll make the adjustments. This should clean up the calls since this way we'll effectively get rid of one level of nesting.</p>
</blockquote>



<a name="189723512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189723512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189723512">(Mar 04 2020 at 19:02)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369041641" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369041641">PR Review</a>.</p>



<a name="189728699"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189728699" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189728699">(Mar 04 2020 at 19:57)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369078830" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369078830">PR Review</a>.</p>



<a name="189728700"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189728700" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189728700">(Mar 04 2020 at 19:57)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387900625" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387900625">PR Review Comment</a>:</p>
<blockquote>
<p>In general for polyfill-style operations like this I tend to err on the side of returning the original error whenever possible, largely just optionally logging other errors if they happen.</p>
</blockquote>



<a name="189730365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189730365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189730365">(Mar 04 2020 at 20:13)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369089569" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369089569">PR Review</a>.</p>



<a name="189730371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189730371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189730371">(Mar 04 2020 at 20:13)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387908897" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387908897">PR Review Comment</a>:</p>
<blockquote>
<p>SGTM! For anyone "listening in" on this discussion, I'd like to propose that we stick to this convention from now on to be consistent. :-)</p>
</blockquote>



<a name="189733405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189733405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189733405">(Mar 04 2020 at 20:49)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">PR #1226</a> from <code>yanix-error-cleanup</code> to <code>master</code>:</p>
<blockquote>
<p>This is the first PR in a series of PRs aiming at streamlining and future-proofing <code>wasi-common</code>'s error handling. Changes included in this part of the series:</p>
<ul>
<li>remove custom <code>yanix::Errno</code> and instead (as was previously suggested) reuse <code>std::io::Error</code> to generate and wrap raw *nix errno value</li>
<li>update <code>wasi-common</code> to use new way of handling raw OS error in <code>yanix</code>; i.e., via re-use of <code>std::io::Error</code> instead of a custom <code>Errno</code> enum</li>
</ul>
</blockquote>



<a name="189733542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189733542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189733542">(Mar 04 2020 at 20:50)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369112287" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369112287">PR Review</a>.</p>



<a name="189733544"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189733544" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189733544">(Mar 04 2020 at 20:50)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387926363" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387926363">PR Review Comment</a>:</p>
<blockquote>
<p>Done in 686fd9d. Hopefully I got all of them!</p>
</blockquote>



<a name="189734447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189734447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189734447">(Mar 04 2020 at 21:01)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387931757" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387931757">PR Review Comment</a>:</p>
<blockquote>
<p>It's a good philosophy in general, though for WASI APIs, the ultimate consideration is, what error code best explains the failure to the WASI user who doesn't know that we're doing multiple syscalls? In this case, I agree that we should try to return the error from <code>unlinkat</code>.</p>
</blockquote>



<a name="189734448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189734448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189734448">(Mar 04 2020 at 21:01)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369119120" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369119120">PR Review</a>.</p>



<a name="189735311"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189735311" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189735311">(Mar 04 2020 at 21:11)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387936662" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#discussion_r387936662">PR Review Comment</a>:</p>
<blockquote>
<p>Good point!</p>
</blockquote>



<a name="189735312"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189735312" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189735312">(Mar 04 2020 at 21:11)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369125520" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226#pullrequestreview-369125520">PR Review</a>.</p>



<a name="189771658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231226%20wasi-common%20error%20cleanup%3A%20part%201%2C%20yanix/near/189771658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231226.20wasi-common.20error.20cleanup.3A.20part.201.2C.20yanix.html#189771658">(Mar 05 2020 at 09:08)</a>:</h4>
<p>kubkon merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1226" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1226">PR #1226</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>