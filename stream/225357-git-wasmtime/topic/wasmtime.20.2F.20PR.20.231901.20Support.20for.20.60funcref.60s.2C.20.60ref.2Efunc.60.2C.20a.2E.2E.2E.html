<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1901 Support for `funcref`s, `ref.func`, a... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html">wasmtime / PR #1901 Support for `funcref`s, `ref.func`, a...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="201308340"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201308340" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201308340">(Jun 18 2020 at 18:35)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201308341"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201308341" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201308341">(Jun 18 2020 at 18:35)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a>.</p>



<a name="201312930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201312930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201312930">(Jun 18 2020 at 19:11)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-433566902">PR Review</a>.</p>



<a name="201312931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201312931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201312931">(Jun 18 2020 at 19:11)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-433566902">PR Review</a>.</p>



<a name="201312932"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201312932" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201312932">(Jun 18 2020 at 19:11)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r442440635">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW this pattern with <code>#[cfg]</code> might be good to encapsulate somewhere with something like <code>ir::types::rsize()</code></p>
</blockquote>



<a name="201338845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201338845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201338845">(Jun 18 2020 at 23:41)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201665172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201665172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201665172">(Jun 22 2020 at 21:48)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201670627"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201670627" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201670627">(Jun 22 2020 at 22:51)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201670724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201670724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201670724">(Jun 22 2020 at 22:52)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a>.</p>



<a name="201672949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201672949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201672949">(Jun 22 2020 at 23:22)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201675812"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201675812" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201675812">(Jun 23 2020 at 00:04)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201734086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734086">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-435822900">PR Review</a>.</p>



<a name="201734087"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734087" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734087">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-435822900">PR Review</a>.</p>



<a name="201734088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734088">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444254421">PR Review Comment</a>:</p>
<blockquote>
<p>The fallout from this change seems quite large (affecting the C API and many callers of the default API), but I can't figure out why this changed? </p>
<p>While this makes sense for <code>Val</code> I don't think this makes sense for <code>Extern</code> which is acquired from an instance, and I don't think that instances can export a <code>null</code> funcref, right?</p>
</blockquote>



<a name="201734089"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734089" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734089">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444259607">PR Review Comment</a>:</p>
<blockquote>
<p>I think there's a safe conversion from <code>&amp;T</code> to <code>NonNull&lt;T&gt;</code> to use here?</p>
</blockquote>



<a name="201734090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734090">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444258347">PR Review Comment</a>:</p>
<blockquote>
<p>I saw somewhere else that this was store-local, but it's also here per-instance? Could this perhaps be <code>*mut</code> and stored in the <code>Store</code> instad?</p>
</blockquote>



<a name="201734091"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734091" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734091">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444255152">PR Review Comment</a>:</p>
<blockquote>
<p>Could <code>u64::from</code> be used still to avoid <code>as</code>?</p>
</blockquote>



<a name="201734092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734092">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444262178">PR Review Comment</a>:</p>
<blockquote>
<p><code>"b"</code></p>
</blockquote>



<a name="201734093"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734093" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734093">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444262355">PR Review Comment</a>:</p>
<blockquote>
<p><code>"c"</code></p>
</blockquote>



<a name="201734094"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734094" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734094">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444263060">PR Review Comment</a>:</p>
<blockquote>
<p>This expression happens a lot in this block, so perhaps this could do this at the top?</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">anyfunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">export</span><span class="p">.</span><span class="n">anyfunc</span><span class="p">.</span><span class="n">as_ref</span><span class="p">();</span><span class="w"></span>
<span class="c1">// ...</span>
</code></pre></div>


</blockquote>



<a name="201734095"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734095" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734095">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444264722">PR Review Comment</a>:</p>
<blockquote>
<p><code>"a"</code></p>
</blockquote>



<a name="201734096"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734096" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734096">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444265017">PR Review Comment</a>:</p>
<blockquote>
<p>Since there's already a lifetime here, perhaps this could be <code>&amp;'a Store</code>?</p>
</blockquote>



<a name="201734097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734097">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444264589">PR Review Comment</a>:</p>
<blockquote>
<p>I think this answers my question about where the <code>None</code> came from, but I think that we're guaranteed <code>ExportFunction</code> is never a "null function", right?</p>
</blockquote>



<a name="201734098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734098">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444265297">PR Review Comment</a>:</p>
<blockquote>
<p>This got a little gnarly, mind annotating the <code>_</code> here?</p>
</blockquote>



<a name="201734099"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734099" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734099">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444271886">PR Review Comment</a>:</p>
<blockquote>
<p>Nice <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="201734100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734100">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444270660">PR Review Comment</a>:</p>
<blockquote>
<p>An idle thought, but we could perhaps have something like:</p>
<div class="codehilite"><pre><span></span><code><span class="k">impl</span><span class="w"> </span><span class="n">Func</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="p">(</span><span class="k">crate</span><span class="p">)</span><span class="w"> </span><span class="k">fn</span> <span class="nf">into_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span>: <span class="kp">&amp;</span><span class="nc">Store</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">NonNull</span><span class="o">&lt;</span><span class="n">VMCallerCheckedAnyfunc</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>


<p>to bake in how you can't access the raw value without using the right store. Anyway not necessary to do here, just a thought!</p>
</blockquote>



<a name="201734101"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734101" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734101">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444267721">PR Review Comment</a>:</p>
<blockquote>
<p>I think this should write the store "null funcref" singleton instead of a null pointer, right?</p>
</blockquote>



<a name="201734102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734102">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444271175">PR Review Comment</a>:</p>
<blockquote>
<p>Another passing though, perhaps <code>fn is_null(&amp;self) -&gt; bool</code> could be added to <code>VMCallerCheckedAnyfunc</code></p>
</blockquote>



<a name="201734103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734103">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444269372">PR Review Comment</a>:</p>
<blockquote>
<p>Is <code>NonNull::new</code> here necessary?  This is related to my question above too I think.</p>
<p>I figured that <code>ref.null</code> would be implemented as returning the null singleton rather than a literal null pointer. (to make <code>table.set</code> a simple store instead of having a branch to store a non-null value)</p>
</blockquote>



<a name="201734104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734104">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444265905">PR Review Comment</a>:</p>
<blockquote>
<p>Ah it looks like there is indeed a null funcref per-store, but perhaps this could be reused for each <code>Instance</code>?</p>
</blockquote>



<a name="201734106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201734106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201734106">(Jun 23 2020 at 14:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444267048">PR Review Comment</a>:</p>
<blockquote>
<p>Could this perhaps go through the <code>Store</code> instead? One day if we ever support cross-compilation this'd be through that instead of <code>wasmtime-runtime</code></p>
</blockquote>



<a name="201749262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201749262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201749262">(Jun 23 2020 at 16:29)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-435954202">PR Review</a>.</p>



<a name="201749263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201749263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201749263">(Jun 23 2020 at 16:29)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444354358">PR Review Comment</a>:</p>
<blockquote>
<p><code>wasmtime-environ</code> is the thing that should handle the cross compilation as it is about the environment of the compilation target, while <code>wasmtime-runtime</code> is always compiled into the target. So if we put it in <code>wasmtime-runtime</code>, then it is always going to reflect the compilation target.</p>
<p>If we wanted to support cross compilation at the <code>wasmtime</code> API level, then we would have to stop linking <code>wasmtime-runtime</code> directly, which would force us to (correctly) revisit calls to this function from the <code>wasmtime</code> crate. So I think we should be good here.</p>
</blockquote>



<a name="201757163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201757163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201757163">(Jun 23 2020 at 17:33)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436004492">PR Review</a>.</p>



<a name="201757164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201757164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201757164">(Jun 23 2020 at 17:33)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444392541">PR Review Comment</a>:</p>
<blockquote>
<p>I... <em>think</em> you are correct. I'll look into it.</p>
</blockquote>



<a name="201758887"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201758887" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201758887">(Jun 23 2020 at 17:50)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436019013">PR Review</a>.</p>



<a name="201758888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201758888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201758888">(Jun 23 2020 at 17:50)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444402571">PR Review Comment</a>:</p>
<blockquote>
<p>I didn't realize that <code>NonNull&lt;T&gt;</code> implements <code>From&lt;&amp;T&gt;</code>!</p>
</blockquote>



<a name="201759081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201759081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201759081">(Jun 23 2020 at 17:51)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436020337">PR Review</a>.</p>



<a name="201759082"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201759082" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201759082">(Jun 23 2020 at 17:51)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444403530">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW, we don't use pointer equality for <code>VMCallerCheckedAnyfunc</code>s, so this would just be a memory optimization that saves two words per instance.</p>
</blockquote>



<a name="201760526"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201760526" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201760526">(Jun 23 2020 at 18:03)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436029561">PR Review</a>.</p>



<a name="201760527"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201760527" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201760527">(Jun 23 2020 at 18:03)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444410347">PR Review Comment</a>:</p>
<blockquote>
<p>Ah yeah that's all I'm imagining, fewer small allocations here-and-there. It also sort of helps the case of "I precompiled my wasm" since we'd presumably statically allocate this anyfunc instead of trying to dynamically allocate it.</p>
</blockquote>



<a name="201760602"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201760602" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201760602">(Jun 23 2020 at 18:03)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444410810">PR Review Comment</a>:</p>
<blockquote>
<p>It's true yeah we're a <em>long</em> way away from wasmtime supporting AOT compilation, but I just figured this'd be a relatively easy future-proofing.</p>
</blockquote>



<a name="201760603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201760603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201760603">(Jun 23 2020 at 18:03)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436030157">PR Review</a>.</p>



<a name="201765180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201765180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201765180">(Jun 23 2020 at 18:41)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436056877">PR Review</a>.</p>



<a name="201765181"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201765181" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201765181">(Jun 23 2020 at 18:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444431268">PR Review Comment</a>:</p>
<blockquote>
<p>I think we are as future proofed as it makes sense to be given that this function is safely inside <code>wasmtime-runtime</code>, as mentioned above.</p>
<p>I think our best path forward for AOT cross compilation is a <code>wasmtime-aot</code> crate.</p>
</blockquote>



<a name="201766519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201766519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201766519">(Jun 23 2020 at 18:52)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201766590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201766590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201766590">(Jun 23 2020 at 18:53)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a>.</p>



<a name="201767263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201767263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201767263">(Jun 23 2020 at 18:57)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201797739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201797739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201797739">(Jun 23 2020 at 23:37)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201800759"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201800759" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201800759">(Jun 24 2020 at 00:28)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201849541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201849541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201849541">(Jun 24 2020 at 13:54)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436669006">PR Review</a>.</p>



<a name="201849542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201849542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201849542">(Jun 24 2020 at 13:54)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#pullrequestreview-436669006">PR Review</a>.</p>



<a name="201849544"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201849544" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201849544">(Jun 24 2020 at 13:54)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1901#discussion_r444910610">PR Review Comment</a>:</p>
<blockquote>
<p>I think the <code>return</code> here can go away, or this may also benefit from a early-return <code>match</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">anyfunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">NonNull</span>:<span class="nc">new</span><span class="p">(</span><span class="n">anyfunc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">Some</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Val</span>::<span class="n">FuncRef</span><span class="p">(</span><span class="nb">None</span><span class="p">),</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="c1">// ...</span>
<span class="o">~~~</span><span class="w"></span>
</code></pre></div>


</blockquote>



<a name="201867223"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201867223" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201867223">(Jun 24 2020 at 15:59)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201874837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201874837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201874837">(Jun 24 2020 at 17:01)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201875726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201875726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201875726">(Jun 24 2020 at 17:08)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a> from <code>ref-func</code> to <code>master</code>.</p>



<a name="201881280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231901%20Support%20for%20%60funcref%60s%2C%20%60ref.func%60%2C%20a.../near/201881280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231901.20Support.20for.20.60funcref.60s.2C.20.60ref.2Efunc.60.2C.20a.2E.2E.2E.html#201881280">(Jun 24 2020 at 17:53)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1901">PR #1901</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>