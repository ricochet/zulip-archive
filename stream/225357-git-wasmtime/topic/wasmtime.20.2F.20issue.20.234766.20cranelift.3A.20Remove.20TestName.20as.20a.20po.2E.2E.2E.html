<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4766 cranelift: Remove TestName as a po... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234766.20cranelift.3A.20Remove.20TestName.20as.20a.20po.2E.2E.2E.html">wasmtime / issue #4766 cranelift: Remove TestName as a po...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="295006696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234766%20cranelift%3A%20Remove%20TestName%20as%20a%20po.../near/295006696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234766.20cranelift.3A.20Remove.20TestName.20as.20a.20po.2E.2E.2E.html#295006696">(Aug 24 2022 at 09:11)</a>:</h4>
<p>afonso360 opened <a href="https://github.com/bytecodealliance/wasmtime/issues/4766">issue #4766</a>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<h4>Feature</h4>
<p>This is a follow up to <a href="https://github.com/bytecodealliance/wasmtime/pull/4667#issuecomment-1218328143">https://github.com/bytecodealliance/wasmtime/pull/4667#issuecomment-1218328143</a>, where we discussed removing TestName as an option for Function names.</p>
<h4>Benefit</h4>
<p>The biggest benefit is cleaning up our naming interface. TestNames arguably shouldn't belong to the core cranelift infrastructure. Instead the test suite should have an external table as any other embedder would do.</p>
<p>The other benefit was allowing larger names in test functions, but @jameysharp has fixed that in <a href="https://github.com/bytecodealliance/wasmtime/pull/4764">https://github.com/bytecodealliance/wasmtime/pull/4764</a> (Thanks!)</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/4667#issuecomment-1219673349">@jameysharp tested this</a> and while it does have some performance benefits, they are minimal.</p>
<p>This also removes some edges such as <code>cranelift-jit</code> not supporting test names which makes for a better experience using it.</p>
<h4>Implementation</h4>
<p>I started working on this a few days ago, but I'm putting it on hold to fix some other more prioritary issues. (<a href="https://github.com/afonso360/wasmtime/tree/remove-testnames">in progress branch</a>) If anyone wants to pick this up in the mean time feel free!</p>
<p>The branch above starts by changing the parser to produce a side table of test names while assigning UserExernalNames to each function.</p>
<p>Following from that we need to switch the testsuite to use this new side table.</p>
<p>And after that we should be able to remove the TestName from cranelift.</p>
<p>This sounds simple, but I think it will end up being quite a big change.</p>
<h4>Alternatives</h4>
<p>Do nothing. This has been the state of cranelift for a long time. I think this would also break the interface for pretty much every downstream user since we would probably remove UserFuncName and replace it with UserExernalName directly.<br>
</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>