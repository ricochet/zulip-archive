<html>
<head><meta charset="utf-8"><title>wasmtime / PR #4958 fuzzgen: Add `fcvt_*` ops · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html">wasmtime / PR #4958 fuzzgen: Add `fcvt_*` ops</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="300660982"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/300660982" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#300660982">(Sep 25 2022 at 15:05)</a>:</h4>
<p>afonso360 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/4958">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>Following up from #4884 (Thanks!) this PR introduces <code>fcvt_*</code> ops to the fuzzer. Additionally it also adds a pass to minimize the number of traps generated by these ops.</p>
<p>Like the <code>int_divz</code> pass, the number of traps generated doesn't seem to correspond with the amount requested in the config.  I think I've actually figured out something here, if I limit the amount of bytes the fuzzer uses the amount of traps is reduced by a  lot.  (I got 0.4% <code>int_ovf</code> with <code>-max_len=2048</code>)</p>
<p>That leads me to believe that we get such a high number of traps due to executing a lot of inputs. This is something that I want to look further into since I think there could actually be a performance benefit from limiting this.</p>
<p>As a sanity check I also tried to benchmark with 100% insertion rate, and as expected we don't get the other traps.</p>
<h3>Benchmarks</h3>
<p>&lt;details&gt;<br>
&lt;summary&gt;&lt;h3&gt;Baseline&lt;/h3&gt;&lt;/summary&gt;</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="mi">92127</span><span class="w">  </span><span class="n">REDUCE</span><span class="w"> </span><span class="n">cov</span>: <span class="mi">30535</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">173903</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4510</span><span class="o">/</span><span class="mi">10465</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">393617</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">24</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2448</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">124</span><span class="o">/</span><span class="mi">393581</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">1</span><span class="w"> </span><span class="n">EraseBytes</span><span class="o">-</span><span class="w"></span>
<span class="o">==</span><span class="w"> </span><span class="n">FuzzGen</span><span class="w"> </span><span class="n">Statistics</span><span class="w">  </span><span class="o">====================</span><span class="w"></span>
<span class="n">Valid</span><span class="w"> </span><span class="n">Inputs</span>: <span class="mi">50000</span><span class="w"></span>
<span class="n">Total</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1469777</span><span class="w"></span>
<span class="n">Successful</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1415404</span><span class="w"> </span><span class="p">(</span><span class="mf">96.3</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Timed</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">425</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Traps</span>:
        <span class="nc">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_divz</span>: <span class="mi">53948</span><span class="w"> </span><span class="p">(</span><span class="mf">3.7</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
#<span class="mi">92200</span><span class="w">  </span><span class="n">NEW</span><span class="w">    </span><span class="n">cov</span>: <span class="mi">30535</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">173904</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4511</span><span class="o">/</span><span class="mi">10470</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">393617</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">23</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2448</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">4614</span><span class="o">/</span><span class="mi">393581</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">3</span><span class="w"> </span><span class="n">ChangeASCIIInt</span><span class="o">-</span><span class="n">ChangeByte</span><span class="o">-</span><span class="n">CMP</span><span class="o">-</span><span class="w"> </span><span class="n">DE</span>: <span class="s">"</span><span class="se">\x1e\x00\x00\x00</span><span class="s">"</span><span class="o">-</span><span class="w"></span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>&lt;details&gt;<br>
&lt;summary&gt;&lt;h3&gt;This PR&lt;/h3&gt;&lt;/summary&gt;</p>
<p>I've seen the <code>int_ovf</code> trap count vary a lot while testing, from 0.4% up to almost 7%.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="mi">86636</span><span class="w">  </span><span class="n">NEW</span><span class="w">    </span><span class="n">cov</span>: <span class="mi">31377</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">178040</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4651</span><span class="o">/</span><span class="mi">8643</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">119720</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2375</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">4548</span><span class="o">/</span><span class="mi">65539</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">2</span><span class="w"> </span><span class="n">ChangeASCIIInt</span><span class="o">-</span><span class="n">CopyPart</span><span class="o">-</span><span class="w"></span>
<span class="o">==</span><span class="w"> </span><span class="n">FuzzGen</span><span class="w"> </span><span class="n">Statistics</span><span class="w">  </span><span class="o">====================</span><span class="w"></span>
<span class="n">Valid</span><span class="w"> </span><span class="n">Inputs</span>: <span class="mi">50000</span><span class="w"></span>
<span class="n">Total</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1184585</span><span class="w"></span>
<span class="n">Successful</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1099371</span><span class="w"> </span><span class="p">(</span><span class="mf">92.8</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Timed</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1066</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Traps</span>:
        <span class="nc">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_ovf</span>: <span class="mi">40522</span><span class="w"> </span><span class="p">(</span><span class="mf">3.4</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_divz</span>: <span class="mi">33112</span><span class="w"> </span><span class="p">(</span><span class="mf">2.8</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">bad_toint</span>: <span class="mi">10514</span><span class="w"> </span><span class="p">(</span><span class="mf">0.9</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
#<span class="mi">86713</span><span class="w">  </span><span class="n">REDUCE</span><span class="w"> </span><span class="n">cov</span>: <span class="mi">31377</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">178042</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4652</span><span class="o">/</span><span class="mi">8645</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">119720</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2375</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">1761</span><span class="o">/</span><span class="mi">65539</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">2</span><span class="w"> </span><span class="n">InsertRepeatedBytes</span><span class="o">-</span><span class="n">InsertRepeatedBytes</span><span class="o">-</span><span class="w"></span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>&lt;details&gt;<br>
&lt;summary&gt;&lt;h3&gt;This PR while always applying the trap pass&lt;/h3&gt;&lt;/summary&gt;</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="mi">89715</span><span class="w">  </span><span class="n">REDUCE</span><span class="w"> </span><span class="n">cov</span>: <span class="mi">31208</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">177781</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4618</span><span class="o">/</span><span class="mi">8793</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">136654</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2342</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">2397</span><span class="o">/</span><span class="mi">136620</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">1</span><span class="w"> </span><span class="n">PersAutoDict</span><span class="o">-</span><span class="w"> </span><span class="n">DE</span>: <span class="s">"</span><span class="se">\x00\x00\x00</span><span class="s">Y"</span><span class="o">-</span><span class="w"></span>
<span class="o">==</span><span class="w"> </span><span class="n">FuzzGen</span><span class="w"> </span><span class="n">Statistics</span><span class="w">  </span><span class="o">====================</span><span class="w"></span>
<span class="n">Valid</span><span class="w"> </span><span class="n">Inputs</span>: <span class="mi">50000</span><span class="w"></span>
<span class="n">Total</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1315468</span><span class="w"></span>
<span class="n">Successful</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1273898</span><span class="w"> </span><span class="p">(</span><span class="mf">96.8</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Timed</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1016</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Traps</span>:
        <span class="nc">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_divz</span>: <span class="mi">40554</span><span class="w"> </span><span class="p">(</span><span class="mf">3.1</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
#<span class="mi">89889</span><span class="w">  </span><span class="n">NEW</span><span class="w">    </span><span class="n">cov</span>: <span class="mi">31208</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">177782</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4619</span><span class="o">/</span><span class="mi">8808</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">136654</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2342</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">15765</span><span class="o">/</span><span class="mi">136620</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">4</span><span class="w"> </span><span class="n">CopyPart</span><span class="o">-</span><span class="n">CopyPart</span><span class="o">-</span><span class="n">InsertByte</span><span class="o">-</span><span class="n">CrossOver</span><span class="o">-</span><span class="w"></span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>cc: @jameysharp </p>
</blockquote>



<a name="300662149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/300662149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#300662149">(Sep 25 2022 at 15:18)</a>:</h4>
<p>afonso360 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4958">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>.</p>



<a name="300662512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/300662512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#300662512">(Sep 25 2022 at 15:22)</a>:</h4>
<p>afonso360 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4958">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>.</p>



<a name="300662601"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/300662601" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#300662601">(Sep 25 2022 at 15:23)</a>:</h4>
<p>afonso360 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4958">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>.</p>



<a name="300753061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/300753061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#300753061">(Sep 26 2022 at 09:51)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/4958">PR #4958</a> from <code>fuzzgen-fcvt</code> to <code>main</code>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>Following up from #4884 (Thanks!) this PR introduces <code>fcvt_*</code> ops to the fuzzer. Additionally it also adds a pass to minimize the number of traps generated by these ops.</p>
<p>Like the <code>int_divz</code> pass, the number of traps generated doesn't seem to correspond with the amount requested in the config.  I think I've actually figured out something here, if I limit the amount of bytes the fuzzer uses, the amount of traps is reduced by a  lot.  (I got 0.4% <code>int_ovf</code> with <code>-max_len=2048</code>)</p>
<p>That leads me to believe that we get such a high number of traps due to executing a lot of inputs. This is something that I want to look further into since I think there could actually be a performance benefit from limiting this.</p>
<p>As a sanity check I also tried to benchmark with 100% insertion rate, and as expected we don't get the other traps.</p>
<h3>Benchmarks</h3>
<p>&lt;details&gt;<br>
&lt;summary&gt;&lt;h3&gt;Baseline&lt;/h3&gt;&lt;/summary&gt;</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="mi">92127</span><span class="w">  </span><span class="n">REDUCE</span><span class="w"> </span><span class="n">cov</span>: <span class="mi">30535</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">173903</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4510</span><span class="o">/</span><span class="mi">10465</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">393617</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">24</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2448</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">124</span><span class="o">/</span><span class="mi">393581</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">1</span><span class="w"> </span><span class="n">EraseBytes</span><span class="o">-</span><span class="w"></span>
<span class="o">==</span><span class="w"> </span><span class="n">FuzzGen</span><span class="w"> </span><span class="n">Statistics</span><span class="w">  </span><span class="o">====================</span><span class="w"></span>
<span class="n">Valid</span><span class="w"> </span><span class="n">Inputs</span>: <span class="mi">50000</span><span class="w"></span>
<span class="n">Total</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1469777</span><span class="w"></span>
<span class="n">Successful</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1415404</span><span class="w"> </span><span class="p">(</span><span class="mf">96.3</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Timed</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">425</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Traps</span>:
        <span class="nc">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_divz</span>: <span class="mi">53948</span><span class="w"> </span><span class="p">(</span><span class="mf">3.7</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
#<span class="mi">92200</span><span class="w">  </span><span class="n">NEW</span><span class="w">    </span><span class="n">cov</span>: <span class="mi">30535</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">173904</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4511</span><span class="o">/</span><span class="mi">10470</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">393617</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">23</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2448</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">4614</span><span class="o">/</span><span class="mi">393581</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">3</span><span class="w"> </span><span class="n">ChangeASCIIInt</span><span class="o">-</span><span class="n">ChangeByte</span><span class="o">-</span><span class="n">CMP</span><span class="o">-</span><span class="w"> </span><span class="n">DE</span>: <span class="s">"</span><span class="se">\x1e\x00\x00\x00</span><span class="s">"</span><span class="o">-</span><span class="w"></span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>&lt;details&gt;<br>
&lt;summary&gt;&lt;h3&gt;This PR&lt;/h3&gt;&lt;/summary&gt;</p>
<p>I've seen the <code>int_ovf</code> trap count vary a lot while testing, from 0.4% up to almost 7%.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="mi">86636</span><span class="w">  </span><span class="n">NEW</span><span class="w">    </span><span class="n">cov</span>: <span class="mi">31377</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">178040</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4651</span><span class="o">/</span><span class="mi">8643</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">119720</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2375</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">4548</span><span class="o">/</span><span class="mi">65539</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">2</span><span class="w"> </span><span class="n">ChangeASCIIInt</span><span class="o">-</span><span class="n">CopyPart</span><span class="o">-</span><span class="w"></span>
<span class="o">==</span><span class="w"> </span><span class="n">FuzzGen</span><span class="w"> </span><span class="n">Statistics</span><span class="w">  </span><span class="o">====================</span><span class="w"></span>
<span class="n">Valid</span><span class="w"> </span><span class="n">Inputs</span>: <span class="mi">50000</span><span class="w"></span>
<span class="n">Total</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1184585</span><span class="w"></span>
<span class="n">Successful</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1099371</span><span class="w"> </span><span class="p">(</span><span class="mf">92.8</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Timed</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1066</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Traps</span>:
        <span class="nc">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_ovf</span>: <span class="mi">40522</span><span class="w"> </span><span class="p">(</span><span class="mf">3.4</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_divz</span>: <span class="mi">33112</span><span class="w"> </span><span class="p">(</span><span class="mf">2.8</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">bad_toint</span>: <span class="mi">10514</span><span class="w"> </span><span class="p">(</span><span class="mf">0.9</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
#<span class="mi">86713</span><span class="w">  </span><span class="n">REDUCE</span><span class="w"> </span><span class="n">cov</span>: <span class="mi">31377</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">178042</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4652</span><span class="o">/</span><span class="mi">8645</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">119720</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2375</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">1761</span><span class="o">/</span><span class="mi">65539</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">2</span><span class="w"> </span><span class="n">InsertRepeatedBytes</span><span class="o">-</span><span class="n">InsertRepeatedBytes</span><span class="o">-</span><span class="w"></span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>&lt;details&gt;<br>
&lt;summary&gt;&lt;h3&gt;This PR while always applying the trap pass&lt;/h3&gt;&lt;/summary&gt;</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="mi">89715</span><span class="w">  </span><span class="n">REDUCE</span><span class="w"> </span><span class="n">cov</span>: <span class="mi">31208</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">177781</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4618</span><span class="o">/</span><span class="mi">8793</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">136654</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2342</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">2397</span><span class="o">/</span><span class="mi">136620</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">1</span><span class="w"> </span><span class="n">PersAutoDict</span><span class="o">-</span><span class="w"> </span><span class="n">DE</span>: <span class="s">"</span><span class="se">\x00\x00\x00</span><span class="s">Y"</span><span class="o">-</span><span class="w"></span>
<span class="o">==</span><span class="w"> </span><span class="n">FuzzGen</span><span class="w"> </span><span class="n">Statistics</span><span class="w">  </span><span class="o">====================</span><span class="w"></span>
<span class="n">Valid</span><span class="w"> </span><span class="n">Inputs</span>: <span class="mi">50000</span><span class="w"></span>
<span class="n">Total</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1315468</span><span class="w"></span>
<span class="n">Successful</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1273898</span><span class="w"> </span><span class="p">(</span><span class="mf">96.8</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Timed</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">Runs</span>: <span class="mi">1016</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
<span class="n">Traps</span>:
        <span class="nc">user</span><span class="w"> </span><span class="n">code</span>: <span class="nc">int_divz</span>: <span class="mi">40554</span><span class="w"> </span><span class="p">(</span><span class="mf">3.1</span><span class="o">%</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">Runs</span><span class="p">)</span><span class="w"></span>
#<span class="mi">89889</span><span class="w">  </span><span class="n">NEW</span><span class="w">    </span><span class="n">cov</span>: <span class="mi">31208</span><span class="w"> </span><span class="n">ft</span>: <span class="mi">177782</span><span class="w"> </span><span class="n">corp</span>: <span class="mi">4619</span><span class="o">/</span><span class="mi">8808</span><span class="n">Kb</span><span class="w"> </span><span class="n">lim</span>: <span class="mi">136654</span><span class="w"> </span><span class="n">exec</span><span class="o">/</span><span class="n">s</span>: <span class="mi">25</span><span class="w"> </span><span class="n">rss</span>: <span class="mi">2342</span><span class="n">Mb</span><span class="w"> </span><span class="n">L</span>: <span class="mi">15765</span><span class="o">/</span><span class="mi">136620</span><span class="w"> </span><span class="n">MS</span>: <span class="mi">4</span><span class="w"> </span><span class="n">CopyPart</span><span class="o">-</span><span class="n">CopyPart</span><span class="o">-</span><span class="n">InsertByte</span><span class="o">-</span><span class="n">CrossOver</span><span class="o">-</span><span class="w"></span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>cc: @jameysharp </p>
</blockquote>



<a name="301060911"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/301060911" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#301060911">(Sep 27 2022 at 16:52)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4958#pullrequestreview-1122352687">PR review</a>.</p>



<a name="301061025"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234958%20fuzzgen%3A%20Add%20%60fcvt_%2A%60%20ops/near/301061025" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234958.20fuzzgen.3A.20Add.20.60fcvt_.2A.60.20ops.html#301061025">(Sep 27 2022 at 16:52)</a>:</h4>
<p>jameysharp merged <a href="https://github.com/bytecodealliance/wasmtime/pull/4958">PR #4958</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>