<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4912 `qemu-riscv64`  will exhaust all p... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html">wasmtime / issue #4912 `qemu-riscv64`  will exhaust all p...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="298920734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/298920734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#298920734">(Sep 15 2022 at 08:04)</a>:</h4>
<p>yuyang-ok edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<p>Finished test [unoptimized + debuginfo] target(s) in 26.99s<br>
     Running <code>/home/yuyang/projects/qemu/build/qemu-riscv64 -L /usr/riscv64-linux-gnu -E LD_LIBRARY_PATH=/usr/riscv64-linux-gnu/lib -E WASMTIME_TEST_NO_HOG_MEMORY=1 /home/yuyang/projects/wasmtime/target/riscv64gc-unknown-linux-gnu/debug/deps/host_segfault-0362e2365a90b3f7</code><br>
thread 'main' panicked at '</p>
<p>expected a stack overflow on <code>hit async stack guard page with pooling allocator</code><br>
got status: signal: 9 (SIGKILL)</p>
<p>', tests/host_segfault.rs:213:13<br>
note: run with <code>RUST_BACKTRACE=1</code> environment variable to display a backtrace<br>
error: test failed, to rerun pass '--test host_segfault'</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>
</code></pre></div>



<a name="298921052"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/298921052" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#298921052">(Sep 15 2022 at 08:07)</a>:</h4>
<p>yuyang-ok edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1247423546">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718">https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718</a></p>
</blockquote>



<a name="298921186"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/298921186" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#298921186">(Sep 15 2022 at 08:08)</a>:</h4>
<p>yuyang-ok deleted a <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1247423546">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718">https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718</a></p>
</blockquote>



<a name="298921386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/298921386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#298921386">(Sep 15 2022 at 08:09)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1247739222">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p>@jameysharp look like the env var <code>WASMTIME_TEST_NO_HOG_MEMORY</code> not used no test <code>host_segfault</code>.</p>
</blockquote>



<a name="298929592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/298929592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#298929592">(Sep 15 2022 at 09:11)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1247816299">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/rustix/issues/400">https://github.com/bytecodealliance/rustix/issues/400</a></p>
</blockquote>



<a name="299076273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299076273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299076273">(Sep 16 2022 at 01:38)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1248816733">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p>(<a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718">https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718</a>)<br>
<code>MemoryPool</code> is trying to alloc very huge area (6002G) in virutal address space.<br>
maybe this is a little incompatible with <code>qemu-riscv64</code>.</p>
</blockquote>



<a name="299078180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299078180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299078180">(Sep 16 2022 at 01:56)</a>:</h4>
<p>yuyang-ok edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1248816733">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p>(<a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718">https://github.com/bytecodealliance/wasmtime/blob/main/crates/runtime/src/instance/allocator/pooling.rs#L718</a>)<br>
<code>MemoryPool</code> is trying to alloc very huge area (6002G) in virtual address space.<br>
maybe this is a little incompatible with <code>qemu-riscv64</code>.</p>
</blockquote>



<a name="299092162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299092162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299092162">(Sep 16 2022 at 05:09)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1248924677">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://gitlab.com/qemu-project/qemu/-/issues/1214">https://gitlab.com/qemu-project/qemu/-/issues/1214</a></p>
</blockquote>



<a name="299092163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299092163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299092163">(Sep 16 2022 at 05:09)</a>:</h4>
<p>yuyang-ok closed <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<p>Finished test [unoptimized + debuginfo] target(s) in 26.99s<br>
     Running <code>/home/yuyang/projects/qemu/build/qemu-riscv64 -L /usr/riscv64-linux-gnu -E LD_LIBRARY_PATH=/usr/riscv64-linux-gnu/lib -E WASMTIME_TEST_NO_HOG_MEMORY=1 /home/yuyang/projects/wasmtime/target/riscv64gc-unknown-linux-gnu/debug/deps/host_segfault-0362e2365a90b3f7</code><br>
thread 'main' panicked at '</p>
<p>expected a stack overflow on <code>hit async stack guard page with pooling allocator</code><br>
got status: signal: 9 (SIGKILL)</p>
<p>', tests/host_segfault.rs:213:13<br>
note: run with <code>RUST_BACKTRACE=1</code> environment variable to display a backtrace<br>
error: test failed, to rerun pass '--test host_segfault'</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>
</code></pre></div>



<a name="299092178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299092178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299092178">(Sep 16 2022 at 05:09)</a>:</h4>
<p>yuyang-ok deleted a <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1247816299">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/rustix/issues/400">https://github.com/bytecodealliance/rustix/issues/400</a></p>
</blockquote>



<a name="299092183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299092183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299092183">(Sep 16 2022 at 05:09)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1248924964">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://gitlab.com/qemu-project/qemu/-/issues/1214">https://gitlab.com/qemu-project/qemu/-/issues/1214</a></p>
</blockquote>



<a name="299092184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299092184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299092184">(Sep 16 2022 at 05:09)</a>:</h4>
<p>yuyang-ok closed <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<p>Finished test [unoptimized + debuginfo] target(s) in 26.99s<br>
     Running <code>/home/yuyang/projects/qemu/build/qemu-riscv64 -L /usr/riscv64-linux-gnu -E LD_LIBRARY_PATH=/usr/riscv64-linux-gnu/lib -E WASMTIME_TEST_NO_HOG_MEMORY=1 /home/yuyang/projects/wasmtime/target/riscv64gc-unknown-linux-gnu/debug/deps/host_segfault-0362e2365a90b3f7</code><br>
thread 'main' panicked at '</p>
<p>expected a stack overflow on <code>hit async stack guard page with pooling allocator</code><br>
got status: signal: 9 (SIGKILL)</p>
<p>', tests/host_segfault.rs:213:13<br>
note: run with <code>RUST_BACKTRACE=1</code> environment variable to display a backtrace<br>
error: test failed, to rerun pass '--test host_segfault'</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>
</code></pre></div>



<a name="299093583"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234912%20%60qemu-riscv64%60%20%20will%20exhaust%20all%20p.../near/299093583" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234912.20.60qemu-riscv64.60.20.20will.20exhaust.20all.20p.2E.2E.2E.html#299093583">(Sep 16 2022 at 05:31)</a>:</h4>
<p>yuyang-ok deleted a <a href="https://github.com/bytecodealliance/wasmtime/issues/4912#issuecomment-1248924964">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4912">issue #4912</a>:</p>
<blockquote>
<p><a href="https://gitlab.com/qemu-project/qemu/-/issues/1214">https://gitlab.com/qemu-project/qemu/-/issues/1214</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>