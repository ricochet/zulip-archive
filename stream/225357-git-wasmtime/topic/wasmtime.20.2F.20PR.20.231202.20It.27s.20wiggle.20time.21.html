<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1202 It&#x27;s wiggle time! · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html">wasmtime / PR #1202 It&#x27;s wiggle time!</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="190315231"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190315231" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190315231">(Mar 11 2020 at 18:26)</a>:</h4>
<p>kubkon edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="190402263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190402263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190402263">(Mar 12 2020 at 15:22)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="190484553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190484553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190484553">(Mar 13 2020 at 09:26)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="190486024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190486024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190486024">(Mar 13 2020 at 09:45)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="190514980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190514980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190514980">(Mar 13 2020 at 15:18)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="190831792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190831792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190831792">(Mar 17 2020 at 10:49)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="190972312"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/190972312" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#190972312">(Mar 18 2020 at 12:26)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191001793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191001793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191001793">(Mar 18 2020 at 16:01)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191003884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191003884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191003884">(Mar 18 2020 at 16:14)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191040497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191040497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191040497">(Mar 18 2020 at 20:51)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191042507"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191042507" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191042507">(Mar 18 2020 at 21:08)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191042856"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191042856" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191042856">(Mar 18 2020 at 21:12)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191053174"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191053174" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191053174">(Mar 18 2020 at 22:54)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191085759"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191085759" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191085759">(Mar 19 2020 at 09:12)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191086651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191086651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191086651">(Mar 19 2020 at 09:20)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191095327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191095327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191095327">(Mar 19 2020 at 10:43)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191095992"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191095992" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191095992">(Mar 19 2020 at 10:48)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191100988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191100988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191100988">(Mar 19 2020 at 11:41)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191146193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191146193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191146193">(Mar 19 2020 at 17:20)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191153291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191153291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191153291">(Mar 19 2020 at 18:07)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191155213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191155213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191155213">(Mar 19 2020 at 18:22)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-377983029" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-377983029">PR Review</a>.</p>



<a name="191155215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191155215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191155215">(Mar 19 2020 at 18:22)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395231689" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395231689">PR Review Comment</a>:</p>
<blockquote>
<p>can you just use the <code>Into&lt;u32&gt;</code> implementation?</p>
</blockquote>



<a name="191157028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191157028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191157028">(Mar 19 2020 at 18:34)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-377991960" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-377991960">PR Review</a>.</p>



<a name="191157029"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191157029" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191157029">(Mar 19 2020 at 18:34)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395238847" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395238847">PR Review Comment</a>:</p>
<blockquote>
<p>I agree it'd be good to have one way to do this, rather than two. Could I suggest preferring <code>.inner()</code> over <code>.into()</code>? Most of the code in wasi-common should treat these as opaque, so it'd be nice for the places where we do need to peek inside to stand out.</p>
</blockquote>



<a name="191157314"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191157314" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191157314">(Mar 19 2020 at 18:36)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191168343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168343">(Mar 19 2020 at 20:06)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191168378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168378">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378020879" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378020879">PR Review</a>.</p>



<a name="191168379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168379">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395262075" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395262075">PR Review Comment</a>:</p>
<blockquote>
<p><code>fd_pool</code> and <code>entries</code> need to stay in sync with each other. How awkward would it be to have a single <code>RefCell</code> that holds a struct containing both?</p>
</blockquote>



<a name="191168380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168380">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378020879" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378020879">PR Review</a>.</p>



<a name="191168382"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168382" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168382">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395272307" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395272307">PR Review Comment</a>:</p>
<blockquote>
<p>And similar here? If so, we may not even need the <code>contains_key</code> method, which would be nice because it can be tricky to use without look-before-you-leap hazards.</p>
</blockquote>



<a name="191168383"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168383" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168383">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395274737" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395274737">PR Review Comment</a>:</p>
<blockquote>
<p>Instead of <code>from</code>, what would you think of naming this method <code>from_raw</code>, to emphasize that this call is not something one should do often.</p>
</blockquote>



<a name="191168384"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168384" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168384">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395277052" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395277052">PR Review Comment</a>:</p>
<blockquote>
<p>Implementing this as a trait for <code>WasiCtx</code> is an interesting idea, and it is pretty fun to do <code>ctx.fd_close</code> as the code does above, but does this make it harder to share a <code>WasiCtx</code> between snapshot versions in the same wasm module?</p>
</blockquote>



<a name="191168385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168385">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395271449" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395271449">PR Review Comment</a>:</p>
<blockquote>
<p>This isn't strictly incorrect (at least while we only have one thread), but it feels awkward. Would it work to do something like this? A little verbose still, but it only does one borrow and one entries lookup.</p>
<div class="codehilite"><pre><span></span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">maybe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ref</span>::<span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">entries</span><span class="p">.</span><span class="n">borrow</span><span class="p">(),</span><span class="w"> </span><span class="o">|</span><span class="n">entries</span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">entries</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fd</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">maybe</span><span class="p">.</span><span class="n">is_none</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="n">Errno</span>::<span class="n">BadF</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">Ref</span>::<span class="n">map</span><span class="p">(</span><span class="n">maybe</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">maybe_entry</span><span class="o">|</span><span class="w"> </span><span class="n">maybe_entry</span><span class="p">.</span><span class="n">unwrap</span><span class="p">())</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>


<p>?</p>
</blockquote>



<a name="191168386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168386">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395280911" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395280911">PR Review Comment</a>:</p>
<blockquote>
<p>What does <code>bc</code> stand for?</p>
</blockquote>



<a name="191168387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168387">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395276274" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395276274">PR Review Comment</a>:</p>
<blockquote>
<p>Is there a path to where these <code>trace!</code> calls could be auto-generated by wiggle?</p>
</blockquote>



<a name="191168388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168388">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395283993" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395283993">PR Review Comment</a>:</p>
<blockquote>
<p>Can you say more about the <code>unsafe</code> here? I assume wiggle has done the bounds checking before we get here, is that right?</p>
</blockquote>



<a name="191168389"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168389" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168389">(Mar 19 2020 at 20:07)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395288367" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395288367">PR Review Comment</a>:</p>
<blockquote>
<p>Is it temporary to add this hook in <code>wig</code> here?</p>
</blockquote>



<a name="191168565"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168565" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168565">(Mar 19 2020 at 20:08)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378055979" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378055979">PR Review</a>.</p>



<a name="191168566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168566">(Mar 19 2020 at 20:08)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395290369" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395290369">PR Review Comment</a>:</p>
<blockquote>
<p>Ah, excellent observation!</p>
</blockquote>



<a name="191168639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168639">(Mar 19 2020 at 20:09)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378056420" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378056420">PR Review</a>.</p>



<a name="191168640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168640">(Mar 19 2020 at 20:09)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395290704" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395290704">PR Review Comment</a>:</p>
<blockquote>
<p>Awesome, this is exactly what I wanted to do and couldn't figure out how. Thanks! :-D</p>
</blockquote>



<a name="191168706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168706">(Mar 19 2020 at 20:09)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378056920" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378056920">PR Review</a>.</p>



<a name="191168707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168707">(Mar 19 2020 at 20:09)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395291081" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395291081">PR Review Comment</a>:</p>
<blockquote>
<p>Right, I've actually tweaked this only so that it builds. I was going to cc you about the <code>fs</code> module and how we'd want to handle things here :-)</p>
</blockquote>



<a name="191168893"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168893" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168893">(Mar 19 2020 at 20:11)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378057912" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378057912">PR Review</a>.</p>



<a name="191168895"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168895" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168895">(Mar 19 2020 at 20:11)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395291837" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395291837">PR Review Comment</a>:</p>
<blockquote>
<p>Excellent question! Thanks for bringing it up! @pchickey and I had some thoughts about this, and as far as I can tell, he would rather avoid adding logging to <code>wiggle</code> (which is where we'd want this to end up actually). I haven't put that much thought to it just yet, hence why I left the traces in <code>wasi-common</code>, but I'm open to suggestions here!</p>
</blockquote>



<a name="191168943"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168943" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168943">(Mar 19 2020 at 20:11)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395292094" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395292094">PR Review Comment</a>:</p>
<blockquote>
<p>Ah, I missed the part of your earlier comment where you explained this ^_^.</p>
</blockquote>



<a name="191168944"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191168944" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191168944">(Mar 19 2020 at 20:11)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378058258" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378058258">PR Review</a>.</p>



<a name="191169049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169049">(Mar 19 2020 at 20:12)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378058893" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378058893">PR Review</a>.</p>



<a name="191169050"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169050" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169050">(Mar 19 2020 at 20:12)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395292613" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395292613">PR Review Comment</a>:</p>
<blockquote>
<p>Excellent question! So I think it won't be that difficult. However, I suggest to leave that for a subsequent PR. I'm purposely migrated all impls into one module and directly into the trait impl so that we can have a better idea how to tackle the problem of multiple snapshots/polyfill. Does it make sense?</p>
</blockquote>



<a name="191169119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169119">(Mar 19 2020 at 20:13)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378059582" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378059582">PR Review</a>.</p>



<a name="191169120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169120">(Mar 19 2020 at 20:13)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395293147" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395293147">PR Review Comment</a>:</p>
<blockquote>
<p>You got me, I was just following @alexcrichton's example in <code>wiggle</code>'s tests :-} I'm happy to change it to something more meaningful, say <code>borrows</code>?</p>
</blockquote>



<a name="191169499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169499">(Mar 19 2020 at 20:17)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378061849" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378061849">PR Review</a>.</p>



<a name="191169500"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169500" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169500">(Mar 19 2020 at 20:17)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395294956" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395294956">PR Review Comment</a>:</p>
<blockquote>
<p>That's correct, <code>as_raw</code> does the bounds checking. We need <code>unsafe</code> here since we're dereferencing a raw <code>*mut _</code> pointer, and in this particular case, we're obtaining <code>&amp;str</code>. The signature of this function here is:</p>
<div class="codehilite"><pre><span></span><span class="k">fn</span> <span class="nf">as_raw</span><span class="p">(...)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;*</span><span class="k">mut</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">GuestError</span><span class="o">&gt;</span><span class="w"></span>
</pre></div>


<p>This is unsafe since we cannot really track the references here other than by using <code>GuestBorrows</code>. More on that <a href="https://github.com/bytecodealliance/wasmtime/blob/master/crates/wiggle/crates/runtime/src/lib.rs#L401" target="_blank" title="https://github.com/bytecodealliance/wasmtime/blob/master/crates/wiggle/crates/runtime/src/lib.rs#L401">here</a>.</p>
</blockquote>



<a name="191169607"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169607" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169607">(Mar 19 2020 at 20:18)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395295411" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395295411">PR Review Comment</a>:</p>
<blockquote>
<p>Yep, until we figure out where to put the glue macro for <code>wasmtime-wasi</code>/<code>wasmtime</code>, i.e., the one that's autogenerating the <code>Func</code> wrappers, and whatnot.</p>
</blockquote>



<a name="191169608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191169608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191169608">(Mar 19 2020 at 20:18)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378062413" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378062413">PR Review</a>.</p>



<a name="191170305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170305">(Mar 19 2020 at 20:24)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378066668" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378066668">PR Review</a>.</p>



<a name="191170306"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170306" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170306">(Mar 19 2020 at 20:24)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395298687" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395298687">PR Review Comment</a>:</p>
<blockquote>
<p>I'll try to beat everyone to the question here. I'm not sure how to handle this better with the current state of <code>wiggle</code> (which is not to say we can't modify <code>wiggle</code> to accommodate this case). So, I was forced to create two instances of <code>GuestBorrows</code> since it is possible for the two <code>path</code>s that are handed to us from guest to point at the same memory location (one use case being for instance symlink loops, etc.).</p>
<p>I was thinking, we could potentially check for that by comparing the pointers (if they implemented <code>PartialEq</code>), but it still feels clunky. Perhaps we should revisit the concept of immutability in <code>wiggle</code>? That is, differentiate immutable vs mutable borrows? In this case, I reckon it should be fine to borrow the same location immutably multiple times. Thoughts? @alexcrichton what do you reckon?</p>
</blockquote>



<a name="191170358"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170358" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170358">(Mar 19 2020 at 20:25)</a>:</h4>
<p>kubkon edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395298687" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395298687">PR Review Comment</a>.</p>



<a name="191170621"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170621" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170621">(Mar 19 2020 at 20:27)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378068619" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378068619">PR Review</a>.</p>



<a name="191170623"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170623" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170623">(Mar 19 2020 at 20:27)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395300196" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395300196">PR Review Comment</a>:</p>
<blockquote>
<p>@sunfishcode Note that we don't have <code>unsafe</code>'s in methods' signatures. I was somewhat worried about this since we're still dealing with file descriptors and other OS handles, but perhaps the entry points to WASI syscalls are OK being safe especially given that WASI fd is now a handle type? What do you think?</p>
</blockquote>



<a name="191170676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170676">(Mar 19 2020 at 20:27)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395300511" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395300511">PR Review Comment</a>:</p>
<blockquote>
<p>This is a great question. One alternative to creating two different borrowed path strings is to clone two path strings from the wasm memory into Rust owned <code>String</code>s. I expect, since paths shouldn't be too big, that is the right design choice here, except for the possibility of a DoS attack by creating two 4gb Strings here.</p>
</blockquote>



<a name="191170677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170677">(Mar 19 2020 at 20:27)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378068973" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378068973">PR Review</a>.</p>



<a name="191170746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191170746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191170746">(Mar 19 2020 at 20:28)</a>:</h4>
<p>pchickey edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395300511" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395300511">PR Review Comment</a>.</p>



<a name="191171407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191171407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191171407">(Mar 19 2020 at 20:34)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378073117" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378073117">PR Review</a>.</p>



<a name="191171408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191171408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191171408">(Mar 19 2020 at 20:34)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395303741" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395303741">PR Review Comment</a>:</p>
<blockquote>
<p>Differentiating between mutable and immutable borrows sounds like a good way to go.</p>
<p>For example, POSIX doesn't say anything about <a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/link.html" target="_blank" title="https://pubs.opengroup.org/onlinepubs/9699919799/functions/link.html"><code>link</code></a>'s arguments aliasing or not, but most functions with output buffers, such as <a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/readlink.html" target="_blank" title="https://pubs.opengroup.org/onlinepubs/9699919799/functions/readlink.html">readlink</a> are defined with <code>restrict</code> qualifiers, meaning the output buffer is expected to not overlap with any of the input buffers. This also echos the Rust's borrow checker: you can have many aliasing immutable references, but a mutable reference must be unaliased.</p>
</blockquote>



<a name="191174611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191174611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191174611">(Mar 19 2020 at 20:59)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378089521" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378089521">PR Review</a>.</p>



<a name="191174612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191174612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191174612">(Mar 19 2020 at 20:59)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395316546" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395316546">PR Review Comment</a>:</p>
<blockquote>
<p>I've thought about this and I'm fairly convinced the right thing, for now, is to leave a nice comment that outlines the design decisions you just did in this thread. </p>
</blockquote>



<a name="191175490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191175490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191175490">(Mar 19 2020 at 21:07)</a>:</h4>
<p>pchickey edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395316546" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395316546">PR Review Comment</a>.</p>



<a name="191176845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191176845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191176845">(Mar 19 2020 at 21:19)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378101714" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378101714">PR Review</a>.</p>



<a name="191176846"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191176846" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191176846">(Mar 19 2020 at 21:19)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395325897" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395325897">PR Review Comment</a>:</p>
<blockquote>
<p>its short for "borrow checker".</p>
</blockquote>



<a name="191177741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191177741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191177741">(Mar 19 2020 at 21:28)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395330048" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395330048">PR Review Comment</a>:</p>
<blockquote>
<p>Could there be a <code>log</code> feature of <code>wiggle</code> which generates log statements? That way wasmtime could turn it on but if it's not needed in lucet it could be disabled?</p>
</blockquote>



<a name="191177742"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191177742" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191177742">(Mar 19 2020 at 21:28)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378106940" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378106940">PR Review</a>.</p>



<a name="191177804"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191177804" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191177804">(Mar 19 2020 at 21:29)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378107388" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378107388">PR Review</a>.</p>



<a name="191177805"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191177805" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191177805">(Mar 19 2020 at 21:29)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395330380" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395330380">PR Review Comment</a>:</p>
<blockquote>
<p>I'd actually imagine that it makes it <em>easier</em> to share a <code>WasiCtx</code> between versions because we could implement both traits for one struct!</p>
</blockquote>



<a name="191179188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191179188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191179188">(Mar 19 2020 at 21:44)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378115571" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378115571">PR Review</a>.</p>



<a name="191179189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191179189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191179189">(Mar 19 2020 at 21:44)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336971" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336971">PR Review Comment</a>:</p>
<blockquote>
<p>Crazy idea that I haven't thought all the way through yet: Would it work if we made <code>Fd</code> work like <code>std::fs::File</code>?</p>
<ul>
<li>Make <code>Fd::from_raw</code> unsafe? , similar to <a href="https://doc.rust-lang.org/std/fs/struct.File.html#method.from_raw_fd" target="_blank" title="https://doc.rust-lang.org/std/fs/struct.File.html#method.from_raw_fd"><code>from_raw_fd</code></a> being unsafe.</li>
<li>Make <code>Fd</code> <em>not</em> implement <code>Copy</code>. Change <code>Fd</code> arguments to <code>&amp;Fd</code>.</li>
<li>Make <code> Fd</code> implement <code>Drop</code> and have it automatically close. This might be hard though. Is there a way in Rust to make <code>drop</code> private, so that you have to pass it back to the context?</li>
</ul>
</blockquote>



<a name="191180035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180035">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378109877" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378109877">PR Review</a>.</p>



<a name="191180037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180037">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378109877" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378109877">PR Review</a>.</p>



<a name="191180038"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180038" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180038">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395334184" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395334184">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW stylistically I'd group sets of statements that are all "participating in the unsafe" together rather than trying to minimize the <code>unsafe</code> block to just one expression.</p>
</blockquote>



<a name="191180039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180039">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395335855" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395335855">PR Review Comment</a>:</p>
<blockquote>
<p>I'm not sure if this is how it was implemented before, but I'm actually pretty surprised by this. I thought that one of the purposes of <code>GuestBorrows</code> and stuff was to pass wasm buffers directly to syscalls, no?</p>
</blockquote>



<a name="191180040"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180040" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180040">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395332447" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395332447">PR Review Comment</a>:</p>
<blockquote>
<p>One of the downsides of this returning <code>RefMut</code> directly is that it runs the risk of making it easy to panic in wasi-common code by accident I think. For example if while you have a <code>RefMut</code> you call back into wasm any reentrancy back into wasi would cause a panic due to a failed borrow.</p>
<p>It may just be worth documenting that for now, but wanted to point out that this may be a panic waiting to happen in the future.</p>
</blockquote>



<a name="191180041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180041">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395334769" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395334769">PR Review Comment</a>:</p>
<blockquote>
<p>Also, I don't think this function needs to be <code>unsafe</code>?</p>
</blockquote>



<a name="191180042"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180042" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180042">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395333926" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395333926">PR Review Comment</a>:</p>
<blockquote>
<p>I think the usage of <code>GuestBorrows</code> here technically may not be correct. There's no real need to do any borrow checking here because there's no long-lived borrows, this is effectively just a "given this guest slice pointer write in these bytes' which is in general a safe operation (like <code>GuestPtr::write</code> is)</p>
</blockquote>



<a name="191180043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180043">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336232">PR Review Comment</a>:</p>
<blockquote>
<p>As a side note, this is not a safe function in general because the virtual implementation could reenter wasm. I think we'll want to make the virtual traits <code>unsafe</code> since you need to assert you don't reenter wasm or try to reborrow/read/etc from wasm memory in the underlying implementations.</p>
</blockquote>



<a name="191180044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180044">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336797" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336797">PR Review Comment</a>:</p>
<blockquote>
<p>I'd have the same question as before with <code>pread</code> here about passing raw wasm buffers to the underlying implementation.</p>
</blockquote>



<a name="191180045"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180045" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180045">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395337623" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395337623">PR Review Comment</a>:</p>
<blockquote>
<p>There's two <code>slices</code> vecs here, but I think there only needs to be one?</p>
</blockquote>



<a name="191180046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180046">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395339491" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395339491">PR Review Comment</a>:</p>
<blockquote>
<p>I don't actually think that <code>GuestBorrows</code> is really needed here at all because there are no long-lived pointers, I think it's fine to do what this is currently doing, but I might recommend making it a bit more concise with the comment I made above</p>
</blockquote>



<a name="191180047"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180047" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180047">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336563" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395336563">PR Review Comment</a>:</p>
<blockquote>
<p>This idiom is showing up in a few places ("given this slice write this slice"), so it might be good to encapsulate this in a safe function perhaps?</p>
</blockquote>



<a name="191180048"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180048" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180048">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395337358" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395337358">PR Review Comment</a>:</p>
<blockquote>
<p>This <code>read</code> is unsafe in combination with the long-lived borrows here, you'll need to add the <code>GuestPtr&lt;Iovec&gt;</code> to the <code>GuestBorrows</code> to make sure this pointer doesn't overlap with previous buffers.</p>
</blockquote>



<a name="191180049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180049">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395339832" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395339832">PR Review Comment</a>:</p>
<blockquote>
<p>Hm does <code>as_raw</code> or <code>as_array</code> not work with zero-length arrays? I would naively expect this condition to not be necessary.</p>
</blockquote>



<a name="191180050"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180050" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180050">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395338783" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395338783">PR Review Comment</a>:</p>
<blockquote>
<p>Could the idiom of unsafely getting a <code>&amp;str</code> and then calling <code>path::get</code> be wrapped up in a safe function to <code>unsafe</code> doesn't have to be used each time a path is resolved?</p>
</blockquote>



<a name="191180051"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180051" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180051">(Mar 19 2020 at 21:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395340235" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395340235">PR Review Comment</a>:</p>
<blockquote>
<p>Technically the FIXME items elsewhere are equally applicable here, there's not really any fundamental reason why these two guest buffers shouldn't be allowed to overlap.</p>
</blockquote>



<a name="191180572"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180572" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180572">(Mar 19 2020 at 21:57)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378122531" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378122531">PR Review</a>.</p>



<a name="191180573"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180573" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180573">(Mar 19 2020 at 21:57)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395342647" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395342647">PR Review Comment</a>:</p>
<blockquote>
<p>Unfortunately, this is how it was implemented before. I think we should correct it in a follow-up PR.</p>
</blockquote>



<a name="191180690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180690">(Mar 19 2020 at 21:59)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378123154" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378123154">PR Review</a>.</p>



<a name="191180691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180691">(Mar 19 2020 at 21:59)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395343199" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395343199">PR Review Comment</a>:</p>
<blockquote>
<p>Agreed, this could be a method on GuestPtr&lt;[T]&gt;</p>
</blockquote>



<a name="191180708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180708">(Mar 19 2020 at 21:59)</a>:</h4>
<p>pchickey edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395343199" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395343199">PR Review Comment</a>.</p>



<a name="191180842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180842">(Mar 19 2020 at 22:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378123775" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378123775">PR Review</a>.</p>



<a name="191180843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191180843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191180843">(Mar 19 2020 at 22:00)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395343688" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395343688">PR Review Comment</a>:</p>
<blockquote>
<p>Ah ok, in that case I think we can probably avoid the <code>GuestBorrows</code> and collecting slices, since all the writes/reads only happen in one go and there's no need for long-lived borrows.</p>
</blockquote>



<a name="191191878"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191191878" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191191878">(Mar 20 2020 at 00:32)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378179940" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378179940">PR Review</a>.</p>



<a name="191191879"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191191879" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191191879">(Mar 20 2020 at 00:32)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395391270" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395391270">PR Review Comment</a>:</p>
<blockquote>
<p>The <code>unsafe</code> is there for the raw file descriptor. This is a convention we picked up from <code>std::fs::File::from_raw_fd</code>, which isn't necessarily memory-unsafe, but extends the concept of safety to include I/O safety. Or an alternative interpretation is that file descriptors are pointers into a different address space (they can dangle, alias, be out of bounds, be bogus, etc.), and memory safety rules should apply to that address space too.</p>
<p>That said, I think we're still working out exactly how we want to approach this. See <a href="https://github.com/bytecodealliance/wasmtime/pull/1202/files#r395300196" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202/files#r395300196">https://github.com/bytecodealliance/wasmtime/pull/1202/files#r395300196</a> for an example.</p>
</blockquote>



<a name="191192036"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191192036" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191192036">(Mar 20 2020 at 00:34)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378180679" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378180679">PR Review</a>.</p>



<a name="191192037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191192037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191192037">(Mar 20 2020 at 00:34)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395391965" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395391965">PR Review Comment</a>:</p>
<blockquote>
<p>On further consideration, the <code>Drop</code> part makes this unworkable. I'm going to investigate other approaches.</p>
</blockquote>



<a name="191203155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191203155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191203155">(Mar 20 2020 at 05:02)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378234883" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378234883">PR Review</a>.</p>



<a name="191203156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191203156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191203156">(Mar 20 2020 at 05:02)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395440224" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395440224">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, I don't think I understand what you mean here by <code>GuestBorrows</code> not needed here at all. I'm probably missing something but let me outline the things I do believe:</p>
<p>I agree that in this case, the borrow checking is vacuous. But there isn't presently another method besides <code>GuestPtr::as_raw</code> that allows us to get a <code>&amp;str</code> out of this <code>GuestPtr&lt;str&gt;</code>. We could add a method to GuestPtr that returns an owned <code>String</code>, but I fear that is a DoS vector because the guest will control the size of that String, and therefore gets to allocate in Rust's heap. We haven't yet rigorously audited this codebase for DoS vectors, of course, but I'm wary of adding something I know I'll have to forbid actually using in production.</p>
<p>I do not think we should create a shortcut variant of <code>GuestPtr::as_raw</code> to omit borrow checking which is only safe if the user ensures borrows are always short-lived, because I could see that leading to bugs when someone less familiar with the safety properties updates the code. Maybe that is too paranoid?</p>
</blockquote>



<a name="191215192"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215192" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215192">(Mar 20 2020 at 08:59)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191215643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215643">(Mar 20 2020 at 09:05)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378317626" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378317626">PR Review</a>.</p>



<a name="191215644"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215644" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215644">(Mar 20 2020 at 09:05)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395508570" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395508570">PR Review Comment</a>:</p>
<blockquote>
<p>Good point. Do you think we could do it in a subsequent PR and just leave reminder "TODO" comment now?</p>
</blockquote>



<a name="191215778"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215778" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215778">(Mar 20 2020 at 09:06)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378318476" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378318476">PR Review</a>.</p>



<a name="191215779"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215779" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215779">(Mar 20 2020 at 09:06)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395509262" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395509262">PR Review Comment</a>:</p>
<blockquote>
<p>Yep, @pchickey is right, I've just adapted the "prior art" to <code>wiggle-runtime</code> types. I'm happy to look at this though, but @pchickey might be right that we should perhaps increment in-tree?</p>
</blockquote>



<a name="191215836"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215836" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215836">(Mar 20 2020 at 09:07)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378319009" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378319009">PR Review</a>.</p>



<a name="191215837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191215837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191215837">(Mar 20 2020 at 09:07)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395509687" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395509687">PR Review Comment</a>:</p>
<blockquote>
<p>Cool, I'm fine with that. I have to admit when porting the syscalls to <code>wiggle-runtime</code> I was following the <code>fd_pread</code> example from <code>wiggle</code>'s WASI testcase :-)</p>
</blockquote>



<a name="191216585"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191216585" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191216585">(Mar 20 2020 at 09:15)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378323735" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378323735">PR Review</a>.</p>



<a name="191216586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191216586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191216586">(Mar 20 2020 at 09:15)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395513314" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395513314">PR Review Comment</a>:</p>
<blockquote>
<p>I guess you may be right, however, without the <code>GuestBorrows</code> I cannot obtain a mutable ref to <code>[u8]</code>, and there's not other simple way of copying the contents of <code>arg_bytes</code> into the <code>argv_buf</code> pointer currently. The only other way I can see is manually incrementing <code>argv_buf</code> pointer and copying byte-by-byte from <code>arg_bytes</code>. Unless I'm perhaps missing something here?</p>
</blockquote>



<a name="191216780"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191216780" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191216780">(Mar 20 2020 at 09:17)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378324953" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378324953">PR Review</a>.</p>



<a name="191216781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191216781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191216781">(Mar 20 2020 at 09:17)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395514331" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395514331">PR Review Comment</a>:</p>
<blockquote>
<p>Cool, I'll leave a comment in for now, and we can figure out a fix later. As far as <code>unsafe</code> is concerned, as @sunfishcode pointed out, this is "prior art" and was there to signal the unsafety of using I/O. FWIW I'd leave that in for now and we can figure out how to deal with all the unsafety in a future PR?</p>
</blockquote>



<a name="191216989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191216989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191216989">(Mar 20 2020 at 09:19)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378326260" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378326260">PR Review</a>.</p>



<a name="191216990"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191216990" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191216990">(Mar 20 2020 at 09:19)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395515353" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395515353">PR Review Comment</a>:</p>
<blockquote>
<p>I like the idea but yeah, <code>Drop</code> will not work like this, unless we made the context object static/global. Having said that your suggestion aligns with my mental model of <code>Fd</code> 100%, so perhaps we could come up with something close to it but not necessarily one-to-one.</p>
</blockquote>



<a name="191217154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217154">(Mar 20 2020 at 09:21)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378327181" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378327181">PR Review</a>.</p>



<a name="191217156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217156">(Mar 20 2020 at 09:21)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395516049" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395516049">PR Review Comment</a>:</p>
<blockquote>
<p>Exactly as @pchickey explained, obtaining a reference to a slice-type object in Rust from <code>wiggle</code> is currently only possible through <code>as_raw</code> method which requires a <code>GuestBorrows</code> object in scope.</p>
</blockquote>



<a name="191217366"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217366" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217366">(Mar 20 2020 at 09:23)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378328493" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378328493">PR Review</a>.</p>



<a name="191217367"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217367" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217367">(Mar 20 2020 at 09:23)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395517085" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395517085">PR Review Comment</a>:</p>
<blockquote>
<p>When you say "encapsulate in a safe function" do you mean as a helper in <code>wasi-common</code> or a method of <code>GuestPtr&lt;'_, [T]&gt;</code>? I'm partial to the latter approach, and agreed that a method like this would be most useful!</p>
</blockquote>



<a name="191217445"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217445" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217445">(Mar 20 2020 at 09:23)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378329130" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378329130">PR Review</a>.</p>



<a name="191217446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217446">(Mar 20 2020 at 09:23)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395517553" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395517553">PR Review Comment</a>:</p>
<blockquote>
<p>Excellent observation, and as I explained above, I've only made enough to make <code>wiggle</code> work with <code>wasi-common</code>. I'm happy to investigate this further though!</p>
</blockquote>



<a name="191217597"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217597" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217597">(Mar 20 2020 at 09:25)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378330083" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378330083">PR Review</a>.</p>



<a name="191217598"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191217598" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191217598">(Mar 20 2020 at 09:25)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395518322" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395518322">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, out of curiosity, is the example <a href="https://github.com/bytecodealliance/wasmtime/blob/master/crates/wiggle/tests/wasi.rs#L130" target="_blank" title="https://github.com/bytecodealliance/wasmtime/blob/master/crates/wiggle/tests/wasi.rs#L130">here</a> wrong then?</p>
</blockquote>



<a name="191218560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191218560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191218560">(Mar 20 2020 at 09:34)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191218986"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191218986" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191218986">(Mar 20 2020 at 09:38)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378338336" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378338336">PR Review</a>.</p>



<a name="191218987"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191218987" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191218987">(Mar 20 2020 at 09:39)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395525027" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395525027">PR Review Comment</a>:</p>
<blockquote>
<p>Oh, this must be a remnant of my hack to not stifle progress with <code>wasi-common</code> while some required changes to <code>wiggle</code> were in progress. This change is no longer part of this PR, so please ignore it.</p>
</blockquote>



<a name="191219192"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191219192" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191219192">(Mar 20 2020 at 09:41)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378339681" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378339681">PR Review</a>.</p>



<a name="191219193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191219193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191219193">(Mar 20 2020 at 09:41)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395526095" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395526095">PR Review Comment</a>:</p>
<blockquote>
<p>Oh, I believe what @alexcrichton suggests sounds like _the_ solution to this problem. @pchickey @sunfishcode what do you guys reckon? Oh, and until that lands in <code>wiggle</code>, my suggestion would be to leave the <code>trace</code>s as-is in <code>wasi-common</code>. What do you think?</p>
</blockquote>



<a name="191220086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191220086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191220086">(Mar 20 2020 at 09:50)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191220727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191220727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191220727">(Mar 20 2020 at 09:56)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378349452" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378349452">PR Review</a>.</p>



<a name="191220728"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191220728" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191220728">(Mar 20 2020 at 09:56)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395533662" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395533662">PR Review Comment</a>:</p>
<blockquote>
<p>Oh, and I think we should do the same for <code>wasi-common</code> as well. We've got a couple <code>log</code> calls here and there for debugging and what not, and I believe that @pchickey would like to have a version stripped off all altogether for lucet/xqd.</p>
</blockquote>



<a name="191220772"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191220772" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191220772">(Mar 20 2020 at 09:56)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378349796" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378349796">PR Review</a>.</p>



<a name="191220773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191220773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191220773">(Mar 20 2020 at 09:56)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395533914" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395533914">PR Review Comment</a>:</p>
<blockquote>
<p>Not suggesting we do it immediately in this PR, but we should have it in mind. :-)</p>
</blockquote>



<a name="191221368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191221368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191221368">(Mar 20 2020 at 10:02)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191222615"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191222615" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191222615">(Mar 20 2020 at 10:14)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191224501"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191224501" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191224501">(Mar 20 2020 at 10:35)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378374323" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378374323">PR Review</a>.</p>



<a name="191224503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191224503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191224503">(Mar 20 2020 at 10:35)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395552621" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395552621">PR Review Comment</a>:</p>
<blockquote>
<p>You're right, I'd expect this to work as well. It turns out <code>wiggle_runtime::Region</code> didn't accommodate for zero-length <code>Region</code>s. I've now fixed that in #1366. I'll leave a comment in to remove the check once it lands in <code>wiggle-runtime</code>.</p>
</blockquote>



<a name="191224760"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191224760" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191224760">(Mar 20 2020 at 10:38)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395554138" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395554138">PR Review Comment</a>:</p>
<blockquote>
<p>I've simplified this now, so have a look and lemme know what you reckon!</p>
</blockquote>



<a name="191224761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191224761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191224761">(Mar 20 2020 at 10:38)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378376311" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378376311">PR Review</a>.</p>



<a name="191224900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191224900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191224900">(Mar 20 2020 at 10:40)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191226713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191226713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191226713">(Mar 20 2020 at 10:58)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378388346" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378388346">PR Review</a>.</p>



<a name="191226714"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191226714" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191226714">(Mar 20 2020 at 10:58)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395563473" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395563473">PR Review Comment</a>:</p>
<blockquote>
<p>BTW @alexcrichton, lemme know what's your plan for this, i.e., what to use instead of <code>RefMut</code>! :-)</p>
</blockquote>



<a name="191226774"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191226774" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191226774">(Mar 20 2020 at 10:59)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191236012"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236012" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236012">(Mar 20 2020 at 12:35)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395606792" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395606792">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, thinking this through more carefully, maybe we can do this without the <code>Drop</code> part. So make <code>handle</code> types not implement <code>Copy</code>, pass <code>handle</code> arguments by reference rather than by value, and make the raw constructor <code>unsafe</code>. That's not the same as <code>std::fs::File</code>, but it still has some nice properties. We just need to be careful when calling the raw constructor, but there aren't many places where we need to do that outside of the generated wrappers. Does that sound feasible?</p>
<p>If you'd like to defer this to a later PR, that's fine too.</p>
</blockquote>



<a name="191236013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236013">(Mar 20 2020 at 12:35)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378443934" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378443934">PR Review</a>.</p>



<a name="191236100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236100">(Mar 20 2020 at 12:35)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191236414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236414">(Mar 20 2020 at 12:38)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395608307" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395608307">PR Review Comment</a>:</p>
<blockquote>
<p>OK, I've refactored both <code>pread</code> and <code>pwrite</code> so that we no longer need temp storage buffer. Instead, we're using slices bound to guest's memory directly (as <code>IoSliceMut</code> and <code>IoSlice</code> respectively), and both ops now essentially consists of two steps <code>SeekFrom::Start(offset)</code>, followed by <code>read_vectored(...)</code> and <code>write_vectored(...)</code> respectively.</p>
</blockquote>



<a name="191236415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236415">(Mar 20 2020 at 12:38)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378445866" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378445866">PR Review</a>.</p>



<a name="191236633"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236633" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236633">(Mar 20 2020 at 12:40)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378447198" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378447198">PR Review</a>.</p>



<a name="191236634"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236634" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236634">(Mar 20 2020 at 12:40)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395609313" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395609313">PR Review Comment</a>:</p>
<blockquote>
<p>Sounds good, and yeah, if we could defer to a subsequent PR, that would be perfect IMHO. There's already a substantial amount of tweaks I have to apply and I'm worried more and more will slip away. Is that OK?</p>
</blockquote>



<a name="191236822"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236822" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236822">(Mar 20 2020 at 12:42)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191236996"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236996" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236996">(Mar 20 2020 at 12:43)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378449413" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378449413">PR Review</a>.</p>



<a name="191236997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191236997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191236997">(Mar 20 2020 at 12:43)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395611052" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395611052">PR Review Comment</a>:</p>
<blockquote>
<p>I've done just that. Now <code>path::get</code> takes <code>&amp;GuestPtr&lt;'_, str&gt;</code> directly and does borrowing internally. This actually, at the surface at least, gets rid of the double-immutable-borrow problem.</p>
</blockquote>



<a name="191238248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191238248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191238248">(Mar 20 2020 at 12:56)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395617245" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395617245">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, but wouldn't <code>borrow_slice</code> take care of it for us here?</p>
</blockquote>



<a name="191238249"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191238249" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191238249">(Mar 20 2020 at 12:56)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378457504" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378457504">PR Review</a>.</p>



<a name="191239547"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191239547" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191239547">(Mar 20 2020 at 13:06)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191239781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191239781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191239781">(Mar 20 2020 at 13:08)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378465818" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378465818">PR Review</a>.</p>



<a name="191239782"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191239782" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191239782">(Mar 20 2020 at 13:08)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395623728" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395623728">PR Review Comment</a>:</p>
<blockquote>
<p>@pchickey What do you think of having a <code>from_raw</code> method for handles in <code>wiggle</code>?</p>
</blockquote>



<a name="191240247"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191240247" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191240247">(Mar 20 2020 at 13:13)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191248701"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191248701" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191248701">(Mar 20 2020 at 14:22)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191248784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191248784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191248784">(Mar 20 2020 at 14:23)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395669977" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395669977">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, I've now added an aux struct called <code>EntryTable</code> which holds both <code>fd_pool</code> and <code>entries</code>, and inside <code>WasiCtx</code> it's behind a single <code>RefCell</code> thus both working in sync.</p>
</blockquote>



<a name="191248785"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191248785" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191248785">(Mar 20 2020 at 14:23)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378526665" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378526665">PR Review</a>.</p>



<a name="191250992"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191250992" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191250992">(Mar 20 2020 at 14:39)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191251096"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251096" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251096">(Mar 20 2020 at 14:40)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378540983" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378540983">PR Review</a>.</p>



<a name="191251097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251097">(Mar 20 2020 at 14:40)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395680984" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395680984">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, since #1366 landed, I've now removed the check and everything works as expected <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>
</blockquote>



<a name="191251101"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251101" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251101">(Mar 20 2020 at 14:40)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378541006" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378541006">PR Review</a>.</p>



<a name="191251103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251103">(Mar 20 2020 at 14:40)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395681004" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395681004">PR Review Comment</a>:</p>
<blockquote>
<p>@pchickey er sorry I don't think I was being very clear! I don't think we should remove the <code>GuestBorrows</code> argument or use owned strings here, I mean that each of these is resolved independently and there's never any overlapping borrows so documenting fixmes and/or hacks isn't necessary because each path is getting sucked into an owned object anyway so borrows never last long enough for runtime borrow-checking to be that relevant.</p>
</blockquote>



<a name="191251397"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251397" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251397">(Mar 20 2020 at 14:42)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378542972" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378542972">PR Review</a>.</p>



<a name="191251398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251398">(Mar 20 2020 at 14:42)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395682502" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395682502">PR Review Comment</a>:</p>
<blockquote>
<p>Hm ok so I would strongly recommend removing <code>unsafe</code> here. There's already enough <code>unsafe</code> as-is with dealing with raw wasm memory, and this feels like it's overkill.</p>
<p>The unsafety around libstd's I/O was specifically about providing a guarantee that each entity holding a file descriptor owns that file descriptor. That allows safe abstractions around mmap and stuff (in theory). I really think we should not be adding <code>unsafe</code> here lightly, and we may just not have that guarantee for wasi-common.</p>
<p>The unsafety here also doesn't really seem to stop anything in practice, every callsite just wraps a <code>unsafe { ... }</code> block which just makes it more verbose to call these methods rather than providing the "oh I should think about this" speedbump it seems.</p>
</blockquote>



<a name="191251512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251512">(Mar 20 2020 at 14:43)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378543797" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378543797">PR Review</a>.</p>



<a name="191251513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251513">(Mar 20 2020 at 14:43)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395683140" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395683140">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, this proves to be more difficult than I originally envisioned. If I follow your suggestion, than we end up with a lifetime mismatch since the first <code>maybe</code> will contain weirdness of the like <code>&amp;Option&lt;&amp;Entry&gt;</code>, and the compiler cannot assign approriate lifetimes to the final <code>Ref&lt;'_, Entry&gt;</code>. Perhaps when  we revisit the use of <code>RefCell</code> in <code>wasi-common</code> altogether, this will no longer be an issue?</p>
</blockquote>



<a name="191251676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251676">(Mar 20 2020 at 14:44)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378544736" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378544736">PR Review</a>.</p>



<a name="191251677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251677">(Mar 20 2020 at 14:44)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395683886" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395683886">PR Review Comment</a>:</p>
<blockquote>
<p>Oh no nevermind my interpretation is wrong, I think this should be fine.</p>
</blockquote>



<a name="191251980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251980">(Mar 20 2020 at 14:47)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378546937" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378546937">PR Review</a>.</p>



<a name="191251981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191251981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191251981">(Mar 20 2020 at 14:47)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395685581" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395685581">PR Review Comment</a>:</p>
<blockquote>
<p>Oh I should also mention, I think the only real alternative to returning <code>RefMut&lt;Entry&gt;</code> is to return <code>Rc&lt;Entry&gt;</code>. That will likely be required anyway if we want to make this multithreaded at some point (probably don't want to hold locks for entireties of syscalls). I don't know of a great way to otherwise handle this. For now it seems fine to document how you need to be careful about holding a borrow for too long.</p>
</blockquote>



<a name="191252105"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191252105" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191252105">(Mar 20 2020 at 14:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378547782" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378547782">PR Review</a>.</p>



<a name="191252106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191252106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191252106">(Mar 20 2020 at 14:48)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395686230" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395686230">PR Review Comment</a>:</p>
<blockquote>
<p>Oh sorry my point is that persisting the same <code>GuestBorrows</code> for the entirety of this method I believe is not necessary. Each write can use an independent instance of <code>GuestBorrows</code> since there's no need to prevent overlap in this method.</p>
</blockquote>



<a name="191252263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191252263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191252263">(Mar 20 2020 at 14:49)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378549131" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378549131">PR Review</a>.</p>



<a name="191252264"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191252264" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191252264">(Mar 20 2020 at 14:49)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395687303" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395687303">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, right, I think I get it. <code>Rc</code> should still allow for obtaining <code>&amp;mut</code> of the wrapped type provided there is only one at play at any one time, right? And then in the multithreaded case, we'd just swap it for <code>Arc</code>?</p>
</blockquote>



<a name="191253103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253103">(Mar 20 2020 at 14:56)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378555120" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378555120">PR Review</a>.</p>



<a name="191253105"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253105" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253105">(Mar 20 2020 at 14:56)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395692047" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395692047">PR Review Comment</a>:</p>
<blockquote>
<p>I've posted <a href="https://github.com/bytecodealliance/wasmtime/pull/1367" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1367">https://github.com/bytecodealliance/wasmtime/pull/1367</a>, and my point here is that if that's used then there's no need for <code>GuestBorrows</code> in this method and no need for this method to be unsafe.</p>
</blockquote>



<a name="191253391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253391">(Mar 20 2020 at 14:58)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378556872" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378556872">PR Review</a>.</p>



<a name="191253392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253392">(Mar 20 2020 at 14:58)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395693806" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395693806">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW I've posted <a href="https://github.com/bytecodealliance/wasmtime/pull/1367" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1367">https://github.com/bytecodealliance/wasmtime/pull/1367</a> to cover this.</p>
</blockquote>



<a name="191253393"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253393" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253393">(Mar 20 2020 at 14:58)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395693416" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395693416">PR Review Comment</a>:</p>
<blockquote>
<p>In terms of semantics, I'm not sure if <code>pread</code> is specified to change the file cursor or not, but I believe this implementation does? Might be good to double check...</p>
</blockquote>



<a name="191253412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253412">(Mar 20 2020 at 14:58)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378557579" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378557579">PR Review</a>.</p>



<a name="191253413"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253413" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253413">(Mar 20 2020 at 14:58)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395693988" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395693988">PR Review Comment</a>:</p>
<blockquote>
<p>That's perfect! It'll clean up the code nicely! <span aria-label="sunglasses" class="emoji emoji-1f60e" role="img" title="sunglasses">:sunglasses:</span> </p>
</blockquote>



<a name="191253516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253516">(Mar 20 2020 at 14:59)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378558389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378558389">PR Review</a>.</p>



<a name="191253517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253517">(Mar 20 2020 at 14:59)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395694618" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395694618">PR Review Comment</a>:</p>
<blockquote>
<p>Oh crap, you're right, it shouldn't! I forgot to rewind the cursor! Thanks for bringing it up!</p>
</blockquote>



<a name="191253888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253888">(Mar 20 2020 at 15:02)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378560468" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378560468">PR Review</a>.</p>



<a name="191253890"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253890" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253890">(Mar 20 2020 at 15:02)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395696109" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395696109">PR Review Comment</a>:</p>
<blockquote>
<p>I don't believe that <code>&amp;mut</code> is needed anywhere actually? For example all methods on I/O files are implemented for <code>&amp;T</code> so you have to do something like <code>(&amp;entry.file).read(...)</code> which is a bit wonky, but there shouldn't be a fundamental need to ever mutate an <code>Entry</code>.</p>
<p>If there is though then a <code>RefCell</code> can always be used, and the borrows would need to be scoped in duration.</p>
</blockquote>



<a name="191253920"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253920" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253920">(Mar 20 2020 at 15:02)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378560690" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378560690">PR Review</a>.</p>



<a name="191253922"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191253922" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191253922">(Mar 20 2020 at 15:02)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395696284" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395696284">PR Review Comment</a>:</p>
<blockquote>
<p>Yes that should be fine</p>
</blockquote>



<a name="191255104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255104">(Mar 20 2020 at 15:10)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191255129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255129">(Mar 20 2020 at 15:10)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378567959" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378567959">PR Review</a>.</p>



<a name="191255131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255131">(Mar 20 2020 at 15:10)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395701874" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395701874">PR Review Comment</a>:</p>
<blockquote>
<p>Fixed! Thanks for spotting that one!</p>
</blockquote>



<a name="191255231"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255231" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255231">(Mar 20 2020 at 15:11)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395702355" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395702355">PR Review Comment</a>:</p>
<blockquote>
<p>I left the comment in <code>virtfs.rs</code> module.</p>
</blockquote>



<a name="191255232"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255232" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255232">(Mar 20 2020 at 15:11)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378568594" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378568594">PR Review</a>.</p>



<a name="191255972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255972">(Mar 20 2020 at 15:16)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378572870" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378572870">PR Review</a>.</p>



<a name="191255973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191255973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191255973">(Mar 20 2020 at 15:16)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395705872" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395705872">PR Review Comment</a>:</p>
<blockquote>
<p>You're absolutely right, we could easily operate on refs since we have impl on <code>&amp;T</code> for I/O in Rust. That's cool. I'll make this change here already to clean up the code as much as possible (i.e., removing the <code>mut</code>s). In terms of <code>Rc</code>, I'm guessing we'd still want to wrap the map holding the <code>Entry</code>s in an <code>Rc</code>?</p>
</blockquote>



<a name="191256190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191256190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191256190">(Mar 20 2020 at 15:18)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378574194" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378574194">PR Review</a>.</p>



<a name="191256197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191256197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191256197">(Mar 20 2020 at 15:18)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395706918" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395706918">PR Review Comment</a>:</p>
<blockquote>
<p>Right, we do since we still need to able to mutate <code>EntryTable</code> and <em>not</em> <code>Entry</code>!</p>
</blockquote>



<a name="191256326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191256326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191256326">(Mar 20 2020 at 15:18)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378574912" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378574912">PR Review</a>.</p>



<a name="191256327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191256327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191256327">(Mar 20 2020 at 15:18)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395707520" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395707520">PR Review Comment</a>:</p>
<blockquote>
<p>The map will want to be in a <code>RefCell</code> for sure (was <code>Rc</code> a typo?) because we're modifying it behind a shared reference, and then each entry would be in its own <code>Rc</code> to get handed out without holding a long-lived borrow.</p>
</blockquote>



<a name="191256463"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191256463" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191256463">(Mar 20 2020 at 15:19)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378575809" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378575809">PR Review</a>.</p>



<a name="191256464"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191256464" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191256464">(Mar 20 2020 at 15:19)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395708206" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395708206">PR Review Comment</a>:</p>
<blockquote>
<p>Sorry, yeah, meant <code>RefCell</code>.</p>
<p>Right, makes sense!</p>
</blockquote>



<a name="191261191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191261191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191261191">(Mar 20 2020 at 15:49)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378601130" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378601130">PR Review</a>.</p>



<a name="191261192"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191261192" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191261192">(Mar 20 2020 at 15:49)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395727426" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395727426">PR Review Comment</a>:</p>
<blockquote>
<p>I was wrong actually. We do need to be able to mutate <code>Entry</code> in two places: <code>fd_fdstat_set_rights</code> and <code>fd_fdstat_set_flags</code>.</p>
</blockquote>



<a name="191265430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191265430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191265430">(Mar 20 2020 at 16:17)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191265705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191265705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191265705">(Mar 20 2020 at 16:19)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378626899" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378626899">PR Review</a>.</p>



<a name="191265706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191265706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191265706">(Mar 20 2020 at 16:19)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395746716" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395746716">PR Review Comment</a>:</p>
<blockquote>
<p>@sunfishcode would you agree at removing the <code>unsafe</code> here?</p>
</blockquote>



<a name="191266963"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191266963" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191266963">(Mar 20 2020 at 16:29)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395753144" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395753144">PR Review Comment</a>:</p>
<blockquote>
<p>Yes. I've been exploring the "pass Fd by reference" idea more, and I'm sufficiently confident that that will provide a way for <code>get_entry</code> and <code>get_entry_mut</code> to be safe functions, even considering I/O safety, so I think we can leave the unsafe off for now because that's where they'll end up anyway.</p>
</blockquote>



<a name="191266964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191266964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191266964">(Mar 20 2020 at 16:29)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378634978" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378634978">PR Review</a>.</p>



<a name="191269482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191269482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191269482">(Mar 20 2020 at 16:47)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378648696" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378648696">PR Review</a>.</p>



<a name="191269483"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191269483" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191269483">(Mar 20 2020 at 16:47)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395763799" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395763799">PR Review Comment</a>:</p>
<blockquote>
<p>@alexcrichton Would you be OK if we parked the <code>&amp;</code> vs <code>&amp;mut</code> cleanup in <code>wasi-common</code>? Changing to <code>&amp;</code> in most cases while absolutely correct will require some more work with <code>virtfs</code> module (at quick glance, not everything is behind a <code>RefCell</code> or alike to be able to mutate the interior behind <code> &amp;</code>.</p>
</blockquote>



<a name="191269690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191269690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191269690">(Mar 20 2020 at 16:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378649571" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378649571">PR Review</a>.</p>



<a name="191269691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191269691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191269691">(Mar 20 2020 at 16:48)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395764456" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395764456">PR Review Comment</a>:</p>
<blockquote>
<p>Oh sorry yeah, I think cleaning up later is fine, but it'd be nice to remove the <code>unsafe</code> before landing</p>
</blockquote>



<a name="191269808"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191269808" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191269808">(Mar 20 2020 at 16:49)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378650246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378650246">PR Review</a>.</p>



<a name="191269809"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191269809" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191269809">(Mar 20 2020 at 16:49)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395765003" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395765003">PR Review Comment</a>:</p>
<blockquote>
<p>Absolutely, I'm on it <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="191270470"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191270470" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191270470">(Mar 20 2020 at 16:53)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191270706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191270706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191270706">(Mar 20 2020 at 16:55)</a>:</h4>
<p><strong>kubkon</strong> requested <a href="https://github.com/alexcrichton" target="_blank" title="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a>.</p>



<a name="191270711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191270711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191270711">(Mar 20 2020 at 16:55)</a>:</h4>
<p><strong>kubkon</strong> requested <a href="https://github.com/alexcrichton" target="_blank" title="https://github.com/alexcrichton">alexcrichton</a>, and <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a>.</p>



<a name="191270720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191270720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191270720">(Mar 20 2020 at 16:55)</a>:</h4>
<p><strong>kubkon</strong> requested <a href="https://github.com/alexcrichton" target="_blank" title="https://github.com/alexcrichton">alexcrichton</a>, <a href="https://github.com/pchickey" target="_blank" title="https://github.com/pchickey">pchickey</a>, and <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a>.</p>



<a name="191273321"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191273321" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191273321">(Mar 20 2020 at 17:13)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378666542" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378666542">PR Review</a>.</p>



<a name="191273323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191273323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191273323">(Mar 20 2020 at 17:13)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378666542" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378666542">PR Review</a>.</p>



<a name="191273324"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191273324" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191273324">(Mar 20 2020 at 17:13)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395777552" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395777552">PR Review Comment</a>:</p>
<blockquote>
<p>This looks like it may be buggy? I think <code>environ_buf_offset</code> may not be needed here because we're already offseting <code>environ_buf</code> on each iteration of the loop?</p>
</blockquote>



<a name="191274979"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191274979" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191274979">(Mar 20 2020 at 17:26)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378668765" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378668765">PR Review</a>.</p>



<a name="191274980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191274980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191274980">(Mar 20 2020 at 17:26)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378668765" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378668765">PR Review</a>.</p>



<a name="191274981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191274981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191274981">(Mar 20 2020 at 17:26)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395779261" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395779261">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, if it gets awkward, then I agree it makes sense to leave the code as-is for now.</p>
</blockquote>



<a name="191281609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191281609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191281609">(Mar 20 2020 at 18:14)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191281694"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191281694" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191281694">(Mar 20 2020 at 18:15)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378711730" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378711730">PR Review</a>.</p>



<a name="191281698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191281698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191281698">(Mar 20 2020 at 18:15)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395812625" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#discussion_r395812625">PR Review Comment</a>:</p>
<blockquote>
<p>@alexcrichton Right on, thanks for spotting that one! I believe I've fixed it in 5e75830, but if you could double check, that'd be awesome!</p>
</blockquote>



<a name="191296754"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191296754" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191296754">(Mar 20 2020 at 20:16)</a>:</h4>
<p>kubkon updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a> from <code>wiggle-time</code> to <code>master</code>:</p>
<blockquote>
<p>It's [<code>wiggle</code>] time!</p>
<p>This PR is the beginning of a journey which aims at replacing <code>wig</code> crate with <code>wiggle</code>. @pchickey and myself have been working on <code>wiggle</code> for over a month now, and we feel we got to the point where it could successfully be used in <code>wasi-common</code>, <code>wasmtime</code> and <code>lucet</code>. We also agreed that if any functionality is still missing, we should iterate in-tree if possible. Anyhow, this is a draft PR so things will invariably change (a lot!), but I wanted to get it out there sooner rather than later so that I can get some meaningful feedback early on and work on addressing that when things are still plastic.</p>
<p>[<code>wiggle</code>]: <a href="https://github.com/kubkon/wiggle" target="_blank" title="https://github.com/kubkon/wiggle">https://github.com/kubkon/wiggle</a></p>
</blockquote>



<a name="191299505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191299505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191299505">(Mar 20 2020 at 20:40)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378798552" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202#pullrequestreview-378798552">PR Review</a>.</p>



<a name="191301105"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231202%20It%27s%20wiggle%20time%21/near/191301105" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231202.20It.27s.20wiggle.20time.21.html#191301105">(Mar 20 2020 at 20:54)</a>:</h4>
<p>kubkon merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1202" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1202">PR #1202</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>