<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5893 cranelift: Add big and little endian ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html">wasmtime / PR #5893 cranelift: Add big and little endian ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="338612935"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338612935" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338612935">(Feb 28 2023 at 15:13)</a>:</h4>
<p>jan-justin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5893">PR #5893</a> from <code>cranelift-big-little-endian-access</code> to <code>main</code>:</p>
<blockquote>
<p>This PR aims to add specific big-endian and little-endian memory accesses to the interpreter when performing a load or store operation, as discussed over at #5881.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="338613806"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338613806" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338613806">(Feb 28 2023 at 15:16)</a>:</h4>
<p>jan-justin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1317851434">PR review</a>.</p>



<a name="338613807"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338613807" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338613807">(Feb 28 2023 at 15:16)</a>:</h4>
<p>jan-justin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120235953">PR review comment</a>:</p>
<blockquote>
<p>As far as I can see, this function is only ever used for testing purposes so I assumed that specific endianness is not an issue here, but do let me know.</p>
</blockquote>



<a name="338614594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338614594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338614594">(Feb 28 2023 at 15:19)</a>:</h4>
<p>jan-justin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1317857322">PR review</a>.</p>



<a name="338614595"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338614595" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338614595">(Feb 28 2023 at 15:19)</a>:</h4>
<p>jan-justin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120240795">PR review comment</a>:</p>
<blockquote>
<p>@afonso360 you posited theses functions more as a question, so let me know if you don't think it will suffice.</p>
<p>Also, this could probably be DRY'd up with a macro, but my macrofu is not there yet. Let me know if I should go and do it though.</p>
</blockquote>



<a name="338618177"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338618177" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338618177">(Feb 28 2023 at 15:32)</a>:</h4>
<p>jan-justin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5893">PR #5893</a> from <code>cranelift-big-little-endian-access</code> to <code>main</code>.</p>



<a name="338657104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338657104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338657104">(Feb 28 2023 at 18:12)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1318241887">PR review</a>.</p>



<a name="338657106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338657106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338657106">(Feb 28 2023 at 18:12)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120560068">PR review comment</a>:</p>
<blockquote>
<p>Yeah, mostly because they match what we have in the rust standard library so it seemed natural to keep that naming convention.</p>
<p>This does involve a lot of repetitive code, and I also don't see a way out of this without creating a macro. @jameysharp any ideas here?</p>
</blockquote>



<a name="338657205"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338657205" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338657205">(Feb 28 2023 at 18:13)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1318242841">PR review</a>.</p>



<a name="338657209"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338657209" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338657209">(Feb 28 2023 at 18:13)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120560619">PR review comment</a>:</p>
<blockquote>
<p>That seems to be used by our trampolines, so _ne should be the correct choice!</p>
</blockquote>



<a name="338657247"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338657247" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338657247">(Feb 28 2023 at 18:13)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120560619">PR review comment</a>.</p>



<a name="338658981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338658981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338658981">(Feb 28 2023 at 18:21)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1318261516">PR review</a>.</p>



<a name="338660530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338660530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338660530">(Feb 28 2023 at 18:27)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1318261516">PR review</a>.</p>



<a name="338700927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338700927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338700927">(Feb 28 2023 at 22:03)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1318732376">PR review</a>.</p>



<a name="338700928"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338700928" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338700928">(Feb 28 2023 at 22:03)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120844997">PR review comment</a>:</p>
<blockquote>
<p>Huh, yeah, this is tricky! As much as I dislike the duplication, I suspect a macro won't make the code more clear.</p>
<p>One question first: why aren't vectors byte-swapped in this implementation? Is there something I'm missing that makes them special?</p>
<p>Here's an alternative way to split this up. I'm not claiming it's the right choice, but it's an alternative we can discuss.</p>
<p>First, write a function that takes a <code>DataValue</code> and returns a <code>DataValue</code>, but with its contents unconditionally byte-swapped. In other words, if you have a <code>DataValue::I32(i)</code>, return <code>DataValue::I32(i.swap_bytes())</code>. For vectors, maybe we should be calling <code>reverse</code> on the arrays?</p>
<p>Next, write a pair of functions on <code>DataValue</code>, where one calls the above byte-swap function when run on a big-endian system, and the other calls it when run on a little-endian system. See the example code in <a href="https://doc.rust-lang.org/std/primitive.u32.html#method.to_be"><code>u32::to_be</code></a> and <code>to_le</code> for the pattern to follow. Note that <code>to_be</code> and <code>from_be</code> are functionally identical (both functions only byte-swap on little-endian systems), and similarly for <code>to_le</code> and <code>from_le</code>. So we don't actually need <code>to</code> and <code>from</code> variants for each endianness; just one will do.</p>
<p>Finally, keep <code>write_to_slice_ne</code> and <code>read_from_slice_ne</code> as they are here. The <code>_le</code> variants should call the <code>_ne</code> variants, but pass the <code>DataValue</code> through the method that only byte-swaps on big-endian systems. Similarly, the <code>_be</code> variants call the method that byte-swaps on little-endian systems. When reading, the swap happens after the native-endian read; when writing, the swap happens before the native-endian write.</p>
<p>That reduces this from six copies of this match on all of <code>DataValue</code>'s variants, to three. That's still two more than I'd prefer, but I think it's pretty reasonable.</p>
</blockquote>



<a name="338706020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338706020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338706020">(Feb 28 2023 at 22:39)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1318776129">PR review</a>.</p>



<a name="338706021"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338706021" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338706021">(Feb 28 2023 at 22:39)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1120881860">PR review comment</a>:</p>
<blockquote>
<p>For future work, not part of this PR: @afonso360, can/should <code>checked_load</code> validate mem-flags like <code>aligned</code>, now that they're passed in here anyway? And same question for <code>checked_store</code>.</p>
</blockquote>



<a name="338788161"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338788161" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338788161">(Mar 01 2023 at 09:56)</a>:</h4>
<p>jan-justin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1319478069">PR review</a>.</p>



<a name="338788163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338788163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338788163">(Mar 01 2023 at 09:56)</a>:</h4>
<p>jan-justin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1121440914">PR review comment</a>:</p>
<blockquote>
<p>Thank you for the input!</p>
<p>No, vectors are not special. It seems I just slipped up. Thanks for pointing it out.</p>
<p>As for your proposal, I would be inclined to agree with you. I am in favour of cutting it down so as to make it more manageable and catch errors like the one above.</p>
</blockquote>



<a name="338801513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338801513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338801513">(Mar 01 2023 at 10:54)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1121519962">PR review comment</a>:</p>
<blockquote>
<p>Oh yeah it absolutely should! I've opened #5899 for this</p>
</blockquote>



<a name="338801514"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338801514" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338801514">(Mar 01 2023 at 10:54)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1319587644">PR review</a>.</p>



<a name="338801713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338801713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338801713">(Mar 01 2023 at 10:55)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1121519962">PR review comment</a>.</p>



<a name="338804291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338804291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338804291">(Mar 01 2023 at 11:06)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1121519962">PR review comment</a>.</p>



<a name="338804364"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338804364" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338804364">(Mar 01 2023 at 11:06)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1121519962">PR review comment</a>.</p>



<a name="338932287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338932287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338932287">(Mar 01 2023 at 19:10)</a>:</h4>
<p>jan-justin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5893">PR #5893</a> from <code>cranelift-big-little-endian-access</code> to <code>main</code>.</p>



<a name="338934693"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338934693" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338934693">(Mar 01 2023 at 19:22)</a>:</h4>
<p>jan-justin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1320480009">PR review</a>.</p>



<a name="338934695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338934695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338934695">(Mar 01 2023 at 19:22)</a>:</h4>
<p>jan-justin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122203254">PR review comment</a>:</p>
<blockquote>
<p>I used the Rust core lib as inspiration, and modelled it quite closely. However, I am unsure about whether to change the <code>write_to_slice_*</code> and <code>read_from_slice_*</code> methods to move instead of borrow. The result is having to copy data in the write calls. Let me know if this is not desirable.</p>
</blockquote>



<a name="338936767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338936767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338936767">(Mar 01 2023 at 19:31)</a>:</h4>
<p>jan-justin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122203254">PR review comment</a>.</p>



<a name="338937684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338937684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338937684">(Mar 01 2023 at 19:35)</a>:</h4>
<p>jan-justin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122203254">PR review comment</a>.</p>



<a name="338991701"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338991701" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338991701">(Mar 02 2023 at 02:22)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1320937836">PR review</a>.</p>



<a name="338991702"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338991702" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338991702">(Mar 02 2023 at 02:22)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1320937836">PR review</a>.</p>



<a name="338991703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338991703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338991703">(Mar 02 2023 at 02:22)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122528988">PR review comment</a>:</p>
<blockquote>
<p>I have a slight preference for writing this in the <code>if cfg!(...) { ... } else { ... }</code> style because that way the compiler will check that both branches are valid before constant-folding one of them away. Also it's shorter that way.</p>
</blockquote>



<a name="338991704"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/338991704" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#338991704">(Mar 02 2023 at 02:22)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122530463">PR review comment</a>:</p>
<blockquote>
<p>I didn't think about needing to clone! But I think the way you've done it is fine. For one thing, this is only 32 bytes if I counted correctly, so it's not that much to copy. LLVM might even optimize away the copies. But more importantly, this is primarily used in the interpreter, which is already not expected to be super fast.</p>
</blockquote>



<a name="339024608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/339024608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#339024608">(Mar 02 2023 at 07:51)</a>:</h4>
<p>jan-justin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1321194421">PR review</a>.</p>



<a name="339024609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/339024609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#339024609">(Mar 02 2023 at 07:51)</a>:</h4>
<p>jan-justin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122709806">PR review comment</a>:</p>
<blockquote>
<p>No problem. Consider it done.</p>
</blockquote>



<a name="339024894"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/339024894" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#339024894">(Mar 02 2023 at 07:53)</a>:</h4>
<p>jan-justin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#pullrequestreview-1321197611">PR review</a>.</p>



<a name="339024896"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/339024896" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#339024896">(Mar 02 2023 at 07:53)</a>:</h4>
<p>jan-justin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5893#discussion_r1122711991">PR review comment</a>:</p>
<blockquote>
<p>Great, thanks again!</p>
<p>I figured it may not be that big a deal, but I drew attention to it just in case. I will keep this in mind going forward though.</p>
</blockquote>



<a name="339025616"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/339025616" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#339025616">(Mar 02 2023 at 07:57)</a>:</h4>
<p>jan-justin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5893">PR #5893</a> from <code>cranelift-big-little-endian-access</code> to <code>main</code>.</p>



<a name="339085416"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235893%20cranelift%3A%20Add%20big%20and%20little%20endian%20.../near/339085416" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235893.20cranelift.3A.20Add.20big.20and.20little.20endian.20.2E.2E.2E.html#339085416">(Mar 02 2023 at 12:31)</a>:</h4>
<p>afonso360 merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5893">PR #5893</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>