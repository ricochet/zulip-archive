<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6985 cranelift: Fix `v{all,any}_true` and ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236985.20cranelift.3A.20Fix.20.60v.7Ball.2Cany.7D_true.60.20and.20.2E.2E.2E.html">wasmtime / PR #6985 cranelift: Fix `v{all,any}_true` and ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="390027941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236985%20cranelift%3A%20Fix%20%60v%7Ball%2Cany%7D_true%60%20and%20.../near/390027941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236985.20cranelift.3A.20Fix.20.60v.7Ball.2Cany.7D_true.60.20and.20.2E.2E.2E.html#390027941">(Sep 09 2023 at 11:50)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6985">PR #6985</a>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>This PR fixes the <code>v{all,any}_true</code> and <code>vhigh_bits</code> for floats in the cranelift interpreter. Since these are all bitwise operations, the fix was similar for all of them, convert the type to an equivalent sized integer type and proceed with the operation as normal.</p>
<p>Additionally this PR also restricts the return types for <a href="https://docs.rs/cranelift-codegen/latest/cranelift_codegen/ir/trait.InstBuilder.html#method.vhigh_bits"><code>vhigh_bits</code></a> down to scalar integers. It currently allows returning SIMD integer types which looks like an oversight since it clearly states that it returns a scalar integer in the docs. (Let me know if you'd like me to pull this into a separate PR)</p>
<p>Finally, these instructions are also enabled in the fuzzgen fuzzer.</p>
</blockquote>



<a name="390027970"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236985%20cranelift%3A%20Fix%20%60v%7Ball%2Cany%7D_true%60%20and%20.../near/390027970" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236985.20cranelift.3A.20Fix.20.60v.7Ball.2Cany.7D_true.60.20and.20.2E.2E.2E.html#390027970">(Sep 09 2023 at 11:50)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6985">PR #6985</a>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>This PR fixes the <code>v{all,any}_true</code> and <code>vhigh_bits</code> instructions for floats in the cranelift interpreter. Since these are all bitwise operations, the fix was similar for all of them, convert the type to an equivalent sized integer type and proceed with the operation as normal.</p>
<p>Additionally this PR also restricts the return types for <a href="https://docs.rs/cranelift-codegen/latest/cranelift_codegen/ir/trait.InstBuilder.html#method.vhigh_bits"><code>vhigh_bits</code></a> down to scalar integers. It currently allows returning SIMD integer types which looks like an oversight since it clearly states that it returns a scalar integer in the docs. (Let me know if you'd like me to pull this into a separate PR)</p>
<p>Finally, these instructions are also enabled in the fuzzgen fuzzer.</p>
</blockquote>



<a name="390052968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236985%20cranelift%3A%20Fix%20%60v%7Ball%2Cany%7D_true%60%20and%20.../near/390052968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236985.20cranelift.3A.20Fix.20.60v.7Ball.2Cany.7D_true.60.20and.20.2E.2E.2E.html#390052968">(Sep 09 2023 at 17:42)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6985#pullrequestreview-1618676423">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="390055377"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236985%20cranelift%3A%20Fix%20%60v%7Ball%2Cany%7D_true%60%20and%20.../near/390055377" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236985.20cranelift.3A.20Fix.20.60v.7Ball.2Cany.7D_true.60.20and.20.2E.2E.2E.html#390055377">(Sep 09 2023 at 18:22)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6985">PR #6985</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>