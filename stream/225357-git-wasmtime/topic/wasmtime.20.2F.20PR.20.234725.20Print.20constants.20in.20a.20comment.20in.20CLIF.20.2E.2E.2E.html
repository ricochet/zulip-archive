<html>
<head><meta charset="utf-8"><title>wasmtime / PR #4725 Print constants in a comment in CLIF ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html">wasmtime / PR #4725 Print constants in a comment in CLIF ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="293796362"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293796362" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293796362">(Aug 16 2022 at 20:38)</a>:</h4>
<p><strong>jameysharp</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a>.</p>



<a name="293796363"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293796363" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293796363">(Aug 16 2022 at 20:38)</a>:</h4>
<p>jameysharp opened <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a> from <code>print-consts</code> to <code>main</code>:</p>
<blockquote>
<p>When trying to read generated CLIF, it's nice to be able to see at a glance that some of the operands are defined by <code>iconst</code> instructions, without having to go find each operand's definition manually.</p>
<p>@afonso360 suggested this in #4721 (and @bjorn3 seconded the idea) but I think it's a good idea independent of that issue.</p>
<p>I'm not sure if this is the right implementation, though: I don't understand the intent of the <code>FuncWriter</code> trait well enough to know if adding this to the shared <code>write_operands</code> function is the best place. Perhaps only some implementations of <code>FuncWriter</code> should do this?</p>
<p>Because of that uncertainty, I haven't fixed up any of the tests which fail due to not expecting these extra comments. So I expect that CI should currently be failing.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="293796366"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293796366" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293796366">(Aug 16 2022 at 20:38)</a>:</h4>
<p><strong>jameysharp</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a>.</p>



<a name="293800378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293800378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293800378">(Aug 16 2022 at 21:04)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#pullrequestreview-1074775760">PR review</a>.</p>



<a name="293803515"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293803515" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293803515">(Aug 16 2022 at 21:26)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#pullrequestreview-1074795735">PR review</a>.</p>



<a name="293803516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293803516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293803516">(Aug 16 2022 at 21:26)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#pullrequestreview-1074795735">PR review</a>.</p>



<a name="293803517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293803517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293803517">(Aug 16 2022 at 21:26)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#discussion_r947263574">PR review comment</a>:</p>
<blockquote>
<p>What do you think about expanding this to <code>UnaryIeee{32, 64}</code> and <code>UnaryBool</code>?  </p>
</blockquote>



<a name="293803583"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293803583" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293803583">(Aug 16 2022 at 21:26)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#discussion_r947263574">PR review comment</a>.</p>



<a name="293803695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293803695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293803695">(Aug 16 2022 at 21:27)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#discussion_r947263574">PR review comment</a>.</p>



<a name="293815034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293815034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293815034">(Aug 16 2022 at 23:07)</a>:</h4>
<p>jameysharp updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a> from <code>print-consts</code> to <code>main</code>.</p>



<a name="293815164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293815164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293815164">(Aug 16 2022 at 23:09)</a>:</h4>
<p>jameysharp updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a> from <code>print-consts</code> to <code>main</code>.</p>



<a name="293815532"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293815532" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293815532">(Aug 16 2022 at 23:12)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#pullrequestreview-1074868564">PR review</a>.</p>



<a name="293815533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293815533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293815533">(Aug 16 2022 at 23:12)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#discussion_r947319542">PR review comment</a>:</p>
<blockquote>
<p>Okay, done! That still leaves <code>vconst</code> but that's more complicated since those constants aren't inline in the instruction. I don't feel like figuring out how that works right now since it was enough of a pain fixing the tests for these changes already. I'd be happy to review a PR on top of this one if somebody feels like taking that on though.</p>
</blockquote>



<a name="293815548"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293815548" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293815548">(Aug 16 2022 at 23:12)</a>:</h4>
<p><strong>jameysharp</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a> as ready for review.</p>



<a name="293815811"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293815811" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293815811">(Aug 16 2022 at 23:15)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#pullrequestreview-1074870214">PR review</a>.</p>



<a name="293817353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293817353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293817353">(Aug 16 2022 at 23:34)</a>:</h4>
<p>jameysharp updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a> from <code>print-consts</code> to <code>main</code>.</p>



<a name="293817521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293817521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293817521">(Aug 16 2022 at 23:36)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#discussion_r947329444">PR review comment</a>:</p>
<blockquote>
<p>I changed my mind: it's good enough to just print which element of the constant pool is in a vector-typed value, and that was easy to do. I think that might actually be more useful than printing giant vector literals. So now there's output for <code>vconst</code> as well.</p>
</blockquote>



<a name="293817522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293817522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293817522">(Aug 16 2022 at 23:36)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4725#pullrequestreview-1074881407">PR review</a>.</p>



<a name="293926084"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234725%20Print%20constants%20in%20a%20comment%20in%20CLIF%20.../near/293926084" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234725.20Print.20constants.20in.20a.20comment.20in.20CLIF.20.2E.2E.2E.html#293926084">(Aug 17 2022 at 16:00)</a>:</h4>
<p>jameysharp merged <a href="https://github.com/bytecodealliance/wasmtime/pull/4725">PR #4725</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>