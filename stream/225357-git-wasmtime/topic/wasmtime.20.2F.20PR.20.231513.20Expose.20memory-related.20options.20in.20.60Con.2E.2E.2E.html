<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1513 Expose memory-related options in `Con... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html">wasmtime / PR #1513 Expose memory-related options in `Con...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="194041689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194041689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194041689">(Apr 15 2020 at 14:47)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194061675"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194061675" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194061675">(Apr 15 2020 at 17:04)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-393957760" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-393957760">PR Review</a>.</p>



<a name="194061676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194061676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194061676">(Apr 15 2020 at 17:04)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-393957760" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-393957760">PR Review</a>.</p>



<a name="194061677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194061677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194061677">(Apr 15 2020 at 17:04)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r408989718" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r408989718">PR Review Comment</a>:</p>
<blockquote>
<p>"emit" -&gt; "omit"?</p>
</blockquote>



<a name="194204733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194204733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194204733">(Apr 15 2020 at 18:03)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194206592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194206592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194206592">(Apr 15 2020 at 18:19)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194507683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194507683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194507683">(Apr 17 2020 at 22:24)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194732593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194732593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194732593">(Apr 20 2020 at 20:59)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194844514"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194844514" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194844514">(Apr 21 2020 at 18:37)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194844541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194844541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194844541">(Apr 21 2020 at 18:37)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/sunfishcode" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a>.</p>



<a name="194870647"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870647" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870647">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-397711553" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-397711553">PR Review</a>.</p>



<a name="194870648"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870648" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870648">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-397711553" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-397711553">PR Review</a>.</p>



<a name="194870649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870649">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412525807" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412525807">PR Review Comment</a>:</p>
<blockquote>
<p>typo: a -&gt; at</p>
</blockquote>



<a name="194870650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870650">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412529627" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412529627">PR Review Comment</a>:</p>
<blockquote>
<p>Code-quote <code>LinearMemory</code>.</p>
</blockquote>



<a name="194870651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870651">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412532109" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412532109">PR Review Comment</a>:</p>
<blockquote>
<p>Because wasm sometimes measures sizes in pages, we should clarify that this is a size in bytes.</p>
</blockquote>



<a name="194870652"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870652" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870652">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412529109" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412529109">PR Review Comment</a>:</p>
<blockquote>
<p>This first-to-last property is interesting, as optimizers could be tempted to optimize memory accesses in ways that could change the access order -- for example optimizing <code>load.i32(x) &amp; 0xff000000</code> into a one-byte load from the last byte. Could you add some text to <a href="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/docs/ir.md#memory-operation-flags" title="https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/docs/ir.md#memory-operation-flags">https://github.com/bytecodealliance/wasmtime/blob/master/cranelift/docs/ir.md#memory-operation-flags</a> that says that when an access is not <code>notrap</code>, the bytes are defined to be accessed first-to-last, so that we at least document it?</p>
</blockquote>



<a name="194870654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870654">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412530132" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412530132">PR Review Comment</a>:</p>
<blockquote>
<p>One subtlety that would be good to clarify here is that this is talking about reserving address space, not necessarily actual memory.</p>
</blockquote>



<a name="194870655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870655">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412538728" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412538728">PR Review Comment</a>:</p>
<blockquote>
<p>This could produce a value which is <em>lower</em> than the given <code>val</code>, but I guess that's ok here because it'd be an unusably large value in either case.</p>
</blockquote>



<a name="194870656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870656">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412538997" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412538997">PR Review Comment</a>:</p>
<blockquote>
<p>"size in bytes", and so on below.</p>
</blockquote>



<a name="194870657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194870657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194870657">(Apr 21 2020 at 22:38)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412535578" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r412535578">PR Review Comment</a>:</p>
<blockquote>
<p>The page size will always be a power of 2, so we can do <code>val &amp; -page_size</code>.</p>
</blockquote>



<a name="194946064"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194946064" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194946064">(Apr 22 2020 at 15:12)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="194947426"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194947426" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194947426">(Apr 22 2020 at 15:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-398304724" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-398304724">PR Review</a>.</p>



<a name="194947427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194947427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194947427">(Apr 22 2020 at 15:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413078573" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413078573">PR Review Comment</a>:</p>
<blockquote>
<p>So thinking more about this, I think I just carried this comment over from somewhere that I didn't fully understand. I think this property isn't actually necessary (and may not be necessary to document).</p>
<p>The main assumption I think we can make is that all our accesses are smaller than the size of a page (e.g. the minimum size of the guard region). In that case the first byte is either:</p>
<ul>
<li>in wasm memory which is normal-bounds-checked and all remaining bytes are either in wasm memory or the guard-page</li>
<li>in the guard page, in which case the bounds check will fail.</li>
</ul>
<p>Does that sound right to you as well? If so I'll reword this to and probably throw in an assert that the <code>width</code> is less than 1k or something like that with a doc comment explaining.</p>
</blockquote>



<a name="194947458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194947458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194947458">(Apr 22 2020 at 15:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-398305026" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-398305026">PR Review</a>.</p>



<a name="194947459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194947459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194947459">(Apr 22 2020 at 15:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413078824" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413078824">PR Review Comment</a>:</p>
<blockquote>
<p>Ah true yeah, but I was mostly just striving to do something reasonable-ish here.</p>
</blockquote>



<a name="194947594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/194947594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#194947594">(Apr 22 2020 at 15:24)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="195010527"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195010527" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195010527">(Apr 23 2020 at 01:27)</a>:</h4>
<p>eust-dfinity submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-398698423" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-398698423">PR Review</a>.</p>



<a name="195010528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195010528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195010528">(Apr 23 2020 at 01:27)</a>:</h4>
<p>eust-dfinity created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413442490" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413442490">PR Review Comment</a>:</p>
<blockquote>
<p>Actually that example is allocating one guard page</p>
</blockquote>



<a name="195078473"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195078473" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195078473">(Apr 23 2020 at 15:31)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="195078490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195078490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195078490">(Apr 23 2020 at 15:31)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-399219905" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-399219905">PR Review</a>.</p>



<a name="195078491"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195078491" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195078491">(Apr 23 2020 at 15:31)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413899224" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413899224">PR Review Comment</a>:</p>
<blockquote>
<p>I went ahead and tried to update the comment with my thinking here.</p>
</blockquote>



<a name="195078578"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195078578" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195078578">(Apr 23 2020 at 15:32)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-399220402" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-399220402">PR Review</a>.</p>



<a name="195078579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195078579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195078579">(Apr 23 2020 at 15:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413899607" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r413899607">PR Review Comment</a>:</p>
<blockquote>
<p>True yeah, I was mostly just getting this test to pass. Since the JIT is configured that there might not be a guard page then the guard page allocation here shouldn't be necessary.</p>
</blockquote>



<a name="195759380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195759380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195759380">(Apr 29 2020 at 19:33)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a> from <code>configurable-memory-bounds</code> to <code>master</code>:</p>
<blockquote>
<p>This commit was initially motivated by looking more into #1501, but it<br>
ended up balooning a bit after finding a few issues. The high-level<br>
items in this commit are:</p>
<ul>
<li>
<p>New configuration options via <code>wasmtime::Config</code> are exposed to<br>
  configure the tunable limits of how memories are allocated and such.</p>
</li>
<li>
<p>The <code>MemoryCreator</code> trait has been updated to accurately reflect the<br>
  required allocation characteristics that JIT code expects.</p>
</li>
<li>
<p>A bug has been fixed in the cranelift wasm code generation where if no<br>
  guard page was present bounds checks weren't accurately performed.</p>
</li>
</ul>
<p>The new <code>Config</code> methods allow tuning the memory allocation<br>
characteristics of wasmtime. Currently 64-bit platforms will reserve 6GB<br>
chunks of memory for each linear memory, but by tweaking various config<br>
options you can change how this is allocate, perhaps at the cost of<br>
slower JIT code since it needs more bounds checks. The methods are<br>
intended to be pretty thoroughly documented as to the effect they have<br>
on the JIT code and what values you may wish to select. These new<br>
methods have been added to the spectest fuzzer to ensure that various<br>
configuration values for these methods don't affect correctness.</p>
<p>The <code>MemoryCreator</code> trait previously only allocated memories with a<br>
<code>MemoryType</code>, but this didn't actually reflect the guarantees that JIT<br>
code expected. JIT code is generated with an assumption about the<br>
minimum size of the guard region, as well as whether memory is static or<br>
dynamic (whether the base pointer can be relocated). These properties<br>
must be upheld by custom allocation engines for JIT code to perform<br>
correctly, so extra parameters have been added to<br>
<code>MemoryCreator::new_memory</code> to reflect this.</p>
<p>Finally the fuzzing with <code>Config</code> turned up an issue where if no guard<br>
pages present the wasm code wouldn't correctly bounds-check memory<br>
accesses. The issue here was that with a guard page we only need to<br>
bounds-check the first byte of access, but without a guard page we need<br>
to bounds-check the last byte of access. This meant that the code<br>
generation needed to account for the size of the memory operation<br>
(load/store) and use this as the offset-to-check in the no-guard-page<br>
scenario. I've attempted to make the various comments in cranelift a bit<br>
more exhaustive too to hopefully make it a bit clearer for future<br>
readers!</p>
<p>Closes #1501</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="195785963"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/195785963" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#195785963">(Apr 30 2020 at 00:10)</a>:</h4>
<p>sunfishcode merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1513" title="https://github.com/bytecodealliance/wasmtime/pull/1513">PR #1513</a>.</p>



<a name="196353168"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/196353168" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#196353168">(May 05 2020 at 19:16)</a>:</h4>
<p>plicease submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-406082507" title="https://github.com/bytecodealliance/wasmtime/pull/1513#pullrequestreview-406082507">PR Review</a>.</p>



<a name="196353169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231513%20Expose%20memory-related%20options%20in%20%60Con.../near/196353169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231513.20Expose.20memory-related.20options.20in.20.60Con.2E.2E.2E.html#196353169">(May 05 2020 at 19:16)</a>:</h4>
<p>plicease created <a href="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r420346865" title="https://github.com/bytecodealliance/wasmtime/pull/1513#discussion_r420346865">PR Review Comment</a>:</p>
<blockquote>
<p>After testing this from Perl, I think the <code>_set</code> suffix was accidentally omitted from this declaration.  Same for <code>wasmtime_config_dynamic_memory_guard_size</code> below.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>