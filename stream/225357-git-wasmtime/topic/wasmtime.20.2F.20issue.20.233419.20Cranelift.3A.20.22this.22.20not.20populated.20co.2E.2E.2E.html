<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3419 Cranelift: &quot;this&quot; not populated co... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html">wasmtime / issue #3419 Cranelift: &quot;this&quot; not populated co...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="256253781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/256253781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#256253781">(Oct 05 2021 at 14:21)</a>:</h4>
<p>adv-sw labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that.</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>Unsure where that's coming from - doesn't seem to be cranelift.</p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
</blockquote>



<a name="256253782"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/256253782" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#256253782">(Oct 05 2021 at 14:21)</a>:</h4>
<p>adv-sw opened <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that.</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>Unsure where that's coming from - doesn't seem to be cranelift.</p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
</blockquote>



<a name="256253783"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/256253783" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#256253783">(Oct 05 2021 at 14:21)</a>:</h4>
<p>adv-sw labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that.</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>Unsure where that's coming from - doesn't seem to be cranelift.</p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
</blockquote>



<a name="256254733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/256254733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#256254733">(Oct 05 2021 at 14:26)</a>:</h4>
<p>adv-sw edited <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that - same command line, just s/lldbg/lldb</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>Unsure where that's coming from - doesn't seem to be cranelift.</p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
</blockquote>



<a name="256255460"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/256255460" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#256255460">(Oct 05 2021 at 14:30)</a>:</h4>
<p>adv-sw edited <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that - same command line, just s/lldbg/lldb</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>Unsure where that's coming from - doesn't seem to be cranelift.</p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
<p>Severe C++ web assembly development productivity issue because webdevs need to be able to effectively debug their code.</p>
</blockquote>



<a name="257035049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/257035049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#257035049">(Oct 11 2021 at 09:12)</a>:</h4>
<p>adv-sw <a href="https://github.com/bytecodealliance/wasmtime/issues/3419#issuecomment-939840182">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Resolved here. </p>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/92a10d1ace70fe75c3e2c646ea613168fc417851">https://github.com/bytecodealliance/wasmtime/commit/92a10d1ace70fe75c3e2c646ea613168fc417851</a></p>
<p>Please review/merge.</p>
</blockquote>



<a name="257038197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/257038197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#257038197">(Oct 11 2021 at 09:41)</a>:</h4>
<p>adv-sw edited <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that - same command line, just s/lldbg/lldb</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>LLDB is complaining "this" is not a standard pointer. LLDB refuses to evaluate non-standard this &amp; self pointers.</p>
<p>Hence we need a workaround to resolve from sandbox pointer, which is provided here :</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/92a10d1ace70fe75c3e2c646ea613168fc417851">https://github.com/bytecodealliance/wasmtime/commit/92a10d1ace70fe75c3e2c646ea613168fc417851</a></p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
<p>Severe C++ web assembly development productivity issue because webdevs need to be able to effectively debug their code.</p>
</blockquote>



<a name="257084096"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/257084096" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#257084096">(Oct 11 2021 at 15:59)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/3419#issuecomment-940154092">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>@adv-sw thanks for looking into this! Would you mind creating a PR for the review and merging of your commit? (The usual flow is that one will create this PR with the text "Fixes #ISSUE-NUMBER" in the commit message, which links it back to this issue and closes it when merged.)</p>
</blockquote>



<a name="260442703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/260442703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#260442703">(Nov 05 2021 at 18:05)</a>:</h4>
<p>bacongobbler <a href="https://github.com/bytecodealliance/wasmtime/issues/3419#issuecomment-962106738">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>looks like <a href="https://github.com/bytecodealliance/wasmtime/pull/3443">https://github.com/bytecodealliance/wasmtime/pull/3443</a> has been merged, so this can be closed.</p>
</blockquote>



<a name="260445063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/260445063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#260445063">(Nov 05 2021 at 18:23)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/3419#issuecomment-962118350">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Yes indeed, thank you for pointing this out!</p>
</blockquote>



<a name="260445064"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233419%20Cranelift%3A%20%22this%22%20not%20populated%20co.../near/260445064" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233419.20Cranelift.3A.20.22this.22.20not.20populated.20co.2E.2E.2E.html#260445064">(Nov 05 2021 at 18:23)</a>:</h4>
<p>cfallin closed <a href="https://github.com/bytecodealliance/wasmtime/issues/3419">issue #3419</a>:</p>
<blockquote>
<p>Unzip test case.</p>
<p>On Linux :</p>
<p>Run <a href="http://make_wasm.sh">make_wasm.sh</a> to build</p>
<p>Optional lldbg debugging front end - tested linux &amp; windows : <a href="https://github.com/adv-sw/lldbg">https://github.com/adv-sw/lldbg</a><br>
Modify <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under lldb direct instead of new lldbg front end if you want to skip that - same command line, just s/lldbg/lldb</p>
<p>Run <a href="http://dbg_wasm.sh">dbg_wasm.sh</a> to run under debugger.</p>
<p>Place breakpoint in test.cpp in Thing constructor on assignment m_i = i;</p>
<p>Start program, hit breakpoint.</p>
<p>Inspect "this"</p>
<h3>Expected Results</h3>
<p>Should contain single integer member m_i</p>
<h3>Actual Results</h3>
<p>"this" is empty - not populated correctly.</p>
<p>Console : warning: `this' is not accessible (substituting 0)</p>
<p>LLDB is complaining "this" is not a standard pointer. LLDB refuses to evaluate non-standard this &amp; self pointers.</p>
<p>Hence we need a workaround to resolve from sandbox pointer, which is provided here :</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/92a10d1ace70fe75c3e2c646ea613168fc417851">https://github.com/bytecodealliance/wasmtime/commit/92a10d1ace70fe75c3e2c646ea613168fc417851</a></p>
<h3>Versions and Environment</h3>
<p>Cranelift &amp; wasmtime trunk as of 3/10/21<br>
lldb trunk as of late Sept 21.<br>
lldbg trunk</p>
<p>Operating system:  Windows 11 &amp; Ubuntu tested.</p>
<p>Architecture: x64<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7286614/test.zip">test.zip</a></p>
<p>Severe C++ web assembly development productivity issue because webdevs need to be able to effectively debug their code.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>