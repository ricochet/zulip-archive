<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1996 Support reference types in the C API · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html">wasmtime / PR #1996 Support reference types in the C API</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="203328252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203328252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203328252">(Jul 08 2020 at 21:50)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203328253"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203328253" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203328253">(Jul 08 2020 at 21:50)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a>.</p>



<a name="203328793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203328793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203328793">(Jul 08 2020 at 21:56)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203330972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203330972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203330972">(Jul 08 2020 at 22:21)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-445166829">PR Review</a>.</p>



<a name="203330973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203330973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203330973">(Jul 08 2020 at 22:21)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-445166829">PR Review</a>.</p>



<a name="203330974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203330974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203330974">(Jul 08 2020 at 22:21)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r451855989">PR Review Comment</a>:</p>
<blockquote>
<p>Could you add a fixme to use the <code>write</code> method of <code>MaybeUninit</code> once it is stabilized?</p>
</blockquote>



<a name="203330975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203330975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203330975">(Jul 08 2020 at 22:21)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r451856092">PR Review Comment</a>:</p>
<blockquote>
<p>Same here</p>
</blockquote>



<a name="203331470"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203331470" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203331470">(Jul 08 2020 at 22:27)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203390689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390689">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-445646080">PR Review</a>.</p>



<a name="203390690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390690">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-445646080">PR Review</a>.</p>



<a name="203390691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390691">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452240527">PR Review Comment</a>:</p>
<blockquote>
<p>For this I believe the C API avoids returning structs-by-value where possible, so could the <code>wasm_val_t</code> be an out-pointer?</p>
</blockquote>



<a name="203390693"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390693" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390693">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452242341">PR Review Comment</a>:</p>
<blockquote>
<p>I think that writing to <code>&amp;mut MaybeUninit&lt;T&gt;</code> is actually a safe operation, so could the unsafety be encapsulated in a helper method for now while we wait for <code>MaybeUninit::write</code>? That should help reduce the creep of <code>unsafe</code> into some of these functions.</p>
</blockquote>



<a name="203390695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390695">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452241060">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW the other APIs with finalizers don't assign a type name to the finalizer, they'd just do <code>void(*finalizer)(void*)</code> inline (although naturally this is much more readable)</p>
</blockquote>



<a name="203390696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390696">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452243151">PR Review Comment</a>:</p>
<blockquote>
<p>Technically I think this should be <code>extern fn(*mut c_void)</code></p>
</blockquote>



<a name="203390697"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390697" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390697">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452243560">PR Review Comment</a>:</p>
<blockquote>
<p>This I think could be <code>&amp;mut *mut c_void</code> to improve safety a bit (and document at the type level that it cant be null</p>
</blockquote>



<a name="203390698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390698">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452244766">PR Review Comment</a>:</p>
<blockquote>
<p>Could this delegate to <code>new_with_finalizer</code> below?</p>
</blockquote>



<a name="203390699"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390699" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390699">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452246095">PR Review Comment</a>:</p>
<blockquote>
<p>It seems like there's two levels of <code>Option</code> in this representation, both here and in handling of <code>Option&lt;Box&lt;wasm_ref_t&gt;&gt;</code>. Is there a way that we could perhaps unify that so there's only one level at which null is introduced?</p>
</blockquote>



<a name="203390700"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390700" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390700">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452247318">PR Review Comment</a>:</p>
<blockquote>
<p>Is this method still used in the API somewhere? This seems like it's probably unsafe to do since it runs the dtor on the previous contents and I don't think that there's anywhere else we should do that in the API</p>
</blockquote>



<a name="203390701"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203390701" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203390701">(Jul 09 2020 at 14:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452244578">PR Review Comment</a>:</p>
<blockquote>
<p>I think this is a bit surprising to do here because this means that you can get back pointers to externref values that you didn't create. I would expect null to be returned here, although I can't imagine this'll be too common of a case to hit since they're no way in the API to create an externref other than the functions above.</p>
</blockquote>



<a name="203439622"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203439622" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203439622">(Jul 09 2020 at 20:57)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-445963736">PR Review</a>.</p>



<a name="203439623"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203439623" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203439623">(Jul 09 2020 at 20:57)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r452485812">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW I think it might be best from an API perspective to not take ownership here, since it's not really needed anyway</p>
</blockquote>



<a name="203542840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203542840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203542840">(Jul 10 2020 at 18:38)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-446623316">PR Review</a>.</p>



<a name="203542841"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203542841" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203542841">(Jul 10 2020 at 18:38)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r453009761">PR Review Comment</a>:</p>
<blockquote>
<p>I was also split on what the best thing to do here was.</p>
<p>I was imagining that someone might have both Rust code and C code that try to communicate via <code>externref</code>s, and have some out of band protocol for communicating the types of values they are sending each other.</p>
<p>I can remove it, and return <code>null</code> in this case, if you think that is the better course of action.</p>
</blockquote>



<a name="203544679"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203544679" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203544679">(Jul 10 2020 at 18:53)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-446632357">PR Review</a>.</p>



<a name="203544680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203544680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203544680">(Jul 10 2020 at 18:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r453021288">PR Review Comment</a>:</p>
<blockquote>
<p>I suppose if there's multiple actors in play you can't really assume anything about the externref pointers you get back anyway. Given two C embeddings there's no guarantee their pointers align, so seems fine to just return what we can here for now. Always possible to tweak later!</p>
</blockquote>



<a name="203546087"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203546087" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203546087">(Jul 10 2020 at 19:05)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203546238"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203546238" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203546238">(Jul 10 2020 at 19:06)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a>.</p>



<a name="203552554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203552554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203552554">(Jul 10 2020 at 20:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-446671666">PR Review</a>.</p>



<a name="203552555"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203552555" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203552555">(Jul 10 2020 at 20:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#pullrequestreview-446671666">PR Review</a>.</p>



<a name="203552556"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203552556" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203552556">(Jul 10 2020 at 20:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r453054301">PR Review Comment</a>:</p>
<blockquote>
<p>I think this syntax isn't implemented for MSVC? (according to CI)</p>
</blockquote>



<a name="203552557"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203552557" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203552557">(Jul 10 2020 at 20:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1996#discussion_r453054111">PR Review Comment</a>:</p>
<blockquote>
<p>Perhaps change this to <code>*mut</code>?</p>
</blockquote>



<a name="203552602"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203552602" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203552602">(Jul 10 2020 at 20:07)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203552837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203552837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203552837">(Jul 10 2020 at 20:09)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203556845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203556845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203556845">(Jul 10 2020 at 20:55)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203558373"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203558373" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203558373">(Jul 10 2020 at 21:12)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203733529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203733529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203733529">(Jul 13 2020 at 15:58)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203735512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203735512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203735512">(Jul 13 2020 at 16:14)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203737787"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203737787" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203737787">(Jul 13 2020 at 16:35)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a> from <code>ref-types-in-c-api</code> to <code>main</code>:</p>
<blockquote>
<p>See each commit message for details. The first commit in particular has a bit of rippling out due to <code>wasm_val_t</code> not being POD anymore.</p>
</blockquote>



<a name="203747762"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231996%20Support%20reference%20types%20in%20the%20C%20API/near/203747762" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231996.20Support.20reference.20types.20in.20the.20C.20API.html#203747762">(Jul 13 2020 at 17:58)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1996">PR #1996</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>