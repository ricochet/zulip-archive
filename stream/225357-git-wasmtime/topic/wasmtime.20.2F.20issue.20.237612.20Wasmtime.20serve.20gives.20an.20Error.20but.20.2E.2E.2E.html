<html>
<head><meta charset="utf-8"><title>wasmtime / issue #7612 Wasmtime serve gives an Error but ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html">wasmtime / issue #7612 Wasmtime serve gives an Error but ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="404976359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/404976359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#404976359">(Nov 30 2023 at 00:34)</a>:</h4>
<p><a href="https://github.com/Mossaka">Mossaka</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">Issue #7612</a>.</p>



<a name="404976360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/404976360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#404976360">(Nov 30 2023 at 00:34)</a>:</h4>
<p>Mossaka opened <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>I am using wasmtime 15 the <code>serve</code> command for a Go WASI HTTP component. The component WIT looks like</p>
<div class="codehilite" data-code-language="wit"><pre><span></span><code>package root:component

world root {
  import wasi:clocks/wall-clock@0.2.0-rc-2023-11-10
  import wasi:clocks/monotonic-clock@0.2.0-rc-2023-11-10
  import wasi:io/error@0.2.0-rc-2023-11-10
  import wasi:io/streams@0.2.0-rc-2023-11-10
  import wasi:cli/stdout@0.2.0-rc-2023-11-10
  import wasi:cli/stderr@0.2.0-rc-2023-11-10
  import wasi:cli/stdin@0.2.0-rc-2023-11-10
  import wasi:http/types@0.2.0-rc-2023-11-10
  import wasi:filesystem/types@0.2.0-rc-2023-11-10
  import wasi:filesystem/preopens@0.2.0-rc-2023-11-10
  import wasi:sockets/tcp@0.2.0-rc-2023-11-10
  import wasi:cli/environment@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-input@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-output@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-stdin@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-stdout@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-stderr@0.2.0-rc-2023-11-10

  export wasi:http/incoming-handler@0.2.0-rc-2023-11-10
}
</code></pre></div>
<p>As you can tell, it is using the same version of the WASI HTTP as the wasmtime <code>v15</code>'s using. Now when I serve the HTTP request and <code>curl</code> the 8080 endpoint, I got the following error message:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">2023</span>-11-30T00:31:14.242114Z<span class="w"> </span>ERROR<span class="w"> </span>wasmtime_cli::commands::serve:<span class="w"> </span><span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w"> </span>::<span class="w"> </span>Error<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>context:<span class="w"> </span><span class="s2">"error while executing at wasm backtrace:\n    0: 0x55d34 - wit-component:shim!indirect-wasi:http/types@0.2.0-rc-2023-11-10-[static]outgoing-body.finish\n    1: 0xb11b - &lt;unknown&gt;!wasi_http_0_2_0_rc_2023_11_10_types_static_outgoing_body_finish\n    2: 0x8e1a - &lt;unknown&gt;!exports_wasi_http_0_2_0_rc_2023_11_10_incoming_handler_handle\n    3: 0xb5be - &lt;unknown&gt;!__wasm_export_exports_wasi_http_0_2_0_rc_2023_11_10_incoming_handler_handle\nnote: using the `WASMTIME_BACKTRACE_DETAILS=1` environment variable may show more debugging information"</span>,
<span class="w">    </span>source:<span class="w"> </span>HasChildren,
<span class="o">}</span>
</code></pre></div>
<p>But my curl returns status code 200 and expected response body:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="w"> </span>curl<span class="w"> </span>http://localhost:8080<span class="w"> </span>-vvv
*<span class="w">   </span>Trying<span class="w"> </span><span class="m">127</span>.0.0.1:8080...
*<span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span>localhost<span class="w"> </span><span class="o">(</span><span class="m">127</span>.0.0.1<span class="o">)</span><span class="w"> </span>port<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="o">(</span><span class="c1">#0)</span>
&gt;<span class="w"> </span>GET<span class="w"> </span>/<span class="w"> </span>HTTP/1.1
&gt;<span class="w"> </span>Host:<span class="w"> </span>localhost:8080
&gt;<span class="w"> </span>User-Agent:<span class="w"> </span>curl/8.1.2
&gt;<span class="w"> </span>Accept:<span class="w"> </span>*/*
&gt;
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
&lt;<span class="w"> </span>transfer-encoding:<span class="w"> </span>chunked
&lt;<span class="w"> </span>date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">30</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">00</span>:31:13<span class="w"> </span>GMT
&lt;
Hello<span class="w"> </span>world<span class="w"> </span>from<span class="w"> </span>Go!!!
</code></pre></div>
<h2>Expectation</h2>
<p>If the response is 200 and the body is expected, then wasmtime shouldn't output Error. <br>
</p>
</blockquote>



<a name="404983148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/404983148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#404983148">(Nov 30 2023 at 01:25)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/7612#issuecomment-1832957360">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>We'll need to dig in a little deeper to debug here - can you add <code>WASMTIME_LOG=wasmtime_wasi_http=trace</code> and examine what is going on a bit more?</p>
</blockquote>



<a name="404985854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/404985854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#404985854">(Nov 30 2023 at 01:48)</a>:</h4>
<p>Mossaka <a href="https://github.com/bytecodealliance/wasmtime/issues/7612#issuecomment-1832975921">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>This is what <code>WASMTIME_LOG=trace</code> shows</p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">2023</span>-11-30T01:47:47.658704Z<span class="w">  </span>INFO<span class="w"> </span>wasmtime_cli::commands::serve:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:8080
<span class="m">2023</span>-11-30T01:47:49.748585Z<span class="w"> </span>TRACE<span class="w"> </span>hyper::proto::h1::conn:<span class="w"> </span>Conn::read_head
<span class="m">2023</span>-11-30T01:47:49.748617Z<span class="w"> </span>TRACE<span class="w"> </span>hyper::proto::h1::io:<span class="w"> </span>received<span class="w"> </span><span class="m">77</span><span class="w"> </span>bytes
<span class="m">2023</span>-11-30T01:47:49.748635Z<span class="w"> </span>TRACE<span class="w"> </span>parse_headers:<span class="w"> </span>hyper::proto::h1::role:<span class="w"> </span>Request.parse<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">77</span>
<span class="m">2023</span>-11-30T01:47:49.748644Z<span class="w"> </span>TRACE<span class="w"> </span>parse_headers:<span class="w"> </span>hyper::proto::h1::role:<span class="w"> </span>Request.parse<span class="w"> </span>Complete<span class="o">(</span><span class="m">77</span><span class="o">)</span>
<span class="m">2023</span>-11-30T01:47:49.748659Z<span class="w"> </span>DEBUG<span class="w"> </span>hyper::proto::h1::io:<span class="w"> </span>parsed<span class="w"> </span><span class="m">3</span><span class="w"> </span>headers
<span class="m">2023</span>-11-30T01:47:49.748661Z<span class="w"> </span>DEBUG<span class="w"> </span>hyper::proto::h1::conn:<span class="w"> </span>incoming<span class="w"> </span>body<span class="w"> </span>is<span class="w"> </span>empty
<span class="m">2023</span>-11-30T01:47:49.748675Z<span class="w"> </span>TRACE<span class="w"> </span>hyper::proto::h1::conn:<span class="w"> </span>flushed<span class="o">({</span><span class="nv">role</span><span class="o">=</span>server<span class="o">})</span>:<span class="w"> </span>State<span class="w"> </span><span class="o">{</span><span class="w"> </span>reading:<span class="w"> </span>KeepAlive,<span class="w"> </span>writing:<span class="w"> </span>Init,<span class="w"> </span>keep_alive:<span class="w"> </span>Busy<span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.748686Z<span class="w">  </span>INFO<span class="w"> </span>wasmtime_cli::commands::serve:<span class="w"> </span>Request<span class="w"> </span><span class="m">0</span><span class="w"> </span>handling<span class="w"> </span>GET<span class="w"> </span>to<span class="w"> </span>http://127.0.0.1:8080/
<span class="m">2023</span>-11-30T01:47:49.748926Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]fields"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call
<span class="m">2023</span>-11-30T01:47:49.748936Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]fields"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">5</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">})</span>
<span class="m">2023</span>-11-30T01:47:49.748952Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]outgoing-response"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">headers</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">5</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.748962Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]outgoing-response"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">})</span>
<span class="m">2023</span>-11-30T01:47:49.748973Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.set-status-code"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">status_code</span><span class="o">=</span><span class="m">200</span>
<span class="m">2023</span>-11-30T01:47:49.748980Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.set-status-code"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Ok<span class="o">(()))</span>
<span class="m">2023</span>-11-30T01:47:49.748991Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.body"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.748998Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.body"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}))</span>
<span class="m">2023</span>-11-30T01:47:49.749013Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]response-outparam.set"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">param</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">response</span><span class="o">=</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">})</span>
<span class="m">2023</span>-11-30T01:47:49.749023Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]response-outparam.set"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(())</span>
<span class="m">2023</span>-11-30T01:47:49.749032Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-body.write"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.749038Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-body.write"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}))</span>
<span class="m">2023</span>-11-30T01:47:49.749084Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"streams"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]output-stream.blocking-write-and-flush"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi::preview2::bindings::wasi::io::streams:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">contents</span><span class="o">=[</span><span class="m">72</span>,<span class="w"> </span><span class="m">101</span>,<span class="w"> </span><span class="m">108</span>,<span class="w"> </span><span class="m">108</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="m">119</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">114</span>,<span class="w"> </span><span class="m">108</span>,<span class="w"> </span><span class="m">100</span>,<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="m">102</span>,<span class="w"> </span><span class="m">114</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">109</span>,<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="m">71</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">33</span>,<span class="w"> </span><span class="m">33</span>,<span class="w"> </span><span class="m">33</span>,<span class="w"> </span><span class="m">10</span><span class="o">]</span>
<span class="m">2023</span>-11-30T01:47:49.749099Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"streams"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]output-stream.blocking-write-and-flush"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi::preview2::bindings::wasi::io::streams:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(())</span>
<span class="m">2023</span>-11-30T01:47:49.749136Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]outgoing-body.finish"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">this</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">trailers</span><span class="o">=</span>None
<span class="m">2023</span>-11-30T01:47:49.749142Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]outgoing-body.finish"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Err<span class="o">(</span>entry<span class="w"> </span>still<span class="w"> </span>has<span class="w"> </span>children<span class="o">)</span>
<span class="m">2023</span>-11-30T01:47:49.749153Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="o">======</span><span class="w"> </span>Capturing<span class="w"> </span><span class="nv">Backtrace</span><span class="w"> </span><span class="o">======</span>
<span class="m">2023</span>-11-30T01:47:49.749156Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="o">===</span><span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>contiguous<span class="w"> </span>sequence<span class="w"> </span>of<span class="w"> </span>Wasm<span class="w"> </span><span class="nv">frames</span><span class="w"> </span><span class="o">===</span>
<span class="m">2023</span>-11-30T01:47:49.749160Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">trampoline_sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0000000104aefb50
<span class="m">2023</span>-11-30T01:47:49.749163Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w">    </span>initial<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x00000001048aeb6c
<span class="m">2023</span>-11-30T01:47:49.749190Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w">    </span>initial<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0000000104aef990
<span class="m">2023</span>-11-30T01:47:49.749198Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749202Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048aeb6c
<span class="m">2023</span>-11-30T01:47:49.749220Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aef990
<span class="m">2023</span>-11-30T01:47:49.749225Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749228Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048a8ecc
<span class="m">2023</span>-11-30T01:47:49.749231Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aefa00
<span class="m">2023</span>-11-30T01:47:49.749234Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749236Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048a53a8
<span class="m">2023</span>-11-30T01:47:49.749239Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aefb10
<span class="m">2023</span>-11-30T01:47:49.749258Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749263Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048a9710
<span class="m">2023</span>-11-30T01:47:49.749266Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aefb40
<span class="m">2023</span>-11-30T01:47:49.749273Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="o">===</span><span class="w"> </span>Done<span class="w"> </span>tracing<span class="w"> </span>contiguous<span class="w"> </span>sequence<span class="w"> </span>of<span class="w"> </span>Wasm<span class="w"> </span><span class="nv">frames</span><span class="w"> </span><span class="o">===</span>
<span class="m">2023</span>-11-30T01:47:49.749276Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bi
<span class="o">[</span>message<span class="w"> </span>truncated<span class="o">]</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="404985990"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/404985990" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#404985990">(Nov 30 2023 at 01:50)</a>:</h4>
<p>Mossaka edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/7612#issuecomment-1832975921">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>This is what <code>WASMTIME_LOG=trace</code> shows</p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">2023</span>-11-30T01:47:47.658704Z<span class="w">  </span>INFO<span class="w"> </span>wasmtime_cli::commands::serve:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:8080
<span class="m">2023</span>-11-30T01:47:49.748585Z<span class="w"> </span>TRACE<span class="w"> </span>hyper::proto::h1::conn:<span class="w"> </span>Conn::read_head
<span class="m">2023</span>-11-30T01:47:49.748617Z<span class="w"> </span>TRACE<span class="w"> </span>hyper::proto::h1::io:<span class="w"> </span>received<span class="w"> </span><span class="m">77</span><span class="w"> </span>bytes
<span class="m">2023</span>-11-30T01:47:49.748635Z<span class="w"> </span>TRACE<span class="w"> </span>parse_headers:<span class="w"> </span>hyper::proto::h1::role:<span class="w"> </span>Request.parse<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">77</span>
<span class="m">2023</span>-11-30T01:47:49.748644Z<span class="w"> </span>TRACE<span class="w"> </span>parse_headers:<span class="w"> </span>hyper::proto::h1::role:<span class="w"> </span>Request.parse<span class="w"> </span>Complete<span class="o">(</span><span class="m">77</span><span class="o">)</span>
<span class="m">2023</span>-11-30T01:47:49.748659Z<span class="w"> </span>DEBUG<span class="w"> </span>hyper::proto::h1::io:<span class="w"> </span>parsed<span class="w"> </span><span class="m">3</span><span class="w"> </span>headers
<span class="m">2023</span>-11-30T01:47:49.748661Z<span class="w"> </span>DEBUG<span class="w"> </span>hyper::proto::h1::conn:<span class="w"> </span>incoming<span class="w"> </span>body<span class="w"> </span>is<span class="w"> </span>empty
<span class="m">2023</span>-11-30T01:47:49.748675Z<span class="w"> </span>TRACE<span class="w"> </span>hyper::proto::h1::conn:<span class="w"> </span>flushed<span class="o">({</span><span class="nv">role</span><span class="o">=</span>server<span class="o">})</span>:<span class="w"> </span>State<span class="w"> </span><span class="o">{</span><span class="w"> </span>reading:<span class="w"> </span>KeepAlive,<span class="w"> </span>writing:<span class="w"> </span>Init,<span class="w"> </span>keep_alive:<span class="w"> </span>Busy<span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.748686Z<span class="w">  </span>INFO<span class="w"> </span>wasmtime_cli::commands::serve:<span class="w"> </span>Request<span class="w"> </span><span class="m">0</span><span class="w"> </span>handling<span class="w"> </span>GET<span class="w"> </span>to<span class="w"> </span>http://127.0.0.1:8080/
<span class="m">2023</span>-11-30T01:47:49.748926Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]fields"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call
<span class="m">2023</span>-11-30T01:47:49.748936Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]fields"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">5</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">})</span>
<span class="m">2023</span>-11-30T01:47:49.748952Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]outgoing-response"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">headers</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">5</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.748962Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[constructor]outgoing-response"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">})</span>
<span class="m">2023</span>-11-30T01:47:49.748973Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.set-status-code"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">status_code</span><span class="o">=</span><span class="m">200</span>
<span class="m">2023</span>-11-30T01:47:49.748980Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.set-status-code"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Ok<span class="o">(()))</span>
<span class="m">2023</span>-11-30T01:47:49.748991Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.body"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.748998Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-response.body"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}))</span>
<span class="m">2023</span>-11-30T01:47:49.749013Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]response-outparam.set"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">param</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">response</span><span class="o">=</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">})</span>
<span class="m">2023</span>-11-30T01:47:49.749023Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]response-outparam.set"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(())</span>
<span class="m">2023</span>-11-30T01:47:49.749032Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-body.write"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span>
<span class="m">2023</span>-11-30T01:47:49.749038Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]outgoing-body.write"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(</span>Ok<span class="o">(</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}))</span>
<span class="m">2023</span>-11-30T01:47:49.749084Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"streams"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]output-stream.blocking-write-and-flush"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi::preview2::bindings::wasi::io::streams:<span class="w"> </span>call<span class="w"> </span><span class="nv">self_</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"borrow"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">contents</span><span class="o">=[</span><span class="m">72</span>,<span class="w"> </span><span class="m">101</span>,<span class="w"> </span><span class="m">108</span>,<span class="w"> </span><span class="m">108</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="m">119</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">114</span>,<span class="w"> </span><span class="m">108</span>,<span class="w"> </span><span class="m">100</span>,<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="m">102</span>,<span class="w"> </span><span class="m">114</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">109</span>,<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="m">71</span>,<span class="w"> </span><span class="m">111</span>,<span class="w"> </span><span class="m">33</span>,<span class="w"> </span><span class="m">33</span>,<span class="w"> </span><span class="m">33</span>,<span class="w"> </span><span class="m">10</span><span class="o">]</span>
<span class="m">2023</span>-11-30T01:47:49.749099Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"streams"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[method]output-stream.blocking-write-and-flush"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi::preview2::bindings::wasi::io::streams:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Ok<span class="o">(())</span>
<span class="m">2023</span>-11-30T01:47:49.749136Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]outgoing-body.finish"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span>call<span class="w"> </span><span class="nv">this</span><span class="o">=</span>Resource<span class="w"> </span><span class="o">{</span><span class="w"> </span>rep:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>state:<span class="w"> </span><span class="s2">"own (not in table)"</span><span class="w"> </span><span class="o">}</span><span class="w"> </span><span class="nv">trailers</span><span class="o">=</span>None
<span class="m">2023</span>-11-30T01:47:49.749142Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:wit-bindgen<span class="w"> </span>import<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"types"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"[static]outgoing-body.finish"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_wasi_http::bindings::wasi::http::types:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span>Err<span class="o">(</span>entry<span class="w"> </span>still<span class="w"> </span>has<span class="w"> </span>children<span class="o">)</span>
<span class="m">2023</span>-11-30T01:47:49.749153Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="o">======</span><span class="w"> </span>Capturing<span class="w"> </span><span class="nv">Backtrace</span><span class="w"> </span><span class="o">======</span>
<span class="m">2023</span>-11-30T01:47:49.749156Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="o">===</span><span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>contiguous<span class="w"> </span>sequence<span class="w"> </span>of<span class="w"> </span>Wasm<span class="w"> </span><span class="nv">frames</span><span class="w"> </span><span class="o">===</span>
<span class="m">2023</span>-11-30T01:47:49.749160Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">trampoline_sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0000000104aefb50
<span class="m">2023</span>-11-30T01:47:49.749163Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w">    </span>initial<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x00000001048aeb6c
<span class="m">2023</span>-11-30T01:47:49.749190Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w">    </span>initial<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0000000104aef990
<span class="m">2023</span>-11-30T01:47:49.749198Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749202Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048aeb6c
<span class="m">2023</span>-11-30T01:47:49.749220Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aef990
<span class="m">2023</span>-11-30T01:47:49.749225Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749228Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048a8ecc
<span class="m">2023</span>-11-30T01:47:49.749231Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aefa00
<span class="m">2023</span>-11-30T01:47:49.749234Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749236Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048a53a8
<span class="m">2023</span>-11-30T01:47:49.749239Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aefb10
<span class="m">2023</span>-11-30T01:47:49.749258Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span>---<span class="w"> </span>Tracing<span class="w"> </span>through<span class="w"> </span>one<span class="w"> </span>Wasm<span class="w"> </span>frame<span class="w"> </span>---
<span class="m">2023</span>-11-30T01:47:49.749263Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1048a9710
<span class="m">2023</span>-11-30T01:47:49.749266Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="nv">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x104aefb40
<span class="m">2023</span>-11-30T01:47:49.749273Z<span class="w"> </span>TRACE<span class="w"> </span>wit-bindgen<span class="w"> </span>export<span class="o">{</span><span class="nv">module</span><span class="o">=</span><span class="s2">"wasi:http/incoming-handler@0.2.0-rc-2023-11-10"</span><span class="w"> </span><span class="k">function</span><span class="o">=</span><span class="s2">"handle"</span><span class="o">}</span>:<span class="w"> </span>wasmtime_runtime::traphandlers::backtrace:<span class="w"> </span><span class="o">===</span><span class="w"> </span>Done<span class="w"> </span>tracing<span class="w"> </span>contiguous<span class="w"> </span>sequence<span class="w"> </span>of<span class="w"> </span>Wasm<span class="w"> </span><span class="nv">frames</span><span class="w"> </span><span class="o">===</span>
<span class="m">2023</span>-11-30T01:47:49.749276Z<span class="w"> </span>TRACE
<span class="o">[</span>message<span class="w"> </span>truncated<span class="o">]</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="405047100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/405047100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#405047100">(Nov 30 2023 at 06:51)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/7612#issuecomment-1833204140">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>Why is doesn't return a 500 internal server error is I think because by the time it crashes the http headers and the response body have already been written. Http doesn't allow changing the status code in the middle of a response, only at the start.</p>
<p>As for the crash, I'm not really familiar with how wasi preview 2 works, but is it possible that you need to drop the output-stream before calling outgoing-body.finish?</p>
</blockquote>



<a name="405154896"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/405154896" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#405154896">(Nov 30 2023 at 16:33)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/7612#issuecomment-1834123528">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>Yes, you need to drop the output-stream derived from outgoing-body before calling outgoing-body.finish. The wit docs explain this restriction: <a href="https://github.com/WebAssembly/wasi-http/blob/main/wit/types.wit#L493-L528">https://github.com/WebAssembly/wasi-http/blob/main/wit/types.wit#L493-L528</a></p>
<p>re <code>Err(entry still has children)</code>: some resources are so-called "child resources" of others, e.g. <a href="https://github.com/WebAssembly/wasi-io/blob/main/wit/streams.wit#L85-L87">https://github.com/WebAssembly/wasi-io/blob/main/wit/streams.wit#L85-L87</a>. This introduces a rule that, before the parent resource can be dropped, all child resources must be dropped. This also comes up in a bunch of places in the http interfaces as well.</p>
<p>The child/parent wording admittedly isn't perfect, but one way to think about it is that a child resource is an "interior pointer" of the parent - it cant becomes invalid after the parent is freed. This interiority is literally true in the implementation of these resources in the host, but more importantly it is required to give a correct implementation of the interfaces. The parent-child relationship of the output-stream of an outgoing-body ensures that no further writes to the body contents are possible when <code>finish</code> sends the trailers. This is even more important for incoming-body's input-stream, where the child stream being dropped before incoming-body.finish means that the http connection can implement backpressure at all.</p>
</blockquote>



<a name="415931132"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/415931132" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#415931132">(Jan 17 2024 at 01:26)</a>:</h4>
<p>Mossaka closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>I am using wasmtime 15 the <code>serve</code> command for a Go WASI HTTP component. The component WIT looks like</p>
<div class="codehilite" data-code-language="wit"><pre><span></span><code>package root:component

world root {
  import wasi:clocks/wall-clock@0.2.0-rc-2023-11-10
  import wasi:clocks/monotonic-clock@0.2.0-rc-2023-11-10
  import wasi:io/error@0.2.0-rc-2023-11-10
  import wasi:io/streams@0.2.0-rc-2023-11-10
  import wasi:cli/stdout@0.2.0-rc-2023-11-10
  import wasi:cli/stderr@0.2.0-rc-2023-11-10
  import wasi:cli/stdin@0.2.0-rc-2023-11-10
  import wasi:http/types@0.2.0-rc-2023-11-10
  import wasi:filesystem/types@0.2.0-rc-2023-11-10
  import wasi:filesystem/preopens@0.2.0-rc-2023-11-10
  import wasi:sockets/tcp@0.2.0-rc-2023-11-10
  import wasi:cli/environment@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-input@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-output@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-stdin@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-stdout@0.2.0-rc-2023-11-10
  import wasi:cli/terminal-stderr@0.2.0-rc-2023-11-10

  export wasi:http/incoming-handler@0.2.0-rc-2023-11-10
}
</code></pre></div>
<p>As you can tell, it is using the same version of the WASI HTTP as the wasmtime <code>v15</code>'s using. Now when I serve the HTTP request and <code>curl</code> the 8080 endpoint, I got the following error message:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">2023</span>-11-30T00:31:14.242114Z<span class="w"> </span>ERROR<span class="w"> </span>wasmtime_cli::commands::serve:<span class="w"> </span><span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="w"> </span>::<span class="w"> </span>Error<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>context:<span class="w"> </span><span class="s2">"error while executing at wasm backtrace:\n    0: 0x55d34 - wit-component:shim!indirect-wasi:http/types@0.2.0-rc-2023-11-10-[static]outgoing-body.finish\n    1: 0xb11b - &lt;unknown&gt;!wasi_http_0_2_0_rc_2023_11_10_types_static_outgoing_body_finish\n    2: 0x8e1a - &lt;unknown&gt;!exports_wasi_http_0_2_0_rc_2023_11_10_incoming_handler_handle\n    3: 0xb5be - &lt;unknown&gt;!__wasm_export_exports_wasi_http_0_2_0_rc_2023_11_10_incoming_handler_handle\nnote: using the `WASMTIME_BACKTRACE_DETAILS=1` environment variable may show more debugging information"</span>,
<span class="w">    </span>source:<span class="w"> </span>HasChildren,
<span class="o">}</span>
</code></pre></div>
<p>But my curl returns status code 200 and expected response body:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="w"> </span>curl<span class="w"> </span>http://localhost:8080<span class="w"> </span>-vvv
*<span class="w">   </span>Trying<span class="w"> </span><span class="m">127</span>.0.0.1:8080...
*<span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span>localhost<span class="w"> </span><span class="o">(</span><span class="m">127</span>.0.0.1<span class="o">)</span><span class="w"> </span>port<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="o">(</span><span class="c1">#0)</span>
&gt;<span class="w"> </span>GET<span class="w"> </span>/<span class="w"> </span>HTTP/1.1
&gt;<span class="w"> </span>Host:<span class="w"> </span>localhost:8080
&gt;<span class="w"> </span>User-Agent:<span class="w"> </span>curl/8.1.2
&gt;<span class="w"> </span>Accept:<span class="w"> </span>*/*
&gt;
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
&lt;<span class="w"> </span>transfer-encoding:<span class="w"> </span>chunked
&lt;<span class="w"> </span>date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">30</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">00</span>:31:13<span class="w"> </span>GMT
&lt;
Hello<span class="w"> </span>world<span class="w"> </span>from<span class="w"> </span>Go!!!
</code></pre></div>
<h2>Expectation</h2>
<p>If the response is 200 and the body is expected, then wasmtime shouldn't output Error. <br>
</p>
</blockquote>



<a name="415931135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237612%20Wasmtime%20serve%20gives%20an%20Error%20but%20.../near/415931135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237612.20Wasmtime.20serve.20gives.20an.20Error.20but.20.2E.2E.2E.html#415931135">(Jan 17 2024 at 01:26)</a>:</h4>
<p>Mossaka <a href="https://github.com/bytecodealliance/wasmtime/issues/7612#issuecomment-1894785647">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7612">issue #7612</a>:</p>
<blockquote>
<p>Can close this issue now as it's been resolved. </p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>