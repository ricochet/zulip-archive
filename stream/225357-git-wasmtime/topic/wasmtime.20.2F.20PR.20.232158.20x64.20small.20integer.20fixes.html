<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2158 x64 small integer fixes · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html">wasmtime / PR #2158 x64 small integer fixes</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="207715352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207715352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207715352">(Aug 22 2020 at 09:05)</a>:</h4>
<p>bjorn3 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207715418"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207715418" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207715418">(Aug 22 2020 at 09:07)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207716252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207716252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207716252">(Aug 22 2020 at 09:33)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207718767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207718767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207718767">(Aug 22 2020 at 10:48)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207726828"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207726828" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207726828">(Aug 22 2020 at 14:28)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207727124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207727124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207727124">(Aug 22 2020 at 14:36)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207763172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207763172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207763172">(Aug 23 2020 at 08:50)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="207825588"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/207825588" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#207825588">(Aug 24 2020 at 09:57)</a>:</h4>
<p><strong>bnjbvr</strong> requested <a href="https://github.com/bnjbvr">bnjbvr</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a>.</p>



<a name="208747656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/208747656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#208747656">(Sep 01 2020 at 21:00)</a>:</h4>
<p>MaxGraey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#pullrequestreview-480111444">PR Review</a>.</p>



<a name="208747658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/208747658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#208747658">(Sep 01 2020 at 21:00)</a>:</h4>
<p>MaxGraey created <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#discussion_r481428140">PR Review Comment</a>:</p>
<blockquote>
<p>Is it sign extention from small ints to <code>i64</code>, right? Perhaps I'm missing something, that it should look like this I guess:</p>
<div class="codehilite"><pre><span></span><code>                I8 =&gt; (((value as i64) &lt;&lt; 56) &gt;&gt; 56) as u64,
                I16 =&gt; (((value as i64) &lt;&lt; 48) &gt;&gt; 48) as u64,
                I32 =&gt; (((value as i64) &lt;&lt; 32) &gt;&gt; 32) as u64,
</code></pre></div>


</blockquote>



<a name="208747972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/208747972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#208747972">(Sep 01 2020 at 21:01)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#pullrequestreview-480112612">PR Review</a>.</p>



<a name="208747973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/208747973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#208747973">(Sep 01 2020 at 21:01)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#discussion_r481429066">PR Review Comment</a>:</p>
<blockquote>
<p>Indeed. Good catch! Thanks!</p>
</blockquote>



<a name="208748106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/208748106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#208748106">(Sep 01 2020 at 21:02)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="209367519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209367519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209367519">(Sep 08 2020 at 10:10)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#pullrequestreview-483979766">PR Review</a>.</p>



<a name="209367520"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209367520" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209367520">(Sep 08 2020 at 10:10)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#pullrequestreview-483979766">PR Review</a>.</p>



<a name="209367521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209367521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209367521">(Sep 08 2020 at 10:10)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#discussion_r484800947">PR Review Comment</a>:</p>
<blockquote>
<p>We should reuse the <code>SignExtendRaxRdx</code> instruction, because this new instruction you added and the former have the same semantics: sign-extend the "data" (originally on x86, <code>rax</code> is the "data" (Accumulator, hence A) register up to 32 bits, and when more is required, the <code>rdx</code> contains the rest of the Data (hence D in name)). Maybe rename <code>SignExtendRaxRdx</code> to <code>SignExtendData</code>, and make the size an <code>Option</code> to indicate al-&gt;ah? (or use 0 for al-&gt;ah sign-extension?) Or we could have a <code>SignExtendOpSize</code> enum that contains all the valid sizes for this instruction?</p>
</blockquote>



<a name="209367523"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209367523" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209367523">(Sep 08 2020 at 10:10)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#discussion_r484798065">PR Review Comment</a>:</p>
<blockquote>
<p>nit: I think <code>bitwise not</code> would be more colloquial here</p>
</blockquote>



<a name="209367524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209367524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209367524">(Sep 08 2020 at 10:10)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2158#discussion_r484802543">PR Review Comment</a>:</p>
<blockquote>
<p>nit: can you please add a bit more details in the unreachable message: <code>"unhandled output type for shift/rotates: {}"</code>?</p>
</blockquote>



<a name="209370773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209370773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209370773">(Sep 08 2020 at 10:54)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="209372310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209372310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209372310">(Sep 08 2020 at 11:14)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="209373383"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209373383" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209373383">(Sep 08 2020 at 11:28)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="209373614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209373614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209373614">(Sep 08 2020 at 11:31)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a> from <code>x64_fixes</code> to <code>main</code>:</p>
<blockquote>
<p>I am not sure how to implement <code>sshr</code> and <code>ushr</code> for small integers.</p>
<p>Fixes #2121</p>
</blockquote>



<a name="209382053"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232158%20x64%20small%20integer%20fixes/near/209382053" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232158.20x64.20small.20integer.20fixes.html#209382053">(Sep 08 2020 at 13:00)</a>:</h4>
<p>bnjbvr merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2158">PR #2158</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>