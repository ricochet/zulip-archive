<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1192 Add initial support for EVEX encodings · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html">wasmtime / PR #1192 Add initial support for EVEX encodings</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189738157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189738157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189738157">(Mar 04 2020 at 21:37)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369102068" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369102068">PR Review</a>.</p>



<a name="189738158"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189738158" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189738158">(Mar 04 2020 at 21:37)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369102068" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369102068">PR Review</a>.</p>



<a name="189738159"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189738159" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189738159">(Mar 04 2020 at 21:37)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387948733" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387948733">PR Review Comment</a>:</p>
<blockquote>
<p>I am a little :crying_cat_face: that the manual (at least the latest one I see online: <a href="https://software.intel.com/en-us/download/intel-64-and-ia-32-architectures-sdm-combined-volumes-1-2a-2b-2c-2d-3a-3b-3c-3d-and-4" target="_blank" title="https://software.intel.com/en-us/download/intel-64-and-ia-32-architectures-sdm-combined-volumes-1-2a-2b-2c-2d-3a-3b-3c-3d-and-4">https://software.intel.com/en-us/download/intel-64-and-ia-32-architectures-sdm-combined-volumes-1-2a-2b-2c-2d-3a-3b-3c-3d-and-4</a> from October 2019) doesn't seem to say anything about these bits being inverted in EVEX prefixes. In fact, just reading the manual suggests the opposite: <code>Combine with ModR/M.reg, ModR/M.rm (base, index/vidx)</code>, from <code>Table 2-30.  EVEX Prefix Bit Field Functional Grouping</code>.</p>
<p>Anyway, I see the negated interpretation is <a href="https://github.com/intelxed/xed/blob/master/src/dec/xed-ild.c#L1281-L1287" target="_blank" title="https://github.com/intelxed/xed/blob/master/src/dec/xed-ild.c#L1281-L1287">backed up by XED</a> so <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="189738160"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189738160" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189738160">(Mar 04 2020 at 21:37)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387939434" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387939434">PR Review Comment</a>:</p>
<blockquote>
<p>It's a bit defensive, but do you think a <code>debug_assert!(enc.mm() &lt; 0b100)</code> makes sense here? <code>VEX.mmmmm &gt; 0b10</code> is also an error at the moment, and I suspect we'd need to look at encoding rules again if that changed too. So the most likely case I imagine for <code>enc.mm() &gt; 0b11</code> is "Cranelift error". I also see that <code>mm()</code> returns the bits masked by <code>0x3</code>anyway, so if this is in use when higher values become allocated (and we want to use them) there might need to be other places that need fixing as well.</p>
</blockquote>



<a name="189738161"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189738161" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189738161">(Mar 04 2020 at 21:37)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387918520" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387918520">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>/// used together for certain classes of instructions; i.e., special care should be taken to ensure
</pre></div>


<p>I think this is the missing word, anyway?</p>
</blockquote>



<a name="189742046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189742046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189742046">(Mar 04 2020 at 22:21)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369167438" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369167438">PR Review</a>.</p>



<a name="189742047"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189742047" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189742047">(Mar 04 2020 at 22:21)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387969909" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r387969909">PR Review Comment</a>:</p>
<blockquote>
<p>Yeah, me too... mostly because I implemented it without inversion first and then had to invert it after getting weird results. I will ask around here to see if anyone knows what team is responsible for editing the manual.</p>
</blockquote>



<a name="189827184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189827184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189827184">(Mar 05 2020 at 19:26)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1192" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192">PR #1192</a> from <code>evex</code> to <code>master</code>:</p>
<blockquote>
<p>See <a href="https://github.com/bytecodealliance/cranelift/pull/1370" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1370">https://github.com/bytecodealliance/cranelift/pull/1370</a></p>
</blockquote>



<a name="189827677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189827677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189827677">(Mar 05 2020 at 19:32)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1192" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192">PR #1192</a> from <code>evex</code> to <code>master</code>:</p>
<blockquote>
<p>See <a href="https://github.com/bytecodealliance/cranelift/pull/1370" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1370">https://github.com/bytecodealliance/cranelift/pull/1370</a></p>
</blockquote>



<a name="189837336"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837336" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837336">(Mar 05 2020 at 21:16)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1192" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192">PR #1192</a> from <code>evex</code> to <code>master</code>:</p>
<blockquote>
<p>See <a href="https://github.com/bytecodealliance/cranelift/pull/1370" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1370">https://github.com/bytecodealliance/cranelift/pull/1370</a></p>
</blockquote>



<a name="189837391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837391">(Mar 05 2020 at 21:17)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369920351" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369920351">PR Review</a>.</p>



<a name="189837392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837392">(Mar 05 2020 at 21:17)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r388570477" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r388570477">PR Review Comment</a>:</p>
<blockquote>
<p>I added it.</p>
</blockquote>



<a name="189837498"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837498" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837498">(Mar 05 2020 at 21:18)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369920974" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369920974">PR Review</a>.</p>



<a name="189837499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837499">(Mar 05 2020 at 21:18)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r388571030" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r388571030">PR Review Comment</a>:</p>
<blockquote>
<p>Added this in a fixup and rebased so that the history looks cleaner; like we discussed, I think there are some bug fixes here that we won't want to squash together so I have been carefully rebasing.</p>
</blockquote>



<a name="189837563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837563">(Mar 05 2020 at 21:19)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369921617" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369921617">PR Review</a>.</p>



<a name="189837564"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189837564" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189837564">(Mar 05 2020 at 21:19)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r388571542" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#discussion_r388571542">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, I e-mailed someone internally about this. Let's see what happens.</p>
</blockquote>



<a name="189839015"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189839015" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189839015">(Mar 05 2020 at 21:34)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369931378" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369931378">PR Review</a>.</p>



<a name="189839415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189839415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189839415">(Mar 05 2020 at 21:39)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369934128" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369934128">PR Review</a>.</p>



<a name="189839462"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189839462" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189839462">(Mar 05 2020 at 21:39)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369934128" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192#pullrequestreview-369934128">PR Review</a>.</p>



<a name="189922929"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231192%20Add%20initial%20support%20for%20EVEX%20encodings/near/189922929" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231192.20Add.20initial.20support.20for.20EVEX.20encodings.html#189922929">(Mar 06 2020 at 18:53)</a>:</h4>
<p>abrown merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1192" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1192">PR #1192</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>