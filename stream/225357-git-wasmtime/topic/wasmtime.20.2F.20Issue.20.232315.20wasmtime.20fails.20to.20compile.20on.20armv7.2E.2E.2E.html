<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2315 wasmtime fails to compile on armv7... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232315.20wasmtime.20fails.20to.20compile.20on.20armv7.2E.2E.2E.html">wasmtime / Issue #2315 wasmtime fails to compile on armv7...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="214429272"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232315%20wasmtime%20fails%20to%20compile%20on%20armv7.../near/214429272" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232315.20wasmtime.20fails.20to.20compile.20on.20armv7.2E.2E.2E.html#214429272">(Oct 24 2020 at 13:56)</a>:</h4>
<p>stefson opened <a href="https://github.com/bytecodealliance/wasmtime/issues/2315">Issue #2315</a>:</p>
<blockquote>
<p>I checked out latest git and compiled with rust-1.45.2 and got this error: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">[</span><span class="n">E0308</span><span class="p">]</span>: <span class="nc">mismatched</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">156</span>:<span class="mi">52</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">156</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="k">unsafe</span><span class="w"> </span><span class="k">fn</span> <span class="nf">get_pc</span><span class="p">(</span><span class="n">cx</span>: <span class="o">*</span><span class="k">mut</span><span class="w"> </span><span class="n">libc</span>::<span class="n">c_void</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="o">------</span><span class="w">                           </span><span class="o">^^^^^^^^^</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">*-</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="n">implicitly</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="err">`</span><span class="k">return</span><span class="err">`</span><span class="w"> </span><span class="n">expression</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="err">`</span><span class="w"></span>
<span class="w">                 </span><span class="n">found</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>

<span class="n">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="err">`</span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">explain</span><span class="w"> </span><span class="n">E0308</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="err">`</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">runtime</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<p>there's also another error, which is fully suspected as armv7 isn't fully implemented yet: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span>: <span class="nc">unsupported</span><span class="w"> </span><span class="n">platform</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">174</span>:<span class="mi">21</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">174</span><span class="w"> </span><span class="o">|</span><span class="w">                     </span><span class="n">compile_error</span><span class="o">!</span><span class="p">(</span><span class="s">"unsupported platform"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                     </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w"></span>
</code></pre></div>

<p>verbose error log: <a href="https://github.com/bytecodealliance/wasmtime/files/5432974/verbose-error.zip">verbose-error.zip</a></p>
</blockquote>



<a name="214429273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232315%20wasmtime%20fails%20to%20compile%20on%20armv7.../near/214429273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232315.20wasmtime.20fails.20to.20compile.20on.20armv7.2E.2E.2E.html#214429273">(Oct 24 2020 at 13:56)</a>:</h4>
<p>stefson labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2315">Issue #2315</a>:</p>
<blockquote>
<p>I checked out latest git and compiled with rust-1.45.2 and got this error: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">[</span><span class="n">E0308</span><span class="p">]</span>: <span class="nc">mismatched</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">156</span>:<span class="mi">52</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">156</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="k">unsafe</span><span class="w"> </span><span class="k">fn</span> <span class="nf">get_pc</span><span class="p">(</span><span class="n">cx</span>: <span class="o">*</span><span class="k">mut</span><span class="w"> </span><span class="n">libc</span>::<span class="n">c_void</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="o">------</span><span class="w">                           </span><span class="o">^^^^^^^^^</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">*-</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="n">implicitly</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="err">`</span><span class="k">return</span><span class="err">`</span><span class="w"> </span><span class="n">expression</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="err">`</span><span class="w"></span>
<span class="w">                 </span><span class="n">found</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>

<span class="n">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="err">`</span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">explain</span><span class="w"> </span><span class="n">E0308</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="err">`</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">runtime</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<p>there's also another error, which is fully suspected as armv7 isn't fully implemented yet: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span>: <span class="nc">unsupported</span><span class="w"> </span><span class="n">platform</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">174</span>:<span class="mi">21</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">174</span><span class="w"> </span><span class="o">|</span><span class="w">                     </span><span class="n">compile_error</span><span class="o">!</span><span class="p">(</span><span class="s">"unsupported platform"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                     </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w"></span>
</code></pre></div>

<p>verbose error log: <a href="https://github.com/bytecodealliance/wasmtime/files/5432974/verbose-error.zip">verbose-error.zip</a></p>
</blockquote>



<a name="214430163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232315%20wasmtime%20fails%20to%20compile%20on%20armv7.../near/214430163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232315.20wasmtime.20fails.20to.20compile.20on.20armv7.2E.2E.2E.html#214430163">(Oct 24 2020 at 14:16)</a>:</h4>
<p>stefson <a href="https://github.com/bytecodealliance/wasmtime/issues/2315#issuecomment-715921381">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2315">Issue #2315</a>:</p>
<blockquote>
<p>I'm doing this test compile every once in a while to stop the code base from decaying further, making it even more difficult to work on it in the future and maybe implement full armv7 support. Sadly, I'm unable to fix this on my own as I don't speak that much rust, but I can offter to test any provided patch. </p>
</blockquote>



<a name="214539983"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232315%20wasmtime%20fails%20to%20compile%20on%20armv7.../near/214539983" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232315.20wasmtime.20fails.20to.20compile.20on.20armv7.2E.2E.2E.html#214539983">(Oct 26 2020 at 07:12)</a>:</h4>
<p>stefson edited <a href="https://github.com/bytecodealliance/wasmtime/issues/2315">Issue #2315</a>:</p>
<blockquote>
<p>I checked out latest git, compiled it with rust-1.45.2 and got this error: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">[</span><span class="n">E0308</span><span class="p">]</span>: <span class="nc">mismatched</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">156</span>:<span class="mi">52</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">156</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="k">unsafe</span><span class="w"> </span><span class="k">fn</span> <span class="nf">get_pc</span><span class="p">(</span><span class="n">cx</span>: <span class="o">*</span><span class="k">mut</span><span class="w"> </span><span class="n">libc</span>::<span class="n">c_void</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="o">------</span><span class="w">                           </span><span class="o">^^^^^^^^^</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">*-</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                   </span><span class="n">implicitly</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="err">`</span><span class="k">return</span><span class="err">`</span><span class="w"> </span><span class="n">expression</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="err">`</span><span class="w"></span>
<span class="w">                 </span><span class="n">found</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">()</span><span class="err">`</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>

<span class="n">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="err">`</span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">explain</span><span class="w"> </span><span class="n">E0308</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="err">`</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">runtime</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<p>there's also another error, which is expected as armv7 isn't fully implemented yet: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span>: <span class="nc">unsupported</span><span class="w"> </span><span class="n">platform</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">174</span>:<span class="mi">21</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">174</span><span class="w"> </span><span class="o">|</span><span class="w">                     </span><span class="n">compile_error</span><span class="o">!</span><span class="p">(</span><span class="s">"unsupported platform"</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">                     </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w"></span>
</code></pre></div>

<p>verbose error log: <a href="https://github.com/bytecodealliance/wasmtime/files/5432974/verbose-error.zip">verbose-error.zip</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>