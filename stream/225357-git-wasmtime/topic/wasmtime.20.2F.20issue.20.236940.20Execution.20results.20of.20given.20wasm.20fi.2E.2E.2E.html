<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6940 Execution results of given wasm fi... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html">wasmtime / issue #6940 Execution results of given wasm fi...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="388307482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/388307482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#388307482">(Aug 31 2023 at 11:59)</a>:</h4>
<p>luxinyi0105 opened <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p><a href="https://github.com/luxinyi0105/wasm_runtime_test/raw/main/08-31.zip">The given testcase</a> was simply mutated a wasm file, which was obtained by compiling C program generated with <code>Csmith</code> using <code>Emscripten Compiler</code>(Emcc). </p>
<p>The original C program is <code>c_file.c</code>, the compilation results with Emscripten is <code>wasm_file.wasm</code>, and its wat format is <code>wat_file.wat</code>. </p>
<p>We mutated the wat file to change its <code>i32.sub</code> in line 11762 with <code>i32.mul</code>. The result after mutation is <code>mutated_file.wat</code>, and its wasm format is <code>mutated_file.wasm</code>.</p>
<h3>Expected Results</h3>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
</code></pre></div>
<p>Output nothing.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmedge<span class="w"> </span>mutated_file.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>main<span class="w"> </span>module<span class="w"> </span><span class="sb">`</span>mutated_file.wasm<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">    </span><span class="m">0</span>:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>invoke<span class="w"> </span><span class="nb">command</span><span class="w"> </span>default
<span class="w">    </span><span class="m">1</span>:<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>executing<span class="w"> </span>at<span class="w"> </span>wasm<span class="w"> </span>backtrace:
<span class="w">           </span><span class="m">0</span>:<span class="w"> </span>0x75ba<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">41</span>&gt;
<span class="w">           </span><span class="m">1</span>:<span class="w"> </span>0x7bd0<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">58</span>&gt;
<span class="w">           </span><span class="m">2</span>:<span class="w"> </span>0x870c<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">61</span>&gt;
<span class="w">           </span><span class="m">3</span>:<span class="w"> </span>0x7e70<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">60</span>&gt;
<span class="w">           </span><span class="m">4</span>:<span class="w"> </span>0x7d09<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">59</span>&gt;
<span class="w">           </span><span class="m">5</span>:<span class="w"> </span>0x8b39<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">68</span>&gt;
<span class="w">           </span><span class="m">6</span>:<span class="w"> </span>0x7544<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">40</span>&gt;
<span class="w">           </span><span class="m">7</span>:<span class="w"> </span>0x56a7<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">12</span>&gt;
<span class="w">           </span><span class="m">8</span>:<span class="w"> </span>0x3f65<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">7</span>&gt;
<span class="w">           </span><span class="m">9</span>:<span class="w"> </span>0x72d9<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">34</span>&gt;
<span class="w">          </span><span class="m">10</span>:<span class="w"> </span>0x7253<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">33</span>&gt;
<span class="w">    </span><span class="m">2</span>:<span class="w"> </span>Pointer<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds:<span class="w"> </span>Region<span class="w"> </span><span class="o">{</span><span class="w"> </span>start:<span class="w"> </span><span class="m">78792</span>,<span class="w"> </span>len:<span class="w"> </span><span class="m">1914709016</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime-cli 13.0.0<br>
Operating system: Ubuntu 22.04.1<br>
Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>I tried to use some other wasm runtimes, such as wasmer, wasmedge and wasmi to execute the same testcase, they terminate normally and do not output anything(do not trigger errors). </p>
<p>Maybe there is something wrong with the “exception handling module”, or other tools do not follow certain specifications or perform certain condition checks. Due to a lack of knowledge of WebAssembly, the detail still need you to confirm. Thanks a lot!</p>
</blockquote>



<a name="388307485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/388307485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#388307485">(Aug 31 2023 at 11:59)</a>:</h4>
<p><a href="https://github.com/luxinyi0105">luxinyi0105</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">Issue #6940</a>.</p>



<a name="388315750"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/388315750" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#388315750">(Aug 31 2023 at 12:45)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-1700972203">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>That error seems to be emitted when calling a wasi function with an out-of-bounds pointer. Given that the memory is only 256 bytes big (<code>(memory (;0;) 256 256)</code>), address 78792 is out of bounds. I believe several other wasi implementations return ERRNO_FAULT when handed an out-of-bounds pointer, while Wasmtime emits a wasm traps and thus aborts execution.</p>
</blockquote>



<a name="388325963"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/388325963" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#388325963">(Aug 31 2023 at 13:35)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-1701054210">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>Oh note that the 256 there is 256 wasm pages, which is a memory that's 16777216 bytes large. Nevertheless @bjorn3 is still correct because the length of the pointer, 1914709016, is out of bounds, so Wasmtime is the spec-compliant runtime here.</p>
</blockquote>



<a name="388325964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/388325964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#388325964">(Aug 31 2023 at 13:35)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p><a href="https://github.com/luxinyi0105/wasm_runtime_test/raw/main/08-31.zip">The given testcase</a> was simply mutated a wasm file, which was obtained by compiling C program generated with <code>Csmith</code> using <code>Emscripten Compiler</code>(Emcc). </p>
<p>The original C program is <code>c_file.c</code>, the compilation results with Emscripten is <code>wasm_file.wasm</code>, and its wat format is <code>wat_file.wat</code>. </p>
<p>We mutated the wat file to change its <code>i32.sub</code> in line 11762 with <code>i32.mul</code>. The result after mutation is <code>mutated_file.wat</code>, and its wasm format is <code>mutated_file.wasm</code>.</p>
<h3>Expected Results</h3>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
</code></pre></div>
<p>Output nothing.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmedge<span class="w"> </span>mutated_file.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>main<span class="w"> </span>module<span class="w"> </span><span class="sb">`</span>mutated_file.wasm<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">    </span><span class="m">0</span>:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>invoke<span class="w"> </span><span class="nb">command</span><span class="w"> </span>default
<span class="w">    </span><span class="m">1</span>:<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>executing<span class="w"> </span>at<span class="w"> </span>wasm<span class="w"> </span>backtrace:
<span class="w">           </span><span class="m">0</span>:<span class="w"> </span>0x75ba<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">41</span>&gt;
<span class="w">           </span><span class="m">1</span>:<span class="w"> </span>0x7bd0<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">58</span>&gt;
<span class="w">           </span><span class="m">2</span>:<span class="w"> </span>0x870c<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">61</span>&gt;
<span class="w">           </span><span class="m">3</span>:<span class="w"> </span>0x7e70<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">60</span>&gt;
<span class="w">           </span><span class="m">4</span>:<span class="w"> </span>0x7d09<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">59</span>&gt;
<span class="w">           </span><span class="m">5</span>:<span class="w"> </span>0x8b39<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">68</span>&gt;
<span class="w">           </span><span class="m">6</span>:<span class="w"> </span>0x7544<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">40</span>&gt;
<span class="w">           </span><span class="m">7</span>:<span class="w"> </span>0x56a7<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">12</span>&gt;
<span class="w">           </span><span class="m">8</span>:<span class="w"> </span>0x3f65<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">7</span>&gt;
<span class="w">           </span><span class="m">9</span>:<span class="w"> </span>0x72d9<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">34</span>&gt;
<span class="w">          </span><span class="m">10</span>:<span class="w"> </span>0x7253<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">33</span>&gt;
<span class="w">    </span><span class="m">2</span>:<span class="w"> </span>Pointer<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds:<span class="w"> </span>Region<span class="w"> </span><span class="o">{</span><span class="w"> </span>start:<span class="w"> </span><span class="m">78792</span>,<span class="w"> </span>len:<span class="w"> </span><span class="m">1914709016</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime-cli 13.0.0<br>
Operating system: Ubuntu 22.04.1<br>
Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>I tried to use some other wasm runtimes, such as wasmer, wasmedge and wasmi to execute the same testcase, they terminate normally and do not output anything(do not trigger errors). </p>
<p>Maybe there is something wrong with the “exception handling module”, or other tools do not follow certain specifications or perform certain condition checks. Due to a lack of knowledge of WebAssembly, the detail still need you to confirm. Thanks a lot!</p>
</blockquote>



<a name="392993128"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/392993128" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#392993128">(Sep 25 2023 at 12:08)</a>:</h4>
<p>luxinyi0105 edited <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p><a href="https://github.com/luxinyi0105/wasm_runtime_test/raw/main/08-31.zip">The given testcase</a> was simply mutated a wasm file, which was obtained by compiling C program generated with <code>Csmith</code> using <code>Emscripten Compiler</code>(Emcc). </p>
<p>The original C program is <code>c_file.c</code>, the compilation results with Emscripten is <code>wasm_file.wasm</code>, and its wat format is <code>wat_file.wat</code>. </p>
<p>We mutated the wat file to change its <code>i32.sub</code> in line 11762 with <code>i32.mul</code>. The result after mutation is <code>mutated_file.wat</code>, and its wasm format is <code>mutated_file.wasm</code>.</p>
<h3>Expected Results</h3>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
</code></pre></div>
<p>Output nothing.</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>main<span class="w"> </span>module<span class="w"> </span><span class="sb">`</span>mutated_file.wasm<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">    </span><span class="m">0</span>:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>invoke<span class="w"> </span><span class="nb">command</span><span class="w"> </span>default
<span class="w">    </span><span class="m">1</span>:<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>executing<span class="w"> </span>at<span class="w"> </span>wasm<span class="w"> </span>backtrace:
<span class="w">           </span><span class="m">0</span>:<span class="w"> </span>0x75ba<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">41</span>&gt;
<span class="w">           </span><span class="m">1</span>:<span class="w"> </span>0x7bd0<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">58</span>&gt;
<span class="w">           </span><span class="m">2</span>:<span class="w"> </span>0x870c<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">61</span>&gt;
<span class="w">           </span><span class="m">3</span>:<span class="w"> </span>0x7e70<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">60</span>&gt;
<span class="w">           </span><span class="m">4</span>:<span class="w"> </span>0x7d09<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">59</span>&gt;
<span class="w">           </span><span class="m">5</span>:<span class="w"> </span>0x8b39<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">68</span>&gt;
<span class="w">           </span><span class="m">6</span>:<span class="w"> </span>0x7544<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">40</span>&gt;
<span class="w">           </span><span class="m">7</span>:<span class="w"> </span>0x56a7<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">12</span>&gt;
<span class="w">           </span><span class="m">8</span>:<span class="w"> </span>0x3f65<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">7</span>&gt;
<span class="w">           </span><span class="m">9</span>:<span class="w"> </span>0x72d9<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">34</span>&gt;
<span class="w">          </span><span class="m">10</span>:<span class="w"> </span>0x7253<span class="w"> </span>-<span class="w"> </span>&lt;unknown&gt;!&lt;wasm<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="m">33</span>&gt;
<span class="w">    </span><span class="m">2</span>:<span class="w"> </span>Pointer<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds:<span class="w"> </span>Region<span class="w"> </span><span class="o">{</span><span class="w"> </span>start:<span class="w"> </span><span class="m">78792</span>,<span class="w"> </span>len:<span class="w"> </span><span class="m">1914709016</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime-cli 13.0.0<br>
Operating system: Ubuntu 22.04.1<br>
Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>I tried to use some other wasm runtimes, such as wasmer, wasmedge and wasmi to execute the same testcase, they terminate normally and do not output anything(do not trigger errors). </p>
<p>Maybe there is something wrong with the “exception handling module”, or other tools do not follow certain specifications or perform certain condition checks. Due to a lack of knowledge of WebAssembly, the detail still need you to confirm. Thanks a lot!</p>
</blockquote>



<a name="475154112"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475154112" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475154112">(Oct 06 2024 at 22:43)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2395613160">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>@alexcrichton I just triaged the issue for Wasmi and found that Wasmtime no longer traps here but instead happily returns the checksum: <a href="https://github.com/wasmi-labs/wasmi/issues/757#issuecomment-2395612799">https://github.com/wasmi-labs/wasmi/issues/757#issuecomment-2395612799</a></p>
</blockquote>



<a name="475154134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475154134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475154134">(Oct 06 2024 at 22:43)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2395613160">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>@alexcrichton I just triaged the issue for Wasmi and found that Wasmtime no longer traps here but instead happily returns the checksum: <a href="https://github.com/wasmi-labs/wasmi/issues/757#issuecomment-2395612799">https://github.com/wasmi-labs/wasmi/issues/757#issuecomment-2395612799</a></p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmtime<span class="w"> </span>--version
wasmtime<span class="w"> </span><span class="m">25</span>.0.1
</code></pre></div><br>
</p>
</blockquote>



<a name="475157603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475157603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475157603">(Oct 06 2024 at 23:28)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2395635569">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>In <a href="https://github.com/wasmi-labs/wasmi/issues/757">https://github.com/wasmi-labs/wasmi/issues/757</a> where did you get <code>06-mutated.wat</code> from? The <code>*.zip</code> files in this issue and the wasmi issue are different, and <code>mutated_file.wasm</code> is different, so it may be expected that one passes and one doesn't. I can reproduce the file from  <a href="https://github.com/wasmi-labs/wasmi/issues/757">https://github.com/wasmi-labs/wasmi/issues/757</a> succeeding, but the one attached to this issue still fails with the same error.</p>
</blockquote>



<a name="475234975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475234975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475234975">(Oct 07 2024 at 07:52)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2396180088">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>Hi @alexcrichton , sorry about the confusion with the Wasm file names. Yesterday I did a triage of many Wasmi issues and thus I renamed the Wasm files from the issues (which were often named the same).</p>
<p>Indeed the Wasm blobs in both issues are different. I probably got confused by the initial Wasmi issue post:<br>
<a href="https://github.com/wasmi-labs/wasmi/issues/757#issue-1887832399">https://github.com/wasmi-labs/wasmi/issues/757#issue-1887832399</a></p>
<blockquote>
<p>According to the issue I submitted in wasmtime: <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">https://github.com/bytecodealliance/wasmtime/issues/6940</a>, the length of the pointer, 952683808, is out of bounds. Wasmtime emits a wasm traps when handed an out-of-bounds pointer, while other runtime tools maybe return ERRNO_FAULT.</p>
</blockquote>
<p>Maybe the link to the Wasmtime issue is wrong there. But this link lead me to re-reporting the issue here.</p>
</blockquote>



<a name="475314716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475314716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475314716">(Oct 07 2024 at 14:47)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2397143523">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>No worries! I wanted to try to dig in further to see what's going on. Do you still have a module on-hand that's exhibiting different behavior in two runtimes?</p>
</blockquote>



<a name="475327232"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475327232" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475327232">(Oct 07 2024 at 15:38)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2397274737">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>Well, the only Wasm blob I currently know where Wasmi and Wasmtime diverge is the one I was reporting above: <code>mutated_file.wasm</code> or <code>mutated_file.wat</code> in <a href="https://github.com/luxinyi0105/wasm_runtime_test/raw/main/09-08.zip">this Zip file</a>.</p>
<h2>Wasmi</h2>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmi_cli<span class="w"> </span>mutated_file.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>during<span class="w"> </span>execution<span class="w"> </span>of<span class="w"> </span>_start:<span class="w"> </span>Pointer<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds:<span class="w"> </span>Region<span class="w"> </span><span class="o">{</span><span class="w"> </span>start:<span class="w"> </span><span class="m">816071770</span>,<span class="w"> </span>len:<span class="w"> </span><span class="m">952683808</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<h2>Wasmtime</h2>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
<span class="nv">checksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>72658C22
</code></pre></div><br>
</p>
</blockquote>



<a name="475327354"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475327354" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475327354">(Oct 07 2024 at 15:39)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2397274737">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>Well, the only Wasm blob I currently know where Wasmi and Wasmtime diverge is the one I was reporting above: <code>mutated_file.wasm</code> or <code>mutated_file.wat</code> in <a href="https://github.com/luxinyi0105/wasm_runtime_test/raw/main/09-08.zip">this Zip file</a>.</p>
<p>And I just re-checked and it indeed diverges in both.</p>
<h2>Wasmi v0.38.0</h2>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmi_cli<span class="w"> </span>mutated_file.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>during<span class="w"> </span>execution<span class="w"> </span>of<span class="w"> </span>_start:<span class="w"> </span>Pointer<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds:<span class="w"> </span>Region<span class="w"> </span><span class="o">{</span><span class="w"> </span>start:<span class="w"> </span><span class="m">816071770</span>,<span class="w"> </span>len:<span class="w"> </span><span class="m">952683808</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<h2>Wasmtime v25.0.1</h2>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
<span class="nv">checksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>72658C22
</code></pre></div><br>
</p>
</blockquote>



<a name="475327423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475327423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475327423">(Oct 07 2024 at 15:39)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2397274737">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>Well, the only Wasm blob I currently know where Wasmi and Wasmtime diverge is the one I was reporting above: <code>mutated_file.wasm</code> or <code>mutated_file.wat</code> in <a href="https://github.com/luxinyi0105/wasm_runtime_test/raw/main/09-08.zip">this Zip file</a>.</p>
<p>And I just re-checked (because it was very late yesterday) and it indeed diverges in both.</p>
<h2>Wasmi v0.38.0</h2>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmi_cli<span class="w"> </span>mutated_file.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>during<span class="w"> </span>execution<span class="w"> </span>of<span class="w"> </span>_start:<span class="w"> </span>Pointer<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds:<span class="w"> </span>Region<span class="w"> </span><span class="o">{</span><span class="w"> </span>start:<span class="w"> </span><span class="m">816071770</span>,<span class="w"> </span>len:<span class="w"> </span><span class="m">952683808</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<h2>Wasmtime v25.0.1</h2>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>%<span class="w"> </span>wasmtime<span class="w"> </span>mutated_file.wasm
<span class="nv">checksum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>72658C22
</code></pre></div><br>
</p>
</blockquote>



<a name="475376482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475376482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475376482">(Oct 07 2024 at 19:27)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2397716334">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<p>Digging in to this it looks like the issue is that beforehand <code>fd_write</code> was given 2 entries in its ciovec array. The mutation gives it instead 3 entries. Wasmtime however only look at the first non-empty entry and doesn't validate the others. Given the under-specification of <code>fd_write</code> and wasip1 functions in general I think this is probably fine, but that may explain the difference here.</p>
</blockquote>



<a name="475380022"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236940%20Execution%20results%20of%20given%20wasm%20fi.../near/475380022" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236940.20Execution.20results.20of.20given.20wasm.20fi.2E.2E.2E.html#475380022">(Oct 07 2024 at 19:45)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/issues/6940#issuecomment-2397750750">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6940">issue #6940</a>:</p>
<blockquote>
<blockquote>
<p>Digging in to this it looks like the issue is that beforehand <code>fd_write</code> was given 2 entries in its ciovec array. The mutation gives it instead 3 entries. Wasmtime however only look at the first non-empty entry and doesn't validate the others. Given the under-specification of <code>fd_write</code> and wasip1 functions in general I think this is probably fine, but that may explain the difference here.</p>
</blockquote>
<p>Ah okay, very good to know. Thanks a lot for the clarification here!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>