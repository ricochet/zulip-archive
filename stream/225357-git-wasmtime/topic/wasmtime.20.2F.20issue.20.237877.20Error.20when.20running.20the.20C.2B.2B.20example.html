<html>
<head><meta charset="utf-8"><title>wasmtime / issue #7877 Error when running the C++ example · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html">wasmtime / issue #7877 Error when running the C++ example</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="420001839"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420001839" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420001839">(Feb 06 2024 at 09:01)</a>:</h4>
<p><a href="https://github.com/996ccs">996ccs</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">Issue #7877</a>.</p>



<a name="420001840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420001840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420001840">(Feb 06 2024 at 09:01)</a>:</h4>
<p><a href="https://github.com/996ccs">996ccs</a> added the cranelift label to <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">Issue #7877</a>.</p>



<a name="420001844"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420001844" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420001844">(Feb 06 2024 at 09:01)</a>:</h4>
<p>996ccs opened <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<p>Thanks for filing an issue! Please fill out the TODOs below.</p>
<h3><code>.clif</code> Test Case</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">TODO</span>: <span class="nc">paste</span><span class="w"> </span><span class="p">.</span><span class="n">clif</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="n">here</span><span class="p">.</span><span class="w"> </span><span class="n">Ideally</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">reduced</span><span class="w"> </span><span class="n">via</span>
<span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">clif</span><span class="o">-</span><span class="n">util</span><span class="w"> </span><span class="n">bugpoint</span><span class="err">`</span><span class="w"> </span><span class="n">command</span><span class="p">.</span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<p>An error occurs when the c++ column in the examples/ directory is run</p>
<ul>
<li>TODO: First, ...</li>
<li>TODO: Then, ...</li>
<li>Etc...</li>
</ul>
<h3>Expected Results</h3>
<p>TODO: What do you expect to happen?<br>
Code compile through</p>
<h3>Actual Results</h3>
<p>Undefined symbols for architecture arm64:<br>
  "_wasm_byte_vec_delete", referenced from:<br>
      (anonymous namespace)::compile_wat_module_from_file(wasm_engine_t*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt; const&amp;) in async-63399a.o<br>
      (anonymous namespace)::exit_with_error(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;, wasmtime_error<em>, wasm_trap_t</em>) in async-63399a.o<br>
TODO: What actually happens? Panic? Segfault? Incorrect result?</p>
<h3>Versions and Environment</h3>
<p>Cranelift version or commit: TODO</p>
<p>Operating system: TODO<br>
mac os 13.4<br>
Architecture: TODO</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="420121545"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420121545" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420121545">(Feb 06 2024 at 19:40)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1930631472">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<p>Thanks for the report, but can you fill out some more of the issue template? For example how do we reproduce this? You've pasted a linker-generated error but that could happen from a whole manner of causes. This could be as simple as a missing <code>-lwasmtime</code> on the linker command line and something as complex as the wrong version of the library being used. </p>
</blockquote>



<a name="420169625"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420169625" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420169625">(Feb 07 2024 at 02:26)</a>:</h4>
<p>996ccs <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1931140026">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<blockquote>
<p>Thanks for the report, but can you fill out some more of the issue template? For example how do we reproduce this? You've pasted a linker-generated error but that could happen from a whole manner of causes. This could be as simple as a missing <code>-lwasmtime</code> on the linker command line and something as complex as the wrong version of the library being used.</p>
</blockquote>
<p>Thank you for your reply.<br>
I was under the <a href="https://github.com/bytecodealliance/wasmtime-cpp">https://github.com/bytecodealliance/wasmtime-cpp</a> warehouse will include directory header file complete and implement a c + + examples/arg, 20 \ cc - STD = c + + <br>
-I ./include \ <br>
-I ./include \ <br>
-lpthread -ldl -lm \ <br>
-o fuel<br>
Then the compiler reported an error, the error message is as follows:<br>
Undefined symbols for architecture arm64:<br>
  "_wasm_byte_vec_delete", referenced from:<br>
      __ZNK8wasmtime5Error7messageB5cxx11Ev in ccjBPpoF.o<br>
      __ZN8wasmtime8wat2wasmESt17basic_string_viewIcSt11char_traitsIcEE in ccjBPpoF.o<br>
      __ZNK8wasmtime4Trap7messageB5cxx11Ev in ccjBPpoF.o<br>
  "_wasm_config_delete", referenced from:...</p>
</blockquote>



<a name="420170752"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420170752" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420170752">(Feb 07 2024 at 02:41)</a>:</h4>
<p>996ccs edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1931140026">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<blockquote>
<p>Thanks for the report, but can you fill out some more of the issue template? For example how do we reproduce this? You've pasted a linker-generated error but that could happen from a whole manner of causes. This could be as simple as a missing <code>-lwasmtime</code> on the linker command line and something as complex as the wrong version of the library being used.</p>
</blockquote>
<p>Thank you for your reply.<br>
I was under the <a href="https://github.sheincorp.cn/bytecodealliance/wasmtime-cpp">https://github.sheincorp.cn/bytecodealliance/wasmtime-cpp</a> repository will include directory header file complete and implement a c + + examples/arg, 20 \ cc - STD = c + + <br>
-I ./include \ <br>
-I ./include \ <br>
-lpthread -ldl -lm \ <br>
-o fuel<br>
Then the compiler reported an error, the error message is as follows:<br>
Undefined symbols for architecture arm64:<br>
  "_wasm_byte_vec_delete", referenced from:<br>
      __ZNK8wasmtime5Error7messageB5cxx11Ev in ccjBPpoF.o<br>
      __ZN8wasmtime8wat2wasmESt17basic_string_viewIcSt11char_traitsIcEE in ccjBPpoF.o<br>
      __ZNK8wasmtime4Trap7messageB5cxx11Ev in ccjBPpoF.o<br>
  "_wasm_config_delete", referenced from:...</p>
</blockquote>



<a name="420170896"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420170896" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420170896">(Feb 07 2024 at 02:43)</a>:</h4>
<p>996ccs edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1931140026">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<blockquote>
<p>Thanks for the report, but can you fill out some more of the issue template? For example how do we reproduce this? You've pasted a linker-generated error but that could happen from a whole manner of causes. This could be as simple as a missing <code>-lwasmtime</code> on the linker command line and something as complex as the wrong version of the library being used.</p>
</blockquote>
<p>Thank you for your reply.<br>
I was under the <a href="https://github.sheincorp.cn/bytecodealliance/wasmtime-cpp">https://github.sheincorp.cn/bytecodealliance/wasmtime-cpp</a> repository will include directory header file complete and implement a  c++ examples/fuel.cc -std=c++20\<br>
-I ./include \ <br>
-lpthread -ldl -lm \ <br>
-o fuel<br>
Then the compiler reported an error, the error message is as follows:<br>
Undefined symbols for architecture arm64:<br>
  "_wasm_byte_vec_delete", referenced from:<br>
      __ZNK8wasmtime5Error7messageB5cxx11Ev in ccjBPpoF.o<br>
      __ZN8wasmtime8wat2wasmESt17basic_string_viewIcSt11char_traitsIcEE in ccjBPpoF.o<br>
      __ZNK8wasmtime4Trap7messageB5cxx11Ev in ccjBPpoF.o<br>
  "_wasm_config_delete", referenced from:...</p>
</blockquote>



<a name="420634997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/420634997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#420634997">(Feb 09 2024 at 11:38)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1935771492">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<p>Your command line there is missing <code>-lwasmtime</code> or something equivalent to link the Wasmtime C API. You can find more documentation in <a href="https://github.com/bytecodealliance/wasmtime/blob/cee0eeb2892e3831b2952b445319e6d894ea378e/examples/fuel.c#L7-L14"><code>fuel.c</code></a>.</p>
</blockquote>



<a name="422012975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/422012975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#422012975">(Feb 17 2024 at 13:54)</a>:</h4>
<p>996ccs <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1950213185">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<blockquote>
<p>Your command line there is missing <code>-lwasmtime</code> or something equivalent to link the Wasmtime C API. You can find more documentation in <a href="https://github.com/bytecodealliance/wasmtime/blob/cee0eeb2892e3831b2952b445319e6d894ea378e/examples/fuel.c#L7-L14"><code>fuel.c</code></a>.</p>
</blockquote>
<p>When I run the above example, I get an error<br>
 wasmtime git:(main) cargo build --release -p wasmtime-c-api<br>
   cc examples/fuel.c \<br>
       -I crates/c-api/include \<br>
       -I crates/c-api/wasm-c-api/include \<br>
       -lpthread -ldl -lm \<br>
       -o fuel<br>
   ./fuel<br>
    Updating <a href="http://crates.io">crates.io</a> index<br>
error: failed to get <code>witx</code> as a dependency of package <code>wiggle v19.0.0 (/Users/mymac/Desktop/fe/wasmtime/crates/wiggle)</code></p>
<p>Caused by:<br>
  failed to load source for dependency <code>witx</code></p>
<p>Caused by:<br>
  Unable to update /Users/mymac/Desktop/fe/wasmtime/crates/wasi-common/WASI/tools/witx</p>
<p>Caused by:<br>
  failed to read <code>/Users/mymac/Desktop/fe/wasmtime/crates/wasi-common/WASI/tools/witx/Cargo.toml</code></p>
<p>Caused by:<br>
  No such file or directory (os error 2)<br>
examples/fuel.c:27:10: fatal error: 'wasm.h' file not found<br>
#include &lt;wasm.h&gt;<br>
         ^~~~~~~~<br>
1 error generated.<br>
zsh: no such file or directory: ./fuel<br>
➜  wasmtime git:(main) cargo build --release -p wasmtime-c-api<br>
   cc examples/fuel.c \<br>
       -I crates/c-api/include \<br>
       -I crates/c-api/wasm-c-api/include \<br>
       target/release/libwasmtime.a \<br>
       -lpthread -ldl -lm \<br>
       -o fuel<br>
   ./fuel<br>
    Updating <a href="http://crates.io">crates.io</a> index<br>
error: failed to get <code>witx</code> as a dependency of package <code>wiggle v19.0.0 (/Users/mymac/Desktop/fe/wasmtime/crates/wiggle)</code></p>
<p>Caused by:<br>
  failed to load source for dependency <code>witx</code></p>
<p>Caused by:<br>
  Unable to update /Users/mymac/Desktop/fe/wasmtime/crates/wasi-common/WASI/tools/witx</p>
<p>Caused by:<br>
  failed to read <code>/Users/mymac/Desktop/fe/wasmtime/crates/wasi-common/WASI/tools/witx/Cargo.toml</code></p>
<p>Caused by:<br>
  No such file or directory (os error 2)<br>
clang: error: no such file or directory: 'target/release/libwasmtime.a'<br>
zsh: no such file or directory: ./fuel</p>
</blockquote>



<a name="422361756"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/422361756" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#422361756">(Feb 20 2024 at 07:39)</a>:</h4>
<p>996ccs closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<p>Thanks for filing an issue! Please fill out the TODOs below.</p>
<h3><code>.clif</code> Test Case</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">TODO</span>: <span class="nc">paste</span><span class="w"> </span><span class="p">.</span><span class="n">clif</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="n">here</span><span class="p">.</span><span class="w"> </span><span class="n">Ideally</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">reduced</span><span class="w"> </span><span class="n">via</span>
<span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">clif</span><span class="o">-</span><span class="n">util</span><span class="w"> </span><span class="n">bugpoint</span><span class="err">`</span><span class="w"> </span><span class="n">command</span><span class="p">.</span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<p>An error occurs when the c++ column in the examples/ directory is run</p>
<ul>
<li>TODO: First, ...</li>
<li>TODO: Then, ...</li>
<li>Etc...</li>
</ul>
<h3>Expected Results</h3>
<p>TODO: What do you expect to happen?<br>
Code compile through</p>
<h3>Actual Results</h3>
<p>Undefined symbols for architecture arm64:<br>
  "_wasm_byte_vec_delete", referenced from:<br>
      (anonymous namespace)::compile_wat_module_from_file(wasm_engine_t*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt; const&amp;) in async-63399a.o<br>
      (anonymous namespace)::exit_with_error(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;, wasmtime_error<em>, wasm_trap_t</em>) in async-63399a.o<br>
TODO: What actually happens? Panic? Segfault? Incorrect result?</p>
<h3>Versions and Environment</h3>
<p>Cranelift version or commit: TODO</p>
<p>Operating system: TODO<br>
mac os 13.4<br>
Architecture: TODO</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?<br>
</p>
</blockquote>



<a name="422361797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237877%20Error%20when%20running%20the%20C%2B%2B%20example/near/422361797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237877.20Error.20when.20running.20the.20C.2B.2B.20example.html#422361797">(Feb 20 2024 at 07:39)</a>:</h4>
<p>996ccs <a href="https://github.com/bytecodealliance/wasmtime/issues/7877#issuecomment-1953636362">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7877">issue #7877</a>:</p>
<blockquote>
<p>The problem has been solved.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>