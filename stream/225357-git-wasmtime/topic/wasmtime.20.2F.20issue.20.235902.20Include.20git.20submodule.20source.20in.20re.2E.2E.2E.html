<html>
<head><meta charset="utf-8"><title>wasmtime / issue #5902 Include git submodule source in re... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html">wasmtime / issue #5902 Include git submodule source in re...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="338880638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/338880638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#338880638">(Mar 01 2023 at 15:51)</a>:</h4>
<p>kriswuollett opened <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Include submodules source in release source artifacts.</p>
<h4>Benefit</h4>
<p>Can compile <code>wasmtime</code> from release source artifact, otherwise one currently encounters this issue:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>--manifest-path<span class="w"> </span>crates/c-api/Cargo.toml
error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>workspace<span class="w"> </span>member<span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/bench-api<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-cap-std-sync<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-common<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime-wasi<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-tokio<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-macro<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-generate<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>witx<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/wasi-common/WASI/tools/witx/Cargo.toml<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>My use case is to use <code>http_archive</code> instead of <code>git_repository</code> in a Bazel workspace for faster build initialization, e.g.,:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">_ALL_CONTENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"""\</span>
<span class="s">filegroup(</span>
<span class="s">    name = "</span><span class="n">all_srcs</span><span class="s">",</span>
<span class="s">    srcs = glob(["</span><span class="o">**</span><span class="s">"]),</span>
<span class="s">    visibility = ["</span><span class="c1">//visibility:public"],</span>
<span class="p">)</span>

<span class="n">http_archive</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime"</span><span class="p">,</span>
<span class="w">    </span><span class="n">build_file_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_ALL_CONTENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">strip_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime-6.0.0"</span><span class="p">,</span>
<span class="w">    </span><span class="n">urls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s">"https://github.com/bytecodealliance/wasmtime/archive/refs/tags/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"02af6132501ec5aff6993925a23efda0cbaab16e509787d3649cfc1bf8a33978"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h4>Implementation</h4>
<p>It is possible to reuse a script created for another project with the same issue to include submodules in the release source archive, see <a href="https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043">https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043</a>.</p>
</blockquote>



<a name="338882055"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/338882055" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#338882055">(Mar 01 2023 at 15:55)</a>:</h4>
<p>kriswuollett edited <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Include submodules source in release source artifacts.</p>
<h4>Benefit</h4>
<p>Can compile <code>wasmtime</code> from release source artifact, which can be mirrored on an internal archive, otherwise one currently encounters this issue:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>--manifest-path<span class="w"> </span>crates/c-api/Cargo.toml
error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>workspace<span class="w"> </span>member<span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/bench-api<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-cap-std-sync<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-common<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime-wasi<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-tokio<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-macro<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-generate<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>witx<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/wasi-common/WASI/tools/witx/Cargo.toml<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>My use case is to use <code>http_archive</code> instead of <code>git_repository</code> in a Bazel workspace for faster build initialization, e.g.,:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">_ALL_CONTENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"""\</span>
<span class="s">filegroup(</span>
<span class="s">    name = "</span><span class="n">all_srcs</span><span class="s">",</span>
<span class="s">    srcs = glob(["</span><span class="o">**</span><span class="s">"]),</span>
<span class="s">    visibility = ["</span><span class="c1">//visibility:public"],</span>
<span class="p">)</span>

<span class="n">http_archive</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime"</span><span class="p">,</span>
<span class="w">    </span><span class="n">build_file_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_ALL_CONTENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">strip_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime-6.0.0"</span><span class="p">,</span>
<span class="w">    </span><span class="n">urls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s">"https://github.com/bytecodealliance/wasmtime/archive/refs/tags/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"02af6132501ec5aff6993925a23efda0cbaab16e509787d3649cfc1bf8a33978"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h4>Implementation</h4>
<p>It is possible to reuse a script created for another project with the same issue to include submodules in the release source archive, see <a href="https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043">https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043</a>.</p>
</blockquote>



<a name="338882430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/338882430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#338882430">(Mar 01 2023 at 15:56)</a>:</h4>
<p>kriswuollett edited <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Include submodules source in release source artifacts.</p>
<h4>Benefit</h4>
<p>Can compile <code>wasmtime</code> from release source artifact, which can be mirrored on an internal archive, otherwise one currently encounters this issue:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>--manifest-path<span class="w"> </span>crates/c-api/Cargo.toml
error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>workspace<span class="w"> </span>member<span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/bench-api<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-cap-std-sync<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-common<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime-wasi<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-tokio<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-macro<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-generate<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>witx<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/wasi-common/WASI/tools/witx/Cargo.toml<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>My use case is to use <code>http_archive</code> instead of <code>git_repository</code> in a Bazel workspace for faster build initialization, e.g.,:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">_ALL_CONTENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"""\</span>
<span class="s">filegroup(</span>
<span class="s">    name = "</span><span class="n">all_srcs</span><span class="s">",</span>
<span class="s">    srcs = glob(["</span><span class="o">**</span><span class="s">"]),</span>
<span class="s">    visibility = ["</span><span class="c1">//visibility:public"],</span>
<span class="p">)</span>

<span class="n">http_archive</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime"</span><span class="p">,</span>
<span class="w">    </span><span class="n">build_file_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_ALL_CONTENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">strip_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime-6.0.0"</span><span class="p">,</span>
<span class="w">    </span><span class="n">urls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s">"https://archive.corp.mycompany.com/bytecodealliance/wasmtime/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">        </span><span class="s">"https://github.com/bytecodealliance/wasmtime/archive/refs/tags/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"02af6132501ec5aff6993925a23efda0cbaab16e509787d3649cfc1bf8a33978"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h4>Implementation</h4>
<p>It is possible to reuse a script created for another project with the same issue to include submodules in the release source archive, see <a href="https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043">https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043</a>.</p>
</blockquote>



<a name="338882577"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/338882577" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#338882577">(Mar 01 2023 at 15:56)</a>:</h4>
<p>kriswuollett edited <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Include submodules source in release source artifacts.</p>
<h4>Benefit</h4>
<p>Can compile <code>wasmtime</code> from release source artifact, which can be mirrored on an internal archive, otherwise one currently encounters this issue:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>--manifest-path<span class="w"> </span>crates/c-api/Cargo.toml
error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>workspace<span class="w"> </span>member<span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/bench-api<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-cap-std-sync<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-common<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime-wasi<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-tokio<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-macro<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-generate<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>witx<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/wasi-common/WASI/tools/witx/Cargo.toml<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>My use case is to use <code>http_archive</code> instead of <code>git_repository</code> in a Bazel workspace for faster build initialization, e.g.,:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">_ALL_CONTENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"""\</span>
<span class="s">filegroup(</span>
<span class="s">    name = "</span><span class="n">all_srcs</span><span class="s">",</span>
<span class="s">    srcs = glob(["</span><span class="o">**</span><span class="s">"]),</span>
<span class="s">    visibility = ["</span><span class="c1">//visibility:public"],</span>
<span class="p">)</span>

<span class="n">http_archive</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime"</span><span class="p">,</span>
<span class="w">    </span><span class="n">build_file_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_ALL_CONTENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">strip_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime-6.0.0"</span><span class="p">,</span>
<span class="w">    </span><span class="n">urls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s">"https://archive.corp.example.com/bytecodealliance/wasmtime/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">        </span><span class="s">"https://github.com/bytecodealliance/wasmtime/archive/refs/tags/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"02af6132501ec5aff6993925a23efda0cbaab16e509787d3649cfc1bf8a33978"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h4>Implementation</h4>
<p>It is possible to reuse a script created for another project with the same issue to include submodules in the release source archive, see <a href="https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043">https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043</a>.</p>
</blockquote>



<a name="338886708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/338886708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#338886708">(Mar 01 2023 at 16:11)</a>:</h4>
<p>kriswuollett <a href="https://github.com/bytecodealliance/wasmtime/issues/5902#issuecomment-1450414532">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<p>Current workaround:</p>
<div class="codehilite" data-code-language="bazel"><pre><span></span><code>git_repository(
    name = "wasmtime",
    build_file_content = _ALL_CONTENT,
    remote = "https://github.com/bytecodealliance/wasmtime.git",
    commit = "c00d3f0542855a13adffffd5f4ff0177dfbdcb34", # v6.0.0
    recursive_init_submodules = True,
)
</code></pre></div>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>bazel<span class="w"> </span>query<span class="w"> </span><span class="s1">'deps(@wasmtime//:all_srcs)'</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">'tools/witx'</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head
@wasmtime//:crates/wasi-common/WASI/tools/witx-cli/Cargo.toml
@wasmtime//:crates/wasi-common/WASI/tools/witx-cli/src/main.rs
@wasmtime//:crates/wasi-common/WASI/tools/witx/.gitignore
@wasmtime//:crates/wasi-common/WASI/tools/witx/Cargo.toml
@wasmtime//:crates/wasi-common/WASI/tools/witx/LICENSE
@wasmtime//:crates/wasi-common/WASI/tools/witx/src/abi.rs
@wasmtime//:crates/wasi-common/WASI/tools/witx/src/ast.rs
@wasmtime//:crates/wasi-common/WASI/tools/witx/src/docs/ast.rs
@wasmtime//:crates/wasi-common/WASI/tools/witx/src/docs/md.rs
@wasmtime//:crates/wasi-common/WASI/tools/witx/src/docs/mod.rs
</code></pre></div>
</blockquote>



<a name="338887268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/338887268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#338887268">(Mar 01 2023 at 16:13)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/5902#issuecomment-1450417940">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<p>Could you try using the <a href="https://github.com/bytecodealliance/wasmtime/releases/download/v6.0.0/wasmtime-v6.0.0-src.tar.gz">dedicated source tarball</a>? We have no control over the github-generated tarballs to include submodules or not.</p>
</blockquote>



<a name="339129689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/339129689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#339129689">(Mar 02 2023 at 15:21)</a>:</h4>
<p>kriswuollett <a href="https://github.com/bytecodealliance/wasmtime/issues/5902#issuecomment-1452047455">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<p>Yes, thanks, that works! I seem to have been in the habit of always skipping down to the src link at the bottom of GitHub releases for a repo.</p>
</blockquote>



<a name="339129690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235902%20Include%20git%20submodule%20source%20in%20re.../near/339129690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235902.20Include.20git.20submodule.20source.20in.20re.2E.2E.2E.html#339129690">(Mar 02 2023 at 15:21)</a>:</h4>
<p>kriswuollett closed <a href="https://github.com/bytecodealliance/wasmtime/issues/5902">issue #5902</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Include submodules source in release source artifacts.</p>
<h4>Benefit</h4>
<p>Can compile <code>wasmtime</code> from release source artifact, which can be mirrored on an internal archive, otherwise one currently encounters this issue:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>build<span class="w"> </span>--release<span class="w"> </span>--manifest-path<span class="w"> </span>crates/c-api/Cargo.toml
error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>workspace<span class="w"> </span>member<span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/bench-api<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-cap-std-sync<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-common<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasmtime-wasi<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wasi-tokio<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-macro<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>wiggle-generate<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span>load<span class="w"> </span>manifest<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependency<span class="w"> </span><span class="sb">`</span>witx<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>failed<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="sb">`</span>/home/kris/code/wasmtime-6.0.0/crates/wasi-common/WASI/tools/witx/Cargo.toml<span class="sb">`</span>

Caused<span class="w"> </span>by:
<span class="w">  </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>My use case is to use <code>http_archive</code> instead of <code>git_repository</code> in a Bazel workspace for faster build initialization, e.g.,:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">_ALL_CONTENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"""\</span>
<span class="s">filegroup(</span>
<span class="s">    name = "</span><span class="n">all_srcs</span><span class="s">",</span>
<span class="s">    srcs = glob(["</span><span class="o">**</span><span class="s">"]),</span>
<span class="s">    visibility = ["</span><span class="c1">//visibility:public"],</span>
<span class="p">)</span>

<span class="n">http_archive</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime"</span><span class="p">,</span>
<span class="w">    </span><span class="n">build_file_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_ALL_CONTENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">strip_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"wasmtime-6.0.0"</span><span class="p">,</span>
<span class="w">    </span><span class="n">urls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s">"https://archive.corp.example.com/bytecodealliance/wasmtime/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">        </span><span class="s">"https://github.com/bytecodealliance/wasmtime/archive/refs/tags/v6.0.0.tar.gz"</span><span class="p">,</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="n">sha256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"02af6132501ec5aff6993925a23efda0cbaab16e509787d3649cfc1bf8a33978"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<h4>Implementation</h4>
<p>It is possible to reuse a script created for another project with the same issue to include submodules in the release source archive, see <a href="https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043">https://github.com/AcademySoftwareFoundation/MaterialX/issues/317#issuecomment-560131043</a>.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>