<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5947 Pick argument and return types based ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html">wasmtime / PR #5947 Pick argument and return types based ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="340000772"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/340000772" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#340000772">(Mar 07 2023 at 01:23)</a>:</h4>
<p>elliottt opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p>When generating instructions during fuzzing, use the opcode's constraints to guide the generation of argument and return value types. This gets us slightly closer to not needing <code>OPCODE_SIGNATURES</code>, but also surfaces some problems with how we encode constraints for some instructions. For example, some instructions require that the type of their output has fewer bits than the type of their input, but we do not currently mechanize this constraint. As a result, the changes in this PR will frequently generate unexpected combinations of types for an instruction's inputs and outputs that trigger panics in a backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="340000876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/340000876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#340000876">(Mar 07 2023 at 01:24)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p><strong>This PR is not ready for review, there are some problems to work out that are outlined below.</strong></p>
<p>When generating instructions during fuzzing, use the opcode's constraints to guide the generation of argument and return value types. This gets us slightly closer to not needing <code>OPCODE_SIGNATURES</code>, but also surfaces some problems with how we encode constraints for some instructions. For example, some instructions require that the type of their output has fewer bits than the type of their input, but we do not currently mechanize this constraint. As a result, the changes in this PR will frequently generate unexpected combinations of types for an instruction's inputs and outputs that trigger panics in a backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="340181689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/340181689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#340181689">(Mar 07 2023 at 18:25)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="340681208"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/340681208" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#340681208">(Mar 09 2023 at 18:20)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="340695099"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/340695099" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#340695099">(Mar 09 2023 at 19:29)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="341859797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/341859797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#341859797">(Mar 14 2023 at 17:17)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="341860380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/341860380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#341860380">(Mar 14 2023 at 17:20)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="341879009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/341879009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#341879009">(Mar 14 2023 at 18:48)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="341927877"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/341927877" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#341927877">(Mar 14 2023 at 23:39)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="342108141"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/342108141" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#342108141">(Mar 15 2023 at 16:28)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343178357"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343178357" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343178357">(Mar 20 2023 at 17:08)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343181028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343181028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343181028">(Mar 20 2023 at 17:20)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p><strong>This PR is not ready for review, there are some problems to work out that are outlined below.</strong></p>
<p>Remove the <code>OPCODE_SIGNATURES</code> constant in the function generator, using instead an explicit deny list for avoiding instruction instatiations that we know are problematic. This gives us two things:</p>
<ol>
<li>An explicit list of the instruction instantiations that need fuzzing</li>
<li>All new opcodes will automatically be fuzzed</li>
</ol>
<p>Burning down the list from 1 should be fairly mechanical as we can remove instantiations from the list and see if it fails for a given backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="343181130"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343181130" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343181130">(Mar 20 2023 at 17:20)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p>This PR is rebased on top of #6070, and shouldn't be merged without it.</p>
<p>Remove the <code>OPCODE_SIGNATURES</code> constant in the function generator, using instead an explicit deny list for avoiding instruction instatiations that we know are problematic. This gives us two things:</p>
<ol>
<li>An explicit list of the instruction instantiations that need fuzzing</li>
<li>All new opcodes will automatically be fuzzed</li>
</ol>
<p>Burning down the list from 1 should be fairly mechanical as we can remove instantiations from the list and see if it fails for a given backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="343182889"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343182889" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343182889">(Mar 20 2023 at 17:27)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343186055"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343186055" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343186055">(Mar 20 2023 at 17:41)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343190116"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343190116" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343190116">(Mar 20 2023 at 17:59)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343208639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343208639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343208639">(Mar 20 2023 at 19:24)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343228011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343228011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343228011">(Mar 20 2023 at 21:19)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343238390"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343238390" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343238390">(Mar 20 2023 at 22:31)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343238609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343238609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343238609">(Mar 20 2023 at 22:32)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p>This PR is rebased on top of #6070, and shouldn't be merged without it.</p>
<p>Lazily populate the <code>OPCODE_SIGNATURES</code> constant in the function generator, using an explicit deny list for avoiding instruction instatiations that we know are problematic. This gives us two things:</p>
<ol>
<li>An explicit list of the instruction instantiations that need fuzzing</li>
<li>All new opcodes will automatically be fuzzed</li>
</ol>
<p>Burning down the list from 1 should be fairly mechanical as we can remove instantiations from the list and see if it fails for a given backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="343238656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343238656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343238656">(Mar 20 2023 at 22:33)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p>This PR is rebased on top of #6070, and shouldn't be merged without it.</p>
<p>Lazily populate the <code>OPCODE_SIGNATURES</code> constant in the function generator, using an explicit deny list for avoiding instruction instantiations that we know are problematic. This gives us two things:</p>
<ol>
<li>An explicit list of the instruction instantiations that need fuzzing</li>
<li>All new opcodes will automatically be fuzzed</li>
</ol>
<p>Burning down the list from 1 should be fairly mechanical as we can remove instantiations from the list and see if it fails for a given backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="343243155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343243155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343243155">(Mar 20 2023 at 23:05)</a>:</h4>
<p><strong>elliottt</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> as ready for review.</p>



<a name="343243166"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343243166" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343243166">(Mar 20 2023 at 23:05)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/afonso360">afonso360</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a>.</p>



<a name="343244839"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343244839" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343244839">(Mar 20 2023 at 23:18)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343251348"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343251348" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343251348">(Mar 21 2023 at 00:24)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343261787"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343261787" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343261787">(Mar 21 2023 at 02:20)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343261804"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343261804" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343261804">(Mar 21 2023 at 02:20)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>:</p>
<blockquote>
<p>Lazily populate the <code>OPCODE_SIGNATURES</code> constant in the function generator, using an explicit deny list for avoiding instruction instantiations that we know are problematic. This gives us two things:</p>
<ol>
<li>An explicit list of the instruction instantiations that need fuzzing</li>
<li>All new opcodes will automatically be fuzzed</li>
</ol>
<p>Burning down the list from 1 should be fairly mechanical as we can remove instantiations from the list and see if it fails for a given backend.</p>
<p>Co-authored-by: Jamey Sharp &lt;<a href="mailto:jsharp@fastly.com">jsharp@fastly.com</a>&gt;</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="343344737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343344737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343344737">(Mar 21 2023 at 11:38)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#pullrequestreview-1350217776">PR review</a>.</p>



<a name="343344738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343344738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343344738">(Mar 21 2023 at 11:38)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#pullrequestreview-1350217776">PR review</a>.</p>



<a name="343344739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343344739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343344739">(Mar 21 2023 at 11:38)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#discussion_r1143232276">PR review comment</a>:</p>
<blockquote>
<p>What do you think about using the <code>exceptions!</code> macro here? I think it could improve readability</p>
</blockquote>



<a name="343344741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343344741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343344741">(Mar 21 2023 at 11:38)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#discussion_r1143238986">PR review comment</a>:</p>
<blockquote>
<p>If we use <code>exceptions!</code> below, it probably would be fairly easy to move this block into that list, that way Its one less place to look at. (The special opcodes should probably still be rejected here)</p>
</blockquote>



<a name="343458914"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343458914" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343458914">(Mar 21 2023 at 16:15)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#pullrequestreview-1350892608">PR review</a>.</p>



<a name="343458917"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343458917" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343458917">(Mar 21 2023 at 16:15)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#discussion_r1143659825">PR review comment</a>:</p>
<blockquote>
<p>I'll move the ones that haven't been vetted into there, and leave the others with comments about why they're there <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="343458936"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343458936" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343458936">(Mar 21 2023 at 16:15)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#pullrequestreview-1350892780">PR review</a>.</p>



<a name="343458940"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343458940" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343458940">(Mar 21 2023 at 16:15)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5947#discussion_r1143659962">PR review comment</a>:</p>
<blockquote>
<p>I like it!</p>
</blockquote>



<a name="343459737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343459737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343459737">(Mar 21 2023 at 16:18)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343460223"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343460223" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343460223">(Mar 21 2023 at 16:20)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a> from <code>trevor/generate-instruction-table-fuzzgen</code> to <code>main</code>.</p>



<a name="343532438"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235947%20Pick%20argument%20and%20return%20types%20based%20.../near/343532438" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235947.20Pick.20argument.20and.20return.20types.20based.20.2E.2E.2E.html#343532438">(Mar 21 2023 at 22:24)</a>:</h4>
<p>elliottt merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5947">PR #5947</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>