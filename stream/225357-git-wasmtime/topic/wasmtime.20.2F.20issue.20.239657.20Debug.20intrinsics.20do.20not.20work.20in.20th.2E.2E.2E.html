<html>
<head><meta charset="utf-8"><title>wasmtime / issue #9657 Debug intrinsics do not work in th... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html">wasmtime / issue #9657 Debug intrinsics do not work in th...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="483973432"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/483973432" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#483973432">(Nov 22 2024 at 19:04)</a>:</h4>
<p>SingleAccretion opened <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have.</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="483976022"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/483976022" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#483976022">(Nov 22 2024 at 19:23)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have.</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
</blockquote>



<a name="483984545"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/483984545" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#483984545">(Nov 22 2024 at 20:16)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have. And <code>#[export_name]</code> doesn't do anything for executables (<a href="https://github.com/rust-lang/rust/issues/84161">https://github.com/rust-lang/rust/issues/84161</a>).</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
</blockquote>



<a name="483984801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/483984801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#483984801">(Nov 22 2024 at 20:18)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have. And <code>#[export_name]</code> doesn't do anything for executables (<a href="https://github.com/rust-lang/rust/issues/84161">https://github.com/rust-lang/rust/issues/84161</a>).</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
<p>I wonder if we could use the same mechanism that libcalls and use a (dynamically) relocatable DWARF DIE for the debug intrinsics with an explicit entry point address, instead of utilizing the platform-specific symbol lookup mechanisms.</p>
</blockquote>



<a name="483984837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/483984837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#483984837">(Nov 22 2024 at 20:18)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have. And <code>#[export_name]</code> doesn't do anything for executables (<a href="https://github.com/rust-lang/rust/issues/84161">https://github.com/rust-lang/rust/issues/84161</a>).</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
<p>I wonder if we could use the system mechanism that libcalls use via a (dynamically) relocatable DWARF DIE for the debug intrinsics with an explicit entry point address, instead of utilizing the platform-specific symbol lookup mechanisms.</p>
</blockquote>



<a name="484101729"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/484101729" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#484101729">(Nov 23 2024 at 22:37)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have. And <code>#[export_name]</code> doesn't do anything for executables (<a href="https://github.com/rust-lang/rust/issues/84161">https://github.com/rust-lang/rust/issues/84161</a>).</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
<p>I wonder if we could use the system mechanism that libcalls use via a (dynamically) relocatable DWARF DIE for the debug intrinsics with an explicit entry point address, instead of utilizing the platform-specific symbol lookup mechanisms.</p>
<p>Edit: working on this...</p>
</blockquote>



<a name="484101840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/484101840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#484101840">(Nov 23 2024 at 22:39)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have. And <code>#[export_name]</code> doesn't do anything for executables (<a href="https://github.com/rust-lang/rust/issues/84161">https://github.com/rust-lang/rust/issues/84161</a>).</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
<p>I wonder if we could use the mechanism that libcalls use via a (dynamically) relocatable DWARF DIE for the debug intrinsics with an explicit entry point address, instead of utilizing the platform-specific symbol lookup mechanisms.</p>
<p>Edit: working on this...</p>
</blockquote>



<a name="484333358"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/484333358" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#484333358">(Nov 25 2024 at 15:38)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/9657#issuecomment-2498360029">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Oh dear, thanks for finding this! I see you're working on this but wanted to leave a comment as well saying I like the idea of using the relocation phase for dwarf for this to avoid needing to deal with symbols <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="484727844"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/484727844" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#484727844">(Nov 27 2024 at 14:00)</a>:</h4>
<p>SingleAccretion <a href="https://github.com/bytecodealliance/wasmtime/issues/9657#issuecomment-2503954491">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>This has turned out to be a trickier problem than initially anticipated.</p>
<p>The expression evaluator (in LLDB) evaluates expression by compiling them to C++ in a context of an AST rehydrated from DWARF. It means that even if the DWARF spec has many interesting facilities in it that could help solve this issue (e. g. <code>DW_TAG_entry_point</code>, <code>DW_AT_vtable_elem_location</code>), what we can actually use must be representable in C++ source, with just a little bit of wiggle room left with location descriptors.</p>
<p>What I have experimented with then, is describing wasmtime's code in the generated DWARF by adding a small CU that describes the debug intrinsics with <code>low_pc/high_pc</code> ranges. It works, however, I don't think it is an acceptable solution because:<br>
1) We can't describe the ranges faithfully (no way to know the length of Rust functions).<br>
2) The generated CU may conflict with actual CUs generated by rustc on platforms where DWARF is the default DI format.</p>
<p>A way to salvage this approach is to include generated trampolines that would <code>jmp</code> to the debug intrinsics into the overall module, but that would not be very satisfying.</p>
<p>Another angle I explored is using virtual functions to bypass symbol names. However, that also won't work because LLDB hardcodes the assumption that a C++ class will have the vtable as the first field at a zero offset.</p>
</blockquote>



<a name="485706180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239657%20Debug%20intrinsics%20do%20not%20work%20in%20th.../near/485706180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239657.20Debug.20intrinsics.20do.20not.20work.20in.20th.2E.2E.2E.html#485706180">(Dec 02 2024 at 20:48)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/9657">issue #9657</a>:</p>
<blockquote>
<p>Reproduction:</p>
<p>1) Obtain <code>wasmtime.exe</code> from the released artifacts. You will also need LLDB.<br>
2) Run: <code>lldb wasmtime -Ddebug-info -Oopt-level=0 &lt;any WASM file with debug info&gt;</code>.<br>
3) Place a breakpoint on any WASM frame.<br>
4) Execute <code>p __vmctx-&gt;set()</code>.</p>
<p>Expected result: it works.<br>
Actual result:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">Couldn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">symbols</span><span class="p">:</span>
<span class="w">  </span><span class="nc">set_vmctx_memory_27_0_0</span>
</code></pre></div>
<p>This is because the symbol is not present anywhere visible to LLDB. On Unix-likes it will be in the symbol table, which Windows doesn't have. And <code>#[export_name]</code> doesn't do anything for executables (<a href="https://github.com/rust-lang/rust/issues/84161">https://github.com/rust-lang/rust/issues/84161</a>).</p>
<p><code>(lldb) image dump symtab wasmtime.exe</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Symtab</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="err">\</span><span class="n">Wasmtime</span><span class="err">\</span><span class="n">bin</span><span class="err">\</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="w"> </span><span class="n">num_symbols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">               </span><span class="nc">Debug</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">|</span><span class="n">Synthetic</span><span class="w"> </span><span class="n">symbol</span>
<span class="w">               </span><span class="o">||</span><span class="n">Externally</span><span class="w"> </span><span class="n">Visible</span>
<span class="w">               </span><span class="o">|||</span>
<span class="n">Index</span><span class="w">   </span><span class="n">UserID</span><span class="w"> </span><span class="n">DSX</span><span class="w"> </span><span class="n">Type</span><span class="w">            </span><span class="n">File</span><span class="w"> </span><span class="n">Address</span><span class="o">/</span><span class="n">Value</span><span class="w"> </span><span class="n">Load</span><span class="w"> </span><span class="n">Address</span><span class="w">       </span><span class="n">Size</span><span class="w">               </span><span class="n">Flags</span><span class="w">      </span><span class="n">Name</span>
<span class="o">-------</span><span class="w"> </span><span class="o">------</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="o">---------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">------------------</span><span class="w"> </span><span class="o">----------</span><span class="w"> </span><span class="o">----------------------------------</span>
<span class="p">[</span><span class="w">    </span><span class="mi">0</span><span class="p">]</span><span class="w">      </span><span class="mi">1</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Data</span><span class="w">            </span><span class="mh">0x0000000141b396c0</span><span class="w"> </span><span class="mh">0x00007ff7f9b996c0</span><span class="w"> </span><span class="mh">0x0000000000005fb8</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_descriptor</span>
<span class="p">[</span><span class="w">    </span><span class="mi">1</span><span class="p">]</span><span class="w">      </span><span class="mi">2</span><span class="w">   </span><span class="n">X</span><span class="w"> </span><span class="n">Code</span><span class="w">            </span><span class="mh">0x0000000141158dc0</span><span class="w"> </span><span class="mh">0x00007ff7f91b8dc0</span><span class="w"> </span><span class="mh">0x0000000000161ec0</span><span class="w"> </span><span class="mh">0x00000000</span><span class="w"> </span><span class="n">__jit_debug_register_code</span>
</code></pre></div>
<p>Of note is the fact that if you build wasmtime locally, this works fine because LLDB synthesizes symbols using wasmtime's PDB.</p>
<p>I wonder if we could use the mechanism that libcalls use via a (dynamically) relocatable DWARF DIE for the debug intrinsics with an explicit entry point address, instead of utilizing the platform-specific symbol lookup mechanisms.</p>
<p>Edit: working on this...</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>