<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6176 Various cranelift interpreter impr... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236176.20Various.20cranelift.20interpreter.20impr.2E.2E.2E.html">wasmtime / issue #6176 Various cranelift interpreter impr...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="347697000"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236176%20Various%20cranelift%20interpreter%20impr.../near/347697000" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236176.20Various.20cranelift.20interpreter.20impr.2E.2E.2E.html#347697000">(Apr 07 2023 at 15:57)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/6176#issuecomment-1500412858">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6176">issue #6176</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/issues/5793">https://github.com/bytecodealliance/wasmtime/issues/5793</a> is for the Value type generic, right? Not for the State trait. In cg_clif's usage I give the interpreted code direct access to the compiler's address space. For this I implemented the checked_load and checked_store methods of the State trait. I also needed to change a couple of other methods compared to InterpreterState to allow accessing data objects, to allow directly reading functions and data objects from a Module implementation that can be serialized and deserialized and to allow specifying arbitrary rust code to handle libc function calls. The last thing depends on a cranelift-interpreter change I haven't opened a PR for yet.</p>
<p>As for the exact use case of cg_clif, currently I used it to prototype exception support in cranelift (for my bachelor thesis) without having to immediately implement it in any backend. This allowed me to discover several optimization passes that needed changes. But even outside this I will probably want to land support for the interpreter in cg_clif.</p>
</blockquote>



<a name="347702398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236176%20Various%20cranelift%20interpreter%20impr.../near/347702398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236176.20Various.20cranelift.20interpreter.20impr.2E.2E.2E.html#347702398">(Apr 07 2023 at 16:28)</a>:</h4>
<p>afonso360 <a href="https://github.com/bytecodealliance/wasmtime/pull/6176#issuecomment-1500440105">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6176">issue #6176</a>:</p>
<blockquote>
<p>Oh, that's right! I had it in my mind that it was about both since the only other user of <code>State</code> was <code>ImmutableRegisterState</code> which was used for SCCP (I think!), but it looks like that issue only covers <code>Value</code>.</p>
<p>I think we should probably revisit this when we start making progress on <a href="https://github.com/bytecodealliance/wasmtime/issues/5793">https://github.com/bytecodealliance/wasmtime/issues/5793</a>, just to make sure we can keep folks happy. Thanks for sharing!</p>
<blockquote>
<p>As for the exact use case of cg_clif, currently I used it to prototype exception support in cranelift (for my bachelor thesis) without having to immediately implement it in any backend. This allowed me to discover several optimization passes that needed changes. But even outside this I will probably want to land support for the interpreter in cg_clif.</p>
</blockquote>
<p>Wow! This is an awesome use case! I look forward to reading that! <span aria-label="rocket" class="emoji emoji-1f680" role="img" title="rocket">:rocket:</span> </p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>