<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3876 Add support for `async` call hooks · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html">wasmtime / PR #3876 Add support for `async` call hooks</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="273897375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273897375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273897375">(Mar 02 2022 at 23:46)</a>:</h4>
<p>acw opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>:</p>
<blockquote>
<p>The present runtime supports the ability to add aspect-like hooks to wasm entrance/exit via the <code>call_hook</code> method. In some cases, it can be useful to have this hook do asynchronous operations; to acquire a lock, for example.</p>
<p>This patch series provides an alternate way for users to provide a call hook that mirrors the resource limiter callbacks. To get around some trickiness with Rust types, closures, and Futures, <code>call_hook_async</code> takes an object on which a simple trait is implemented. This hook is then executed using the existing <code>block_on</code> mechanism.</p>
<p>Beyond just adding this capability, this patch makes two other changes to the code base to avoid an error condition in which one of these tasks becomes scheduled right as an async fiber is being dropped. The first changes the <code>async_cx</code> method so that it returns <code>Option&lt;AsyncCx&gt;</code> instead of just <code>AsyncCx</code>; this can be an early detection mechanism for the fiber being dropped. The more key one is a late check in <code>block_on</code>, which turns a former-panic into being a catchable an error condition.</p>
<p>Many thanks to @alexcrichton, who figured out the "resuming a task on a dying thread" issue.</p>
</blockquote>



<a name="273907445"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273907445" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273907445">(Mar 03 2022 at 01:24)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="273992986"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992986" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992986">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-899112663">PR review</a>.</p>



<a name="273992987"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992987" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992987">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818788768">PR review comment</a>:</p>
<blockquote>
<p>Same as above I think this is best done as <code>.expect()</code> since it would be bad if wasm were able to execute and only caught it when an import happened.</p>
</blockquote>



<a name="273992988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992988">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818788194">PR review comment</a>:</p>
<blockquote>
<p>For this I think it's ok to do <code>.expect()</code> because any trap raised from cancellation of a fiber should not be catch-able by wasm and wasm should never be able to initiate a call of an async import.</p>
</blockquote>



<a name="273992989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992989">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818794073">PR review comment</a>:</p>
<blockquote>
<p>Instead of returning a trap could this return <code>Ok(())</code>, perhaps with an assert that this is <code>CallHook::ExitingWasm</code> (I forget the precise name) since I think we should be guaranteed that the hook is only used in that one direction.</p>
<p>Additionally when I stop to think about this I think it's a small preexisting bug today where when a fiber is being torn down we shouldn't execute any user-provided code on the fiber, instead only destructors. Right now though if you have a synchronous call-hook installed then we'll still run the synchronous call hook when exiting wasm.</p>
<p>To handle that, perhaps my above comment about moving <code>self.inner.async_cx()</code> down here isn't so applicable. Perhaps if async support is enabled and if the cx isn't available then <code>Ok(())</code> is unconditionally returned to avoid calling any hook infrastructure? (also having the assert about <code>s: CallHook</code> I think)</p>
</blockquote>



<a name="273992990"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992990" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992990">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818788943">PR review comment</a>:</p>
<blockquote>
<p>Ditto to above</p>
</blockquote>



<a name="273992991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992991">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818790774">PR review comment</a>:</p>
<blockquote>
<p>Is this still applicable? It looks like <code>self.inner.async_cx()</code> is disjoint from <code>self.call_hook</code> which is part of the <code>match</code> so I think this should be able to move in to the <code>Async</code> block below?</p>
</blockquote>



<a name="273992992"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992992" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992992">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-899112663">PR review</a>.</p>



<a name="273992993"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992993" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992993">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818795487">PR review comment</a>:</p>
<blockquote>
<p>Like the above for <code>Func::new</code> I think this is safe to <code>.expect()</code> and/or <code>.unwrap()</code> since it should be impossible to hit this with a <code>None</code> </p>
</blockquote>



<a name="273992994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992994">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818791177">PR review comment</a>:</p>
<blockquote>
<p>FWIW if you so desire you can get rid of the pesky <code>ref mut</code> on <code>ref mut hook</code> by having the match expression be <code>&amp;mut self.call_hook</code></p>
</blockquote>



<a name="273992995"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992995" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992995">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818794778">PR review comment</a>:</p>
<blockquote>
<p>Could you add some documentation to this function as to why <code>Option</code> is the return value? (notably pointing out as well that this panics if <code>async_support</code> is not enabled, whereas the signature might naively appear to return <code>None</code> if async support is not enabled)</p>
</blockquote>



<a name="273992996"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992996" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992996">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818797347">PR review comment</a>:</p>
<blockquote>
<p>Ditto to other places, it's ok to <code>.unwrap()</code> here</p>
</blockquote>



<a name="273992997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992997">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818796873">PR review comment</a>:</p>
<blockquote>
<p>I don't think that this is necessary because the <code>suspend()</code> call below will return an <code>Err(())</code> which will propagate the error outwards as soon as it's seen with <code>res?</code>, meaning that we still shouldn't ever reach this spot with a null <code>poll_cx</code> and if we do its indicative of a bug elsewhere</p>
</blockquote>



<a name="273992998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992998">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818789055">PR review comment</a>:</p>
<blockquote>
<p>Ditto to above</p>
</blockquote>



<a name="273992999"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/273992999" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#273992999">(Mar 03 2022 at 15:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818797542">PR review comment</a>:</p>
<blockquote>
<p>Ditto to above</p>
</blockquote>



<a name="274021563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274021563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274021563">(Mar 03 2022 at 19:00)</a>:</h4>
<p>aturon created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r818976185">PR review comment</a>:</p>
<blockquote>
<p>One worry here: <code>async_trait</code> means this will be using a <code>Box</code> under the hood, which means we incur an allocation for every hook invocation, i.e. two times per hostcall.</p>
<p>A different factoring might allow us to allocate once up front (for the hook itself), basically by making this a <code>poll</code>-style function rather than an <code>async fn</code>.</p>
<p>How worried are we about these costs? AIUI we care a lot about host/guest boundary crossing being cheap.</p>
</blockquote>



<a name="274021564"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274021564" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274021564">(Mar 03 2022 at 19:00)</a>:</h4>
<p>aturon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-899392300">PR review</a>.</p>



<a name="274031827"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274031827" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274031827">(Mar 03 2022 at 20:08)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-899461177">PR review</a>.</p>



<a name="274031828"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274031828" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274031828">(Mar 03 2022 at 20:08)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r819024960">PR review comment</a>:</p>
<blockquote>
<p>Oh that's actually a good point! I haven't ever done benchmarking myself about the costs with call hooks enabled, but I suspect that even as-is it's already at least an order of magnitude slower than "raw" syscalls. That being said though even when wiggle is layered on top I suspect it's even slower as we haven't done much work to optimize wiggle bits (I know there's a <code>Mutex</code> somewhere right now frobbed on all entrances and exits, but the mutex is always un-contended). In that sense it might be good to benchmark this locally in something like Viceroy perhaps and see if the overhead is meaningful?</p>
</blockquote>



<a name="274041114"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274041114" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274041114">(Mar 03 2022 at 21:15)</a>:</h4>
<p>aturon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-899523801">PR review</a>.</p>



<a name="274041115"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274041115" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274041115">(Mar 03 2022 at 21:15)</a>:</h4>
<p>aturon created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r819068391">PR review comment</a>:</p>
<blockquote>
<p>Gotcha. Seems like it'd be interesting data to have around -- comparing no call hook, sync call hook, and async call hook.</p>
</blockquote>



<a name="274174636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274174636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274174636">(Mar 04 2022 at 19:04)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-900601629">PR review</a>.</p>



<a name="274174637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274174637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274174637">(Mar 04 2022 at 19:04)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r819833130">PR review comment</a>:</p>
<blockquote>
<p>To assist in poking around with performance bits I wrote up <a href="https://github.com/bytecodealliance/wasmtime/pull/3883">https://github.com/bytecodealliance/wasmtime/pull/3883</a> which should be a good spot we can insert an async call hook and see the performance. My expectation is that given how slow most async things already are an extra allocation here isn't going to really be all that expensive. For comparison calling into wasm itself is on the order of microseconds instead of nanoseconds because of how our stack management currently works. Calling into the host already allocates a <code>Box</code>'d future per call so allocating 2 more probably isn't the end of the world.</p>
</blockquote>



<a name="274447727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447727">(Mar 07 2022 at 19:50)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="274447879"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447879" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447879">(Mar 07 2022 at 19:51)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902178602">PR review</a>.</p>



<a name="274447881"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447881" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447881">(Mar 07 2022 at 19:51)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821050376">PR review comment</a>:</p>
<blockquote>
<p>Cool. I've pulled these checks and replaced them with <code>expect()</code> (mostly; a couple <code>unwrap</code>s) in a775e97.</p>
</blockquote>



<a name="274447920"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447920" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447920">(Mar 07 2022 at 19:51)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902179052">PR review</a>.</p>



<a name="274447921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447921">(Mar 07 2022 at 19:51)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821050669">PR review comment</a>:</p>
<blockquote>
<p>Addressed in a775e97.</p>
</blockquote>



<a name="274447973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447973">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902179182">PR review</a>.</p>



<a name="274447974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447974">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821050751">PR review comment</a>:</p>
<blockquote>
<p>Addressed in a775e97.</p>
</blockquote>



<a name="274447987"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447987" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447987">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902179300">PR review</a>.</p>



<a name="274447988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274447988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274447988">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821050861">PR review comment</a>:</p>
<blockquote>
<p>Addressed in a775e97.</p>
</blockquote>



<a name="274448008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274448008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274448008">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902179498">PR review</a>.</p>



<a name="274448009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274448009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274448009">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821051013">PR review comment</a>:</p>
<blockquote>
<p>Addressed in a775e97.</p>
</blockquote>



<a name="274448023"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274448023" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274448023">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821051105">PR review comment</a>:</p>
<blockquote>
<p>Addressed in a775e97.</p>
</blockquote>



<a name="274448024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274448024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274448024">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902179658">PR review</a>.</p>



<a name="274448039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274448039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274448039">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902179792">PR review</a>.</p>



<a name="274448041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274448041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274448041">(Mar 07 2022 at 19:52)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821051197">PR review comment</a>:</p>
<blockquote>
<p>Addressed in a775e97.</p>
</blockquote>



<a name="274455109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274455109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274455109">(Mar 07 2022 at 20:49)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902236323">PR review</a>.</p>



<a name="274455110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274455110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274455110">(Mar 07 2022 at 20:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821090950">PR review comment</a>:</p>
<blockquote>
<p>From the benchmark added there the host-calling-wasm case has negligible overhead with this design of async hooks because the cost of that transition is on the order of a microsecond where the allocations here are more like nanoseconds. I think setting up the stack and unconditionally doing a context switch is probably the expensive part.</p>
<p>For wasm-calling-host this imposes a ~40ns overhead. If the host function is defined via <code>Func::wrap</code> ("typed" and "synchronous") then the sync hook vs async hook is 7ns vs 46ns. For functiosn defined via <code>Func::wrapN_async</code> ("typed" and async) then the sync hook vs async hook is 29ns vs 69ns.</p>
<p>Now whether those specific numbers make sense in a broader context I'm not sure, but I would suspect that most of the cost is indeed the allocation of the returned future from this trait.</p>
</blockquote>



<a name="274458475"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274458475" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274458475">(Mar 07 2022 at 21:14)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="274458612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274458612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274458612">(Mar 07 2022 at 21:15)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902261726">PR review</a>.</p>



<a name="274458614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274458614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274458614">(Mar 07 2022 at 21:15)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821108767">PR review comment</a>:</p>
<blockquote>
<p>Yes, seems right. Also, moving it removes an unnecessary test if the <code>async</code> feature is set but we're not actually using <code>async</code> callbacks.</p>
<p>This code was mirrored from <code>memory_growing</code>, so I've updated that function, too.</p>
<p>Addressed in fdbd3b9.</p>
</blockquote>



<a name="274459424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274459424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274459424">(Mar 07 2022 at 21:20)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902266773">PR review</a>.</p>



<a name="274459425"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274459425" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274459425">(Mar 07 2022 at 21:20)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821112413">PR review comment</a>:</p>
<blockquote>
<p>Let me put together a more generic test case for all of this, and make sure that everything still works if I remove this check. My memory is that this is the check that actually made sure things work, but let me confirm that. (I had a few different tests and validation runs, and I might be conflating two of them.)</p>
</blockquote>



<a name="274459824"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274459824" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274459824">(Mar 07 2022 at 21:23)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902269430">PR review</a>.</p>



<a name="274459826"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274459826" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274459826">(Mar 07 2022 at 21:23)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821114423">PR review comment</a>:</p>
<blockquote>
<p>Is there any reason not to just make the check be for both conditions (i.e., we have <code>async_support</code> and we're not being torn down), rather than panicking if <code>async_support</code> is not enabled?</p>
</blockquote>



<a name="274460286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274460286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274460286">(Mar 07 2022 at 21:26)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="274460359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274460359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274460359">(Mar 07 2022 at 21:27)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-902272844">PR review</a>.</p>



<a name="274460360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274460360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274460360">(Mar 07 2022 at 21:27)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821116978">PR review comment</a>:</p>
<blockquote>
<p>(I've added the basic docs, with the panic sill allowed, in 09d62a4)</p>
</blockquote>



<a name="274482567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274482567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274482567">(Mar 08 2022 at 01:06)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="274560705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274560705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274560705">(Mar 08 2022 at 15:59)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-903221609">PR review</a>.</p>



<a name="274560706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274560706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274560706">(Mar 08 2022 at 15:59)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-903221609">PR review</a>.</p>



<a name="274560707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274560707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274560707">(Mar 08 2022 at 15:59)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821811216">PR review comment</a>:</p>
<blockquote>
<p>FWIW this might be a bit easier to do with <code>inst.get_typed_func::&lt;(), (), _&gt;(&amp;mut store, "export")</code></p>
</blockquote>



<a name="274560708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274560708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274560708">(Mar 08 2022 at 15:59)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821812299">PR review comment</a>:</p>
<blockquote>
<p>I think this ends up meaning that this test spin-loops for 2 seconds, right? If so could that instead be changed to something like "after 200 calls into the host return a trap" or similar? (ideally good to avoid having tests take too long)</p>
</blockquote>



<a name="274560709"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/274560709" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#274560709">(Mar 08 2022 at 15:59)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r821809552">PR review comment</a>:</p>
<blockquote>
<p>Stylistic nit, but this can be <code>struct HandlerR;</code> (no need for the <code>{}</code>)</p>
</blockquote>



<a name="276273184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276273184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276273184">(Mar 23 2022 at 00:25)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="276273667"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276273667" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276273667">(Mar 23 2022 at 00:29)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-918039977">PR review</a>.</p>



<a name="276273668"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276273668" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276273668">(Mar 23 2022 at 00:29)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r832737254">PR review comment</a>:</p>
<blockquote>
<p>It turns out that the upstream check that required this test (the one in <code>async_cx()</code>) was not complete enough, necessitating this check. The updated version of <code>async_cx</code> in b9c035c addresses this issue, and allowed me to remove this code. </p>
</blockquote>



<a name="276274939"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276274939" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276274939">(Mar 23 2022 at 00:39)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="276274975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276274975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276274975">(Mar 23 2022 at 00:39)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-918044530">PR review</a>.</p>



<a name="276274976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276274976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276274976">(Mar 23 2022 at 00:39)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r832740912">PR review comment</a>:</p>
<blockquote>
<p>Fixed in 207f2e6.</p>
</blockquote>



<a name="276275025"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276275025" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276275025">(Mar 23 2022 at 00:40)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-918044912">PR review</a>.</p>



<a name="276275026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276275026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276275026">(Mar 23 2022 at 00:40)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r832741111">PR review comment</a>:</p>
<blockquote>
<p>Fixed in 207f2e6.</p>
</blockquote>



<a name="276275080"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276275080" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276275080">(Mar 23 2022 at 00:40)</a>:</h4>
<p>acw submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-918044985">PR review</a>.</p>



<a name="276275081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276275081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276275081">(Mar 23 2022 at 00:40)</a>:</h4>
<p>acw created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r832741223">PR review comment</a>:</p>
<blockquote>
<p>Fixed in 207f2e6.</p>
</blockquote>



<a name="276275688"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276275688" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276275688">(Mar 23 2022 at 00:45)</a>:</h4>
<p>acw updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="276341030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276341030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276341030">(Mar 23 2022 at 14:28)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#discussion_r833336509">PR review comment</a>:</p>
<blockquote>
<p>My thinking is that the decision about whether to do something async or not is a higher-level concern than this function, so something shouldn't unconditionally call this and then act on the return value, instead it should have already made some prior decision to call this function and then it acts on the return value as necessary. (plus having two different <code>None</code> states would mean we'd probably have to return some sort of custom enum which is a bit of a pain)</p>
</blockquote>



<a name="276341031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276341031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276341031">(Mar 23 2022 at 14:28)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-918875870">PR review</a>.</p>



<a name="276343973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276343973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276343973">(Mar 23 2022 at 14:47)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a> from <code>acw/call-hook-async-variant</code> to <code>main</code>.</p>



<a name="276344141"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276344141" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276344141">(Mar 23 2022 at 14:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3876#pullrequestreview-918908041">PR review</a>.</p>



<a name="276361360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233876%20Add%20support%20for%20%60async%60%20call%20hooks/near/276361360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233876.20Add.20support.20for.20.60async.60.20call.20hooks.html#276361360">(Mar 23 2022 at 16:29)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3876">PR #3876</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>