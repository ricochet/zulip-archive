<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2542 Debugging of Hand-Written WASM · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html">wasmtime / Issue #2542 Debugging of Hand-Written WASM</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="221531126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221531126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221531126">(Jan 04 2021 at 14:47)</a>:</h4>
<p>Dakror opened <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<p>&lt;!-- Please try to describe precisely what you would like to do in<br>
Cranelift/Wasmtime and/or expect from it. You can answer the questions below if<br>
they're relevant and delete this text before submitting. Thanks for opening an<br>
issue! --&gt;</p>
<h4>Feature</h4>
<p>&lt;!-- What is the feature or code improvement you would like to do in<br>
Cranelift/Wasmtime? --&gt;</p>
<p>As i understand the documentation, wasmtime offers debugging support using DWARF data embedded in wasm binaries.<br>
However this cannot be used when writing / generating raw Webassembly or converting it via wat2wasm. It would therefore be a great feature to add wat-source-level debugging (much like the early Chrome DevTools debugging) to atleast look at the text representation.</p>
<h4>Benefit</h4>
<p>&lt;!-- What is the value of adding this in Cranelift/Wasmtime? --&gt;</p>
<p>This would aid in debugging of immediate wasm code, where a high source representation is unavailable</p>
<h4>Implementation</h4>
<p>&lt;!-- Do you have an implementation plan, and/or ideas for data structures or<br>
algorithms to use? --&gt;</p>
<p>When using a wat2wasm parser or when generating an IR by yourself, you'd need to track the binary locations of your expressions to emit DWARF yourself</p>
<h4>Alternatives</h4>
<p>&lt;!-- Have you considered alternative implementations? If so, how are they<br>
better or worse than your proposal? --&gt;</p>
<p>I've also opened this issue over at binaryen, since this is what I'm using to generate raw WASM (via their C-API). However I think that this feature is generator independent and would best be implemented at the runtime.</p>
</blockquote>



<a name="221562063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221562063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221562063">(Jan 04 2021 at 18:34)</a>:</h4>
<p>yurydelendik <a href="https://github.com/bytecodealliance/wasmtime/issues/2542#issuecomment-754141453">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<p>FWIW, <code>-g</code> generates DWARF info that uses wasm bytecode offset for source locations. See <a href="https://github.com/bytecodealliance/wasmtime/blob/main/tests/all/debug/simulate.rs">https://github.com/bytecodealliance/wasmtime/blob/main/tests/all/debug/simulate.rs</a> </p>
<p>That's what Chrome and Firefox DevTools do, UI do the rest of the WAT magic. </p>
</blockquote>



<a name="221562338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221562338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221562338">(Jan 04 2021 at 18:36)</a>:</h4>
<p>yurydelendik <a href="https://github.com/bytecodealliance/wasmtime/issues/2542#issuecomment-754142594">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<blockquote>
<p>When using a wat2wasm parser or when generating an IR by yourself, you'd need to track the binary locations of your expressions to emit DWARF yourself</p>
</blockquote>
<p>Looks like this is request for the wat2wasm tool(s) and not for wasmtime.</p>
</blockquote>



<a name="221581180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221581180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221581180">(Jan 04 2021 at 21:11)</a>:</h4>
<p>Dakror <a href="https://github.com/bytecodealliance/wasmtime/issues/2542#issuecomment-754221322">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<blockquote>
<p>FWIW, <code>-g</code> generates DWARF info that uses wasm bytecode offset for source locations. See <a href="https://github.com/bytecodealliance/wasmtime/blob/main/tests/all/debug/simulate.rs">https://github.com/bytecodealliance/wasmtime/blob/main/tests/all/debug/simulate.rs</a></p>
<p>That's what Chrome and Firefox DevTools do, UI do the rest of the WAT magic.</p>
</blockquote>
<p>Where am i to specify <code>-g</code>? When compiling wasmtime from source? I don't quite understand. I'm using the Wasm C api + the wasmtime specific functions to embed wasmtime right now.</p>
</blockquote>



<a name="221581664"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221581664" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221581664">(Jan 04 2021 at 21:14)</a>:</h4>
<p>Dakror edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/2542#issuecomment-754221322">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<blockquote>
<p>FWIW, <code>-g</code> generates DWARF info that uses wasm bytecode offset for source locations. See <a href="https://github.com/bytecodealliance/wasmtime/blob/main/tests/all/debug/simulate.rs">https://github.com/bytecodealliance/wasmtime/blob/main/tests/all/debug/simulate.rs</a></p>
<p>That's what Chrome and Firefox DevTools do, UI do the rest of the WAT magic.</p>
</blockquote>
<p>Where am i to specify <code>-g</code>? When compiling wasmtime from source? I don't quite understand. I'm using the Wasm C api + the wasmtime specific functions to embed wasmtime right now, and im setting <code>wasmtime_config_debug_info_set</code> to true.</p>
</blockquote>



<a name="221586566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221586566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221586566">(Jan 04 2021 at 21:57)</a>:</h4>
<p>Dakror <a href="https://github.com/bytecodealliance/wasmtime/issues/2542#issuecomment-754245396">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<p>I've found that this is actually working and my tools werent properly set up. So the only thing that remains is the need for a UI / lookup for the code section offset into WAT code.</p>
</blockquote>



<a name="221586567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232542%20Debugging%20of%20Hand-Written%20WASM/near/221586567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232542.20Debugging.20of.20Hand-Written.20WASM.html#221586567">(Jan 04 2021 at 21:57)</a>:</h4>
<p>Dakror closed <a href="https://github.com/bytecodealliance/wasmtime/issues/2542">Issue #2542</a>:</p>
<blockquote>
<p>&lt;!-- Please try to describe precisely what you would like to do in<br>
Cranelift/Wasmtime and/or expect from it. You can answer the questions below if<br>
they're relevant and delete this text before submitting. Thanks for opening an<br>
issue! --&gt;</p>
<h4>Feature</h4>
<p>&lt;!-- What is the feature or code improvement you would like to do in<br>
Cranelift/Wasmtime? --&gt;</p>
<p>As i understand the documentation, wasmtime offers debugging support using DWARF data embedded in wasm binaries.<br>
However this cannot be used when writing / generating raw Webassembly or converting it via wat2wasm. It would therefore be a great feature to add wat-source-level debugging (much like the early Chrome DevTools debugging) to atleast look at the text representation.</p>
<h4>Benefit</h4>
<p>&lt;!-- What is the value of adding this in Cranelift/Wasmtime? --&gt;</p>
<p>This would aid in debugging of immediate wasm code, where a high source representation is unavailable</p>
<h4>Implementation</h4>
<p>&lt;!-- Do you have an implementation plan, and/or ideas for data structures or<br>
algorithms to use? --&gt;</p>
<p>When using a wat2wasm parser or when generating an IR by yourself, you'd need to track the binary locations of your expressions to emit DWARF yourself</p>
<h4>Alternatives</h4>
<p>&lt;!-- Have you considered alternative implementations? If so, how are they<br>
better or worse than your proposal? --&gt;</p>
<p>I've also opened this issue over at binaryen, since this is what I'm using to generate raw WASM (via their C-API). However I think that this feature is generator independent and would best be implemented at the runtime.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>