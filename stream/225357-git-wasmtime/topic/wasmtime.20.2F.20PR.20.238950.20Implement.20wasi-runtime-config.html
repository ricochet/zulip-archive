<html>
<head><meta charset="utf-8"><title>wasmtime / PR #8950 Implement wasi-runtime-config · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html">wasmtime / PR #8950 Implement wasi-runtime-config</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="451131931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451131931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451131931">(Jul 13 2024 at 06:21)</a>:</h4>
<p>iawia002 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a> from <code>iawia002:wasi-runtime-config</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Part of <a href="https://github.com/bytecodealliance/wasmtime/issues/8929">https://github.com/bytecodealliance/wasmtime/issues/8929</a>, the integration of <code>wasmtime-cli</code> will be implemented in the next separate PR.</p>
<p>close <a href="https://github.com/bytecodealliance/wasmtime/pull/8939">https://github.com/bytecodealliance/wasmtime/pull/8939</a><br>
close <a href="https://github.com/bytecodealliance/wasmtime/pull/8928">https://github.com/bytecodealliance/wasmtime/pull/8928</a></p>
<p>cc @alexcrichton </p>
</blockquote>



<a name="451131932"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451131932" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451131932">(Jul 13 2024 at 06:21)</a>:</h4>
<p><strong>iawia002</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451131933"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451131933" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451131933">(Jul 13 2024 at 06:21)</a>:</h4>
<p><strong>iawia002</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451131934"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451131934" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451131934">(Jul 13 2024 at 06:21)</a>:</h4>
<p><strong>iawia002</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451133005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451133005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451133005">(Jul 13 2024 at 06:38)</a>:</h4>
<p>iawia002 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451135385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451135385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451135385">(Jul 13 2024 at 07:03)</a>:</h4>
<p>iawia002 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451600530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451600530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451600530">(Jul 15 2024 at 19:11)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2178460178">PR review</a>:</p>
<blockquote>
<p>Thanks! This all looks good to me.</p>
<p>Could this also get hooked up to the CLI as well? Under perhaps <code>-Sruntime-config</code> and/or some other <code>-S</code> flags for the actual keys themselves?</p>
</blockquote>



<a name="451600531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451600531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451600531">(Jul 15 2024 at 19:11)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2178460178">PR review</a>:</p>
<blockquote>
<p>Thanks! This all looks good to me.</p>
<p>Could this also get hooked up to the CLI as well? Under perhaps <code>-Sruntime-config</code> and/or some other <code>-S</code> flags for the actual keys themselves?</p>
</blockquote>



<a name="451600533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451600533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451600533">(Jul 15 2024 at 19:11)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678277751">PR review comment</a>:</p>
<blockquote>
<p>Could this file also have an assert to ensure that there's a test for all runtime_config tests? Something along the lines of:</p>
<ul>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/de29ce35982eba2060709491309ccc93b397168c/crates/wasi-http/tests/all/main.rs#L117-L124">https://github.com/bytecodealliance/wasmtime/blob/de29ce35982eba2060709491309ccc93b397168c/crates/wasi-http/tests/all/main.rs#L117-L124</a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/de29ce35982eba2060709491309ccc93b397168c/crates/wasi-http/tests/all/async_.rs#L5">https://github.com/bytecodealliance/wasmtime/blob/de29ce35982eba2060709491309ccc93b397168c/crates/wasi-http/tests/all/async_.rs#L5</a></li>
</ul>
</blockquote>



<a name="451601390"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601390" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601390">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2178419814">PR review</a>:</p>
<blockquote>
<p>Thanks! A bunch of stylistic/idiomatic/ergonomic suggestions and nitpicks below, but this looks good, and we should be able to land it shortly after those things are addressed.</p>
</blockquote>



<a name="451601391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601391">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2178419814">PR review</a>:</p>
<blockquote>
<p>Thanks! A bunch of stylistic/idiomatic/ergonomic suggestions and nitpicks below, but this looks good, and we should be able to land it shortly after those things are addressed.</p>
</blockquote>



<a name="451601392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601392">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678266256">PR review comment</a>:</p>
<blockquote>
<p>Is the idea here to separate the configured variables from the per-<code>Store</code> state, so that the variables can be reused across many <code>Store</code>s?</p>
<p>Can you document that fact?</p>
</blockquote>



<a name="451601393"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601393" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601393">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678271697">PR review comment</a>:</p>
<blockquote>
<p>I think it would be more ergonomic and idiomatic to turn this function into a <a href="https://doc.rust-lang.org/nightly/std/iter/trait.FromIterator.html"><code>FromIterator</code></a> trait implementation, derive the <code>Default</code> trait for this type, make <code>new</code> return the default, and also add a <code>fn define(&amp;mut self, key: impl Into&lt;String&gt;, value: impl Into&lt;String&gt;) -&gt; &amp;mut Self</code> builder-style method.</p>
</blockquote>



<a name="451601394"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601394" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601394">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678267867">PR review comment</a>:</p>
<blockquote>
<p>Can you add a top-level doc comment that describes what this crate does, links to the associated WASI proposal, and provides an example of how to use the crate?</p>
<p>Additionally, can you deny missing documentation for this crate?</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>//! top-level docs go here...

#![deny(missing_docs)]

use anyhow::Result;
</code></pre></div><br>
</p>
</blockquote>



<a name="451601395"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601395" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601395">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678272780">PR review comment</a>:</p>
<blockquote>
<p>And then also rename this to <code>WasiRuntimeConfig</code>.</p>
</blockquote>



<a name="451601396"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601396" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601396">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678272279">PR review comment</a>:</p>
<blockquote>
<p>Soft preference to rename this to <code>WasiRuntimeConfigVariables</code>.</p>
</blockquote>



<a name="451601397"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601397" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601397">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678279456">PR review comment</a>:</p>
<blockquote>
<p>Isn't this <code>... + 'static</code> bound going to mean that you can effectively only use <code>WasiRuntimeConfigView&lt;'static&gt;</code>?</p>
<p>If so -- and if the <code>'static</code> bound is necessary, which I think it is -- then instead of using lifetimes and borrows between <code>WasiRuntimeConfigVariables</code> and <code>WasiRuntimeConfig</code>, we should make <code>WasiRuntimeConfig</code> a newtype of <code>Arc&lt;WasiRuntimeConfigVariables&gt;</code>.</p>
</blockquote>



<a name="451601399"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601399" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601399">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678276054">PR review comment</a>:</p>
<blockquote>
<p>And it would also be nice, for convenience, to</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="nb">From</span><span class="o">&lt;&amp;'</span><span class="na">a</span><span class="w"> </span><span class="n">WasiRuntimeConfigVariables</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">WasiRuntimeConfig</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>You might also want to consider</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="w"> </span><span class="n">WasiRuntimeConfig</span><span class="o">&lt;'</span><span class="nb">_</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="sd">/// Create a new, empty runtime configuration.</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">empty</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">WasiRuntimeConfig</span><span class="o">&lt;'</span><span class="nb">static</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="n">EMPTY_VARS</span><span class="p">:</span><span class="w"> </span><span class="nc">WasiRuntimeConfigVariables</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">EMPTY_VARS</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="451601404"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451601404" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451601404">(Jul 15 2024 at 19:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678251902">PR review comment</a>:</p>
<blockquote>
<p>Might as well make this as portable as we can while we are here:</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>#!/usr/bin/env bash
</code></pre></div><br>
</p>
</blockquote>



<a name="451696342"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451696342" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451696342">(Jul 16 2024 at 07:25)</a>:</h4>
<p>iawia002 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451697036"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451697036" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451697036">(Jul 16 2024 at 07:29)</a>:</h4>
<p>iawia002 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2179435189">PR review</a>.</p>



<a name="451697037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451697037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451697037">(Jul 16 2024 at 07:29)</a>:</h4>
<p>iawia002 created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678895978">PR review comment</a>:</p>
<blockquote>
<p>The <code>'static</code> bound is necessary, but this made me think further, since the <code>wasi-runtime-config</code> API is very simple, so I reduced some excessive encapsulation by removing <code>WasiRuntimeConfigVariables</code>/<code>WasiRuntimeConfigCtx</code> and keeping only <code>WasiRuntimeConfig</code>. Now, this problem should no longer exists.</p>
</blockquote>



<a name="451697896"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451697896" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451697896">(Jul 16 2024 at 07:34)</a>:</h4>
<p>iawia002 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2179446823">PR review</a>.</p>



<a name="451697897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451697897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451697897">(Jul 16 2024 at 07:34)</a>:</h4>
<p>iawia002 created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678903313">PR review comment</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Is the idea here to separate the configured variables from the per-<code>Store</code> state, so that the variables can be reused across many <code>Store</code>s?</p>
</blockquote>
</blockquote>
<p>The idea here is very simple: it's just passing some configuration variables from the runtime to the component. I did add some documentation, but it is not described this way. Please check if the current description is reasonable. Feel free to add more comments.</p>
</blockquote>



<a name="451697930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451697930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451697930">(Jul 16 2024 at 07:35)</a>:</h4>
<p>iawia002 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1678903313">PR review comment</a>.</p>



<a name="451699275"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451699275" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451699275">(Jul 16 2024 at 07:43)</a>:</h4>
<p>iawia002 <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#issuecomment-2230236523">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>:</p>
<blockquote>
<blockquote>
<p>Could this also get hooked up to the CLI as well? Under perhaps <code>-Sruntime-config</code> and/or some other <code>-S</code> flags for the actual keys themselves?</p>
</blockquote>
<p>I made some changes based on all the comments except this one, because I plan to add support for the <code>wasi-runtime-config</code> API to <code>wasmtime-cli</code> in a separate PR. Otherwise, this PR would have too many changes, let's focus on the <code>wasi-runtime-config</code> implementation only in this PR.</p>
<p>And I think all comments have been addressed, PTAL.</p>
</blockquote>



<a name="451778743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451778743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451778743">(Jul 16 2024 at 15:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2180523830">PR review</a>.</p>



<a name="451778744"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451778744" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451778744">(Jul 16 2024 at 15:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2180523830">PR review</a>.</p>



<a name="451778745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451778745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451778745">(Jul 16 2024 at 15:00)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1679574306">PR review comment</a>:</p>
<blockquote>
<p>I don't think that this is the signature that you want because it would imply that every time an import is called it would <code>.clone()</code> the entire <code>WasiRuntimeConfig</code> structure which could be pretty expensive.</p>
</blockquote>



<a name="451778746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451778746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451778746">(Jul 16 2024 at 15:00)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1679576405">PR review comment</a>:</p>
<blockquote>
<p>The <code>+ 'static</code> doesn't require <code>&lt;'static&gt;</code> in this case since the <code>+ 'static</code> only applies to the lifetime of the captures of the closure itself. This I think was the desired signature which allows borrowing the config without cloning it on import calls.</p>
</blockquote>



<a name="451910658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451910658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451910658">(Jul 17 2024 at 01:50)</a>:</h4>
<p>iawia002 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="451912054"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451912054" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451912054">(Jul 17 2024 at 01:58)</a>:</h4>
<p>iawia002 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2181717663">PR review</a>.</p>



<a name="451912055"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/451912055" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#451912055">(Jul 17 2024 at 01:58)</a>:</h4>
<p>iawia002 created <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#discussion_r1680304149">PR review comment</a>:</p>
<blockquote>
<p>Yeah, you are right, I did not understand it correctly last time. I made some changes (<a href="https://github.com/bytecodealliance/wasmtime/pull/8950/commits/99b6a113c6a5e13ce3d1a016792b32948ae7d461">https://github.com/bytecodealliance/wasmtime/pull/8950/commits/99b6a113c6a5e13ce3d1a016792b32948ae7d461</a>) and returned to the original <code>WasiRuntimeConfigVariables</code> + <code>WasiRuntimeConfig</code> style. Hope I have understood it correctly this time.</p>
</blockquote>



<a name="452101707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/452101707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#452101707">(Jul 17 2024 at 15:01)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#pullrequestreview-2183202588">PR review</a>.</p>



<a name="452106001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/452106001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#452106001">(Jul 17 2024 at 15:17)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>.</p>



<a name="452125278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/452125278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#452125278">(Jul 17 2024 at 16:31)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#issuecomment-2233724524">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="452221477"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238950%20Implement%20wasi-runtime-config/near/452221477" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238950.20Implement.20wasi-runtime-config.html#452221477">(Jul 18 2024 at 01:08)</a>:</h4>
<p>iawia002 <a href="https://github.com/bytecodealliance/wasmtime/pull/8950#issuecomment-2234991118">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8950">PR #8950</a>:</p>
<blockquote>
<p>Thanks for the review!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>