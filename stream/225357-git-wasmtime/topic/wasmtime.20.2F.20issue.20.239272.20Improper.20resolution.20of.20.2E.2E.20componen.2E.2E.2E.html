<html>
<head><meta charset="utf-8"><title>wasmtime / issue #9272 Improper resolution of .. componen... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html">wasmtime / issue #9272 Improper resolution of .. componen...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="471108732"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471108732" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471108732">(Sep 17 2024 at 22:17)</a>:</h4>
<p><a href="https://github.com/neild">neild</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">Issue #9272</a>.</p>



<a name="471108734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471108734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471108734">(Sep 17 2024 at 22:17)</a>:</h4>
<p>neild opened <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>I believe I've run across a bug in wasmtime's handling of symlink targets which include <code>".."</code>. I've reproduced this using the Go program below which calls <code>path_open</code> on a path and reports the result. It's not the simplest test program, but it avoids dependencies and I have a Go compiler handy.</p>
<p>Simple case, no bug:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">file</span>
<span class="cp">$</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">link</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">link</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>
<p>The bug shows up when resolving a link with a target of <code>".."</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">up</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">foo</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">Not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span>
</code></pre></div>
<p>I'm not sure exactly what is going awry, but the "not a directory" error is clearly wrong. Note that we can open <code>b/up</code> (resolves to <code>.</code> as expected). The problem seems to be specific to links that end in <code>..</code>: if we change the link target to <code>../a</code>, everything works as expected:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">a</span>
<span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">/</span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">../</span><span class="n">a</span><span class="w"> </span><span class="n">upa</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">upa</span><span class="o">/</span><span class="n">target</span>
<span class="n">bar</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">upa</span><span class="o">/</span><span class="n">target</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>
<p>Test program:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">main</span>

<span class="n">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="s">"fmt"</span>
<span class="w">        </span><span class="s">"os"</span>
<span class="w">        </span><span class="s">"syscall"</span>
<span class="w">        </span><span class="s">"unsafe"</span>
<span class="p">)</span>

<span class="c1">//go:wasmimport wasi_snapshot_preview1 path_open</span>
<span class="c1">//go:noescape</span>
<span class="n">func</span><span class="w"> </span><span class="n">path_open</span><span class="p">(</span><span class="n">rootFD</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">dirflags</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">,</span><span class="w"> </span><span class="n">pathLen</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">oflags</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">fsRightsBase</span><span class="w"> </span><span class="n">uint64</span><span class="p">,</span><span class="w"> </span><span class="n">fsRightsInheriting</span><span class="w"> </span><span class="n">uint64</span><span class="p">,</span><span class="w"> </span><span class="n">fsFlags</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">)</span><span class="w"> </span><span class="n">uint32</span>

<span class="k">const</span><span class="w"> </span><span class="n">LOOKUP_SYMLINK_FOLLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="n">func</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">filename</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">        </span><span class="n">var</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="n">int32</span>
<span class="w">        </span><span class="n">errno</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">path_open</span><span class="p">(</span>
<span class="w">                </span><span class="n">int32</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">Fd</span><span class="p">()),</span>
<span class="w">                </span><span class="n">syscall</span><span class="p">.</span><span class="n">LOOKUP_SYMLINK_FOLLOW</span><span class="p">,</span>
<span class="w">                </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">(</span><span class="k">unsafe</span><span class="p">.</span><span class="n">StringData</span><span class="p">(</span><span class="n">filename</span><span class="p">)),</span>
<span class="w">                </span><span class="n">uint32</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)),</span>
<span class="w">                </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="n">syscall</span><span class="p">.</span><span class="n">RIGHT_FD_READ</span><span class="p">,</span>
<span class="w">                </span><span class="n">syscall</span><span class="p">.</span><span class="n">RIGHT_FD_READ</span><span class="p">,</span>
<span class="w">                </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fd</span><span class="p">),</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">fmt</span><span class="p">.</span><span class="n">Println</span><span class="p">(</span><span class="n">syscall</span><span class="p">.</span><span class="n">Errno</span><span class="p">(</span><span class="n">errno</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="471801400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471801400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471801400">(Sep 20 2024 at 18:25)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2364291267">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>Thanks for the report! Would you be able to gist exactly what <code>wasmtime</code> command is being used? You're using <code>go run</code> but it's not clear to me what exactly <code>wasmtime</code> is doing. Locally I can't seem to reproduce this with what I believe is an equivalent Rust program:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">rs</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span>
<span class="w">        </span><span class="s">"{:?}"</span><span class="p">,</span>
<span class="w">        </span><span class="n">std</span><span class="p">::</span><span class="n">fs</span><span class="p">::</span><span class="n">File</span><span class="p">::</span><span class="n">open</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">env</span><span class="p">::</span><span class="n">args</span><span class="p">().</span><span class="n">nth</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">unwrap</span><span class="p">())</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">$</span><span class="w"> </span><span class="n">rustc</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="o">--</span><span class="n">target</span><span class="w"> </span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasip1</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">a</span>
<span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">/</span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">../</span><span class="n">a</span><span class="w"> </span><span class="n">upa</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">upa</span><span class="o">/</span><span class="n">target</span>
<span class="n">bar</span>
<span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">upa</span><span class="o">/</span><span class="n">target</span>
<span class="nb">Ok</span><span class="p">(</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">fd</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">})</span>
<span class="cp">$</span><span class="w"> </span><span class="n">ls</span>
<span class="n">a</span><span class="w">  </span><span class="n">b</span><span class="w">  </span><span class="n">foo</span><span class="p">.</span><span class="n">rs</span><span class="w">  </span><span class="n">foo</span><span class="p">.</span><span class="n">wasm</span>
<span class="cp">$</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">rf</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">up</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">foo</span>
<span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span>
<span class="nb">Ok</span><span class="p">(</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">fd</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">})</span>
<span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="nb">Ok</span><span class="p">(</span><span class="n">File</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">fd</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">})</span>
<span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">nonexistent</span>
<span class="nb">Err</span><span class="p">(</span><span class="n">Os</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">code</span><span class="p">:</span><span class="w"> </span><span class="mi">44</span><span class="p">,</span><span class="w"> </span><span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="nc">NotFound</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="s">"No such file or directory"</span><span class="w"> </span><span class="p">})</span>
</code></pre></div>
<p>That may mean that the difference boils down to what Rust and Go are doing, and so the next step here would be to narrow in on that and see what's going on. If you're able to upload the Go-generated wasm binary here that would also help too</p>
</blockquote>



<a name="471809001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471809001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471809001">(Sep 20 2024 at 18:56)</a>:</h4>
<p>neild <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2364342911">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>The wasmtime command is from here: <a href="https://go.googlesource.com/go/+/refs/tags/go1.23.0/misc/wasm/go_wasip1_wasm_exec">https://go.googlesource.com/go/+/refs/tags/go1.23.0/misc/wasm/go_wasip1_wasm_exec</a></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="o">=/</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PWD</span><span class="o">=</span><span class="s">"$PWD"</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PATH</span><span class="o">=</span><span class="s">"$PATH"</span><span class="w"> </span><span class="o">-</span><span class="n">W</span><span class="w"> </span><span class="n">max</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">stack</span><span class="o">=</span><span class="mi">1048576</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
</code></pre></div>
<p>Wasm binary I'm using:<br>
<a href="https://github.com/user-attachments/files/17079815/main.wasm.gz">main.wasm.gz</a></p>
</blockquote>



<a name="471829234"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471829234" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471829234">(Sep 20 2024 at 20:38)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2364583630">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>Hm I actually can't seem to reproduce with the binary that you provided. I get:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="o">=/</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PWD</span><span class="o">=</span><span class="s">"$PWD"</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PATH</span><span class="o">=</span><span class="s">"$PATH"</span><span class="w"> </span><span class="o">-</span><span class="n">W</span><span class="w"> </span><span class="n">max</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">stack</span><span class="o">=</span><span class="mi">1048576</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>
<p>which I think means that it's working?</p>
<p>I noticed above sometimes the symlink was called "up" and sometimes it was "upa". I mixed the two up and thought Rust was working and Go wasn't but then when I fixed the name they both worked. Mind double-checking on your end too?</p>
</blockquote>



<a name="471837529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471837529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471837529">(Sep 20 2024 at 21:42)</a>:</h4>
<p>neild <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2364656922">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>Setup:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">up</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">foo</span>
</code></pre></div>
<p>And running:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">version</span>
<span class="n">wasmtime</span><span class="w"> </span><span class="mf">25.0.0</span><span class="w"> </span><span class="p">(</span><span class="mb">0b1</span><span class="mi">95</span><span class="n">ef5d</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="o">=/</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PWD</span><span class="o">=</span><span class="s">"$PWD"</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PATH</span><span class="o">=</span><span class="s">"$PATH"</span><span class="w"> </span><span class="o">-</span><span class="n">W</span><span class="w"> </span><span class="n">max</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">stack</span><span class="o">=</span><span class="mi">1048576</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">Not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span>
</code></pre></div>
<p>This is on macOS. I had thought I'd observed this on macOS and Linux, but I just rechecked and I can't reproduce on Linux. So perhaps macOS-specific?</p>
<p>Or possibly even Linux version specific, if wasmtime uses openat2 with RESOLVE_BENEATH when available.</p>
</blockquote>



<a name="471840507"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471840507" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471840507">(Sep 20 2024 at 22:07)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2364682401">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>Aha the plot thickens! I was indeed testing on Linux. I'll work next week on digging more into macOS, as I suspect you're right this is macOS-specific behavior. </p>
</blockquote>



<a name="471846944"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/471846944" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#471846944">(Sep 20 2024 at 22:48)</a>:</h4>
<p>sunfishcode <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2364724234">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>I can reproduce the problem using cap-std directly with this example:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">io</span><span class="p">::</span><span class="n">Read</span><span class="p">;</span>

<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"b/up/target"</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cap_std</span><span class="p">::</span><span class="n">fs</span><span class="p">::</span><span class="n">Dir</span><span class="p">::</span><span class="n">open_ambient_dir</span><span class="p">(</span><span class="s">"."</span><span class="p">,</span><span class="w"> </span><span class="n">cap_std</span><span class="p">::</span><span class="n">ambient_authority</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dir</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">file</span><span class="p">.</span><span class="n">read_to_string</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">s</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
<span class="w">    </span><span class="fm">eprintln!</span><span class="p">(</span><span class="s">"read: {:?}"</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>If I modify cap-std to avoid using <code>openat2</code>, then I can reproduce the "Not a directory" error even on Linux. I'll investigate further.</p>
</blockquote>



<a name="472585263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/472585263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#472585263">(Sep 24 2024 at 22:57)</a>:</h4>
<p>sunfishcode <a href="https://github.com/bytecodealliance/wasmtime/issues/9272#issuecomment-2372529896">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>I've now submitted #9307 which should fix this issue.</p>
</blockquote>



<a name="472595287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239272%20Improper%20resolution%20of%20..%20componen.../near/472595287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239272.20Improper.20resolution.20of.20.2E.2E.20componen.2E.2E.2E.html#472595287">(Sep 25 2024 at 01:06)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/9272">issue #9272</a>:</p>
<blockquote>
<p>I believe I've run across a bug in wasmtime's handling of symlink targets which include <code>".."</code>. I've reproduced this using the Go program below which calls <code>path_open</code> on a path and reports the result. It's not the simplest test program, but it avoids dependencies and I have a Go compiler handy.</p>
<p>Simple case, no bug:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">file</span>
<span class="cp">$</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">link</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">link</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>
<p>The bug shows up when resolving a link with a target of <code>".."</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">up</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">foo</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">up</span><span class="o">/</span><span class="n">target</span>
<span class="n">Not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">directory</span>
</code></pre></div>
<p>I'm not sure exactly what is going awry, but the "not a directory" error is clearly wrong. Note that we can open <code>b/up</code> (resolves to <code>.</code> as expected). The problem seems to be specific to links that end in <code>..</code>: if we change the link target to <code>../a</code>, everything works as expected:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">a</span>
<span class="cp">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">/</span><span class="n">target</span>
<span class="cp">$</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">b</span>
<span class="cp">$</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ln</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">../</span><span class="n">a</span><span class="w"> </span><span class="n">upa</span><span class="p">)</span>
<span class="cp">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">upa</span><span class="o">/</span><span class="n">target</span>
<span class="n">bar</span>
<span class="cp">$</span><span class="w"> </span><span class="n">GOOS</span><span class="o">=</span><span class="n">wasip1</span><span class="w"> </span><span class="n">GOARCH</span><span class="o">=</span><span class="n">wasm</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="n">go</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">upa</span><span class="o">/</span><span class="n">target</span>
<span class="n">errno</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>
<p>Test program:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">main</span>

<span class="n">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="s">"fmt"</span>
<span class="w">        </span><span class="s">"os"</span>
<span class="w">        </span><span class="s">"syscall"</span>
<span class="w">        </span><span class="s">"unsafe"</span>
<span class="p">)</span>

<span class="c1">//go:wasmimport wasi_snapshot_preview1 path_open</span>
<span class="c1">//go:noescape</span>
<span class="n">func</span><span class="w"> </span><span class="n">path_open</span><span class="p">(</span><span class="n">rootFD</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">dirflags</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">,</span><span class="w"> </span><span class="n">pathLen</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">oflags</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">fsRightsBase</span><span class="w"> </span><span class="n">uint64</span><span class="p">,</span><span class="w"> </span><span class="n">fsRightsInheriting</span><span class="w"> </span><span class="n">uint64</span><span class="p">,</span><span class="w"> </span><span class="n">fsFlags</span><span class="w"> </span><span class="n">uint32</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">)</span><span class="w"> </span><span class="n">uint32</span>

<span class="k">const</span><span class="w"> </span><span class="n">LOOKUP_SYMLINK_FOLLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="n">func</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">panic</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">filename</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">        </span><span class="n">var</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="n">int32</span>
<span class="w">        </span><span class="n">errno</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">path_open</span><span class="p">(</span>
<span class="w">                </span><span class="n">int32</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">Fd</span><span class="p">()),</span>
<span class="w">                </span><span class="n">syscall</span><span class="p">.</span><span class="n">LOOKUP_SYMLINK_FOLLOW</span><span class="p">,</span>
<span class="w">                </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">(</span><span class="k">unsafe</span><span class="p">.</span><span class="n">StringData</span><span class="p">(</span><span class="n">filename</span><span class="p">)),</span>
<span class="w">                </span><span class="n">uint32</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)),</span>
<span class="w">                </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="n">syscall</span><span class="p">.</span><span class="n">RIGHT_FD_READ</span><span class="p">,</span>
<span class="w">                </span><span class="n">syscall</span><span class="p">.</span><span class="n">RIGHT_FD_READ</span><span class="p">,</span>
<span class="w">                </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="k">unsafe</span><span class="p">.</span><span class="n">Pointer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fd</span><span class="p">),</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">fmt</span><span class="p">.</span><span class="n">Println</span><span class="p">(</span><span class="n">syscall</span><span class="p">.</span><span class="n">Errno</span><span class="p">(</span><span class="n">errno</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>