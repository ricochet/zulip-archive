<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9084 riscv64: Refactor Floating Point Inst... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html">wasmtime / PR #9084 riscv64: Refactor Floating Point Inst...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="457120472"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/457120472" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#457120472">(Aug 07 2024 at 14:12)</a>:</h4>
<p>afonso360 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a> from <code>afonso360:riscv-refactor-float</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>This is a refactor to the floating point instruction emission code for RISC-V.</p>
<p>All FP instructions include a 2 bit field that denotes the width of the arguments, from FP16 up to FP128. In the current code that is part of the opcode, and we replicate opcodes between FP32 and FP64.</p>
<p>With this PR we now encode the width on a separate field, and make the opcodes width agnostic, which should simplify the introduction of FP16 and FP128 instructions.</p>
<p>There shouldn't be any bytecode changes with this PR. The one formatting change we have is due to us previously hiding the selected FRM mode for <code>fcvt.d.{w,wu}</code> instructions, which shouldn't have been hidden since, we don't do the same for their <code>fcvt.s</code> variants. Additionally these instructions change their results based on FRM so we should probably show it anyway.</p>
</blockquote>



<a name="457120473"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/457120473" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#457120473">(Aug 07 2024 at 14:12)</a>:</h4>
<p><strong>afonso360</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a>.</p>



<a name="457120477"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/457120477" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#457120477">(Aug 07 2024 at 14:12)</a>:</h4>
<p><strong>afonso360</strong> requested <a href="https://github.com/elliottt">elliottt</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a>.</p>



<a name="457121368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/457121368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#457121368">(Aug 07 2024 at 14:17)</a>:</h4>
<p>afonso360 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a>.</p>



<a name="457121504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/457121504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#457121504">(Aug 07 2024 at 14:18)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>This is a refactor to the floating point instruction emission code for RISC-V.</p>
<p>All FP instructions include a 2 bit field that denotes the width of the arguments, from FP16 up to FP128. In the current code that is part of the opcode, and we duplicate opcodes between FP32 and FP64.</p>
<p>With this PR we now encode the width on a separate field, and make the opcodes width agnostic, which should simplify the introduction of FP16 and FP128 instructions.</p>
<p>There shouldn't be any bytecode changes with this PR. The one formatting change we have is due to us previously hiding the selected FRM mode for <code>fcvt.d.{w,wu}</code> instructions, which shouldn't have been hidden since, we don't do the same for their <code>fcvt.s</code> variants. Additionally these instructions change their results based on FRM so we should probably show it anyway.</p>
</blockquote>



<a name="457153603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/457153603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#457153603">(Aug 07 2024 at 16:46)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/9084#issuecomment-2273893008">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @cfallin, @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift", "cranelift:area:riscv64", "isle"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>cfallin: isle</li>
<li>fitzgen: isle</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="459340419"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/459340419" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#459340419">(Aug 09 2024 at 02:56)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9084#pullrequestreview-2229189991">PR review</a>.</p>



<a name="459342888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239084%20riscv64%3A%20Refactor%20Floating%20Point%20Inst.../near/459342888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239084.20riscv64.3A.20Refactor.20Floating.20Point.20Inst.2E.2E.2E.html#459342888">(Aug 09 2024 at 03:12)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9084">PR #9084</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>