<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6937 Add `Engine::detect_precompiled_file()` · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html">wasmtime / PR #6937 Add `Engine::detect_precompiled_file()`</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="388175505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236937%20Add%20%60Engine%3A%3Adetect_precompiled_file%28%29%60/near/388175505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html#388175505">(Aug 30 2023 at 18:48)</a>:</h4>
<p>acfoltzer opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6937">PR #6937</a> from <code>bytecodealliance:acf/detect-precompiled-file</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This is handy for users of <code>deserialize_file()</code> to determine which version to call.</p>
</blockquote>



<a name="388180133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236937%20Add%20%60Engine%3A%3Adetect_precompiled_file%28%29%60/near/388180133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html#388180133">(Aug 30 2023 at 19:18)</a>:</h4>
<p><strong>acfoltzer</strong> requested <a href="https://github.com/jameysharp">jameysharp</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6937">PR #6937</a>.</p>



<a name="388186018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236937%20Add%20%60Engine%3A%3Adetect_precompiled_file%28%29%60/near/388186018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html#388186018">(Aug 30 2023 at 19:57)</a>:</h4>
<p><strong>jameysharp</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6937">PR #6937</a>.</p>



<a name="388186370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236937%20Add%20%60Engine%3A%3Adetect_precompiled_file%28%29%60/near/388186370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html#388186370">(Aug 30 2023 at 19:59)</a>:</h4>
<p><strong>acfoltzer</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6937">PR #6937</a>.</p>



<a name="388208123"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236937%20Add%20%60Engine%3A%3Adetect_precompiled_file%28%29%60/near/388208123" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html#388208123">(Aug 30 2023 at 22:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6937#pullrequestreview-1603598990">PR review</a>:</p>
<blockquote>
<p>Seems reasonable to me, thanks!</p>
<blockquote>
<p>I had hoped that the <code>from_trusted_file</code> entry-point or similar would suffice to avoid embedders needing to detect for themselves whether they were holding on to a precompiled module</p>
</blockquote>
<p>Ah yeah I tried to use this when I originally refactored the CLI to take components, but the main reason I couldn't use it was that the CLI needed to dispatch to either <code>Component::deserialize</code> or <code>Module::deserialize</code> depending on what the compiled bytes were. I initially hoped to avoid <code>ModuleOrComponent</code> in the <code>wasmtime</code> crate's API but I think <code>from_trusted_file</code> would work there.</p>
<p>Overall at least from the CLI I felt that our API for loading modules/components is still kinda clunky. I couldn't really figure out a better replacement though so I gave up and added <code>detect_precompiled</code>. I'm definitely all-ears though for other suggestions!</p>
</blockquote>



<a name="388212428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236937%20Add%20%60Engine%3A%3Adetect_precompiled_file%28%29%60/near/388212428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236937.20Add.20.60Engine.3A.3Adetect_precompiled_file.28.29.60.html#388212428">(Aug 30 2023 at 23:35)</a>:</h4>
<p>acfoltzer merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6937">PR #6937</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>