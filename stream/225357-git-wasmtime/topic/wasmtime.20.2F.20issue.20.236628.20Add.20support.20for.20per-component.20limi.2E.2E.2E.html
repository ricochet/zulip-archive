<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6628 Add support for per-component limi... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html">wasmtime / issue #6628 Add support for per-component limi...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="368638944"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/368638944" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#368638944">(Jun 22 2023 at 17:10)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>That is, we should be able to reject allocation/instantiation for a component with more instances/tables/etc than a pre-configured limit, even when we actually have that much capacity in the pooling allocator.</p>
</blockquote>



<a name="368638947"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/368638947" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#368638947">(Jun 22 2023 at 17:10)</a>:</h4>
<p>fitzgen labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>That is, we should be able to reject allocation/instantiation for a component with more instances/tables/etc than a pre-configured limit, even when we actually have that much capacity in the pooling allocator.</p>
</blockquote>



<a name="368638949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/368638949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#368638949">(Jun 22 2023 at 17:10)</a>:</h4>
<p>fitzgen labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>That is, we should be able to reject allocation/instantiation for a component with more instances/tables/etc than a pre-configured limit, even when we actually have that much capacity in the pooling allocator.</p>
</blockquote>



<a name="368638950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/368638950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#368638950">(Jun 22 2023 at 17:10)</a>:</h4>
<p>fitzgen labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>That is, we should be able to reject allocation/instantiation for a component with more instances/tables/etc than a pre-configured limit, even when we actually have that much capacity in the pooling allocator.</p>
</blockquote>



<a name="368639088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/368639088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#368639088">(Jun 22 2023 at 17:11)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/6628#issuecomment-1603029487">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>This might exist in <code>InstancePre</code>, need to double check.</p>
</blockquote>



<a name="368639536"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/368639536" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#368639536">(Jun 22 2023 at 17:12)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/6628#issuecomment-1603031688">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>Either way, we should have typed errors for when you try to instantiate a component that lets you determine whether instantiation failed because there is not enough capacity for the component currently, or because the component is statically above the configured per-component limits on tables/memories/etc.</p>
</blockquote>



<a name="369736061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236628%20Add%20support%20for%20per-component%20limi.../near/369736061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236628.20Add.20support.20for.20per-component.20limi.2E.2E.2E.html#369736061">(Jun 26 2023 at 15:03)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/6628#issuecomment-1607673463">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6628">issue #6628</a>:</p>
<blockquote>
<p>Right now this <a href="https://github.com/bytecodealliance/wasmtime/blob/2d34b4657aa5290948da9a07cb31764a12c12994/crates/wasmtime/src/module.rs#L583">exists for modules</a> as <a href="https://github.com/bytecodealliance/wasmtime/blob/2d34b4657aa5290948da9a07cb31764a12c12994/crates/runtime/src/instance/allocator.rs#L91-L95"><code>InstanceAllocator::validate</code></a> and I think the solution here is "just" adding a component version of that. Note though that this is a compile-time check as opposed to a instantiation-time check, so you'd never run into a situation where a component could never be instantiated due to its limits. </p>
<p>That being said I think a descriptive error here is still good to have, since even if a component fits within the limits configured it can still fail to instantiate and it'd be good to understand why.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>