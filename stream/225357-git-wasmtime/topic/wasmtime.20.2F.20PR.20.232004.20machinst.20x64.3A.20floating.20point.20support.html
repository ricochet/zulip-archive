<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2004 machinst x64: floating point support · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html">wasmtime / PR #2004 machinst x64: floating point support</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="204103281"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204103281" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204103281">(Jul 16 2020 at 15:52)</a>:</h4>
<p>bnjbvr edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2004">PR #2004</a> from <code>x64-fp</code> to <code>main</code>:</p>
<blockquote>
<p>Opening this PR as a WIP, to coordinate better with @jlb6740; this lacks proper testing right now. Only the last commit is relevant, the rest comes from #1995.</p>
<p>This implements the following:</p>
<ul>
<li>load/store for floating point values</li>
<li>more binary and unary opcodes</li>
<li>constant generation</li>
</ul>
</blockquote>



<a name="204106773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204106773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204106773">(Jul 16 2020 at 16:17)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2004">PR #2004</a> from <code>x64-fp</code> to <code>main</code>:</p>
<blockquote>
<p>Opening this PR as a WIP, to coordinate better with @jlb6740; this lacks proper testing right now. Only the last commit is relevant, the rest comes from #1995.</p>
<p>This implements the following:</p>
<ul>
<li>load/store for floating point values</li>
<li>more binary and unary opcodes</li>
<li>constant generation</li>
</ul>
</blockquote>



<a name="204107852"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204107852" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204107852">(Jul 16 2020 at 16:25)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2004">PR #2004</a> from <code>x64-fp</code> to <code>main</code>:</p>
<blockquote>
<p>Opening this PR as a WIP, to coordinate better with @jlb6740; this lacks proper testing right now. Only the last commit is relevant, the rest comes from #1995.</p>
<p>This implements the following:</p>
<ul>
<li>load/store for floating point values</li>
<li>more binary and unary opcodes</li>
<li>constant generation</li>
</ul>
</blockquote>



<a name="204186706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186706">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450476634">PR Review</a>.</p>



<a name="204186707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186707">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450476634">PR Review</a>.</p>



<a name="204186708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186708">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456304242">PR Review Comment</a>:</p>
<blockquote>
<p>What does this function do / how does it help?  I can't guess from the name, and reading the code doesn't help much.  Can you add a comment?  Maybe rename it?</p>
</blockquote>



<a name="204186709"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186709" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186709">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456303307">PR Review Comment</a>:</p>
<blockquote>
<p>I look at this (the introduction of <code>is_int</code>) and imagine the day when this needs to be extended again to handle 128-bit vector registers.  That day can't be far off.  In that case even <code>is_int</code> will be inadequate, I guess.  Would it be more future-proof to return a <code>RegClass</code> instead of the <code>bool</code> here?  </p>
</blockquote>



<a name="204186710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186710">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456308305">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, this comment isn't really right.  Is <code>XMM_RM_R</code> only used for scalar floating point?  I would have thought it could be (and, eventually, will be) used for any SSE operation of the form <code>R := OP(R, RM)</code>.</p>
</blockquote>



<a name="204186711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186711">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456308760">PR Review Comment</a>:</p>
<blockquote>
<p>nit: <code>XmmUnary</code> --&gt; <code>XmmUnaryRmR</code></p>
</blockquote>



<a name="204186712"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186712" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186712">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456309930">PR Review Comment</a>:</p>
<blockquote>
<p>nit: "from float to reg/mem" isn't right.  These are stores (they can't be anything else), and AFAIK they could also be stores of the entire vector register, not just the lowest F32 or F64 lane.</p>
</blockquote>



<a name="204186713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186713">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456314729">PR Review Comment</a>:</p>
<blockquote>
<p>As a suggestion, would you consider renaming <code>xmm_to_int</code> to <code>xmm_to_gpr</code> (and the associated data structures?)  The reason is that "xmm" is unambiguously an XMM register.  But "int" isn't so clear; it could mean "integer register" (as you mean here) but it could also be interpreted as "integer value stored in some lane(s) of an XMM register".  <code>_to_gpr</code> removes that ambiguity.</p>
</blockquote>



<a name="204186714"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186714" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186714">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456311042">PR Review Comment</a>:</p>
<blockquote>
<p>What happens to the upper 96/64 bits of the destination?  I don't think it is important for code generation, but it would be nice if what happens was stated here.</p>
</blockquote>



<a name="204186715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186715">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456316382">PR Review Comment</a>:</p>
<blockquote>
<p>Just as a comment .. these assertions are good (I like assertions), but .. won't the <code>emit</code> function eventually assert/panic if the wrong class register is in an instruction field?  I <em>think</em> that's true but I don't remember exactly.  So I think you're safe even without the assert.  (and if the <code>emit</code> fns don't assert/panic in such circumstances, we should fix them so they do; that's the last line of defense against mistakes in register classes).</p>
</blockquote>



<a name="204186716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186716">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456312604">PR Review Comment</a>:</p>
<blockquote>
<p>On reading further down, I see this appears to be used to assert the register class.  Would you consider renaming this to <code>assert_regclass_is</code>?  I'd prefer to avoid the term "register type" since that's not really a concept we have; what we have are the concepts "register class" and "type of the value stored in the register", which may not be the same.  Eg a F32 value in a V128-class register.</p>
</blockquote>



<a name="204186717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186717">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456317506">PR Review Comment</a>:</p>
<blockquote>
<p>isn't it the inverse-of-cc that needs to be printed here?</p>
</blockquote>



<a name="204186718"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186718" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186718">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456318809">PR Review Comment</a>:</p>
<blockquote>
<p>We can probably special-case <code>0.0</code> using <code>xorpd</code> or whatever the official dependency-breaking generate-vector-zero insn is.  But not now; we can come back to this.</p>
</blockquote>



<a name="204186719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186719">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456319289">PR Review Comment</a>:</p>
<blockquote>
<p>Whatever is chosen, make sure it's an officially-recognised dependency-breaking insn.</p>
</blockquote>



<a name="204186720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186720">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456321738">PR Review Comment</a>:</p>
<blockquote>
<p>Can this ever fail for valid input?</p>
</blockquote>



<a name="204186721"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186721" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186721">(Jul 17 2020 at 09:26)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456319058">PR Review Comment</a>:</p>
<blockquote>
<p>Oh, you comment that just below :-)</p>
</blockquote>



<a name="204186794"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186794" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186794">(Jul 17 2020 at 09:27)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450510270">PR Review</a>.</p>



<a name="204186795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204186795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204186795">(Jul 17 2020 at 09:27)</a>:</h4>
<p>julian-seward1 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456329418">PR Review Comment</a>:</p>
<blockquote>
<p>Oh, maybe that's a stupid idea, because F64 and F32s live in V128 class registers, and we need a way to distinguish between these three cases.  So ignore this.</p>
</blockquote>



<a name="204201258"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204201258" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204201258">(Jul 17 2020 at 12:46)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450625898">PR Review</a>.</p>



<a name="204201260"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204201260" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204201260">(Jul 17 2020 at 12:46)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456419218">PR Review Comment</a>:</p>
<blockquote>
<p>Indeed, done! I've also removed the use of a match to just use <code>if let ...</code> direct pattern matching, which reduces code indent by one tab.</p>
</blockquote>



<a name="204202352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204202352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204202352">(Jul 17 2020 at 12:58)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450634582">PR Review</a>.</p>



<a name="204202353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204202353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204202353">(Jul 17 2020 at 12:58)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456425251">PR Review Comment</a>:</p>
<blockquote>
<p>I renamed it XmmCmove for consistency, and precised that it applied only to scalars at this point; or we can just generalize it right now and use <code>movapd</code> consistently here, not sure...</p>
</blockquote>



<a name="204202656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204202656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204202656">(Jul 17 2020 at 13:01)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450636819">PR Review</a>.</p>



<a name="204202658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204202658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204202658">(Jul 17 2020 at 13:01)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456426890">PR Review Comment</a>:</p>
<blockquote>
<p>The emit functions don't protect much against this, at this point. You're right it'd be better if they did, i'll make this in a subsequent PR!</p>
</blockquote>



<a name="204202792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204202792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204202792">(Jul 17 2020 at 13:02)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450637581">PR Review</a>.</p>



<a name="204202793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204202793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204202793">(Jul 17 2020 at 13:02)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456427449">PR Review Comment</a>:</p>
<blockquote>
<p>good catch, thx</p>
</blockquote>



<a name="204203077"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204203077" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204203077">(Jul 17 2020 at 13:05)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#pullrequestreview-450639678">PR Review</a>.</p>



<a name="204203079"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204203079" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204203079">(Jul 17 2020 at 13:05)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2004#discussion_r456429032">PR Review Comment</a>:</p>
<blockquote>
<p>In theory, yes: the complex variants can take as many inputs as the user wants, and the documentation says it'll add all the inputs together to form the effective address. In practice, <code>postopt</code> I think is the only creator of these instruction variants, and will only use up to 3 inputs together, to map to what the x86 architecture can do.</p>
</blockquote>



<a name="204203843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204203843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204203843">(Jul 17 2020 at 13:12)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2004">PR #2004</a> from <code>x64-fp</code> to <code>main</code>:</p>
<blockquote>
<p>Opening this PR as a WIP, to coordinate better with @jlb6740; this lacks proper testing right now. Only the last commit is relevant, the rest comes from #1995.</p>
<p>This implements the following:</p>
<ul>
<li>load/store for floating point values</li>
<li>more binary and unary opcodes</li>
<li>constant generation</li>
</ul>
</blockquote>



<a name="204208587"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232004%20machinst%20x64%3A%20floating%20point%20support/near/204208587" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232004.20machinst.20x64.3A.20floating.20point.20support.html#204208587">(Jul 17 2020 at 13:56)</a>:</h4>
<p>bnjbvr merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2004">PR #2004</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>