<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1431 Out of bounds memory access not co... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html">wasmtime / Issue #1431 Out of bounds memory access not co...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="192146344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192146344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192146344">(Mar 28 2020 at 23:16)</a>:</h4>
<p>havarnov opened <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I've added two tests for out of bounds memory access to WasmTime.Net. See: <a href="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3" title="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3">https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3</a>.</p>
<p>The problem is that one of the test ("ItThrowsOnOutOfBoundsMemoryAccess") is __not__ consistently passing on my machine. Some times it's passing and sometimes the dotnet runtime crashes.</p>
<table>
<thead>
<tr>
<th>–</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>os</td>
<td>macOS Catalina</td>
</tr>
<tr>
<td>cargo</td>
<td>cargo 1.42.0 (86334295e 2020-01-31)</td>
</tr>
<tr>
<td>rustc</td>
<td>rustc 1.42.0 (b8cedc004 2020-03-09)</td>
</tr>
<tr>
<td>commit sha</td>
<td>08e5484cdb158b7795587ff7ad0cb04beef6dcd3</td>
</tr>
</tbody>
</table>
</blockquote>



<a name="192146345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192146345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192146345">(Mar 28 2020 at 23:16)</a>:</h4>
<p>havarnov labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I've added two tests for out of bounds memory access to WasmTime.Net. See: <a href="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3" title="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3">https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3</a>.</p>
<p>The problem is that one of the test ("ItThrowsOnOutOfBoundsMemoryAccess") is __not__ consistently passing on my machine. Some times it's passing and sometimes the dotnet runtime crashes.</p>
<table>
<thead>
<tr>
<th>–</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>os</td>
<td>macOS Catalina</td>
</tr>
<tr>
<td>cargo</td>
<td>cargo 1.42.0 (86334295e 2020-01-31)</td>
</tr>
<tr>
<td>rustc</td>
<td>rustc 1.42.0 (b8cedc004 2020-03-09)</td>
</tr>
<tr>
<td>commit sha</td>
<td>08e5484cdb158b7795587ff7ad0cb04beef6dcd3</td>
</tr>
</tbody>
</table>
</blockquote>



<a name="192146684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192146684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192146684">(Mar 28 2020 at 23:27)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-605533149" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-605533149">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Here's the full "Problem Report" from macOS:</p>
<div class="codehilite"><pre><span></span>Process:               dotnet [93220]
Path:                  /usr/local/share/dotnet/dotnet
Identifier:            dotnet
Version:               0
Code Type:             X86-64 (Native)
Parent Process:        dotnet [93219]
Responsible:           Terminal [33844]
User ID:               501

Date/Time:             2020-03-29 00:25:25.461 +0100
OS Version:            Mac OS X 10.15.3 (19D76)
Report Version:        12
Bridge OS Version:     3.0 (14Y908)
Anonymous UUID:        3B4958C5-558D-E815-DF8E-FEE76D437CA5

Sleep/Wake UUID:       52F01052-1AE1-48B2-8278-1EE38E1A0CF4

Time Awake Since Boot: 510000 seconds
Time Since Wake:       6800 seconds

System Integrity Protection: enabled

Crashed Thread:        20

Exception Type:        EXC_BAD_ACCESS (SIGSEGV)
Exception Codes:       KERN_INVALID_ADDRESS at 0x0000000000000002
Exception Note:        EXC_CORPSE_NOTIFY

Termination Signal:    Segmentation fault: 11
Termination Reason:    Namespace SIGNAL, Code 0xb
Terminating Process:   exc handler [93220]

VM Regions Near 0x2:
--&gt;
    __TEXT                 0000000105324000-0000000105331000 [   52K] r-x/rwx SM=COW  /usr/local/share/dotnet/dotnet

Thread 0:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x0000000105447dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 347
3   libcoreclr.dylib                0x0000000105447a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010544c47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010544c762 WaitForMultipleObjectsEx + 82
6   libcoreclr.dylib                0x00000001055d76cb Thread::DoAppropriateWaitWorker(int, void**, int, unsigned int, WaitMode) + 1243
7   libcoreclr.dylib                0x00000001055d23c0 Thread::DoAppropriateWait(int, void**, int, unsigned int, WaitMode, PendingSync*) + 48
8   libcoreclr.dylib                0x0000000105706560 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 64
9   libcoreclr.dylib                0x00000001055d85e0 Thread::Block(int, PendingSync*) + 32
10  libcoreclr.dylib                0x00000001055d00a0 SyncBlock::Wait(int, int) + 544
11  libcoreclr.dylib                0x00000001058325b0 ObjectNative::WaitTimeout(bool, int, Object*) + 192
12  ???                             0x000000010bd80854 0 + 4493674580
13  ???                             0x000000010bd95100 0 + 4493758720
14  ???                             0x000000010bd94fa4 0 + 4493758372
15  ???                             0x000000010bd94d17 0 + 4493757719
16  ???                             0x000000010bd94c32 0 + 4493757490
17  ???                             0x000000010c266e3c 0 + 4498812476
18  ???                             0x000000010c2603e5 0 + 4498785253
19  libcoreclr.dylib                0x00000001057cdc3b CallDescrWorkerInternal + 124
20  libcoreclr.dylib                0x000000010561a029 MethodDescCallSite::CallTargetWorker(unsigned long const*, unsigned long*, int) + 1657
21  libcoreclr.dylib                0x00000001054e1ef6 RunMain(MethodDesc*, short, int*, PtrArray**) + 726
22  libcoreclr.dylib                0x00000001054e2268 Assembly::ExecuteMainMethod(PtrArray**, int) + 408
23  libcoreclr.dylib                0x0000000105522678 CorHost2::ExecuteAssembly(unsigned int, char16_t const*, int, char16_t const**, unsigned int*) + 504
24  libcoreclr.dylib                0x000000010545a052 coreclr_execute_assembly + 226
25  libhostpolicy.dylib             0x00000001053b35d7 0x1053a2000 + 71127
26  libhostpolicy.dylib             0x00000001053b4438 0x1053a2000 + 74808
27  libhostfxr.dylib                0x0000000105370a9f 0x105347000 + 170655
28  libhostfxr.dylib                0x000000010536fd92 0x105347000 + 167314
29  libhostfxr.dylib                0x000000010536bd9a 0x105347000 + 150938
30  dotnet                          0x000000010532e55f 0x105324000 + 42335
31  dotnet                          0x000000010532e7df 0x105324000 + 42975
32  libdyld.dylib                   0x00007fff7003a7fd start + 1

Thread 1:
0   libsystem_kernel.dylib          0x00007fff7017b25a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff7017b5d0 mach_msg + 60
2   libcoreclr.dylib                0x0000000105456b18 MachMessage::Receive(unsigned int) + 72
3   libcoreclr.dylib                0x0000000105455a5e SEHExceptionThread(void*) + 94
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 2:
0   libsystem_kernel.dylib          0x00007fff7017fbce kevent + 10
1   libcoreclr.dylib                0x000000010544a320 CorUnix::CPalSynchronizationManager::ReadBytesFromProcessPipe(int, unsigned char*, int) + 448
2   libcoreclr.dylib                0x0000000105449993 CorUnix::CPalSynchronizationManager::WorkerThread(void*) + 131
3   libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 3:
0   libsystem_kernel.dylib          0x00007fff7017bb02 __open + 10
1   libcoreclr.dylib                0x00000001054ca97f TwoWayPipe::WaitForConnection() + 31
2   libcoreclr.dylib                0x00000001054c1c57 DbgTransportSession::TransportWorker() + 167
3   libcoreclr.dylib                0x00000001054c06b9 DbgTransportSession::TransportWorkerStatic(void*) + 9
4   libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
5   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
6   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 4:
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x0000000105447dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 347
3   libcoreclr.dylib                0x0000000105447a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010544c47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010544c762 WaitForMultipleObjectsEx + 82
6   libcoreclr.dylib                0x00000001054be948 DebuggerRCThread::MainLoop() + 248
7   libcoreclr.dylib                0x00000001054be7ec DebuggerRCThread::ThreadProc() + 284
8   libcoreclr.dylib                0x00000001054be503 DebuggerRCThread::ThreadProcStatic(void*) + 131
9   libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
10  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
11  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 5:
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x0000000105447dde CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 318
3   libcoreclr.dylib                0x0000000105447a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010544c47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010544c69d WaitForSingleObjectEx + 77
6   libcoreclr.dylib                0x00000001057065e9 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 201
7   libcoreclr.dylib                0x000000010566ccbf FinalizerThread::WaitForFinalizerEvent(CLREvent*) + 31
8   libcoreclr.dylib                0x000000010566ce22 FinalizerThread::FinalizerThreadWorker(void*) + 98
9   libcoreclr.dylib                0x00000001055dafa3 ManagedThreadBase_DispatchOuter(ManagedThreadCallState*) + 323
10  libcoreclr.dylib                0x00000001055db5f0 ManagedThreadBase::FinalizerBase(void (*)(void*)) + 32
11  libcoreclr.dylib                0x000000010566d0f8 FinalizerThread::FinalizerThreadStart(void*) + 504
12  libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
13  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
14  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 6:
0   libsystem_kernel.dylib          0x00007fff7018187e __accept + 10
1   libcoreclr.dylib                0x00000001054ca6de IpcStream::DiagnosticsIpc::Accept(void (*)(char const*, unsigned int)) const + 62
2   libcoreclr.dylib                0x0000000105647d20 DiagnosticsServerThread(void*) + 288
3   libcoreclr.dylib                0x0000
[message truncated]
</pre></div>


</blockquote>



<a name="192146738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192146738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192146738">(Mar 28 2020 at 23:28)</a>:</h4>
<p>havarnov edited <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I've added two tests for out of bounds memory access to WasmTime.Net. See: <a href="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3" title="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3">https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3</a>.</p>
<p>The problem is that one of the test ("ItThrowsOnOutOfBoundsMemoryAccess") is __not__ consistently passing on my machine. Some times it's passing, sometimes the dotnet runtime crashes and sometimes the process hangs.</p>
<table>
<thead>
<tr>
<th>–</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>os</td>
<td>macOS Catalina</td>
</tr>
<tr>
<td>cargo</td>
<td>cargo 1.42.0 (86334295e 2020-01-31)</td>
</tr>
<tr>
<td>rustc</td>
<td>rustc 1.42.0 (b8cedc004 2020-03-09)</td>
</tr>
<tr>
<td>commit sha</td>
<td>08e5484cdb158b7795587ff7ad0cb04beef6dcd3</td>
</tr>
</tbody>
</table>
</blockquote>



<a name="192268911"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192268911" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192268911">(Mar 30 2020 at 15:05)</a>:</h4>
<p>alexcrichton edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-605533149" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-605533149">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Here's the full "Problem Report" from macOS:</p>
<p>&lt;details&gt;</p>
<div class="codehilite"><pre><span></span>Process:               dotnet [93220]
Path:                  /usr/local/share/dotnet/dotnet
Identifier:            dotnet
Version:               0
Code Type:             X86-64 (Native)
Parent Process:        dotnet [93219]
Responsible:           Terminal [33844]
User ID:               501

Date/Time:             2020-03-29 00:25:25.461 +0100
OS Version:            Mac OS X 10.15.3 (19D76)
Report Version:        12
Bridge OS Version:     3.0 (14Y908)
Anonymous UUID:        3B4958C5-558D-E815-DF8E-FEE76D437CA5

Sleep/Wake UUID:       52F01052-1AE1-48B2-8278-1EE38E1A0CF4

Time Awake Since Boot: 510000 seconds
Time Since Wake:       6800 seconds

System Integrity Protection: enabled

Crashed Thread:        20

Exception Type:        EXC_BAD_ACCESS (SIGSEGV)
Exception Codes:       KERN_INVALID_ADDRESS at 0x0000000000000002
Exception Note:        EXC_CORPSE_NOTIFY

Termination Signal:    Segmentation fault: 11
Termination Reason:    Namespace SIGNAL, Code 0xb
Terminating Process:   exc handler [93220]

VM Regions Near 0x2:
--&gt;
    __TEXT                 0000000105324000-0000000105331000 [   52K] r-x/rwx SM=COW  /usr/local/share/dotnet/dotnet

Thread 0:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x0000000105447dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 347
3   libcoreclr.dylib                0x0000000105447a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010544c47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010544c762 WaitForMultipleObjectsEx + 82
6   libcoreclr.dylib                0x00000001055d76cb Thread::DoAppropriateWaitWorker(int, void**, int, unsigned int, WaitMode) + 1243
7   libcoreclr.dylib                0x00000001055d23c0 Thread::DoAppropriateWait(int, void**, int, unsigned int, WaitMode, PendingSync*) + 48
8   libcoreclr.dylib                0x0000000105706560 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 64
9   libcoreclr.dylib                0x00000001055d85e0 Thread::Block(int, PendingSync*) + 32
10  libcoreclr.dylib                0x00000001055d00a0 SyncBlock::Wait(int, int) + 544
11  libcoreclr.dylib                0x00000001058325b0 ObjectNative::WaitTimeout(bool, int, Object*) + 192
12  ???                             0x000000010bd80854 0 + 4493674580
13  ???                             0x000000010bd95100 0 + 4493758720
14  ???                             0x000000010bd94fa4 0 + 4493758372
15  ???                             0x000000010bd94d17 0 + 4493757719
16  ???                             0x000000010bd94c32 0 + 4493757490
17  ???                             0x000000010c266e3c 0 + 4498812476
18  ???                             0x000000010c2603e5 0 + 4498785253
19  libcoreclr.dylib                0x00000001057cdc3b CallDescrWorkerInternal + 124
20  libcoreclr.dylib                0x000000010561a029 MethodDescCallSite::CallTargetWorker(unsigned long const*, unsigned long*, int) + 1657
21  libcoreclr.dylib                0x00000001054e1ef6 RunMain(MethodDesc*, short, int*, PtrArray**) + 726
22  libcoreclr.dylib                0x00000001054e2268 Assembly::ExecuteMainMethod(PtrArray**, int) + 408
23  libcoreclr.dylib                0x0000000105522678 CorHost2::ExecuteAssembly(unsigned int, char16_t const*, int, char16_t const**, unsigned int*) + 504
24  libcoreclr.dylib                0x000000010545a052 coreclr_execute_assembly + 226
25  libhostpolicy.dylib             0x00000001053b35d7 0x1053a2000 + 71127
26  libhostpolicy.dylib             0x00000001053b4438 0x1053a2000 + 74808
27  libhostfxr.dylib                0x0000000105370a9f 0x105347000 + 170655
28  libhostfxr.dylib                0x000000010536fd92 0x105347000 + 167314
29  libhostfxr.dylib                0x000000010536bd9a 0x105347000 + 150938
30  dotnet                          0x000000010532e55f 0x105324000 + 42335
31  dotnet                          0x000000010532e7df 0x105324000 + 42975
32  libdyld.dylib                   0x00007fff7003a7fd start + 1

Thread 1:
0   libsystem_kernel.dylib          0x00007fff7017b25a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff7017b5d0 mach_msg + 60
2   libcoreclr.dylib                0x0000000105456b18 MachMessage::Receive(unsigned int) + 72
3   libcoreclr.dylib                0x0000000105455a5e SEHExceptionThread(void*) + 94
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 2:
0   libsystem_kernel.dylib          0x00007fff7017fbce kevent + 10
1   libcoreclr.dylib                0x000000010544a320 CorUnix::CPalSynchronizationManager::ReadBytesFromProcessPipe(int, unsigned char*, int) + 448
2   libcoreclr.dylib                0x0000000105449993 CorUnix::CPalSynchronizationManager::WorkerThread(void*) + 131
3   libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 3:
0   libsystem_kernel.dylib          0x00007fff7017bb02 __open + 10
1   libcoreclr.dylib                0x00000001054ca97f TwoWayPipe::WaitForConnection() + 31
2   libcoreclr.dylib                0x00000001054c1c57 DbgTransportSession::TransportWorker() + 167
3   libcoreclr.dylib                0x00000001054c06b9 DbgTransportSession::TransportWorkerStatic(void*) + 9
4   libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
5   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
6   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 4:
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x0000000105447dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 347
3   libcoreclr.dylib                0x0000000105447a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010544c47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010544c762 WaitForMultipleObjectsEx + 82
6   libcoreclr.dylib                0x00000001054be948 DebuggerRCThread::MainLoop() + 248
7   libcoreclr.dylib                0x00000001054be7ec DebuggerRCThread::ThreadProc() + 284
8   libcoreclr.dylib                0x00000001054be503 DebuggerRCThread::ThreadProcStatic(void*) + 131
9   libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
10  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
11  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 5:
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x0000000105447dde CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 318
3   libcoreclr.dylib                0x0000000105447a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010544c47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010544c69d WaitForSingleObjectEx + 77
6   libcoreclr.dylib                0x00000001057065e9 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 201
7   libcoreclr.dylib                0x000000010566ccbf FinalizerThread::WaitForFinalizerEvent(CLREvent*) + 31
8   libcoreclr.dylib                0x000000010566ce22 FinalizerThread::FinalizerThreadWorker(void*) + 98
9   libcoreclr.dylib                0x00000001055dafa3 ManagedThreadBase_DispatchOuter(ManagedThreadCallState*) + 323
10  libcoreclr.dylib                0x00000001055db5f0 ManagedThreadBase::FinalizerBase(void (*)(void*)) + 32
11  libcoreclr.dylib                0x000000010566d0f8 FinalizerThread::FinalizerThreadStart(void*) + 504
12  libcoreclr.dylib                0x0000000105453384 CorUnix::CPalThread::ThreadEntry(void*) + 436
13  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
14  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 6:
0   libsystem_kernel.dylib          0x00007fff7018187e __accept + 10
1   libcoreclr.dylib                0x00000001054ca6de IpcStream::DiagnosticsIpc::Accept(void (*)(char const*, unsigned int)) const + 62
2   libcoreclr.dylib                0x0000000105647d20 DiagnosticsServerThread(void*) + 288
3   libcoreclr.dy
[message truncated]
</pre></div>


</blockquote>



<a name="192269087"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192269087" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192269087">(Mar 30 2020 at 15:06)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606056695" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606056695">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Thanks for the report! </p>
<p>Given your crash logs it says thread 20 crashed which has a stack trace of:</p>
<div class="codehilite"><pre><span></span>0   libwasmtime.dylib               0x0000000108cdb1a9 __rbt_macho_add_symtab + 1353
1   libwasmtime.dylib               0x0000000108cda230 __rbt_macho_add + 1920
2   libwasmtime.dylib               0x0000000108cd9921 __rbt_backtrace_initialize + 337
3   libwasmtime.dylib               0x0000000108cd8fdf fileline_initialize + 735
4   libwasmtime.dylib               0x0000000108cd90dd __rbt_backtrace_syminfo + 45
5   libwasmtime.dylib               0x0000000108cc4fcf backtrace::symbolize::libbacktrace::resolve::h719e8a9f1adb8fe1 + 159 (libbacktrace.rs:469)
6   libwasmtime.dylib               0x0000000108cc85a8 backtrace::symbolize::resolve_frame_unsynchronized::h7ca357de7ff98157 + 56 (mod.rs:178)
7   libwasmtime.dylib               0x0000000108cc83e0 backtrace::symbolize::resolve_frame::h75c5abc2a861fa2d + 80 (mod.rs:105)
8   libwasmtime.dylib               0x0000000108cc0c2c backtrace::capture::Backtrace::resolve::he887e05906dda0c3 + 348 (capture.rs:219)
9   libwasmtime.dylib               0x0000000108cc077c backtrace::capture::Backtrace::new::hde48dbbe07c85c38 + 60 (capture.rs:129)
10  libwasmtime.dylib               0x0000000108c6e4d0 wasmtime_runtime::traphandlers::Trap::wasm::hc86ae73cea48b813 + 64 (traphandlers.rs:363)
11  libwasmtime.dylib               0x0000000108c8bfa2 wasmtime_runtime::instance::initialize_memories::hffd4acb5f389bdf5 + 514 (instance.rs:1326)
12  libwasmtime.dylib               0x0000000108c89801 wasmtime_runtime::instance::InstanceHandle::new::h7769a621032ef434 + 6369 (instance.rs:978)
13  libwasmtime.dylib               0x00000001089ee425 wasmtime_jit::instantiate::CompiledModule::instantiate::h2f2ec277d7cd7968 + 1237 (instantiate.rs:216)
14  libwasmtime.dylib               0x00000001088d3286 wasmtime::instance::instantiate::hde8bac425f17f01c + 150 (instance.rs:29)
15  libwasmtime.dylib               0x00000001088d363a wasmtime::instance::Instance::new::hfb0a2766f04e3a70 + 586 (instance.rs:127)
16  libwasmtime.dylib               0x00000001088d11ee wasmtime::linker::Linker::instantiate::h4aa0fd178eec2ddd + 2878 (linker.rs:395)
17  libwasmtime.dylib               0x0000000108659214 wasmtime_linker_instantiate + 132 (linker.rs:85)
</pre></div>


<p>which looks like this is running into <a href="https://github.com/bytecodealliance/wasmtime/issues/1295" title="https://github.com/bytecodealliance/wasmtime/issues/1295">https://github.com/bytecodealliance/wasmtime/issues/1295</a> as an issue which is in turn slated to be fixed by <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">https://github.com/bytecodealliance/wasmtime/pull/1315</a></p>
</blockquote>



<a name="192283301"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192283301" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192283301">(Mar 30 2020 at 16:46)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606113131" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606113131">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>NP, happy to help! Good that it's allready is on track to be fixed.</p>
<p>A couple of things:</p>
<ol>
<li>Would you'ld like me to create a PR, so these tests are part of the Wasmtime.Net test suite?</li>
<li>Could you help me to understand how the memory stuf works? If I have the set bot max &amp; min number of pages to 2 as in:</li>
</ol>
<div class="codehilite"><pre><span></span>var memory = new Memory(Store, 2, 2);
</pre></div>


<p>And I have a wasm module as follows:</p>
<div class="codehilite"><pre><span></span>(module
  (import &quot;&quot; &quot;mem&quot; (memory $m 1 1))
)
</pre></div>


<p>Is there any way to grow the memory to 2 pages? I've tried to understand the <a href="https://webassembly.github.io/spec/core/bikeshed/index.html#memory-instructions%E2%91%A0" title="https://webassembly.github.io/spec/core/bikeshed/index.html#memory-instructions%E2%91%A0">spec</a>, but haven't figured out how to use the <code>memory.grow</code> instruction.</p>
</blockquote>



<a name="192284338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192284338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192284338">(Mar 30 2020 at 16:52)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606116455" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606116455">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>In the wasm module you defined the maximum size to be 1 page. This means that you can't grow it to 2 pages. If you use <code>(memory $m 1)</code> instead, there is no limit on the memory size other than the standard limit of 4GB.</p>
</blockquote>



<a name="192284416"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192284416" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192284416">(Mar 30 2020 at 16:52)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606116455" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606116455">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>In the wasm module you defined the maximum size to be 1 page. This means that you can't grow it to 2 pages. If you use <code>(memory $m 1)</code> instead, there is no limit on the size the memory can grow to other than the standard limit of 4GB.</p>
</blockquote>



<a name="192287346"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192287346" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192287346">(Mar 30 2020 at 17:12)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606126921" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606126921">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@bjorn3 if you use <code>(memory $m 1)</code> I guess you can't grow it more than what the host has defined? And how exactly do I use <code>memory.grow</code>?</p>
</blockquote>



<a name="192290840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192290840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192290840">(Mar 30 2020 at 17:37)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606139771" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-606139771">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I believe you can use <code>memory.grow</code> by first pushing a 32bit integer representing the new size in pages to the stack and the calling <code>memory.grow</code>.</p>
</blockquote>



<a name="192866981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192866981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192866981">(Apr 03 2020 at 21:36)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-608695829" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-608695829">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Ok I think this should be fixed with <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">https://github.com/bytecodealliance/wasmtime/pull/1315</a> now </p>
</blockquote>



<a name="192866985"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192866985" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192866985">(Apr 03 2020 at 21:36)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I've added two tests for out of bounds memory access to WasmTime.Net. See: <a href="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3" title="https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3">https://github.com/havarnov/wasmtime/commit/1b199cf63ed218094271020c34c89c2aea347dc3</a>.</p>
<p>The problem is that one of the test ("ItThrowsOnOutOfBoundsMemoryAccess") is __not__ consistently passing on my machine. Some times it's passing, sometimes the dotnet runtime crashes and sometimes the process hangs.</p>
<table>
<thead>
<tr>
<th>–</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>os</td>
<td>macOS Catalina</td>
</tr>
<tr>
<td>cargo</td>
<td>cargo 1.42.0 (86334295e 2020-01-31)</td>
</tr>
<tr>
<td>rustc</td>
<td>rustc 1.42.0 (b8cedc004 2020-03-09)</td>
</tr>
<tr>
<td>commit sha</td>
<td>08e5484cdb158b7795587ff7ad0cb04beef6dcd3</td>
</tr>
</tbody>
</table>
</blockquote>



<a name="192925437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/192925437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#192925437">(Apr 04 2020 at 20:25)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-609084435" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-609084435">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Still getting the same error after merging in master. Atleast for me it seems like it's the same stack trace (in thread 1 this time).</p>
<p>&lt;details&gt;<br>
Process:               dotnet [56275]<br>
Path:                  /usr/local/share/dotnet/dotnet<br>
Identifier:            dotnet<br>
Version:               0<br>
Code Type:             X86-64 (Native)<br>
Parent Process:        mono-sgen [54559]<br>
Responsible:           rider [53391]<br>
User ID:               501</p>
<p>Date/Time:             2020-04-04 22:18:49.598 +0200<br>
OS Version:            Mac OS X 10.15.3 (19D76)<br>
Report Version:        12<br>
Bridge OS Version:     3.0 (14Y908)<br>
Anonymous UUID:        3B4958C5-558D-E815-DF8E-FEE76D437CA5</p>
<p>Sleep/Wake UUID:       20124844-BA37-4C58-8ED2-83ADCDC394D1</p>
<p>Time Awake Since Boot: 680000 seconds<br>
Time Since Wake:       750 seconds</p>
<p>System Integrity Protection: enabled</p>
<p>Crashed Thread:        1</p>
<p>Exception Type:        EXC_CRASH (SIGABRT)<br>
Exception Codes:       0x0000000000000000, 0x0000000000000000<br>
Exception Note:        EXC_CORPSE_NOTIFY</p>
<p>Application Specific Information:<br>
abort() called</p>
<p>Thread 0:: Dispatch queue: com.apple.main-thread<br>
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10<br>
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701<br>
2   libcoreclr.dylib                0x000000010ce59dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData<em>, unsigned int, CorUnix::ThreadWakeupReason</em>, unsigned int*) + 347<br>
3   libcoreclr.dylib                0x000000010ce59a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread<em>, unsigned int, bool, bool, CorUnix::ThreadWakeupReason</em>, unsigned int*) + 464<br>
4   libcoreclr.dylib                0x000000010ce5e47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread<em>, unsigned int, void</em> const*, int, unsigned int, int, int) + 2028<br>
5   libcoreclr.dylib                0x000000010ce5e762 WaitForMultipleObjectsEx + 82<br>
6   libcoreclr.dylib                0x000000010cfe96cb Thread::DoAppropriateWaitWorker(int, void**, int, unsigned int, WaitMode) + 1243<br>
7   libcoreclr.dylib                0x000000010cfe43c0 Thread::DoAppropriateWait(int, void*<em>, int, unsigned int, WaitMode, PendingSync</em>) + 48<br>
8   libcoreclr.dylib                0x000000010d118560 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 64<br>
9   libcoreclr.dylib                0x000000010cfea5e0 Thread::Block(int, PendingSync*) + 32<br>
10  libcoreclr.dylib                0x000000010cfe20a0 SyncBlock::Wait(int, int) + 544<br>
11  libcoreclr.dylib                0x000000010d2445b0 ObjectNative::WaitTimeout(bool, int, Object*) + 192<br>
12  ???                             0x000000011b770854 0 + 4755753044<br>
13  ???                             0x000000011b785100 0 + 4755837184<br>
14  ???                             0x000000011b784fa4 0 + 4755836836<br>
15  ???                             0x000000011b784d17 0 + 4755836183<br>
16  ???                             0x000000011b784c32 0 + 4755835954<br>
17  ???                             0x000000011bc56e3c 0 + 4760890940<br>
18  ???                             0x000000011bc503e5 0 + 4760863717<br>
19  libcoreclr.dylib                0x000000010d1dfc3b CallDescrWorkerInternal + 124<br>
20  libcoreclr.dylib                0x000000010d02c029 MethodDescCallSite::CallTargetWorker(unsigned long const<em>, unsigned long</em>, int) + 1657<br>
21  libcoreclr.dylib                0x000000010cef3ef6 RunMain(MethodDesc<em>, short, int</em>, PtrArray**) + 726<br>
22  libcoreclr.dylib                0x000000010cef4268 Assembly::ExecuteMainMethod(PtrArray**, int) + 408<br>
23  libcoreclr.dylib                0x000000010cf34678 CorHost2::ExecuteAssembly(unsigned int, char16_t const<em>, int, char16_t const</em><em>, unsigned int</em>) + 504<br>
24  libcoreclr.dylib                0x000000010ce6c052 coreclr_execute_assembly + 226<br>
25  libhostpolicy.dylib             0x000000010cdc55d7 0x10cdb4000 + 71127<br>
26  libhostpolicy.dylib             0x000000010cdc6438 0x10cdb4000 + 74808<br>
27  libhostfxr.dylib                0x000000010cd82a9f 0x10cd59000 + 170655<br>
28  libhostfxr.dylib                0x000000010cd81d92 0x10cd59000 + 167314<br>
29  libhostfxr.dylib                0x000000010cd7dd9a 0x10cd59000 + 150938<br>
30  dotnet                          0x000000010cd4055f 0x10cd36000 + 42335<br>
31  dotnet                          0x000000010cd407df 0x10cd36000 + 42975<br>
32  libdyld.dylib                   0x00007fff7003a7fd start + 1</p>
<p>Thread 1 Crashed:<br>
0   libsystem_kernel.dylib          0x00007fff701817fa __pthread_kill + 10<br>
1   libsystem_pthread.dylib         0x00007fff7023ebc1 pthread_kill + 432<br>
2   libsystem_c.dylib               0x00007fff70108a1c abort + 120<br>
3   libcoreclr.dylib                0x000000010ce6815c SEHExceptionThread(void*) + 1884<br>
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148<br>
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15</p>
<p>Thread 2:<br>
0   libsystem_kernel.dylib          0x00007fff7017fbce kevent + 10<br>
1   libcoreclr.dylib                0x000000010ce5c320 CorUnix::CPalSynchronizationManager::ReadBytesFromProcessPipe(int, unsigned char*, int) + 448<br>
2   libcoreclr.dylib                0x000000010ce5b993 CorUnix::CPalSynchronizationManager::WorkerThread(void*) + 131<br>
3   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436<br>
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148<br>
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15</p>
<p>Thread 3:<br>
0   libsystem_kernel.dylib          0x00007fff7017bb02 __open + 10<br>
1   libcoreclr.dylib                0x000000010cedc97f TwoWayPipe::WaitForConnection() + 31<br>
2   libcoreclr.dylib                0x000000010ced3c57 DbgTransportSession::TransportWorker() + 167<br>
3   libcoreclr.dylib                0x000000010ced26b9 DbgTransportSession::TransportWorkerStatic(void*) + 9<br>
4   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436<br>
5   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148<br>
6   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15</p>
<p>Thread 4:<br>
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10<br>
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701<br>
2   libcoreclr.dylib                0x000000010ce59dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData<em>, unsigned int, CorUnix::ThreadWakeupReason</em>, unsigned int*) + 347<br>
3   libcoreclr.dylib                0x000000010ce59a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread<em>, unsigned int, bool, bool, CorUnix::ThreadWakeupReason</em>, unsigned int*) + 464<br>
4   libcoreclr.dylib                0x000000010ce5e47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread<em>, unsigned int, void</em> const*, int, unsigned int, int, int) + 2028<br>
5   libcoreclr.dylib                0x000000010ce5e762 WaitForMultipleObjectsEx + 82<br>
6   libcoreclr.dylib                0x000000010ced0948 DebuggerRCThread::MainLoop() + 248<br>
7   libcoreclr.dylib                0x000000010ced07ec DebuggerRCThread::ThreadProc() + 284<br>
8   libcoreclr.dylib                0x000000010ced0503 DebuggerRCThread::ThreadProcStatic(void*) + 131<br>
9   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436<br>
10  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148<br>
11  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15</p>
<p>Thread 5:<br>
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10<br>
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701<br>
2   libcoreclr.dylib                0x000000010ce59dde CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData<em>, unsigned int, CorUnix::ThreadWakeupReason</em>, unsigned int*) + 318<br>
3   libcoreclr.dylib                0x000000010ce59a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread<em>, unsigned int, bool, bool, CorUnix::ThreadWakeupReason</em>, unsigned int*) + 464<br>
4   libcoreclr.dylib                0x000000010ce5e47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread<em>, unsigned int, void</em> const*, int, unsigned int, int, int) + 2028<br>
5   libcoreclr.dylib                0x000000010ce5e69d WaitForSingleObjectEx + 77<br>
6   libcoreclr.dylib                0x000000010d1185e9 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 201<br>
7   libcoreclr.dylib                0x000000010d07ecbf FinalizerThread::WaitForFinalizerEvent(CLREvent*) + 31<br>
8   libcoreclr.dylib                0x000000010d07ee22 FinalizerThread::FinalizerThreadWorker(void*) + 98<br>
9   libcoreclr.dylib                0x000000010cfecfa3 ManagedThreadBase_DispatchOuter(ManagedThreadCallState*) + 323<br>
10  libcoreclr.dylib                0x000000010cfed5f0 ManagedThreadBase::FinalizerBase(void (<em>)(void</em>)) + 32<br>
11  libcoreclr.dylib                0x000000010d07f0f8 FinalizerThread::FinalizerThreadStart(void*) + 504<br>
12  libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436<br>
13  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148<br>
14  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15</p>
<p>Thread 6:<br>
0   libsystem_kernel.dylib          0x00007fff7018187e __accept + 10<br>
1   libcoreclr.dylib                0x000000010cedc6de IpcStream::DiagnosticsIpc::Accept(void (<em>)(char const</em>, unsigned int)) const + 62<br>
2   libcoreclr.dylib                0x000000010d059d20 DiagnosticsServerThread(void*) + 288<br>
3   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436<br>
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148<br>
5   libsystem_pthread.dylib    <br>
[message truncated]</p>
</blockquote>



<a name="193052973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193052973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193052973">(Apr 06 2020 at 14:49)</a>:</h4>
<p>alexcrichton edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-609084435" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-609084435">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Still getting the same error after merging in master. Atleast for me it seems like it's the same stack trace (in thread 1 this time).</p>
<p>&lt;details&gt;</p>
<div class="codehilite"><pre><span></span>Process:               dotnet [56275]
Path:                  /usr/local/share/dotnet/dotnet
Identifier:            dotnet
Version:               0
Code Type:             X86-64 (Native)
Parent Process:        mono-sgen [54559]
Responsible:           rider [53391]
User ID:               501

Date/Time:             2020-04-04 22:18:49.598 +0200
OS Version:            Mac OS X 10.15.3 (19D76)
Report Version:        12
Bridge OS Version:     3.0 (14Y908)
Anonymous UUID:        3B4958C5-558D-E815-DF8E-FEE76D437CA5

Sleep/Wake UUID:       20124844-BA37-4C58-8ED2-83ADCDC394D1

Time Awake Since Boot: 680000 seconds
Time Since Wake:       750 seconds

System Integrity Protection: enabled

Crashed Thread:        1

Exception Type:        EXC_CRASH (SIGABRT)
Exception Codes:       0x0000000000000000, 0x0000000000000000
Exception Note:        EXC_CORPSE_NOTIFY

Application Specific Information:
abort() called

Thread 0:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x000000010ce59dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 347
3   libcoreclr.dylib                0x000000010ce59a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010ce5e47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010ce5e762 WaitForMultipleObjectsEx + 82
6   libcoreclr.dylib                0x000000010cfe96cb Thread::DoAppropriateWaitWorker(int, void**, int, unsigned int, WaitMode) + 1243
7   libcoreclr.dylib                0x000000010cfe43c0 Thread::DoAppropriateWait(int, void**, int, unsigned int, WaitMode, PendingSync*) + 48
8   libcoreclr.dylib                0x000000010d118560 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 64
9   libcoreclr.dylib                0x000000010cfea5e0 Thread::Block(int, PendingSync*) + 32
10  libcoreclr.dylib                0x000000010cfe20a0 SyncBlock::Wait(int, int) + 544
11  libcoreclr.dylib                0x000000010d2445b0 ObjectNative::WaitTimeout(bool, int, Object*) + 192
12  ???                             0x000000011b770854 0 + 4755753044
13  ???                             0x000000011b785100 0 + 4755837184
14  ???                             0x000000011b784fa4 0 + 4755836836
15  ???                             0x000000011b784d17 0 + 4755836183
16  ???                             0x000000011b784c32 0 + 4755835954
17  ???                             0x000000011bc56e3c 0 + 4760890940
18  ???                             0x000000011bc503e5 0 + 4760863717
19  libcoreclr.dylib                0x000000010d1dfc3b CallDescrWorkerInternal + 124
20  libcoreclr.dylib                0x000000010d02c029 MethodDescCallSite::CallTargetWorker(unsigned long const*, unsigned long*, int) + 1657
21  libcoreclr.dylib                0x000000010cef3ef6 RunMain(MethodDesc*, short, int*, PtrArray**) + 726
22  libcoreclr.dylib                0x000000010cef4268 Assembly::ExecuteMainMethod(PtrArray**, int) + 408
23  libcoreclr.dylib                0x000000010cf34678 CorHost2::ExecuteAssembly(unsigned int, char16_t const*, int, char16_t const**, unsigned int*) + 504
24  libcoreclr.dylib                0x000000010ce6c052 coreclr_execute_assembly + 226
25  libhostpolicy.dylib             0x000000010cdc55d7 0x10cdb4000 + 71127
26  libhostpolicy.dylib             0x000000010cdc6438 0x10cdb4000 + 74808
27  libhostfxr.dylib                0x000000010cd82a9f 0x10cd59000 + 170655
28  libhostfxr.dylib                0x000000010cd81d92 0x10cd59000 + 167314
29  libhostfxr.dylib                0x000000010cd7dd9a 0x10cd59000 + 150938
30  dotnet                          0x000000010cd4055f 0x10cd36000 + 42335
31  dotnet                          0x000000010cd407df 0x10cd36000 + 42975
32  libdyld.dylib                   0x00007fff7003a7fd start + 1

Thread 1 Crashed:
0   libsystem_kernel.dylib          0x00007fff701817fa __pthread_kill + 10
1   libsystem_pthread.dylib         0x00007fff7023ebc1 pthread_kill + 432
2   libsystem_c.dylib               0x00007fff70108a1c abort + 120
3   libcoreclr.dylib                0x000000010ce6815c SEHExceptionThread(void*) + 1884
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 2:
0   libsystem_kernel.dylib          0x00007fff7017fbce kevent + 10
1   libcoreclr.dylib                0x000000010ce5c320 CorUnix::CPalSynchronizationManager::ReadBytesFromProcessPipe(int, unsigned char*, int) + 448
2   libcoreclr.dylib                0x000000010ce5b993 CorUnix::CPalSynchronizationManager::WorkerThread(void*) + 131
3   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 3:
0   libsystem_kernel.dylib          0x00007fff7017bb02 __open + 10
1   libcoreclr.dylib                0x000000010cedc97f TwoWayPipe::WaitForConnection() + 31
2   libcoreclr.dylib                0x000000010ced3c57 DbgTransportSession::TransportWorker() + 167
3   libcoreclr.dylib                0x000000010ced26b9 DbgTransportSession::TransportWorkerStatic(void*) + 9
4   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436
5   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
6   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 4:
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x000000010ce59dfb CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 347
3   libcoreclr.dylib                0x000000010ce59a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010ce5e47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010ce5e762 WaitForMultipleObjectsEx + 82
6   libcoreclr.dylib                0x000000010ced0948 DebuggerRCThread::MainLoop() + 248
7   libcoreclr.dylib                0x000000010ced07ec DebuggerRCThread::ThreadProc() + 284
8   libcoreclr.dylib                0x000000010ced0503 DebuggerRCThread::ThreadProcStatic(void*) + 131
9   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436
10  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
11  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 5:
0   libsystem_kernel.dylib          0x00007fff7017dce6 __psynch_cvwait + 10
1   libsystem_pthread.dylib         0x00007fff7023f185 _pthread_cond_wait + 701
2   libcoreclr.dylib                0x000000010ce59dde CorUnix::CPalSynchronizationManager::ThreadNativeWait(CorUnix::_ThreadNativeWaitData*, unsigned int, CorUnix::ThreadWakeupReason*, unsigned int*) + 318
3   libcoreclr.dylib                0x000000010ce59a90 CorUnix::CPalSynchronizationManager::BlockThread(CorUnix::CPalThread*, unsigned int, bool, bool, CorUnix::ThreadWakeupReason*, unsigned int*) + 464
4   libcoreclr.dylib                0x000000010ce5e47c CorUnix::InternalWaitForMultipleObjectsEx(CorUnix::CPalThread*, unsigned int, void* const*, int, unsigned int, int, int) + 2028
5   libcoreclr.dylib                0x000000010ce5e69d WaitForSingleObjectEx + 77
6   libcoreclr.dylib                0x000000010d1185e9 CLREventBase::WaitEx(unsigned int, WaitMode, PendingSync*) + 201
7   libcoreclr.dylib                0x000000010d07ecbf FinalizerThread::WaitForFinalizerEvent(CLREvent*) + 31
8   libcoreclr.dylib                0x000000010d07ee22 FinalizerThread::FinalizerThreadWorker(void*) + 98
9   libcoreclr.dylib                0x000000010cfecfa3 ManagedThreadBase_DispatchOuter(ManagedThreadCallState*) + 323
10  libcoreclr.dylib                0x000000010cfed5f0 ManagedThreadBase::FinalizerBase(void (*)(void*)) + 32
11  libcoreclr.dylib                0x000000010d07f0f8 FinalizerThread::FinalizerThreadStart(void*) + 504
12  libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436
13  libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
14  libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15

Thread 6:
0   libsystem_kernel.dylib          0x00007fff7018187e __accept + 10
1   libcoreclr.dylib                0x000000010cedc6de IpcStream::DiagnosticsIpc::Accept(void (*)(char const*, unsigned int)) const + 62
2   libcoreclr.dylib                0x000000010d059d20 DiagnosticsServerThread(void*) + 288
3   libcoreclr.dylib                0x000000010ce65384 CorUnix::CPalThread::ThreadEntry(void*) + 436
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem
[message truncated]
</pre></div>


</blockquote>



<a name="193053137"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193053137" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193053137">(Apr 06 2020 at 14:50)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-609842332" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-609842332">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@havarnov that says that thread 1 crashed with a stack tha tlooks like:</p>
<div class="codehilite"><pre><span></span>Thread 1 Crashed:
0   libsystem_kernel.dylib          0x00007fff701817fa __pthread_kill + 10
1   libsystem_pthread.dylib         0x00007fff7023ebc1 pthread_kill + 432
2   libsystem_c.dylib               0x00007fff70108a1c abort + 120
3   libcoreclr.dylib                0x000000010ce6815c SEHExceptionThread(void*) + 1884
4   libsystem_pthread.dylib         0x00007fff7023ee65 _pthread_start + 148
5   libsystem_pthread.dylib         0x00007fff7023a83b thread_start + 15
</pre></div>


<p>are you sure that's related to segfaults? That looks like the application explicitly killed itself?</p>
</blockquote>



<a name="193279286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193279286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193279286">(Apr 08 2020 at 06:23)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-610774523" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-610774523">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Now I'm both confused and unsure about what a commented 2 days ago. Seems like a posted the wrong stack trace?</p>
<p>Anyways, I'm sure the test is failing/passign inconsistently. Here's a new stack trace after running <code>dotnet test</code> on <a href="https://github.com/havarnov/wasmtime/commit/30e0655493c67cadf4099029e38fa726f896ea19" title="https://github.com/havarnov/wasmtime/commit/30e0655493c67cadf4099029e38fa726f896ea19">https://github.com/havarnov/wasmtime/commit/30e0655493c67cadf4099029e38fa726f896ea19</a>.</p>
<p>&lt;details&gt;</p>
<div class="codehilite"><pre><span></span>Thread 18:
0   libsystem_kernel.dylib          0x00007fff7017d4c2 __psynch_mutexwait + 10
1   libsystem_pthread.dylib         0x00007fff7023c62a _pthread_mutex_firstfit_lock_wait + 96
2   libsystem_pthread.dylib         0x00007fff7023a5e5 _pthread_mutex_firstfit_lock_slow + 222
3   libwasmtime.dylib               0x000000010fc16b35 std::sys::unix::mutex::Mutex::lock::h1dbae44fb498794c + 37 (mutex.rs:57)
4   libwasmtime.dylib               0x000000010fc166a8 std::sys_common::mutex::Mutex::raw_lock::h0320f6f2d66d3b9a + 24 (mutex.rs:42)
5   libwasmtime.dylib               0x000000010fc0f8c6 std::sync::mutex::Mutex$LT$T$GT$::lock::h3ff867185c94d556 + 38 (mutex.rs:219)
6   libwasmtime.dylib               0x000000010fc1759c backtrace::lock::lock::h8fc4afef87bf4cdd + 108
7   libwasmtime.dylib               0x000000010fc190a9 backtrace::backtrace::trace::h2c442a445ec5d23c + 25 (mod.rs:52)
8   libwasmtime.dylib               0x000000010fc0ad67 backtrace::capture::Backtrace::create::h6478de780a3e1ffe + 103 (capture.rs:164)
9   libwasmtime.dylib               0x000000010fc0aceb backtrace::capture::Backtrace::new_unresolved::h6faba8f13d41d24f + 27
10  libwasmtime.dylib               0x000000010f53fbb5 wasmtime::trap::Trap::new::h1a9eabfc567a0830 + 85 (trap.rs:32)
11  libwasmtime.dylib               0x000000010f5a8cd5 wasm_trap_new + 357 (trap.rs:43)
12  ???                             0x00000001200ffd7d 0 + 4832886141
13  ???                             0x00000001200ff9c4 0 + 4832885188
14  ???                             0x00000001200ff516 0 + 4832883990
15  libcoreclr.dylib                0x000000010c6eaca9 UMThunkStub + 273
16  libwasmtime.dylib               0x000000010f58d7fd wasmtime::func::wasm_func_new::_$u7b$$u7b$closure$u7d$$u7d$::h04b26d3696b68533 + 45 (func.rs:113)
17  libwasmtime.dylib               0x000000010f58d38d wasmtime::func::create_function::_$u7b$$u7b$closure$u7d$$u7d$::habe73ec684983f10 + 461 (func.rs:90)
18  libwasmtime.dylib               0x000000010f5af954 wasmtime::func::Func::new::_$u7b$$u7b$closure$u7d$$u7d$::heef410f7add1b585 + 948 (func.rs:246)
19  libwasmtime.dylib               0x000000010f7c0420 _$LT$alloc..boxed..Box$LT$F$GT$$u20$as$u20$core..ops..function..Fn$LT$A$GT$$GT$::call::h99249d428e1cf153 + 48 (boxed.rs:1029)
20  libwasmtime.dylib               0x000000010f7ba438 wasmtime::trampoline::func::stub_fn::call_stub::h3340fb5f082687a0 + 184 (func.rs:79)
21  libwasmtime.dylib               0x000000010f7d5cc1 wasmtime::trampoline::func::stub_fn::_$u7b$$u7b$closure$u7d$$u7d$::h5226b3d450958191 + 49 (func.rs:50)
22  libwasmtime.dylib               0x000000010f7ab91d core::ops::function::FnOnce::call_once::h39eca28141925286 + 13
23  libwasmtime.dylib               0x000000010f798ae8 _$LT$std..panic..AssertUnwindSafe$LT$F$GT$$u20$as$u20$core..ops..function..FnOnce$LT$$LP$$RP$$GT$$GT$::call_once::hac4b47668d95477a + 40 (panic.rs:318)
24  libwasmtime.dylib               0x000000010f80638d std::panicking::try::do_call::h6e790f5863cd1626 + 77 (panicking.rs:305)
25  libwasmtime.dylib               0x00000001103e340b __rust_maybe_catch_panic + 27 (lib.rs:94)
26  libwasmtime.dylib               0x000000010f80627b std::panicking::try::he4c645adab2154a6 + 187 (panicking.rs:281)
27  libwasmtime.dylib               0x000000010f798b2f std::panic::catch_unwind::ha8510c644ad9f868 + 47
28  libwasmtime.dylib               0x000000010f7ba206 wasmtime::trampoline::func::stub_fn::hadd0620c40df928e + 118 (func.rs:49)
29  ???                             0x000000011198301d 0 + 4590153757
30  ???                             0x00000001119630ee 0 + 4590022894
31  ???                             0x00000001119632e4 0 + 4590023396
32  libwasmtime.dylib               0x000000010f7e68fa wasmtime::func::Func::call::_$u7b$$u7b$closure$u7d$$u7d$::hf0de02914dcebcf0 + 106 (func.rs:537)
33  libwasmtime.dylib               0x000000010f7be618 wasmtime_runtime::traphandlers::catch_traps::call_closure::ha8fe22ead980de5c + 24 (traphandlers.rs:397)
34  libwasmtime.dylib               0x000000010fc071b6 RegisterSetjmp + 118 (helpers.c:13)
35  libwasmtime.dylib               0x000000010f7be88d wasmtime_runtime::traphandlers::catch_traps::_$u7b$$u7b$closure$u7d$$u7d$::hd670f25e8930dd8e + 61 (traphandlers.rs:385)
36  libwasmtime.dylib               0x000000010f7bf678 wasmtime_runtime::traphandlers::CallThreadState::with::_$u7b$$u7b$closure$u7d$$u7d$::_$u7b$$u7b$closure$u7d$$u7d$::he43f22d21542f808 + 40 (traphandlers.rs:434)
37  libwasmtime.dylib               0x000000010f7fffa9 wasmtime_runtime::traphandlers::tls::set::_$u7b$$u7b$closure$u7d$$u7d$::h33448bea1c38356f + 89 (traphandlers.rs:592)
38  libwasmtime.dylib               0x000000010f7d20dd std::thread::local::LocalKey$LT$T$GT$::try_with::h5afbe2ebf53cd09f + 253 (local.rs:262)
39  libwasmtime.dylib               0x000000010f7d1e60 std::thread::local::LocalKey$LT$T$GT$::with::had9e0ec9e0efdafb + 48 (local.rs:239)
40  libwasmtime.dylib               0x000000010f7fff3c wasmtime_runtime::traphandlers::tls::set::h05ba0b7054f32ba0 + 60 (traphandlers.rs:590)
41  libwasmtime.dylib               0x000000010f7be9d3 wasmtime_runtime::traphandlers::CallThreadState::with::_$u7b$$u7b$closure$u7d$$u7d$::hd71ca41e35a2e24b + 195 (traphandlers.rs:434)
42  libwasmtime.dylib               0x000000010f8000fa wasmtime_runtime::traphandlers::tls::with::_$u7b$$u7b$closure$u7d$$u7d$::h7d32ba2acb06c7fe + 170 (traphandlers.rs:601)
43  libwasmtime.dylib               0x000000010f7d1f9b std::thread::local::LocalKey$LT$T$GT$::try_with::h527a0121f2d2ff09 + 251 (local.rs:262)
44  libwasmtime.dylib               0x000000010f7d1df7 std::thread::local::LocalKey$LT$T$GT$::with::h9ea0df510202099a + 55
45  libwasmtime.dylib               0x000000010f80003b wasmtime_runtime::traphandlers::tls::with::h50577ff01f6a129e + 59
46  libwasmtime.dylib               0x000000010f7be8d3 wasmtime_runtime::traphandlers::CallThreadState::with::h9708523a0125e9dd + 51 (traphandlers.rs:432)
47  libwasmtime.dylib               0x000000010f7be809 wasmtime_runtime::traphandlers::catch_traps::h03f0d10c4a1eecaa + 489 (traphandlers.rs:384)
48  libwasmtime.dylib               0x000000010f805259 wasmtime::func::Func::call::hf98f9e53dcf28bd1 + 1161 (func.rs:530)
49  libwasmtime.dylib               0x000000010f58d964 wasmtime::func::wasm_func_call::_$u7b$$u7b$closure$u7d$$u7d$::h35e240458febc54e + 84
50  libwasmtime.dylib               0x000000010f5411f0 core::ops::function::FnOnce::call_once::h6eac9b799daddc95 + 32 (function.rs:232)
51  libwasmtime.dylib               0x000000010f534934 _$LT$std..panic..AssertUnwindSafe$LT$F$GT$$u20$as$u20$core..ops..function..FnOnce$LT$$LP$$RP$$GT$$GT$::call_once::hbe2a7711d183cc27 + 36
52  libwasmtime.dylib               0x000000010f55b8be std::panicking::try::do_call::h0a237ef0c1d957b0 + 62 (panicking.rs:305)
53  libwasmtime.dylib               0x00000001103e340b __rust_maybe_catch_panic + 27 (lib.rs:94)
54  libwasmtime.dylib               0x000000010f55b78c std::panicking::try::h9e9a49438d44ff4b + 188 (panicking.rs:281)
55  libwasmtime.dylib               0x000000010f534964 std::panic::catch_unwind::habc0197a0168034f + 36
56  libwasmtime.dylib               0x000000010f59ca4d wasm_func_call + 477 (func.rs:178)
57  ???                             0x00000001200ff23b 0 + 4832883259
58  ???                             0x00000001200fee0b 0 + 4832882187
59  ???                             0x00000001200fea42 0 + 4832881218
60  ???                             0x000000011ce137ae 0 + 4779489198
61  ???                             0x000000011bd463eb 0 + 4761871339
62  ???                             0x00000001200fd6d2 0 + 4832876242
63  ???                             0x00000001200f8c50 0 + 4832857168
64  ???                             0x00000001200f8bc4 0 + 4832857028
65  ???                             0x00000001200f88a4 0 + 4832856228
66  ???                             0x00000001200fc81a 0 + 4832872474
67  libcoreclr.dylib                0x000000010c6e9c3b CallDescrWorkerInternal + 124
68  libcoreclr.dylib                0x000000010c5352a8 CallDescrWorkerWithHandler(CallDescrData*, int) + 104
69  libcoreclr.dylib                0x000000010c5f96df CallDescrWorkerReflectionWrapper(CallDescrData*, Frame*) + 127
70  libcoreclr.dylib                0x000000010c5fa667 RuntimeMethodHandle::InvokeMethod(Object*, PtrArray*, SignatureNative*, bool, bool) + 3143
</pre></div>


<p>&lt;/details&gt;</p>
</blockquote>



<a name="193279291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193279291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193279291">(Apr 08 2020 at 06:23)</a>:</h4>
<p>havarnov edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-610774523" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-610774523">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Now I'm both confused and unsure about what a commented 2 days ago. Seems like a posted the wrong stack trace?</p>
<p>Anyways, I'm sure the test is failing/passing inconsistently. Here's a new stack trace after running <code>dotnet test</code> on <a href="https://github.com/havarnov/wasmtime/commit/30e0655493c67cadf4099029e38fa726f896ea19" title="https://github.com/havarnov/wasmtime/commit/30e0655493c67cadf4099029e38fa726f896ea19">https://github.com/havarnov/wasmtime/commit/30e0655493c67cadf4099029e38fa726f896ea19</a>.</p>
<p>&lt;details&gt;</p>
<div class="codehilite"><pre><span></span>Thread 18:
0   libsystem_kernel.dylib          0x00007fff7017d4c2 __psynch_mutexwait + 10
1   libsystem_pthread.dylib         0x00007fff7023c62a _pthread_mutex_firstfit_lock_wait + 96
2   libsystem_pthread.dylib         0x00007fff7023a5e5 _pthread_mutex_firstfit_lock_slow + 222
3   libwasmtime.dylib               0x000000010fc16b35 std::sys::unix::mutex::Mutex::lock::h1dbae44fb498794c + 37 (mutex.rs:57)
4   libwasmtime.dylib               0x000000010fc166a8 std::sys_common::mutex::Mutex::raw_lock::h0320f6f2d66d3b9a + 24 (mutex.rs:42)
5   libwasmtime.dylib               0x000000010fc0f8c6 std::sync::mutex::Mutex$LT$T$GT$::lock::h3ff867185c94d556 + 38 (mutex.rs:219)
6   libwasmtime.dylib               0x000000010fc1759c backtrace::lock::lock::h8fc4afef87bf4cdd + 108
7   libwasmtime.dylib               0x000000010fc190a9 backtrace::backtrace::trace::h2c442a445ec5d23c + 25 (mod.rs:52)
8   libwasmtime.dylib               0x000000010fc0ad67 backtrace::capture::Backtrace::create::h6478de780a3e1ffe + 103 (capture.rs:164)
9   libwasmtime.dylib               0x000000010fc0aceb backtrace::capture::Backtrace::new_unresolved::h6faba8f13d41d24f + 27
10  libwasmtime.dylib               0x000000010f53fbb5 wasmtime::trap::Trap::new::h1a9eabfc567a0830 + 85 (trap.rs:32)
11  libwasmtime.dylib               0x000000010f5a8cd5 wasm_trap_new + 357 (trap.rs:43)
12  ???                             0x00000001200ffd7d 0 + 4832886141
13  ???                             0x00000001200ff9c4 0 + 4832885188
14  ???                             0x00000001200ff516 0 + 4832883990
15  libcoreclr.dylib                0x000000010c6eaca9 UMThunkStub + 273
16  libwasmtime.dylib               0x000000010f58d7fd wasmtime::func::wasm_func_new::_$u7b$$u7b$closure$u7d$$u7d$::h04b26d3696b68533 + 45 (func.rs:113)
17  libwasmtime.dylib               0x000000010f58d38d wasmtime::func::create_function::_$u7b$$u7b$closure$u7d$$u7d$::habe73ec684983f10 + 461 (func.rs:90)
18  libwasmtime.dylib               0x000000010f5af954 wasmtime::func::Func::new::_$u7b$$u7b$closure$u7d$$u7d$::heef410f7add1b585 + 948 (func.rs:246)
19  libwasmtime.dylib               0x000000010f7c0420 _$LT$alloc..boxed..Box$LT$F$GT$$u20$as$u20$core..ops..function..Fn$LT$A$GT$$GT$::call::h99249d428e1cf153 + 48 (boxed.rs:1029)
20  libwasmtime.dylib               0x000000010f7ba438 wasmtime::trampoline::func::stub_fn::call_stub::h3340fb5f082687a0 + 184 (func.rs:79)
21  libwasmtime.dylib               0x000000010f7d5cc1 wasmtime::trampoline::func::stub_fn::_$u7b$$u7b$closure$u7d$$u7d$::h5226b3d450958191 + 49 (func.rs:50)
22  libwasmtime.dylib               0x000000010f7ab91d core::ops::function::FnOnce::call_once::h39eca28141925286 + 13
23  libwasmtime.dylib               0x000000010f798ae8 _$LT$std..panic..AssertUnwindSafe$LT$F$GT$$u20$as$u20$core..ops..function..FnOnce$LT$$LP$$RP$$GT$$GT$::call_once::hac4b47668d95477a + 40 (panic.rs:318)
24  libwasmtime.dylib               0x000000010f80638d std::panicking::try::do_call::h6e790f5863cd1626 + 77 (panicking.rs:305)
25  libwasmtime.dylib               0x00000001103e340b __rust_maybe_catch_panic + 27 (lib.rs:94)
26  libwasmtime.dylib               0x000000010f80627b std::panicking::try::he4c645adab2154a6 + 187 (panicking.rs:281)
27  libwasmtime.dylib               0x000000010f798b2f std::panic::catch_unwind::ha8510c644ad9f868 + 47
28  libwasmtime.dylib               0x000000010f7ba206 wasmtime::trampoline::func::stub_fn::hadd0620c40df928e + 118 (func.rs:49)
29  ???                             0x000000011198301d 0 + 4590153757
30  ???                             0x00000001119630ee 0 + 4590022894
31  ???                             0x00000001119632e4 0 + 4590023396
32  libwasmtime.dylib               0x000000010f7e68fa wasmtime::func::Func::call::_$u7b$$u7b$closure$u7d$$u7d$::hf0de02914dcebcf0 + 106 (func.rs:537)
33  libwasmtime.dylib               0x000000010f7be618 wasmtime_runtime::traphandlers::catch_traps::call_closure::ha8fe22ead980de5c + 24 (traphandlers.rs:397)
34  libwasmtime.dylib               0x000000010fc071b6 RegisterSetjmp + 118 (helpers.c:13)
35  libwasmtime.dylib               0x000000010f7be88d wasmtime_runtime::traphandlers::catch_traps::_$u7b$$u7b$closure$u7d$$u7d$::hd670f25e8930dd8e + 61 (traphandlers.rs:385)
36  libwasmtime.dylib               0x000000010f7bf678 wasmtime_runtime::traphandlers::CallThreadState::with::_$u7b$$u7b$closure$u7d$$u7d$::_$u7b$$u7b$closure$u7d$$u7d$::he43f22d21542f808 + 40 (traphandlers.rs:434)
37  libwasmtime.dylib               0x000000010f7fffa9 wasmtime_runtime::traphandlers::tls::set::_$u7b$$u7b$closure$u7d$$u7d$::h33448bea1c38356f + 89 (traphandlers.rs:592)
38  libwasmtime.dylib               0x000000010f7d20dd std::thread::local::LocalKey$LT$T$GT$::try_with::h5afbe2ebf53cd09f + 253 (local.rs:262)
39  libwasmtime.dylib               0x000000010f7d1e60 std::thread::local::LocalKey$LT$T$GT$::with::had9e0ec9e0efdafb + 48 (local.rs:239)
40  libwasmtime.dylib               0x000000010f7fff3c wasmtime_runtime::traphandlers::tls::set::h05ba0b7054f32ba0 + 60 (traphandlers.rs:590)
41  libwasmtime.dylib               0x000000010f7be9d3 wasmtime_runtime::traphandlers::CallThreadState::with::_$u7b$$u7b$closure$u7d$$u7d$::hd71ca41e35a2e24b + 195 (traphandlers.rs:434)
42  libwasmtime.dylib               0x000000010f8000fa wasmtime_runtime::traphandlers::tls::with::_$u7b$$u7b$closure$u7d$$u7d$::h7d32ba2acb06c7fe + 170 (traphandlers.rs:601)
43  libwasmtime.dylib               0x000000010f7d1f9b std::thread::local::LocalKey$LT$T$GT$::try_with::h527a0121f2d2ff09 + 251 (local.rs:262)
44  libwasmtime.dylib               0x000000010f7d1df7 std::thread::local::LocalKey$LT$T$GT$::with::h9ea0df510202099a + 55
45  libwasmtime.dylib               0x000000010f80003b wasmtime_runtime::traphandlers::tls::with::h50577ff01f6a129e + 59
46  libwasmtime.dylib               0x000000010f7be8d3 wasmtime_runtime::traphandlers::CallThreadState::with::h9708523a0125e9dd + 51 (traphandlers.rs:432)
47  libwasmtime.dylib               0x000000010f7be809 wasmtime_runtime::traphandlers::catch_traps::h03f0d10c4a1eecaa + 489 (traphandlers.rs:384)
48  libwasmtime.dylib               0x000000010f805259 wasmtime::func::Func::call::hf98f9e53dcf28bd1 + 1161 (func.rs:530)
49  libwasmtime.dylib               0x000000010f58d964 wasmtime::func::wasm_func_call::_$u7b$$u7b$closure$u7d$$u7d$::h35e240458febc54e + 84
50  libwasmtime.dylib               0x000000010f5411f0 core::ops::function::FnOnce::call_once::h6eac9b799daddc95 + 32 (function.rs:232)
51  libwasmtime.dylib               0x000000010f534934 _$LT$std..panic..AssertUnwindSafe$LT$F$GT$$u20$as$u20$core..ops..function..FnOnce$LT$$LP$$RP$$GT$$GT$::call_once::hbe2a7711d183cc27 + 36
52  libwasmtime.dylib               0x000000010f55b8be std::panicking::try::do_call::h0a237ef0c1d957b0 + 62 (panicking.rs:305)
53  libwasmtime.dylib               0x00000001103e340b __rust_maybe_catch_panic + 27 (lib.rs:94)
54  libwasmtime.dylib               0x000000010f55b78c std::panicking::try::h9e9a49438d44ff4b + 188 (panicking.rs:281)
55  libwasmtime.dylib               0x000000010f534964 std::panic::catch_unwind::habc0197a0168034f + 36
56  libwasmtime.dylib               0x000000010f59ca4d wasm_func_call + 477 (func.rs:178)
57  ???                             0x00000001200ff23b 0 + 4832883259
58  ???                             0x00000001200fee0b 0 + 4832882187
59  ???                             0x00000001200fea42 0 + 4832881218
60  ???                             0x000000011ce137ae 0 + 4779489198
61  ???                             0x000000011bd463eb 0 + 4761871339
62  ???                             0x00000001200fd6d2 0 + 4832876242
63  ???                             0x00000001200f8c50 0 + 4832857168
64  ???                             0x00000001200f8bc4 0 + 4832857028
65  ???                             0x00000001200f88a4 0 + 4832856228
66  ???                             0x00000001200fc81a 0 + 4832872474
67  libcoreclr.dylib                0x000000010c6e9c3b CallDescrWorkerInternal + 124
68  libcoreclr.dylib                0x000000010c5352a8 CallDescrWorkerWithHandler(CallDescrData*, int) + 104
69  libcoreclr.dylib                0x000000010c5f96df CallDescrWorkerReflectionWrapper(CallDescrData*, Frame*) + 127
70  libcoreclr.dylib                0x000000010c5fa667 RuntimeMethodHandle::InvokeMethod(Object*, PtrArray*, SignatureNative*, bool, bool) + 3143
</pre></div>


<p>&lt;/details&gt;</p>
</blockquote>



<a name="193281836"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193281836" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193281836">(Apr 08 2020 at 07:09)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-610790935" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-610790935">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Hm that also looks pretty normal, are you sure that was the thread which crashed?</p>
</blockquote>



<a name="193355628"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193355628" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193355628">(Apr 08 2020 at 17:55)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611102261" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611102261">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I don't know how I manage to mess this up every time :/</p>
<p>I run <code>dotnet test --filter ItThrowsOnOutOfBoundsMemoryAccess</code>.</p>
<p>It has three different outcomes:</p>
<ol>
<li>test pass</li>
<li>test process hangs</li>
<li>test process crashes (with the provided report)</li>
</ol>
<p>Crashed thread stack trace:<br>
&lt;details&gt;</p>
<div class="codehilite"><pre><span></span>Thread 18 Crashed:
0   libwasmtime.dylib               0x0000000113b856b9 __rbt_macho_add_symtab + 1353
1   libwasmtime.dylib               0x0000000113b84740 __rbt_macho_add + 1920
2   libwasmtime.dylib               0x0000000113b83e31 __rbt_backtrace_initialize + 337
3   libwasmtime.dylib               0x0000000113b834ef fileline_initialize + 735
4   libwasmtime.dylib               0x0000000113b835ed __rbt_backtrace_syminfo + 45
5   libwasmtime.dylib               0x0000000113b6f4df backtrace::symbolize::libbacktrace::resolve::h719e8a9f1adb8fe1 + 159 (libbacktrace.rs:469)
6   libwasmtime.dylib               0x0000000113b72ab8 backtrace::symbolize::resolve_frame_unsynchronized::h7ca357de7ff98157 + 56 (mod.rs:178)
7   libwasmtime.dylib               0x0000000113b728f0 backtrace::symbolize::resolve_frame::h75c5abc2a861fa2d + 80 (mod.rs:105)
8   libwasmtime.dylib               0x0000000113b6b13c backtrace::capture::Backtrace::resolve::he887e05906dda0c3 + 348 (capture.rs:219)
9   libwasmtime.dylib               0x0000000113b6ac8c backtrace::capture::Backtrace::new::hde48dbbe07c85c38 + 60 (capture.rs:129)
10  libwasmtime.dylib               0x0000000113b3cfd0 wasmtime_runtime::traphandlers::Trap::wasm::h1cad6bcb8cc876a1 + 64 (traphandlers.rs:360)
11  libwasmtime.dylib               0x0000000113b55532 wasmtime_runtime::instance::initialize_memories::hd1e791bdc211efcb + 514 (instance.rs:1326)
12  libwasmtime.dylib               0x0000000113b52d91 wasmtime_runtime::instance::InstanceHandle::new::h7ed6837db8af70f4 + 6369 (instance.rs:978)
13  libwasmtime.dylib               0x00000001138b2895 wasmtime_jit::instantiate::CompiledModule::instantiate::h4ab8e22914e45208 + 1237 (instantiate.rs:216)
14  libwasmtime.dylib               0x00000001136feed6 wasmtime::instance::instantiate::hf4f7fd3334ac0a8b + 150 (instance.rs:29)
15  libwasmtime.dylib               0x00000001136ff296 wasmtime::instance::Instance::new::h724eb3a5b0218b1a + 598 (instance.rs:128)
16  libwasmtime.dylib               0x00000001136f755e wasmtime::linker::Linker::instantiate::h55a563d6e112071b + 2878 (linker.rs:395)
17  libwasmtime.dylib               0x00000001134ff6c4 wasmtime_linker_instantiate + 132 (linker.rs:85)
18  ???                             0x000000011be0093e 0 + 4762634558
19  ???                             0x000000011be003b2 0 + 4762633138
20  ???                             0x000000011be002ef 0 + 4762632943
21  ???                             0x000000011be00143 0 + 4762632515
22  ???                             0x000000011be00070 0 + 4762632304
23  ???                             0x000000011bdfffe4 0 + 4762632164
24  ???                             0x000000011bdff3f4 0 + 4762629108
25  ???                             0x000000011bdfdcc3 0 + 4762623171
26  libcoreclr.dylib                0x0000000110429c3b CallDescrWorkerInternal + 124
27  libcoreclr.dylib                0x00000001102752a8 CallDescrWorkerWithHandler(CallDescrData*, int) + 104
28  libcoreclr.dylib                0x00000001103396df CallDescrWorkerReflectionWrapper(CallDescrData*, Frame*) + 127
29  libcoreclr.dylib                0x000000011033a667 RuntimeMethodHandle::InvokeMethod(Object*, PtrArray*, SignatureNative*, bool, bool) + 3143
30  ???                             0x0000000116a6750a 0 + 4674974986
31  ???                             0x0000000116a618a9 0 + 4674951337
32  ???                             0x000000011bdfdb89 0 + 4762622857
33  ???                             0x000000011bdfd799 0 + 4762621849
34  ???                             0x000000011bdfcd46 0 + 4762619206
35  ???                             0x000000011bdfcc65 0 + 4762618981
36  ???                             0x000000011bdfcbe0 0 + 4762618848
37  ???                             0x000000011bdfc999 0 + 4762618265
38  ???                             0x000000011bdfc863 0 + 4762617955
39  ???                             0x000000011bdfc7bb 0 + 4762617787
40  ???                             0x000000011bdfc76c 0 + 4762617708
41  ???                             0x000000011bdfc6d5 0 + 4762617557
42  ???                             0x000000011bdfc47d 0 + 4762616957
43  ???                             0x000000011bdfc363 0 + 4762616675
44  ???                             0x000000011bdfc2bb 0 + 4762616507
45  ???                             0x000000011bdfc26c 0 + 4762616428
46  ???                             0x000000011bdfbd16 0 + 4762615062
47  ???                             0x000000011bdfb5e6 0 + 4762613222
48  ???                             0x000000011bdfb505 0 + 4762612997
49  ???                             0x000000011bdfb480 0 + 4762612864
50  ???                             0x000000011bdfb292 0 + 4762612370
51  ???                             0x000000011bdf9c39 0 + 4762606649
52  ???                             0x000000011bdf9356 0 + 4762604374
53  ???                             0x000000011bdf9275 0 + 4762604149
54  ???                             0x000000011bdf91f0 0 + 4762604016
55  ???                             0x000000011bdf8f85 0 + 4762603397
56  ???                             0x000000011bdf8e53 0 + 4762603091
57  ???                             0x000000011bdf8dab 0 + 4762602923
58  ???                             0x000000011bdf8d1c 0 + 4762602780
59  ???                             0x000000011bdf8c5e 0 + 4762602590
60  ???                             0x000000011bdf85ae 0 + 4762600878
61  ???                             0x000000011bdf82a5 0 + 4762600101
62  ???                             0x000000011bdf8103 0 + 4762599683
63  ???                             0x000000011bdf805f 0 + 4762599519
64  ???                             0x000000011bdf8000 0 + 4762599424
65  ???                             0x000000011bdf7b5a 0 + 4762598234
66  ???                             0x000000011bdf781e 0 + 4762597406
67  ???                             0x000000011bdf7506 0 + 4762596614
68  ???                             0x000000011bdf7425 0 + 4762596389
69  ???                             0x000000011bdf7368 0 + 4762596200
70  ???                             0x000000011bdf6b02 0 + 4762594050
71  ???                             0x000000011bdf6276 0 + 4762591862
72  ???                             0x000000011bdf6195 0 + 4762591637
73  ???                             0x000000011bdf60fa 0 + 4762591482
74  ???                             0x000000011bdf49d1 0 + 4762585553
75  ???                             0x000000011bdf404c 0 + 4762583116
76  ???                             0x000000011bdf3d16 0 + 4762582294
77  ???                             0x000000011bdf3c35 0 + 4762582069
78  ???                             0x000000011bdf3b9a 0 + 4762581914
79  ???                             0x000000011bdf3783 0 + 4762580867
80  ???                             0x000000011bdf3636 0 + 4762580534
81  ???                             0x000000011bdf327a 0 + 4762579578
82  ???                             0x000000011bdf2c66 0 + 4762578022
83  ???                             0x000000011bdf2b85 0 + 4762577797
84  ???                             0x000000011bdf2aea 0 + 4762577642
85  ???                             0x000000011bdf244d 0 + 4762575949
86  ???                             0x000000011bdf21e6 0 + 4762575334
87  ???                             0x000000011bdf2105 0 + 4762575109
88  ???                             0x000000011bdf206a 0 + 4762574954
89  ???                             0x000000011bdf1c2e 0 + 4762573870
90  ???                             0x000000011bdf028c 0 + 4762567308
91  ???                             0x000000011bdefec6 0 + 4762566342
92  ???                             0x000000011bdefde5 0 + 4762566117
93  ???                             0x000000011bdefd4a 0 + 4762565962
94  ???                             0x000000011bde90ef 0 + 4762538223
95  ???                             0x000000011bde8976 0 + 4762536310
96  ???                             0x000000011bde8895 0 + 4762536085
97  ???                             0x000000011bde87fa 0 + 4762535930
98  ???                             0x000000011bde82c7 0 + 4762534599
99  ???                             0x000000011bde7c4b 0 + 4762532939
100 ???                             0x000000011bde78f6 0 + 4762532086
101 ???                             0x000000011bde7815 0 + 4762531861
102 ???                             0x000000011bde737a 0 + 4762530682
103 ???                             0x000000011bde5ba0 0 + 4762524576
104 ???                             0x000000011bde5836 0 + 4762523702
105 ???                             0x000000011bde5755 0 + 4762523477
106 ???                             0x000000011bde52ba 0 + 4762522298
107 ???                             0x000000011bde4dfc 0 + 4762521084
108 ???                             0x000000011bde4d10 0 + 4762520848
109 ???                             0x00000001169ed4f1 0 + 4674475249
110 ???                             0x00000001169fa1e2 0 + 4674527714
111 ???                             0x00000001169deba1 0 + 4674415521
112 ???                             0x00000001169f4642 0 + 4674504258
113 ???                             0x00000001169f43de 0 + 4674503646
114 ???                             0x0000000116a00c19 0 + 4674554905
115 ???                             0x000000011bde4be3 0 + 4762520547
116 ???                             0x00000001169deba1 0 + 4674415521
117 ???                             0x000000011bde4b62 0 + 4762520418
118 ???                             0x000000011bde1faa 0 + 4762509226
119 ???
[message truncated]
</pre></div>


</blockquote>



<a name="193368123"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193368123" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193368123">(Apr 08 2020 at 19:33)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611150356" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611150356">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@havarnov ok that definitely looks like a bug! I don't think it's the same issue as before though because it doesn't look like there's any wasm code on the stack. This may perhaps mean there's a bug in the <code>backtrace</code> crate or we're generating invalid debuginfo or something like that.</p>
<p>Would it be possible to reduce this to a small thing that can be reproduced locally?</p>
</blockquote>



<a name="193408337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193408337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193408337">(Apr 09 2020 at 05:22)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611334606" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611334606">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@alexcrichton not sure what you mean about a "small thing"? Isn't the <a href="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/OutOfBoundsMemoryAccessTests.cs#L37-L48" title="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/OutOfBoundsMemoryAccessTests.cs#L37-L48">test I provided ok for testing</a>? Or were you thinking of a small console application?</p>
</blockquote>



<a name="193601647"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193601647" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193601647">(Apr 10 2020 at 18:29)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612158669" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612158669">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>Hm so ideally we could get a reproduction with just the Rust API. Failing that a reproduction with just the C API would be great. Failing that a reproduction with a small example in the dotnet API would be great too. The dotnet extension has moved around a bit and it looks like the test <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611102261" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-611102261">mentioned here</a> has either been renamed or no longer exists. Would it be possible to help reduce this to something standalone which can be reproduced today?</p>
</blockquote>



<a name="193652248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193652248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193652248">(Apr 11 2020 at 09:53)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612381818" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612381818">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@alexcrichton I'll look into reproducing this bug in rust or the c api. The test I refered to was one I created in my fork of this repo, <a href="https://github.com/havarnov/wasmtime/tree/outofboundsmemoryaccess" title="https://github.com/havarnov/wasmtime/tree/outofboundsmemoryaccess">https://github.com/havarnov/wasmtime/tree/outofboundsmemoryaccess</a>. That's why I asked if you wanted a PR with the new test.</p>
<p>I'll come back when I have something more to show, or I need more help. Ok?</p>
</blockquote>



<a name="193678713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193678713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193678713">(Apr 11 2020 at 20:45)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612510175" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612510175">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@alexcrichton I need some help on this one. I'm trying to reproduce this by using the wasmtime api directly as follows, which to the best of my knowledge mimics the test I've written from the dotnet side.</p>
<div class="codehilite"><pre><span></span><span class="cp">#[test]</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">outofbounds_memory</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Store</span>::<span class="n">default</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linker</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">store</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryType</span>::<span class="n">new</span><span class="p">(</span><span class="n">Limits</span>::<span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Memory</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="n">ty</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linker</span><span class="p">.</span><span class="n">define</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mem&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">memory</span><span class="p">).</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Should be able to define memory item.&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">wat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="err">#</span><span class="s">&quot;</span>
<span class="s">        (module</span>
<span class="s">            (import &quot;&quot; &quot;</span><span class="n">mem</span><span class="s">&quot; (memory $m 1 2))</span>
<span class="s">            (data (i32.const 65535) &quot;</span><span class="err">\</span><span class="mi">01</span><span class="s">&quot;)</span>
<span class="s">            (data (i32.const 65536) &quot;</span><span class="err">\</span><span class="mi">02</span><span class="s">&quot;)</span>
<span class="s">        )</span>
<span class="s">    &quot;</span><span class="err">#</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Module</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="n">wat</span><span class="p">)</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">trap</span><span class="o">=</span><span class="w"> </span><span class="n">linker</span><span class="p">.</span><span class="n">instantiate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">module</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">err</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">downcast</span>::<span class="o">&lt;</span><span class="n">Trap</span><span class="o">&gt;</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">trap</span><span class="p">.</span><span class="n">message</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="s">&quot;wasm trap: out of bounds memory access, source location: @-&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>As you can see I'm expecting this to be "trapped" with the "out of bounds memory access" message. This is after all what I'm seeing from the dotnet side of things when the test _does_ pass. But what I'm getting is a linker error from <code>linker.instantiate</code>:</p>
<div class="codehilite"><pre><span></span>Failed to link module

Caused by:
    Link error: memory out of bounds: data segment does not fit
</pre></div>


</blockquote>



<a name="193778552"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193778552" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193778552">(Apr 13 2020 at 14:42)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612927714" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-612927714">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I believe that's the expected error from that test. I don't really know much about C# testing, but you've got <a href="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/OutOfBoundsMemoryAccessTests.cs" title="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/OutOfBoundsMemoryAccessTests.cs">two tests defined in that file</a>, is it possible that they're sharing access to the same linker by accident?</p>
</blockquote>



<a name="193803547"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193803547" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193803547">(Apr 13 2020 at 18:27)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613028410" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613028410">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>The <code>ClearDefinitions</code> call should instantiate a new linker between the different test executions, I believe (iirc my xUnit semantics correctly, at least). </p>
</blockquote>



<a name="193803703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193803703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193803703">(Apr 13 2020 at 18:28)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613028410" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613028410">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>The <code>ClearDefinitions</code> call should instantiate a new linker between the different test executions, I believe (iirc xUnit semantics correctly, at least). </p>
<p>Although, reusing the definitions seems like the probable cause of the failure.</p>
</blockquote>



<a name="193803719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193803719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193803719">(Apr 13 2020 at 18:28)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613028410" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613028410">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>The <code>ClearDefinitions</code> call should instantiate a new linker between the different test executions, I believe (iirc xUnit semantics correctly, at least). </p>
<p>Although, reusing the definitions seems like the probable cause of the failure.  I can look into this.</p>
</blockquote>



<a name="193808509"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193808509" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193808509">(Apr 13 2020 at 19:08)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613047081" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613047081">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I'm not able to reproduce the failure of either of those two tests (both pass as-is).</p>
<p>I verified that <code>ClearDefinitions</code> is called for each test run, so a linker should not be shared between the runs.</p>
</blockquote>



<a name="193932230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193932230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193932230">(Apr 14 2020 at 17:38)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613580688" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613580688">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@peterhuene interesting that it does fail on your machine. Just so there's no misunderstandings, it's the test name <code>ItThrowsOnOutOfBoundsMemoryAccess</code> that's inconsistently passes.</p>
<p>I will try to get the <code>"wasm trap: out of bounds memory access, source location: @-"</code> trap message from my rust test aswell, and see if that's working consistently.</p>
</blockquote>



<a name="193938228"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193938228" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193938228">(Apr 14 2020 at 18:26)</a>:</h4>
<p>havarnov <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613605396" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613605396">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I think I have pinpointed this a bit more. The <code>ModuleFixture</code> in the dotnet test builds the Host as follows:</p>
<div class="codehilite"><pre><span></span>        public ModuleFixture()
        {
            Host = new HostBuilder()
                .WithMultiValue(true)
                .WithReferenceTypes(true)
                .Build();

            Module = Host.LoadModuleText(Path.Combine(&quot;Modules&quot;, ModuleFileName));
        }
</pre></div>


<p>If I comment out <code>.WithReferenceTypes(true)</code> the test now fails consistently with the following error message:</p>
<div class="codehilite"><pre><span></span>Error Message:
   Expected exception message to match the equivalent of
&quot;wasm trap: out of bounds memory access, source location: @-&quot;, but
&quot;Failed to link module

Caused by:
    Link error: memory out of bounds: data segment does not fit&quot; does not.
</pre></div>


</blockquote>



<a name="193938507"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193938507" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193938507">(Apr 14 2020 at 18:28)</a>:</h4>
<p>havarnov edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613605396" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613605396">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>I think I have pinpointed this a bit more. The <code>ModuleFixture</code> in the dotnet test builds the Host as follows:</p>
<div class="codehilite"><pre><span></span>        public ModuleFixture()
        {
            Host = new HostBuilder()
                .WithMultiValue(true)
                .WithReferenceTypes(true)
                .Build();

            Module = Host.LoadModuleText(Path.Combine(&quot;Modules&quot;, ModuleFileName));
        }
</pre></div>


<p>EDIT: but to investigate this further I need some help from you guys; @alexcrichton @peterhuene </p>
<p>If I comment out <code>.WithReferenceTypes(true)</code> the test now fails consistently with the following error message:</p>
<div class="codehilite"><pre><span></span>Error Message:
   Expected exception message to match the equivalent of
&quot;wasm trap: out of bounds memory access, source location: @-&quot;, but
&quot;Failed to link module

Caused by:
    Link error: memory out of bounds: data segment does not fit&quot; does not.
</pre></div>


</blockquote>



<a name="193956703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193956703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193956703">(Apr 14 2020 at 21:01)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613679403" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613679403">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>@havarnov that's correct, the <code>ItThrowsOnOutOfBoundsMemoryAccess</code> test consistently <em>passes</em> for me.  I reran the tests 100 times and they all succeeded.</p>
<p>My steps to reproduce:</p>
<ol>
<li><code>git clone git@github.com:bytecodealliance/wasmtime-dotnet.git</code></li>
<li><code>cd wasmtime-dotnet</code></li>
<li>I created <code>tests/OutOfBoundsMemoryAccessTests.cs</code> with the contents of <a href="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/OutOfBoundsMemoryAccessTests.cs" title="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/OutOfBoundsMemoryAccessTests.cs">this file</a>.</li>
<li>I created <code>tests/Modules/OutOfBoundsMemoryAccess.wat</code> with the contents of <a href="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/Modules/OutOfBoundsMemoryAccess.wat" title="https://github.com/havarnov/wasmtime/blob/30e0655493c67cadf4099029e38fa726f896ea19/crates/misc/dotnet/tests/Modules/OutOfBoundsMemoryAccess.wat">this file</a>.</li>
<li><code>dotnet test</code> in a loop 100 times, breaking if failure.</li>
</ol>
<p>All test runs were successful.</p>
<p>I'll see if I can reproduce it with your older <code>wasmtime</code>-based branch.</p>
</blockquote>



<a name="193956976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193956976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193956976">(Apr 14 2020 at 21:04)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613680536" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613680536">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>However, I <em>was able to reproduce</em> the link error if support for reference types is disabled.</p>
<div class="codehilite"><pre><span></span>   Expected a &lt;Wasmtime.TrapException&gt; to be thrown, but found &lt;Wasmtime.WasmtimeException&gt;: &quot;
&quot;Wasmtime.WasmtimeException with message &quot;Failed to link module

Caused by:
    Link error: memory out of bounds: data segment does not fit
</pre></div>


</blockquote>



<a name="193957248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193957248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193957248">(Apr 14 2020 at 21:06)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613681644" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613681644">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>It appears to be a link-time error without reference types enabled <a href="https://github.com/bytecodealliance/wasmtime/blob/7eea5d8d438bf0d65710410c0acc58e5b27018d7/crates/runtime/src/instance.rs#L973-L976" title="https://github.com/bytecodealliance/wasmtime/blob/7eea5d8d438bf0d65710410c0acc58e5b27018d7/crates/runtime/src/instance.rs#L973-L976">by design</a>.</p>
</blockquote>



<a name="193957636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231431%20Out%20of%20bounds%20memory%20access%20not%20co.../near/193957636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231431.20Out.20of.20bounds.20memory.20access.20not.20co.2E.2E.2E.html#193957636">(Apr 14 2020 at 21:10)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613681644" title="https://github.com/bytecodealliance/wasmtime/issues/1431#issuecomment-613681644">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1431" title="https://github.com/bytecodealliance/wasmtime/issues/1431">Issue #1431</a>:</p>
<blockquote>
<p>It appears to be a link-time error without reference types enabled <a href="https://github.com/bytecodealliance/wasmtime/blob/7eea5d8d438bf0d65710410c0acc58e5b27018d7/crates/runtime/src/instance.rs#L973-L976" title="https://github.com/bytecodealliance/wasmtime/blob/7eea5d8d438bf0d65710410c0acc58e5b27018d7/crates/runtime/src/instance.rs#L973-L976">by design</a>.</p>
<p>This is because the reference types feature implicitly enables the bulk-memory feature.  Without it, you'll get the linker error.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>