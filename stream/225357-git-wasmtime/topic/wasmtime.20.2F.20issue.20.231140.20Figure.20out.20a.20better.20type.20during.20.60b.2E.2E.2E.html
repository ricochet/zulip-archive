<html>
<head><meta charset="utf-8"><title>wasmtime / issue #1140 Figure out a better type during `b... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.231140.20Figure.20out.20a.20better.20type.20during.20.60b.2E.2E.2E.html">wasmtime / issue #1140 Figure out a better type during `b...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="281232917"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%231140%20Figure%20out%20a%20better%20type%20during%20%60b.../near/281232917" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.231140.20Figure.20out.20a.20better.20type.20during.20.60b.2E.2E.2E.html#281232917">(May 04 2022 at 23:09)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/1140#issuecomment-1118013978">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1140">issue #1140</a>:</p>
<blockquote>
<p>Is this still a relevant issue with the new backends @abrown?</p>
</blockquote>



<a name="281233230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%231140%20Figure%20out%20a%20better%20type%20during%20%60b.../near/281233230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.231140.20Figure.20out.20a.20better.20type.20during.20.60b.2E.2E.2E.html#281233230">(May 04 2022 at 23:12)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/issues/1140#issuecomment-1118016126">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1140">issue #1140</a>:</p>
<blockquote>
<p>Nope, closing.</p>
</blockquote>



<a name="281233232"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%231140%20Figure%20out%20a%20better%20type%20during%20%60b.../near/281233232" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.231140.20Figure.20out.20a.20better.20type.20during.20.60b.2E.2E.2E.html#281233232">(May 04 2022 at 23:12)</a>:</h4>
<p>abrown closed <a href="https://github.com/bytecodealliance/wasmtime/issues/1140">issue #1140</a>:</p>
<blockquote>
<p>As noted in <a href="https://github.com/CraneStation/cranelift/pull/1120#discussion_r335156013">https://github.com/CraneStation/cranelift/pull/1120#discussion_r335156013</a>, when moving a scalar value (<code>I32</code> or <code>I64</code>) to a vector register in x86, the destination must be a a <code>I64x2</code> due to typing restrictions that ensure vectors have more than one lane. This may be rather confusing when looking at CLIF IR because the intent of that move (using the <code>bitcast</code> instruction) is to zero out the upper bits and only load the lower bits using the scalar value--it's more a <code>I128x1</code> than anything else.</p>
<p>There are several options here, some of which are:</p>
<ul>
<li>leave as-is with <code>I64x2</code> and remove the TODO comment</li>
<li>change the typing restrictions to allow <code>I128x1</code></li>
<li>use a different CLIF instruction altogether</li>
<li>etc.</li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>