<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1556 Test suite fails on darwin in Cran... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html">wasmtime / Issue #1556 Test suite fails on darwin in Cran...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="194666025"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/194666025" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#194666025">(Apr 20 2020 at 12:14)</a>:</h4>
<p>nomeata opened <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Trying to upgrade <code>wasmtime</code> in nixpks via <a href="https://github.com/NixOS/nixpkgs/pull/85602" title="https://github.com/NixOS/nixpkgs/pull/85602">https://github.com/NixOS/nixpkgs/pull/85602</a><br>
 I get the following build error</p>
<div class="codehilite"><pre><span></span>thread &#39;Cranelift::spec::skip_stack_guard_page&#39; has overflowed its stack
fatal runtime error: stack overflow
error: test failed, to rerun pass &#39;--test wast_testsuites&#39;
Caused by:
  process didn&#39;t exit successfully: `/private/tmp/nix-build-wasmtime-0.15.0.drv-0/source/target/debug/deps/wast_testsuites-eaac573cefb8aa83` (signal: 6, SIGABRT: process abort signal)
</pre></div>


<p>Full log at <a href="https://logs.nix.ci/?key=nixos/nixpkgs.85602&amp;attempt_id=83a9c69d-7d43-491e-959c-9d974a859018" title="https://logs.nix.ci/?key=nixos/nixpkgs.85602&amp;attempt_id=83a9c69d-7d43-491e-959c-9d974a859018">https://logs.nix.ci/?key=nixos/nixpkgs.85602&amp;attempt_id=83a9c69d-7d43-491e-959c-9d974a859018</a></p>
</blockquote>



<a name="194681088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/194681088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#194681088">(Apr 20 2020 at 14:20)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616585519" title="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616585519">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Is it possible to debug the builders and get perhaps a full stack trace and/or more info for the fault here?</p>
</blockquote>



<a name="194684801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/194684801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#194684801">(Apr 20 2020 at 14:44)</a>:</h4>
<p>nomeata <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616600133" title="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616600133">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>I’ll try to reproduce it locally and see if I can get something</p>
</blockquote>



<a name="194685632"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/194685632" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#194685632">(Apr 20 2020 at 14:50)</a>:</h4>
<p>Mic92 <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616604056" title="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616604056">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Maybe you can do something like</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="ss">preCheck =</span> <span class="s1">&#39;&#39;</span>
<span class="s1">    export RUST_BACKTRACE=1</span>
<span class="s1">  &#39;&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>and re-run ofborg.</p>
</blockquote>



<a name="194687315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/194687315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#194687315">(Apr 20 2020 at 15:02)</a>:</h4>
<p>nomeata <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616611441" title="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-616611441">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Tried that locally, but it didn’t produce any new output</p>
</blockquote>



<a name="196062335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/196062335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#196062335">(May 02 2020 at 17:41)</a>:</h4>
<p>nomeata <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-622989264" title="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-622989264">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Just for the record: I failed to debug this, and don’t expect I will be able to, it’s out of my expertise.</p>
</blockquote>



<a name="196124970"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/196124970" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#196124970">(May 03 2020 at 21:46)</a>:</h4>
<p>jyn514 <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-623187502" title="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-623187502">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556" title="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<blockquote>
<p>Is it possible to debug the builders and get perhaps a full stack trace and/or more info for the fault here?</p>
</blockquote>
<p>In general, Rust does not generate backtraces for stack overflows. You would have to use <code>gdb</code> on the process, something like this:</p>
<div class="codehilite"><pre><span></span><code>$ gdb /home/joshua/.local/lib/cargo/target/debug/rcc
Reading symbols from /home/joshua/.local/lib/cargo/target/debug/rcc...done.
warning: Missing auto-load script at offset 0 in section .debug_gdb_scripts
of file /home/joshua/.local/lib/cargo/target/debug/rcc.
Use `info auto-load python-scripts [REGEXP]&#39; to list them.
(gdb) run crash.c
Starting program: /home/joshua/.local/lib/cargo/target/debug/rcc crash.c
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.

Program received signal SIGSEGV, Segmentation fault.
0x0000555555e4754b in core::ptr::const_ptr::&lt;impl *const T&gt;::offset (
    self=0x7fffff7ff2a4 &quot;\017\000&quot;, count=0)
    at /rustc/4fb7144ed159f94491249e86d5bbd033b5d60550/src/libcore/ptr/const_ptr.rs:160
160 /rustc/4fb7144ed159f94491249e86d5bbd033b5d60550/src/libcore/ptr/const_ptr.rs: No such file or directory.
(gdb) where
#0  0x0000555555e4754b in core::ptr::const_ptr::&lt;impl *const T&gt;::offset (
    self=0x7fffff7ff2a4 &quot;\017\000&quot;, count=0)
    at /rustc/4fb7144ed159f94491249e86d5bbd033b5d60550/src/libcore/ptr/const_ptr.rs:160
#1  0x0000555555e47514 in core::ptr::const_ptr::&lt;impl *const T&gt;::add (
    self=0x7fffff7ff2a4 &quot;\017\000&quot;, count=0)
    at /rustc/4fb7144ed159f94491249e86d5bbd033b5d60550/src/libcore/ptr/const_ptr.rs:399
... etc ...
</code></pre></div>


<p>Since it's in the test suite, you'll use the binary that <code>cargo test</code> generates, something like this:</p>
<div class="codehilite"><pre><span></span><code>$ cargo test --lib noop
    Finished test [unoptimized + debuginfo] target(s) in 0.08s
     Running /home/joshua/.local/lib/cargo/target/debug/deps/rcc-d000a597a330c054

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 117 filtered out

$ gdb /home/joshua/.local/lib/cargo/target/debug/deps/rcc-d000a597a330c054
Reading symbols from /home/joshua/.local/lib/cargo/target/debug/deps/rcc-d000a597a330c054...done.
(gdb)
</code></pre></div>


</blockquote>



<a name="197786875"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/197786875" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#197786875">(May 16 2020 at 09:34)</a>:</h4>
<p>nomeata <a href="https://github.com/bytecodealliance/wasmtime/issues/1556#issuecomment-629617328">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Reportedly fixed in 0.16, according to <a href="https://github.com/ggreif/nixpkgs/commit/d89ae377d4b57415b1b00f2aa8e5a1655a1724b9">https://github.com/ggreif/nixpkgs/commit/d89ae377d4b57415b1b00f2aa8e5a1655a1724b9</a></p>
</blockquote>



<a name="197786876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231556%20Test%20suite%20fails%20on%20darwin%20in%20Cran.../near/197786876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231556.20Test.20suite.20fails.20on.20darwin.20in.20Cran.2E.2E.2E.html#197786876">(May 16 2020 at 09:34)</a>:</h4>
<p>nomeata closed <a href="https://github.com/bytecodealliance/wasmtime/issues/1556">Issue #1556</a>:</p>
<blockquote>
<p>Trying to upgrade <code>wasmtime</code> in nixpks via <a href="https://github.com/NixOS/nixpkgs/pull/85602">https://github.com/NixOS/nixpkgs/pull/85602</a><br>
 I get the following build error</p>
<div class="codehilite"><pre><span></span><code>thread &#39;Cranelift::spec::skip_stack_guard_page&#39; has overflowed its stack
fatal runtime error: stack overflow
error: test failed, to rerun pass &#39;--test wast_testsuites&#39;
Caused by:
  process didn&#39;t exit successfully: `/private/tmp/nix-build-wasmtime-0.15.0.drv-0/source/target/debug/deps/wast_testsuites-eaac573cefb8aa83` (signal: 6, SIGABRT: process abort signal)
</code></pre></div>


<p>Full log at <a href="https://logs.nix.ci/?key=nixos/nixpkgs.85602&amp;attempt_id=83a9c69d-7d43-491e-959c-9d974a859018">https://logs.nix.ci/?key=nixos/nixpkgs.85602&amp;attempt_id=83a9c69d-7d43-491e-959c-9d974a859018</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>