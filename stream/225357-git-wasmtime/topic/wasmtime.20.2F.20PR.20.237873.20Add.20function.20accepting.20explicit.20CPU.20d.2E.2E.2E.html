<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7873 Add function accepting explicit CPU d... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html">wasmtime / PR #7873 Add function accepting explicit CPU d...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="419917078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/419917078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#419917078">(Feb 05 2024 at 19:53)</a>:</h4>
<p>Milek7 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a> from <code>Milek7:guestprofiler-delta</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Currently <code>GuestProfiler::sample</code> always records zero CPU time delta. This makes resulting profiles hard to interpret, especially because sampling is usually performed from epoch callback, which necessarily means that no samples at all are captured when guest is not running, thus there is no distinguishable "idle" stacktrace of any sort.</p>
<p>While it is possible to read OS thread time counters for that, GuestProfiler is not aware whether current thread is used exclusively for running that guest. For example, I'm running multiple guests on single-threaded event loop and that would partially misattribute CPU time to neighboring guests on first/last sample. Thus I think that the embedder is better suited to measure and provide time delta to sampling function.</p>
<p>I left old signature intact not to break any existing users. For symmetry C bindings also got new signature, though maybe old one should be removed as it doesn't have any users yet?</p>
</blockquote>



<a name="419917080"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/419917080" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#419917080">(Feb 05 2024 at 19:53)</a>:</h4>
<p><strong>Milek7</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a>.</p>



<a name="419917081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/419917081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#419917081">(Feb 05 2024 at 19:53)</a>:</h4>
<p><strong>Milek7</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a>.</p>



<a name="419918410"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/419918410" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#419918410">(Feb 05 2024 at 20:01)</a>:</h4>
<p>Milek7 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a>.</p>



<a name="419933617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/419933617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#419933617">(Feb 05 2024 at 21:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/7873#issuecomment-1928149424">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @peterhuene</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api", "wasmtime:c-api"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>peterhuene: wasmtime:api, wasmtime:c-api</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="420077171"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/420077171" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#420077171">(Feb 06 2024 at 15:49)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/7873#issuecomment-1930095326">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a>:</p>
<blockquote>
<p>Thanks for the PR! It's ok to break the current signature and change it, so I think I would agree with you that it seems like it might be best to unconditionally take a <code>Duration</code> argument. Could you update the documentation to indicate that passing <code>Duration::ZERO</code> is ok but might have some consequences when viewing the results?</p>
</blockquote>



<a name="420082080"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237873%20Add%20function%20accepting%20explicit%20CPU%20d.../near/420082080" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237873.20Add.20function.20accepting.20explicit.20CPU.20d.2E.2E.2E.html#420082080">(Feb 06 2024 at 16:12)</a>:</h4>
<p>Milek7 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7873">PR #7873</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>