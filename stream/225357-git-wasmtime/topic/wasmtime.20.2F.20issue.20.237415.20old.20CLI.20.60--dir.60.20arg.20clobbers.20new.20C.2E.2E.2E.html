<html>
<head><meta charset="utf-8"><title>wasmtime / issue #7415 old CLI `--dir` arg clobbers new C... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html">wasmtime / issue #7415 old CLI `--dir` arg clobbers new C...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="399378650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399378650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399378650">(Oct 30 2023 at 21:18)</a>:</h4>
<p><a href="https://github.com/ydnar">ydnar</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">Issue #7415</a>.</p>



<a name="399378651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399378651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399378651">(Oct 30 2023 at 21:18)</a>:</h4>
<p>ydnar opened <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">issue #7415</a>:</p>
<blockquote>
<p>Thanks for releasing the compatibility shim in v14.0.3! I ran into an odd compatibility issue:</p>
<p>If <code>wasmtime</code> is run without <code>WASMTIME_NEW_CLI=1</code>, then <code>--dir</code> is always interpreted as a single value, and not <code>HOST::GUEST</code>. e.g.:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>wasmtime<span class="w"> </span>run<span class="w"> </span>--dir<span class="w"> </span>./::./<span class="w"> </span>...
</code></pre></div>
<p>Fails with:</p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>open<span class="w"> </span>directory<span class="w"> </span><span class="s1">'./::./'</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="399378749"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399378749" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399378749">(Oct 30 2023 at 21:19)</a>:</h4>
<p>ydnar edited <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">issue #7415</a>:</p>
<blockquote>
<p>Thanks for releasing the compatibility shim in v14.0.3! I ran into an odd compatibility issue:</p>
<p>If <code>wasmtime</code> is run without <code>WASMTIME_NEW_CLI=1</code>, then <code>--dir</code> is always interpreted as a single value, and not <code>HOST::GUEST</code>, e.g.:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>wasmtime<span class="w"> </span>run<span class="w"> </span>--dir<span class="w"> </span>./::./<span class="w"> </span>...
</code></pre></div>
<p>Fails with:</p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>open<span class="w"> </span>directory<span class="w"> </span><span class="s1">'./::./'</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="399378763"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399378763" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399378763">(Oct 30 2023 at 21:19)</a>:</h4>
<p>ydnar edited <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">issue #7415</a>:</p>
<blockquote>
<p>Thanks for releasing the compatibility shim in v14.0.3! I ran into an odd compatibility issue:</p>
<p>If <code>wasmtime</code> is run without <code>WASMTIME_NEW_CLI=1</code>, then <code>--dir</code> is always interpreted as a single value, and not <code>HOST::GUEST</code>:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>wasmtime<span class="w"> </span>run<span class="w"> </span>--dir<span class="w"> </span>./::./<span class="w"> </span>...
</code></pre></div>
<p>Fails with:</p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>open<span class="w"> </span>directory<span class="w"> </span><span class="s1">'./::./'</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="399380344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399380344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399380344">(Oct 30 2023 at 21:35)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7415#issuecomment-1786085378">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">issue #7415</a>:</p>
<blockquote>
<p>Thanks for the report, I've opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7416">https://github.com/bytecodealliance/wasmtime/pull/7416</a> to fix the warning here and we can do a 14.0.4 release as well in a day or two to collect some more feedback.</p>
<p>I'll also confirm though that Wasmtime doesn't just fail with the error message above, it also prints the expected warning about the old-vs-new CLI, which is what I at least expected. Still something that's worth fixing because otherwise <code>--dir</code>-with-remapping behavior isn't actually able to be used without a warning or env var, which isn't great.</p>
</blockquote>



<a name="399594102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399594102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399594102">(Oct 31 2023 at 20:04)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">issue #7415</a>:</p>
<blockquote>
<p>Thanks for releasing the compatibility shim in v14.0.3! I ran into an odd compatibility issue:</p>
<p>If <code>wasmtime</code> is run without <code>WASMTIME_NEW_CLI=1</code>, then <code>--dir</code> is always interpreted as a single value, and not <code>HOST::GUEST</code>:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>wasmtime<span class="w"> </span>run<span class="w"> </span>--dir<span class="w"> </span>./::./<span class="w"> </span>...
</code></pre></div>
<p>Fails with:</p>
<p><div class="codehilite" data-code-language="Bash"><pre><span></span><code>Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>open<span class="w"> </span>directory<span class="w"> </span><span class="s1">'./::./'</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="399594103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237415%20old%20CLI%20%60--dir%60%20arg%20clobbers%20new%20C.../near/399594103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237415.20old.20CLI.20.60--dir.60.20arg.20clobbers.20new.20C.2E.2E.2E.html#399594103">(Oct 31 2023 at 20:04)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7415#issuecomment-1787954675">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7415">issue #7415</a>:</p>
<blockquote>
<p>Fixed in <a href="https://github.com/bytecodealliance/wasmtime/pull/7416">https://github.com/bytecodealliance/wasmtime/pull/7416</a>, backported in <a href="https://github.com/bytecodealliance/wasmtime/pull/7421">https://github.com/bytecodealliance/wasmtime/pull/7421</a>, and 14.0.4 will go out when <a href="https://github.com/bytecodealliance/wasmtime/pull/7431">https://github.com/bytecodealliance/wasmtime/pull/7431</a> is merged, so closing. Thanks again for the report!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>