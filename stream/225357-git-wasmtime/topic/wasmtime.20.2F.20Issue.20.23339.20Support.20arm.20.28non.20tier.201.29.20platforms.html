<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #339 Support arm (non tier 1) platforms · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html">wasmtime / Issue #339 Support arm (non tier 1) platforms</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="197355528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197355528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197355528">(May 13 2020 at 00:09)</a>:</h4>
<p>brooksmtownsend <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627665506">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>A project that I contribute to has a dependency on the rust crate <code>wasmtime = "0.15.0"</code>, and running <code>cargo build</code> on a Raspberry Pi 3B using Ubuntu 20.04 LTS armv7l results in the following error:</p>
<div class="codehilite"><pre><span></span><code>   Compiling wasmtime-runtime v0.15.0
error: unsupported platform
   --&gt; /home/ubuntu/.cargo/registry/src/github.com-1ecc6299db9ec823/wasmtime-runtime-0.15.0/src/traphandlers.rs:169:21
    |
169 |                     compile_error!(&quot;unsupported platform&quot;);
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

error[E0308]: mismatched types
   --&gt; /home/ubuntu/.cargo/registry/src/github.com-1ecc6299db9ec823/wasmtime-runtime-0.15.0/src/traphandlers.rs:156:52
    |
156 |         unsafe fn get_pc(cx: *mut libc::c_void) -&gt; *const u8 {
    |                   ------                           ^^^^^^^^^ expected *-ptr, found `()`
    |                   |
    |                   implicitly returns `()` as its body has no tail or `return` expression
...
169 |                     compile_error!(&quot;unsupported platform&quot;);
    |                                                           - help: consider removing this semicolon
    |
    = note: expected raw pointer `*const u8`
                 found unit type `()`

error: aborting due to 2 previous errors

For more information about this error, try `rustc --explain E0308`.
error: could not compile `wasmtime-runtime`.

To learn more, run the command again with --verbose.
</code></pre></div>


<p>I understand that <code>wasmtime</code> does not support arm, just thought I'd contribute and say that others are still watching <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span> </p>
</blockquote>



<a name="197361654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197361654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197361654">(May 13 2020 at 01:58)</a>:</h4>
<p>jlb6740 <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627698716">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>Hi @brooksmtownsend have you seen this <a href="https://github.com/bytecodealliance/wasmtime/pull/1494">https://github.com/bytecodealliance/wasmtime/pull/1494</a>? Perhaps just a dependency update?</p>
</blockquote>



<a name="197361736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197361736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197361736">(May 13 2020 at 02:00)</a>:</h4>
<p>jlb6740 deleted a <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627698716">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>Hi @brooksmtownsend have you seen this <a href="https://github.com/bytecodealliance/wasmtime/pull/1494">https://github.com/bytecodealliance/wasmtime/pull/1494</a>? Perhaps just a dependency update?</p>
</blockquote>



<a name="197361746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197361746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197361746">(May 13 2020 at 02:01)</a>:</h4>
<p>jlb6740 <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627699263">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>Hi @brooksmtownsend have you seen this #1494? Does this platform support Arm64?</p>
</blockquote>



<a name="197372440"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197372440" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197372440">(May 13 2020 at 06:18)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627770634">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>The RPi3 does have a 64-bit CPU, but I think most distros (at least the default Raspbian, and it looks like Ubuntu install in the logs above too) run a 32-bit kernel and userland. Unfortunately we only support ARM64 (which would require a 64-bit userland) right now. @brooksmtownsend, I've used wasmtime successfully on a Gentoo 64-bit install on a RPi4, FWIW, but I know switching distro/install is quite a hassle.</p>
<p>ARM32 support may come at some point in the future, but I'm not sure what our architecture support roadmap looks like so I can't make any promises, sorry! If anyone is interested in working on this, I'd be happy to provide guidance as best as I can.</p>
</blockquote>



<a name="197387906"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197387906" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197387906">(May 13 2020 at 09:32)</a>:</h4>
<p>brooksmtownsend <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627868759">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>@cfallin @jlb6740 great callout and this was all done on a fresh install of, unfortunately, the 32-bit server OS. I'll try out switching to the 64-bit version of Ubuntu (I'm not dedicated to Ubuntu, but figured I'll stick with changing one thing at a time) and see how that goes. Thanks!</p>
</blockquote>



<a name="197389015"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197389015" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197389015">(May 13 2020 at 09:42)</a>:</h4>
<p>ebeasant-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627873654">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>If you can get it installed, Ubuntu 64-bit is well worth the effort: With the recent upgrade of the Pi Imager, its not much harder than putting Rasbian on it from scratch :-) There's been a huge amount of work on Cranelift/wasmtime very recently to support aarch64, which is now maturing nicely, and being used in anger. Keep up the good work!</p>
</blockquote>



<a name="197389130"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197389130" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197389130">(May 13 2020 at 09:43)</a>:</h4>
<p>brooksmtownsend <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627874334">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>Awesome! Looking forward to getting it, I actually didn't mean to install the 32-bit version in the first place</p>
</blockquote>



<a name="197390501"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197390501" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197390501">(May 13 2020 at 09:56)</a>:</h4>
<p>tschneidereit <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-627880687">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>@brooksmtownsend we'd love to hear how things are going, so it'd be great if you could report back here. Do note that #1494 just landed, so ARM64 support is quite new, which might mean running into early-adopter issues. Which mostly means that hearing how things are going would be even more appreciated :D</p>
</blockquote>



<a name="197800133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197800133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197800133">(May 16 2020 at 15:12)</a>:</h4>
<p>brooksmtownsend <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-629661313">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>@tschneidereit i tried building with the aarch64 version of Ubuntu 20.04, unfortunately I ran into the same issue. This is with wasmtime-runtime v0.15.0, is that too early of a version?</p>
</blockquote>



<a name="197865301"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/197865301" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#197865301">(May 17 2020 at 19:35)</a>:</h4>
<p>tschneidereit <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-629849051">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>@brooksmtownsend thank you for reporting this! I think v0.15.0 might indeed be too old: I think the new backend hadn't landed by then, and we certainly didn't do aarch64 builds in CI. We do do that by now, see the <a href="https://github.com/bytecodealliance/wasmtime/releases/tag/dev"><code>dev</code></a> and <a href="https://github.com/bytecodealliance/wasmtime/releases/tag/v0.16.0"><code>v0.16.0</code></a> releases.</p>
<p>However, the cross-compilation process isn't documented (at least that I could find). I just filed #1720 to rectify that. Here's the <a href="https://github.com/bytecodealliance/wasmtime/commit/d1aa86f91a4e7b6d1663cd9b4a1f749fdbb83dfd#diff-90829e76e906f1c73140c7ded7e1b268">patch that added aarch64 builds to CI</a>, in case you're interested.</p>
</blockquote>



<a name="225057652"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/225057652" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#225057652">(Feb 03 2021 at 18:20)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/339#issuecomment-772718687">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>The new backend framework has a working AArch64 backend.</p>
</blockquote>



<a name="225061162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23339%20Support%20arm%20%28non%20tier%201%29%20platforms/near/225061162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23339.20Support.20arm.20.28non.20tier.201.29.20platforms.html#225061162">(Feb 03 2021 at 18:42)</a>:</h4>
<p>cfallin closed <a href="https://github.com/bytecodealliance/wasmtime/issues/339">Issue #339</a>:</p>
<blockquote>
<p>The wasi story is really exciting in the idea of showing we can run the same code on multi platforms and architectures so I went to do that, and in compiling for arm I found that only tier 1 basically x86 platforms are supported currently.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">link</span><span class="p">.</span><span class="n">rs</span>:<span class="p">(.</span><span class="n">text</span><span class="p">.</span><span class="n">_ZN12wasmtime_jit4link8relocate17h8a250ae005184b62E</span><span class="o">+</span><span class="mh">0x680</span><span class="p">)</span>: <span class="nc">undefined</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">`</span><span class="n">__rust_probestack</span><span class="o">'</span><span class="w"></span>
<span class="n">collect2</span>: <span class="nc">error</span>: <span class="nc">ld</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w"></span>
</code></pre></div>
<p>Found this in probestack so it seems like an upstream problem</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="sd">//! Finally it's worth noting that at the time of this writing LLVM only has</span>
<span class="sd">//! support for stack probes on x86 and x86_64. There's no support for stack</span>
<span class="sd">//! probes on any other architecture like ARM or PowerPC64. LLVM I'm sure would</span>
<span class="sd">//! be more than welcome to accept such a change!</span>
</code></pre></div>
<p>And found these<br>
<a href="https://github.com/rust-lang/rust/issues/43241">https://github.com/rust-lang/rust/issues/43241</a><br>
<a href="https://github.com/rust-lang/rust/issues/49355">https://github.com/rust-lang/rust/issues/49355</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>