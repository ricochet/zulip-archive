<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3355 Use rsix to make system calls in Wasm... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html">wasmtime / PR #3355 Use rsix to make system calls in Wasm...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="253502226"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253502226" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253502226">(Sep 15 2021 at 23:10)</a>:</h4>
<p>sunfishcode opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>:</p>
<blockquote>
<p><code>rsix</code> is a system call wrapper crate that we use in <code>wasi-common</code>,<br>
which can provide the following advantages in the rest of Wasmtime:</p>
<ul>
<li>
<p>It eliminates some <code>unsafe</code> blocks in Wasmtime's code. There's<br>
   still an <code>unsafe</code> block in the library, but this way, the <code>unsafe</code><br>
   is factored out and clearly scoped.</p>
</li>
<li>
<p>And, it makes error handling more consistent, factoring out code for<br>
   checking return values and <code>io::Error::last_os_error()</code>, and code that<br>
   does <code>errno::set_errno(0)</code>.</p>
</li>
</ul>
<p>This doesn't cover <em>all</em> system calls; <code>rsix</code> doesn't implement<br>
signal-handling APIs, and this doesn't cover calls made through <code>std</code> or<br>
crates like <code>userfaultfd</code>, <code>rand</code>, and <code>region</code>.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="253505149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253505149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253505149">(Sep 15 2021 at 23:38)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253506277"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253506277" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253506277">(Sep 15 2021 at 23:51)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253506584"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253506584" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253506584">(Sep 15 2021 at 23:54)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253508285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253508285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253508285">(Sep 16 2021 at 00:11)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253508686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253508686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253508686">(Sep 16 2021 at 00:16)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253510344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253510344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253510344">(Sep 16 2021 at 00:38)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253511298"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253511298" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253511298">(Sep 16 2021 at 00:49)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253512740"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253512740" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253512740">(Sep 16 2021 at 01:07)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253514358"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253514358" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253514358">(Sep 16 2021 at 01:28)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253516937"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253516937" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253516937">(Sep 16 2021 at 02:00)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253538482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253538482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253538482">(Sep 16 2021 at 07:08)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253594990"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253594990" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253594990">(Sep 16 2021 at 14:54)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756410276">PR review</a>.</p>



<a name="253594991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253594991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253594991">(Sep 16 2021 at 14:54)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756410276">PR review</a>.</p>



<a name="253594993"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253594993" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253594993">(Sep 16 2021 at 14:54)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710197302">PR review comment</a>:</p>
<blockquote>
<p>How come this was needed with this change? I would have figured that rsix was already part of wasi-common's dep tree to have this required already...</p>
</blockquote>



<a name="253596155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253596155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253596155">(Sep 16 2021 at 15:01)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756422289">PR review</a>.</p>



<a name="253596157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253596157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253596157">(Sep 16 2021 at 15:01)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710205802">PR review comment</a>:</p>
<blockquote>
<p>It's actually an unrelated change; a contributor recently added 32-bit ARM support in rsix, so it now needs cross tools to be cross-compiled.</p>
</blockquote>



<a name="253597586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253597586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253597586">(Sep 16 2021 at 15:10)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756433539">PR review</a>.</p>



<a name="253597590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253597590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253597590">(Sep 16 2021 at 15:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710213839">PR review comment</a>:</p>
<blockquote>
<p>How come this is required at <code>cargo check</code>-time though? Did rsix previously not have C code to build and now it does?</p>
</blockquote>



<a name="253598071"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253598071" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253598071">(Sep 16 2021 at 15:13)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-756437594">PR review</a>.</p>



<a name="253598073"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253598073" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253598073">(Sep 16 2021 at 15:13)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r710216689">PR review comment</a>:</p>
<blockquote>
<p>Rsix has two backends. The libc backend and the raw linux syscall backend. The latter requires compiling external assembly and is only used on supported linux targets. Previously 32-bit ARM was not one of such targets and thus would use the libc backend AFAIU.</p>
</blockquote>



<a name="253810632"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253810632" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253810632">(Sep 17 2021 at 21:32)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a> from <code>sunfishcode/use-rsix</code> to <code>main</code>.</p>



<a name="253816242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/253816242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#253816242">(Sep 17 2021 at 22:28)</a>:</h4>
<p>sunfishcode merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3355">PR #3355</a>.</p>



<a name="254245784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/254245784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#254245784">(Sep 21 2021 at 17:26)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-760047720">PR review</a>.</p>



<a name="254245786"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/254245786" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#254245786">(Sep 21 2021 at 17:26)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r713262642">PR review comment</a>:</p>
<blockquote>
<p>This adds a lot of new dependencies to cg_clif:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">errno</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">2.7</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">errno</span><span class="o">-</span><span class="n">dragonfly</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">1.1</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">gcc</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">3.55</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">io</span><span class="o">-</span><span class="n">lifetimes</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">3.1</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">itoa</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">4.8</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">linux</span><span class="o">-</span><span class="n">raw</span><span class="o">-</span><span class="n">sys</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">0.28</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">rsix</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">23.5</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">rustc_version</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">4.0</span><span class="w"></span>
<span class="w">      </span><span class="n">Adding</span><span class="w"> </span><span class="n">semver</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="mf">0.4</span><span class="w"></span>
</code></pre></div>
<p>This all to prevent a single libc call is not worth it IMO. Before this change cg_clif didn't depend on a C compiler on any target, now it does on some targets. It also bloats the dylib size as unused functions are still exported from the dylib and thus can't be gc'ed and increases compilation time.</p>
</blockquote>



<a name="254929379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/254929379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#254929379">(Sep 26 2021 at 12:58)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r716200729">PR review comment</a>:</p>
<blockquote>
<p>Makes sense. rsix is only used for one thing in Cranelift here, so I'll submit a PR to revert that to just using libc.</p>
</blockquote>



<a name="254929385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/254929385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#254929385">(Sep 26 2021 at 12:58)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-763694424">PR review</a>.</p>



<a name="254929662"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/254929662" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#254929662">(Sep 26 2021 at 13:01)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-763694781">PR review</a>.</p>



<a name="254929663"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/254929663" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#254929663">(Sep 26 2021 at 13:01)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r716201272">PR review comment</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="258787167"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/258787167" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#258787167">(Oct 22 2021 at 23:08)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#pullrequestreview-787322297">PR review</a>.</p>



<a name="258787168"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233355%20Use%20rsix%20to%20make%20system%20calls%20in%20Wasm.../near/258787168" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233355.20Use.20rsix.20to.20make.20system.20calls.20in.20Wasm.2E.2E.2E.html#258787168">(Oct 22 2021 at 23:08)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3355#discussion_r734883951">PR review comment</a>:</p>
<blockquote>
<p>This part of the patch is now reverted, so it's not relevant at this time, but in case anyone is reading this is curious, the situation is better now:</p>
<p>New versions of rsix no longer build-depend on gcc or any C compiler, and no longer depend on itoa by default.</p>
<p>Also, it's worth noting that rustc_version and semver are build-time dependencies that aren't linked into the output, and linux-raw-sys doesn't contain any code.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>