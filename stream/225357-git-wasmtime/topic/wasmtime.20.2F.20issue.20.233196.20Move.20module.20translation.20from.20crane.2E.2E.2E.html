<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3196 Move module translation from crane... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html">wasmtime / issue #3196 Move module translation from crane...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="249754731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249754731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249754731">(Aug 17 2021 at 17:56)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900513155">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>As a heads up there's a ton of non-obvious code movement in this PR. While it can be reviewed in detail the diff is quite large. It was not my intention to actually modify any behavior in this PR, this should in theory be only a large refactoring.</p>
</blockquote>



<a name="249754808"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249754808" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249754808">(Aug 17 2021 at 17:57)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900513677">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>Does Spidermonkey need this function?</p>
</blockquote>



<a name="249754947"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249754947" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249754947">(Aug 17 2021 at 17:58)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900513677">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>Does Spidermonkey need this?</p>
</blockquote>



<a name="249755008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249755008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249755008">(Aug 17 2021 at 17:59)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900513677">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>Does Spidermonkey need the module translation code too? Or does it write its own code?</p>
</blockquote>



<a name="249757182"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249757182" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249757182">(Aug 17 2021 at 18:15)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900525353">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<blockquote>
<p>Does Spidermonkey need the module translation code too? Or does it write its own code?</p>
</blockquote>
<p>SpiderMonkey only uses the per-function translation API surface, so AFAIK this should not break it. The relevant code is <a href="https://searchfox.org/mozilla-central/source/js/src/wasm/cranelift/src/compile.rs">here</a>; see e.g. how <code>BatchCompiler</code> holds a <code>FuncTranslator</code> but not anything at the module level.</p>
</blockquote>



<a name="249757414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249757414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249757414">(Aug 17 2021 at 18:17)</a>:</h4>
<p>cfallin edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900525353">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<blockquote>
<p>Does Spidermonkey need the module translation code too? Or does it write its own code?</p>
</blockquote>
<p>SpiderMonkey only uses the per-function translation API surface, so AFAIK this should not break it. The relevant code is <a href="https://searchfox.org/mozilla-central/source/js/src/wasm/cranelift/src/compile.rs">here</a>; see e.g. how <code>BatchCompiler</code> holds a <code>FuncTranslator</code> but not anything at the module level (edit: or at least, not the module translator).</p>
</blockquote>



<a name="249766212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249766212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249766212">(Aug 17 2021 at 19:24)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900569559">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>Lucet also uses <code>ModuleEnvironment</code>, so we will need to inline the implementation over there so that we can keep on putting cranelift bugfixes into Lucet.</p>
</blockquote>



<a name="249772977"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249772977" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249772977">(Aug 17 2021 at 20:14)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900599964">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>@pchickey would you prefer if I just left <code>cranelift-wasm</code> alone in this regard? I could still inline everything into <code>wasmtime-environ</code> and just leave the crate alone and achieve the same goals here.</p>
</blockquote>



<a name="249774452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249774452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249774452">(Aug 17 2021 at 20:27)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900607620">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>Yeah, that should be fine for now. We can add a deprecation warning for now, and delete the dead code in <code>cranelift-wasm</code> in a little while after lucet is finally dead</p>
</blockquote>



<a name="249781496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249781496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249781496">(Aug 17 2021 at 21:29)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900643852">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>Ok I've updated to avoid changing <code>cranelift-wasm</code> and I've updated the commit/PR description as well.</p>
</blockquote>



<a name="249781586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233196%20Move%20module%20translation%20from%20crane.../near/249781586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233196.20Move.20module.20translation.20from.20crane.2E.2E.2E.html#249781586">(Aug 17 2021 at 21:30)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3196#issuecomment-900644243">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3196">issue #3196</a>:</p>
<blockquote>
<p>One worthwhile thing to point out is that with Wasmtime no longer using <code>translate_module</code> I think that means that there will be no more active maintainers of that functionality in <code>cranelift-wasm</code> any more.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>