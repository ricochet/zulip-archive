<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1391 Use `Linker` in `*.wast` testing · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html">wasmtime / PR #1391 Use `Linker` in `*.wast` testing</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="191638654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191638654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191638654">(Mar 24 2020 at 16:40)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391">PR #1391</a> from <code>wast-linker</code> to <code>master</code>:</p>
<blockquote>
<p>By default <code>Linker</code> disallows shadowing previously defined items, but it<br>
looks like the <code>*.wast</code> test suites rely on this so this commit adds a<br>
boolean flag to <code>Linker</code> as well indicating whether duplicates are<br>
allowed.</p>
</blockquote>



<a name="191641719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191641719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191641719">(Mar 24 2020 at 17:01)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380516319" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380516319">PR Review</a>.</p>



<a name="191641720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191641720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191641720">(Mar 24 2020 at 17:01)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397315754" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397315754">PR Review Comment</a>:</p>
<blockquote>
<p>On most systems the symbols loaded first have priority I believe. (Otherwise <code>LD_PRELOAD</code> would be pretty much useless.)</p>
</blockquote>



<a name="191641881"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191641881" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191641881">(Mar 24 2020 at 17:02)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380517255" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380517255">PR Review</a>.</p>



<a name="191641882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191641882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191641882">(Mar 24 2020 at 17:02)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397316437" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397316437">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>                &quot;import of `{}::{}` with kind {:?} defined twice&quot;,
</pre></div>


</blockquote>



<a name="191651378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191651378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191651378">(Mar 24 2020 at 18:10)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380574019" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380574019">PR Review</a>.</p>



<a name="191651381"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191651381" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191651381">(Mar 24 2020 at 18:10)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397361983" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397361983">PR Review Comment</a>:</p>
<blockquote>
<p>I agree that in the context of <code>LD_PRELOAD</code> that makes sense, but from from an API perspective, last-in-wins might be more intuitive for developers (a la virtual inheritance).  For example, I'd probably tell the linker to link in an engine-provided WASI implementation and then my host functions, which could potentially override the WASI implementation.</p>
</blockquote>



<a name="191652259"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191652259" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191652259">(Mar 24 2020 at 18:18)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380579828" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380579828">PR Review</a>.</p>



<a name="191652260"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191652260" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191652260">(Mar 24 2020 at 18:18)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397366670" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397366670">PR Review Comment</a>:</p>
<blockquote>
<p>Teensy naming nit: perhaps <code>allow_shadowing</code> or <code>enable_shadowing</code>?  The singular <code>shadow</code> reads a little strange to me for some reason.</p>
</blockquote>



<a name="191652739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191652739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191652739">(Mar 24 2020 at 18:22)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380582629" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380582629">PR Review</a>.</p>



<a name="191652865"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191652865" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191652865">(Mar 24 2020 at 18:23)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397361983" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397361983">PR Review Comment</a>.</p>



<a name="191653575"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191653575" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191653575">(Mar 24 2020 at 18:28)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397372966" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397372966">PR Review Comment</a>:</p>
<blockquote>
<p><code>LD_PRELOAD</code>-style symbol preemption is fairly limited and awkward though. It's possible for libraries to make calls to their own symbols which can't be preempted, or to make assumptions that break if their symbols get preempted. So you have to depend on the library not doing those things.</p>
<p>I think it would be better to encourage wasm programs and tools to focus on interposition rather than preemption. Load the replacement <em>after</em> the thing it is replacing rather than before. One nice thing about this approach is that it means you can easy wrap functions and call them from your wrappers. For things like <code>malloc</code> replacements, it may require libraries to be structured differently, but it has the advantage of not depending on any implicit contracts with the libc to only access the malloc heap through the public interface.</p>
</blockquote>



<a name="191653576"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191653576" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191653576">(Mar 24 2020 at 18:28)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380587559" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380587559">PR Review</a>.</p>



<a name="191655302"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191655302" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191655302">(Mar 24 2020 at 18:42)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391">PR #1391</a> from <code>wast-linker</code> to <code>master</code>:</p>
<blockquote>
<p>By default <code>Linker</code> disallows shadowing previously defined items, but it<br>
looks like the <code>*.wast</code> test suites rely on this so this commit adds a<br>
boolean flag to <code>Linker</code> as well indicating whether duplicates are<br>
allowed.</p>
</blockquote>



<a name="191655399"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191655399" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191655399">(Mar 24 2020 at 18:43)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397382062" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397382062">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW I think all behaviors are fine to implement. They're all simple enough and it's largely just a matter of defaults. If necessary it would be quite easy to implement a <code>LD_PRELOAD</code>-style first-one-always-wins, but I think it's best to wait for a use case to come up first.</p>
</blockquote>



<a name="191655400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191655400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191655400">(Mar 24 2020 at 18:43)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380599113" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380599113">PR Review</a>.</p>



<a name="191660322"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191660322" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191660322">(Mar 24 2020 at 19:23)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391">PR #1391</a> from <code>wast-linker</code> to <code>master</code>:</p>
<blockquote>
<p>By default <code>Linker</code> disallows shadowing previously defined items, but it<br>
looks like the <code>*.wast</code> test suites rely on this so this commit adds a<br>
boolean flag to <code>Linker</code> as well indicating whether duplicates are<br>
allowed.</p>
</blockquote>



<a name="191660755"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191660755" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191660755">(Mar 24 2020 at 19:27)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391">PR #1391</a> from <code>wast-linker</code> to <code>master</code>:</p>
<blockquote>
<p>By default <code>Linker</code> disallows shadowing previously defined items, but it<br>
looks like the <code>*.wast</code> test suites rely on this so this commit adds a<br>
boolean flag to <code>Linker</code> as well indicating whether duplicates are<br>
allowed.</p>
</blockquote>



<a name="191667135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191667135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191667135">(Mar 24 2020 at 20:24)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380660941" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380660941">PR Review</a>.</p>



<a name="191667138"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191667138" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191667138">(Mar 24 2020 at 20:24)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397431647" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397431647">PR Review Comment</a>:</p>
<blockquote>
<p>Can you reformat this to avoid tab characters?</p>
</blockquote>



<a name="191667139"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191667139" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191667139">(Mar 24 2020 at 20:24)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397436128" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397436128">PR Review Comment</a>:</p>
<blockquote>
<p>It feels awkward to have both <code>instances</code> and <code>linker</code>, since they're largely overlapping. Code like <code>fn invoke</code> currently looks up a method to invoke by doing <code>get_instance</code> and then looking up the export. Can it user the <code>linker</code> to do this instead? It seems like we should be able to completely eliminate <code>instances</code>.</p>
</blockquote>



<a name="191667141"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191667141" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191667141">(Mar 24 2020 at 20:24)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380660941" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380660941">PR Review</a>.</p>



<a name="191672753"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191672753" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191672753">(Mar 24 2020 at 21:10)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391">PR #1391</a> from <code>wast-linker</code> to <code>master</code>:</p>
<blockquote>
<p>By default <code>Linker</code> disallows shadowing previously defined items, but it<br>
looks like the <code>*.wast</code> test suites rely on this so this commit adds a<br>
boolean flag to <code>Linker</code> as well indicating whether duplicates are<br>
allowed.</p>
</blockquote>



<a name="191672818"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191672818" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191672818">(Mar 24 2020 at 21:11)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397463348" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397463348">PR Review Comment</a>:</p>
<blockquote>
<p>I agree yeah it's a bit awkward but I don't think we can easily change this. This would involve adding some sort of accesor to <code>Linker</code> and it wouldn't work well for the <code>register</code> command which takes a whole instance and puts it in the linker. Would you be ok trying to clean this up at a later date?</p>
</blockquote>



<a name="191672820"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191672820" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191672820">(Mar 24 2020 at 21:11)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380699394" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380699394">PR Review</a>.</p>



<a name="191675518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191675518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191675518">(Mar 24 2020 at 21:33)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380713329" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380713329">PR Review</a>.</p>



<a name="191675519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191675519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191675519">(Mar 24 2020 at 21:33)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397474845" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397474845">PR Review Comment</a>:</p>
<blockquote>
<p>Yeah. In fact, I think I have an idea of how to do it, so let's go ahead and land this and I'll see if my idea works in a separate PR.</p>
</blockquote>



<a name="191675533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191675533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191675533">(Mar 24 2020 at 21:33)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380713450" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380713450">PR Review</a>.</p>



<a name="191681736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191681736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191681736">(Mar 24 2020 at 22:37)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391">PR #1391</a>.</p>



<a name="191682262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191682262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191682262">(Mar 24 2020 at 22:44)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380749002" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#pullrequestreview-380749002">PR Review</a>.</p>



<a name="191682263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231391%20Use%20%60Linker%60%20in%20%60%2A.wast%60%20testing/near/191682263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231391.20Use.20.60Linker.60.20in.20.60.2A.2Ewast.60.20testing.html#191682263">(Mar 24 2020 at 22:44)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397506279" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1391#discussion_r397506279">PR Review Comment</a>:</p>
<blockquote>
<p>I took a quick look at this, and it turns out to be harder than I thought. The Linker interface doesn't have a way to look up a function without knowing its return types, which is something that the wast <code>invoke</code> command does. We may eventually want to add a way to do this, but we can figure that out later.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>