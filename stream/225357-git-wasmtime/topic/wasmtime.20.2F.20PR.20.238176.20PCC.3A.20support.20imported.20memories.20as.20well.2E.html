<html>
<head><meta charset="utf-8"><title>wasmtime / PR #8176 PCC: support imported memories as well. · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html">wasmtime / PR #8176 PCC: support imported memories as well.</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="427589814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427589814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427589814">(Mar 18 2024 at 22:55)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a> from <code>cfallin:fix-pcc-imported-memories</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Exposed by a fuzzbug (<a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=67429">https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=67429</a>); rather than exclude from fuzzing, it seemed easier to just implement. We need  to define a new memory type to describe the memory definition struct pointed to by vmctx, and set up points-to facts appropriately.</p>
<p>Stacked on top of #8174; only last commit is new.</p>
</blockquote>



<a name="427589815"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427589815" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427589815">(Mar 18 2024 at 22:55)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>.</p>



<a name="427589816"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427589816" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427589816">(Mar 18 2024 at 22:55)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>.</p>



<a name="427589817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427589817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427589817">(Mar 18 2024 at 22:56)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>.</p>



<a name="427600699"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427600699" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427600699">(Mar 19 2024 at 00:48)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>.</p>



<a name="427600717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427600717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427600717">(Mar 19 2024 at 00:49)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>:</p>
<blockquote>
<p>Exposed by a fuzzbug (<a href="https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=67429">https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=67429</a>); rather than exclude from fuzzing, it seemed easier to just implement. We need  to define a new memory type to describe the memory definition struct pointed to by vmctx, and set up points-to facts appropriately.</p>
</blockquote>



<a name="427614420"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427614420" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427614420">(Mar 19 2024 at 03:35)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/8176#issuecomment-2005691229">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>:</p>
<blockquote>
<p>I don't know enough here to really review what's going on, but could the pcc-related pieces get factored into their own functions/methods? Right now they're suffering quite a bit from a huge indentation due to being so nested so breaking them out might help with readability</p>
</blockquote>



<a name="427751497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427751497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427751497">(Mar 19 2024 at 15:33)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/8176#issuecomment-2007506660">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>:</p>
<blockquote>
<p>Perhaps; the original intent was to put the PCC logic alongside the CLIF generation because they "mirror" each other (both have largely the same case breakdown, so we'd mirror the control flow elsewhere, which seems more brittle). Happy to consider refactors, unfortunately don't have much time to do a big refactor now. @fitzgen and I cowrote the original; @fitzgen would you be willing to review the fuzzbug fix here?</p>
</blockquote>



<a name="427791757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427791757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427791757">(Mar 19 2024 at 18:53)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>.</p>



<a name="427791951"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427791951" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427791951">(Mar 19 2024 at 18:54)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/8176#issuecomment-2007908493">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>:</p>
<blockquote>
<p>@alexcrichton On second look, I did a small refactor on some of the logic so hopefully it's at least a little easier to digest now -- let me know what you think. Thanks!</p>
</blockquote>



<a name="427801521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427801521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427801521">(Mar 19 2024 at 19:57)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/8176#issuecomment-2008008328">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>:</p>
<blockquote>
<p>Seems reasonable to me! Alas though I fear I know so little about how this is all supposed to work that I still can't really make heads or tails of it without diving much deeper into pcc stuff, so I'll leave @fitzgen to review</p>
</blockquote>



<a name="427951470"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427951470" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427951470">(Mar 20 2024 at 15:11)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8176#pullrequestreview-1949191916">PR review</a>.</p>



<a name="427958100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238176%20PCC%3A%20support%20imported%20memories%20as%20well./near/427958100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238176.20PCC.3A.20support.20imported.20memories.20as.20well.2E.html#427958100">(Mar 20 2024 at 15:39)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/8176">PR #8176</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>