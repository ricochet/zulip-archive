<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #270  Ambiguous spec of __wasi_fstflags_t · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23270.20.20Ambiguous.20spec.20of.20__wasi_fstflags_t.html">wasmtime / Issue #270  Ambiguous spec of __wasi_fstflags_t</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="225048687"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23270%20%20Ambiguous%20spec%20of%20__wasi_fstflags_t/near/225048687" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23270.20.20Ambiguous.20spec.20of.20__wasi_fstflags_t.html#225048687">(Feb 03 2021 at 17:21)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/270#issuecomment-772679121">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/270">Issue #270</a>:</p>
<blockquote>
<p>Should this be moved to <a href="https://github.com/WebAssembly/WASI">https://github.com/WebAssembly/WASI</a> and is this even still a problem.</p>
</blockquote>



<a name="225205308"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23270%20%20Ambiguous%20spec%20of%20__wasi_fstflags_t/near/225205308" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23270.20.20Ambiguous.20spec.20of.20__wasi_fstflags_t.html#225205308">(Feb 04 2021 at 18:56)</a>:</h4>
<p>sunfishcode <a href="https://github.com/bytecodealliance/wasmtime/issues/270#issuecomment-773532020">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/270">Issue #270</a>:</p>
<blockquote>
<p>Yes; I've now moved it.</p>
</blockquote>



<a name="225205309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%23270%20%20Ambiguous%20spec%20of%20__wasi_fstflags_t/near/225205309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.23270.20.20Ambiguous.20spec.20of.20__wasi_fstflags_t.html#225205309">(Feb 04 2021 at 18:56)</a>:</h4>
<p>sunfishcode closed <a href="https://github.com/bytecodealliance/wasmtime/issues/270">Issue #270</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Possible</span><span class="w"> </span><span class="n">values</span>:

    <span class="nc">__WASI_FILESTAT_SET_ATIM</span><span class="w"></span>
<span class="w">    </span><span class="n">Adjust</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">__wasi_filestat_t</span>::<span class="n">st_atim</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="n">__WASI_FILESTAT_SET_ATIM_NOW</span><span class="w"></span>
<span class="w">    </span><span class="n">Adjust</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">clock</span><span class="w"> </span><span class="n">__WASI_CLOCK_REALTIME</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="n">__WASI_FILESTAT_SET_MTIM</span><span class="w"></span>
<span class="w">    </span><span class="n">Adjust</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">modification</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">__wasi_filestat_t</span>::<span class="n">st_mtim</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="n">__WASI_FILESTAT_SET_MTIM_NOW</span><span class="w"></span>
<span class="w">    </span><span class="n">Adjust</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">modification</span><span class="w"> </span><span class="n">timestamp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">clock</span><span class="w"> </span><span class="n">__WASI_CLOCK_REALTIME</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<p>It is unclear what the behavior is, when the both flags <code>__WASI_FILESTAT_SET_MTIM</code> and <code>__WASI_FILESTAT_SET_MTIM_NOW</code> are set. Should whichever of them take precedence or should one return <code>EINVAL</code>? This should be clarified in the API docs.</p>
<p>I suggest we return <code>EINVAL</code>, which is the behaviorimplemented in <a href="https://github.com/CraneStation/wasi-common/pull/54">https://github.com/CraneStation/wasi-common/pull/54</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>