<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7590 Winch: cleanup stack in br_if in non-... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html">wasmtime / PR #7590 Winch: cleanup stack in br_if in non-...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="404503979"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404503979" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404503979">(Nov 27 2023 at 23:07)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/elliottt">elliottt</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<a name="404503981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404503981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404503981">(Nov 27 2023 at 23:07)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<a name="404503984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404503984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404503984">(Nov 27 2023 at 23:07)</a>:</h4>
<p>jeffcharles opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a> from <code>jeffcharles:winch-br-if-stack-cleanup</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
I discovered that executing the following module compiled with Winch causes a segmentation fault:</p>
<div class="codehilite" data-code-language="WebAssembly"><pre><span></span><code><span class="p">(</span><span class="k">module</span>
  <span class="p">(</span><span class="k">func</span> <span class="p">(</span><span class="k">export</span> <span class="s2">""</span><span class="p">)</span>
    <span class="nb">call</span> <span class="mi">1</span>
    <span class="nb">call</span> <span class="mi">1</span>
    <span class="nb">br_if</span> <span class="mi">0</span>
    <span class="nb">drop</span>
  <span class="p">)</span>
  <span class="p">(</span><span class="k">func</span> <span class="cm">(;1;)</span> <span class="p">(</span><span class="k">result</span> <span class="kt">i32</span><span class="p">)</span>
    <span class="nb">i32.const</span> <span class="mi">1</span>
  <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>The cause appears to be that the code that would increment <code>rsp</code> to balance the machine stack is jumped over when the <code>br_if</code> path is taken.</p>
<p>What appears to work is, if the frame's <code>sp_offset</code> is different than the current <code>sp_offset</code>, we invert the existing jump and execute instructions to balance the stack before jumping to the frame's label, and reset the <code>sp_offset</code> before continuing with the fallthrough code (falling through in terms of the <code>br_if</code>, not the machine code jump). In the case where there is no difference between <code>sp_offset</code>s, we can use the existing <code>jne</code> machine code emission since we don't need to run any stack balancing instructions.</p>
<p>In terms of machine instructions, we'd be changing</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;</span><span class="n">reg</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">reg</span><span class="o">&gt;</span>
<span class="n">jne</span><span class="w"> </span><span class="n">end</span>
<span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="n">end</span>:
<span class="nc">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span>
<span class="n">pop</span><span class="w"> </span><span class="n">rbp</span>
<span class="n">ret</span>
</code></pre></div>
<p>to</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;</span><span class="n">reg</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">reg</span><span class="o">&gt;</span>
<span class="n">jeq</span><span class="w"> </span><span class="n">fallthrough</span>
<span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="n">jmp</span><span class="w"> </span><span class="n">end</span>
<span class="n">fallthrough</span>:
<span class="nc">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="n">end</span>:
<span class="nc">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span>
<span class="n">pop</span><span class="w"> </span><span class="n">rbp</span>
<span class="n">ret</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="404504351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404504351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404504351">(Nov 27 2023 at 23:11)</a>:</h4>
<p>jeffcharles submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1751584801">PR review</a>.</p>



<a name="404504352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404504352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404504352">(Nov 27 2023 at 23:11)</a>:</h4>
<p>jeffcharles created <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1406878875">PR review comment</a>:</p>
<blockquote>
<p>The old file test instructions resulted in an imbalanced stack, these new instructions are balanced. I suspect visiting the <code>unreachable</code> instruction may have put Winch into a state where it did not validate the <code>sp_offset</code> at the end was equal to the locals size.</p>
<p>Old:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">;;</span><span class="w">    </span><span class="mi">0</span>:     <span class="mi">55</span><span class="w">                     </span><span class="n">push</span><span class="w">    </span><span class="n">rbp</span>
<span class="p">;;</span><span class="w">    </span><span class="mi">1</span>:     <span class="mf">4889e5</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">rbp</span><span class="p">,</span><span class="w"> </span><span class="n">rsp</span>
<span class="p">;;</span><span class="w">    </span><span class="mi">4</span>:     <span class="mi">4883</span><span class="n">ec10</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0x10</span><span class="w">                    </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="p">;;</span><span class="w">    </span><span class="mi">8</span>:     <span class="mi">897</span><span class="n">c240c</span><span class="w">               </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xc</span><span class="p">],</span><span class="w"> </span><span class="n">edi</span>
<span class="p">;;</span><span class="w">    </span><span class="n">c</span>:     <span class="mi">4</span><span class="n">c893424</span><span class="w">               </span><span class="n">mov</span><span class="w"> </span><span class="n">qword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">r14</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">10</span>:     <span class="mi">448</span><span class="n">b5c240c</span><span class="w">             </span><span class="n">mov</span><span class="w"> </span><span class="n">r11d</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xc</span><span class="p">]</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">15</span>:     <span class="mi">4883</span><span class="n">ec04</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">19</span>:     <span class="mi">44891</span><span class="n">c24</span><span class="w">               </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">r11d</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">1</span><span class="n">d</span>:     <span class="mi">4883</span><span class="n">ec0c</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc</span><span class="w">                     </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">21</span>:     <span class="nc">bf01000000</span><span class="w">             </span><span class="n">mov</span><span class="w"> </span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">26</span>:     <span class="nc">e800000000</span><span class="w">             </span><span class="n">call</span><span class="w">    </span><span class="mh">0x2b</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">2</span><span class="n">b</span>:     <span class="mi">4883</span><span class="n">c40c</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc</span><span class="w">                     </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">2</span><span class="n">f</span>:     <span class="mi">4883</span><span class="n">ec04</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">33</span>:     <span class="mi">890424</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">eax</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">36</span>:     <span class="mi">4883</span><span class="n">ec08</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">3</span><span class="n">a</span>:     <span class="nc">bf01000000</span><span class="w">             </span><span class="n">mov</span><span class="w"> </span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">3</span><span class="n">f</span>:     <span class="nc">e800000000</span><span class="w">             </span><span class="n">call</span><span class="w">    </span><span class="mh">0x44</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">44</span>:     <span class="mi">4883</span><span class="n">c408</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">48</span>:     <span class="mi">4883</span><span class="n">ec04</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">4</span><span class="n">c</span>:     <span class="mi">890424</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">eax</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">4</span><span class="n">f</span>:     <span class="mi">8</span><span class="n">b0c24</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">ecx</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">]</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">52</span>:     <span class="mi">4883</span><span class="n">c404</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">56</span>:     <span class="mi">8</span><span class="n">b0424</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">]</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">59</span>:     <span class="mi">4883</span><span class="n">c404</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">5</span><span class="n">d</span>:     <span class="mi">85</span><span class="n">c9</span><span class="w">                   </span><span class="n">test</span><span class="w">    </span><span class="n">ecx</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">5</span><span class="n">f</span>:     <span class="mi">0</span><span class="n">f8502000000</span><span class="w">           </span><span class="n">jne</span><span class="w"> </span><span class="mh">0x67</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">65</span>:     <span class="mi">0</span><span class="n">f0b</span><span class="w">                   </span><span class="n">ud2</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">67</span>:     <span class="mi">4883</span><span class="n">c410</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0x10</span><span class="w">                    </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">6</span><span class="n">b</span>:     <span class="mi">5</span><span class="n">d</span><span class="w">                     </span><span class="n">pop</span><span class="w"> </span><span class="n">rbp</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">6</span><span class="n">c</span>:     <span class="nc">c3</span><span class="w">                     </span><span class="n">ret</span>
</code></pre></div>
<p>New:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">;;</span><span class="w">    </span><span class="mi">0</span>:     <span class="mi">55</span><span class="w">                     </span><span class="n">push</span><span class="w">    </span><span class="n">rbp</span>
<span class="p">;;</span><span class="w">    </span><span class="mi">1</span>:     <span class="mf">4889e5</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">rbp</span><span class="p">,</span><span class="w"> </span><span class="n">rsp</span>
<span class="p">;;</span><span class="w">    </span><span class="mi">4</span>:     <span class="mi">4883</span><span class="n">ec10</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0x10</span><span class="w">                    </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="p">;;</span><span class="w">    </span><span class="mi">8</span>:     <span class="mi">897</span><span class="n">c240c</span><span class="w">               </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xc</span><span class="p">],</span><span class="w"> </span><span class="n">edi</span>
<span class="p">;;</span><span class="w">    </span><span class="n">c</span>:     <span class="mi">4</span><span class="n">c893424</span><span class="w">               </span><span class="n">mov</span><span class="w"> </span><span class="n">qword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">r14</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">10</span>:     <span class="mi">448</span><span class="n">b5c240c</span><span class="w">             </span><span class="n">mov</span><span class="w"> </span><span class="n">r11d</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xc</span><span class="p">]</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">15</span>:     <span class="mi">4883</span><span class="n">ec04</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">19</span>:     <span class="mi">44891</span><span class="n">c24</span><span class="w">               </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">r11d</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">1</span><span class="n">d</span>:     <span class="mi">4883</span><span class="n">ec0c</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc</span><span class="w">                     </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">21</span>:     <span class="nc">bf01000000</span><span class="w">             </span><span class="n">mov</span><span class="w"> </span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">26</span>:     <span class="nc">e800000000</span><span class="w">             </span><span class="n">call</span><span class="w">    </span><span class="mh">0x2b</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">2</span><span class="n">b</span>:     <span class="mi">4883</span><span class="n">c40c</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc</span><span class="w">                     </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">2</span><span class="n">f</span>:     <span class="mi">4883</span><span class="n">ec04</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">33</span>:     <span class="mi">890424</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">eax</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">36</span>:     <span class="mi">4883</span><span class="n">ec08</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">3</span><span class="n">a</span>:     <span class="nc">bf01000000</span><span class="w">             </span><span class="n">mov</span><span class="w"> </span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">3</span><span class="n">f</span>:     <span class="nc">e800000000</span><span class="w">             </span><span class="n">call</span><span class="w">    </span><span class="mh">0x44</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">44</span>:     <span class="mi">4883</span><span class="n">c408</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">48</span>:     <span class="mi">4883</span><span class="n">ec04</span><span class="w">               </span><span class="n">sub</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">4</span><span class="n">c</span>:     <span class="mi">890424</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">],</span><span class="w"> </span><span class="n">eax</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">4</span><span class="n">f</span>:     <span class="mi">8</span><span class="n">b0c24</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">ecx</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">]</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">52</span>:     <span class="mi">4883</span><span class="n">c404</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">56</span>:     <span class="mi">8</span><span class="n">b0424</span><span class="w">                 </span><span class="n">mov</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="p">[</span><span class="n">rsp</span><span class="p">]</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">59</span>:     <span class="mi">4883</span><span class="n">c404</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">5</span><span class="n">d</span>:     <span class="mi">85</span><span class="n">c9</span><span class="w">                   </span><span class="n">test</span><span class="w">    </span><span class="n">ecx</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">5</span><span class="n">f</span>:     <span class="mi">0</span><span class="n">f8409000000</span><span class="w">           </span><span class="n">je</span><span class="w">  </span><span class="mh">0x6e</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">65</span>:     <span class="mi">4883</span><span class="n">c404</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w">                       </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">69</span>:     <span class="nc">e902000000</span><span class="w">             </span><span class="n">jmp</span><span class="w"> </span><span class="mh">0x70</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">6</span><span class="n">e</span>:     <span class="mi">0</span><span class="n">f0b</span><span class="w">                   </span><span class="n">ud2</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">70</span>:     <span class="mi">4883</span><span class="n">c410</span><span class="w">               </span><span class="n">add</span><span class="w"> </span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mh">0x10</span><span class="w">                    </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">74</span>:     <span class="mi">5</span><span class="n">d</span><span class="w">                     </span><span class="n">pop</span><span class="w"> </span><span class="n">rbp</span>
<span class="p">;;</span><span class="w">   </span><span class="mi">75</span>:     <span class="nc">c3</span><span class="w">                     </span><span class="n">ret</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="404505407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404505407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404505407">(Nov 27 2023 at 23:22)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<a name="404506782"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404506782" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404506782">(Nov 27 2023 at 23:35)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1751602807">PR review</a>.</p>



<a name="404506784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404506784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404506784">(Nov 27 2023 at 23:35)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1751602807">PR review</a>.</p>



<a name="404506786"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404506786" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404506786">(Nov 27 2023 at 23:35)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1406889282">PR review comment</a>:</p>
<blockquote>
<p>Minor note here: instead of checking for equality, can we check for <code>current_sp_offset &gt; frame_sp_offset</code>? We have checks everywhere else that guarantee that the current sp should never be less than the target SP; doing so will also align with how <code>ensure_sp_for_jump</code> is built and it also conveys a clearer message that the stack will be manipulated. </p>
</blockquote>



<a name="404506787"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404506787" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404506787">(Nov 27 2023 at 23:35)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1406895918">PR review comment</a>:</p>
<blockquote>
<p>It seems that we can avoid some repetition here, as only the label and the <code>CmpKind</code> are different for the branch instruction:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="n">cmp</span><span class="p">,</span><span class="w"> </span><span class="n">needs_cleanup</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">current_sp_offset</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">frame_sp_offset</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="n">masm</span><span class="p">.</span><span class="n">get_label</span><span class="p">(),</span><span class="w"> </span><span class="n">IntCmpKind</span>::<span class="nb">Eq</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="err">•</span><span class="n">frame</span><span class="p">.</span><span class="n">label</span><span class="p">(),</span><span class="w"> </span><span class="n">IntCmpKind</span>::<span class="n">Ne</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="p">};</span>

<span class="bp">self</span><span class="p">.</span><span class="n">masm</span><span class="p">.</span><span class="n">branch</span><span class="p">(</span><span class="o">..</span><span class="p">.);</span>

<span class="k">if</span><span class="w"> </span><span class="n">needs_cleanup</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="404506789"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404506789" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404506789">(Nov 27 2023 at 23:35)</a>:</h4>
<p>saulecabrera edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1406895918">PR review comment</a>.</p>



<a name="404675125"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404675125" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404675125">(Nov 28 2023 at 16:43)</a>:</h4>
<p>jeffcharles submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1753387170">PR review</a>.</p>



<a name="404675126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404675126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404675126">(Nov 28 2023 at 16:43)</a>:</h4>
<p>jeffcharles created <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1408071818">PR review comment</a>:</p>
<blockquote>
<p>Should <code>SPOffset</code> implement <code>Ord</code>? I can call <code>.as_u32()</code> on both sides, but I _think_ it would be reasonable to be able to compare them directly.</p>
</blockquote>



<a name="404677040"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404677040" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404677040">(Nov 28 2023 at 16:53)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<a name="404677169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404677169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404677169">(Nov 28 2023 at 16:54)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/saulecabrera">saulecabrera</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<a name="404677629"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404677629" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404677629">(Nov 28 2023 at 16:57)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1753415815">PR review</a>.</p>



<a name="404677631"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404677631" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404677631">(Nov 28 2023 at 16:57)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1408089829">PR review comment</a>:</p>
<blockquote>
<p>Yeah, I think it's fine for it to implement <code>Ord</code>. </p>
</blockquote>



<a name="404677746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404677746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404677746">(Nov 28 2023 at 16:57)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1753417464">PR review</a>.</p>



<a name="404677747"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404677747" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404677747">(Nov 28 2023 at 16:57)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#discussion_r1408090897">PR review comment</a>:</p>
<blockquote>
<p>We can do it in a follow-up PR too. </p>
</blockquote>



<a name="404693102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404693102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404693102">(Nov 28 2023 at 18:33)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<a name="404709157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404709157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404709157">(Nov 28 2023 at 20:05)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7590#pullrequestreview-1753835249">PR review</a>.</p>



<a name="404716012"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237590%20Winch%3A%20cleanup%20stack%20in%20br_if%20in%20non-.../near/404716012" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237590.20Winch.3A.20cleanup.20stack.20in.20br_if.20in.20non-.2E.2E.2E.html#404716012">(Nov 28 2023 at 20:53)</a>:</h4>
<p>saulecabrera merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7590">PR #7590</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>