<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4631 Wasmtime cannot be compiled to `wa... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html">wasmtime / issue #4631 Wasmtime cannot be compiled to `wa...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="292251630"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292251630" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292251630">(Aug 06 2022 at 12:20)</a>:</h4>
<p>tqwewe opened <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Attempting to build a crate to <code>wasm32-wasi</code> target with wasmtime as a dependency fails.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li>Create blank crate</li>
<li>Import wasmtime</li>
<li>Build to wasm32-wasi target<br>
<code>bash
   $ cargo build --target wasm32-wasi
   </code></li>
</ul>
<h3>Expected Results</h3>
<p>It should build just fine</p>
<h3>Actual Results</h3>
<p>I get a build error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="err">❯</span><span class="w"> </span><span class="n">cargo</span><span class="w"> </span><span class="o">+</span><span class="n">nightly</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">runner</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">88.0</span><span class="w"> </span><span class="p">(</span><span class="n">https</span>:<span class="c1">//github.com/bytecodealliance/wasmtime.git#1ce9e8aa)</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">zstd</span><span class="o">-</span><span class="n">sys</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="mf">0.1</span><span class="o">+</span><span class="n">zstd</span><span class="p">.</span><span class="mf">1.5.2</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">bincode</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="mf">3.3</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">toml</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">5.9</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">88.0</span><span class="w"> </span><span class="p">(</span><span class="n">https</span>:<span class="c1">//github.com/bytecodealliance/wasmtime.git#1ce9e8aa)`</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
  <span class="nc">process</span><span class="w"> </span><span class="n">didn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">successfully</span>: <span class="err">`</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="o">-</span><span class="n">c41799193b42c3f7</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">script</span><span class="o">-</span><span class="n">build</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="n">exit</span><span class="w"> </span><span class="n">status</span>: <span class="mi">101</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">stderr</span><span class="w"></span>
<span class="w">  </span><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">error</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">identifying</span><span class="w"> </span><span class="n">target</span>: <span class="s">"no supported isa found for arch `wasm32`"</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ari</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">1</span><span class="n">ce9e8a</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">42</span>:<span class="mi">53</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime commit: #1ce9e8aa</p>
<p>Operating system: Linux</p>
</blockquote>



<a name="292251631"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292251631" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292251631">(Aug 06 2022 at 12:20)</a>:</h4>
<p>tqwewe labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Attempting to build a crate to <code>wasm32-wasi</code> target with wasmtime as a dependency fails.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li>Create blank crate</li>
<li>Import wasmtime</li>
<li>Build to wasm32-wasi target<br>
<code>bash
   $ cargo build --target wasm32-wasi
   </code></li>
</ul>
<h3>Expected Results</h3>
<p>It should build just fine</p>
<h3>Actual Results</h3>
<p>I get a build error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="err">❯</span><span class="w"> </span><span class="n">cargo</span><span class="w"> </span><span class="o">+</span><span class="n">nightly</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">runner</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">88.0</span><span class="w"> </span><span class="p">(</span><span class="n">https</span>:<span class="c1">//github.com/bytecodealliance/wasmtime.git#1ce9e8aa)</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">zstd</span><span class="o">-</span><span class="n">sys</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="mf">0.1</span><span class="o">+</span><span class="n">zstd</span><span class="p">.</span><span class="mf">1.5.2</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">bincode</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="mf">3.3</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">toml</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">5.9</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">88.0</span><span class="w"> </span><span class="p">(</span><span class="n">https</span>:<span class="c1">//github.com/bytecodealliance/wasmtime.git#1ce9e8aa)`</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
  <span class="nc">process</span><span class="w"> </span><span class="n">didn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">successfully</span>: <span class="err">`</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="o">-</span><span class="n">c41799193b42c3f7</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">script</span><span class="o">-</span><span class="n">build</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="n">exit</span><span class="w"> </span><span class="n">status</span>: <span class="mi">101</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">stderr</span><span class="w"></span>
<span class="w">  </span><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">error</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">identifying</span><span class="w"> </span><span class="n">target</span>: <span class="s">"no supported isa found for arch `wasm32`"</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ari</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">1</span><span class="n">ce9e8a</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">42</span>:<span class="mi">53</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime commit: #1ce9e8aa</p>
<p>Operating system: Linux</p>
</blockquote>



<a name="292252234"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292252234" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292252234">(Aug 06 2022 at 12:32)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207206733">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Wasmtime is a wasm runtime with a jit backend. It can't run on wasm as wasm doesn't support jit's. Why do you want to compile wasmtime to wasm?</p>
</blockquote>



<a name="292252260"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292252260" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292252260">(Aug 06 2022 at 12:34)</a>:</h4>
<p>tqwewe <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207206961">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>I'm writing rust code which will be run with lunatic runtime. Lunatic runtime executes wasm modules. Though I want to also have my own wasmtime engine within my wasm module if that makes sense, since I don't have access to the host lunatic's engine and wasm stores</p>
</blockquote>



<a name="292252303"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292252303" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292252303">(Aug 06 2022 at 12:34)</a>:</h4>
<p>tqwewe edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207206961">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>I'm writing rust code which will be run with <a href="https://github.com/lunatic-solutions/lunatic">lunatic runtime</a>. Lunatic runtime executes wasm modules. Though I want to also have my own wasmtime engine within my wasm module if that makes sense, since I don't have access to the host lunatic's engine and wasm stores</p>
</blockquote>



<a name="292252389"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292252389" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292252389">(Aug 06 2022 at 12:37)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207207387">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>You will need to either use a wasm interpreter (at the cost of slower execution) or extend lunatic to provide a way to compile and run arbitrary wasm modules from within it.</p>
</blockquote>



<a name="292252463"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292252463" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292252463">(Aug 06 2022 at 12:38)</a>:</h4>
<p>tqwewe <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207207534">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>I see, having wasmtime running from within a wasm module simply isn't possible without a wasm interpreter?</p>
</blockquote>



<a name="292252767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292252767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292252767">(Aug 06 2022 at 12:45)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207208439">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>No, wasmtime only has a jit backend (cranelift), which can't possibly work in wasm. The whole security design of wasm depends on the fact that wasm modules can't generate arbitrary native code and then execute it.</p>
</blockquote>



<a name="292265289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292265289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292265289">(Aug 06 2022 at 16:01)</a>:</h4>
<p>jornfranke <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207238719">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Would it be possible that a WASM module can (dynamically) load another WASM module then? Maybe a stripped down version of wasmtime?<br>
E.g. I have a system that provides various plugins  and I only want to load the ones that I needed for a given file type. </p>
<p>The system itself is an application compiled to WASM and the plugins are dedicated WASM modules that are dynamically loaded. Would this be eventually possible? Similar to this one: <a href="https://github.com/ZuInnoTe/rust-wasm-dynamic-module-study">https://github.com/ZuInnoTe/rust-wasm-dynamic-module-study</a></p>
<p>Or does the system always have to be "native", ie a native application loading the wasmtime runtime or a Javascript "glue" code in a browser?</p>
</blockquote>



<a name="292265442"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292265442" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292265442">(Aug 06 2022 at 16:03)</a>:</h4>
<p>jornfranke edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207238719">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Would it be possible that a WASM module can (dynamically) load another WASM module then? Maybe a stripped down version of wasmtime?<br>
E.g. I have a system that provides various plugins  and I only want to load the ones that I needed for a given file type. </p>
<p>The system itself is an application compiled to WASM and the plugins are dedicated WASM modules that are dynamically loaded. Would this be eventually possible? Similar to this one: <a href="https://github.com/ZuInnoTe/rust-wasm-dynamic-module-study">https://github.com/ZuInnoTe/rust-wasm-dynamic-module-study</a> (edit: or simpler, would it be possible to compile such an application to wasm32-wasi? <a href="https://github.com/bytecodealliance/wasmtime/blob/main/examples/linking.rs">https://github.com/bytecodealliance/wasmtime/blob/main/examples/linking.rs</a>)</p>
<p>Or does the system always have to be "native", ie a native application loading the wasmtime runtime or a Javascript "glue" code in a browser?</p>
</blockquote>



<a name="292265646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292265646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292265646">(Aug 06 2022 at 16:07)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1207239835">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<blockquote>
<p>Would it be possible that a WASM module can (dynamically) load another WASM module then?</p>
</blockquote>
<p>That is what I mean with</p>
<blockquote>
<p>or extend lunatic to provide a way to compile and run arbitrary wasm modules from within it.</p>
</blockquote>
<p>It should then be possible to re-implement the wasmtime api based on this api exported to the wasm module.</p>
</blockquote>



<a name="292418438"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292418438" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292418438">(Aug 08 2022 at 15:36)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1208287020">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Wasmtime indeed does not compile to <code>wasm32-wasi</code> and to do so would be a very large effort. The only way Wasmtime could run WebAssembly within WebAssembly would be an interpreter but that probably isn't what you want. Instead the better solution here is to probably integrate with the existing host runtime to somehow allow dynamic loading of wasm modules. That itself is no small ask though and is also quite tricky.</p>
<p>Otherwise there are a number of interpreters for wasm written in Rust and Wasmtime doesn't currently have an interpreter. That's a major implementation project for Wasmtime that's best discussed through RFCs, so I'm going to close this for now.</p>
</blockquote>



<a name="292418439"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292418439" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292418439">(Aug 08 2022 at 15:36)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>Attempting to build a crate to <code>wasm32-wasi</code> target with wasmtime as a dependency fails.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li>Create blank crate</li>
<li>Import wasmtime</li>
<li>Build to wasm32-wasi target<br>
<code>bash
   $ cargo build --target wasm32-wasi
   </code></li>
</ul>
<h3>Expected Results</h3>
<p>It should build just fine</p>
<h3>Actual Results</h3>
<p>I get a build error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="err">❯</span><span class="w"> </span><span class="n">cargo</span><span class="w"> </span><span class="o">+</span><span class="n">nightly</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">runner</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">88.0</span><span class="w"> </span><span class="p">(</span><span class="n">https</span>:<span class="c1">//github.com/bytecodealliance/wasmtime.git#1ce9e8aa)</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">zstd</span><span class="o">-</span><span class="n">sys</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="mf">0.1</span><span class="o">+</span><span class="n">zstd</span><span class="p">.</span><span class="mf">1.5.2</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">bincode</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="mf">3.3</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">toml</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">5.9</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">88.0</span><span class="w"> </span><span class="p">(</span><span class="n">https</span>:<span class="c1">//github.com/bytecodealliance/wasmtime.git#1ce9e8aa)`</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
  <span class="nc">process</span><span class="w"> </span><span class="n">didn</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">successfully</span>: <span class="err">`</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="o">-</span><span class="n">c41799193b42c3f7</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">script</span><span class="o">-</span><span class="n">build</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="n">exit</span><span class="w"> </span><span class="n">status</span>: <span class="mi">101</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">stderr</span><span class="w"></span>
<span class="w">  </span><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">error</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">identifying</span><span class="w"> </span><span class="n">target</span>: <span class="s">"no supported isa found for arch `wasm32`"</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ari</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">1</span><span class="n">ce9e8a</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">42</span>:<span class="mi">53</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime commit: #1ce9e8aa</p>
<p>Operating system: Linux</p>
</blockquote>



<a name="292471769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234631%20Wasmtime%20cannot%20be%20compiled%20to%20%60wa.../near/292471769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234631.20Wasmtime.20cannot.20be.20compiled.20to.20.60wa.2E.2E.2E.html#292471769">(Aug 08 2022 at 17:29)</a>:</h4>
<p>jornfranke <a href="https://github.com/bytecodealliance/wasmtime/issues/4631#issuecomment-1208405836">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4631">issue #4631</a>:</p>
<blockquote>
<p>makes sense, thanks for the answer</p>
<blockquote>
<p>Instead the better solution here is to probably integrate with the existing host runtime to somehow allow dynamic loading of wasm modules</p>
</blockquote>
<p>Find here some of those considerations: <a href="https://github.com/ZuInnoTe/rust-wasm-dynamic-module-study">https://github.com/ZuInnoTe/rust-wasm-dynamic-module-study</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>