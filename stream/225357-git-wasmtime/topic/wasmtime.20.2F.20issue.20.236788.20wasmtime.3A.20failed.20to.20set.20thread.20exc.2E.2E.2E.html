<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6788 wasmtime: failed to set thread exc... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236788.20wasmtime.3A.20failed.20to.20set.20thread.20exc.2E.2E.2E.html">wasmtime / issue #6788 wasmtime: failed to set thread exc...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="380307588"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236788%20wasmtime%3A%20failed%20to%20set%20thread%20exc.../near/380307588" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236788.20wasmtime.3A.20failed.20to.20set.20thread.20exc.2E.2E.2E.html#380307588">(Jul 31 2023 at 11:45)</a>:</h4>
<p>casimiro opened <a href="https://github.com/bytecodealliance/wasmtime/issues/6788">issue #6788</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Although the behaviour observed and here described does not seem dependent on the Wasm file itself at all, this is the one considered for tests:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">(</span><span class="n">module</span>
<span class="w">  </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="cp">$hello</span><span class="w"> </span><span class="p">(</span><span class="n">import</span><span class="w"> </span><span class="s">""</span><span class="w"> </span><span class="s">"hello"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"run"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">call</span><span class="w"> </span><span class="cp">$hello</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<p>This issue can be reproduced in a C program that invokes <code>wasm_engine_new</code>,<br>
forks itself and then proceed to invoke the remaining C API calls in the child<br>
process.</p>
<p>The engine created in the main process doesn't even need to be used<br>
in the child process to trigger the segmentation fault.</p>
<p>The following C code, adapted from <code>./examples/hello.c</code>, triggers the behaviour:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">wasm</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>

<span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">exit_with_error</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">wasmtime_error_t</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">wasm_trap_t</span><span class="w"> </span><span class="o">*</span><span class="n">trap</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">wasm_trap_t</span><span class="o">*</span><span class="w"> </span><span class="n">hello_callback</span><span class="p">(</span>
<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">env</span><span class="p">,</span>
<span class="w">    </span><span class="n">wasmtime_caller_t</span><span class="w"> </span><span class="o">*</span><span class="n">caller</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">wasmtime_val_t</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
<span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">nargs</span><span class="p">,</span>
<span class="w">    </span><span class="n">wasmtime_val_t</span><span class="w"> </span><span class="o">*</span><span class="n">results</span><span class="p">,</span>
<span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">nresults</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"Calling back...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"&gt; Hello World!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">wasm_engine_t</span><span class="o">*</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_engine_new</span><span class="p">();</span>
<span class="w">  </span><span class="n">wasm_engine_delete</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"Initializing...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fork</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wasm_engine_t</span><span class="o">*</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_engine_new</span><span class="p">();</span>
<span class="w">    </span><span class="n">wasmtime_store_t</span><span class="w"> </span><span class="o">*</span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_store_new</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_context_t</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_store_context</span><span class="p">(</span><span class="n">store</span><span class="p">);</span>

<span class="w">    </span><span class="n">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">"examples/hello.wat"</span><span class="p">,</span><span class="w"> </span><span class="s">"r"</span><span class="p">);</span>
<span class="w">    </span><span class="n">fseek</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">SEEK_END</span><span class="p">);</span>
<span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">file_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ftell</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">    </span><span class="n">fseek</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">SEEK_SET</span><span class="p">);</span>

<span class="w">    </span><span class="n">wasm_byte_vec_t</span><span class="w"> </span><span class="n">wat</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasm_byte_vec_new_uninitialized</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wat</span><span class="p">,</span><span class="w"> </span><span class="n">file_size</span><span class="p">);</span>
<span class="w">    </span><span class="n">fread</span><span class="p">(</span><span class="n">wat</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">file_size</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">);</span>
<span class="w">    </span><span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

<span class="w">    </span><span class="n">wasm_byte_vec_t</span><span class="w"> </span><span class="n">wasm</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_error_t</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_wat2wasm</span><span class="p">(</span><span class="n">wat</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">wat</span><span class="p">.</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wasm</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to parse wat"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_byte_vec_delete</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wat</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Compiling module...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_module_t</span><span class="w"> </span><span class="o">*</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_module_new</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">module</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_byte_vec_delete</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wasm</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to compile module"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Creating callback...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_functype_t</span><span class="w"> </span><span class="o">*</span><span class="n">hello_ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_functype_new_0_0</span><span class="p">();</span>
<span class="w">    </span><span class="n">wasmtime_func_t</span><span class="w"> </span><span class="n">hello</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_func_new</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">hello_ty</span><span class="p">,</span><span class="w"> </span><span class="n">hello_callback</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hello</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Instantiating module...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_trap_t</span><span class="w"> </span><span class="o">*</span><span class="n">trap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_instance_t</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_extern_t</span><span class="w"> </span><span class="n">import</span><span class="p">;</span>
<span class="w">    </span><span class="n">import</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WASMTIME_EXTERN_FUNC</span><span class="p">;</span>
<span class="w">    </span><span class="n">import</span><span class="p">.</span><span class="n">of</span><span class="p">.</span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hello</span><span class="p">;</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_instance_new</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">import</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">trap</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to instantiate"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">trap</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Extracting export...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_extern_t</span><span class="w"> </span><span class="n">run</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_instance_export_get</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="s">"run"</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">run</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Calling export...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_func_call</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">run</span><span class="p">.</span><span class="n">of</span><span class="p">.</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">trap</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to call function"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">trap</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"All finished!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

<span class="w">    </span><span class="n">wasmtime_module_delete</span><span class="p">(</span><span class="n">module</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_store_delete</span><span class="p">(</span><span class="n">store</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_engine_delete</span><span class="p">(</span><span class="n">engine</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">exit_with_error</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">wasmtime_error_t</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">wasm_trap_t</span><span class="w"> </span><span class="o">*</span><span class="n">trap</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"error: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasm_byte_vec_t</span><span class="w"> </span><span class="n">error_message</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wasmtime_error_message</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error_message</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_error_delete</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wasm_trap_message</span><span class="p">(</span><span class="n">trap</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error_message</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_trap_delete</span><span class="p">(</span><span class="n">trap</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"%.*s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="w"> </span><span class="n">error_message</span><span class="p">.</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">error_message</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasm_byte_vec_delete</span><span class="p">(</span><span class="o">&amp;</span><span class="n">error_message</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3>Expected Results</h3>
<p>I expect to have something like this from the standard output:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">hello</span>
<span class="n">Initializing</span><span class="o">..</span><span class="p">.</span>
<span class="n">Compiling</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Creating</span><span class="w"> </span><span class="n">callback</span><span class="o">..</span><span class="p">.</span>
<span class="n">Instantiating</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Extracting</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">back</span><span class="o">..</span><span class="p">.</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">Hello</span><span class="w"> </span><span class="n">World</span><span class="o">!</span>
<span class="n">All</span><span class="w"> </span><span class="n">finished</span><span class="o">!</span>
</code></pre></div>
<h3>Actual Results</h3>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">.</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">hello</span>
<span class="n">Initializing</span><span class="o">..</span><span class="p">.</span>
<span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">@</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">73</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">Compiling</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Creating</span><span class="w"> </span><span class="n">callback</span><span class="o">..</span><span class="p">.</span>
<span class="n">Instantiating</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Extracting</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">thread</span><span class="w"> </span><span class="o">'&lt;</span><span class="n">unnamed</span><span class="o">&gt;'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">268435466</span><span class="err">`</span><span class="p">,</span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">0</span><span class="err">`</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">port</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="o">/</span><span class="n">macos</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">474</span>:<span class="mi">9</span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">backtrace_rs</span>::<span class="n">backtrace</span>::<span class="n">libunwind</span>::<span class="n">trace</span>::<span class="n">h63c1c2c6ab21e780</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/../../</span><span class="n">backtrace</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">backtrace</span><span class="o">/</span><span class="n">libunwind</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">93</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">1</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">backtrace_rs</span>::<span class="n">backtrace</span>::<span class="n">trace_unsynchronized</span>::<span class="n">hf38aadaccf972d0c</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/../../</span><span class="n">backtrace</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">backtrace</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">66</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">2</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">_print_fmt</span>::<span class="n">hbc7fc8ab62c7587a</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">65</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">3</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&lt;</span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">_print</span>::<span class="n">DisplayBacktrace</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">Display</span><span class="o">&gt;</span>::<span class="n">fmt</span>::<span class="n">h3fbf720fbb1cb41b</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">44</span>:<span class="mi">22</span>
<span class="w">   </span><span class="mi">4</span>:        <span class="mh">0x1021d0e38</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">rt</span>::<span class="n">Argument</span>::<span class="n">fmt</span>::<span class="n">h6f942517dda9fa22</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">fmt</span><span class="o">/</span><span class="n">rt</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">138</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">5</span>:        <span class="mh">0x1021d0e38</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">write</span>::<span class="n">h8ab6230d6f2a4204</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">fmt</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1094</span>:<span class="mi">21</span>
<span class="w">   </span><span class="mi">6</span>:        <span class="mh">0x10217be04</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">Write</span>::<span class="n">write_fmt</span>::<span class="n">h15ecdca1916a179e</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1713</span>:<span class="mi">15</span>
<span class="w">   </span><span class="mi">7</span>:        <span class="mh">0x102185b7c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">_print</span>::<span class="n">hb9cd8d0f949f9219</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">47</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">8</span>:        <span class="mh">0x102185b7c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">print</span>::<span class="n">hb6e94bab886a9ccf</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">34</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">9</span>:        <span class="mh">0x1021885e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">default_hook</span>::<span class="p">{{</span><span class="n">closure</span><span class="p">}}</span>::<span class="n">h4a0e30e90cb1c7bb</span>
<span class="w">  </span><span class="mi">10</span>:        <span class="mh">0x1021883e8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">default_hook</span>::<span class="n">h0bb5bbf65ac7c64d</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">288</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">11</span>:        <span class="mh">0x102188b68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">rust_panic_with_hook</span>::<span class="n">h17facd9c53870157</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">705</span>:<span class="mi">13</span>
<span class="w">  </span><span class="mi">12</span>:        <span class="mh">0x102188a74</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">begin_panic_handler</span>::<span class="p">{{</span><span class="n">closure</span><span class="p">}}</span>::<span class="n">h9eab8195c369d860</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">597</span>:<span class="mi">13</span>
<span class="w">  </span><span class="mi">13</span>:        <span class="mh">0x102186108</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">__rust_end_short_backtrace</span>::<span class="n">hce5f67454da3493d</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">151</span>:<span class="mi">18</span>
<span class="w">  </span><span class="mi">14</span>:        <span class="mh">0x1021887e8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rust_begin_unwind</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">593</span>:<span class="mi">5</span>
<span class="w">  </span><span class="mi">15</span>:        <span class="mh">0x102257afc</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span>::<span class="n">hc7e96873bfc1c7ba</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">67</span>:<span class="mi">14</span>
<span class="w">  </span><span class="mi">16</span>:        <span class="mh">0x102257df4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">panicking</span>::<span class="n">assert_failed_inner</span>::<span class="n">h9c0c629e544785f4</span>
<span class="w">  </span><span class="mi">17</span>:        <span class="mh">0x102244f1c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">panicking</span>::<span class="n">assert_failed</span>::<span class="n">hfe838f74eaaf86df</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">228</span>:<span class="mi">5</span>
<span class="w">  </span><span class="mi">18</span>:        <span class="mh">0x102244a54</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">macos</span>::<span class="n">lazy_per_thread_init</span>::<span class="n">h3f4bc6e0342ace6f</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="o">/</span><span class="n">macos</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">474</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">19</span>:        <span class="mh">0x101dd2880</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">tls</span>::<span class="n">raw</span>::<span class="n">replace</span>::<span class="p">{{</span><span class="n">closure</span><span class="p">}}</span>::<span class="n">h7b1f85cce42a81fb</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">577</span>:<span class="mi">21</span>
<span class="w">  </span><span class="mi">20</span>:        <span class="mh">0x101dcb1f8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">thread</span>::<span class="n">local</span>::<span class="n">LocalKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">try_with</span>::<span class="n">hbcc1f52fa2ccce66</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">thread</span><span class="o">/</span><span class="n">local</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">270</span>:<span class="mi">16</span>
<span class="w">  </span><span class="mi">21</span>:        <span class="mh">0x101dcb0a4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">thread</span>::<span class="n">local</span>::<span class="n">LocalKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">with</span>::<span class="n">hfb6aa9a623e59b91</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">thread</span><span class="o">/</span><span class="n">local</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">246</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">22</span>:        <span class="mh">0x100cd7eec</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">tls</span>::<span class="n">raw</span>::<span class="n">replace</span>::<span class="n">h7f17824cf711ea1d</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">571</span>:<span class="mi">13</span>
<span class="w">  </span><span class="mi">23</span>:        <span class="mh">0x100cdd318</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">tls</span>::<span class="n">set</span>::<span class="n">hdca844b261078194</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">678</span>:<span class="mi">20</span>
<span class="w">  </span><span class="mi">24</span>:        <span class="mh">0x100e4d320</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">call_thread_state</span>::<span class="n">CallThreadState</span><span class="o">&gt;</span>::<span class="n">with</span>::<span class="n">h4ba7e7d0ac56b8e0</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">409</span>:<span class="mi">19</span>
<span class="w">  </span><span class="mi">25</span>:        <span class="mh">0x100e2bce0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">catch_traps</span>::<span class="n">h60659c6a959930da</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">224</span>:<span class="mi">18</span>
<span class="w">  </span><span class="mi">26</span>:        <span class="mh">0x100d44e00</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">func</span>::<span class="n">invok</span>
<span class="p">[</span><span class="n">message</span><span class="w"> </span><span class="n">truncated</span><span class="p">]</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="380307590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236788%20wasmtime%3A%20failed%20to%20set%20thread%20exc.../near/380307590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236788.20wasmtime.3A.20failed.20to.20set.20thread.20exc.2E.2E.2E.html#380307590">(Jul 31 2023 at 11:45)</a>:</h4>
<p><a href="https://github.com/casimiro">casimiro</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/6788">Issue #6788</a>.</p>



<a name="380370948"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236788%20wasmtime%3A%20failed%20to%20set%20thread%20exc.../near/380370948" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236788.20wasmtime.3A.20failed.20to.20set.20thread.20exc.2E.2E.2E.html#380370948">(Jul 31 2023 at 14:39)</a>:</h4>
<p>casimiro <a href="https://github.com/bytecodealliance/wasmtime/issues/6788#issuecomment-1658502498">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/6788">issue #6788</a>:</p>
<blockquote>
<p>Closing this issue as this behaviour has already been reported at: <a href="https://github.com/bytecodealliance/wasmtime/issues/6785">https://github.com/bytecodealliance/wasmtime/issues/6785</a></p>
</blockquote>



<a name="380370951"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236788%20wasmtime%3A%20failed%20to%20set%20thread%20exc.../near/380370951" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236788.20wasmtime.3A.20failed.20to.20set.20thread.20exc.2E.2E.2E.html#380370951">(Jul 31 2023 at 14:39)</a>:</h4>
<p>casimiro closed <a href="https://github.com/bytecodealliance/wasmtime/issues/6788">issue #6788</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Although the behaviour observed and here described does not seem dependent on the Wasm file itself at all, this is the one considered for tests:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">(</span><span class="n">module</span>
<span class="w">  </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="cp">$hello</span><span class="w"> </span><span class="p">(</span><span class="n">import</span><span class="w"> </span><span class="s">""</span><span class="w"> </span><span class="s">"hello"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"run"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">call</span><span class="w"> </span><span class="cp">$hello</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<p>This issue can be reproduced in a C program that invokes <code>wasm_engine_new</code>,<br>
forks itself and then proceed to invoke the remaining C API calls in the child<br>
process.</p>
<p>The engine created in the main process doesn't even need to be used<br>
in the child process to trigger the segmentation fault.</p>
<p>The following C code, adapted from <code>./examples/hello.c</code>, triggers the behaviour:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">wasm</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">wasmtime</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
#<span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>

<span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">exit_with_error</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">wasmtime_error_t</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">wasm_trap_t</span><span class="w"> </span><span class="o">*</span><span class="n">trap</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">wasm_trap_t</span><span class="o">*</span><span class="w"> </span><span class="n">hello_callback</span><span class="p">(</span>
<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">env</span><span class="p">,</span>
<span class="w">    </span><span class="n">wasmtime_caller_t</span><span class="w"> </span><span class="o">*</span><span class="n">caller</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">wasmtime_val_t</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
<span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">nargs</span><span class="p">,</span>
<span class="w">    </span><span class="n">wasmtime_val_t</span><span class="w"> </span><span class="o">*</span><span class="n">results</span><span class="p">,</span>
<span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">nresults</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"Calling back...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"&gt; Hello World!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">wasm_engine_t</span><span class="o">*</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_engine_new</span><span class="p">();</span>
<span class="w">  </span><span class="n">wasm_engine_delete</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">"Initializing...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fork</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wasm_engine_t</span><span class="o">*</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_engine_new</span><span class="p">();</span>
<span class="w">    </span><span class="n">wasmtime_store_t</span><span class="w"> </span><span class="o">*</span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_store_new</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_context_t</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_store_context</span><span class="p">(</span><span class="n">store</span><span class="p">);</span>

<span class="w">    </span><span class="n">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">"examples/hello.wat"</span><span class="p">,</span><span class="w"> </span><span class="s">"r"</span><span class="p">);</span>
<span class="w">    </span><span class="n">fseek</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">SEEK_END</span><span class="p">);</span>
<span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">file_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ftell</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">    </span><span class="n">fseek</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">SEEK_SET</span><span class="p">);</span>

<span class="w">    </span><span class="n">wasm_byte_vec_t</span><span class="w"> </span><span class="n">wat</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasm_byte_vec_new_uninitialized</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wat</span><span class="p">,</span><span class="w"> </span><span class="n">file_size</span><span class="p">);</span>
<span class="w">    </span><span class="n">fread</span><span class="p">(</span><span class="n">wat</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">file_size</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">);</span>
<span class="w">    </span><span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

<span class="w">    </span><span class="n">wasm_byte_vec_t</span><span class="w"> </span><span class="n">wasm</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_error_t</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_wat2wasm</span><span class="p">(</span><span class="n">wat</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">wat</span><span class="p">.</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wasm</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to parse wat"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_byte_vec_delete</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wat</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Compiling module...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_module_t</span><span class="w"> </span><span class="o">*</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_module_new</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">module</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_byte_vec_delete</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wasm</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to compile module"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Creating callback...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_functype_t</span><span class="w"> </span><span class="o">*</span><span class="n">hello_ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_functype_new_0_0</span><span class="p">();</span>
<span class="w">    </span><span class="n">wasmtime_func_t</span><span class="w"> </span><span class="n">hello</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_func_new</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">hello_ty</span><span class="p">,</span><span class="w"> </span><span class="n">hello_callback</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hello</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Instantiating module...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_trap_t</span><span class="w"> </span><span class="o">*</span><span class="n">trap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_instance_t</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_extern_t</span><span class="w"> </span><span class="n">import</span><span class="p">;</span>
<span class="w">    </span><span class="n">import</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WASMTIME_EXTERN_FUNC</span><span class="p">;</span>
<span class="w">    </span><span class="n">import</span><span class="p">.</span><span class="n">of</span><span class="p">.</span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hello</span><span class="p">;</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_instance_new</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">import</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">trap</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to instantiate"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">trap</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Extracting export...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_extern_t</span><span class="w"> </span><span class="n">run</span><span class="p">;</span>
<span class="w">    </span><span class="n">wasmtime_instance_export_get</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="s">"run"</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">run</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Calling export...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_func_call</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">run</span><span class="p">.</span><span class="n">of</span><span class="p">.</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">trap</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="n">exit_with_error</span><span class="p">(</span><span class="s">"failed to call function"</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">trap</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"All finished!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

<span class="w">    </span><span class="n">wasmtime_module_delete</span><span class="p">(</span><span class="n">module</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_store_delete</span><span class="p">(</span><span class="n">store</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_engine_delete</span><span class="p">(</span><span class="n">engine</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">exit_with_error</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">wasmtime_error_t</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">wasm_trap_t</span><span class="w"> </span><span class="o">*</span><span class="n">trap</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"error: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasm_byte_vec_t</span><span class="w"> </span><span class="n">error_message</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wasmtime_error_message</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error_message</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasmtime_error_delete</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wasm_trap_message</span><span class="p">(</span><span class="n">trap</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error_message</span><span class="p">);</span>
<span class="w">    </span><span class="n">wasm_trap_delete</span><span class="p">(</span><span class="n">trap</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">"%.*s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="w"> </span><span class="n">error_message</span><span class="p">.</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">error_message</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasm_byte_vec_delete</span><span class="p">(</span><span class="o">&amp;</span><span class="n">error_message</span><span class="p">);</span>
<span class="w">  </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3>Expected Results</h3>
<p>I expect to have something like this from the standard output:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">hello</span>
<span class="n">Initializing</span><span class="o">..</span><span class="p">.</span>
<span class="n">Compiling</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Creating</span><span class="w"> </span><span class="n">callback</span><span class="o">..</span><span class="p">.</span>
<span class="n">Instantiating</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Extracting</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">back</span><span class="o">..</span><span class="p">.</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">Hello</span><span class="w"> </span><span class="n">World</span><span class="o">!</span>
<span class="n">All</span><span class="w"> </span><span class="n">finished</span><span class="o">!</span>
</code></pre></div>
<h3>Actual Results</h3>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">.</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">hello</span>
<span class="n">Initializing</span><span class="o">..</span><span class="p">.</span>
<span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">@</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">73</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">Compiling</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Creating</span><span class="w"> </span><span class="n">callback</span><span class="o">..</span><span class="p">.</span>
<span class="n">Instantiating</span><span class="w"> </span><span class="n">module</span><span class="o">..</span><span class="p">.</span>
<span class="n">Extracting</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">export</span><span class="o">..</span><span class="p">.</span>
<span class="n">thread</span><span class="w"> </span><span class="o">'&lt;</span><span class="n">unnamed</span><span class="o">&gt;'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="err">`</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="err">`</span>
<span class="w">  </span><span class="n">left</span>: <span class="err">`</span><span class="mi">268435466</span><span class="err">`</span><span class="p">,</span>
<span class="w"> </span><span class="n">right</span>: <span class="err">`</span><span class="mi">0</span><span class="err">`</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">port</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="o">/</span><span class="n">macos</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">474</span>:<span class="mi">9</span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">backtrace_rs</span>::<span class="n">backtrace</span>::<span class="n">libunwind</span>::<span class="n">trace</span>::<span class="n">h63c1c2c6ab21e780</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/../../</span><span class="n">backtrace</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">backtrace</span><span class="o">/</span><span class="n">libunwind</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">93</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">1</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">backtrace_rs</span>::<span class="n">backtrace</span>::<span class="n">trace_unsynchronized</span>::<span class="n">hf38aadaccf972d0c</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/../../</span><span class="n">backtrace</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">backtrace</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">66</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">2</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">_print_fmt</span>::<span class="n">hbc7fc8ab62c7587a</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">65</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">3</span>:        <span class="mh">0x102185d28</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&lt;</span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">_print</span>::<span class="n">DisplayBacktrace</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">Display</span><span class="o">&gt;</span>::<span class="n">fmt</span>::<span class="n">h3fbf720fbb1cb41b</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">44</span>:<span class="mi">22</span>
<span class="w">   </span><span class="mi">4</span>:        <span class="mh">0x1021d0e38</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">rt</span>::<span class="n">Argument</span>::<span class="n">fmt</span>::<span class="n">h6f942517dda9fa22</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">fmt</span><span class="o">/</span><span class="n">rt</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">138</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">5</span>:        <span class="mh">0x1021d0e38</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">write</span>::<span class="n">h8ab6230d6f2a4204</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">fmt</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1094</span>:<span class="mi">21</span>
<span class="w">   </span><span class="mi">6</span>:        <span class="mh">0x10217be04</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">Write</span>::<span class="n">write_fmt</span>::<span class="n">h15ecdca1916a179e</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1713</span>:<span class="mi">15</span>
<span class="w">   </span><span class="mi">7</span>:        <span class="mh">0x102185b7c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">_print</span>::<span class="n">hb9cd8d0f949f9219</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">47</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">8</span>:        <span class="mh">0x102185b7c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">print</span>::<span class="n">hb6e94bab886a9ccf</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">34</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">9</span>:        <span class="mh">0x1021885e0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">default_hook</span>::<span class="p">{{</span><span class="n">closure</span><span class="p">}}</span>::<span class="n">h4a0e30e90cb1c7bb</span>
<span class="w">  </span><span class="mi">10</span>:        <span class="mh">0x1021883e8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">default_hook</span>::<span class="n">h0bb5bbf65ac7c64d</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">288</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">11</span>:        <span class="mh">0x102188b68</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">rust_panic_with_hook</span>::<span class="n">h17facd9c53870157</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">705</span>:<span class="mi">13</span>
<span class="w">  </span><span class="mi">12</span>:        <span class="mh">0x102188a74</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">panicking</span>::<span class="n">begin_panic_handler</span>::<span class="p">{{</span><span class="n">closure</span><span class="p">}}</span>::<span class="n">h9eab8195c369d860</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">597</span>:<span class="mi">13</span>
<span class="w">  </span><span class="mi">13</span>:        <span class="mh">0x102186108</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">sys_common</span>::<span class="n">backtrace</span>::<span class="n">__rust_end_short_backtrace</span>::<span class="n">hce5f67454da3493d</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">sys_common</span><span class="o">/</span><span class="n">backtrace</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">151</span>:<span class="mi">18</span>
<span class="w">  </span><span class="mi">14</span>:        <span class="mh">0x1021887e8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rust_begin_unwind</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">593</span>:<span class="mi">5</span>
<span class="w">  </span><span class="mi">15</span>:        <span class="mh">0x102257afc</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span>::<span class="n">hc7e96873bfc1c7ba</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">67</span>:<span class="mi">14</span>
<span class="w">  </span><span class="mi">16</span>:        <span class="mh">0x102257df4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">panicking</span>::<span class="n">assert_failed_inner</span>::<span class="n">h9c0c629e544785f4</span>
<span class="w">  </span><span class="mi">17</span>:        <span class="mh">0x102244f1c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">core</span>::<span class="n">panicking</span>::<span class="n">assert_failed</span>::<span class="n">hfe838f74eaaf86df</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">228</span>:<span class="mi">5</span>
<span class="w">  </span><span class="mi">18</span>:        <span class="mh">0x102244a54</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">macos</span>::<span class="n">lazy_per_thread_init</span>::<span class="n">h3f4bc6e0342ace6f</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="o">/</span><span class="n">macos</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">474</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">19</span>:        <span class="mh">0x101dd2880</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">tls</span>::<span class="n">raw</span>::<span class="n">replace</span>::<span class="p">{{</span><span class="n">closure</span><span class="p">}}</span>::<span class="n">h7b1f85cce42a81fb</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">577</span>:<span class="mi">21</span>
<span class="w">  </span><span class="mi">20</span>:        <span class="mh">0x101dcb1f8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">thread</span>::<span class="n">local</span>::<span class="n">LocalKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">try_with</span>::<span class="n">hbcc1f52fa2ccce66</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">thread</span><span class="o">/</span><span class="n">local</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">270</span>:<span class="mi">16</span>
<span class="w">  </span><span class="mi">21</span>:        <span class="mh">0x101dcb0a4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">std</span>::<span class="n">thread</span>::<span class="n">local</span>::<span class="n">LocalKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">with</span>::<span class="n">hfb6aa9a623e59b91</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">8</span><span class="n">ede3aae28fe6e4d52b38157d7bfe0d3bceef225</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">thread</span><span class="o">/</span><span class="n">local</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">246</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">22</span>:        <span class="mh">0x100cd7eec</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">tls</span>::<span class="n">raw</span>::<span class="n">replace</span>::<span class="n">h7f17824cf711ea1d</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">571</span>:<span class="mi">13</span>
<span class="w">  </span><span class="mi">23</span>:        <span class="mh">0x100cdd318</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">tls</span>::<span class="n">set</span>::<span class="n">hdca844b261078194</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">678</span>:<span class="mi">20</span>
<span class="w">  </span><span class="mi">24</span>:        <span class="mh">0x100e4d320</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">call_thread_state</span>::<span class="n">CallThreadState</span><span class="o">&gt;</span>::<span class="n">with</span>::<span class="n">h4ba7e7d0ac56b8e0</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">409</span>:<span class="mi">19</span>
<span class="w">  </span><span class="mi">25</span>:        <span class="mh">0x100e2bce0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime_runtime</span>::<span class="n">traphandlers</span>::<span class="n">catch_traps</span>::<span class="n">h60659c6a959930da</span>
<span class="w">                               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">ec2</span><span class="o">-</span><span class="n">user</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">traphandlers</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">224</span>:<span class="mi">18</span>
<span class="w">  </span><span class="mi">26</span>:        <span class="mh">0x100d44e00</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">func</span>::<span class="n">invok</span>
<span class="p">[</span><span class="n">message</span><span class="w"> </span><span class="n">truncated</span><span class="p">]</span>
</code></pre></div><br>
</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>