<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4776 Implement the remaining socket-rel... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234776.20Implement.20the.20remaining.20socket-rel.2E.2E.2E.html">wasmtime / issue #4776 Implement the remaining socket-rel...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="295129097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234776%20Implement%20the%20remaining%20socket-rel.../near/295129097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234776.20Implement.20the.20remaining.20socket-rel.2E.2E.2E.html#295129097">(Aug 24 2022 at 21:22)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/4776#issuecomment-1226381140">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4776">issue #4776</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @kubkon</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasi"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>kubkon: wasi</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="295137105"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234776%20Implement%20the%20remaining%20socket-rel.../near/295137105" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234776.20Implement.20the.20remaining.20socket-rel.2E.2E.2E.html#295137105">(Aug 24 2022 at 22:36)</a>:</h4>
<p>sunfishcode <a href="https://github.com/bytecodealliance/wasmtime/pull/4776#issuecomment-1226532747">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4776">issue #4776</a>:</p>
<blockquote>
<p>Windows disagrees :upside_down_face: </p>
</blockquote>



<a name="295142708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234776%20Implement%20the%20remaining%20socket-rel.../near/295142708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234776.20Implement.20the.20remaining.20socket-rel.2E.2E.2E.html#295142708">(Aug 24 2022 at 23:46)</a>:</h4>
<p>jameysharp <a href="https://github.com/bytecodealliance/wasmtime/pull/4776#issuecomment-1226606335">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4776">issue #4776</a>:</p>
<blockquote>
<p>I assume cargo-vet is going to need a delta audit for <code>system-interface</code>.</p>
</blockquote>



<a name="295158412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234776%20Implement%20the%20remaining%20socket-rel.../near/295158412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234776.20Implement.20the.20remaining.20socket-rel.2E.2E.2E.html#295158412">(Aug 25 2022 at 04:09)</a>:</h4>
<p>stevelr <a href="https://github.com/bytecodealliance/wasmtime/pull/4776#issuecomment-1226750279">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4776">issue #4776</a>:</p>
<blockquote>
<p>I am not sure I see how sock_shutdown is intended to be used if the socket is in use by a wasm module.</p>
<p>Scenario: the host creates a tcp listener socket bound to an address, and adds it to <code>WasiCtx</code> as a <code>preopened_socket</code>.  The wasm module creates a listener via the wasi api and calls accept().</p>
<p>Sometime later, while wasm module is still waiting on <code>accept</code>, the host wants to stop the module. It can't directly call <code>sock_shutdown</code> because neither TcpListen nor Socket are cloneable, so it can't hold onto a cloned object to call shutdown on it later. If the host kept the u32 file descriptor, it could either recreate a Socket from the fd and call sock_shutdown, or pass the fd to a low-level unix function to close it, which seems extremely non-portable. There is a try_clone and if it succeeds it creates an alias file descriptor, but it's not clear from the documentation if it would work for this purpose.</p>
<p>What is the recommended method of closing a socket in this scenario? <br>
</p>
</blockquote>



<a name="295215583"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234776%20Implement%20the%20remaining%20socket-rel.../near/295215583" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234776.20Implement.20the.20remaining.20socket-rel.2E.2E.2E.html#295215583">(Aug 25 2022 at 12:20)</a>:</h4>
<p>sunfishcode <a href="https://github.com/bytecodealliance/wasmtime/pull/4776#issuecomment-1227183000">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4776">issue #4776</a>:</p>
<blockquote>
<p>@stevelr shutdown doesn't do a close; it just marks a stream as no longer readable, writeable, or both. The file descriptor remains open. And it isn't required to be called.</p>
<p>The main use case for it that I know is for one side of a socket to declare that it's done writing to a stream and will subsequently only be reading the response.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>