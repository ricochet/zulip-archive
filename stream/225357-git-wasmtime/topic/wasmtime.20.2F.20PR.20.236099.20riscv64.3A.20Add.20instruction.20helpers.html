<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6099 riscv64: Add instruction helpers · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236099.20riscv64.3A.20Add.20instruction.20helpers.html">wasmtime / PR #6099 riscv64: Add instruction helpers</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="344323179"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236099%20riscv64%3A%20Add%20instruction%20helpers/near/344323179" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236099.20riscv64.3A.20Add.20instruction.20helpers.html#344323179">(Mar 24 2023 at 17:01)</a>:</h4>
<p>afonso360 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6099">PR #6099</a> from <code>riscv-inst-helpers</code> to <code>main</code>:</p>
<blockquote>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> Hey,</p>
<p>This change is something we discussed recently. It refactors the RISC-V ISLE files so that all instructions are emitted via helpers, similar to what we have in the x64 backend.</p>
<p>It also unifies them under a common syntax. We currently use 4 different ways of emitting instructions:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">(</span><span class="n">alu_rrr</span><span class="w"> </span><span class="p">(</span><span class="n">AluOPRRR</span><span class="p">.</span><span class="w"> </span><span class="o">..</span><span class="p">.)</span><span class="w"> </span><span class="o">..</span><span class="p">.)</span>
<span class="p">(</span><span class="n">emit_</span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="n">alu_</span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="n">gen_</span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>These were all different ways of doing the same thing. Sometimes we even used multiple variations of the above for the same instruction.</p>
<p>With this PR, single instructions are now emitted using <code>rv_...</code>. Larger patterns are still emitted using one of <code>gen_...</code> or <code>lower_...</code>.</p>
<p>This is a pretty large refactor. I'm not sure if it helps reviewing but I've tried to restrict changes to one instruction per commit. It also doesn't change any of the golden output tests, so that helps making sure I haven't messed up anywhere.</p>
</blockquote>



<a name="344336721"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236099%20riscv64%3A%20Add%20instruction%20helpers/near/344336721" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236099.20riscv64.3A.20Add.20instruction.20helpers.html#344336721">(Mar 24 2023 at 18:00)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6099#pullrequestreview-1357203135">PR review</a>.</p>



<a name="344342796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236099%20riscv64%3A%20Add%20instruction%20helpers/near/344342796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236099.20riscv64.3A.20Add.20instruction.20helpers.html#344342796">(Mar 24 2023 at 18:34)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6099">PR #6099</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>