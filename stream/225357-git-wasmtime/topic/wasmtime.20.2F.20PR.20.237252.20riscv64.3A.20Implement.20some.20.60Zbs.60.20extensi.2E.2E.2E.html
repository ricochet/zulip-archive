<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7252 riscv64: Implement some `Zbs` extensi... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html">wasmtime / PR #7252 riscv64: Implement some `Zbs` extensi...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="396910386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/396910386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#396910386">(Oct 16 2023 at 14:03)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/afonso360">afonso360</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a>.</p>



<a name="396910388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/396910388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#396910388">(Oct 16 2023 at 14:03)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/elliottt">elliottt</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a>.</p>



<a name="396910389"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/396910389" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#396910389">(Oct 16 2023 at 14:03)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a> from <code>alexcrichton:rv64-zbs</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This commit extends the riscv64 backend with instructions from the <code>Zbs</code> extension. I did this awhile back for the bmi{1,2} instructions for x64 and this is mostly for completeness's sake rather than performance or anything like that, and because I had a long plane ride!</p>
</blockquote>



<a name="396910391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/396910391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#396910391">(Oct 16 2023 at 14:03)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a>.</p>



<a name="397081109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081109">(Oct 17 2023 at 10:46)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#pullrequestreview-1681982002">PR review</a>:</p>
<blockquote>
<p>Nice! Some small suggestions if you'd like to expand on this.</p>
<p>With so many patterns here I think it might be worth eventually creating intermediate instructions in CLIF and moving some of these rules to the egraphs layer. But this looks good to me!</p>
</blockquote>



<a name="397081110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081110">(Oct 17 2023 at 10:46)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#pullrequestreview-1681982002">PR review</a>:</p>
<blockquote>
<p>Nice! Some small suggestions if you'd like to expand on this.</p>
<p>With so many patterns here I think it might be worth eventually creating intermediate instructions in CLIF and moving some of these rules to the egraphs layer. But this looks good to me!</p>
</blockquote>



<a name="397081112"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081112" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081112">(Oct 17 2023 at 10:46)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#discussion_r1361901970">PR review comment</a>:</p>
<blockquote>
<p>Also, perhaps we should add equivalent rules for these with swapped arguments. i.e. <code>(band (bnot ...) y)</code> we have them for the other  instructions but not for <code>bclr</code>.</p>
</blockquote>



<a name="397081113"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081113" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081113">(Oct 17 2023 at 10:46)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#discussion_r1361901799">PR review comment</a>:</p>
<blockquote>
<p>A small suggestion here would be to change this to <code>(u64_sub (ty_bits ty) 1)</code> so that we could also apply these patterns to i16 and i8.</p>
</blockquote>



<a name="397081199"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081199" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081199">(Oct 17 2023 at 10:47)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#discussion_r1361901799">PR review comment</a>.</p>



<a name="397081275"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081275" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081275">(Oct 17 2023 at 10:47)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#pullrequestreview-1681982002">PR review</a>:</p>
<blockquote>
<p>Nice! Some small suggestions if you'd like to expand on this.</p>
<p>With so many patterns here I think it might be worth eventually creating intermediate instructions in CLIF and moving some of these rules to the egraphs layer. But this looks good to me!</p>
<p>I've also been running the fuzzer on this branch and it hasn't found anything yet.</p>
</blockquote>



<a name="397081434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081434">(Oct 17 2023 at 10:48)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#pullrequestreview-1681982002">PR review</a>:</p>
<blockquote>
<p>Nice! Some small suggestions if you'd like to expand on this.</p>
<p>With so many patterns here I think it might be worth eventually creating intermediate instructions in CLIF and moving some of these rules to the egraphs layer. But this looks good to me! (cc: #1067)</p>
<p>I've also been running the fuzzer on this branch and it hasn't found anything yet.</p>
</blockquote>



<a name="397081741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397081741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397081741">(Oct 17 2023 at 10:50)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7252#pullrequestreview-1681982002">PR review</a>:</p>
<blockquote>
<p>Nice! Some small suggestions if you'd like to expand on this.</p>
<p>With so many patterns here I think it might be worth eventually creating intermediate instructions in CLIF and moving some of these rules to the egraphs layer. But this looks good to me!</p>
<p>I've also been running the fuzzer on this branch and it hasn't found anything yet.</p>
</blockquote>



<a name="397128847"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397128847" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397128847">(Oct 17 2023 at 15:04)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a>.</p>



<a name="397128880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397128880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397128880">(Oct 17 2023 at 15:04)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a>.</p>



<a name="397144995"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237252%20riscv64%3A%20Implement%20some%20%60Zbs%60%20extensi.../near/397144995" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237252.20riscv64.3A.20Implement.20some.20.60Zbs.60.20extensi.2E.2E.2E.html#397144995">(Oct 17 2023 at 16:27)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7252">PR #7252</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>