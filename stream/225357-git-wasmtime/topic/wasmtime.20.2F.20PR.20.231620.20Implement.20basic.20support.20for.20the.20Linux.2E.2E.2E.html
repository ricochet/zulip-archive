<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1620 Implement basic support for the Linux... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html">wasmtime / PR #1620 Implement basic support for the Linux...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="195564611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195564611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195564611">(Apr 28 2020 at 13:35)</a>:</h4>
<p>whitequark opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1620" title="https://github.com/bytecodealliance/wasmtime/pull/1620">PR #1620</a> from <code>x86_32-mvp</code> to <code>master</code>:</p>
<blockquote>
<p>This PR, together with #1612, #1615 and #1616 makes it possible to run simple WASI binaries on x86_32 Linux. There are some caveats:</p>
<p>* Because of the approach taken in #1612, it is necessary to always use <code>--enable-simd</code>.<br>
  * There are still some issues in the 32-bit legalizer that prevent complex applications from running.<br>
  * Debug information is not generated.</p>
<p>Other than that it should be fully functional, or at least I don't see anything obviously broken.</p>
</blockquote>



<a name="195569146"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195569146" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195569146">(Apr 28 2020 at 14:08)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-401873168" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-401873168">PR Review</a>.</p>



<a name="195569147"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195569147" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195569147">(Apr 28 2020 at 14:08)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r416643626" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r416643626">PR Review Comment</a>:</p>
<blockquote>
<p><code>ArgumentPurpose::Normal</code> is not correct.</p>
</blockquote>



<a name="195569407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195569407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195569407">(Apr 28 2020 at 14:10)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-401874875" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-401874875">PR Review</a>.</p>



<a name="195569408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195569408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195569408">(Apr 28 2020 at 14:10)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r416644995" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r416644995">PR Review Comment</a>:</p>
<blockquote>
<p>You should use <code>pos.func.stack_slots.make_incoming_arg(types::I32, offset)</code> and then load from the resulting stack slot.</p>
</blockquote>



<a name="195569525"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195569525" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195569525">(Apr 28 2020 at 14:11)</a>:</h4>
<p>bjorn3 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r416644995" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r416644995">PR Review Comment</a>.</p>



<a name="195656614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195656614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195656614">(Apr 29 2020 at 03:42)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402347219" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402347219">PR Review</a>.</p>



<a name="195656615"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195656615" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195656615">(Apr 29 2020 at 03:42)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417050262" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417050262">PR Review Comment</a>:</p>
<blockquote>
<p>Does that actually work in the prologue itself?</p>
</blockquote>



<a name="195658322"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195658322" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195658322">(Apr 29 2020 at 04:09)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402353387" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402353387">PR Review</a>.</p>



<a name="195658323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195658323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195658323">(Apr 29 2020 at 04:09)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417056196" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417056196">PR Review Comment</a>:</p>
<blockquote>
<p>Ish. Stack slots are handled correctly in x86 after rsp's final adjustment, even though there may be a little more prologue afterward (for example, x86_64 XMM preservation <a href="https://github.com/bytecodealliance/wasmtime/blob/d2ec33c6caec7eda7afcf9f025c88b413b7ff0f1/cranelift/codegen/src/isa/x86/abi.rs#L799" title="https://github.com/bytecodealliance/wasmtime/blob/d2ec33c6caec7eda7afcf9f025c88b413b7ff0f1/cranelift/codegen/src/isa/x86/abi.rs#L799">relies on this</a>). It looks like this is too early for an explicit <code>stack_load</code> here.</p>
</blockquote>



<a name="195658510"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195658510" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195658510">(Apr 29 2020 at 04:15)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402354693" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402354693">PR Review</a>.</p>



<a name="195658511"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195658511" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195658511">(Apr 29 2020 at 04:15)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417057421" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417057421">PR Review Comment</a>:</p>
<blockquote>
<p>That was my understanding too, which is why I spent several hours figuring out a solution that does not involve a <code>stack_load</code>.</p>
</blockquote>



<a name="195658533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195658533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195658533">(Apr 29 2020 at 04:15)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417057515" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417057515">PR Review Comment</a>:</p>
<blockquote>
<p>I agree. What would be appropriate here, assuming <code>stack_load</code> indeed isn't, as discussed below?</p>
</blockquote>



<a name="195658534"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195658534" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195658534">(Apr 29 2020 at 04:15)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402354820" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402354820">PR Review</a>.</p>



<a name="195667330"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195667330" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195667330">(Apr 29 2020 at 06:54)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402402699" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-402402699">PR Review</a>.</p>



<a name="195667331"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/195667331" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#195667331">(Apr 29 2020 at 06:54)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417101780" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r417101780">PR Review Comment</a>:</p>
<blockquote>
<p>Maybe use <code>fill</code>? That one takes the SSA var stored on stack and outputs it ib a register.</p>
</blockquote>



<a name="196033611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196033611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196033611">(May 02 2020 at 04:53)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r418895465" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r418895465">PR Review Comment</a>:</p>
<blockquote>
<p>@bjorn3 <code>fill</code> has the exact same problem as <code>stack_load</code>, no? It also uses stack slots, which is what I am avoiding in this code.</p>
</blockquote>



<a name="196033612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196033612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196033612">(May 02 2020 at 04:53)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-404500465" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-404500465">PR Review</a>.</p>



<a name="196369854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196369854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196369854">(May 05 2020 at 21:21)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406164662" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406164662">PR Review</a>.</p>



<a name="196369855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196369855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196369855">(May 05 2020 at 21:21)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420414022" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420414022">PR Review Comment</a>:</p>
<blockquote>
<p>@iximeow Could you advise on any workable way to implement this operation? I'll be happy to implement whatever the upstream likes here. I think I could use a <code>stack_load</code> with an ad-hoc fixup if that's considered OK, though that looks pretty gross to me personally.</p>
</blockquote>



<a name="196389380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196389380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196389380">(May 06 2020 at 01:42)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406260490" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406260490">PR Review</a>.</p>



<a name="196389381"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196389381" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196389381">(May 06 2020 at 01:42)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420502865" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420502865">PR Review Comment</a>:</p>
<blockquote>
<p>I think this is the workable approach, since stack slot machinery isn't usable this early in the function. I agree that <code>stack_load</code> with some later fixup would not be better.</p>
</blockquote>



<a name="196390147"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390147" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390147">(May 06 2020 at 02:02)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406261113" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406261113">PR Review</a>.</p>



<a name="196390148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390148">(May 06 2020 at 02:02)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406261113" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406261113">PR Review</a>.</p>



<a name="196390149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390149">(May 06 2020 at 02:02)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420503495" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420503495">PR Review Comment</a>:</p>
<blockquote>
<p>This is to read the item before the return address, right? That happens to be the leftmost argument and VMContext typically, but I think this ought to be</p>
<div class="codehilite"><pre><span></span><code>let offset = offset + i32::from(pos.isa.pointer_bytes() * (1 + vmctx_index))
``` to be correct if VMContext happens to be some later argument.
~~~
</code></pre></div>


</blockquote>



<a name="196390150"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390150" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390150">(May 06 2020 at 02:02)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420506568" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420506568">PR Review Comment</a>:</p>
<blockquote>
<p>I'd give <code>ArgumentPurpose::CalleeSaved</code> a shot here, this is well after register allocation so it's probably free of risk in side effects there. The primary benefit of being descriptive here is to be clear this isn't an argument from the original function somehow ending up in esp, I don't think the <code>ArgumentPurpose</code> at this point would have any actual effect.</p>
</blockquote>



<a name="196390151"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390151" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390151">(May 06 2020 at 02:02)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420507323" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420507323">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code>                    // The following access can be marked `trusted` because it is a load of an argument. We
                    // know it is safe because it was safe to write it in preparing this function call.
                    let ret =
</code></pre></div>


<p>Just because while we can be quite confident it's a trusted access, it might not be immediately obvious to the reader.</p>
</blockquote>



<a name="196390697"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390697" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390697">(May 06 2020 at 02:14)</a>:</h4>
<p>whitequark updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1620" title="https://github.com/bytecodealliance/wasmtime/pull/1620">PR #1620</a> from <code>x86_32-mvp</code> to <code>master</code>:</p>
<blockquote>
<p>This PR, together with #1612, #1615 and #1616 makes it possible to run simple WASI binaries on x86_32 Linux. There are some caveats:</p>
<p>* Because of the approach taken in #1612, it is necessary to always use <code>--enable-simd</code>.<br>
  * There are still some issues in the 32-bit legalizer that prevent complex applications from running.<br>
  * Debug information is not generated.</p>
<p>Other than that it should be fully functional, or at least I don't see anything obviously broken.</p>
</blockquote>



<a name="196390722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390722">(May 06 2020 at 02:15)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420510476" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420510476">PR Review Comment</a>:</p>
<blockquote>
<p>You're being kind heh, I'm pretty sure I, uh, just copy-and-pasted that <code>trusted</code> bit without ever stopping to give it any thought.</p>
</blockquote>



<a name="196390723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390723">(May 06 2020 at 02:15)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406268166" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406268166">PR Review</a>.</p>



<a name="196390861"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390861" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390861">(May 06 2020 at 02:18)</a>:</h4>
<p>whitequark updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1620" title="https://github.com/bytecodealliance/wasmtime/pull/1620">PR #1620</a> from <code>x86_32-mvp</code> to <code>master</code>:</p>
<blockquote>
<p>This PR, together with #1612, #1615 and #1616 makes it possible to run simple WASI binaries on x86_32 Linux. There are some caveats:</p>
<p>* Because of the approach taken in #1612, it is necessary to always use <code>--enable-simd</code>.<br>
  * There are still some issues in the 32-bit legalizer that prevent complex applications from running.<br>
  * Debug information is not generated.</p>
<p>Other than that it should be fully functional, or at least I don't see anything obviously broken.</p>
</blockquote>



<a name="196390862"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390862" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390862">(May 06 2020 at 02:18)</a>:</h4>
<p>whitequark submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406268804" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-406268804">PR Review</a>.</p>



<a name="196390863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390863">(May 06 2020 at 02:18)</a>:</h4>
<p>whitequark created <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420511092" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420511092">PR Review Comment</a>:</p>
<blockquote>
<p>Good catch, fixed</p>
</blockquote>



<a name="196390892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196390892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196390892">(May 06 2020 at 02:19)</a>:</h4>
<p>whitequark updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1620" title="https://github.com/bytecodealliance/wasmtime/pull/1620">PR #1620</a> from <code>x86_32-mvp</code> to <code>master</code>:</p>
<blockquote>
<p>This PR, together with #1612, #1615 and #1616 makes it possible to run simple WASI binaries on x86_32 Linux. There are some caveats:</p>
<p>* Because of the approach taken in #1612, it is necessary to always use <code>--enable-simd</code>.<br>
  * There are still some issues in the 32-bit legalizer that prevent complex applications from running.<br>
  * Debug information is not generated.</p>
<p>Other than that it should be fully functional, or at least I don't see anything obviously broken.</p>
</blockquote>



<a name="196391073"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196391073" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196391073">(May 06 2020 at 02:22)</a>:</h4>
<p>iximeow edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420503495" title="https://github.com/bytecodealliance/wasmtime/pull/1620#discussion_r420503495">PR Review Comment</a>.</p>



<a name="196859704"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196859704" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196859704">(May 08 2020 at 05:42)</a>:</h4>
<p>whitequark updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1620" title="https://github.com/bytecodealliance/wasmtime/pull/1620">PR #1620</a> from <code>x86_32-mvp</code> to <code>master</code>:</p>
<blockquote>
<p>This PR, together with #1612, #1615 and #1616 makes it possible to run simple WASI binaries on x86_32 Linux. There are some caveats:</p>
<p>* Because of the approach taken in #1612, it is necessary to always use <code>--enable-simd</code>.<br>
  * There are still some issues in the 32-bit legalizer that prevent complex applications from running.<br>
  * Debug information is not generated.</p>
<p>Other than that it should be fully functional, or at least I don't see anything obviously broken.</p>
</blockquote>



<a name="196984541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196984541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196984541">(May 09 2020 at 10:26)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-408638063" title="https://github.com/bytecodealliance/wasmtime/pull/1620#pullrequestreview-408638063">PR Review</a>.</p>



<a name="196984549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231620%20Implement%20basic%20support%20for%20the%20Linux.../near/196984549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231620.20Implement.20basic.20support.20for.20the.20Linux.2E.2E.2E.html#196984549">(May 09 2020 at 10:27)</a>:</h4>
<p>iximeow merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1620" title="https://github.com/bytecodealliance/wasmtime/pull/1620">PR #1620</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>