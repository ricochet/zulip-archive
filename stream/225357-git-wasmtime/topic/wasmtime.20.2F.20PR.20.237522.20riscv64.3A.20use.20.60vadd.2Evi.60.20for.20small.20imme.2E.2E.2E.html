<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7522 riscv64: use `vadd.vi` for small imme... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html">wasmtime / PR #7522 riscv64: use `vadd.vi` for small imme...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="401277127"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401277127" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401277127">(Nov 10 2023 at 03:01)</a>:</h4>
<p><strong>pyroMechanical</strong> requested <a href="https://github.com/elliottt">elliottt</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7522">PR #7522</a>.</p>



<a name="401277128"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401277128" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401277128">(Nov 10 2023 at 03:01)</a>:</h4>
<p>pyroMechanical opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7522">PR #7522</a> from <code>pyroMechanical:main</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>this PR implements the change requested in #7481. Since riscv64 doesn't have a <code>vsub.vi</code> instruction, this optimization removes a load when the immediate fits in an Imm5.</p>
</blockquote>



<a name="401277129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401277129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401277129">(Nov 10 2023 at 03:01)</a>:</h4>
<p><strong>pyroMechanical</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7522">PR #7522</a>.</p>



<a name="401303882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401303882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401303882">(Nov 10 2023 at 07:54)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7522#pullrequestreview-1724201157">PR review</a>:</p>
<blockquote>
<p>This looks good to me! @afonso360, would you mind taking a look as well?</p>
</blockquote>



<a name="401303883"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401303883" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401303883">(Nov 10 2023 at 07:54)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7522#pullrequestreview-1724201157">PR review</a>:</p>
<blockquote>
<p>This looks good to me! @afonso360, would you mind taking a look as well?</p>
</blockquote>



<a name="401303884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401303884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401303884">(Nov 10 2023 at 07:54)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7522#discussion_r1389031316">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>;; Like imm5_from_value, but first negates the `Value`.
(decl pure partial imm5_from_negated_value (Value) Imm5)
(rule (imm5_from_negated_value (has_type ty (iconst n)))
  (if-let (imm5_from_i64 imm) (i64_neg (i64_sextend_imm64 ty n)))
  imm)
</code></pre></div><br>
</p>
</blockquote>



<a name="401355625"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/401355625" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#401355625">(Nov 10 2023 at 11:43)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7522#pullrequestreview-1724608624">PR review</a>:</p>
<blockquote>
<p>This looks great! Thanks! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> </p>
</blockquote>



<a name="403795675"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/403795675" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#403795675">(Nov 23 2023 at 14:07)</a>:</h4>
<p>afonso360 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7522">PR #7522</a>.</p>



<a name="403795713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/403795713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#403795713">(Nov 23 2023 at 14:07)</a>:</h4>
<p>afonso360 has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/7522">PR #7522</a>.</p>



<a name="403805348"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237522%20riscv64%3A%20use%20%60vadd.vi%60%20for%20small%20imme.../near/403805348" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237522.20riscv64.3A.20use.20.60vadd.2Evi.60.20for.20small.20imme.2E.2E.2E.html#403805348">(Nov 23 2023 at 14:58)</a>:</h4>
<p>afonso360 merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7522">PR #7522</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>