<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2376 AArch64 SIMD: replace `LoadSplat` wit... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html">wasmtime / PR #2376 AArch64 SIMD: replace `LoadSplat` wit...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="215920522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215920522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215920522">(Nov 07 2020 at 00:24)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/julian-seward1">julian-seward1</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a>.</p>



<a name="215920523"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215920523" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215920523">(Nov 07 2020 at 00:24)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="215920574"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215920574" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215920574">(Nov 07 2020 at 00:25)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="215977825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215977825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215977825">(Nov 07 2020 at 23:05)</a>:</h4>
<p>akirilov-arm submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-525687781">PR Review</a>.</p>



<a name="215977826"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215977826" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215977826">(Nov 07 2020 at 23:05)</a>:</h4>
<p>akirilov-arm created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r519226866">PR Review Comment</a>:</p>
<blockquote>
<p>Shouldn't we keep these helpers in <code>lower.rs</code>? I thought that <code>lower_inst.rs</code> was created to contain just the big functions <code>lower_insn_to_regs()</code> and <code>lower_branch()</code>.</p>
</blockquote>



<a name="215977827"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215977827" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215977827">(Nov 07 2020 at 23:05)</a>:</h4>
<p>akirilov-arm created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r519230309">PR Review Comment</a>:</p>
<blockquote>
<p>I just had a quick look at #2366, so I might be missing something, but the description says:<br>
<code>This can only be done to an instruction with no uses of its result register(s), because it will cause the instruction not to be codegen'd at its original location.</code><br>
(I guess the meaning is that there are no uses of its result except the instruction it has been merged into)<br>
It is not clear to me how we ensure that here; at the very least shouldn't there be a test case where the result of a load is used both by a splat and by another operation?</p>
</blockquote>



<a name="215977828"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215977828" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215977828">(Nov 07 2020 at 23:05)</a>:</h4>
<p>akirilov-arm submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-525687781">PR Review</a>.</p>



<a name="215979580"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215979580" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215979580">(Nov 07 2020 at 23:53)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-525693556">PR Review</a>.</p>



<a name="215979581"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/215979581" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#215979581">(Nov 07 2020 at 23:53)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r519235825">PR Review Comment</a>:</p>
<blockquote>
<p>Indeed, no other uses than the one by the input merging the op (I'll clarify that, and add a test for the multi-use case).</p>
<p>The condition is ensured by the logic in <code>maybe_get_input_as_source_or_const()</code>: it will return <code>None</code> as the <code>inst</code> field in the returned <code>LowerInput</code> if any of the conditions for code motion are not satisfied. So, things just transparently work in the pattern-matching: we won't see any source op at all if we aren't allowed to merge it.</p>
</blockquote>



<a name="216113688"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216113688" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216113688">(Nov 09 2020 at 17:05)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-526467553">PR Review</a>.</p>



<a name="216113689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216113689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216113689">(Nov 09 2020 at 17:05)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r519974090">PR Review Comment</a>:</p>
<blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> for fewer CLIF instructions!</p>
</blockquote>



<a name="216113843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216113843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216113843">(Nov 09 2020 at 17:06)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-526468655">PR Review</a>.</p>



<a name="216113844"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216113844" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216113844">(Nov 09 2020 at 17:06)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r519974947">PR Review Comment</a>:</p>
<blockquote>
<p>So a separate PR will do the same for x64?</p>
</blockquote>



<a name="216118191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216118191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216118191">(Nov 09 2020 at 17:38)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-526495822">PR Review</a>.</p>



<a name="216118193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216118193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216118193">(Nov 09 2020 at 17:38)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r519996242">PR Review Comment</a>:</p>
<blockquote>
<p>Indeed, that's my plan for today :-)</p>
</blockquote>



<a name="216125176"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216125176" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216125176">(Nov 09 2020 at 18:30)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216125255"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216125255" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216125255">(Nov 09 2020 at 18:31)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-526537322">PR Review</a>.</p>



<a name="216125256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216125256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216125256">(Nov 09 2020 at 18:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#discussion_r520028260">PR Review Comment</a>:</p>
<blockquote>
<p>Yes, good point, we've gotten a bit sloppy about this -- moved the added helpers as well as the one above this code.</p>
</blockquote>



<a name="216125845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216125845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216125845">(Nov 09 2020 at 18:35)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216126129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216126129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216126129">(Nov 09 2020 at 18:37)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216165249"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216165249" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216165249">(Nov 10 2020 at 01:56)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216264072"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216264072" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216264072">(Nov 10 2020 at 19:45)</a>:</h4>
<p>akirilov-arm submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-527550791">PR Review</a>.</p>



<a name="216297200"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216297200" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216297200">(Nov 11 2020 at 01:18)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216298188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216298188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216298188">(Nov 11 2020 at 01:35)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216948566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216948566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216948566">(Nov 16 2020 at 23:40)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="216949969"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/216949969" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#216949969">(Nov 16 2020 at 23:59)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a> from <code>loadsplat</code> to <code>main</code>:</p>
<blockquote>
<p>This PR uses the isel changes introduced in #2366 that allows loads to sink and merge with other operations in order to replace the <code>LoadSplat</code> instruction with more general pattern-matching.</p>
<p><code>LoadSplat</code> was added as an incremental step to improve AArch64 code quality in #2278. At the time, we did not have a way to pattern-match the load + splat opcode sequence that the relevant Wasm opcodes lowered to. However, now with PR #2366, we can merge effectful instructions such as loads into other ops, and so we can do this pattern matching directly.</p>
<p>PR includes commit from #2366 to allow simultaneous review/CI.</p>
<p>cc @julian-seward1 @akirilov-arm @abrown</p>
</blockquote>



<a name="217006666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/217006666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#217006666">(Nov 17 2020 at 14:12)</a>:</h4>
<p>julian-seward1 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2376#pullrequestreview-532400966">PR Review</a>.</p>



<a name="217022289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232376%20AArch64%20SIMD%3A%20replace%20%60LoadSplat%60%20wit.../near/217022289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232376.20AArch64.20SIMD.3A.20replace.20.60LoadSplat.60.20wit.2E.2E.2E.html#217022289">(Nov 17 2020 at 16:03)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2376">PR #2376</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>