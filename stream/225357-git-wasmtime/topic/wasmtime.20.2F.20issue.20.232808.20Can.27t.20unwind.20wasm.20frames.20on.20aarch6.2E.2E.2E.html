<html>
<head><meta charset="utf-8"><title>wasmtime / issue #2808 Can&#x27;t unwind wasm frames on aarch6... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html">wasmtime / issue #2808 Can&#x27;t unwind wasm frames on aarch6...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="291833871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/291833871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#291833871">(Aug 03 2022 at 11:19)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1203814109">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>@bnjbvr @cfallin @fitzgen Is this issue still relevant? It affects the tests in <code>tests/all/traps.rs</code> in particular.</p>
</blockquote>



<a name="291875994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/291875994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#291875994">(Aug 03 2022 at 16:30)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1204197649">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>This is probably still relevant for when we emit unwind info, which is a configuration we still want to support to integrate with external tools like GDB/profilers/etc, but it is no longer an issue that is critical for correctness (e.g. reclaiming GC garbage).</p>
</blockquote>



<a name="292006685"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/292006685" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#292006685">(Aug 04 2022 at 13:25)</a>:</h4>
<p>bnjbvr <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1205255300">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>This is also used to compute backtraces, right? I'll note to try it again on my side.</p>
</blockquote>



<a name="292040653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/292040653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#292040653">(Aug 04 2022 at 17:10)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1205537990">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>Backtraces are now captured by walking frame pointers since <a href="https://github.com/bytecodealliance/wasmtime/pull/4431">https://github.com/bytecodealliance/wasmtime/pull/4431</a></p>
</blockquote>



<a name="292939565"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/292939565" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#292939565">(Aug 11 2022 at 14:24)</a>:</h4>
<p>bnjbvr <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1212060039">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>Very sweet! I've just retried on my mac m1, and indeed these tests now pass after uncommenting the cfg_attr (I'll submit a PR), and in our embedding I can see a full stack trace \o/<br>
Thanks @fitzgen for working on this!</p>
</blockquote>



<a name="294915585"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/294915585" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#294915585">(Aug 23 2022 at 17:35)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1224426143">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>FYI recently I did a little investigation for my back-edge CFI work, and the only remaining user I could find of the <code>backtrace</code> crate, and by extension the system unwinder, is the <code>wasmtime-fiber</code> crate. In fact, that is just a test dependency, and, more precisely, only <a href="https://github.com/bytecodealliance/wasmtime/blob/3b68d769051adc4fecf7987b044dd1a8ad501c44/crates/fiber/src/lib.rs#L220">one test</a> needs it - <code>backtrace_traces_to_host</code>.</p>
<p>Of course, there is still the issue about integrating with external tools such as debuggers.</p>
</blockquote>



<a name="294917670"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/294917670" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#294917670">(Aug 23 2022 at 17:48)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1224456510">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<blockquote>
<p>the only remaining user I could find of the <code>backtrace</code> crate, and by extension the system unwinder, is the <code>wasmtime-fiber</code> crate. In fact, that is just a test dependency, and, more precisely, only <a href="https://github.com/bytecodealliance/wasmtime/blob/3b68d769051adc4fecf7987b044dd1a8ad501c44/crates/fiber/src/lib.rs#L220">one test</a> needs it - <code>backtrace_traces_to_host</code>.</p>
</blockquote>
<p>FWIW, I think this is 100% okay. We shouldn't be concerned about dev deps in the same way we are about regular deps.</p>
<blockquote>
<p>Of course, there is still the issue about integrating with external tools such as debuggers.</p>
</blockquote>
<p>We do still emit native unwind info by default, but also have a <code>wasmtime::Config</code> knob to turn it off should an embedder choose to.</p>
</blockquote>



<a name="294917868"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/294917868" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#294917868">(Aug 23 2022 at 17:50)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1224460543">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>Can we close this issue now? @bnjbvr I can't remember: did you submit the PR you mentioned you'd make in <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1212060039">https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1212060039</a>? I don't see any <code>cfg_attr</code> in <code>tests/all/traps.rs</code> anymore so I assume so.</p>
</blockquote>



<a name="294935017"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232808%20Can%27t%20unwind%20wasm%20frames%20on%20aarch6.../near/294935017" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232808.20Can.27t.20unwind.20wasm.20frames.20on.20aarch6.2E.2E.2E.html#294935017">(Aug 23 2022 at 19:40)</a>:</h4>
<p>bnjbvr <a href="https://github.com/bytecodealliance/wasmtime/issues/2808#issuecomment-1224724544">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2808">issue #2808</a>:</p>
<blockquote>
<p>Yep, I did submit this PR, so we could consider this closed. I didn't link this issue in the PR because the native unwinders would still require this to work properly, but maybe that can be deferred to a future issue.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>