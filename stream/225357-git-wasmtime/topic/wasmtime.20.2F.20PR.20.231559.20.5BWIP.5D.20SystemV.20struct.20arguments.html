<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1559 [WIP] SystemV struct arguments · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html">wasmtime / PR #1559 [WIP] SystemV struct arguments</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="194690415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/194690415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#194690415">(Apr 20 2020 at 15:22)</a>:</h4>
<p>bjorn3 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1559" title="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>master</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297" title="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="194829658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/194829658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#194829658">(Apr 21 2020 at 16:43)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1559#pullrequestreview-397475077" title="https://github.com/bytecodealliance/wasmtime/pull/1559#pullrequestreview-397475077">PR Review</a>.</p>



<a name="194829861"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/194829861" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#194829861">(Apr 21 2020 at 16:44)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1559#discussion_r412310014" title="https://github.com/bytecodealliance/wasmtime/pull/1559#discussion_r412310014">PR Review Comment</a>:</p>
<blockquote>
<p>For <code>sarg</code> this must always be done.</p>
</blockquote>



<a name="194951326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/194951326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#194951326">(Apr 22 2020 at 15:50)</a>:</h4>
<p>bjorn3 deleted <a href="https://github.com/bytecodealliance/wasmtime/pull/1559#discussion_r412310014" title="https://github.com/bytecodealliance/wasmtime/pull/1559#discussion_r412310014">PR Review Comment</a>.</p>



<a name="202009411"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202009411" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202009411">(Jun 25 2020 at 18:50)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202188640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202188640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202188640">(Jun 27 2020 at 14:33)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202191327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202191327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202191327">(Jun 27 2020 at 15:24)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202191396"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202191396" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202191396">(Jun 27 2020 at 15:26)</a>:</h4>
<p><strong>bjorn3</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> as ready for review.</p>



<a name="202191504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202191504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202191504">(Jun 27 2020 at 15:28)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202196576"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202196576" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202196576">(Jun 27 2020 at 17:34)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202196921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202196921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202196921">(Jun 27 2020 at 17:43)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202197154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202197154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202197154">(Jun 27 2020 at 17:49)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202200994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202200994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202200994">(Jun 27 2020 at 19:19)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202201256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202201256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202201256">(Jun 27 2020 at 19:25)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<a name="202202009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231559%20%5BWIP%5D%20SystemV%20struct%20arguments/near/202202009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231559.20.5BWIP.5D.20SystemV.20struct.20arguments.html#202202009">(Jun 27 2020 at 19:44)</a>:</h4>
<p>bjorn3 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1559">PR #1559</a> from <code>abi_struct_args</code> to <code>main</code>:</p>
<blockquote>
<p>According to the SystemV abi, struct arguments must be passed at a fixed stack offset. Cranelift didn't have any way to implement this before. This is necessary to compile proc-macros using cg_clif: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297">https://github.com/bjorn3/rustc_codegen_cranelift/issues/905#issuecomment-616173297</a></p>
<p>Fixes #1108</p>
<h1>TODO</h1>
<ul>
<li>[ ] Don't misuse <code>INVALID</code>, but introduce a proper type.</li>
<li>[ ] Implement this correctly for WindowsFastcall or give an error.</li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>