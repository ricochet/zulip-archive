<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2108 Caller get_export() implemented for E... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html">wasmtime / PR #2108 Caller get_export() implemented for E...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="206167022"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206167022" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206167022">(Aug 06 2020 at 16:51)</a>:</h4>
<p>agiachris opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2108">PR #2108</a> from <code>main</code> to <code>main</code>:</p>
<blockquote>
<p>To my knowledge, this has not been discussed in an issue. However, comments in the overwritten code make clear that the get_export() function is only currently implemented for Extern::Memory, with potential future support for Extern::Func - which is the update of this PR. This update simply enables user to lookup and return Extern::Func types from Caller structure.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[x] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[x] This PR contains test cases, if meaningful.</p>
</li>
<li>[x] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="206170202"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206170202" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206170202">(Aug 06 2020 at 17:16)</a>:</h4>
<p>PiotrSikora submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#pullrequestreview-462702501">PR Review</a>.</p>



<a name="206170203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206170203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206170203">(Aug 06 2020 at 17:16)</a>:</h4>
<p>PiotrSikora created <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#discussion_r466553228">PR Review Comment</a>:</p>
<blockquote>
<p>Style: <code>s/return Some(Extern::Func(func));/Some(Extern::Func(func))/</code> (i.e. no <code>return</code>, no <code>;</code>).</p>
</blockquote>



<a name="206170204"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206170204" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206170204">(Aug 06 2020 at 17:16)</a>:</h4>
<p>PiotrSikora created <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#discussion_r466553035">PR Review Comment</a>:</p>
<blockquote>
<p>Style: <code>s/return Some(Extern::Memory(mem));/Some(Extern::Memory(mem))/</code> (i.e. no <code>return</code>, no <code>;</code>).</p>
</blockquote>



<a name="206170205"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206170205" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206170205">(Aug 06 2020 at 17:16)</a>:</h4>
<p>PiotrSikora submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#pullrequestreview-462702501">PR Review</a>.</p>



<a name="206170206"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206170206" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206170206">(Aug 06 2020 at 17:16)</a>:</h4>
<p>PiotrSikora created <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#discussion_r466556446">PR Review Comment</a>:</p>
<blockquote>
<p>Style: <code>s/return None,/None,/</code> (i.e. no <code>return</code>).</p>
</blockquote>



<a name="206173701"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206173701" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206173701">(Aug 06 2020 at 17:45)</a>:</h4>
<p>agiachris updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2108">PR #2108</a> from <code>main</code> to <code>main</code>:</p>
<blockquote>
<p>To my knowledge, this has not been discussed in an issue. However, comments in the overwritten code make clear that the get_export() function is only currently implemented for Extern::Memory, with potential future support for Extern::Func - which is the update of this PR. This update simply enables user to lookup and return Extern::Func types from Caller structure.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[x] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[x] This PR contains test cases, if meaningful.</p>
</li>
<li>[x] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="206178289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206178289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206178289">(Aug 06 2020 at 18:22)</a>:</h4>
<p>PiotrSikora submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#pullrequestreview-462769739">PR Review</a>.</p>



<a name="206270559"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206270559" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206270559">(Aug 07 2020 at 15:23)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#pullrequestreview-463398336">PR Review</a>.</p>



<a name="206270560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206270560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206270560">(Aug 07 2020 at 15:23)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#pullrequestreview-463398336">PR Review</a>.</p>



<a name="206270561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206270561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206270561">(Aug 07 2020 at 15:23)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#discussion_r467106690">PR Review Comment</a>:</p>
<blockquote>
<p>Could this be refactored a bit to avoid duplicating the <code>let handle = ...</code>?</p>
<p>Something like:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instance</span><span class="p">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">?</span>:
<span class="nc">let</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">..</span><span class="p">.;</span><span class="w"></span>
<span class="nb">Some</span><span class="p">(</span><span class="k">match</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Export</span>::<span class="n">Memory</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Export</span>::<span class="n">Memory</span><span class="p">(</span><span class="n">Memory</span>::<span class="n">from_wasmtime_memory</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">handle</span><span class="p">)),</span><span class="w"></span>
<span class="w">    </span><span class="n">Export</span>::<span class="n">Function</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="cm">/* ... */</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">None</span><span class="p">,</span><span class="w"></span>
<span class="p">})</span><span class="w"></span>
<span class="o">~~~</span><span class="w"></span>
</code></pre></div>


</blockquote>



<a name="206270562"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206270562" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206270562">(Aug 07 2020 at 15:23)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#discussion_r467108686">PR Review Comment</a>:</p>
<blockquote>
<p>I think that the documentation on the <code>Caller</code> type itself needs to be updated to indicate it's more than just memory now, and this function can probably point to that documentation to guide about usages of the function.</p>
<p>On the <code>Caller</code> struct itself I think it can be updated to something like:</p>
<blockquote>
<p>This structure can be taken as the first parameter of a closure passed to<br>
[<code>Func::wrap</code>], and it can be used to learn information about the caller of<br>
the function, such as the calling module's memory, exports, etc.</p>
<p>The primary purpose of this structure is to provide access to the<br>
caller's information, namely it's exported memory and exported functions. This<br>
allows functions which take pointers as arguments to easily read the memory the<br>
pointers point into, or if a function is expected to call <code>malloc</code> in the wasm<br>
module to reserve space for the output you can do that.</p>
<p>Note that this <code>Caller</code> type a pretty temporary mechanism for accessing the<br>
caller's information until interface types has been fully standardized and<br>
implemented. The interface types proposal will obsolete this type and this will<br>
be removed in the future at some point after interface types is implemented. If<br>
you're relying on this <code>Caller</code> type it's recommended to become familiar with<br>
interface types to ensure that your use case is covered by the proposal.</p>
</blockquote>
</blockquote>



<a name="206270887"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206270887" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206270887">(Aug 07 2020 at 15:26)</a>:</h4>
<p>agiachris submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#pullrequestreview-463402905">PR Review</a>.</p>



<a name="206270888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206270888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206270888">(Aug 07 2020 at 15:26)</a>:</h4>
<p>agiachris created <a href="https://github.com/bytecodealliance/wasmtime/pull/2108#discussion_r467110364">PR Review Comment</a>:</p>
<blockquote>
<p>Great, will make these updates. Thank you!</p>
</blockquote>



<a name="206273118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206273118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206273118">(Aug 07 2020 at 15:44)</a>:</h4>
<p>agiachris updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2108">PR #2108</a> from <code>main</code> to <code>main</code>:</p>
<blockquote>
<p>To my knowledge, this has not been discussed in an issue. However, comments in the overwritten code make clear that the get_export() function is only currently implemented for Extern::Memory, with potential future support for Extern::Func - which is the update of this PR. This update simply enables user to lookup and return Extern::Func types from Caller structure.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[x] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[x] This PR contains test cases, if meaningful.</p>
</li>
<li>[x] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="206277955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232108%20Caller%20get_export%28%29%20implemented%20for%20E.../near/206277955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232108.20Caller.20get_export.28.29.20implemented.20for.20E.2E.2E.2E.html#206277955">(Aug 07 2020 at 16:24)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2108">PR #2108</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>