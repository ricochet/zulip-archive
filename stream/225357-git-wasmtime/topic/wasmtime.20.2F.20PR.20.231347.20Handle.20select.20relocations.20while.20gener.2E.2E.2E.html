<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1347 Handle select relocations while gener... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231347.20Handle.20select.20relocations.20while.20gener.2E.2E.2E.html">wasmtime / PR #1347 Handle select relocations while gener...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="190902488"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231347%20Handle%20select%20relocations%20while%20gener.../near/190902488" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231347.20Handle.20select.20relocations.20while.20gener.2E.2E.2E.html#190902488">(Mar 17 2020 at 19:55)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1347" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1347">PR #1347</a> from <code>fix-trampoline-relocations</code> to <code>master</code>:</p>
<blockquote>
<p>Trampoline generation for all function signatures exposed a preexisting<br>
bug in wasmtime where trampoline generation occasionally does have<br>
relocations, but it's asserted that trampolines don't generate<br>
relocations, causing a panic. The relocation is currently primarily the<br>
probestack function which happens when functions might have a huge<br>
number of parameters, but not so huge as to blow the wasmparser limit of<br>
how many parameters are allowed.</p>
<p>This commit fixes the issue by handling relocations for trampolines in<br>
the same manner as the rest of the code. Note that dynamically-generated<br>
trampolines via the <code>Func</code> API still panic if they have too many<br>
arguments and generate a relocation, but it seems like we can try to fix<br>
that later if the need truly arises.</p>
<p>Closes #1322</p>
</blockquote>



<a name="190909125"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231347%20Handle%20select%20relocations%20while%20gener.../near/190909125" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231347.20Handle.20select.20relocations.20while.20gener.2E.2E.2E.html#190909125">(Mar 17 2020 at 20:51)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1347#pullrequestreview-376395983" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1347#pullrequestreview-376395983">PR Review</a>.</p>



<a name="190910236"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231347%20Handle%20select%20relocations%20while%20gener.../near/190910236" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231347.20Handle.20select.20relocations.20while.20gener.2E.2E.2E.html#190910236">(Mar 17 2020 at 21:01)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1347" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1347">PR #1347</a> from <code>fix-trampoline-relocations</code> to <code>master</code>:</p>
<blockquote>
<p>Trampoline generation for all function signatures exposed a preexisting<br>
bug in wasmtime where trampoline generation occasionally does have<br>
relocations, but it's asserted that trampolines don't generate<br>
relocations, causing a panic. The relocation is currently primarily the<br>
probestack function which happens when functions might have a huge<br>
number of parameters, but not so huge as to blow the wasmparser limit of<br>
how many parameters are allowed.</p>
<p>This commit fixes the issue by handling relocations for trampolines in<br>
the same manner as the rest of the code. Note that dynamically-generated<br>
trampolines via the <code>Func</code> API still panic if they have too many<br>
arguments and generate a relocation, but it seems like we can try to fix<br>
that later if the need truly arises.</p>
<p>Closes #1322</p>
</blockquote>



<a name="190913290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231347%20Handle%20select%20relocations%20while%20gener.../near/190913290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231347.20Handle.20select.20relocations.20while.20gener.2E.2E.2E.html#190913290">(Mar 17 2020 at 21:30)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1347" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1347">PR #1347</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>