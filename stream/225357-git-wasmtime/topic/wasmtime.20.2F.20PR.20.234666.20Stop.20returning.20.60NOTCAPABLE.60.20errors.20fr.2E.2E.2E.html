<html>
<head><meta charset="utf-8"><title>wasmtime / PR #4666 Stop returning `NOTCAPABLE` errors fr... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html">wasmtime / PR #4666 Stop returning `NOTCAPABLE` errors fr...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="292650660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292650660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292650660">(Aug 09 2022 at 20:17)</a>:</h4>
<p>sunfishcode opened <a href="https://github.com/bytecodealliance/wasmtime/pull/4666">PR #4666</a> from <code>stop-using-notcapable</code> to <code>main</code>:</p>
<blockquote>
<p><code>ENOTCAPABLE</code> was an error code that is used as part of the rights<br>
system, from CloudABI. There is a set of flags associated with each file<br>
descriptor listing which operations can be performed with the file<br>
descriptor, and if an attempt is made to perform an operation with a<br>
file descriptor that isn't permitted by its rights flags, it fails with<br>
<code>ENOTCAPABLE</code>.</p>
<p>WASI is removing the rights system. For example, <a href="https://github.com/WebAssembly/wasi-libc/issues/294">WebAssembly/wasi-libc#294</a><br>
removed support for translating <code>ENOTCAPABLE</code> into POSIX error codes, on<br>
the assumption that engines should stop using it.</p>
<p>So as another step to migrating away from the rights system, remove uses<br>
of the <code>ENOTCAPABLE</code> error.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="292672554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292672554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292672554">(Aug 09 2022 at 23:17)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4666">PR #4666</a> from <code>stop-using-notcapable</code> to <code>main</code>.</p>



<a name="292814288"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292814288" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292814288">(Aug 10 2022 at 18:59)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4666#pullrequestreview-1068779527">PR review</a>.</p>



<a name="292814289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292814289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292814289">(Aug 10 2022 at 18:59)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/4666#pullrequestreview-1068779527">PR review</a>.</p>



<a name="292814290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292814290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292814290">(Aug 10 2022 at 18:59)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/4666#discussion_r942798723">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>            let err = if missing.intersects(DirCaps::READDIR) {
                Error::not_dir()
            } else {
                Error::perm()
            };
            Err(err.context(format!("desired rights {:?}, has {:?}", caps, self.caps)))
</code></pre></div><br>
</p>
</blockquote>



<a name="292814291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292814291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292814291">(Aug 10 2022 at 18:59)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/4666#discussion_r942798116">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>            let err = if missing.intersects(FileCaps::READ | FileCaps::WRITE) {
                // `EBADF` is a little surprising here because it's also used
                // for unknown-file-descriptor errors, but it's what POSIX uses
                // in this situation.
                Error::badf()
            } else {
                Error::perm()
            };
            Err(err.context(format!("desired rights {:?}, has {:?}", caps, self.caps)))
</code></pre></div><br>
</p>
</blockquote>



<a name="292814585"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292814585" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292814585">(Aug 10 2022 at 19:01)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4666">PR #4666</a> from <code>stop-using-notcapable</code> to <code>main</code>.</p>



<a name="292814610"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292814610" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292814610">(Aug 10 2022 at 19:01)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/4666">PR #4666</a> from <code>stop-using-notcapable</code> to <code>main</code>.</p>



<a name="292829905"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234666%20Stop%20returning%20%60NOTCAPABLE%60%20errors%20fr.../near/292829905" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234666.20Stop.20returning.20.60NOTCAPABLE.60.20errors.20fr.2E.2E.2E.html#292829905">(Aug 10 2022 at 20:44)</a>:</h4>
<p>sunfishcode merged <a href="https://github.com/bytecodealliance/wasmtime/pull/4666">PR #4666</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>