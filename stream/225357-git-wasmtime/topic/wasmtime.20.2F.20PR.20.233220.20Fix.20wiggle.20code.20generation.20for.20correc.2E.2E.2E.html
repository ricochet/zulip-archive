<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3220 Fix wiggle code generation for correc... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html">wasmtime / PR #3220 Fix wiggle code generation for correc...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="250127689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250127689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250127689">(Aug 20 2021 at 14:50)</a>:</h4>
<p>mgattozzi opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3220">PR #3220</a> from <code>mgattozzi/a-fix-that-spans-awaits</code> to <code>main</code>:</p>
<blockquote>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.<br>
  This was an issue that @pchickey stumbled on internally at work when testing<br>
  out some things and I was asked to take a look at it and figure out what was going on</p>
</li>
<li>
<p>[X] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
<p>Fixes incorrect behavior with spans generated by wiggle in asynchronous code.</p>
</li>
<li>
<p>[X] This PR contains test cases, if meaningful.</p>
<p>N/A but have confirmed in internal testing that this does indeed fix the issue and doesn't break<br>
functionality, just changes the function signatures.</p>
</li>
<li>
<p>[X] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</p>
<p>@pchickey asked for me to tag him for review when I put this PR up.</p>
</li>
</ul>
<h2>Commit Message Follows:</h2>
<p>Up to this point when using wiggle to generate functions we could end up<br>
with two types of functions an async or sync one with this proc macro</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">  </span><span class="cp">#[allow(unreachable_code)]</span><span class="w"> </span><span class="c1">// deals with warnings in noreturn functions</span>
<span class="w">  </span><span class="k">pub</span><span class="w"> </span>#<span class="n">asyncness</span><span class="w"> </span><span class="k">fn</span> #<span class="n">ident</span><span class="p">(</span><span class="w"></span>
<span class="w">      </span><span class="n">ctx</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="p">(</span><span class="k">impl</span><span class="w"> </span>#<span class="p">(</span>#<span class="n">bounds</span><span class="p">)</span><span class="o">+*</span><span class="p">),</span><span class="w"></span>
<span class="w">      </span><span class="n">memory</span>: <span class="kp">&amp;</span><span class="nc">dyn</span><span class="w"> </span>#<span class="n">rt</span>::<span class="n">GuestMemory</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span>#<span class="p">(</span>#<span class="n">abi_params</span><span class="p">),</span><span class="o">*</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span>#<span class="n">abi_ret</span><span class="p">,</span><span class="w"> </span>#<span class="n">rt</span>::<span class="n">Trap</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">convert</span>::<span class="n">TryFrom</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">_span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>#<span class="n">rt</span>::<span class="n">tracing</span>::<span class="n">span</span><span class="o">!</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span>#<span class="n">rt</span>::<span class="n">tracing</span>::<span class="n">Level</span>::<span class="n">TRACE</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s">"wiggle abi"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>#<span class="n">mod_name</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>#<span class="n">func_name</span><span class="w"></span>
<span class="w">      </span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">_enter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_span</span><span class="p">.</span><span class="n">enter</span><span class="p">();</span><span class="w"></span>

<span class="w">      </span>#<span class="n">body</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Now this might seem fine, we just create a span and enter it and run the<br>
body code and we get async versions as well. However, this is where the<br>
source of our problem lies. The impetus for this fix was seeing multiple<br>
request IDs output in the logs for a single function call of a generated<br>
function. Something was clearly happening that shouldn't have been. If<br>
we take a look at the tracing docs here we can see why the above code<br>
will not work in asynchronous code.</p>
<p><a href="https://docs.rs/tracing/0.1.26/tracing/span/struct.Span.html#in-asynchronous-code">https://docs.rs/tracing/0.1.26/tracing/span/struct.Span.html#in-asynchronous-code</a></p>
<blockquote>
<p>Warning: in asynchronous code that uses async/await syntax,<br>
Span::enter should be used very carefully or avoided entirely.<br>
Holding the drop guard returned by Span::enter across .await points<br>
will result in incorrect traces.</p>
</blockquote>
<p>The above documentation provides some more information, but what could<br>
happen is that the <code>#body</code> itself could contain code that would await<br>
and mess up the tracing that occurred and causing output that would be<br>
completely nonsensical. The code itself should work fine in the<br>
synchronous case though and in cases where await was not called again<br>
inside the body as the future would poll to completion as if it was a<br>
synchronous function.</p>
<p>The solution then is to use the newer <code>Instrument</code> trait which can make<br>
sure that the span will be entered on every poll of the future. In order<br>
to make sure that we have the same behavior as before we generate<br>
synchronous functions and the ones that were async instead return a<br>
future that uses the instrument trait. This way we can guarantee that<br>
the span is created in synchronous code before being passed into a<br>
future. This does change the function signature, but the functionality<br>
itself is exactly as before and so we should see no actual difference in<br>
how it's used by others. We also just to be safe call the synchronous<br>
version's body with <code>in_scope</code> now as per the docs recommendation even<br>
though it's more intended for calling sync code inside async functions.<br>
Functionally it's the same as before with the call to enter. We also<br>
bump the version of tracing uses so that wiggle can reexport tracing<br>
with the instrument changes.</p>
</blockquote>



<a name="250127704"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250127704" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250127704">(Aug 20 2021 at 14:50)</a>:</h4>
<p>mgattozzi edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3220">PR #3220</a> from <code>mgattozzi/a-fix-that-spans-awaits</code> to <code>main</code>:</p>
<blockquote>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.<br>
  This was an issue that @pchickey stumbled on internally at work when testing<br>
  out some things and I was asked to take a look at it and figure out what was going on</p>
</li>
<li>
<p>[X] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
<p>Fixes incorrect behavior with spans generated by wiggle in asynchronous code.</p>
</li>
<li>
<p>[X] This PR contains test cases, if meaningful.</p>
<p>N/A but have confirmed in internal testing that this does indeed fix the issue and doesn't break<br>
functionality, just changes the function signatures.</p>
</li>
<li>
<p>[X] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</p>
<p>@pchickey asked for me to tag him for review when I put this PR up.</p>
</li>
</ul>
<h2>Commit Message Follows:</h2>
<p>Up to this point when using wiggle to generate functions we could end up<br>
with two types of functions an async or sync one with this proc macro</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">  </span><span class="cp">#[allow(unreachable_code)]</span><span class="w"> </span><span class="c1">// deals with warnings in noreturn functions</span>
<span class="w">  </span><span class="k">pub</span><span class="w"> </span>#<span class="n">asyncness</span><span class="w"> </span><span class="k">fn</span> #<span class="n">ident</span><span class="p">(</span><span class="w"></span>
<span class="w">      </span><span class="n">ctx</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="p">(</span><span class="k">impl</span><span class="w"> </span>#<span class="p">(</span>#<span class="n">bounds</span><span class="p">)</span><span class="o">+*</span><span class="p">),</span><span class="w"></span>
<span class="w">      </span><span class="n">memory</span>: <span class="kp">&amp;</span><span class="nc">dyn</span><span class="w"> </span>#<span class="n">rt</span>::<span class="n">GuestMemory</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span>#<span class="p">(</span>#<span class="n">abi_params</span><span class="p">),</span><span class="o">*</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span>#<span class="n">abi_ret</span><span class="p">,</span><span class="w"> </span>#<span class="n">rt</span>::<span class="n">Trap</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">convert</span>::<span class="n">TryFrom</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">_</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">_span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>#<span class="n">rt</span>::<span class="n">tracing</span>::<span class="n">span</span><span class="o">!</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span>#<span class="n">rt</span>::<span class="n">tracing</span>::<span class="n">Level</span>::<span class="n">TRACE</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s">"wiggle abi"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>#<span class="n">mod_name</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>#<span class="n">func_name</span><span class="w"></span>
<span class="w">      </span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">_enter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_span</span><span class="p">.</span><span class="n">enter</span><span class="p">();</span><span class="w"></span>

<span class="w">      </span>#<span class="n">body</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Now this might seem fine, we just create a span and enter it and run the<br>
body code and we get async versions as well. However, this is where the<br>
source of our problem lies. The impetus for this fix was seeing multiple<br>
request IDs output in the logs for a single function call of a generated<br>
function. Something was clearly happening that shouldn't have been. If<br>
we take a look at the tracing docs here we can see why the above code<br>
will not work in asynchronous code.</p>
<p><a href="https://docs.rs/tracing/0.1.26/tracing/span/struct.Span.html#in-asynchronous-code">https://docs.rs/tracing/0.1.26/tracing/span/struct.Span.html#in-asynchronous-code</a></p>
<blockquote>
<p>Warning: in asynchronous code that uses async/await syntax,<br>
Span::enter should be used very carefully or avoided entirely.<br>
Holding the drop guard returned by Span::enter across .await points<br>
will result in incorrect traces.</p>
</blockquote>
<p>The above documentation provides some more information, but what could<br>
happen is that the <code>#body</code> itself could contain code that would await<br>
and mess up the tracing that occurred and causing output that would be<br>
completely nonsensical. The code itself should work fine in the<br>
synchronous case though and in cases where await was not called again<br>
inside the body as the future would poll to completion as if it was a<br>
synchronous function.</p>
<p>The solution then is to use the newer <code>Instrument</code> trait which can make<br>
sure that the span will be entered on every poll of the future. In order<br>
to make sure that we have the same behavior as before we generate<br>
synchronous functions and the ones that were async instead return a<br>
future that uses the instrument trait. This way we can guarantee that<br>
the span is created in synchronous code before being passed into a<br>
future. This does change the function signature, but the functionality<br>
itself is exactly as before and so we should see no actual difference in<br>
how it's used by others. We also just to be safe call the synchronous<br>
version's body with <code>in_scope</code> now as per the docs recommendation even<br>
though it's more intended for calling sync code inside async functions.<br>
Functionally it's the same as before with the call to enter. We also<br>
bump the version of tracing uses so that wiggle can reexport tracing<br>
with the instrument changes.</p>
</blockquote>



<a name="250130044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250130044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250130044">(Aug 20 2021 at 15:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#pullrequestreview-735126615">PR review</a>.</p>



<a name="250130045"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250130045" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250130045">(Aug 20 2021 at 15:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#pullrequestreview-735126615">PR review</a>.</p>



<a name="250130046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250130046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250130046">(Aug 20 2021 at 15:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#discussion_r693019662">PR review comment</a>:</p>
<blockquote>
<p>Since this call is somewhat nontrivial could this call to <code>span!</code> get pulled out of the two branches of this <code>if</code> and something like <code>let _span = #mk_span;</code> be used in both macros?</p>
</blockquote>



<a name="250130047"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250130047" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250130047">(Aug 20 2021 at 15:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#discussion_r693019352">PR review comment</a>:</p>
<blockquote>
<p>I think the indentation may be a bit off here and below? (to match the indentation above)</p>
</blockquote>



<a name="250132519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250132519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250132519">(Aug 20 2021 at 15:25)</a>:</h4>
<p>mgattozzi submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#pullrequestreview-735144888">PR review</a>.</p>



<a name="250132521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250132521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250132521">(Aug 20 2021 at 15:25)</a>:</h4>
<p>mgattozzi created <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#discussion_r693032758">PR review comment</a>:</p>
<blockquote>
<p>Yeah! I can do that <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>🏻 </p>
</blockquote>



<a name="250133213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250133213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250133213">(Aug 20 2021 at 15:30)</a>:</h4>
<p>mgattozzi updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3220">PR #3220</a> from <code>mgattozzi/a-fix-that-spans-awaits</code> to <code>main</code>.</p>



<a name="250133386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250133386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250133386">(Aug 20 2021 at 15:31)</a>:</h4>
<p>mgattozzi submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#pullrequestreview-735150453">PR review</a>.</p>



<a name="250133387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250133387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250133387">(Aug 20 2021 at 15:31)</a>:</h4>
<p>mgattozzi created <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#discussion_r693037061">PR review comment</a>:</p>
<blockquote>
<p>Yeah cargo fmt can't really handle things inside macros. I think I got it fixed up in the most recent commit as well.</p>
</blockquote>



<a name="250133822"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250133822" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250133822">(Aug 20 2021 at 15:34)</a>:</h4>
<p>mgattozzi updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3220">PR #3220</a> from <code>mgattozzi/a-fix-that-spans-awaits</code> to <code>main</code>.</p>



<a name="250135225"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250135225" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250135225">(Aug 20 2021 at 15:45)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3220#pullrequestreview-735162773">PR review</a>.</p>



<a name="250139790"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233220%20Fix%20wiggle%20code%20generation%20for%20correc.../near/250139790" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233220.20Fix.20wiggle.20code.20generation.20for.20correc.2E.2E.2E.html#250139790">(Aug 20 2021 at 16:20)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3220">PR #3220</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>