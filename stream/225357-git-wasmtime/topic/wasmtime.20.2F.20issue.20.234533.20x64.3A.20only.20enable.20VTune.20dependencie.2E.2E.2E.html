<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4533 x64: only enable VTune dependencie... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html">wasmtime / issue #4533 x64: only enable VTune dependencie...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="290946528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/290946528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#290946528">(Jul 26 2022 at 19:46)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1195908944">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<p>Could you double-check that this fixes at least the issue in #4523 (although I suspect more exist)</p>
</blockquote>



<a name="290948428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/290948428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#290948428">(Jul 26 2022 at 20:02)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1195922822">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<blockquote>
<p>Could you double-check that this fixes at least the issue in #4523 (although I suspect more exist)</p>
</blockquote>
<p>Like compile with <code>cargo build --target aarch64-linux-android</code> or something else?</p>
</blockquote>



<a name="290949035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/290949035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#290949035">(Jul 26 2022 at 20:06)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1195926729">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<p>Looks like something else is the problem now:</p>
<p><div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="gp">$ </span>cargo build --release --target aarch64-linux-android
<span class="go">...</span>

<span class="go">error: failed to run custom build command for `psm v0.1.18`</span>

<span class="go">Caused by:</span>
<span class="go">  process didn't exit successfully: `/home/abrown/Code/wasmtime/target/release/build/psm-d3851756418374a6/build-script-build` (exit status: 1)</span>
<span class="go">  --- stdout</span>
<span class="go">  OPT_LEVEL = Some("3")</span>
<span class="go">  TARGET = Some("aarch64-linux-android")</span>
<span class="go">  HOST = Some("x86_64-unknown-linux-gnu")</span>
<span class="go">  CC_aarch64-linux-android = None</span>
<span class="go">  CC_aarch64_linux_android = None</span>
<span class="go">  TARGET_CC = None</span>
<span class="go">  CC = None</span>
<span class="go">  CFLAGS_aarch64-linux-android = None</span>
<span class="go">  CFLAGS_aarch64_linux_android = None</span>
<span class="go">  TARGET_CFLAGS = None</span>
<span class="go">  CFLAGS = None</span>
<span class="go">  CRATE_CC_NO_DEFAULTS = None</span>
<span class="go">  DEBUG = Some("false")</span>
<span class="go">  cargo:rustc-cfg=asm</span>
<span class="go">  cargo:rustc-cfg=switchable_stack</span>
<span class="go">  running: "aarch64-linux-android-clang" "-O3" "-DANDROID" "-ffunction-sections" "-fdata-sections" "-fPIC" "-Wall" "-Wextra" "-xassembler-with-cpp" "-DCFG_TARGET_OS_android" "-DCFG_TARGET_ARCH_aarch64" "-DCFG_TARGET_ENV_" "-o" "/home/abrown/Code/wasmtime/target/aarch64-linux-android/release/build/psm-975239bbdf5842b2/out/src/arch/aarch_aapcs64.o" "-c" "src/arch/aarch_aapcs64.s"</span>

<span class="go">  --- stderr</span>


<span class="go">  error occurred: Failed to find tool. Is `aarch64-linux-android-clang` installed?</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="291039626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/291039626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#291039626">(Jul 27 2022 at 14:09)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1196812037">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<p>Could you perhaps set <code>AR=true CC=true</code> and see how far the build goes? Given the error you got it's unlikely you even reached compiling ittapi-rs</p>
</blockquote>



<a name="291057088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/291057088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#291057088">(Jul 27 2022 at 15:35)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1196919078">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<blockquote>
<p>Could you perhaps set <code>AR=true CC=true</code> and see how far the build goes? Given the error you got it's unlikely you even reached compiling ittapi-rs</p>
</blockquote>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="gp">$ </span><span class="nv">AR</span><span class="o">=</span><span class="nb">true</span> <span class="nv">CC</span><span class="o">=</span><span class="nb">true</span> cargo build --release --target aarch64-linux-android
<span class="go">...</span>
<span class="go">error: could not find native static library `psm_s`, perhaps an -L flag is missing?</span>

<span class="go">error: could not compile `psm` due to previous error</span>
</code></pre></div>
<p>And, yeah, I do not see <code>ittapi</code> being built in the compiled crates up above that error.</p>
</blockquote>



<a name="291059145"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/291059145" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#291059145">(Jul 27 2022 at 15:49)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1196937027">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<p>@gneworld, could you test out this branch to see if it resolves #4523 for you? I don't think I have the right system environment (toolchains, libraries, etc.) to check if indeed this commit will fix the build issue you found.</p>
</blockquote>



<a name="291168207"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/291168207" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#291168207">(Jul 28 2022 at 11:14)</a>:</h4>
<p>gneworld <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1198005012">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<blockquote>
<p>@gneworld, could you test out this branch to see if it resolves #4523 for you? I don't think I have the right system environment (toolchains, libraries, etc.) to check if indeed this commit will fix the build issue you found.</p>
</blockquote>
<p>Compiling wasmtime-jit v0.40.0 (/home/mi/ext/minacore_mi11/mina_jit_aot/wasmtime/crates/jit)<br>
error[E0433]: failed to resolve: use of undeclared crate or module <code>rustc_demangle</code><br>
 --&gt; crates/jit/src/demangling.rs:7:28<br>
  |<br>
7 |     if let Ok(demangled) = rustc_demangle::try_demangle(name) {<br>
  |                            ^^^^^^^^^^^^^^ use of undeclared crate or module <code>rustc_demangle</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>bincode</code><br>
   --&gt; crates/jit/src/instantiate.rs:270:5<br>
    |<br>
270 |     bincode::serialize_into(&amp;mut bytes, &amp;info)?;<br>
    |     ^^^^^^^ use of undeclared crate or module <code>bincode</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>bincode</code><br>
   --&gt; crates/jit/src/instantiate.rs:421:21<br>
    |<br>
421 |             None =&gt; bincode::deserialize(section(ELF_WASMTIME_INFO)?)<br>
    |                     ^^^^^^^ use of undeclared crate or module <code>bincode</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>cpp_demangle</code><br>
 --&gt; crates/jit/src/demangling.rs:9:49<br>
  |<br>
9 |     } else if let Ok(demangled) = cpp_demangle::Symbol::new(name) {<br>
  |                                                 ^^^^^^ not found in <code>cpp_demangle</code><br>
  |<br>
help: consider importing one of these items<br>
  |<br>
3 | use object::Symbol;<br>
  |<br>
3 | use object::write::Symbol;<br>
  |<br>
help: if you import <code>Symbol</code>, refer to it directly<br>
  |<br>
9 -     } else if let Ok(demangled) = cpp_demangle::Symbol::new(name) {<br>
9 +     } else if let Ok(demangled) = Symbol::new(name) {<br>
  | </p>
<p>For more information about this error, try <code>rustc --explain E0433</code>.<br>
error: could not compile <code>wasmtime-jit</code> due to 4 previous errors</p>
</blockquote>



<a name="291168292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/291168292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#291168292">(Jul 28 2022 at 11:15)</a>:</h4>
<p>gneworld edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1198005012">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<blockquote>
<p>@gneworld, could you test out this branch to see if it resolves #4523 for you? I don't think I have the right system environment (toolchains, libraries, etc.) to check if indeed this commit will fix the build issue you found.</p>
</blockquote>
<p>@abrown  unfortunately, <br>
   Compiling wasmtime-jit v0.40.0 (/home/mi/ext/minacore_mi11/mina_jit_aot/wasmtime/crates/jit)<br>
error[E0433]: failed to resolve: use of undeclared crate or module <code>rustc_demangle</code><br>
 --&gt; crates/jit/src/demangling.rs:7:28<br>
  |<br>
7 |     if let Ok(demangled) = rustc_demangle::try_demangle(name) {<br>
  |                            ^^^^^^^^^^^^^^ use of undeclared crate or module <code>rustc_demangle</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>bincode</code><br>
   --&gt; crates/jit/src/instantiate.rs:270:5<br>
    |<br>
270 |     bincode::serialize_into(&amp;mut bytes, &amp;info)?;<br>
    |     ^^^^^^^ use of undeclared crate or module <code>bincode</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>bincode</code><br>
   --&gt; crates/jit/src/instantiate.rs:421:21<br>
    |<br>
421 |             None =&gt; bincode::deserialize(section(ELF_WASMTIME_INFO)?)<br>
    |                     ^^^^^^^ use of undeclared crate or module <code>bincode</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>cpp_demangle</code><br>
 --&gt; crates/jit/src/demangling.rs:9:49<br>
  |<br>
9 |     } else if let Ok(demangled) = cpp_demangle::Symbol::new(name) {<br>
  |                                                 ^^^^^^ not found in <code>cpp_demangle</code><br>
  |<br>
help: consider importing one of these items<br>
  |<br>
3 | use object::Symbol;<br>
  |<br>
3 | use object::write::Symbol;<br>
  |<br>
help: if you import <code>Symbol</code>, refer to it directly<br>
  |<br>
9 -     } else if let Ok(demangled) = cpp_demangle::Symbol::new(name) {<br>
9 +     } else if let Ok(demangled) = Symbol::new(name) {<br>
  | </p>
<p>For more information about this error, try <code>rustc --explain E0433</code>.<br>
error: could not compile <code>wasmtime-jit</code> due to 4 previous errors</p>
</blockquote>



<a name="291168347"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234533%20x64%3A%20only%20enable%20VTune%20dependencie.../near/291168347" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234533.20x64.3A.20only.20enable.20VTune.20dependencie.2E.2E.2E.html#291168347">(Jul 28 2022 at 11:16)</a>:</h4>
<p>gneworld edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/4533#issuecomment-1198005012">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4533">issue #4533</a>:</p>
<blockquote>
<blockquote>
<p>@gneworld, could you test out this branch to see if it resolves #4523 for you? I don't think I have the right system environment (toolchains, libraries, etc.) to check if indeed this commit will fix the build issue you found.</p>
</blockquote>
<p>@abrown  unfortunately, <br>
   Compiling wasmtime-jit v0.40.0<br>
error[E0433]: failed to resolve: use of undeclared crate or module <code>rustc_demangle</code><br>
 --&gt; crates/jit/src/demangling.rs:7:28<br>
  |<br>
7 |     if let Ok(demangled) = rustc_demangle::try_demangle(name) {<br>
  |                            ^^^^^^^^^^^^^^ use of undeclared crate or module <code>rustc_demangle</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>bincode</code><br>
   --&gt; crates/jit/src/instantiate.rs:270:5<br>
    |<br>
270 |     bincode::serialize_into(&amp;mut bytes, &amp;info)?;<br>
    |     ^^^^^^^ use of undeclared crate or module <code>bincode</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>bincode</code><br>
   --&gt; crates/jit/src/instantiate.rs:421:21<br>
    |<br>
421 |             None =&gt; bincode::deserialize(section(ELF_WASMTIME_INFO)?)<br>
    |                     ^^^^^^^ use of undeclared crate or module <code>bincode</code></p>
<p>error[E0433]: failed to resolve: use of undeclared crate or module <code>cpp_demangle</code><br>
 --&gt; crates/jit/src/demangling.rs:9:49<br>
  |<br>
9 |     } else if let Ok(demangled) = cpp_demangle::Symbol::new(name) {<br>
  |                                                 ^^^^^^ not found in <code>cpp_demangle</code><br>
  |<br>
help: consider importing one of these items<br>
  |<br>
3 | use object::Symbol;<br>
  |<br>
3 | use object::write::Symbol;<br>
  |<br>
help: if you import <code>Symbol</code>, refer to it directly<br>
  |<br>
9 -     } else if let Ok(demangled) = cpp_demangle::Symbol::new(name) {<br>
9 +     } else if let Ok(demangled) = Symbol::new(name) {<br>
  | </p>
<p>For more information about this error, try <code>rustc --explain E0433</code>.<br>
error: could not compile <code>wasmtime-jit</code> due to 4 previous errors</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>