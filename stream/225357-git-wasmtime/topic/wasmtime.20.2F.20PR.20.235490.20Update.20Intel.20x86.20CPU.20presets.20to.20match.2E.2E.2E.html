<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5490 Update Intel x86 CPU presets to match... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html">wasmtime / PR #5490 Update Intel x86 CPU presets to match...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="317994974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/317994974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#317994974">(Dec 26 2022 at 19:04)</a>:</h4>
<p>MozarellaMan opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>:</p>
<blockquote>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[x] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
This is for #5444 </p>
<p>I decided to just start with the Intel CPUs for now just to get feedback on whether this is an alright way to sync up + update cranelift's to match LLVM's presets. I used <a href="https://github.com/llvm/llvm-project/blob/d4493dd1ed58ac3f1eab0c4ca6e363e2b15bfd1c/llvm/lib/Target/X86/X86.td#L1300-L1643">this</a> (thanks @bjorn3!) as a reference for the features and presets used by LLVM.</p>
<h2>Changes</h2>
<ul>
<li>added <code>Copy, Clone</code> derive to <code>PresetIndex</code> to enable composing presets multiple times</li>
<li>added missing x86 Intel CPU presets (old and new)</li>
<li>updated existing presets with apparently missing features (<code>cannonlake</code> and <code>icelake</code>)</li>
</ul>
<h2>Notes</h2>
<ul>
<li>What's the best way to test this? Can it be meaningfully tested?</li>
<li>Should I include links to the exact feature lists for each preset as a comment with each preset or just one link at the top of all the presets?</li>
<li>In some cases, LLVM has a different name for the same architecture feature e.g. LLVM has <code>FeatureDQI</code>, cranelift has <code>has_avx512dq</code> - this led to me updating the existing presets with features that those archtectures have (or at least LLVM says they have those features!)<br>
</li>
</ul>
</blockquote>



<a name="318093796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/318093796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#318093796">(Dec 27 2022 at 13:06)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="319320988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319320988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319320988">(Jan 04 2023 at 04:19)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061124056">PR review comment</a>:</p>
<blockquote>
<p>Is this duplicated from up above?</p>
</blockquote>



<a name="319320989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319320989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319320989">(Jan 04 2023 at 04:19)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1235334701">PR review</a>.</p>



<a name="319320990"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319320990" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319320990">(Jan 04 2023 at 04:19)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1235334701">PR review</a>.</p>



<a name="319473027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473027">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1236406620">PR review</a>.</p>



<a name="319473028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473028">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1236406620">PR review</a>.</p>



<a name="319473031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473031">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061839353">PR review comment</a>:</p>
<blockquote>
<p>Looks like LLVM has an alias for <code>silvermont</code> called <code>slm</code> which I guess we should mirror here.</p>
</blockquote>



<a name="319473032"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473032" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473032">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061835768">PR review comment</a>:</p>
<blockquote>
<p>I think there's a mismatch between how we specify features and how LLVM does it.</p>
<p>Apparently LLVM's <code>FeatureSSE41</code> implies <code>FeatureSSSE3</code> which implies <code>FeatureSSE3</code>, for example. Our boolean settings don't imply other settings. Instead, if you look at the <code>nehalem</code> preset for example, it's specified as <code>preset!(has_sse3 &amp;&amp; has_ssse3 &amp;&amp; has_sse41 &amp;&amp; ...)</code>.</p>
<p>So these definitions for <code>core2</code> and <code>penryn</code> are both missing <code>has_sse3</code>, and <code>penryn</code> is missing <code>has_ssse3</code>. Later presets are similarly missing implied features.</p>
<p>I'm not sure whether it's better to follow the existing pattern and duplicate these implied feature sets everywhere, or to introduce new presets for features which are related in this way:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">sse3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"sse3"</span><span class="p">,</span><span class="w"> </span><span class="s">"SSE3 and earlier."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">has_sse3</span><span class="p">));</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">ssse3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"ssse3"</span><span class="p">,</span><span class="w"> </span><span class="s">"SSSE3 and earlier."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">sse3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">has_ssse3</span><span class="p">));</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">sse41</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"sse41"</span><span class="p">,</span><span class="w"> </span><span class="s">"SSE4.1 and earlier."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">ssse3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">has_sse41</span><span class="p">));</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">sse42</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"sse42"</span><span class="p">,</span><span class="w"> </span><span class="s">"SSE4.2 and earlier."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">sse41</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">has_sse42</span><span class="p">));</span><span class="w"></span>
<span class="o">..</span><span class="p">.</span><span class="w"></span>
<span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"nocona"</span><span class="p">,</span><span class="w"> </span><span class="s">"Nocona microarchitecture."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">sse3</span><span class="p">));</span><span class="w"></span>
<span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"core2"</span><span class="p">,</span><span class="w"> </span><span class="s">"Core 2 microarchitecture."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">ssse3</span><span class="p">));</span><span class="w"></span>
<span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"penryn"</span><span class="p">,</span><span class="w"> </span><span class="s">"Penryn microarchitecture."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">sse41</span><span class="p">));</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">nehalem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"nehalem"</span><span class="p">,</span><span class="w"> </span><span class="s">"Nehalem microarchitecture."</span><span class="p">,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">sse42</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">has_popcnt</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<p>Either way the flattened list of features is included in comments in the generated Rust in <code>target/*/build/cranelift-codegen-*/out/settings-x86.rs</code>, which is nice for double-checking the results.</p>
<p>(@fitzgen, perhaps you have opinions on this?)</p>
</blockquote>



<a name="319473033"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473033" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473033">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061848574">PR review comment</a>:</p>
<blockquote>
<p>Let's match how LLVM defines Haswell. Apparently we were missing AVX/AVX2 and FMA.</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        preset!(ivy_bridge &amp;&amp; has_avx2 &amp;&amp; has_bmi1 &amp;&amp; has_bmi2 &amp;&amp; has_fma &amp;&amp; has_lzcnt),
</code></pre></div><br>
</p>
</blockquote>



<a name="319473034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473034">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061849454">PR review comment</a>:</p>
<blockquote>
<p>Since LLVM claims Haswell included FMA, we can drop it from the preset for Broadwell.</p>
</blockquote>



<a name="319473035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473035">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061874212">PR review comment</a>:</p>
<blockquote>
<p>I appreciate that you're keeping the preset with the <code>icelake</code> name that we used previously. But let's do something more like this to emphasize that it's a compatibility alias, not from LLVM:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">icelake_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"icelake-client"</span><span class="p">,</span><span class="w"> </span><span class="o">..</span><span class="p">.,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">cannonlake</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">has_avx512bitalg</span><span class="p">));</span><span class="w"></span>
<span class="c1">// LLVM doesn't use the name "icelake" but Cranelift did in the past; alias it</span>
<span class="n">settings</span><span class="p">.</span><span class="n">add_preset</span><span class="p">(</span><span class="s">"icelake"</span><span class="p">,</span><span class="w"> </span><span class="o">..</span><span class="p">.,</span><span class="w"> </span><span class="n">preset</span><span class="o">!</span><span class="p">(</span><span class="n">icelake_client</span><span class="p">));</span><span class="w"></span>
</code></pre></div><br>
</p>
</blockquote>



<a name="319473036"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473036" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473036">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061869690">PR review comment</a>:</p>
<blockquote>
<p>Yeah, this copy of the <code>alderlake</code> definition should be deleted. But LLVM is confusing here because it defines Alder Lake between Sapphire Rapids and Raptor Lake, but uses it as a base for earlier microarchitectures. Maybe leave a comment here noting it was defined above, and a comment at the definition above noting that LLVM defines it later.</p>
</blockquote>



<a name="319473037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/319473037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#319473037">(Jan 04 2023 at 21:05)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1061876937">PR review comment</a>:</p>
<blockquote>
<p>If I've read the LLVM tables correctly, Nocona is the first Intel 64-bit microarchitecture, so these are the 32-bit targets I'd like to remove.</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>    // Netburst
</code></pre></div><br>
</p>
</blockquote>



<a name="320807080"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320807080" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320807080">(Jan 11 2023 at 22:10)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="320807081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320807081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320807081">(Jan 11 2023 at 22:10)</a>:</h4>
<p>MozarellaMan submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1244683344">PR review</a>.</p>



<a name="320807126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320807126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320807126">(Jan 11 2023 at 22:10)</a>:</h4>
<p>MozarellaMan created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1067504965">PR review comment</a>:</p>
<blockquote>
<p>Personally, I would prefer the features implying the others - it makes sense now that you pointed it out. The added description in the setting preset makes that more obivous.</p>
</blockquote>



<a name="320808370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320808370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320808370">(Jan 11 2023 at 22:20)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="320809068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320809068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320809068">(Jan 11 2023 at 22:25)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="320809343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320809343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320809343">(Jan 11 2023 at 22:27)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="320811194"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320811194" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320811194">(Jan 11 2023 at 22:40)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="320817304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320817304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320817304">(Jan 11 2023 at 23:34)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1244763925">PR review</a>.</p>



<a name="320817305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320817305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320817305">(Jan 11 2023 at 23:34)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1244763925">PR review</a>.</p>



<a name="320817306"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/320817306" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#320817306">(Jan 11 2023 at 23:34)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1067561031">PR review comment</a>:</p>
<blockquote>
<p>If I'm reading the LLVM tables correctly, it exposes this as _both_ "slm" and "silvermont", but defines them identically. So we should do the same. I think it makes sense to use the longer name "silvermont" as the let-bound preset, and define the "slm" preset in terms of "silvermont".</p>
</blockquote>



<a name="321242616"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321242616" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321242616">(Jan 13 2023 at 19:39)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="321251111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321251111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321251111">(Jan 13 2023 at 20:29)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1248436875">PR review</a>.</p>



<a name="321251112"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321251112" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321251112">(Jan 13 2023 at 20:29)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#discussion_r1069998982">PR review comment</a>:</p>
<blockquote>
<p>I think the duplicate definition of <code>alderlake</code> is the last issue remaining here. Once that's fixed I think this PR is ready!</p>
</blockquote>



<a name="321252037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321252037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321252037">(Jan 13 2023 at 20:35)</a>:</h4>
<p>MozarellaMan updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a> from <code>update_x86_target_intel_cpu_presets_to_match_llvm</code> to <code>main</code>.</p>



<a name="321253251"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321253251" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321253251">(Jan 13 2023 at 20:42)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5490#pullrequestreview-1248478050">PR review</a>.</p>



<a name="321253464"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321253464" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321253464">(Jan 13 2023 at 20:43)</a>:</h4>
<p>jameysharp has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a>.</p>



<a name="321256674"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235490%20Update%20Intel%20x86%20CPU%20presets%20to%20match.../near/321256674" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235490.20Update.20Intel.20x86.20CPU.20presets.20to.20match.2E.2E.2E.html#321256674">(Jan 13 2023 at 21:02)</a>:</h4>
<p>jameysharp merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5490">PR #5490</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>