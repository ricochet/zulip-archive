<html>
<head><meta charset="utf-8"><title>wasmtime / PR #8595 Wasmtime(gc): Add support for superty... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html">wasmtime / PR #8595 Wasmtime(gc): Add support for superty...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="438059646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438059646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438059646">(May 10 2024 at 23:13)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a> from <code>fitzgen:supertypes-and-finality</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This is the final type system change for Wasm GC: the ability to explicitly declare supertypes and finality. A final type may not be a supertype of another type. A concrete heap type matches another concrete heap type if its concrete type is a subtype (potentially transitively) of the other heap type's concrete type.</p>
<p>Next, I'll begin support for allocating GC structs and arrays at runtime.</p>
<p>I've also implemented <code>O(1)</code> subtype checking in the types registry:</p>
<p>In a type system with single inheritance, the subtyping relationships between all types form a set of trees. The root of each tree is a type that has no supertype; each node's immediate children are the types that directly subtype that node.</p>
<p>For example, consider these types:</p>
<div class="codehilite"><pre><span></span><code>class Base {}
class A subtypes Base {}
class B subtypes Base {}
class C subtypes A {}
class D subtypes A {}
class E subtypes C {}
</code></pre></div>

<p>These types produce the following tree:</p>
<div class="codehilite"><pre><span></span><code>           Base
          /    \
         A      B
        / \
       C   D
      /
     E
</code></pre></div>

<p>Note the following properties:</p>
<ol>
<li>
<p>If <code>sub</code> is a subtype of <code>sup</code> (either directly or transitively) then <code>sup</code> <em>must</em> be on the path from <code>sub</code> up to the root of <code>sub</code>'s tree.</p>
</li>
<li>
<p>Additionally, <code>sup</code> <em>must</em> be the <code>i</code>th node down from the root in that path, where <code>i</code> is the length of the path from <code>sup</code> to its tree's root.</p>
</li>
</ol>
<p>Therefore, if we maintain a vector containing the path to the root for each type, then we can simply check if <code>sup</code> is at index <code>supertypes(sup).len()</code> within <code>supertypes(sub)</code>.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="438059647"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438059647" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438059647">(May 10 2024 at 23:13)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438059648"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438059648" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438059648">(May 10 2024 at 23:13)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438059649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438059649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438059649">(May 10 2024 at 23:13)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438059651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438059651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438059651">(May 10 2024 at 23:13)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438060059"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438060059" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438060059">(May 10 2024 at 23:17)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438066308"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066308" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066308">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2051002273">PR review</a>:</p>
<blockquote>
<p>Nice <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="438066309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066309">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2051002273">PR review</a>:</p>
<blockquote>
<p>Nice <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="438066310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066310">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1597318210">PR review comment</a>:</p>
<blockquote>
<p>Aha this clears up some historical confusion on my part! This is the missing link in the "break the recursion" thinking for me.</p>
</blockquote>



<a name="438066311"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066311" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066311">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1597316482">PR review comment</a>:</p>
<blockquote>
<p>Could the above method delegate to this new method to start off? (looks like they both start with all the same code)</p>
</blockquote>



<a name="438066312"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066312" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066312">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1597317640">PR review comment</a>:</p>
<blockquote>
<p>IIRC you had a scheme where a lock wasn't required from within wasm, right? (outside of wasm seems totally fine, just wanted to confirm for in-wasm)</p>
</blockquote>



<a name="438066313"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066313" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066313">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1597318608">PR review comment</a>:</p>
<blockquote>
<p>Also, for the arms modified here, should the <code>matches</code> method be removed? Or is it used elsewhere?</p>
</blockquote>



<a name="438066314"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066314" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066314">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1597317344">PR review comment</a>:</p>
<blockquote>
<p>Could this always do <code>= None</code> regardless of whether there's an array there or not?</p>
</blockquote>



<a name="438066315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438066315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438066315">(May 11 2024 at 00:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1597316818">PR review comment</a>:</p>
<blockquote>
<p>Interpreted literally I think these docs are backwards since <code>true</code> means it can't be a supertype of anything else. Mind rewording the other way around?</p>
</blockquote>



<a name="438072670"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438072670" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438072670">(May 11 2024 at 02:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#issuecomment-2105496188">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @saulecabrera</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api", "winch"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>saulecabrera: winch</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="438147246"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438147246" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438147246">(May 12 2024 at 01:30)</a>:</h4>
<p>jeffparsons <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#issuecomment-2106082217">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>:</p>
<blockquote>
<blockquote>
<p>Therefore, if we maintain a vector containing the path to the root for each type, then we can simply check if sup is at index supertypes(sup).len() within supertypes(sub).</p>
</blockquote>
<p>This means that the storage for the vecs in each tree is, in total, in <code>O(N log N)</code>, right? </p>
<p>I think there's a cheaper <code>O(N)</code> storage per tree way to do it, that still offers <code>O(1)</code> subtype checking: </p>
<ul>
<li>Store nodes of the tree in a vec where all descendents of a node occur after that node and before any non-descendent node.</li>
<li>Each node stores the index of its last descendent. If it has none, then the index will be its own index.</li>
<li>To test whether <code>sub</code> is a subtype of <code>sup</code>:<br>
    - Look up trees and indexes of both types.<br>
    - If they live in different trees, then there is no subtype relationship. <br>
    - Otherwise, look up <code>sup</code>'s node. If <code>sup_index &lt; sub_index &amp;&amp; sub_index &lt;= sup_last_descendent</code> then we have a subtype.</li>
</ul>
<p>There's a good chance I've misunderstood something (e.g. how the trees are updated?), but if there's nothing else special about these trees then maybe this optimisation is applicable! <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>
</blockquote>



<a name="438175628"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438175628" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438175628">(May 12 2024 at 10:36)</a>:</h4>
<p>jeffparsons edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#issuecomment-2106082217">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>:</p>
<blockquote>
<blockquote>
<p>Therefore, if we maintain a vector containing the path to the root for each type, then we can simply check if sup is at index supertypes(sup).len() within supertypes(sub).</p>
</blockquote>
<p>This means that the storage for the vecs in each tree is, in total, in <code>O(N log N)</code>, right? </p>
<p>I think there's a cheaper <code>O(N)</code> storage per tree way to do it, that still offers <code>O(1)</code> subtype checking: </p>
<ul>
<li>Store nodes of the tree in a vec where all descendents of a node occur after that node and before any non-descendent node.</li>
<li>Each node stores the index of its last descendent. If it has none, then the index will be its own index.</li>
<li>To test whether <code>sub</code> is a subtype of <code>sup</code>:<br>
    - Look up trees and indexes of both types.<br>
    - If they live in different trees, then there is no subtype relationship. <br>
    - Otherwise, look up <code>sup</code>'s node. If <code>sup_index &lt; sub_index &amp;&amp; sub_index &lt;= sup_last_descendent</code> then we have a subtype.</li>
</ul>
<p>EDIT: And I guess if the types are already stored in some other structure(s), there's actually no need for a separate vector for this information; the primary representation of the type can just have those extra fields for: tree ID, index in tree, max descendent index.</p>
<p>There's a good chance I've misunderstood something (e.g. how the trees are updated?), but if there's nothing else special about these trees then maybe this optimisation is applicable! <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>
</blockquote>



<a name="438412127"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438412127" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438412127">(May 13 2024 at 17:22)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#issuecomment-2108321298">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>:</p>
<blockquote>
<p>@jeffparsons, thanks for digging in here! Always appreciate a second pair of eyes.</p>
<blockquote>
<p>This means that the storage for the vecs in each tree is, in total, in <code>O(N log N)</code>, right?</p>
</blockquote>
<p>It is indeed a time-space tradeoff, but as-implemented it can actually be even worse than <code>O(n log n)</code>: consider a chain where each type is a subtype of its predecessor: <code>a; b &lt;: a; c &lt;: b; d &lt;: c; ...</code>. The <code>i</code>th type's supertype array will be of length <code>i - 1</code>, and this forms the classic "triangle" shape that indicates <code>O(n * n)</code> behavior. This particular case could be resolved (although the implementation would be a bit awkward in the presence of type canonicalization across modules) by defining the supertype arrays in sub-to-supertype order and then using a subslice of a subtype's supertype's vector, when one is present, instead of allocating a new vector. Then I think we would be at <code>O(n log n)</code>.</p>
<p>However, implementations are allowed to define their own limits on the maximum depth a subtyping chain may have. And for JS embeddings, it is additionally tightened from "some implementation limit" to <code>63</code>; for maximum cross-engine compatibility, we've always matched the JS embedding limits.</p>
<p><a href="https://webassembly.github.io/gc/js-api/index.html#limits">https://webassembly.github.io/gc/js-api/index.html#limits</a></p>
<p>Anyways, the point is that this limit provides bounds on the total memory overhead associated with these supertype vectors, preventing worst-case scenarios.</p>
<p>Finally, my understanding is that it is pretty much expected that engines implement subtyping checks with this technique, FWIW. For example, here is SpiderMonkey's docs about doing this same thing: <a href="https://searchfox.org/mozilla-central/rev/ee2ad260c25310a9fbf96031de05bbc0e94394cc/js/src/wasm/WasmTypeDef.h#480-541">https://searchfox.org/mozilla-central/rev/ee2ad260c25310a9fbf96031de05bbc0e94394cc/js/src/wasm/WasmTypeDef.h#480-541</a></p>
<p>This is a good reminder to double check that we are actually enforcing the subtyping depth limits in validation, though :-p</p>
<blockquote>
<p>I think there's a cheaper O(N) storage per tree way to do it, that still offers <code>O(1)</code> subtype checking:</p>
</blockquote>
<p>If I understand correctly, this is storing the entry and exit indices of a depth-first traversal of the tree and then subtype checking checks that (a) we are looking at the same tree and (b) that the subtype's index (doesn't matter if we check entry vs exit index) is within the supertype's range, correct?</p>
<p>This would indeed work very nicely in the context of a single Wasm module and a static set of types.</p>
<p>But, as you alluded to, things get problematic when we consider updates. GC objects can be passed between modules, and a non-final type from module A can be subtyped by another type in module B and then an instance of that subtype can be passed from B to A, and A might want to do subtyping checks on this instance even though it never defined the exact type of that instance. This necessitates canonicalizing types across modules. So, even though from a single Wasm module's perspective the type set is static, from an engine perspective we are constantly dynamically adding and removing types from the same deduplicated, canonicalized types registry as modules are loaded or unloaded (or when the host defines/drops types via the public Wasmtime API). And therefore our type hierarchies and their trees aren't static, and must support having subtrees grafted on and pruned away at any moment. That means we would need to recompute potentially all those depth-first traversal indices on every mutation, an <code>O(n)</code> operation for each new type definition, which is already too expensive on its own, but also leads to <code>O(n * n)</code> behavior when defining <code>n</code> new types.</p>
<p>So I don't think this approach is something we can use in this case, unfortunately.<br>
</p>
</blockquote>



<a name="438412287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438412287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438412287">(May 13 2024 at 17:23)</a>:</h4>
<p>fitzgen edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#issuecomment-2108321298">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>:</p>
<blockquote>
<p>@jeffparsons, thanks for digging in here! Always appreciate a second pair of eyes.</p>
<blockquote>
<p>This means that the storage for the vecs in each tree is, in total, in <code>O(N log N)</code>, right?</p>
</blockquote>
<p>It is indeed a time-space tradeoff, but as-implemented it can actually be even worse than <code>O(n log n)</code>: consider a chain where each type is a subtype of its predecessor: <code>a; b &lt;: a; c &lt;: b; d &lt;: c; ...</code>. The <code>i</code>th type's supertype array will be of length <code>i - 1</code>, and this forms the classic "triangle" shape that indicates <code>O(n * n)</code> behavior. This particular case could be resolved (although the implementation would be a bit awkward in the presence of type canonicalization across modules) by defining the supertype arrays in sub-to-supertype order and then using a subslice of a subtype's supertype's vector, when one is present, instead of allocating a new vector. Then I think we would be at <code>O(n log n)</code> in general again.</p>
<p>However, implementations are allowed to define their own limits on the maximum depth a subtyping chain may have. And for JS embeddings, it is additionally tightened from "some implementation limit" to <code>63</code>; for maximum cross-engine compatibility, we've always matched the JS embedding limits.</p>
<p><a href="https://webassembly.github.io/gc/js-api/index.html#limits">https://webassembly.github.io/gc/js-api/index.html#limits</a></p>
<p>Anyways, the point is that this limit provides bounds on the total memory overhead associated with these supertype vectors, preventing worst-case scenarios.</p>
<p>Finally, my understanding is that it is pretty much expected that engines implement subtyping checks with this technique, FWIW. For example, here is SpiderMonkey's docs about doing this same thing: <a href="https://searchfox.org/mozilla-central/rev/ee2ad260c25310a9fbf96031de05bbc0e94394cc/js/src/wasm/WasmTypeDef.h#480-541">https://searchfox.org/mozilla-central/rev/ee2ad260c25310a9fbf96031de05bbc0e94394cc/js/src/wasm/WasmTypeDef.h#480-541</a></p>
<p>This is a good reminder to double check that we are actually enforcing the subtyping depth limits in validation, though :-p</p>
<blockquote>
<p>I think there's a cheaper O(N) storage per tree way to do it, that still offers <code>O(1)</code> subtype checking:</p>
</blockquote>
<p>If I understand correctly, this is storing the entry and exit indices of a depth-first traversal of the tree and then subtype checking checks that (a) we are looking at the same tree and (b) that the subtype's index (doesn't matter if we check entry vs exit index) is within the supertype's range, correct?</p>
<p>This would indeed work very nicely in the context of a single Wasm module and a static set of types.</p>
<p>But, as you alluded to, things get problematic when we consider updates. GC objects can be passed between modules, and a non-final type from module A can be subtyped by another type in module B and then an instance of that subtype can be passed from B to A, and A might want to do subtyping checks on this instance even though it never defined the exact type of that instance. This necessitates canonicalizing types across modules. So, even though from a single Wasm module's perspective the type set is static, from an engine perspective we are constantly dynamically adding and removing types from the same deduplicated, canonicalized types registry as modules are loaded or unloaded (or when the host defines/drops types via the public Wasmtime API). And therefore our type hierarchies and their trees aren't static, and must support having subtrees grafted on and pruned away at any moment. That means we would need to recompute potentially all those depth-first traversal indices on every mutation, an <code>O(n)</code> operation for each new type definition, which is already too expensive on its own, but also leads to <code>O(n * n)</code> behavior when defining <code>n</code> new types.</p>
<p>So I don't think this approach is something we can use in this case, unfortunately.<br>
</p>
</blockquote>



<a name="438440723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438440723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438440723">(May 13 2024 at 20:19)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438441968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438441968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438441968">(May 13 2024 at 20:27)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2053748700">PR review</a>.</p>



<a name="438441969"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438441969" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438441969">(May 13 2024 at 20:27)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599044086">PR review comment</a>:</p>
<blockquote>
<p>This doesn't quite work out because while both arms of the above method start with producing an <code>EngineOrModuleIndex</code>, and that happens in the same way as this method, the arms continue by reusing intermediate steps from how the <code>EngineOrModuleIndex</code> was produced in the code that follows after the index has been constructed. This makes it subtly difficult to pull apart or reuse.</p>
</blockquote>



<a name="438442394"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438442394" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438442394">(May 13 2024 at 20:30)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2053756029">PR review</a>.</p>



<a name="438442396"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438442396" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438442396">(May 13 2024 at 20:30)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599046771">PR review comment</a>:</p>
<blockquote>
<p>Unfortunately always doing <code>self.types_to_supertypes = None</code> would force the secondary map to allocate even when we aren't ever using Wasm GC. I could remove the <code>is_some_and(..)</code> suffix tho; I'll do that.</p>
</blockquote>



<a name="438443497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438443497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438443497">(May 13 2024 at 20:37)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2053776176">PR review</a>.</p>



<a name="438443498"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438443498" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438443498">(May 13 2024 at 20:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599053542">PR review comment</a>:</p>
<blockquote>
<p>Ah ok makes sense, mind leaving a comment that the purpose here is to avoid touching the map entirely?</p>
</blockquote>



<a name="438443992"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438443992" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438443992">(May 13 2024 at 20:41)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2053784931">PR review</a>.</p>



<a name="438443994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438443994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438443994">(May 13 2024 at 20:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599056688">PR review comment</a>:</p>
<blockquote>
<p>For the common case of checking subtyping of instances of types defined in this module, yes.</p>
<p>I don't have a plan for how to avoid locks in the terrible case of new external subtypes created dynamically:</p>
<ul>
<li>create module <code>A</code> with non-final type <code>T</code></li>
<li>instantiate module <code>A</code></li>
<li>create module <code>B</code></li>
<li>instantiate module B with type <code>U &lt;: T</code></li>
<li>instantiate module <code>B</code></li>
<li>instantiate object of type <code>U</code></li>
<li>pass object to instance <code>A</code> for subtyping check</li>
</ul>
<p>(Note that module <code>B</code> could also be the host using the public API)</p>
<p>My thinking is that we can just fall back to locking the type registry in the cross-module-subtyping case. I think there are some more tricks we can play with <code>InstancePre</code>s to make cross-module-subtyping fast for all types that exist at <code>InstancePre</code> creation time, but for new subtypes created during runtime we will always need to fall back to locking (or equivalent) AFAICT.</p>
</blockquote>



<a name="438444407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438444407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438444407">(May 13 2024 at 20:43)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2053791307">PR review</a>.</p>



<a name="438444408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438444408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438444408">(May 13 2024 at 20:43)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599058813">PR review comment</a>:</p>
<blockquote>
<p>They are used elsewhere (e.g. inside the <code>with_finality_and_supertype</code> constructors) and are also generally useful as part of the public API.</p>
</blockquote>



<a name="438444566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438444566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438444566">(May 13 2024 at 20:44)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599056688">PR review comment</a>.</p>



<a name="438444968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438444968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438444968">(May 13 2024 at 20:46)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<a name="438445264"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438445264" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438445264">(May 13 2024 at 20:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#pullrequestreview-2053800775">PR review</a>.</p>



<a name="438445267"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438445267" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438445267">(May 13 2024 at 20:48)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8595#discussion_r1599064479">PR review comment</a>:</p>
<blockquote>
<p>Ok makes sense, I mostly wanted to confirm there was a means of intra-module checks that didn't require locking. <br>
</p>
</blockquote>



<a name="438452365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238595%20Wasmtime%28gc%29%3A%20Add%20support%20for%20superty.../near/438452365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238595.20Wasmtime.28gc.29.3A.20Add.20support.20for.20superty.2E.2E.2E.html#438452365">(May 13 2024 at 21:30)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/8595">PR #8595</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>