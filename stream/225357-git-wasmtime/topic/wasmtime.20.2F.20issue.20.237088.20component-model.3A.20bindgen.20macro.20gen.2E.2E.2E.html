<html>
<head><meta charset="utf-8"><title>wasmtime / issue #7088 component-model: bindgen macro gen... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html">wasmtime / issue #7088 component-model: bindgen macro gen...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="393145850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393145850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393145850">(Sep 26 2023 at 02:11)</a>:</h4>
<p>lwansbrough opened <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Consider the example from the bindgen docs:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="o">*</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="p">{</span><span class="n">Config</span><span class="p">,</span><span class="w"> </span><span class="n">Engine</span><span class="p">,</span><span class="w"> </span><span class="n">Store</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="p">;</span>

<span class="n">bindgen</span><span class="o">!</span><span class="p">();</span>

<span class="k">struct</span> <span class="nc">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Note that the trait here is per-interface and within a submodule now.</span>
<span class="k">impl</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">rand</span>::<span class="n">thread_rng</span><span class="p">().</span><span class="n">gen</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Config</span>::<span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">wasm_component_model</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Engine</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Component</span>::<span class="n">from_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="s">"./your-component.wasm"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linker</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">);</span>
<span class="w">    </span><span class="n">HelloWorld</span>::<span class="n">add_to_linker</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">MyState</span><span class="o">|</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Store</span>::<span class="n">new</span><span class="p">(</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span>
<span class="w">        </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HelloWorld</span>::<span class="n">instantiate</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">linker</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Note that the `demo` method returns a `&amp;Demo` through which we can</span>
<span class="w">    </span><span class="c1">// run the methods on that interface.</span>
<span class="w">    </span><span class="n">bindings</span><span class="p">.</span><span class="n">demo</span><span class="p">().</span><span class="n">call_run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div>
<p>If <code>MyState</code> here is instead <code>MyState&lt;'render&gt;</code> (in my case, I'm holding a reference to a <code>wgpu::RenderPass&lt;'render&gt;</code>), the bindgen macro generates a trait which is implemented like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="n">HostGpuCommandEncoder</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">WizardRuntimeState</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">begin_render_pass</span><span class="o">&lt;'</span><span class="na">life0</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="na">async_trait</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">life0</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">self_</span>: <span class="nc">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuCommandEncoder</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">descriptor</span>: <span class="nc">GpuRenderPassDescriptor</span><span class="p">)</span><span class="w"> </span>-&gt;  ::<span class="n">core</span>::<span class="n">pin</span>::<span class="n">Pin</span><span class="o">&lt;</span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">future</span>::<span class="n">Future</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuRenderPassEncoder</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="o">+'</span><span class="na">async_trait</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">'</span><span class="na">life0</span>: <span class="o">'</span><span class="na">async_trait</span><span class="p">,</span><span class="w"> </span><span class="bp">Self</span>:<span class="o">'</span><span class="na">async_trait</span> <span class="p">{</span>
</code></pre></div>
<p>but here, Rust is unable to assume that <code>'life0</code> outlives <code>'render</code> and I cannot specify it as <code>'life0: 'render</code> because that's a stricter requirement than the trait.</p>
</blockquote>



<a name="393146050"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393146050" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393146050">(Sep 26 2023 at 02:13)</a>:</h4>
<p>lwansbrough edited <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Consider the example from the bindgen docs:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="o">*</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="p">{</span><span class="n">Config</span><span class="p">,</span><span class="w"> </span><span class="n">Engine</span><span class="p">,</span><span class="w"> </span><span class="n">Store</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="p">;</span>

<span class="n">bindgen</span><span class="o">!</span><span class="p">();</span>

<span class="k">struct</span> <span class="nc">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Note that the trait here is per-interface and within a submodule now.</span>
<span class="k">impl</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">rand</span>::<span class="n">thread_rng</span><span class="p">().</span><span class="n">gen</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Config</span>::<span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">wasm_component_model</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Engine</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Component</span>::<span class="n">from_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="s">"./your-component.wasm"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linker</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">);</span>
<span class="w">    </span><span class="n">HelloWorld</span>::<span class="n">add_to_linker</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">MyState</span><span class="o">|</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Store</span>::<span class="n">new</span><span class="p">(</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span>
<span class="w">        </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HelloWorld</span>::<span class="n">instantiate</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">linker</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Note that the `demo` method returns a `&amp;Demo` through which we can</span>
<span class="w">    </span><span class="c1">// run the methods on that interface.</span>
<span class="w">    </span><span class="n">bindings</span><span class="p">.</span><span class="n">demo</span><span class="p">().</span><span class="n">call_run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div>
<p>If <code>MyState</code> here is instead <code>MyState&lt;'render&gt;</code> (in my case, MyState owns an <code>Option&lt;wgpu::RenderPass&lt;'render&gt;&gt;</code>), the bindgen macro generates a trait which is implemented like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="n">HostGpuCommandEncoder</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">WizardRuntimeState</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">begin_render_pass</span><span class="o">&lt;'</span><span class="na">life0</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="na">async_trait</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">life0</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">self_</span>: <span class="nc">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuCommandEncoder</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">descriptor</span>: <span class="nc">GpuRenderPassDescriptor</span><span class="p">)</span><span class="w"> </span>-&gt;  ::<span class="n">core</span>::<span class="n">pin</span>::<span class="n">Pin</span><span class="o">&lt;</span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">future</span>::<span class="n">Future</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuRenderPassEncoder</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="o">+'</span><span class="na">async_trait</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">'</span><span class="na">life0</span>: <span class="o">'</span><span class="na">async_trait</span><span class="p">,</span><span class="w"> </span><span class="bp">Self</span>:<span class="o">'</span><span class="na">async_trait</span> <span class="p">{</span>
</code></pre></div>
<p>but here, Rust is unable to assume that <code>'life0</code> outlives <code>'render</code> and I cannot specify it as <code>'life0: 'render</code> because that's a stricter requirement than the trait.</p>
</blockquote>



<a name="393244790"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393244790" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393244790">(Sep 26 2023 at 14:21)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1735646263">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Could you share some more code as a reproducible example? This for example compiles ok for me locally:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">mod</span> <span class="nn">with_lifetimes</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">bindgen</span><span class="o">!</span><span class="p">({</span>
<span class="w">        </span><span class="n">inline</span>: <span class="s">"</span>
<span class="s">package my:project</span>

<span class="s">interface host {</span>
<span class="s">    gen-random-integer: func() -&gt; u32</span>
<span class="s">    sha256: func(bytes: list&lt;u8&gt;) -&gt; string</span>
<span class="s">}</span>

<span class="s">world hello-world {</span>
<span class="s">    import host</span>

<span class="s">    export demo: interface {</span>
<span class="s">        run: func()</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">        "</span><span class="p">,</span>
<span class="w">        </span><span class="k">async</span>: <span class="nc">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">struct</span> <span class="nc">MyState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_x</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="n">wgpu</span>::<span class="n">RenderPass</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Note that the trait here is per-interface and within a submodule now.</span>
<span class="w">    </span><span class="cp">#[async_trait::async_trait]</span>
<span class="w">    </span><span class="k">impl</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="o">&lt;'</span><span class="nb">_</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">_bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="393244858"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393244858" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393244858">(Sep 26 2023 at 14:21)</a>:</h4>
<p>alexcrichton edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1735646263">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Could you share some more code as a reproducible example? This for example compiles ok for me locally:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">mod</span> <span class="nn">with_lifetimes</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">bindgen</span><span class="o">!</span><span class="p">({</span>
<span class="w">        </span><span class="n">inline</span>: <span class="s">"</span>
<span class="s">package my:project</span>

<span class="s">interface host {</span>
<span class="s">    gen-random-integer: func() -&gt; u32</span>
<span class="s">    sha256: func(bytes: list&lt;u8&gt;) -&gt; string</span>
<span class="s">}</span>

<span class="s">world hello-world {</span>
<span class="s">    import host</span>

<span class="s">    export demo: interface {</span>
<span class="s">        run: func()</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">        "</span><span class="p">,</span>
<span class="w">        </span><span class="k">async</span>: <span class="nc">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">struct</span> <span class="nc">MyState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_x</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="n">wgpu</span>::<span class="n">RenderPass</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cp">#[async_trait::async_trait]</span>
<span class="w">    </span><span class="k">impl</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="o">&lt;'</span><span class="nb">_</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">_bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="393324593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393324593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393324593">(Sep 26 2023 at 20:36)</a>:</h4>
<p>lwansbrough <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736258550">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>@alexcrichton apologies for the increase in complexity of the example, but this more accurately reflects the problem I'm having and demonstrates the correct lifetimes issue. Uses <code>slab</code> and <code>wgpu</code></p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">mod</span> <span class="nn">with_lifetimes</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">bindgen</span><span class="o">!</span><span class="p">({</span>
<span class="w">        </span><span class="n">inline</span>: <span class="s">"</span>
<span class="s">package my:project</span>

<span class="s">interface host {</span>
<span class="s">    gen-random-integer: func() -&gt; u32</span>
<span class="s">    sha256: func(bytes: list&lt;u8&gt;) -&gt; string</span>
<span class="s">}</span>

<span class="s">world hello-world {</span>
<span class="s">    import host</span>

<span class="s">    export demo: interface {</span>
<span class="s">        run: func()</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">        "</span><span class="p">,</span>
<span class="w">        </span><span class="k">async</span>: <span class="nc">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">struct</span> <span class="nc">MyState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">render_state</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="n">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">pub</span><span class="w"> </span><span class="n">command_encoders</span>: <span class="nc">slab</span>::<span class="n">Slab</span>::<span class="o">&lt;</span><span class="n">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">impl</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">RenderState</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">command_encoders</span>: <span class="nc">slab</span>::<span class="n">Slab</span>::<span class="n">new</span><span class="p">()</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">pub</span><span class="w"> </span><span class="n">encoder</span>: <span class="nc">wgpu</span>::<span class="n">CommandEncoder</span><span class="p">,</span>
<span class="w">        </span><span class="k">pub</span><span class="w"> </span><span class="n">render_passes</span>: <span class="nc">slab</span>::<span class="n">Slab</span>::<span class="o">&lt;</span><span class="n">wgpu</span>::<span class="n">RenderPass</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">impl</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">encoder</span>: <span class="nc">wgpu</span>::<span class="n">CommandEncoder</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">GpuCommandEncoderState</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">encoder</span><span class="p">,</span>
<span class="w">                </span><span class="n">render_passes</span>: <span class="nc">slab</span>::<span class="n">Slab</span>::<span class="n">new</span><span class="p">()</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cp">#[async_trait::async_trait]</span>
<span class="w">    </span><span class="k">impl</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="o">&lt;'</span><span class="nb">_</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">render_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">render_state</span><span class="p">.</span><span class="n">as_mut</span><span class="p">().</span><span class="n">expect</span><span class="p">(</span><span class="s">"Render state"</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">render_state</span><span class="p">.</span><span class="n">command_encoders</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">render_pass_encoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="p">.</span><span class="n">encoder</span><span class="p">.</span><span class="n">begin_render_pass</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wgpu</span>::<span class="n">RenderPassDescriptor</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">label</span>: <span class="nb">None</span><span class="p">,</span>
<span class="w">                </span><span class="n">color_attachments</span>: <span class="kp">&amp;</span><span class="p">[],</span>
<span class="w">                </span><span class="n">depth_stencil_attachment</span>: <span class="nb">None</span>
            <span class="p">});</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">pass_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="p">.</span><span class="n">render_passes</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">render_pass_encoder</span><span class="p">);</span>

<span class="w">            </span><span class="n">wasmtime</span>::<span class="nb">Result</span>::<span class="nb">Ok</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">_bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="393327521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393327521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393327521">(Sep 26 2023 at 20:54)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736288377">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Thanks! I unfortunately think though that this isn't related to Wasmtime or <code>bindgen!</code>. The error message from rustc could probably be improved in this case, but for example this fails to compile which has all the wasmtime bits removed:</p>
<p>&lt;details&gt;</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">struct</span> <span class="nc">MyState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">render_state</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="n">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">command_encoders</span>: <span class="nc">slab</span>::<span class="n">Slab</span><span class="o">&lt;</span><span class="n">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">RenderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">RenderState</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">command_encoders</span>: <span class="nc">slab</span>::<span class="n">Slab</span>::<span class="n">new</span><span class="p">(),</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">encoder</span>: <span class="nc">wgpu</span>::<span class="n">CommandEncoder</span><span class="p">,</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">render_passes</span>: <span class="nc">slab</span>::<span class="n">Slab</span><span class="o">&lt;</span><span class="n">wgpu</span>::<span class="n">RenderPass</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">encoder</span>: <span class="nc">wgpu</span>::<span class="n">CommandEncoder</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">GpuCommandEncoderState</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">GpuCommandEncoderState</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">encoder</span><span class="p">,</span>
<span class="w">            </span><span class="n">render_passes</span>: <span class="nc">slab</span>::<span class="n">Slab</span>::<span class="n">new</span><span class="p">(),</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span><span class="w"> </span><span class="n">MyState</span><span class="o">&lt;'</span><span class="nb">_</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">render_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">render_state</span><span class="p">.</span><span class="n">as_mut</span><span class="p">().</span><span class="n">expect</span><span class="p">(</span><span class="s">"Render state"</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">render_state</span><span class="p">.</span><span class="n">command_encoders</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">render_pass_encoder</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">command_encoder_state</span>
<span class="w">                </span><span class="p">.</span><span class="n">encoder</span>
<span class="w">                </span><span class="p">.</span><span class="n">begin_render_pass</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wgpu</span>::<span class="n">RenderPassDescriptor</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">label</span>: <span class="nb">None</span><span class="p">,</span>
<span class="w">                    </span><span class="n">color_attachments</span>: <span class="kp">&amp;</span><span class="p">[],</span>
<span class="w">                    </span><span class="n">depth_stencil_attachment</span>: <span class="nb">None</span><span class="p">,</span>
<span class="w">                </span><span class="p">});</span>

<span class="w">        </span><span class="n">command_encoder_state</span>
<span class="w">            </span><span class="p">.</span><span class="n">render_passes</span>
<span class="w">            </span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">render_pass_encoder</span><span class="p">);</span>

<span class="w">        </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>&lt;/details&gt;</p>
<p>I believe the root cause of this is that <code>wgpu::RenderPass&lt;'a&gt;</code> is storing a pointer to the <code>wgpu::CommandEncoder</code> field, which makes your <code>GpuCommandEncoderState</code> type a self-referential structure, which Rust doesn't handle well.</p>
<p>That's at least the problem, but I don't know enough about wgpu to know how best to restructure to fix this. Regardless though I think that this is unrelated to Wasmtime?<br>
</p>
</blockquote>



<a name="393327901"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393327901" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393327901">(Sep 26 2023 at 20:56)</a>:</h4>
<p>lwansbrough <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736290756">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Ok, that's a good assessment. I'll have to do some more digging on my end to figure out how to manage that. I'm happy to close the issue in that case. Thanks for your help!</p>
</blockquote>



<a name="393327902"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393327902" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393327902">(Sep 26 2023 at 20:56)</a>:</h4>
<p>lwansbrough closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Consider the example from the bindgen docs:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="o">*</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="p">{</span><span class="n">Config</span><span class="p">,</span><span class="w"> </span><span class="n">Engine</span><span class="p">,</span><span class="w"> </span><span class="n">Store</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="p">;</span>

<span class="n">bindgen</span><span class="o">!</span><span class="p">();</span>

<span class="k">struct</span> <span class="nc">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Note that the trait here is per-interface and within a submodule now.</span>
<span class="k">impl</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">rand</span>::<span class="n">thread_rng</span><span class="p">().</span><span class="n">gen</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Config</span>::<span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">wasm_component_model</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Engine</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Component</span>::<span class="n">from_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="s">"./your-component.wasm"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linker</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">);</span>
<span class="w">    </span><span class="n">HelloWorld</span>::<span class="n">add_to_linker</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">MyState</span><span class="o">|</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Store</span>::<span class="n">new</span><span class="p">(</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span>
<span class="w">        </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HelloWorld</span>::<span class="n">instantiate</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">linker</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Note that the `demo` method returns a `&amp;Demo` through which we can</span>
<span class="w">    </span><span class="c1">// run the methods on that interface.</span>
<span class="w">    </span><span class="n">bindings</span><span class="p">.</span><span class="n">demo</span><span class="p">().</span><span class="n">call_run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div>
<p>If <code>MyState</code> here is instead <code>MyState&lt;'render&gt;</code> (in my case, MyState owns an <code>Option&lt;wgpu::RenderPass&lt;'render&gt;&gt;</code>), the bindgen macro generates a trait which is implemented like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="n">HostGpuCommandEncoder</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">WizardRuntimeState</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">begin_render_pass</span><span class="o">&lt;'</span><span class="na">life0</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="na">async_trait</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">life0</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">self_</span>: <span class="nc">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuCommandEncoder</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">descriptor</span>: <span class="nc">GpuRenderPassDescriptor</span><span class="p">)</span><span class="w"> </span>-&gt;  ::<span class="n">core</span>::<span class="n">pin</span>::<span class="n">Pin</span><span class="o">&lt;</span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">future</span>::<span class="n">Future</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuRenderPassEncoder</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="o">+'</span><span class="na">async_trait</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">'</span><span class="na">life0</span>: <span class="o">'</span><span class="na">async_trait</span><span class="p">,</span><span class="w"> </span><span class="bp">Self</span>:<span class="o">'</span><span class="na">async_trait</span> <span class="p">{</span>
</code></pre></div>
<p>but here, Rust is unable to assume that <code>'life0</code> outlives <code>'render</code> and I cannot specify it as <code>'life0: 'render</code> because that's a stricter requirement than the trait.</p>
</blockquote>



<a name="393334242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393334242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393334242">(Sep 26 2023 at 21:38)</a>:</h4>
<p>lwansbrough <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736337788">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>I guess I do have one follow up @alexcrichton -- specifying that the lifetime of self (<code>'life0</code>, defined by the async_trait) is longer than <code>'render</code> fixes the problem, which I think is how I need to define the lifetime relationship (the global state lifetime outlives the lifetime of the render call.) If you remove the wasmtime trait, this code is valid. But wasmtime doesn't allow it because there is no way to specify <code>'life0: 'render</code>. There may be an alternative way to configure this struct but as it stands, wasmtime is indeed getting in the way here.</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">life0</span>: <span class="o">'</span><span class="na">render</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="n">MyState</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">life0</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">render_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">render_state</span><span class="p">.</span><span class="n">as_mut</span><span class="p">().</span><span class="n">expect</span><span class="p">(</span><span class="s">"Render state"</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">render_state</span><span class="p">.</span><span class="n">command_encoders</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">render_pass_encoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="p">.</span><span class="n">encoder</span><span class="p">.</span><span class="n">begin_render_pass</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wgpu</span>::<span class="n">RenderPassDescriptor</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">label</span>: <span class="nb">None</span><span class="p">,</span>
<span class="w">            </span><span class="n">color_attachments</span>: <span class="kp">&amp;</span><span class="p">[],</span>
<span class="w">            </span><span class="n">depth_stencil_attachment</span>: <span class="nb">None</span>
        <span class="p">});</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">pass_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command_encoder_state</span><span class="p">.</span><span class="n">render_passes</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">render_pass_encoder</span><span class="p">);</span>

<span class="w">        </span><span class="n">wasmtime</span>::<span class="nb">Result</span>::<span class="nb">Ok</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">_bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="393334243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393334243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393334243">(Sep 26 2023 at 21:38)</a>:</h4>
<p>lwansbrough reopened <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Consider the example from the bindgen docs:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="o">*</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="p">{</span><span class="n">Config</span><span class="p">,</span><span class="w"> </span><span class="n">Engine</span><span class="p">,</span><span class="w"> </span><span class="n">Store</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="p">;</span>

<span class="n">bindgen</span><span class="o">!</span><span class="p">();</span>

<span class="k">struct</span> <span class="nc">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Note that the trait here is per-interface and within a submodule now.</span>
<span class="k">impl</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">rand</span>::<span class="n">thread_rng</span><span class="p">().</span><span class="n">gen</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Config</span>::<span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">wasm_component_model</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Engine</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Component</span>::<span class="n">from_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="s">"./your-component.wasm"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linker</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">);</span>
<span class="w">    </span><span class="n">HelloWorld</span>::<span class="n">add_to_linker</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">MyState</span><span class="o">|</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Store</span>::<span class="n">new</span><span class="p">(</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span>
<span class="w">        </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HelloWorld</span>::<span class="n">instantiate</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">linker</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Note that the `demo` method returns a `&amp;Demo` through which we can</span>
<span class="w">    </span><span class="c1">// run the methods on that interface.</span>
<span class="w">    </span><span class="n">bindings</span><span class="p">.</span><span class="n">demo</span><span class="p">().</span><span class="n">call_run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div>
<p>If <code>MyState</code> here is instead <code>MyState&lt;'render&gt;</code> (in my case, MyState owns an <code>Option&lt;wgpu::RenderPass&lt;'render&gt;&gt;</code>), the bindgen macro generates a trait which is implemented like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="n">HostGpuCommandEncoder</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">WizardRuntimeState</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">begin_render_pass</span><span class="o">&lt;'</span><span class="na">life0</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="na">async_trait</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">life0</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">self_</span>: <span class="nc">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuCommandEncoder</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">descriptor</span>: <span class="nc">GpuRenderPassDescriptor</span><span class="p">)</span><span class="w"> </span>-&gt;  ::<span class="n">core</span>::<span class="n">pin</span>::<span class="n">Pin</span><span class="o">&lt;</span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">future</span>::<span class="n">Future</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuRenderPassEncoder</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="o">+'</span><span class="na">async_trait</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">'</span><span class="na">life0</span>: <span class="o">'</span><span class="na">async_trait</span><span class="p">,</span><span class="w"> </span><span class="bp">Self</span>:<span class="o">'</span><span class="na">async_trait</span> <span class="p">{</span>
</code></pre></div>
<p>but here, Rust is unable to assume that <code>'life0</code> outlives <code>'render</code> and I cannot specify it as <code>'life0: 'render</code> because that's a stricter requirement than the trait.</p>
</blockquote>



<a name="393334975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393334975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393334975">(Sep 26 2023 at 21:45)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736345040">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Unfortunately while that works and passes the compiler it is not possible to actually call that function. <code>'life0: 'render</code> can be thought of "<code>'life0</code> outlives <code>'render</code>". In your object first though <code>'render</code> must exist first because that's used to create <code>MyState</code>. Afterwards <code>MyState</code> is then borrowed with <code>'life0</code> which is guaranteed to be shorter than <code>'render</code>. That ends up meaning that even if you could write that down it would be impossible to safely call.</p>
</blockquote>



<a name="393335744"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393335744" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393335744">(Sep 26 2023 at 21:51)</a>:</h4>
<p>lwansbrough <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736351539">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p><span aria-label="oh no" class="emoji emoji-1f615" role="img" title="oh no">:oh_no:</span> I think I'd rather deal with use after free bugs... Thank you for the explanation and I understand that this out of scope for wasmtime so I appreciate you taking the time to make that clear to me.</p>
</blockquote>



<a name="393335745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393335745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393335745">(Sep 26 2023 at 21:51)</a>:</h4>
<p>lwansbrough closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>Consider the example from the bindgen docs:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="o">*</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="p">{</span><span class="n">Config</span><span class="p">,</span><span class="w"> </span><span class="n">Engine</span><span class="p">,</span><span class="w"> </span><span class="n">Store</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">my</span>::<span class="n">project</span>::<span class="n">host</span>::<span class="n">Host</span><span class="p">;</span>

<span class="n">bindgen</span><span class="o">!</span><span class="p">();</span>

<span class="k">struct</span> <span class="nc">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Note that the trait here is per-interface and within a submodule now.</span>
<span class="k">impl</span><span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">gen_random_integer</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="kt">u32</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">rand</span>::<span class="n">thread_rng</span><span class="p">().</span><span class="n">gen</span><span class="p">())</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">sha256</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Config</span>::<span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">wasm_component_model</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Engine</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Component</span>::<span class="n">from_file</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="s">"./your-component.wasm"</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linker</span>::<span class="n">new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">engine</span><span class="p">);</span>
<span class="w">    </span><span class="n">HelloWorld</span>::<span class="n">add_to_linker</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">state</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">MyState</span><span class="o">|</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Store</span>::<span class="n">new</span><span class="p">(</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">engine</span><span class="p">,</span>
<span class="w">        </span><span class="n">MyState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HelloWorld</span>::<span class="n">instantiate</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">component</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">linker</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Note that the `demo` method returns a `&amp;Demo` through which we can</span>
<span class="w">    </span><span class="c1">// run the methods on that interface.</span>
<span class="w">    </span><span class="n">bindings</span><span class="p">.</span><span class="n">demo</span><span class="p">().</span><span class="n">call_run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">store</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div>
<p>If <code>MyState</code> here is instead <code>MyState&lt;'render&gt;</code> (in my case, MyState owns an <code>Option&lt;wgpu::RenderPass&lt;'render&gt;&gt;</code>), the bindgen macro generates a trait which is implemented like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="n">HostGpuCommandEncoder</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">WizardRuntimeState</span><span class="o">&lt;'</span><span class="na">render</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">begin_render_pass</span><span class="o">&lt;'</span><span class="na">life0</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="na">async_trait</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">life0</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">self_</span>: <span class="nc">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuCommandEncoder</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">descriptor</span>: <span class="nc">GpuRenderPassDescriptor</span><span class="p">)</span><span class="w"> </span>-&gt;  ::<span class="n">core</span>::<span class="n">pin</span>::<span class="n">Pin</span><span class="o">&lt;</span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">future</span>::<span class="n">Future</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">wasmtime</span>::<span class="n">component</span>::<span class="n">Resource</span><span class="o">&lt;</span><span class="n">GpuRenderPassEncoder</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>::<span class="n">core</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="o">+'</span><span class="na">async_trait</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">'</span><span class="na">life0</span>: <span class="o">'</span><span class="na">async_trait</span><span class="p">,</span><span class="w"> </span><span class="bp">Self</span>:<span class="o">'</span><span class="na">async_trait</span> <span class="p">{</span>
</code></pre></div>
<p>but here, Rust is unable to assume that <code>'life0</code> outlives <code>'render</code> and I cannot specify it as <code>'life0: 'render</code> because that's a stricter requirement than the trait.</p>
</blockquote>



<a name="393338518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393338518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393338518">(Sep 26 2023 at 22:12)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736375413">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>If you're up for it I suspect the wgpu authors would be happy to hear from you and might be able to assist. You may not be the first that wanted to store those two structures next to each other so they may have pointers about how to approach this already.</p>
</blockquote>



<a name="393338638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393338638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393338638">(Sep 26 2023 at 22:13)</a>:</h4>
<p>lwansbrough <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736376366">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>I'll give it a try, thanks again for your help.</p>
</blockquote>



<a name="393340777"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237088%20component-model%3A%20bindgen%20macro%20gen.../near/393340777" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237088.20component-model.3A.20bindgen.20macro.20gen.2E.2E.2E.html#393340777">(Sep 26 2023 at 22:29)</a>:</h4>
<p>lwansbrough edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/7088#issuecomment-1736376366">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7088">issue #7088</a>:</p>
<blockquote>
<p>I'll give it a try, thanks again for your help. Edit: yeah... <a href="https://github.com/gfx-rs/wgpu/issues/1453">https://github.com/gfx-rs/wgpu/issues/1453</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>