<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7596 Replace the preview2 table&#x27;s HashMap ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html">wasmtime / PR #7596 Replace the preview2 table&#x27;s HashMap ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="404686346"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404686346" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404686346">(Nov 28 2023 at 17:49)</a>:</h4>
<p>elliottt opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a> from <code>elliottt:trevor/wasi-table</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Fix the TODO in preview2's table implementation about performance of key generation once the index number space has wrapped; instead of incrementing a u32, store resources in a vector and keep a free queue in the empty slots.<br>
&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="404687971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404687971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404687971">(Nov 28 2023 at 17:59)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>:</p>
<blockquote>
<p>Fix the TODO in preview2's table implementation about performance of key generation once the index space has wrapped; instead of incrementing a u32, store resources in a vector and keep a free queue in the empty slots.<br>
&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="404688434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404688434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404688434">(Nov 28 2023 at 18:01)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404688595"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404688595" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404688595">(Nov 28 2023 at 18:02)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404689240"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404689240" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404689240">(Nov 28 2023 at 18:06)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404694557"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404694557" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404694557">(Nov 28 2023 at 18:42)</a>:</h4>
<p><strong>elliottt</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a> as ready for review.</p>



<a name="404694572"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404694572" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404694572">(Nov 28 2023 at 18:42)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404694575"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404694575" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404694575">(Nov 28 2023 at 18:42)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404694612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404694612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404694612">(Nov 28 2023 at 18:42)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404700179"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404700179" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404700179">(Nov 28 2023 at 19:11)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404715855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404715855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404715855">(Nov 28 2023 at 20:51)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1753912560">PR review</a>:</p>
<blockquote>
<p>Looks good to me. Thank you</p>
</blockquote>



<a name="404715856"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404715856" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404715856">(Nov 28 2023 at 20:51)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1753912560">PR review</a>:</p>
<blockquote>
<p>Looks good to me. Thank you</p>
</blockquote>



<a name="404715859"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404715859" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404715859">(Nov 28 2023 at 20:51)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1408406361">PR review comment</a>:</p>
<blockquote>
<p>I don't have an intuition for what a good magic number for capacity is. @alexcrichton any guesses?</p>
</blockquote>



<a name="404725553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404725553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404725553">(Nov 28 2023 at 21:52)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1754008748">PR review</a>:</p>
<blockquote>
<p>I've got some thoughts on possibly simplifying this a bit, but overall looks good!</p>
</blockquote>



<a name="404725554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404725554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404725554">(Nov 28 2023 at 21:52)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1754008748">PR review</a>:</p>
<blockquote>
<p>I've got some thoughts on possibly simplifying this a bit, but overall looks good!</p>
</blockquote>



<a name="404725557"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404725557" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404725557">(Nov 28 2023 at 21:52)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1408461857">PR review comment</a>:</p>
<blockquote>
<p>Lots of methods here have <code>_</code> as a suffix, and while that was used for some prior that was only done when there's a <code>pub</code> method with the same name and the <code>_</code>-version erases generics effectively. Could the <code>_</code> be removed when that's not necessary?</p>
</blockquote>



<a name="404725558"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404725558" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404725558">(Nov 28 2023 at 21:52)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1408458416">PR review comment</a>:</p>
<blockquote>
<p>Could <code>with_capacity</code> be removed and this start as an empty vec? I'm not sure if there's much to gain from <code>with_capacity</code> really other than letting default heuristics take over.</p>
</blockquote>



<a name="404725559"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404725559" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404725559">(Nov 28 2023 at 21:52)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1408460335">PR review comment</a>:</p>
<blockquote>
<p>Could this perhaps become just <code>free_head</code>? Currently this looks like a FIFO list but changing it to LIFO I think is ok as well and removes the amount of state to manage here.</p>
</blockquote>



<a name="404725560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404725560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404725560">(Nov 28 2023 at 21:52)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1408463506">PR review comment</a>:</p>
<blockquote>
<p>I was naively expecting a slab-like allocator when taking a look at this, which wouldn't have this branch. Could this perhaps be removed to help simplify this a bit further?</p>
</blockquote>



<a name="404907535"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404907535" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404907535">(Nov 29 2023 at 16:42)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755754554">PR review</a>.</p>



<a name="404907536"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404907536" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404907536">(Nov 29 2023 at 16:42)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409583977">PR review comment</a>:</p>
<blockquote>
<p>My thought here was that it would be good to allow a bit of control so that embedders could make that decision depending on their workloads. Perhaps that's over-estimating the cost of reallocating the vector though.</p>
</blockquote>



<a name="404907901"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404907901" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404907901">(Nov 29 2023 at 16:44)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755758326">PR review</a>.</p>



<a name="404907903"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404907903" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404907903">(Nov 29 2023 at 16:44)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409586392">PR review comment</a>:</p>
<blockquote>
<p>Yep, that's fine. I made it a LIFO after discussing this refactoring with @jameysharp. He had a good suggestion, which is that when debugging code that's using resources, it would probably be helpful to have the generated ids look as distinct as possible. Using a LIFO means that we'd see the oldest free'd id reused first when logging, rather than potentially seeing a lot of churn on the most recent one.</p>
</blockquote>



<a name="404907976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404907976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404907976">(Nov 29 2023 at 16:44)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755759314">PR review</a>.</p>



<a name="404907977"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404907977" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404907977">(Nov 29 2023 at 16:44)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409586905">PR review comment</a>:</p>
<blockquote>
<p>Absolutely, I was just trying to follow the conventions already present.</p>
</blockquote>



<a name="404908257"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404908257" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404908257">(Nov 29 2023 at 16:46)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755762010">PR review</a>.</p>



<a name="404908261"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404908261" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404908261">(Nov 29 2023 at 16:46)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409588566">PR review comment</a>:</p>
<blockquote>
<p>The intent here was to prefer generating new ids, in service of making more debuggable logs. As we've already allocated the space, why not use it and fall back on the free list when it's full?</p>
</blockquote>



<a name="404910515"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404910515" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404910515">(Nov 29 2023 at 16:57)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755784731">PR review</a>.</p>



<a name="404910518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404910518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404910518">(Nov 29 2023 at 16:57)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409603251">PR review comment</a>:</p>
<blockquote>
<p>What do you think about removing <code>push_child_</code>? it's called only by <code>push_child</code> and would inline without issues.</p>
</blockquote>



<a name="404912086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404912086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404912086">(Nov 29 2023 at 17:03)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755797879">PR review</a>.</p>



<a name="404912087"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404912087" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404912087">(Nov 29 2023 at 17:03)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409611558">PR review comment</a>:</p>
<blockquote>
<p>Sounds good to me! Many of these are historical and the artifact of a number of refactorings, so it's definitely ripe for taking the liberty to restructure things while you're here.</p>
</blockquote>



<a name="404912258"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404912258" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404912258">(Nov 29 2023 at 17:04)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755799539">PR review</a>.</p>



<a name="404912259"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404912259" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404912259">(Nov 29 2023 at 17:04)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409612518">PR review comment</a>:</p>
<blockquote>
<p>Ok keeping <code>with_capacity</code> makes sense to me, but I think that <code>new</code> should create with the default 0 capacity of <code>Vec</code> and then <code>with_capacity</code> sets an initial capacity.</p>
</blockquote>



<a name="404912736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404912736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404912736">(Nov 29 2023 at 17:07)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755805084">PR review</a>.</p>



<a name="404912737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404912737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404912737">(Nov 29 2023 at 17:07)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409615753">PR review comment</a>:</p>
<blockquote>
<p>Trevor and I talked a bit on Zulip, and I agree that this would be useful for that form of debugging but I'd personally prefer to stick to a simpler FIFO queue since I think it's not clear whether this form of debugging would be relied on all that much. As an isolated implementation detail it's easy to swap this out in the future, and I'd prefer personally to see the need for such debugging come up first before we go with the slightly fancier LIFO implementation.</p>
<p>It's sort of 6-to-one-half-dozen-or-the-other though so I don't feel too strongly either way, but I do have a preference for the FIFO version. I'm probably biased though b/c that's what I was assuming this was before I read it.</p>
</blockquote>



<a name="404914740"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404914740" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404914740">(Nov 29 2023 at 17:17)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755826791">PR review</a>.</p>



<a name="404914741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404914741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404914741">(Nov 29 2023 at 17:17)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409629408">PR review comment</a>:</p>
<blockquote>
<p>I mixed up my acronyms. Just for the record, I'm going to remove the tail pointer and make this a LIFO, removing the existing FIFO behavior. Sorry about the confusion there :)</p>
</blockquote>



<a name="404915068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404915068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404915068">(Nov 29 2023 at 17:19)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755830409">PR review</a>.</p>



<a name="404915069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404915069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404915069">(Nov 29 2023 at 17:19)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#discussion_r1409631751">PR review comment</a>:</p>
<blockquote>
<p>Oops, I also am appparently forgetting what I was just saying yesterday. Anyway sounds good!</p>
</blockquote>



<a name="404920305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404920305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404920305">(Nov 29 2023 at 17:47)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404920715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404920715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404920715">(Nov 29 2023 at 17:50)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404922889"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404922889" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404922889">(Nov 29 2023 at 18:03)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404924390"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404924390" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404924390">(Nov 29 2023 at 18:12)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<a name="404925563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404925563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404925563">(Nov 29 2023 at 18:20)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7596#pullrequestreview-1755936176">PR review</a>.</p>



<a name="404932954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237596%20Replace%20the%20preview2%20table%27s%20HashMap%20.../near/404932954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237596.20Replace.20the.20preview2.20table.27s.20HashMap.20.2E.2E.2E.html#404932954">(Nov 29 2023 at 19:07)</a>:</h4>
<p>elliottt merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7596">PR #7596</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>