<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4338 Investigate re-integration `wasm-o... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234338.20Investigate.20re-integration.20.60wasm-o.2E.2E.2E.html">wasmtime / issue #4338 Investigate re-integration `wasm-o...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="287631771"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234338%20Investigate%20re-integration%20%60wasm-o.../near/287631771" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234338.20Investigate.20re-integration.20.60wasm-o.2E.2E.2E.html#287631771">(Jun 27 2022 at 20:19)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/issues/4338">issue #4338</a>:</p>
<blockquote>
<p>With <a href="https://github.com/bytecodealliance/wasmtime/issues/4322">https://github.com/bytecodealliance/wasmtime/issues/4322</a> recently I think one thing we could to do help improve our coverage when fuzzing is to re-integrate Binaryen's <code>wasm-opt -ttf</code> fuzzer. The wasm modules coming out of that have a different shape than those of <code>wasm-smith</code> and might be interesting to fuzz in addition to those from <code>wasm-smith</code> for more coverage. </p>
<p>Historically we had this but since removed it for a few reasons:</p>
<ul>
<li>We were using a crate for integration with Binaryen and the crate was somewhat slow to update the submodule, meaning it took quite some time to get fixes from Binaryen in to Wasmtime.</li>
<li>Binaryen itself doesn't run under libfuzzer, but Wasmtime on oss-fuzz compiles it with fuzz options. This means that fuzzing was getting really good at exploring code in the binaryen wasm-module-generator itself and often found paths where binaryen took up too much memory or took too long to generate a wasm module. These are difficult and time consuming to track down for a foreign codebase, however.</li>
<li>At the time we theorized that our coverage wasn't much better than with wasm-smith.</li>
</ul>
<p>It would perhaps be prudent to reevaluate some of these. While the second point likely still stands we could perhaps improve extraction of the random seed and a "reproduction command" to send to upstream binaryen and avoid investigating too much ourselves to avoid adding work to our plates. Specifically the last point may be best empirically evaluated by looking at coverage reports for <code>cranelift-codegen</code> to see how many instructions are hit and how many lowerings are touched.</p>
</blockquote>



<a name="287631772"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234338%20Investigate%20re-integration%20%60wasm-o.../near/287631772" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234338.20Investigate.20re-integration.20.60wasm-o.2E.2E.2E.html#287631772">(Jun 27 2022 at 20:19)</a>:</h4>
<p>alexcrichton labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/4338">issue #4338</a>:</p>
<blockquote>
<p>With <a href="https://github.com/bytecodealliance/wasmtime/issues/4322">https://github.com/bytecodealliance/wasmtime/issues/4322</a> recently I think one thing we could to do help improve our coverage when fuzzing is to re-integrate Binaryen's <code>wasm-opt -ttf</code> fuzzer. The wasm modules coming out of that have a different shape than those of <code>wasm-smith</code> and might be interesting to fuzz in addition to those from <code>wasm-smith</code> for more coverage. </p>
<p>Historically we had this but since removed it for a few reasons:</p>
<ul>
<li>We were using a crate for integration with Binaryen and the crate was somewhat slow to update the submodule, meaning it took quite some time to get fixes from Binaryen in to Wasmtime.</li>
<li>Binaryen itself doesn't run under libfuzzer, but Wasmtime on oss-fuzz compiles it with fuzz options. This means that fuzzing was getting really good at exploring code in the binaryen wasm-module-generator itself and often found paths where binaryen took up too much memory or took too long to generate a wasm module. These are difficult and time consuming to track down for a foreign codebase, however.</li>
<li>At the time we theorized that our coverage wasn't much better than with wasm-smith.</li>
</ul>
<p>It would perhaps be prudent to reevaluate some of these. While the second point likely still stands we could perhaps improve extraction of the random seed and a "reproduction command" to send to upstream binaryen and avoid investigating too much ourselves to avoid adding work to our plates. Specifically the last point may be best empirically evaluated by looking at coverage reports for <code>cranelift-codegen</code> to see how many instructions are hit and how many lowerings are touched.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>