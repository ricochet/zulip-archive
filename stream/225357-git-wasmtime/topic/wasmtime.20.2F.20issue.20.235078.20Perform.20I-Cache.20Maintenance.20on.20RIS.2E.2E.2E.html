<html>
<head><meta charset="utf-8"><title>wasmtime / issue #5078 Perform I-Cache Maintenance on RIS... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html">wasmtime / issue #5078 Perform I-Cache Maintenance on RIS...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="306379749"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/306379749" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#306379749">(Oct 27 2022 at 06:01)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1293034241">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>@afonso360 @bjorn3  I think we are ready.</p>
</blockquote>



<a name="307248215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307248215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307248215">(Nov 01 2022 at 05:14)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1298040508">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>@bjorn3 @afonso360  I think we are ready.</p>
</blockquote>



<a name="307321422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307321422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307321422">(Nov 01 2022 at 14:18)</a>:</h4>
<p>afonso360 <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1298579671">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>This looks correct to me.</p>
</blockquote>



<a name="307439663"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307439663" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307439663">(Nov 02 2022 at 02:23)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1299473261">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>I think I am in favour of store <code>num_cpu</code> in static. @cfallin @bjorn3 @afonso360 </p>
</blockquote>



<a name="307440592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307440592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307440592">(Nov 02 2022 at 02:36)</a>:</h4>
<p>yuyang-ok edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1299473261">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>I think I am in favour of store <code>num_cpu</code> in static. @cfallin @bjorn3 @afonso360 <br>
feature is hard to used.</p>
</blockquote>



<a name="307440710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307440710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307440710">(Nov 02 2022 at 02:38)</a>:</h4>
<p>yuyang-ok edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1299473261">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>I think I am in favour of store <code>num_cpu</code> in static. @cfallin @bjorn3 @afonso360 <br>
feature is hard to use.</p>
</blockquote>



<a name="307459284"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307459284" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307459284">(Nov 02 2022 at 06:50)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1299661405">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>I am having this error.</p>
</blockquote>
<p>yuyang@yuyang-Inspiron-7590:~/projects/wasmtime/crates/jit-icache-coherence$ cargo t    --target   riscv64gc-unknown-linux-gnu <br>
   Compiling wasmtime-jit-icache-coherence v2.0.0 (/home/yuyang/projects/wasmtime/crates/jit-icache-coherence)<br>
error[E0015]: cannot call non-const fn <code>num_cpus::get</code> in statics<br>
  --&gt; crates/jit-icache-coherence/src/libc.rs:12:35<br>
   |<br>
12 | static NUM_CPUS: usize = unsafe { num_cpus::get() };<br>
   |                                   ^^^^^^^^^^^^^^^<br>
   |<br>
   = note: calls in statics are limited to constant functions, tuple structs and tuple variants</p>
<p>For more information about this error, try <code>rustc --explain E0015</code>.<br>
error: could not compile <code>wasmtime-jit-icache-coherence</code> due to previous error<br>
warning: build failed, waiting for other jobs to finish...<br>
error: could not compile <code>wasmtime-jit-icache-coherence</code> due to previous error</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">In</span><span class="w"> </span><span class="n">rust</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="err">`</span><span class="n">lazy_static</span><span class="err">`</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">assign</span><span class="w">  </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="o">??</span><span class="w"></span>
</code></pre></div>



<a name="307470159"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/307470159" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#307470159">(Nov 02 2022 at 08:11)</a>:</h4>
<p>yuyang-ok deleted a <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1299661405">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>I am having this error.</p>
</blockquote>
<p>yuyang@yuyang-Inspiron-7590:~/projects/wasmtime/crates/jit-icache-coherence$ cargo t    --target   riscv64gc-unknown-linux-gnu <br>
   Compiling wasmtime-jit-icache-coherence v2.0.0 (/home/yuyang/projects/wasmtime/crates/jit-icache-coherence)<br>
error[E0015]: cannot call non-const fn <code>num_cpus::get</code> in statics<br>
  --&gt; crates/jit-icache-coherence/src/libc.rs:12:35<br>
   |<br>
12 | static NUM_CPUS: usize = unsafe { num_cpus::get() };<br>
   |                                   ^^^^^^^^^^^^^^^<br>
   |<br>
   = note: calls in statics are limited to constant functions, tuple structs and tuple variants</p>
<p>For more information about this error, try <code>rustc --explain E0015</code>.<br>
error: could not compile <code>wasmtime-jit-icache-coherence</code> due to previous error<br>
warning: build failed, waiting for other jobs to finish...<br>
error: could not compile <code>wasmtime-jit-icache-coherence</code> due to previous error</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">In</span><span class="w"> </span><span class="n">rust</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="err">`</span><span class="n">lazy_static</span><span class="err">`</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">assign</span><span class="w">  </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="o">??</span><span class="w"></span>
</code></pre></div>



<a name="310532550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/310532550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#310532550">(Nov 17 2022 at 01:45)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1317937277">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>@bjorn3 @afonso360 @alexcrichton @cfallin I think we are ready.</p>
</blockquote>



<a name="325067461"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/325067461" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#325067461">(Feb 01 2023 at 04:38)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1411453457">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>@cfallin  Are we going to merge this or not?</p>
</blockquote>



<a name="325098772"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/325098772" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#325098772">(Feb 01 2023 at 09:03)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1411697212">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>@cfallin Yeah,I can rebase.:-)</p>
</blockquote>



<a name="325440152"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235078%20Perform%20I-Cache%20Maintenance%20on%20RIS.../near/325440152" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235078.20Perform.20I-Cache.20Maintenance.20on.20RIS.2E.2E.2E.html#325440152">(Feb 02 2023 at 16:23)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/5078#issuecomment-1414012843">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5078">issue #5078</a>:</p>
<blockquote>
<p>@yuyang-ok unfortunately this seems to be failing a number of tests now -- bad merge?</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>