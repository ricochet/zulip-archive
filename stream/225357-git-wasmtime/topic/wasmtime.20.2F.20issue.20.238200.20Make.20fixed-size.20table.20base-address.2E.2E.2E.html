<html>
<head><meta charset="utf-8"><title>wasmtime / issue #8200 Make fixed-size table base-address... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238200.20Make.20fixed-size.20table.20base-address.2E.2E.2E.html">wasmtime / issue #8200 Make fixed-size table base-address...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="428028106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238200%20Make%20fixed-size%20table%20base-address.../near/428028106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238200.20Make.20fixed-size.20table.20base-address.2E.2E.2E.html#428028106">(Mar 20 2024 at 22:50)</a>:</h4>
<p><a href="https://github.com/jameysharp">jameysharp</a> added the enhancement label to <a href="https://github.com/bytecodealliance/wasmtime/issues/8200">Issue #8200</a>.</p>



<a name="428028107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238200%20Make%20fixed-size%20table%20base-address.../near/428028107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238200.20Make.20fixed-size.20table.20base-address.2E.2E.2E.html#428028107">(Mar 20 2024 at 22:50)</a>:</h4>
<p><a href="https://github.com/jameysharp">jameysharp</a> added the performance label to <a href="https://github.com/bytecodealliance/wasmtime/issues/8200">Issue #8200</a>.</p>



<a name="428028108"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238200%20Make%20fixed-size%20table%20base-address.../near/428028108" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238200.20Make.20fixed-size.20table.20base-address.2E.2E.2E.html#428028108">(Mar 20 2024 at 22:50)</a>:</h4>
<p><a href="https://github.com/jameysharp">jameysharp</a> added the wasmtime label to <a href="https://github.com/bytecodealliance/wasmtime/issues/8200">Issue #8200</a>.</p>



<a name="428028111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238200%20Make%20fixed-size%20table%20base-address.../near/428028111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238200.20Make.20fixed-size.20table.20base-address.2E.2E.2E.html#428028111">(Mar 20 2024 at 22:50)</a>:</h4>
<p>jameysharp opened <a href="https://github.com/bytecodealliance/wasmtime/issues/8200">issue #8200</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>When a WebAssembly table is declared with a maximum size that equals its minimum size, we should be able to GVN the table's base address, and also hoist loads of the base address out of loops.</p>
<h4>Benefit</h4>
<p>Any time there is a sequence of table accesses (<code>table.get</code>, <code>table.set</code>, <code>call_indirect</code>) or a loop of such, this would allow us to remove all the base-address loads after the first one, as well as subsequent address computations for instructions which access the same table element.</p>
<h4>Implementation</h4>
<p>The egraph pass will optimize this for us as long as we add the <code>readonly</code> flag to those loads, but that's only safe if we know that the storage for the table won't be reallocated. We can be sure of that if the table can't grow because its size is fixed.</p>
<h4>Alternatives</h4>
<p>No alternatives besides keeping things as they are.</p>
<p>cc: @cfallin</p>
</blockquote>



<a name="429541027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238200%20Make%20fixed-size%20table%20base-address.../near/429541027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238200.20Make.20fixed-size.20table.20base-address.2E.2E.2E.html#429541027">(Mar 26 2024 at 01:57)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/8200">issue #8200</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>When a WebAssembly table is declared with a maximum size that equals its minimum size, we should be able to GVN the table's base address, and also hoist loads of the base address out of loops.</p>
<h4>Benefit</h4>
<p>Any time there is a sequence of table accesses (<code>table.get</code>, <code>table.set</code>, <code>call_indirect</code>) or a loop of such, this would allow us to remove all the base-address loads after the first one, as well as subsequent address computations for instructions which access the same table element.</p>
<h4>Implementation</h4>
<p>The egraph pass will optimize this for us as long as we add the <code>readonly</code> flag to those loads, but that's only safe if we know that the storage for the table won't be reallocated. We can be sure of that if the table can't grow because its size is fixed.</p>
<h4>Alternatives</h4>
<p>No alternatives besides keeping things as they are.</p>
<p>cc: @cfallin</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>