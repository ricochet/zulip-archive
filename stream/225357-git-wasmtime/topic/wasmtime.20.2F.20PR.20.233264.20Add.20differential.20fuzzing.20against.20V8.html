<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3264 Add differential fuzzing against V8 · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html">wasmtime / PR #3264 Add differential fuzzing against V8</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="251241439"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251241439" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251241439">(Aug 30 2021 at 14:52)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3264">PR #3264</a> from <code>fuzz-v8</code> to <code>main</code>:</p>
<blockquote>
<p>This commit adds a differential fuzzing target to Wasmtime along the<br>
lines of the wasmi and spec interpreters we already have, but with V8<br>
instead. The intention here is that wasmi is unlikely to receive updates<br>
over time (e.g. for SIMD), and the spec interpreter is not suitable for<br>
fuzzing against in general due to its performance characteristics. The<br>
hope is that V8 is indeed appropriate to fuzz against because it's<br>
naturally receiving updates and it also is expected to have good<br>
performance.</p>
<p>Here the <code>rusty_v8</code> crate is used which provides bindings to V8 as well<br>
as precompiled binaries by default. This matches exactly the use case we<br>
need and at least for now I think the <code>rusty_v8</code> crate will be<br>
maintained by the Deno folks as they continue to develop it. If it<br>
becomes an issue though maintaining we can evaluate other options to<br>
have differential fuzzing against.</p>
<p>For now this commit enables the SIMD and bulk-memory feature of<br>
fuzz-target-generation which should enable them to get<br>
differentially-fuzzed with V8 in addition to the compilation fuzzing<br>
we're already getting.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="251252676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251252676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251252676">(Aug 30 2021 at 16:09)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#pullrequestreview-741822069">PR review</a>.</p>



<a name="251252677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251252677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251252677">(Aug 30 2021 at 16:09)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#discussion_r698617410">PR review comment</a>:</p>
<blockquote>
<p>Shouldn't we be comparing <code>v128</code> here and above?</p>
</blockquote>



<a name="251254118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251254118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251254118">(Aug 30 2021 at 16:20)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3264">PR #3264</a> from <code>fuzz-v8</code> to <code>main</code>.</p>



<a name="251254407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251254407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251254407">(Aug 30 2021 at 16:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#pullrequestreview-741834264">PR review</a>.</p>



<a name="251254408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251254408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251254408">(Aug 30 2021 at 16:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#discussion_r698627079">PR review comment</a>:</p>
<blockquote>
<p>Node doesn't, at this time, support v128 values, so if you have a function that returns <code>v128</code>, for example, you get:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">TypeError</span>: <span class="nc">type</span><span class="w"> </span><span class="n">incompatibility</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">transforming</span><span class="w"> </span><span class="n">from</span><span class="o">/</span><span class="n">to</span><span class="w"> </span><span class="n">JS</span><span class="w"></span>
</code></pre></div>
<p>Above this though there's a check with:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="c1">// not supported yet in V8</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">ty</span><span class="p">.</span><span class="n">params</span><span class="p">().</span><span class="n">chain</span><span class="p">(</span><span class="n">ty</span><span class="p">.</span><span class="n">results</span><span class="p">()).</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">t</span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ValType</span>::<span class="n">V128</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">log</span>::<span class="n">trace</span><span class="o">!</span><span class="p">(</span><span class="s">"exported function uses v128, skipping"</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">None</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>to avoid hitting this case by just skipping that fuzzing candidate.</p>
</blockquote>



<a name="251258144"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251258144" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251258144">(Aug 30 2021 at 16:50)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#pullrequestreview-741859339">PR review</a>.</p>



<a name="251258145"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251258145" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251258145">(Aug 30 2021 at 16:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#discussion_r698646974">PR review comment</a>:</p>
<blockquote>
<p>er I should say that it doesn't support v128-in-JS, it only supports v128-in-wasm, so because we can only interact to wasm through JS that's where the limitation comes from</p>
</blockquote>



<a name="251258529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251258529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251258529">(Aug 30 2021 at 16:53)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#pullrequestreview-741862043">PR review</a>.</p>



<a name="251258530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251258530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251258530">(Aug 30 2021 at 16:53)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#discussion_r698649040">PR review comment</a>:</p>
<blockquote>
<p>Ah, I see.</p>
</blockquote>



<a name="251259791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251259791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251259791">(Aug 30 2021 at 17:01)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3264">PR #3264</a> from <code>fuzz-v8</code> to <code>main</code>.</p>



<a name="251260920"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251260920" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251260920">(Aug 30 2021 at 17:08)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#pullrequestreview-741875208">PR review</a>.</p>



<a name="251260923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251260923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251260923">(Aug 30 2021 at 17:08)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#pullrequestreview-741875208">PR review</a>.</p>



<a name="251260924"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251260924" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251260924">(Aug 30 2021 at 17:08)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3264#discussion_r698658946">PR review comment</a>:</p>
<blockquote>
<p>Can you add a comment here that it is the caller's responsibility to ensure that the given wasm won't infinitely loop, since we have no way of adding fuel/timeouts to v8, afaik? Alternatively, in the past I've tried to encode that in the type system by making the oracle a tiny bit less reusable and taking a <code>wasm_smith::Module</code> (or <code>wasm-opt -ttf</code> module in the before times) rather than a raw byte slice.</p>
</blockquote>



<a name="251388779"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251388779" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251388779">(Aug 31 2021 at 13:56)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3264">PR #3264</a> from <code>fuzz-v8</code> to <code>main</code>.</p>



<a name="251395382"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233264%20Add%20differential%20fuzzing%20against%20V8/near/251395382" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233264.20Add.20differential.20fuzzing.20against.20V8.html#251395382">(Aug 31 2021 at 14:34)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3264">PR #3264</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>