<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1134 Use more type-inference to reduce ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231134.20Use.20more.20type-inference.20to.20reduce.20.2E.2E.2E.html">wasmtime / Issue #1134 Use more type-inference to reduce ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="225057910"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231134%20Use%20more%20type-inference%20to%20reduce%20.../near/225057910" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231134.20Use.20more.20type-inference.20to.20reduce.20.2E.2E.2E.html#225057910">(Feb 03 2021 at 18:22)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/1134#issuecomment-772719576">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1134">Issue #1134</a>:</p>
<blockquote>
<p>The new backend framework doesn't use legalizations as much as the old backend framework anymore.</p>
</blockquote>



<a name="225061219"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231134%20Use%20more%20type-inference%20to%20reduce%20.../near/225061219" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231134.20Use.20more.20type-inference.20to.20reduce.20.2E.2E.2E.html#225061219">(Feb 03 2021 at 18:43)</a>:</h4>
<p>cfallin closed <a href="https://github.com/bytecodealliance/wasmtime/issues/1134">Issue #1134</a>:</p>
<blockquote>
<p>Currently, when we have an instruction that requires legalizations for several types, and the legalization is the same modulo the types involved, we'll create one legalization for each type, and will bind the source instruction to the type.</p>
<p>It's actually a shame, because the meta crate implements type inference and can do better than this: for instance, if the instruction you're legalizing accepts types in a set S, then it could be able to generate all the legalizations for types in S as one legalization, and not one per type.</p>
<p>We could switch to use the type inference a bit more. One drawback I can think of is that it would make it harder to find which legalizations handle which types. It's still possible to look at the generated source files, though, so that's a minor problem.</p>
<p>For what it's worth, I've already implemented it, since I thought I found a bug in the type inference code (it was just never triggered, and has existed as long as type inference existed in Cranelift). Branch is <a href="https://github.com/bnjbvr/cranelift/tree/fix-bug-constraints">there</a> and diff of generated code is <a href="https://github.com/bnjbvr/cranelift-compare-gencode/commit/cec74867e8683ca90c8d35d14bf2e03584598e26">there</a>.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>