<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1216 Windows fprs preservation · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html">wasmtime / PR #1216 Windows fprs preservation</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189825213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189825213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189825213">(Mar 05 2020 at 19:05)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369835427" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369835427">PR Review</a>.</p>



<a name="189825214"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189825214" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189825214">(Mar 05 2020 at 19:05)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388499915" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388499915">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>The frame offset is currently being incorrectly stored as 0 in our unwind information (the only ops used until now didn't require it, luckily).</p>
</blockquote>
<p>I'll have to check in on this too.. Broadly this does make sense, yes. I looked at what I think is <a href="http://www.tortall.net/projects/yasm/manual/html/manual.html#objfmt-win64-exception" target="_blank" title="http://www.tortall.net/projects/yasm/manual/html/manual.html#objfmt-win64-exception">the reference</a> for the diagram you included here - do you know how preparing for a the call to <code>B</code> interacts with unwind information? Does Windows require we reserve enough space for the most stack-heavy function call as part of the frame's fixed allocation? (I'm not totally certain we do that, and I'd want to double-check that too)</p>
</blockquote>



<a name="189825414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189825414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189825414">(Mar 05 2020 at 19:07)</a>:</h4>
<p>iximeow edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388499915" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388499915">PR Review Comment</a>.</p>



<a name="189827567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189827567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189827567">(Mar 05 2020 at 19:30)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369852740" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369852740">PR Review</a>.</p>



<a name="189827568"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189827568" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189827568">(Mar 05 2020 at 19:30)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388514833" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388514833">PR Review Comment</a>:</p>
<blockquote>
<p>Yes, Windows does require that the local frame's fixed allocation have the maximum amount of space required for passing arguments on the stack for all function calls made by the function, plus 32 bytes for the shadow space which should always be RSP+0x8 to RSP+0x20 upon entry to the callee.</p>
</blockquote>



<a name="189827854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189827854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189827854">(Mar 05 2020 at 19:33)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388514833" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388514833">PR Review Comment</a>.</p>



<a name="189827926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189827926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189827926">(Mar 05 2020 at 19:34)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388514833" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388514833">PR Review Comment</a>.</p>



<a name="189828722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189828722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189828722">(Mar 05 2020 at 19:42)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369860237" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369860237">PR Review</a>.</p>



<a name="189828724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189828724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189828724">(Mar 05 2020 at 19:42)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668">PR Review Comment</a>:</p>
<blockquote>
<p>Regarding how calling B interacts with the unwind information, it doesn't.  Unwind only concerns itself with unwinding the operations done in the prologue, therefore it is only interested in the register save space and not where any arguments for callees might be stored.  RSP should not adjust (except by a call) after the frame is established unless it's a "dynamic" (alloca) frame, at which point a frame pointer must be used.  Since we're using a frame pointer anyway, we also need that "frame pointer offset" adjustment so that it unwinds from the right base.</p>
<p>What I don't get is why frames with a frame pointer need to be described using this "base address" rather than just treating every unwind operation offset as <em>negative</em> from the frame pointer when there is one and positive from RSP when there is not.  This seems unnecessarily complicated, but I'm sure there's a good reason.</p>
</blockquote>



<a name="189828789"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189828789" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189828789">(Mar 05 2020 at 19:42)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668">PR Review Comment</a>.</p>



<a name="189829118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189829118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189829118">(Mar 05 2020 at 19:46)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668">PR Review Comment</a>.</p>



<a name="189829157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189829157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189829157">(Mar 05 2020 at 19:46)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388520668">PR Review Comment</a>.</p>



<a name="189834760"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189834760" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189834760">(Mar 05 2020 at 20:48)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369902935" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-369902935">PR Review</a>.</p>



<a name="189834761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189834761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189834761">(Mar 05 2020 at 20:48)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388556553" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388556553">PR Review Comment</a>:</p>
<blockquote>
<p>Great, I think we're on the same page now. I really appreciate your help in figuring this out.</p>
</blockquote>



<a name="189852347"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/189852347" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#189852347">(Mar 06 2020 at 00:28)</a>:</h4>
<p>iximeow edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388556553" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r388556553">PR Review Comment</a>.</p>



<a name="190206847"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190206847" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190206847">(Mar 10 2020 at 18:19)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190208997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190208997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190208997">(Mar 10 2020 at 18:38)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372223061" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372223061">PR Review</a>.</p>



<a name="190208998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190208998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190208998">(Mar 10 2020 at 18:38)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390530395" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390530395">PR Review Comment</a>:</p>
<blockquote>
<p>I've finally gotten another tweak that I _think_ makes for the right unwind information. Because we always set up <code>rbp</code> at the start of the function we're kind of limited to producing functions that have a static frame size of 256 or fewer bytes, and unwinding information is requested. I included <a href="https://github.com/bytecodealliance/wasmtime/pull/1216/files#diff-890393297114ccac3e3873180274f04aR329-R332" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216/files#diff-890393297114ccac3e3873180274f04aR329-R332">some checks</a> about this, and because we can get away with a wrong offset so long as no unwind codes need it, this can be scoped down to only impacting functions using callee-save FPRs.</p>
<p>This turns what is a (still open) miscompile corrupting arbitrary caller state into a compiler panic, so I think adding a panic here is still a net improvement.</p>
</blockquote>



<a name="190210650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190210650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190210650">(Mar 10 2020 at 18:53)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190213735"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190213735" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190213735">(Mar 10 2020 at 19:20)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390554990" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390554990">PR Review Comment</a>:</p>
<blockquote>
<p>Why is the static frame size limited to 256 bytes?  The unwind information should only place limits on the offset from the frame pointer to the "base" (i.e. register save area) and not the entire frame size, no?</p>
</blockquote>



<a name="190213736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190213736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190213736">(Mar 10 2020 at 19:20)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372252509" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372252509">PR Review</a>.</p>



<a name="190214033"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190214033" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190214033">(Mar 10 2020 at 19:23)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390554990" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390554990">PR Review Comment</a>.</p>



<a name="190219693"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190219693" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190219693">(Mar 10 2020 at 20:19)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390586203" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390586203">PR Review Comment</a>:</p>
<blockquote>
<p>Since the callee-save region is added after spill slots, it ends up on the lower side of the stack frame, so we need an offset that covers locals and spills, then callee-save FPRs. I fiddled with <code>stack_layout</code> a bit to try keeping callee-save FPRs at the higher side of the stack frame (like the diagram shows) but I couldn't figure out how to get that to work.</p>
</blockquote>



<a name="190219694"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190219694" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190219694">(Mar 10 2020 at 20:19)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372291089" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372291089">PR Review</a>.</p>



<a name="190219976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190219976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190219976">(Mar 10 2020 at 20:22)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190221099"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190221099" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190221099">(Mar 10 2020 at 20:32)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372299762" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372299762">PR Review</a>.</p>



<a name="190221100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190221100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190221100">(Mar 10 2020 at 20:32)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390593267" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390593267">PR Review Comment</a>:</p>
<blockquote>
<p>Ugh.  It sounds like we really need to address how we lay out frames in Cranelift if this is a self-imposed limitation.</p>
<p>I mean we can live with this limitation as a short-term stop gap to get the more important issue of not saving the FPRs (i.e. unblock this PR), but I think we should file a high-priority issue to remove this limitation by always saving registers at higher addresses in the frame than any locals and spills.</p>
</blockquote>



<a name="190221122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190221122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190221122">(Mar 10 2020 at 20:33)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390593267" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390593267">PR Review Comment</a>.</p>



<a name="190223184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190223184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190223184">(Mar 10 2020 at 20:52)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372312993" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372312993">PR Review</a>.</p>



<a name="190223185"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190223185" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190223185">(Mar 10 2020 at 20:52)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390603748" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390603748">PR Review Comment</a>:</p>
<blockquote>
<p>This seems incomplete.</p>
</blockquote>



<a name="190223487"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190223487" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190223487">(Mar 10 2020 at 20:55)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372314935" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372314935">PR Review</a>.</p>



<a name="190223489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190223489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190223489">(Mar 10 2020 at 20:55)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390605294" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390605294">PR Review Comment</a>:</p>
<blockquote>
<p>I was only particularly concerned with verifying that <code>xmm15</code> ends up with an offset that doesn't overlap with shadow space or stack argument space for the called function. I can include the rest of the function's <code>UnwindCode</code> if you'd like, but I figured that got outside the point of this test.</p>
</blockquote>



<a name="190224695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190224695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190224695">(Mar 10 2020 at 21:05)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372321710" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372321710">PR Review</a>.</p>



<a name="190224698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190224698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190224698">(Mar 10 2020 at 21:05)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390611359" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390611359">PR Review Comment</a>:</p>
<blockquote>
<p>I'm good with this but perhaps with a comment explaining why only the first unwind code is validated?</p>
</blockquote>



<a name="190230218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190230218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190230218">(Mar 10 2020 at 21:56)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190236546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190236546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190236546">(Mar 10 2020 at 23:22)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372386200" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372386200">PR Review</a>.</p>



<a name="190236547"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190236547" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190236547">(Mar 10 2020 at 23:22)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372386200" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372386200">PR Review</a>.</p>



<a name="190236548"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190236548" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190236548">(Mar 10 2020 at 23:22)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390666751" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390666751">PR Review Comment</a>:</p>
<blockquote>
<p>This is always true when reached.</p>
</blockquote>



<a name="190257180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190257180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190257180">(Mar 11 2020 at 07:56)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190257424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190257424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190257424">(Mar 11 2020 at 08:00)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372537784" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-372537784">PR Review</a>.</p>



<a name="190257425"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190257425" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190257425">(Mar 11 2020 at 08:00)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390796789" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r390796789">PR Review Comment</a>:</p>
<blockquote>
<p>Yes, this is back to being somewhat wip - wasmtime yielded some new errors I hadn't seen testing only in cranelift. I'd tried setting up a build environment on the Windows machine I have available but ran afoul of link.exe being... wrong? So I just added a bit of logging in the hopes I could figure out what went wrong from just a bit of CI logs. I think I have, and once it's passing I'm going to revert <code>29c6c40 </code>.</p>
</blockquote>



<a name="190310636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190310636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190310636">(Mar 11 2020 at 17:43)</a>:</h4>
<p>pchickey updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190310637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190310637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190310637">(Mar 11 2020 at 17:43)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190560406"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190560406" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190560406">(Mar 13 2020 at 22:09)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190561154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561154">(Mar 13 2020 at 22:18)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190561250"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561250" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561250">(Mar 13 2020 at 22:20)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-374649264" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-374649264">PR Review</a>.</p>



<a name="190561251"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561251" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561251">(Mar 13 2020 at 22:20)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r392511209" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r392511209">PR Review Comment</a>:</p>
<blockquote>
<p>I've made the FPR stack slot an <code>ExplicitSlot</code> rather than <code>SpillSlot</code> because there _is_ some mention of <code>SpillSlot</code> being eligible for certain optimizations in <code>redundant_reload_remover</code>. There shouldn't be redundant reloads from this slot, but <code>ExplicitSlot</code> specifically indicates its use for <code>stack_load</code>/<code>stack_store</code>, which are the intended result of this PR (only not using those here because of encoding constraints that need to be fixed)</p>
</blockquote>



<a name="190561282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561282">(Mar 13 2020 at 22:21)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-374649464" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-374649464">PR Review</a>.</p>



<a name="190561283"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561283" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561283">(Mar 13 2020 at 22:21)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r392511391" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r392511391">PR Review Comment</a>:</p>
<blockquote>
<p>Done - <a href="https://github.com/bytecodealliance/wasmtime/pull/1216/files#diff-f237b61b6e0ae8ac7e42cc2e94fbe7e1R148-R151" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216/files#diff-f237b61b6e0ae8ac7e42cc2e94fbe7e1R148-R151">see here</a></p>
</blockquote>



<a name="190561593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561593">(Mar 13 2020 at 22:25)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-374650905" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-374650905">PR Review</a>.</p>



<a name="190561594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561594">(Mar 13 2020 at 22:25)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r392512596" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r392512596">PR Review Comment</a>:</p>
<blockquote>
<p>(I've reverted <code>29c6c40</code> and the assertion this comment is on is once again a meaningful)</p>
</blockquote>



<a name="190561979"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190561979" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190561979">(Mar 13 2020 at 22:30)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190568067"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190568067" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190568067">(Mar 13 2020 at 23:56)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="190568528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/190568528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#190568528">(Mar 14 2020 at 00:03)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="192056181"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/192056181" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#192056181">(Mar 27 2020 at 17:56)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="192711103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/192711103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#192711103">(Apr 02 2020 at 19:04)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="192718255"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/192718255" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#192718255">(Apr 02 2020 at 20:02)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="192835043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/192835043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#192835043">(Apr 03 2020 at 17:04)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193081434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193081434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193081434">(Apr 06 2020 at 18:22)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388483380" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388483380">PR Review</a>.</p>



<a name="193081435"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193081435" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193081435">(Apr 06 2020 at 18:22)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388483380" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388483380">PR Review</a>.</p>



<a name="193081436"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193081436" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193081436">(Apr 06 2020 at 18:22)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404278770" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404278770">PR Review Comment</a>:</p>
<blockquote>
<p>Can we create a new issue to track the stack layout for CSRs problem and link here instead of the PR?  My concern is only that it's hard to make out what's relevant of a complex PR like this one.</p>
</blockquote>



<a name="193081437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193081437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193081437">(Apr 06 2020 at 18:22)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404294871" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404294871">PR Review Comment</a>:</p>
<blockquote>
<p>Given users might run into this panic on Windows until we fix the underlying issue (granted, without the panic they weren't getting proper register restores or unwind which is a more severe problem), perhaps we should note that this is a known limitation and link to the GitHub issue describing the problem?</p>
</blockquote>



<a name="193092208"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193092208" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193092208">(Apr 06 2020 at 19:51)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388567443" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388567443">PR Review</a>.</p>



<a name="193092210"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193092210" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193092210">(Apr 06 2020 at 19:51)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404347615" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404347615">PR Review Comment</a>:</p>
<blockquote>
<p>Absolutely. That's the third item in my <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#issuecomment-598978800" title="https://github.com/bytecodealliance/wasmtime/pull/1216#issuecomment-598978800">to-do list</a> which I've been waiting for even a preliminary :heavy_check_mark: to actually file.</p>
</blockquote>



<a name="193092302"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193092302" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193092302">(Apr 06 2020 at 19:52)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388567878" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388567878">PR Review</a>.</p>



<a name="193092303"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193092303" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193092303">(Apr 06 2020 at 19:52)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404347955" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404347955">PR Review Comment</a>:</p>
<blockquote>
<p>This is a good idea. I'll add that in once I have an issue filed.</p>
</blockquote>



<a name="193116605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193116605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193116605">(Apr 06 2020 at 23:44)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193153713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153713">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388875665" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388875665">PR Review</a>.</p>



<a name="193153714"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153714" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153714">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404613443" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404613443">PR Review Comment</a>:</p>
<blockquote>
<p>nit: can you expand the date as <code>February 2nd, 2020</code>, please? I read this as "May 2nd", as a European person :)</p>
</blockquote>



<a name="193153716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153716">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388875665" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388875665">PR Review</a>.</p>



<a name="193153717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153717">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404620949" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404620949">PR Review Comment</a>:</p>
<blockquote>
<p>Uh? Do we prefix <code>Vec::new()</code> this way in other places in this file?</p>
</blockquote>



<a name="193153718"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153718" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153718">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404618528" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404618528">PR Review Comment</a>:</p>
<blockquote>
<p>light suggestion: a cheaper alternative which avoids a check below:</p>
<div class="codehilite"><pre><span></span>if let Some(fpr_slot) = fpr_slot {
debug_assert!(csrs.iter(FPR).len() != 0);
</pre></div>


</blockquote>



<a name="193153720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153720">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404615369" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404615369">PR Review Comment</a>:</p>
<blockquote>
<p>(Reopening) Can you add a comment in the code expliciting your conclusion for choosing ExplicitSlot, please?</p>
</blockquote>



<a name="193153721"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153721" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153721">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404620390" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404620390">PR Review Comment</a>:</p>
<blockquote>
<p>Can you copy the comment telling that R11 can be clobbered in any convention?</p>
</blockquote>



<a name="193153722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153722">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404623622" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404623622">PR Review Comment</a>:</p>
<blockquote>
<p>We have a codegen error for implementation limits. Can we return a Result from this function, and return the impl limit reached error in this case, instead of panicking?</p>
<p>(Otherwise, this blocks fuzzing, among other things.)</p>
</blockquote>



<a name="193153723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153723">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404621400" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404621400">PR Review Comment</a>:</p>
<blockquote>
<p>Same possibility to do <code>if let Some(fpr_slot) = fpr_slot { </code> here.</p>
</blockquote>



<a name="193153725"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193153725" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193153725">(Apr 07 2020 at 08:19)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404619320" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404619320">PR Review Comment</a>:</p>
<blockquote>
<p>nit: can you move this definition just before its first use, above the for loop at line 904?</p>
</blockquote>



<a name="193160585"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193160585" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193160585">(Apr 07 2020 at 09:30)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388943839" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388943839">PR Review</a>.</p>



<a name="193160586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193160586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193160586">(Apr 07 2020 at 09:30)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404669091" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404669091">PR Review Comment</a>:</p>
<blockquote>
<p>Oops, yeah I should expand that :)</p>
</blockquote>



<a name="193162314"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193162314" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193162314">(Apr 07 2020 at 09:47)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388956871" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388956871">PR Review</a>.</p>



<a name="193162315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193162315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193162315">(Apr 07 2020 at 09:47)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404679683" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404679683">PR Review Comment</a>:</p>
<blockquote>
<p>I'm curious for @peterhuene's thoughts on this, because #1466 will hopefully land relatively quickly after this does. Does #1466 PR introduce a reason for unwind information to be fallible?</p>
<p>If this is the only reason for an occasional failure, we could make this <code>Result</code> with the understanding that when it stops being <code>Result</code> we can revert this back to a non-Result function. I'm not sure that there's a reason this should be fallible, generally speaking. I only prefer a panic because I see this as something that _should_ be an important issue to resolve promptly, but I realize that might not be very nice to downstream users (including us fuzzing :) ).</p>
</blockquote>



<a name="193163897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193163897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193163897">(Apr 07 2020 at 10:02)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388968318" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388968318">PR Review</a>.</p>



<a name="193163899"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193163899" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193163899">(Apr 07 2020 at 10:02)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404689076" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404689076">PR Review Comment</a>:</p>
<blockquote>
<p>we in fact do not! The fully-qualified <code>Vec</code> reads a bit odd to me too, but I figured we can hoist the <code>use</code> if the number of <code>Vec</code>-referrers goes up to two.</p>
</blockquote>



<a name="193163991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193163991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193163991">(Apr 07 2020 at 10:03)</a>:</h4>
<p>iximeow edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404689076" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404689076">PR Review Comment</a>.</p>



<a name="193164264"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193164264" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193164264">(Apr 07 2020 at 10:06)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388970971" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-388970971">PR Review</a>.</p>



<a name="193164265"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193164265" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193164265">(Apr 07 2020 at 10:06)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404691284" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r404691284">PR Review Comment</a>:</p>
<blockquote>
<p>Or use <code>2020-02-05</code>. (<a href="https://en.wikipedia.org/wiki/ISO_8601]%20format" title="https://en.wikipedia.org/wiki/ISO_8601]%20format">ISO 8601</a></p>
</blockquote>



<a name="193164278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193164278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193164278">(Apr 07 2020 at 10:06)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193169618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193169618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193169618">(Apr 07 2020 at 11:02)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193359596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193359596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193359596">(Apr 08 2020 at 18:26)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390224878" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390224878">PR Review</a>.</p>



<a name="193359597"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193359597" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193359597">(Apr 08 2020 at 18:26)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405726995" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405726995">PR Review Comment</a>:</p>
<blockquote>
<p>Sorry, I missed this notification yesterday.  I think making it <code>Result</code> is a good idea even if this particular platform's implementation will hopefully be infallible once this restriction is lifted.  Other unwind information implementations might be fallible and it can't hurt to have some signature consistency between the functions that create the unwind info.</p>
</blockquote>



<a name="193359896"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193359896" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193359896">(Apr 08 2020 at 18:29)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390226400" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390226400">PR Review</a>.</p>



<a name="193359897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193359897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193359897">(Apr 08 2020 at 18:29)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405728279" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405728279">PR Review Comment</a>:</p>
<blockquote>
<p>Plenty of codgen modules have <code>use alloc::vec::Vec</code>, though, so I wouldn't mind this being lifted to a <code>use</code>.</p>
</blockquote>



<a name="193360137"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193360137" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193360137">(Apr 08 2020 at 18:30)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405728279" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405728279">PR Review Comment</a>.</p>



<a name="193360516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193360516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193360516">(Apr 08 2020 at 18:33)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390229617" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390229617">PR Review</a>.</p>



<a name="193360517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193360517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193360517">(Apr 08 2020 at 18:33)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405730870" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405730870">PR Review Comment</a>:</p>
<blockquote>
<p>Just a reminder to update this to <code>https://github.com/bytecodealliance/wasmtime/issues/1475</code>.</p>
</blockquote>



<a name="193360809"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193360809" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193360809">(Apr 08 2020 at 18:35)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390231210" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390231210">PR Review</a>.</p>



<a name="193360810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193360810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193360810">(Apr 08 2020 at 18:35)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405732174" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r405732174">PR Review Comment</a>:</p>
<blockquote>
<p>@bnjbvr is the new comment sufficient?</p>
</blockquote>



<a name="193425727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193425727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193425727">(Apr 09 2020 at 09:23)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390629827" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-390629827">PR Review</a>.</p>



<a name="193425728"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193425728" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193425728">(Apr 09 2020 at 09:23)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406072992" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406072992">PR Review Comment</a>:</p>
<blockquote>
<p>Yes, looks good, thanks!</p>
</blockquote>



<a name="193501135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193501135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193501135">(Apr 09 2020 at 19:54)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193504672"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193504672" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193504672">(Apr 09 2020 at 20:25)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193505819"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193505819" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193505819">(Apr 09 2020 at 20:34)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193509343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193509343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193509343">(Apr 09 2020 at 21:06)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193510540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193510540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193510540">(Apr 09 2020 at 21:18)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391139452" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391139452">PR Review</a>.</p>



<a name="193510541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193510541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193510541">(Apr 09 2020 at 21:18)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406483378" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406483378">PR Review Comment</a>:</p>
<blockquote>
<p>I've made functions for unwind emission all <code>Result</code>-y. <code>ImplLimitExceeded</code> doesn't describe _which_ limit was exceeded, but I figure for the cases in Windows unwind info it would be very helpful to get some kind of hint, so I moved the panic message into a <code>log::warn</code> as well.</p>
</blockquote>



<a name="193510614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193510614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193510614">(Apr 09 2020 at 21:19)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193521386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193521386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193521386">(Apr 09 2020 at 23:12)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193591357"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193591357" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193591357">(Apr 10 2020 at 16:57)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391547967" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391547967">PR Review</a>.</p>



<a name="193591360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193591360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193591360">(Apr 10 2020 at 16:57)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406846705" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406846705">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>        // No-op by default
        Ok(())
</pre></div>


</blockquote>



<a name="193592060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193592060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193592060">(Apr 10 2020 at 17:02)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406849049" title="https://github.com/bytecodealliance/wasmtime/pull/1216#discussion_r406849049">PR Review Comment</a>:</p>
<blockquote>
<p>oh goodness. thanks :(</p>
</blockquote>



<a name="193592061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193592061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193592061">(Apr 10 2020 at 17:02)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391550719" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391550719">PR Review</a>.</p>



<a name="193592076"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193592076" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193592076">(Apr 10 2020 at 17:02)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<a name="193600385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193600385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193600385">(Apr 10 2020 at 18:15)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391586709" title="https://github.com/bytecodealliance/wasmtime/pull/1216#pullrequestreview-391586709">PR Review</a>.</p>



<a name="193613837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193613837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193613837">(Apr 10 2020 at 20:27)</a>:</h4>
<p>iximeow merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a>.</p>



<a name="193616871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231216%20Windows%20fprs%20preservation/near/193616871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231216.20Windows.20fprs.20preservation.html#193616871">(Apr 10 2020 at 20:57)</a>:</h4>
<p>iximeow edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1216" title="https://github.com/bytecodealliance/wasmtime/pull/1216">PR #1216</a> from <code>windows-fprs-preservation</code> to <code>master</code>:</p>
<blockquote>
<p>Moved from <a href="https://github.com/bytecodealliance/cranelift/pull/1378" title="https://github.com/bytecodealliance/cranelift/pull/1378">https://github.com/bytecodealliance/cranelift/pull/1378</a>.</p>
<ul>
<li>[x] This has been discussed in issue #1177 </li>
<li>[x] A short description: Windows appears to have extended ABI constraints to require callees to save XMM6-XMM15 (see #1177 for links to reference material). This PR adds preserve/restore behavior for those registers.</li>
<li>[x] This PR contains test cases.</li>
<li>[x] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so and/or ping<br>
<code>bnjbvr</code>. The list of suggested reviewers on the right can help you.</li>
</ul>
<p>There were a few unresolved conversations from the original PR that I'll copy below.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>