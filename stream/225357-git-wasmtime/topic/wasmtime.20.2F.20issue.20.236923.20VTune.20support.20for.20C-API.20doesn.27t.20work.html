<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6923 VTune support for C-API doesn&#x27;t work · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236923.20VTune.20support.20for.20C-API.20doesn.27t.20work.html">wasmtime / issue #6923 VTune support for C-API doesn&#x27;t work</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="387906239"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236923%20VTune%20support%20for%20C-API%20doesn%27t%20work/near/387906239" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236923.20VTune.20support.20for.20C-API.20doesn.27t.20work.html#387906239">(Aug 29 2023 at 15:26)</a>:</h4>
<p><a href="https://github.com/rahulchaphalkar">rahulchaphalkar</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/6923">Issue #6923</a>.</p>



<a name="387906242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236923%20VTune%20support%20for%20C-API%20doesn%27t%20work/near/387906242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236923.20VTune.20support.20for.20C-API.20doesn.27t.20work.html#387906242">(Aug 29 2023 at 15:26)</a>:</h4>
<p>rahulchaphalkar opened <a href="https://github.com/bytecodealliance/wasmtime/issues/6923">issue #6923</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Modified <code>examples/gcd.c</code> to utilize C-API as directed <a href="https://docs.wasmtime.dev/examples-profiling-vtune.html">here</a></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Set up our context</span>
<span class="w">  </span><span class="c1">//wasm_engine_new();</span>
<span class="w">  </span><span class="n">wasm_config_t</span><span class="o">*</span><span class="w"> </span><span class="n">wasmtime_configuration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_config_new</span><span class="p">();</span>
<span class="w">  </span><span class="n">wasmtime_config_profiler_set</span><span class="p">(</span><span class="n">wasmtime_configuration</span><span class="p">,</span><span class="w"> </span><span class="n">WASMTIME_PROFILING_STRATEGY_VTUNE</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasm_engine_t</span><span class="w"> </span><span class="o">*</span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasm_engine_new_with_config</span><span class="p">(</span><span class="n">wasmtime_configuration</span><span class="p">);</span>
<span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">engine</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasmtime_store_t</span><span class="w"> </span><span class="o">*</span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_store_new</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">store</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<span class="w">  </span><span class="n">wasmtime_context_t</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wasmtime_store_context</span><span class="p">(</span><span class="n">store</span><span class="p">);</span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<p>Add VTune feature to c-api crate's Cargo.toml <code>wasmtime/crates/c-api/Cargo.toml</code> : </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="n">vtune</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">"wasmtime/vtune"</span><span class="p">]</span>
</code></pre></div>
<p>Build wasmtime-c-api <code>cargo build --release -p wasmtime-c-api --features vtune</code></p>
<p>Build gcd binary : </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">cc</span><span class="w"> </span><span class="n">examples</span><span class="o">/</span><span class="n">gcd</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="err">\</span>
<span class="w">       </span><span class="o">-</span><span class="n">I</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">c</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">include</span><span class="w"> </span><span class="err">\</span>
<span class="w">       </span><span class="o">-</span><span class="n">I</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">c</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">wasm</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">include</span><span class="w"> </span><span class="err">\</span>
<span class="w">       </span><span class="n">target</span><span class="o">/</span><span class="n">release</span><span class="o">/</span><span class="n">libwasmtime</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="err">\</span>
<span class="w">       </span><span class="o">-</span><span class="n">lpthread</span><span class="w"> </span><span class="o">-</span><span class="n">ldl</span><span class="w"> </span><span class="o">-</span><span class="n">lm</span><span class="w"> </span><span class="err">\</span>
<span class="w">       </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">gcd</span>
</code></pre></div>
<p>Now, run the binary by launching it with VTune, from command line it like below -<br>
<code>vtune -collect hotspots -knob sampling-mode=hw -r out_dir ./gcd</code></p>
<h3>Expected Results</h3>
<p>VTune runs to completion with no errors from gcd binary, and then VTune shows [Dynamic Code] module with wasm functions inside it.</p>
<h3>Actual Results</h3>
<p>GCD binary does not run to completion. Normal execution time is a few seconds (I had loops inside of the original gcd.c, tested without vtune hooks) , this one crashes in a second or so with following output from VTune, with data file corrupted.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">vtune</span><span class="w"> </span><span class="o">-</span><span class="n">collect</span><span class="w"> </span><span class="n">hotspots</span><span class="w"> </span><span class="o">-</span><span class="n">knob</span><span class="w"> </span><span class="n">sampling</span><span class="o">-</span><span class="n">mode</span><span class="o">=</span><span class="n">hw</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">vtune</span><span class="o">-</span><span class="n">gcd</span><span class="o">-</span><span class="n">hardcoded2</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">gcd</span><span class="o">-</span><span class="k">mod</span>
<span class="nn">vtune</span>: <span class="nc">Warning</span>: <span class="nc">To</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">hardware</span><span class="w"> </span><span class="n">event</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">sampling</span><span class="p">,</span><span class="w"> </span><span class="n">VTune</span><span class="w"> </span><span class="n">Profiler</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NMI</span><span class="w"> </span><span class="n">watchdog</span><span class="w"> </span><span class="n">timer</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">watchdog</span><span class="w"> </span><span class="n">timer</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">enabled</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">collection</span><span class="w"> </span><span class="n">completes</span><span class="p">.</span>
<span class="n">vtune</span>: <span class="nc">Collection</span><span class="w"> </span><span class="n">started</span><span class="p">.</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">collection</span><span class="p">,</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">CTRL</span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">enter</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="n">window</span>: <span class="nc">vtune</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">oem</span><span class="o">/</span><span class="n">public_repos</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">vtune</span><span class="o">-</span><span class="n">gcd</span><span class="o">-</span><span class="n">hardcoded2</span><span class="w"> </span><span class="o">-</span><span class="n">command</span><span class="w"> </span><span class="n">stop</span><span class="p">.</span>
<span class="n">vtune</span>: <span class="nc">Collection</span><span class="w"> </span><span class="n">stopped</span><span class="p">.</span>
<span class="n">vtune</span>: <span class="nc">Using</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">oem</span><span class="o">/</span><span class="n">public_repos</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">vtune</span><span class="o">-</span><span class="n">gcd</span><span class="o">-</span><span class="n">hardcoded2</span><span class="o">'</span>
<span class="n">vtune</span>: <span class="nc">Executing</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">Loading</span><span class="w"> </span><span class="o">'</span><span class="na">userapicollector</span><span class="o">-</span><span class="mi">2992789</span><span class="o">-</span><span class="mi">09</span><span class="n">cf7a40</span><span class="p">.</span><span class="n">trace</span><span class="o">'</span>
<span class="n">vtune</span>: <span class="nc">Error</span>: <span class="nc">Cannot</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">oem</span><span class="o">/</span><span class="n">public_repos</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">vtune</span><span class="o">-</span><span class="n">gcd</span><span class="o">-</span><span class="n">hardcoded2</span><span class="o">/</span><span class="n">data</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span><span class="n">userapicollector</span><span class="o">-</span><span class="mi">2992789</span><span class="o">-</span><span class="mi">09</span><span class="n">cf7a40</span><span class="p">.</span><span class="n">trace</span><span class="o">'</span><span class="w"> </span><span class="p">(</span><span class="n">Data</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">corrupted</span><span class="p">).</span>
<span class="n">vtune</span>: <span class="nc">Executing</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="mi">19</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">Resolving</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">libittnotify_collector</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: Main branch, commit <code>8efcb9851602287fd07a1a1e91501f51f2653d7e</code></p>
<p>Operating system: Ubuntu</p>
<p>Architecture: x86</p>
<h3>Extra Info</h3>
<ul>
<li>The above failure actually does produce .JIT file in VTune directory.</li>
<li>When no VTune collection is ongoing, and you simply run <code>./gcd</code>, we get the following error</li>
</ul>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w"> </span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">FULL</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">gcd</span>
<span class="n">thread</span><span class="w"> </span><span class="o">'&lt;</span><span class="n">unnamed</span><span class="o">&gt;'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">called</span><span class="w"> </span><span class="err">`</span><span class="nb">Result</span>::<span class="n">unwrap</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="err">`</span><span class="nb">Err</span><span class="err">`</span><span class="w"> </span><span class="n">value</span>: <span class="nc">error</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">notifying</span><span class="w"> </span><span class="n">event</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">profiling</span><span class="o">/</span><span class="n">vtune</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">57</span>:<span class="mi">14</span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">593</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">67</span>:<span class="mi">14</span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">core</span>::<span class="n">result</span>::<span class="n">unwrap_failed</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1651</span>:<span class="mi">5</span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">core</span>::<span class="n">result</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="o">&gt;</span>::<span class="n">unwrap</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">result</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1076</span>:<span class="mi">23</span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">wasmtime_jit</span>::<span class="n">profiling</span>::<span class="n">vtune</span>::<span class="n">State</span>::<span class="n">notify_code</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">profiling</span><span class="o">/</span><span class="n">vtune</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">51</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">wasmtime_jit</span>::<span class="n">profiling</span>::<span class="n">vtune</span>::<span class="n">State</span>::<span class="n">register_function</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">profiling</span><span class="o">/</span><span class="n">vtune</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">78</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">6</span>: <span class="o">&lt;</span><span class="n">wasmtime_jit</span>::<span class="n">profiling</span>::<span class="n">vtune</span>::<span class="n">VTuneAgent</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wasmtime_jit</span>::<span class="n">profiling</span>::<span class="n">ProfilingAgent</span><span class="o">&gt;</span>::<span class="n">register_function</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">profiling</span><span class="o">/</span><span class="n">vtune</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">69</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">wasmtime_jit</span>::<span class="n">profiling</span>::<span class="n">ProfilingAgent</span>::<span class="n">register_module</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">profiling</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">17</span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">wasmtime_jit</span>::<span class="n">instantiate</span>::<span class="n">CompiledModule</span>::<span class="n">register_debug_and_profiling</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">instantiate</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">481</span>:<span class="mi">9</span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">wasmtime_jit</span>::<span class="n">instantiate</span>::<span class="n">CompiledModule</span>::<span class="n">from_artifacts</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">jit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">instantiate</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">468</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_parts_raw</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">module</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">577</span>:<span class="mi">22</span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_parts</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">module</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">568</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">wasmtime</span>::<span class="n">module</span>::<span class="n">Module</span>::<span class="n">from_binary</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">module</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">333</span>:<span class="mi">16</span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">wasmtime_module_new</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">c</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">module</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">140</span>:<span class="mi">9</span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">main</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">gcd</span><span class="p">.</span><span class="n">c</span>:<span class="mi">70</span>:<span class="mi">11</span>

<span class="w">  </span><span class="mi">15</span>: <span class="nc">__libc_start_main</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">glibc</span><span class="o">-</span><span class="n">SzIz7B</span><span class="o">/</span><span class="n">glibc</span><span class="o">-</span><span class="mf">2.31</span><span class="o">/</span><span class="n">csu</span><span class="o">/../</span><span class="n">csu</span><span class="o">/</span><span class="n">libc</span><span class="o">-</span><span class="n">start</span><span class="p">.</span><span class="n">c</span>:<span class="mi">308</span>:<span class="mi">16</span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">_start</span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span>
<span class="n">fatal</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="n">error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initiate</span><span class="w"> </span><span class="n">panic</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="mi">5</span>
<span class="n">Aborted</span><span class="w"> </span><span class="p">(</span><span class="n">core</span><span class="w"> </span><span class="n">dumped</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>Looks somewhat similar to what @abrown reported for CLI <a href="https://github.com/bytecodealliance/wasmtime/issues/5628">https://github.com/bytecodealliance/wasmtime/issues/5628</a></li>
<li></li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>