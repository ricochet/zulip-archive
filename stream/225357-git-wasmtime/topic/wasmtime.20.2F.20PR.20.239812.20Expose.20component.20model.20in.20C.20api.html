<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9812 Expose component model in C api · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html">wasmtime / PR #9812 Expose component model in C api</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="488817965"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488817965" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488817965">(Dec 13 2024 at 11:17)</a>:</h4>
<p>lanfeust69 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a> from <code>klave-network:component_model_c_api</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>The goal is to be able to host wasm components in a wasmtime runtime embedded through the C api.</p>
<p>This was discussed in issue #8036.</p>
<p>Thanks to @rockwotj for the basis of the initial commit, in #7801.</p>
<p>I didn't see tests specific to the c-api, currently only tested through the example (and in our internal use !).</p>
<p>I'm not sure it the sizeable <code>component.rs</code> file should be split...<br>
</p>
</blockquote>



<a name="488817966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488817966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488817966">(Dec 13 2024 at 11:17)</a>:</h4>
<p><strong>lanfeust69</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488817967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488817967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488817967">(Dec 13 2024 at 11:17)</a>:</h4>
<p><strong>lanfeust69</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488834216"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488834216" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488834216">(Dec 13 2024 at 12:56)</a>:</h4>
<p>rockwotj <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2541406668">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<p>Nice work! BTW one of the more complex things I had punted on in my POC was handling resources. From my conversations with @alexcrichton those significantly changed the Rust API when adding them, and might do the same in the C API (although maybe this has changed in the time since I did the POC?). I notice there is no resource support in this PR - it's probably worth a plan for that. At least that was the sentiment prior.</p>
</blockquote>



<a name="488843545"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488843545" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488843545">(Dec 13 2024 at 13:46)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488877127"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488877127" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488877127">(Dec 13 2024 at 16:24)</a>:</h4>
<p>lanfeust69 <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2541806911">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<blockquote>
<p>Nice work! BTW one of the more complex things I had punted on in my POC was handling resources. From my conversations with @alexcrichton those significantly changed the Rust API when adding them, and might do the same in the C API (although maybe this has changed in the time since I did the POC?). I notice there is no resource support in this PR - it's probably worth a plan for that. At least that was the sentiment prior.</p>
</blockquote>
<p>Indeed, having started from your change, and not needing resources on my side, I decided not to support that for now, but I should have made that clear.</p>
<p>I'm currently looking at the CI failures :</p>
<ul>
<li>I've been "fooled" by <code>clang-format</code>, because there is no <code>.clang-format</code> file in the repo, so my default one would be picked up, with a significantly different formatting, and I assumed there was no strict formatting rules for C files.</li>
<li>Not sure if a function only used with some features should be marked <code>#[allow(dead_code)]</code> (which may miss the time it is no longer used) or <code>#[cfg(any(feature = "feature1", feature = "feature2"))]</code> (which gets unwieldy, and may prevent discoverability if useful elsewhere)</li>
<li>CI (reasonably) wants to run the C example for component, but the workaround in <code>component/main.rs</code> is not available, something else is needed.</li>
</ul>
</blockquote>



<a name="488882007"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488882007" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488882007">(Dec 13 2024 at 16:51)</a>:</h4>
<p>lanfeust69 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488882656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488882656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488882656">(Dec 13 2024 at 16:55)</a>:</h4>
<p>lanfeust69 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488883954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488883954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488883954">(Dec 13 2024 at 17:03)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2541874459">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<p>Regarding resources: we'll definitely need to support them eventually, given that they're already used heavily by WASIp2 and beyond; plus they're just really useful in general.  This PR doesn't need to address that, but we should start thinking about what a follow-up PR might look like.</p>
<p>A minimal implementation would include:</p>
<ul>
<li>A way to add new host-implemented resource types to a LinkerInstance, equivalent to <a href="https://docs.rs/wasmtime/latest/wasmtime/component/struct.LinkerInstance.html#method.resource">https://docs.rs/wasmtime/latest/wasmtime/component/struct.LinkerInstance.html#method.resource</a></li>
<li>A C equivalent to (<a href="https://docs.rs/wasmtime/latest/wasmtime/component/struct.ResourceTable.html">https://docs.rs/wasmtime/latest/wasmtime/component/struct.ResourceTable.html</a>) for allocating host resource reps (as <code>uint32_t</code>) and pairing them with resource instances (as <code>void*</code>, which may be cast to the expected type; maybe paired with a type ID for runtime sanity checking)</li>
</ul>
<p>Otherwise, I think it's just a matter of passing the <code>uint32_t</code> reps (representing either host-implemented or guest-implemented resource instances) back and forth between the host and guest, letting Wasmtime handle the details of lifting and lowering.  @alexcrichton does that sound plausible to you?</p>
</blockquote>



<a name="488885964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488885964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488885964">(Dec 13 2024 at 17:14)</a>:</h4>
<p>lanfeust69 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488887231"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488887231" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488887231">(Dec 13 2024 at 17:21)</a>:</h4>
<p>lanfeust69 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>.</p>



<a name="488892991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488892991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488892991">(Dec 13 2024 at 17:54)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2541968504">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<blockquote>
<p>Not sure if a function only used with some features should be marked <code>#[allow(dead_code)]</code> (which may miss the time it is no longer used) or <code>#[cfg(any(feature = "feature1", feature = "feature2"))]</code> (which gets unwieldy, and may prevent discoverability if useful elsewhere)</p>
</blockquote>
<p>We generally prefer the <code>cfg</code>-based approach, even though it can get unweildy, because it provides better compile times and code sizes. Discoverability is not an issue because we build docs for <a href="http://docs.rs">docs.rs</a> with <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasmtime/src/lib.rs#L283"><code>feature(doc_auto_cfg)</code></a> which automatically adds "this method depends on blah feature" to all <code>cfg</code>ed functions.</p>
</blockquote>



<a name="488912866"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912866" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912866">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503060369">PR review</a>:</p>
<blockquote>
<p>Thanks so much for your work here on this! I've left a few comments below, but I want to also gauge a bit on how much time/effort you have for this. This is a pretty big PR and there's quite a lot to bikeshed here, so I'd personally prefer to take this one-piece-at-a-time and perhaps break this PR up into a few smaller PRs. Would you have time for that? For example I'd like to land the "compile a component" first, then perhaps "define a function in a linker and instantiate a component", then "load a function from a component", then finally "call the component function". I realize that it wouldn't actually be useful until the end, but I think it'd help to talk about a piece-at-a-time since this is a pretty major feature being added.</p>
</blockquote>



<a name="488912867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912867">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884432876">PR review comment</a>:</p>
<blockquote>
<p>Could this be moved to <code>conifg.h</code>?</p>
<p>(and also probably gated by <code>WASMTIME_FEATURE_COMPONENT_MODEL</code></p>
</blockquote>



<a name="488912870"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912870" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912870">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884430669">PR review comment</a>:</p>
<blockquote>
<p>Ideally the <code>component-model</code> feature wouldn't necessarily imply <code>cranelift</code>, so would it be ok to gate some functions (e.g. component compilation) behind both features?</p>
</blockquote>



<a name="488912871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912871">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884460573">PR review comment</a>:</p>
<blockquote>
<p>One thing I might recommend if you're up for it is to organize component model support the same way as the core wasm support. For example in the <code>wasmtime</code> crate there's <code>wasmtime::Foo</code> for core wasm things and <code>wasmtime::component::Foo</code> for component-model things, basically everything component-related is in its own namespace. </p>
<p>For the C API we've got <code>wasmtime/foo.h</code> for a specific core-wasm thing and <code>wasmtime.h</code> for "everything core wasm". For components what do you think about <code>wasmtime/component/foo.h</code> for a specific item (e.g. this part here would be <code>wasmtime/component/component.h</code> like <code>wasmtime/module.h</code>) and then there'd be <code>wasmtime/component.h</code> which would include all the component headers.</p>
<p>While this header isn't too too big just yet I could imagine it becoming much larger over time as it supports more features of the component model.</p>
</blockquote>



<a name="488912872"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912872" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912872">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884442300">PR review comment</a>:</p>
<blockquote>
<p>Wasmtime's API doesn't quite reflect this yet but we're moving in a direction where <code>flags</code> is just a 64-bit integer, so I think it's reasonable to go ahead and define this on the C side as a small struct with a <code>uint64_t</code> member</p>
</blockquote>



<a name="488912873"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912873" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912873">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884434267">PR review comment</a>:</p>
<blockquote>
<p>In addition to this <code>#ifdef</code> guard I think this whole file will want to be gated on <code>WASMTIME_FEATURE_COMPONENT_MODEL</code> since it'll otherwise not be available when that feature is disabled.</p>
</blockquote>



<a name="488912874"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912874" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912874">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884473950">PR review comment</a>:</p>
<blockquote>
<p>One thing I might recommend doing here is to match the <code>get_export</code> style from the Rust API where lookup-by-name isn't what's done in the component model exactly but rather it's "lookup within this optional instance this name" which return "an exported thing" and then the "exported thing" can be downcast into a function. That way this can handle nested exports in instances and such.</p>
</blockquote>



<a name="488912875"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912875" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912875">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884466077">PR review comment</a>:</p>
<blockquote>
<p>I'm still only reviewing the header file so far, but I'm a bit confused by this in the sense that a linker at least in Rust doesn't have a "build" operation, it can just always be used to instantiate after an item is added to the linker. Given that I'm not sure what this is doing internally and what the expected contract would be with respect to when callers need to use this in relation to instantiate below?</p>
</blockquote>



<a name="488912876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912876">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884470260">PR review comment</a>:</p>
<blockquote>
<p>Is there a missing <code>wasmtime_component_instance_delete</code>?</p>
</blockquote>



<a name="488912877"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912877" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912877">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884471100">PR review comment</a>:</p>
<blockquote>
<p>Is there a missing <code>wasmtime_component_func_delete</code>?</p>
</blockquote>



<a name="488912885"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488912885" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488912885">(Dec 13 2024 at 20:10)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884461833">PR review comment</a>:</p>
<blockquote>
<p>Could this be removed in favor of a <code>#include &lt;wasmtime/store.h&gt;</code>?</p>
</blockquote>



<a name="488919287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488919287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488919287">(Dec 13 2024 at 20:57)</a>:</h4>
<p>lanfeust69 <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2542352791">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<p>@alexcrichton : Thanks for a very quick first look !</p>
<p>I personally prefer sizeable PR broken down through meaningful commits (because of the logical coupling, an oversight in an earlier PR may only be really visible when used later on), but unfortunately GitHub (as well as GitLab) make the review process much more PR/MR oriented than commit-oriented, which kind of defeats this approach. I'll try to see if I can find a split that makes sense to me (without looking closely, I have a feeling that some of the steps you suggest might be too small, at least compared to others).</p>
<p>I'll try to answer your code-related comments tomorrow. I'm reasonably confident I'll eventually be able to actually address what should be done, though I won't make any promise on the timeline <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span>.</p>
</blockquote>



<a name="488919933"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/488919933" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#488919933">(Dec 13 2024 at 21:00)</a>:</h4>
<p>lanfeust69 <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2542363013">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Not sure if a function only used with some features should be marked <code>#[allow(dead_code)]</code> (which may miss the time it is no longer used) or <code>#[cfg(any(feature = "feature1", feature = "feature2"))]</code> (which gets unwieldy, and may prevent discoverability if useful elsewhere)</p>
</blockquote>
<p>We generally prefer the <code>cfg</code>-based approach, even though it can get unweildy, because it provides better compile times and code sizes. Discoverability is not an issue because we build docs for <a href="http://docs.rs">docs.rs</a> with <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasmtime/src/lib.rs#L283"><code>feature(doc_auto_cfg)</code></a> which automatically adds "this method depends on blah feature" to all <code>cfg</code>ed functions.</p>
</blockquote>
<p>Well, clippy barked at the <code>allow(dead_code)</code> version, so I ended up using the <code>cfg</code>-based version.</p>
</blockquote>



<a name="489000715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489000715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489000715">(Dec 14 2024 at 14:52)</a>:</h4>
<p>lanfeust69 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503897130">PR review</a>.</p>



<a name="489000716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489000716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489000716">(Dec 14 2024 at 14:52)</a>:</h4>
<p>lanfeust69 created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1885087416">PR review comment</a>:</p>
<blockquote>
<p>I tend to favor forward declarations when possible, mostly for build time reasons (more to include is slower, and changes in the included header imply a re-build that could be avoided). What are the reasons for preferring a full <code>#include</code> ?</p>
</blockquote>



<a name="489002181"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489002181" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489002181">(Dec 14 2024 at 15:12)</a>:</h4>
<p>lanfeust69 created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1885092715">PR review comment</a>:</p>
<blockquote>
<p>This was the way I tried to "hide" the difference between <code>Linker</code> and <code>LinkerInstance</code>, the latter didn't seem useful to expose to the C api. But in order to add host functions to the linker, you need the appropriate <code>LinkerInstance</code>, and that can only be created once (through <code>.root()</code> of <code>.instance(name)</code>). An alternative could be to keep the <code>LinkerInstances</code> around in a map, or to provide a lookup mechanism to <code>Linker</code>.</p>
</blockquote>



<a name="489002182"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489002182" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489002182">(Dec 14 2024 at 15:12)</a>:</h4>
<p>lanfeust69 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503900824">PR review</a>.</p>



<a name="489002840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489002840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489002840">(Dec 14 2024 at 15:21)</a>:</h4>
<p>lanfeust69 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503902749">PR review</a>.</p>



<a name="489002841"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489002841" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489002841">(Dec 14 2024 at 15:21)</a>:</h4>
<p>lanfeust69 created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1885095201">PR review comment</a>:</p>
<blockquote>
<p>Unless I missed something (very possible !) these instances are always created inside a store, belong to it, and will be deleted when the store goes down.</p>
</blockquote>



<a name="489003378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489003378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489003378">(Dec 14 2024 at 15:29)</a>:</h4>
<p>lanfeust69 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503905121">PR review</a>.</p>



<a name="489003379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489003379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489003379">(Dec 14 2024 at 15:29)</a>:</h4>
<p>lanfeust69 created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1885097355">PR review comment</a>:</p>
<blockquote>
<p>Possibly, I assumed <code>get_func</code> would return some kind of handle to existing data, but even (not so sure of that looking at the code) there is still the C wrapper to delete.</p>
</blockquote>



<a name="489003458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489003458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489003458">(Dec 14 2024 at 15:30)</a>:</h4>
<p>lanfeust69 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503905212">PR review</a>.</p>



<a name="489003459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489003459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489003459">(Dec 14 2024 at 15:30)</a>:</h4>
<p>lanfeust69 created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1885097481">PR review comment</a>:</p>
<blockquote>
<p>Makes sense, I'll look at this.</p>
</blockquote>



<a name="489004368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489004368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489004368">(Dec 14 2024 at 15:42)</a>:</h4>
<p>lanfeust69 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2503908244">PR review</a>.</p>



<a name="489004369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489004369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489004369">(Dec 14 2024 at 15:42)</a>:</h4>
<p>lanfeust69 created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1885101207">PR review comment</a>:</p>
<blockquote>
<p>Indeed, as this was part of the initial POC I started from, and matched my needs, I didn't look much more at the underlying structures on the Rust side. This may be a bit similar to my attempt to "hide" the <code>LinkerInstance</code>s nested structures within the <code>Linker</code>.</p>
</blockquote>



<a name="489551164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551164">(Dec 17 2024 at 18:49)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2509801301">PR review</a>.</p>



<a name="489551166"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551166" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551166">(Dec 17 2024 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1889054136">PR review comment</a>:</p>
<blockquote>
<p>AFAIK build-time concerns matter a lot for C++ but far less so for C, so I'd prefer to not duplicate definitions because structures like this can change over time.</p>
</blockquote>



<a name="489551374"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551374" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551374">(Dec 17 2024 at 18:50)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2509805300">PR review</a>.</p>



<a name="489551375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551375">(Dec 17 2024 at 18:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1889056120">PR review comment</a>:</p>
<blockquote>
<p>FWIW I think it's fine to change the Rust APIs to better accomodate the C APIs if necessary, but otherwise I'd prefer to keep the two relatively in-sync to make them more managable to maintain, so having a <code>LinkerInstance</code> equivalent in the C API I think would be reasonable (or changing the Rust API to not be based on <code>LinkerInstance</code>)</p>
</blockquote>



<a name="489551433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551433">(Dec 17 2024 at 18:51)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2509806344">PR review</a>.</p>



<a name="489551434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551434">(Dec 17 2024 at 18:51)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1889056719">PR review comment</a>:</p>
<blockquote>
<p>That's true yeah, but as an opaque pointer isn't this allocating something to make it pointer-sized in the implementation?</p>
</blockquote>



<a name="489551579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551579">(Dec 17 2024 at 18:52)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2509808146">PR review</a>.</p>



<a name="489551580"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551580" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551580">(Dec 17 2024 at 18:52)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1889057827">PR review comment</a>:</p>
<blockquote>
<p>Yeah I can see how this works for getting top-level exports, but ideally we'll want to at least set this API design up for extending to the entire component model even if it initially doesn't support it. In that sense I think it'd be good to model the nested instance structure of exports here.</p>
</blockquote>



<a name="489551703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551703">(Dec 17 2024 at 18:53)</a>:</h4>
<p>rockwotj submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#pullrequestreview-2509810956">PR review</a>.</p>



<a name="489551708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551708">(Dec 17 2024 at 18:53)</a>:</h4>
<p>rockwotj created <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1889059209">PR review comment</a>:</p>
<blockquote>
<p>Plus one - C is super cheap to build and this is a trivial amount of just declarations.</p>
</blockquote>



<a name="489551851"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239812%20Expose%20component%20model%20in%20C%20api/near/489551851" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239812.20Expose.20component.20model.20in.20C.20api.html#489551851">(Dec 17 2024 at 18:54)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#issuecomment-2549337510">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9812">PR #9812</a>:</p>
<blockquote>
<p>Personally I'd prefer to split this into separate PRs if you're ok with that because there's a fair amount to discuss here and it's easy to lose track of discussions when it's all in one PR. I agree this is an unfortunate artifact of using github, but there's not a whole lot we can do about that other than work around it.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>