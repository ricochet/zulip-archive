<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5274 bench: benchmark several common WASI ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html">wasmtime / PR #5274 bench: benchmark several common WASI ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="310304125"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310304125" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310304125">(Nov 15 2022 at 22:23)</a>:</h4>
<p>abrown opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5274">PR #5274</a> from <code>bench-wasi</code> to <code>main</code>:</p>
<blockquote>
<p>In order to properly understand the impact of providing thread-safe<br>
implmentations of WASI contexts (<a href="https://github.com/bytecodealliance/wasmtime/issues/5235">https://github.com/bytecodealliance/wasmtime/issues/5235</a>), we need benchmarks that measure<br>
the current performance of WASI calls using Wiggle. This change adds<br>
several common WASI scenarios as WAT files (see <code>benches/wasi/*.wat</code>)<br>
and benchmarks them with <code>criterion</code>. Using <code>criterion</code>'s <code>iter_custom</code>,<br>
the WAT file runs the desired number of benchmark iterations internally<br>
and the total duration of the runs is divided to get the average time<br>
for each loop iteration.</p>
<p>Why WAT? When compiling these benchmarks from Rust to <code>wasm32-wasi</code>, the<br>
output files are large, contain other WASI imports than the desired<br>
ones, and overall it is difficult to tell if we are measuring what we<br>
expect. By hand-writing the WAT, it is (slightly) more clear what each<br>
benchmark is doing.<br>
@<a href="https://github.com/bytecodealliance/wasmtime/commits?author=abrown">abrown</a><br>
abrown committed</p>
</blockquote>



<a name="310304144"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310304144" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310304144">(Nov 15 2022 at 22:23)</a>:</h4>
<p>abrown edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5274">PR #5274</a> from <code>bench-wasi</code> to <code>main</code>:</p>
<blockquote>
<p>In order to properly understand the impact of providing thread-safe<br>
implmentations of WASI contexts (<a href="https://github.com/bytecodealliance/wasmtime/issues/5235">https://github.com/bytecodealliance/wasmtime/issues/5235</a>), we need benchmarks that measure<br>
the current performance of WASI calls using Wiggle. This change adds<br>
several common WASI scenarios as WAT files (see <code>benches/wasi/*.wat</code>)<br>
and benchmarks them with <code>criterion</code>. Using <code>criterion</code>'s <code>iter_custom</code>,<br>
the WAT file runs the desired number of benchmark iterations internally<br>
and the total duration of the runs is divided to get the average time<br>
for each loop iteration.</p>
<p>Why WAT? When compiling these benchmarks from Rust to <code>wasm32-wasi</code>, the<br>
output files are large, contain other WASI imports than the desired<br>
ones, and overall it is difficult to tell if we are measuring what we<br>
expect. By hand-writing the WAT, it is (slightly) more clear what each<br>
benchmark is doing.</p>
</blockquote>



<a name="310305568"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310305568" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310305568">(Nov 15 2022 at 22:33)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5274#pullrequestreview-1181631395">PR review</a>.</p>



<a name="310305569"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310305569" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310305569">(Nov 15 2022 at 22:33)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5274#pullrequestreview-1181631395">PR review</a>.</p>



<a name="310305570"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310305570" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310305570">(Nov 15 2022 at 22:33)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5274#discussion_r1023317390">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>            // `instantiate` for details).
</code></pre></div><br>
</p>
</blockquote>



<a name="310305572"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310305572" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310305572">(Nov 15 2022 at 22:33)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5274#discussion_r1023321989">PR review comment</a>:</p>
<blockquote>
<p>Since all the type parameters are the <code>_</code> wildcard, is the <code>::&lt;_, _, _&gt;</code> necessary? I'd have guessed "no", but I don't know.</p>
</blockquote>



<a name="310314072"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310314072" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310314072">(Nov 15 2022 at 23:40)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5274">PR #5274</a> from <code>bench-wasi</code> to <code>main</code>.</p>



<a name="310314097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310314097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310314097">(Nov 15 2022 at 23:41)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5274#pullrequestreview-1181692639">PR review</a>.</p>



<a name="310314099"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310314099" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310314099">(Nov 15 2022 at 23:41)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/5274#discussion_r1023363096">PR review comment</a>:</p>
<blockquote>
<p>Good point, fixed...</p>
</blockquote>



<a name="310322002"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310322002" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310322002">(Nov 16 2022 at 01:01)</a>:</h4>
<p><strong>abrown</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/5274">PR #5274</a> as ready for review.</p>



<a name="310322089"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235274%20bench%3A%20benchmark%20several%20common%20WASI%20.../near/310322089" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235274.20bench.3A.20benchmark.20several.20common.20WASI.20.2E.2E.2E.html#310322089">(Nov 16 2022 at 01:02)</a>:</h4>
<p>abrown merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5274">PR #5274</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>