<html>
<head><meta charset="utf-8"><title>wasmtime / issue #8955 Overriding `argv[0]` for `wasmtime... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html">wasmtime / issue #8955 Overriding `argv[0]` for `wasmtime...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="451356094"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451356094" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451356094">(Jul 14 2024 at 13:52)</a>:</h4>
<p>whitequark opened <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>I would like it to be possible to override <code>argv[0]</code> for commands executed with <code>wasmtime run</code>. E.g.:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">argv0</span><span class="o">=</span><span class="n">clang</span><span class="o">++</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="n">clang</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">..</span><span class="p">.</span>
</code></pre></div>
<h4>Benefit</h4>
<p>Certain applications use the value of <code>argv[0]</code> to:</p>
<ul>
<li>Dispatch between incompatible code paths (multi-call binaries), e.g. Clang;</li>
<li>Discover location of data via executable-relative paths, e.g. also Clang in some cases.</li>
</ul>
<p>In general I think the path passed to <code>wasmtime run</code> is only meaningful on the host and will rarely if ever mean anything within the sandbox.</p>
<h4>Implementation</h4>
<p>A new option <code>--argv0=</code> would work for me, but really anything that gets the job done is fine.</p>
<h4>Alternatives</h4>
<p>I can't think of any besides not having the functionality.</p>
</blockquote>



<a name="451356115"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451356115" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451356115">(Jul 14 2024 at 13:52)</a>:</h4>
<p>whitequark edited <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>I would like it to be possible to override <code>argv[0]</code> for commands executed with <code>wasmtime run</code>. E.g.:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">argv0</span><span class="o">=</span><span class="n">clang</span><span class="o">++</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="n">clang</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">..</span><span class="p">.</span>
</code></pre></div>
<h4>Benefit</h4>
<p>Certain applications use the value of <code>argv[0]</code> to:</p>
<ul>
<li>Dispatch between incompatible code paths (multi-call binaries), e.g. Clang;</li>
<li>Discover location of data via executable-relative paths, e.g. also Clang in some cases (not the usual configuration though).</li>
</ul>
<p>In general I think the path passed to <code>wasmtime run</code> is only meaningful on the host and will rarely if ever mean anything within the sandbox.</p>
<h4>Implementation</h4>
<p>A new option <code>--argv0=</code> would work for me, but really anything that gets the job done is fine.</p>
<h4>Alternatives</h4>
<p>I can't think of any besides not having the functionality.</p>
</blockquote>



<a name="451512434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451512434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451512434">(Jul 15 2024 at 14:22)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/8955#issuecomment-2228628117">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<p>This sounds reasonable to me to implement as well, and I think <code>--argv0</code> is a fine name as well. We already infer it from the provided wasm module so providing the ability to customize that seems like a good idea.</p>
</blockquote>



<a name="451514007"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451514007" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451514007">(Jul 15 2024 at 14:29)</a>:</h4>
<p>whitequark <a href="https://github.com/bytecodealliance/wasmtime/issues/8955#issuecomment-2228643459">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<p>I was going to implement it originally, but unfortunately I lost the direct motivation for this as I've moved to shipping the combined LLVM compiler driver (the <code>llvm</code> command, if you've seen it, as it's a bit obscure... it's like <code>busybox</code>) which takes the command to invoke as <code>argv[1]</code>.</p>
</blockquote>



<a name="451514110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451514110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451514110">(Jul 15 2024 at 14:29)</a>:</h4>
<p>whitequark edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/8955#issuecomment-2228643459">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<p>I was going to implement it originally, but unfortunately I lost the direct motivation for this as I've moved to shipping the combined LLVM compiler driver (the <code>llvm</code> command, if you've seen it, as it's a bit obscure... it's like <code>busybox</code>) which takes the command to invoke as <code>argv[1]</code>. The combined binary is about 25% smaller so it's clearly preferable to ship.</p>
</blockquote>



<a name="451514266"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451514266" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451514266">(Jul 15 2024 at 14:30)</a>:</h4>
<p>whitequark edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/8955#issuecomment-2228643459">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<p>I was going to implement it originally, but unfortunately I lost the direct motivation for this as I've moved to shipping the combined LLVM compiler driver (the <code>llvm</code> command, if you've seen it, as it's a bit obscure... it's like <code>busybox</code> with every single tool compiled into it) which takes the command to invoke as <code>argv[1]</code>. The combined binary is about 25% smaller so it's clearly preferable to ship.</p>
</blockquote>



<a name="451637766"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451637766" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451637766">(Jul 15 2024 at 21:57)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>I would like it to be possible to override <code>argv[0]</code> for commands executed with <code>wasmtime run</code>. E.g.:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">argv0</span><span class="o">=</span><span class="n">clang</span><span class="o">++</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="n">clang</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">..</span><span class="p">.</span>
</code></pre></div>
<h4>Benefit</h4>
<p>Certain applications use the value of <code>argv[0]</code> to:</p>
<ul>
<li>Dispatch between incompatible code paths (multi-call binaries), e.g. Clang;</li>
<li>Discover location of data via executable-relative paths, e.g. also Clang in some cases (not the usual configuration though).</li>
</ul>
<p>In general I think the path passed to <code>wasmtime run</code> is only meaningful on the host and will rarely if ever mean anything within the sandbox.</p>
<h4>Implementation</h4>
<p>A new option <code>--argv0=</code> would work for me, but really anything that gets the job done is fine.</p>
<h4>Alternatives</h4>
<p>I can't think of any besides not having the functionality.</p>
</blockquote>



<a name="451651163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238955%20Overriding%20%60argv%5B0%5D%60%20for%20%60wasmtime.../near/451651163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238955.20Overriding.20.60argv.5B0.5D.60.20for.20.60wasmtime.2E.2E.2E.html#451651163">(Jul 15 2024 at 23:47)</a>:</h4>
<p>whitequark <a href="https://github.com/bytecodealliance/wasmtime/issues/8955#issuecomment-2229630466">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8955">issue #8955</a>:</p>
<blockquote>
<p>Thank you!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>