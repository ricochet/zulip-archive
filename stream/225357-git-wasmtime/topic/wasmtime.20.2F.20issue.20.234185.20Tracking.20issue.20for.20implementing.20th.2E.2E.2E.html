<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4185 Tracking issue for implementing th... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html">wasmtime / issue #4185 Tracking issue for implementing th...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="283784037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283784037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283784037">(May 24 2022 at 18:04)</a>:</h4>
<p>alexcrichton labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] Extracting a function and calling it with a static signature</li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283784039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283784039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283784039">(May 24 2022 at 18:04)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] Extracting a function and calling it with a static signature</li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283784040"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283784040" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283784040">(May 24 2022 at 18:04)</a>:</h4>
<p>alexcrichton labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] Extracting a function and calling it with a static signature</li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283784092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283784092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283784092">(May 24 2022 at 18:04)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] Extracting a function and calling it with a static signature</li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283784795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283784795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283784795">(May 24 2022 at 18:11)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] Extracting a function and calling it with a static signature</li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283785054"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283785054" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283785054">(May 24 2022 at 18:12)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] Extracting a function and calling it with a static signature</li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283785273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283785273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283785273">(May 24 2022 at 18:14)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283796408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283796408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283796408">(May 24 2022 at 19:48)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="283922333"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/283922333" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#283922333">(May 25 2022 at 18:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284244218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284244218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284244218">(May 28 2022 at 19:17)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284246596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284246596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284246596">(May 28 2022 at 20:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Calling a function with a "dynamic" signature</li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284416634"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284416634" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284416634">(May 31 2022 at 00:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for memory64 in adapters and such</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284500478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284500478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284500478">(May 31 2022 at 16:12)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li>How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284500526"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284500526" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284500526">(May 31 2022 at 16:12)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284541010"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284541010" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284541010">(May 31 2022 at 21:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284661999"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284661999" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284661999">(Jun 01 2022 at 20:00)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284894410"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284894410" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284894410">(Jun 03 2022 at 15:33)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[ ] Importing a wasm module into a component</li>
<li>[ ] Exporting a module from a component</li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284894518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284894518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284894518">(Jun 03 2022 at 15:34)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284894648"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284894648" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284894648">(Jun 03 2022 at 15:35)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="284894697"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/284894697" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#284894697">(Jun 03 2022 at 15:35)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] Importing host functions into a component</li>
<li>[ ] Importing host instances (bundles of host functions) into a component</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285135207"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285135207" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285135207">(Jun 06 2022 at 16:22)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285261605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285261605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285261605">(Jun 07 2022 at 14:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285261627"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285261627" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285261627">(Jun 07 2022 at 14:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Split <code>ComponentValue</code> into lifting and lowering traits</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285261669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285261669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285261669">(Jun 07 2022 at 14:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] Validate alignment and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285273720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285273720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285273720">(Jun 07 2022 at 16:00)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285289034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285289034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285289034">(Jun 07 2022 at 17:47)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] Implement may_enter and may_leave flags</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285290142"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285290142" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285290142">(Jun 07 2022 at 17:55)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="285290153"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/285290153" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#285290153">(Jun 07 2022 at 17:55)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
</ul>
</blockquote>



<a name="286507503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286507503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286507503">(Jun 17 2022 at 15:45)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286507860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286507860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286507860">(Jun 17 2022 at 15:48)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] Nested component compilation</li>
<li>[ ] Nested component instantiation</li>
<li>[ ] Outer component aliases</li>
<li>[ ] Exporting a component from a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286524529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286524529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286524529">(Jun 17 2022 at 18:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286524538"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286524538" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286524538">(Jun 17 2022 at 18:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286524546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286524546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286524546">(Jun 17 2022 at 18:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286524549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286524549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286524549">(Jun 17 2022 at 18:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286524550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286524550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286524550">(Jun 17 2022 at 18:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286954469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286954469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286954469">(Jun 21 2022 at 18:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286954475"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286954475" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286954475">(Jun 21 2022 at 18:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286954479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286954479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286954479">(Jun 21 2022 at 18:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286954486"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286954486" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286954486">(Jun 21 2022 at 18:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286966262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286966262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286966262">(Jun 21 2022 at 19:54)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="286966287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/286966287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#286966287">(Jun 21 2022 at 19:54)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Post-return functions</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287104917"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287104917" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287104917">(Jun 22 2022 at 19:57)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Confirm lowered-then-lifted interpretation of "always trap" is correct</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287105003"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287105003" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287105003">(Jun 22 2022 at 19:58)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110522">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110540">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110548"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110548" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110548">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110556"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110556" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110556">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110560">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110593">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110605">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110658">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110678"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110678" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110678">(Jun 22 2022 at 20:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Exporting a component instance from the root of a component</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110775">(Jun 22 2022 at 20:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110781">(Jun 22 2022 at 20:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287110800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287110800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287110800">(Jun 22 2022 at 20:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287117650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287117650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287117650">(Jun 22 2022 at 21:42)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287231154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287231154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287231154">(Jun 23 2022 at 18:35)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Fuzz interface functions: <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">https://github.com/bytecodealliance/wasmtime/issues/4307</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287238172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287238172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287238172">(Jun 23 2022 at 19:37)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] String support for utf16+latin1 (omitted from #4039)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Support for <code>record</code> types</li>
<li>[ ] Support for <code>variant</code> types</li>
<li>[ ] Support for <code>enum</code> types</li>
<li>[ ] Support for <code>union</code> types</li>
<li>[ ] Support for <code>flags</code> types</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Fuzz interface functions: <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">https://github.com/bytecodealliance/wasmtime/issues/4307</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287262672"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287262672" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287262672">(Jun 23 2022 at 21:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Fuzz interface functions: <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">https://github.com/bytecodealliance/wasmtime/issues/4307</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Calling a function with a dynamic signature</li>
<li>Defining a host function with a dynamic signature</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287263224"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287263224" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287263224">(Jun 23 2022 at 21:52)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287263831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287263831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287263831">(Jun 23 2022 at 21:57)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with lowering a lifted function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Implement components with 64-bit memories</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287595750"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287595750" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287595750">(Jun 27 2022 at 15:39)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and enable <code>&amp;[u64]</code> views and similar</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287602736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287602736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287602736">(Jun 27 2022 at 16:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287602748"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287602748" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287602748">(Jun 27 2022 at 16:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287602751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287602751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287602751">(Jun 27 2022 at 16:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287602758"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287602758" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287602758">(Jun 27 2022 at 16:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287731823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287731823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287731823">(Jun 28 2022 at 15:24)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287732036"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287732036" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287732036">(Jun 28 2022 at 15:25)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287732047"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287732047" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287732047">(Jun 28 2022 at 15:25)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287758013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287758013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287758013">(Jun 28 2022 at 18:37)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287758019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287758019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287758019">(Jun 28 2022 at 18:37)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287758154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287758154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287758154">(Jun 28 2022 at 18:38)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287758162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287758162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287758162">(Jun 28 2022 at 18:38)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[ ] Figure out what to do with a lifting a lowered function</li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287762481"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287762481" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287762481">(Jun 28 2022 at 19:11)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Figure out what to do with reexporting an imported function</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
</ul>
</blockquote>



<a name="287769414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287769414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287769414">(Jun 28 2022 at 20:08)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="287769916"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287769916" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287769916">(Jun 28 2022 at 20:13)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="287872743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287872743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287872743">(Jun 29 2022 at 15:32)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="287872761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287872761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287872761">(Jun 29 2022 at 15:32)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
</ul>
<h3>Items related to memory64 support</h3>
<ul>
<li>Need to call <code>realloc</code> with a different signature</li>
<li>All reads/writes of pointers to linear memory need to have a 32/64 bit switch</li>
<li>Reading and writing pointers to <code>ValRaw</code> needs to be audited</li>
<li>Size and alignment calculations all need to be duplicated or have a parameter for 64 bit </li>
<li>Somehow should probably confirm that this doesn't vastly affect performance for 32-bit</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="287878300"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287878300" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287878300">(Jun 29 2022 at 16:05)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[ ] Implement a "lock" for instances for when a trap happens (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="287886612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287886612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287886612">(Jun 29 2022 at 17:06)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="287935740"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/287935740" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#287935740">(Jun 29 2022 at 21:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[ ] Exporting a component instance from the root of a component</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="288214240"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/288214240" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#288214240">(Jul 01 2022 at 19:24)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="288542314"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/288542314" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#288542314">(Jul 05 2022 at 14:59)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[ ] Fill out <code>unimplemented!</code> for outer core aliases</li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="288582441"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/288582441" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#288582441">(Jul 05 2022 at 19:37)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="289208855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/289208855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#289208855">(Jul 11 2022 at 15:35)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="289208880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/289208880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#289208880">(Jul 11 2022 at 15:35)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="289263058"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/289263058" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#289263058">(Jul 11 2022 at 23:38)</a>:</h4>
<p>Jeffwan <a href="https://github.com/bytecodealliance/wasmtime/issues/4185#issuecomment-1181093669">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>Hi, do we have a rough estimate on the component-model release? I am trying to understand even there's some pending items, is it working now?  Is there a quickstart guidance on the usage? </p>
</blockquote>



<a name="289320286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/289320286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#289320286">(Jul 12 2022 at 13:07)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/4185#issuecomment-1181738284">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>There's no esimate at this time. Some parts work but not all, the un-finished issues above should give an idea of how much is left to do. No documentation on usage yet.</p>
</blockquote>



<a name="289484971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/289484971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#289484971">(Jul 13 2022 at 16:27)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li>Type imports </li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="290394433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/290394433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#290394433">(Jul 21 2022 at 15:53)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="290801086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/290801086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#290801086">(Jul 25 2022 at 18:39)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="290801094"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/290801094" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#290801094">(Jul 25 2022 at 18:39)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291367512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291367512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291367512">(Jul 29 2022 at 19:01)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] Fix support for zero-sized flags.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291369699"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291369699" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291369699">(Jul 29 2022 at 19:21)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291628900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291628900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291628900">(Aug 01 2022 at 20:25)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291628961"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291628961" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291628961">(Aug 01 2022 at 20:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291628971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291628971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291628971">(Aug 01 2022 at 20:26)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291859602"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291859602" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291859602">(Aug 03 2022 at 14:42)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="291859664"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/291859664" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#291859664">(Aug 03 2022 at 14:42)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Fix support for zero-sized lists/strings/types</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292055873"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292055873" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292055873">(Aug 04 2022 at 19:11)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Fix support for zero-sized lists/strings/types</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292166818"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292166818" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292166818">(Aug 05 2022 at 15:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Fix support for zero-sized lists/strings/types</li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292471264"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292471264" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292471264">(Aug 08 2022 at 17:25)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Fix support for zero-sized lists/strings/types</li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292494207"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292494207" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292494207">(Aug 08 2022 at 20:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Fix support for zero-sized lists/strings/types</li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292494215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292494215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292494215">(Aug 08 2022 at 20:46)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Fix support for zero-sized lists/strings/types</li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292499732"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292499732" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292499732">(Aug 08 2022 at 21:34)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292499747"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292499747" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292499747">(Aug 08 2022 at 21:34)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292614785"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292614785" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292614785">(Aug 09 2022 at 16:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292614810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292614810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292614810">(Aug 09 2022 at 16:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>
<p>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></p>
</li>
<li>
<p>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></p>
</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292614881"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292614881" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292614881">(Aug 09 2022 at 16:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292614898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292614898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292614898">(Aug 09 2022 at 16:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>
<p>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></p>
</li>
<li>
<p>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></p>
</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292614913"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292614913" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292614913">(Aug 09 2022 at 16:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="292614933"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/292614933" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#292614933">(Aug 09 2022 at 16:44)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Update support for multi-return, <code>unit</code>, etc.</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="293623113"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/293623113" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#293623113">(Aug 15 2022 at 21:24)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="293623122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/293623122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#293623122">(Aug 15 2022 at 21:24)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="293908187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/293908187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#293908187">(Aug 17 2022 at 14:30)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="296227310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/296227310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#296227310">(Aug 30 2022 at 21:54)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="296830533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/296830533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#296830533">(Sep 02 2022 at 14:23)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4844">Implementing <code>value</code> types and <code>start</code> functions</a></li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">What to do about type imports?</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component root and expecting it to work.</li>
</ul>
</blockquote>



<a name="301039665"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/301039665" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#301039665">(Sep 27 2022 at 15:43)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[ ] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="303884475"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/303884475" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#303884475">(Oct 13 2022 at 17:08)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
<li>[x] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="303884485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/303884485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#303884485">(Oct 13 2022 at 17:08)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[x] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="306045553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/306045553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#306045553">(Oct 25 2022 at 14:50)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[x] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/5119">Support AOT compilation of components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/5120">Change how components interact with the pooling instance allocator</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="307573191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/307573191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#307573191">(Nov 02 2022 at 17:02)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[x] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/5119">Support AOT compilation of components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/5120">Change how components interact with the pooling instance allocator</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="307573217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/307573217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#307573217">(Nov 02 2022 at 17:02)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[x] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/5119">Support AOT compilation of components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/5120">Change how components interact with the pooling instance allocator</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<a name="319361570"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/319361570" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#319361570">(Jan 04 2023 at 10:42)</a>:</h4>
<p>pannous <a href="https://github.com/bytecodealliance/wasmtime/issues/4185#issuecomment-1370761880">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>Once all the boxes are checked don't forget a 'hello component' minimal example.</p>
</blockquote>



<a name="380506769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/380506769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#380506769">(Jul 31 2023 at 22:18)</a>:</h4>
<p>bobby <a href="https://github.com/bytecodealliance/wasmtime/issues/4185#issuecomment-1659265246">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>Hey @alexcrichton, what's the relationship of this issue with #6370?  Are you still actively tracking issues here, or is the state of landing WASI preview 2 support a better proxy for component model progress in wasmtime?</p>
</blockquote>



<a name="380512573"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/380512573" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#380512573">(Jul 31 2023 at 22:58)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/4185#issuecomment-1659302187">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>It depends on why you need to know.</p>
<p>If you are trying to contribute to the component model or WASI design and implementation, they are separate standards where WASI builds on the component model, but only using the pieces that are complete in this list. For example, now that component model resources are complete here in wasmtime and are nearing completion out in wit-bindgen and other tools, we'll be swapping out our u32 placeholders for proper resources in WASI shortly.</p>
<p>If you are just looking to write or embed components, you want both the component model and WASI to be stable: right now their definitions are still in flux, and wasmtime's implementations may not even match the spec definitions. We intend to stabilize both of those, in both spec and implementation, as Preview 2 later this year. The full set of implementation work required to finish Preview 2 isn't captured anywhere right now, but we do have a rough plan on the spec side: <a href="https://github.com/WebAssembly/WASI/pull/550">https://github.com/WebAssembly/WASI/pull/550</a></p>
</blockquote>



<a name="381996231"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/381996231" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#381996231">(Aug 04 2023 at 23:58)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/4185#issuecomment-1666289132">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>I'll add to what @pchickey said already and note that this issue has I think outlived its usefulness. At this time all major efforts for implementing the component model have finished except for the never-ending continued polish in addition to the preview2 implementation (which involves shaping and stabilizing preview2 as well). </p>
<p>In light of that I'm going to go ahead and close this as the component model implementation in Wasmtime is more-or-less complete (with usefulness coming with other preview2-related things). Any follow-ups and remaining items should be opened as separate issues at this point for separate discussion.</p>
</blockquote>



<a name="381996233"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234185%20Tracking%20issue%20for%20implementing%20th.../near/381996233" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234185.20Tracking.20issue.20for.20implementing.20th.2E.2E.2E.html#381996233">(Aug 04 2023 at 23:58)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/4185">issue #4185</a>:</p>
<blockquote>
<p>This is intended to be a tracking issue for the implementation of the <a href="https://github.com/webassembly/component-model">component model proposal</a> of WebAssembly. I'm in the progress of implementing this with work in Wasmtime starting at <a href="https://github.com/bytecodealliance/wasmtime/pull/4005">https://github.com/bytecodealliance/wasmtime/pull/4005</a> and continuing in further PRs. I hope to leave checkbox items here to ensure I don't forget about them and to also track the progress of implementing the component model.</p>
<h3>Items to be implemented</h3>
<ul>
<li>[x] Text format parsing</li>
<li>[x] Validation in <code>wasmparser</code></li>
<li>[x] Basic infrastructure in the <code>component</code> submodule of the <code>wasmtime</code> crate</li>
<li>[x] Basic instantiation with zero imports</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4039">Extracting a function and calling it with a static signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host functions into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Importing host instances (bundles of host functions) into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Importing a wasm module into a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4208">Exporting a module from a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component compilation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Nested component instantiation</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Outer component aliases</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4285">Exporting a component from a component</a></li>
<li>[x] <a href="https://github.com/WebAssembly/component-model/issues/51">Confirm lowered-then-lifted interpretation of "always trap" is correct</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4236">Split <code>ComponentValue</code> into lifting and lowering traits</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4219">Implement may_enter and may_leave flags</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4297">Post-return functions</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4238">Validate alignment</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/4330">enable <code>&amp;[u64]</code> views and similar</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4327">Figure out what to do with lowering a lifted function</a></li>
<li>[x] <del>Double-check behavior of traps with respect to validating in-bounds pointers and intermediate writes of params/results when lifting/lowering</del> given the "trap lock" I don't think that this matters</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4347">Figure out what to do with a lifting a lowered function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4348">Figure out what to do with reexporting an imported function</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4354">Implement a "lock" for instances for when a trap happens</a> (<a href="https://github.com/WebAssembly/component-model/issues/55">https://github.com/WebAssembly/component-model/issues/55</a>)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4364">Exporting a component instance from the root of a component</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4385">Fill out <code>unimplemented!</code> for outer core aliases</a></li>
<li>[x] Component-to-component adapters (this is a huge work item implying an entire compiler for adapter trampolines)</li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4560">Fix support for zero-sized flags.</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4648">Fix support for zero-sized lists/strings/types</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/pull/4715">Update support for multi-return, <code>unit</code>, etc.</a></li>
<li>[x] Implement embedder support for multi-return (in the <code>wasmtime</code> crate API)</li>
<li>[ ] Implement <a href="https://github.com/WebAssembly/component-model/pull/62">new reentrance rules</a></li>
</ul>
<h3>Separate work items</h3>
<p>I'm starting to separate off work items from this issue to separate tracking issues with more detail. These will all need completion to finish the component model work but these issues are suitable to be picked up by anyone in theory.</p>
<ul>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4308">Support for <code>record</code>, <code>variant</code>, <code>enum</code>, <code>union</code>, <code>flags</code></a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4310">Calling a function with a dynamic signature</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4307">Fuzzing for round-tripping component values</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4309">String support for utf16+latin1 (omitted from #4039)</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/4592">Deduplicate size/align calculations</a></li>
<li>[x] <a href="https://github.com/bytecodealliance/wasmtime/issues/5119">Support AOT compilation of components</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4594">Support creation of function types</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4593">Implement type reflection for imports/exports</a></li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">Support 64-bit memories for components</a></li>
<li>[ ] Audit adapter trampolines to ensure that out-of-bounds pointers have correct semantics, especially when calling helper functions for translations of types in memory.</li>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/5120">Change how components interact with the pooling instance allocator</a></li>
</ul>
<h3>Unsure how to implement so far</h3>
<ul>
<li>Everything with <code>value</code> ranging from imports to exports to the <code>start</code> function</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4494">Type imports</a></li>
<li>Unsure how to rationalize performance concerns with validating indirect values like lists from wasm coming to the host when balanced with spec-desired behavior of validating everything.</li>
</ul>
<h3>Open questions</h3>
<ul>
<li>How to optimize passing <code>&amp;[u8]</code> to WebAssembly to a <code>memcpy</code>?</li>
<li><del><a href="https://github.com/bytecodealliance/wasmtime/pull/4198">How to handle validation of <code>Value&lt;T&gt;</code> coming out of wasm?</a></del></li>
</ul>
<h3>Not planned at this time</h3>
<ul>
<li>Importing component-defined functions into a component without any extra copies to the host</li>
<li>Importing component instances directly into other components</li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/4283">Importing a component or exporting a component at the root level</a></li>
<li>Reexporting an imported function from a component and expecting it to work.</li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>