<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3798 cranelift: Use GPR newtypes extensive... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html">wasmtime / PR #3798 cranelift: Use GPR newtypes extensive...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="271872380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271872380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271872380">(Feb 14 2022 at 19:02)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3798">PR #3798</a> from <code>use-gpr-newtypes</code> to <code>main</code>:</p>
<blockquote>
<p>We already defined the <code>Gpr</code> newtype and used it in a few places, and we already<br>
defined the <code>Xmm</code> newtype and used it extensively. This finishes the transition<br>
to using the newtypes extensively in lowering by making use of <code>Gpr</code> in more<br>
places.</p>
<p>Fixes #3685</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="271872381"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271872381" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271872381">(Feb 14 2022 at 19:02)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/3798">PR #3798</a>.</p>



<a name="271875737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271875737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271875737">(Feb 14 2022 at 19:24)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#pullrequestreview-882087170">PR review</a>.</p>



<a name="271875738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271875738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271875738">(Feb 14 2022 at 19:24)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#pullrequestreview-882087170">PR review</a>.</p>



<a name="271875739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271875739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271875739">(Feb 14 2022 at 19:24)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#discussion_r806166550">PR review comment</a>:</p>
<blockquote>
<p>Would it make sense to make <code>regs::rax()</code> and friends return a <code>Gpr</code> directly, and likewise <code>regs::xmm0()</code> and friends return an <code>Xmm</code> directly? This callsite gets simpler but others maybe gain a <code>.to_reg()</code>, so it's not necessarily any less verbose, but it is a bit more typesafe.</p>
</blockquote>



<a name="271876621"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271876621" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271876621">(Feb 14 2022 at 19:30)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#pullrequestreview-882095566">PR review</a>.</p>



<a name="271876623"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271876623" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271876623">(Feb 14 2022 at 19:30)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#discussion_r806172628">PR review comment</a>:</p>
<blockquote>
<p>I've avoided pushing the newtypes beyond the ISLE-glue boundary thus far. I think it would make sense to have one more PR (maybe I'll get to it while waiting on reviews for my components PRs) where we push the newtypes to all the <code>Inst::add</code>/etc methods and I think pushing that to <code>regs::rax</code>/etc in that same PR would make sense.</p>
<p>But I kinda don't want to do all that right now.</p>
<p>Does that sound good?</p>
</blockquote>



<a name="271886166"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271886166" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271886166">(Feb 14 2022 at 20:49)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#pullrequestreview-882171237">PR review</a>.</p>



<a name="271886167"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271886167" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271886167">(Feb 14 2022 at 20:49)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3798#discussion_r806227474">PR review comment</a>:</p>
<blockquote>
<p>Yep, that's reasonable, any incremental increase in typed-ness is good but no need to block on any part of it!</p>
</blockquote>



<a name="271886850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233798%20cranelift%3A%20Use%20GPR%20newtypes%20extensive.../near/271886850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233798.20cranelift.3A.20Use.20GPR.20newtypes.20extensive.2E.2E.2E.html#271886850">(Feb 14 2022 at 20:54)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3798">PR #3798</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>