<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7986 Split out `TypeRegistry`&#x27;s open-coded... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html">wasmtime / PR #7986 Split out `TypeRegistry`&#x27;s open-coded...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="422935325"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422935325" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422935325">(Feb 23 2024 at 01:51)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a> from <code>fitzgen:slab</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>First of all, it is just a nice separation of concerns.</p>
<p>Second of all, as I design the GC rooting APIs for Wasmtime's upcoming Wasm GC support, I want this same thing and I'd rather not open code it multiple times.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="422935326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422935326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422935326">(Feb 23 2024 at 01:51)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a>.</p>



<a name="422935327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422935327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422935327">(Feb 23 2024 at 01:51)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a>.</p>



<a name="422935328"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422935328" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422935328">(Feb 23 2024 at 01:51)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a>.</p>



<a name="422937855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422937855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422937855">(Feb 23 2024 at 02:14)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#pullrequestreview-1897287846">PR review</a>:</p>
<blockquote>
<p>This seems good to me! We could probably use this for the wasi table in wasmtime-wasi as well, as it looks pretty similar in its implementation :)</p>
</blockquote>



<a name="422937856"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422937856" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422937856">(Feb 23 2024 at 02:14)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#pullrequestreview-1897287846">PR review</a>:</p>
<blockquote>
<p>This seems good to me! We could probably use this for the wasi table in wasmtime-wasi as well, as it looks pretty similar in its implementation :)</p>
</blockquote>



<a name="422937857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422937857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422937857">(Feb 23 2024 at 02:14)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#discussion_r1500152046">PR review comment</a>:</p>
<blockquote>
<p>Does this use <code>NonZeroU32</code> to ensure that <code>Option&lt;Id&gt;</code> takes up four bytes?</p>
</blockquote>



<a name="422938413"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422938413" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422938413">(Feb 23 2024 at 02:17)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#pullrequestreview-1897287846">PR review</a>:</p>
<blockquote>
<p>This seems good to me! We could probably use this for the <code>ResourceTable</code> as well, as it looks pretty similar in its implementation :)</p>
</blockquote>



<a name="422938965"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422938965" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422938965">(Feb 23 2024 at 02:23)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#pullrequestreview-1897292927">PR review</a>.</p>



<a name="422938966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422938966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422938966">(Feb 23 2024 at 02:23)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#discussion_r1500155529">PR review comment</a>:</p>
<blockquote>
<p>Yep, and this also aligns with how <code>VMSharedTypeIndex</code> reserves <code>u32::MAX</code> for its default/null value.</p>
</blockquote>



<a name="422939069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422939069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422939069">(Feb 23 2024 at 02:24)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#issuecomment-1960648908">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a>:</p>
<blockquote>
<blockquote>
<p>We could probably use this for the <code>ResourceTable</code> as well, as it looks pretty similar in its implementation :)</p>
</blockquote>
<p>I believe Alex added a generation to that table, so it would need to do the layering described in the docs. Might make sense to add a generic implementation of that layering to this crate if we make <code>ResourceTable</code> use this as an implementation detail.</p>
</blockquote>



<a name="422949674"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/422949674" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#422949674">(Feb 23 2024 at 04:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/7986#issuecomment-1960725792">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @peterhuene</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>peterhuene: wasmtime:api</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="423049777"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237986%20Split%20out%20%60TypeRegistry%60%27s%20open-coded.../near/423049777" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237986.20Split.20out.20.60TypeRegistry.60.27s.20open-coded.2E.2E.2E.html#423049777">(Feb 23 2024 at 16:23)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7986">PR #7986</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>