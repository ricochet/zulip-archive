<html>
<head><meta charset="utf-8"><title>wasmtime / issue #9747 Pulley TODO List · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html">wasmtime / issue #9747 Pulley TODO List</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="486394732"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486394732" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486394732">(Dec 05 2024 at 21:16)</a>:</h4>
<p><a href="https://github.com/alexcrichton">alexcrichton</a> added the pulley label to <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">Issue #9747</a>.</p>



<a name="486394733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486394733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486394733">(Dec 05 2024 at 21:16)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a></li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a></li>
</ul>
</blockquote>



<a name="486394828"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486394828" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486394828">(Dec 05 2024 at 21:17)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/issues/9747#issuecomment-2521467200">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "pulley"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: pulley</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="486395043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486395043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486395043">(Dec 05 2024 at 21:18)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a></li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a></li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
</ul>
</blockquote>



<a name="486395092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486395092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486395092">(Dec 05 2024 at 21:18)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a></li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a></li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.<br>
```[tasklist]</li>
</ul>
<h3>Tasks</h3>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="486395264"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486395264" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486395264">(Dec 05 2024 at 21:20)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
</ul>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="err">```</span><span class="p">[</span><span class="n">tasklist</span><span class="p">]</span>
<span class="p">###</span><span class="w"> </span><span class="n">Tasks</span>
</code></pre></div>
</blockquote>



<a name="486395294"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486395294" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486395294">(Dec 05 2024 at 21:20)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="486403664"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486403664" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486403664">(Dec 05 2024 at 22:24)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[ ] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="486409109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486409109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486409109">(Dec 05 2024 at 23:06)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/9747#issuecomment-2521676831">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>Notes for big-endian:</p>
<ul>
<li>Need to add big-endian targets for Cranelift --  <a href="https://github.com/bytecodealliance/target-lexicon/pull/115">https://github.com/bytecodealliance/target-lexicon/pull/115</a></li>
<li>Pulley loads/stores will all have annotated endianness, nothing is "native endian"</li>
<li>New big-endian loads/stores to get added under the "extended" opcode space</li>
<li>Cranelift will use its configuration to select the appropriate pulley instruction, e.g. "native endianness" is whatever the configured target uses</li>
</ul>
</blockquote>



<a name="486409200"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486409200" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486409200">(Dec 05 2024 at 23:07)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[ ] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="486605367"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/486605367" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#486605367">(Dec 06 2024 at 22:39)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487305328"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487305328" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487305328">(Dec 10 2024 at 17:27)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits?</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487305507"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487305507" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487305507">(Dec 10 2024 at 17:28)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487305654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487305654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487305654">(Dec 10 2024 at 17:28)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487307845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487307845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487307845">(Dec 10 2024 at 17:40)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/blob/main/pulley/CONTRIBUTING.md">Get all <code>.wast</code> tests passing under Pulley!</a></li>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487307884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487307884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487307884">(Dec 10 2024 at 17:40)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/blob/main/pulley/CONTRIBUTING.md">**Get all <code>.wast</code> tests passing under Pulley!**</a></li>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487307928"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487307928" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487307928">(Dec 10 2024 at 17:40)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/blob/main/pulley/CONTRIBUTING.md">**Get all <code>.wast</code> tests passing under Pulley!**</a></li>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="487308036"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/487308036" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#487308036">(Dec 10 2024 at 17:41)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/blob/main/pulley/CONTRIBUTING.md">**Get all <code>.wast</code> tests passing under Pulley!!!!**</a></li>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488109899"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488109899" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488109899">(Dec 11 2024 at 14:21)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] <a href="https://github.com/bytecodealliance/wasmtime/issues/9783">https://github.com/bytecodealliance/wasmtime/issues/9783</a></li>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488125644"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488125644" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488125644">(Dec 11 2024 at 15:28)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Enable Cranelift <code>runtest</code> support</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488197315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488197315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488197315">(Dec 11 2024 at 22:04)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488197432"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488197432" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488197432">(Dec 11 2024 at 22:05)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Enable Cranelift <code>runtest</code> support</li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488197469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488197469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488197469">(Dec 11 2024 at 22:05)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488197486"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488197486" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488197486">(Dec 11 2024 at 22:05)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[ ] Better debugging support, e.g. print the register state between instructions and print each instruction.</li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488516919"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488516919" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488516919">(Dec 11 2024 at 22:54)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488516998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488516998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488516998">(Dec 11 2024 at 22:54)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target - <a href="https://github.com/bytecodealliance/wasmtime/pull/9759">https://github.com/bytecodealliance/wasmtime/pull/9759</a></li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488526742"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488526742" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488526742">(Dec 12 2024 at 00:07)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target - <a href="https://github.com/bytecodealliance/wasmtime/pull/9759">https://github.com/bytecodealliance/wasmtime/pull/9759</a></li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488537196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488537196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488537196">(Dec 12 2024 at 02:04)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[ ] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488658966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488658966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488658966">(Dec 12 2024 at 15:28)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[ ] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488920029"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488920029" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488920029">(Dec 13 2024 at 21:00)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[ ] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="488921680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/488921680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#488921680">(Dec 13 2024 at 21:11)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details</li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="489352350"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/489352350" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#489352350">(Dec 16 2024 at 22:01)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<p>```[tasklist]</p>
<h3>Tasks</h3>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[ ] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity</li>
</ul>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">~~~</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="489363202"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/489363202" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#489363202">(Dec 16 2024 at 23:02)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[ ] Run the full <code>all</code> test suite on 32-bit platforms</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
</ul>
</blockquote>



<a name="489380131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/489380131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#489380131">(Dec 17 2024 at 01:14)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
</ul>
</blockquote>



<a name="489570863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/489570863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#489570863">(Dec 17 2024 at 20:57)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Support building Wasmtime with the Pulley interpreter but not the Pulley compiler</li>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
</ul>
</blockquote>



<a name="492164077"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/492164077" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#492164077">(Jan 06 2025 at 18:57)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[ ] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[ ] Implement the wide-arithmetic proposal</li>
</ul>
</blockquote>



<a name="492184632"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/492184632" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#492184632">(Jan 06 2025 at 21:03)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[ ] Implement the wide-arithmetic proposal</li>
</ul>
</blockquote>



<a name="492184661"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/492184661" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#492184661">(Jan 06 2025 at 21:03)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[ ] Implement the wide-arithmetic proposal</li>
<li>[ ] Fuzz pulley</li>
</ul>
</blockquote>



<a name="492391588"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/492391588" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#492391588">(Jan 07 2025 at 21:36)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[ ] Fuzz pulley</li>
</ul>
</blockquote>



<a name="492810265"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/492810265" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#492810265">(Jan 09 2025 at 20:17)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="493011166"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/493011166" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#493011166">(Jan 10 2025 at 19:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="493011178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/493011178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#493011178">(Jan 10 2025 at 19:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="493011189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/493011189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#493011189">(Jan 10 2025 at 19:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="493011193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/493011193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#493011193">(Jan 10 2025 at 19:16)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit"</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="493400465"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/493400465" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#493400465">(Jan 13 2025 at 16:59)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[x] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit" <a href="https://github.com/bytecodealliance/wasmtime/pull/9994">https://github.com/bytecodealliance/wasmtime/pull/9994</a></li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="493424077"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/493424077" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#493424077">(Jan 13 2025 at 18:51)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit" <a href="https://github.com/bytecodealliance/wasmtime/pull/9994">https://github.com/bytecodealliance/wasmtime/pull/9994</a></li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="494017220"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/494017220" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#494017220">(Jan 15 2025 at 21:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[x] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit" <a href="https://github.com/bytecodealliance/wasmtime/pull/9994">https://github.com/bytecodealliance/wasmtime/pull/9994</a></li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<a name="494017232"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239747%20Pulley%20TODO%20List/near/494017232" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239747.20Pulley.20TODO.20List.html#494017232">(Jan 15 2025 at 21:09)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9747">issue #9747</a>:</p>
<blockquote>
<p>I'd like a place to throw small items as I see them and to collect various TODO items during the development of Pulley. For now this will serve that location. My hope is that this list is TODO items which pertain to code in-tree and are less-so about wishlist items of what's yet to fill in. For example this won't track missing pulley work (e.g. all wasm proposals at this time). Unsure if this style of issue will work out.</p>
<ul>
<li>[ ] Evaluate 32-bit platforms and the decision to "only write low 32-bits". If we write the full 64-bit width of registers does it actually have a performance loss? Is it worth burning opcode space for opcodes that only write the low-32 instead of high 64? Should we split opcodes like <code>xconst8</code> into one that writes 64-bits and one that writes 32-bits? Should we remove <code>xload8_s32_offset32</code> instead?</li>
<li>[ ] Add support for Pulley to <code>#[wasmtime_test]</code></li>
<li>[x] Move sp/fp/lr/special regs out of the general purpose register set; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188">https://github.com/bytecodealliance/wasmtime/pull/9658#pullrequestreview-2482824188</a> for details (also cc <a href="https://github.com/bytecodealliance/wasmtime/pull/9806">https://github.com/bytecodealliance/wasmtime/pull/9806</a>)</li>
<li>[x] Explore adding new addressing modes (e.g. register + register). Should be based on an evaluation of what wasm loads/stores do probably. Perhaps even fold a trapping arithmetic into one macro-op for "do the wasm load on 32-bit" and "do the wasm load on 64-bit" <a href="https://github.com/bytecodealliance/wasmtime/pull/9994">https://github.com/bytecodealliance/wasmtime/pull/9994</a></li>
<li>[x] Assert in call lowering that pulley&lt;-&gt;pulley is always tail-to-tail or similar; see <a href="https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050">https://github.com/bytecodealliance/wasmtime/pull/9665#discussion_r1871969050</a> for details -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9836">https://github.com/bytecodealliance/wasmtime/pull/9836</a></li>
<li>[x] Better debugging support, e.g. print the register state between instructions and print each instruction. <a href="https://github.com/bytecodealliance/wasmtime/pull/9796">https://github.com/bytecodealliance/wasmtime/pull/9796</a></li>
<li>[x] Support big-endian - will need to add <code>pulley{64,32}be</code> targets to target-lexicon, then add big-endian loads/stores, then update the CLIF backend to delegate to the right endianness based on the target</li>
<li>[x] Need to restore callee-save state when a trap happens somehow (either via explicit saves or by removing callee-save state in that situation) <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Enable Cranelift <code>runtest</code> support <a href="https://github.com/bytecodealliance/wasmtime/pull/9795">https://github.com/bytecodealliance/wasmtime/pull/9795</a></li>
<li>[X] Run the full <code>all</code> test suite on 32-bit platforms -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9837">https://github.com/bytecodealliance/wasmtime/pull/9837</a></li>
<li>[x] Figure out story for threading -- loads/stores all need to be at least with a "relaxed" atomicity -- <a href="https://github.com/bytecodealliance/wasmtime/pull/9818">https://github.com/bytecodealliance/wasmtime/pull/9818</a></li>
<li>[x] Implement the wide-arithmetic proposal <a href="https://github.com/bytecodealliance/wasmtime/pull/9944">https://github.com/bytecodealliance/wasmtime/pull/9944</a></li>
<li>[x] Fuzz pulley <a href="https://github.com/bytecodealliance/wasmtime/pull/9966">https://github.com/bytecodealliance/wasmtime/pull/9966</a></li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>