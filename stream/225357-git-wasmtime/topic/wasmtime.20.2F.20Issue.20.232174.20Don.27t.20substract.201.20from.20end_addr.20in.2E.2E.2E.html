<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2174 Don&#x27;t substract 1 from end_addr in... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html">wasmtime / Issue #2174 Don&#x27;t substract 1 from end_addr in...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="208442513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208442513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208442513">(Aug 29 2020 at 16:37)</a>:</h4>
<p>ggreif <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683313375">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>Thanks for the quick fix! Let me come up with a regression test for it!</p>
</blockquote>



<a name="208443107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208443107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208443107">(Aug 29 2020 at 16:50)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683313375">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>Thanks for the quick fix! Let me come up with a regression test for it! (Will take a few hours, but there is no haste...)</p>
</blockquote>



<a name="208456286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208456286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208456286">(Aug 29 2020 at 22:08)</a>:</h4>
<p>ggreif <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683347015">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p><a href="https://github.com/bjorn3/wasmtime/pull/1">https://github.com/bjorn3/wasmtime/pull/1</a></p>
</blockquote>



<a name="208456292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208456292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208456292">(Aug 29 2020 at 22:08)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683347015">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>PR: <a href="https://github.com/bjorn3/wasmtime/pull/1">https://github.com/bjorn3/wasmtime/pull/1</a></p>
</blockquote>



<a name="208482169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208482169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208482169">(Aug 30 2020 at 12:07)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683347015">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>PR: <a href="https://github.com/bjorn3/wasmtime/pull/1">https://github.com/bjorn3/wasmtime/pull/1</a></p>
<p>Note: the test added is _ignored_, due to the usual. lack of tools on CI for drumming it. Try</p>
<div class="codehilite"><pre><span></span><code><span class="n">cargo</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">translate</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="o">--</span><span class="n">ignored</span><span class="w"></span>
</code></pre></div>


<p>After reverting 053757f, the above fails.</p>
</blockquote>



<a name="208482174"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208482174" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208482174">(Aug 30 2020 at 12:07)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683347015">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>PR: <a href="https://github.com/bjorn3/wasmtime/pull/1">https://github.com/bjorn3/wasmtime/pull/1</a></p>
<p>Note: the test added is _ignored_, due to the usual lack of tools on CI for drumming it. Try</p>
<div class="codehilite"><pre><span></span><code><span class="n">cargo</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">translate</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="o">--</span><span class="n">ignored</span><span class="w"></span>
</code></pre></div>


<p>After reverting 053757f, the above fails.</p>
</blockquote>



<a name="208482215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208482215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208482215">(Aug 30 2020 at 12:08)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683347015">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>PR: <a href="https://github.com/bjorn3/wasmtime/pull/1">https://github.com/bjorn3/wasmtime/pull/1</a></p>
<p>Note: the test added is _ignored_, due to the usual lack of tools on CI for running it. Try</p>
<div class="codehilite"><pre><span></span><code><span class="n">cargo</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">translate</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="o">--</span><span class="n">ignored</span><span class="w"></span>
</code></pre></div>


<p>After reverting 053757f, the above fails.</p>
</blockquote>



<a name="208556609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208556609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208556609">(Aug 31 2020 at 13:35)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683313375">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p><del>Thanks for the quick fix! Let me come up with a regression test for it! (Will take a few hours, but there is no haste...)</del> DONE!</p>
</blockquote>



<a name="208564688"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208564688" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208564688">(Aug 31 2020 at 14:33)</a>:</h4>
<p>ggreif <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683817458">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<blockquote>
<p>I'm skeptical about test having hardcoded address. We can keep it though for now with note just it relies on cranelift generator, so the address will be justed when generation changes.</p>
</blockquote>
<p>Yeah, right, I was thinking of this too. But it shouldn't be very bad, since</p>
<ul>
<li>short code is more resistant of CG changes</li>
<li>this part of CD should be mature and rather slowly-moving by now (fingers crossed)</li>
<li>the intent is clear, so easy to fix if a CG change would touch this.</li>
</ul>
<p>Also the <code>FileCheck</code> Rust library seems to be missing advanced features like captures and evaluation. I don't even know whether the LLVM tool proper provides those.</p>
<p>So I suggest to leave it like this for now, and if it causes headaches, just drop it. Better ideas?</p>
</blockquote>



<a name="208565793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208565793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208565793">(Aug 31 2020 at 14:41)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683817458">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<blockquote>
<p>I'm skeptical about test having hardcoded address. We can keep it though for now with note just it relies on cranelift generator, so the address will be justed when generation changes.</p>
</blockquote>
<p>Yeah, right, I was thinking of this too. But it shouldn't be very bad, since</p>
<ul>
<li>short code is more resistant of CG changes</li>
<li>this part of CG should be mature and rather slowly-moving by now (fingers crossed)</li>
<li>the intent is clear, so easy to fix if a CG change would touch this.</li>
</ul>
<p>Also the <code>FileCheck</code> Rust library seems to be missing advanced features like captures and evaluation. I don't even know whether the LLVM tool proper provides those.</p>
<p>So I suggest to leave it like this for now, and if it causes headaches, just drop it. Better ideas?</p>
</blockquote>



<a name="208566140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208566140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208566140">(Aug 31 2020 at 14:44)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683820774">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>Filecheck does have captures: <a href="https://github.com/bytecodealliance/wasmtime/blob/a7f7c23bf9c37c642da962d575b7c99007918872/cranelift/filetests/filetests/regalloc/coalesce.clif#L30">https://github.com/bytecodealliance/wasmtime/blob/a7f7c23bf9c37c642da962d575b7c99007918872/cranelift/filetests/filetests/regalloc/coalesce.clif#L30</a></p>
</blockquote>



<a name="208567329"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208567329" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208567329">(Aug 31 2020 at 14:51)</a>:</h4>
<p>ggreif <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683828759">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<blockquote>
<p>Filecheck does have captures</p>
</blockquote>
<p>That's cool, but I cannot see the ability to do <code>$(expr &lt;var&gt; + 1)</code> or such.</p>
</blockquote>



<a name="208659757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/208659757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#208659757">(Sep 01 2020 at 08:46)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-683817458">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<blockquote>
<p>I'm skeptical about test having hardcoded address. We can keep it though for now with note just it relies on cranelift generator, so the address will be justed when generation changes.</p>
</blockquote>
<p>Yeah, right, I was thinking of this too. But it shouldn't be very bad, since</p>
<ul>
<li>short code is more resistant of CG changes</li>
<li>this part of CG should be mature and rather slowly-moving by now (fingers crossed)</li>
<li>the test is _ignored_, so it won't run in CI</li>
<li>the intent is clear, so easy to fix if a CG change would touch this.</li>
</ul>
<p>Also the <code>FileCheck</code> Rust library seems to be missing advanced features like captures and evaluation. I don't even know whether the LLVM tool proper provides those.</p>
<p>So I suggest to leave it like this for now, and if it causes headaches, just drop it. Better ideas?</p>
</blockquote>



<a name="209182583"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/209182583" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#209182583">(Sep 05 2020 at 15:15)</a>:</h4>
<p>ggreif <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-687624265">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<blockquote>
<p>Let's try that. In the past it was always an issue, e.g. I had the following in the dwarf-to-json library:</p>
<p><a href="https://github.com/yurydelendik/dwarf-to-json/blob/d9c6f665f67da3f862a36d88b86eb488ca4bbc4d/src/dwarf.rs#L488-L500">https://github.com/yurydelendik/dwarf-to-json/blob/d9c6f665f67da3f862a36d88b86eb488ca4bbc4d/src/dwarf.rs#L488-L500</a></p>
<p>Can you check if we have similar case here?</p>
</blockquote>
<p>I can't see how that could be. The DWARF5 standard is pretty much unambiguous in its wording (p151):</p>
<p><code>end_sequence</code>:<br>
A boolean indicating that the current address is that of the first byte after the end of a sequence of target machine instructions. <code>end_sequence</code> terminates a sequence of lines; therefore other information in the same row is not meaningful.</p>
</blockquote>



<a name="209296848"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232174%20Don%27t%20substract%201%20from%20end_addr%20in.../near/209296848" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232174.20Don.27t.20substract.201.20from.20end_addr.20in.2E.2E.2E.html#209296848">(Sep 07 2020 at 13:41)</a>:</h4>
<p>yurydelendik <a href="https://github.com/bytecodealliance/wasmtime/pull/2174#issuecomment-688334501">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2174">Issue #2174</a>:</p>
<blockquote>
<p>Thank you for the patch</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>