<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9447 Add missing pooling allocator options... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html">wasmtime / PR #9447 Add missing pooling allocator options...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="476184996"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476184996" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476184996">(Oct 10 2024 at 17:28)</a>:</h4>
<p><strong>omarjatoi</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>.</p>



<a name="476184997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476184997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476184997">(Oct 10 2024 at 17:28)</a>:</h4>
<p><strong>omarjatoi</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>.</p>



<a name="476184998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476184998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476184998">(Oct 10 2024 at 17:28)</a>:</h4>
<p>omarjatoi opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a> from <code>omarjatoi:9256-pooling-allocator-flags</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>From #9256, this PR adds the missing pooling allocator configuration options as CLI flags. I also renamed some minor things for consistency.</p>
<ul>
<li>Adds missing <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasmtime/src/config.rs#L2518-L3019"><code>PoolingAllocatorConfiguration</code></a> to the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/cli-flags/src/lib.rs#L39-L129"><code>OptimizeOptions</code></a> struct</li>
<li>Updates setting <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/cli-flags/src/lib.rs#L615-L665">when <code>pooling-allocator</code> is enabled</a></li>
<li>Fixes <code>pooling_decommit_batch_size</code> type to <code>usize</code></li>
<li>Rename <code>memory_protection_keys</code> to <code>pooling_memory_protection_keys</code><br>
</li>
</ul>
</blockquote>



<a name="476185487"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476185487" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476185487">(Oct 10 2024 at 17:31)</a>:</h4>
<p>omarjatoi edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>:</p>
<blockquote>
<p>From #9256, this PR adds the missing pooling allocator configuration options as CLI flags. I also renamed some minor things for consistency.</p>
<ul>
<li>Adds missing <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasmtime/src/config.rs#L2518-L3019"><code>PoolingAllocatorConfiguration</code></a> to the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/cli-flags/src/lib.rs#L39-L129"><code>OptimizeOptions</code></a> struct</li>
<li>Set configuration <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/cli-flags/src/lib.rs#L615-L665">when <code>pooling-allocator</code> is enabled</a> and flags are passed</li>
<li>Fixes <code>pooling_decommit_batch_size</code> type to <code>usize</code></li>
<li>Rename <code>memory_protection_keys</code> to <code>pooling_memory_protection_keys</code><br>
</li>
</ul>
</blockquote>



<a name="476186423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476186423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476186423">(Oct 10 2024 at 17:37)</a>:</h4>
<p>omarjatoi submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#pullrequestreview-2361020158">PR review</a>.</p>



<a name="476186424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476186424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476186424">(Oct 10 2024 at 17:37)</a>:</h4>
<p>omarjatoi created <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795853006">PR review comment</a>:</p>
<blockquote>
<p>This option was added to the struct but never used below: <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasmtime/src/config.rs#L2585-L2588">https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasmtime/src/config.rs#L2585-L2588</a></p>
</blockquote>



<a name="476187018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476187018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476187018">(Oct 10 2024 at 17:41)</a>:</h4>
<p>omarjatoi edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795853006">PR review comment</a>.</p>



<a name="476203907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476203907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476203907">(Oct 10 2024 at 19:02)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795929835">PR review comment</a>:</p>
<blockquote>
<p>Beyond the weird indentation, I think this is just a duplicate copy of what the existing <code>if let Some(limit)</code> is doing, but nested inside the existing copy?</p>
</blockquote>



<a name="476203908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476203908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476203908">(Oct 10 2024 at 19:02)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795931663">PR review comment</a>:</p>
<blockquote>
<p>This one doesn't mention the default value, but it should to be consistent with the other config knobs.</p>
</blockquote>



<a name="476203909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476203909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476203909">(Oct 10 2024 at 19:02)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#pullrequestreview-2361148474">PR review</a>:</p>
<blockquote>
<p>Thanks! Just a couple comments below</p>
</blockquote>



<a name="476203911"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476203911" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476203911">(Oct 10 2024 at 19:02)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795934059">PR review comment</a>:</p>
<blockquote>
<p>Ah, I see that earlier issue is fixed in this later commit.</p>
<p>In the future, can you either keep separate commits clean and individually reviewable or squash them into a single commit so that we don't have confusing situations like this? Thanks!</p>
</blockquote>



<a name="476204255"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476204255" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476204255">(Oct 10 2024 at 19:04)</a>:</h4>
<p>omarjatoi submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#pullrequestreview-2361189164">PR review</a>.</p>



<a name="476204257"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476204257" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476204257">(Oct 10 2024 at 19:04)</a>:</h4>
<p>omarjatoi created <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795953787">PR review comment</a>:</p>
<blockquote>
<p>Yeah, I messed up my commits <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> I'll fix them in the PR shortly</p>
</blockquote>



<a name="476205162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476205162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476205162">(Oct 10 2024 at 19:08)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#pullrequestreview-2361196477">PR review</a>.</p>



<a name="476205164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476205164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476205164">(Oct 10 2024 at 19:08)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#discussion_r1795958094">PR review comment</a>:</p>
<blockquote>
<p>At this point its fine, no worries, just something to think about for the future :)</p>
</blockquote>



<a name="476207485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476207485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476207485">(Oct 10 2024 at 19:21)</a>:</h4>
<p>omarjatoi updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>.</p>



<a name="476207803"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476207803" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476207803">(Oct 10 2024 at 19:23)</a>:</h4>
<p>omarjatoi updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>.</p>



<a name="476208387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476208387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476208387">(Oct 10 2024 at 19:26)</a>:</h4>
<p>omarjatoi <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#issuecomment-2405877415">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>:</p>
<blockquote>
<p>Thanks for the comments! I've added defaults in comments and cleaned up the commits.</p>
</blockquote>



<a name="476209581"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476209581" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476209581">(Oct 10 2024 at 19:33)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9447#pullrequestreview-2361241143">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="476209598"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476209598" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476209598">(Oct 10 2024 at 19:33)</a>:</h4>
<p>fitzgen has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>.</p>



<a name="476212466"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239447%20Add%20missing%20pooling%20allocator%20options.../near/476212466" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239447.20Add.20missing.20pooling.20allocator.20options.2E.2E.2E.html#476212466">(Oct 10 2024 at 19:50)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9447">PR #9447</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>