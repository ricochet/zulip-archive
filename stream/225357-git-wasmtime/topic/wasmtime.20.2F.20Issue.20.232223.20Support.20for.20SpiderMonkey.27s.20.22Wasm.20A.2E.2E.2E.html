<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2223 Support for SpiderMonkey&#x27;s &quot;Wasm A... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232223.20Support.20for.20SpiderMonkey.27s.20.22Wasm.20A.2E.2E.2E.html">wasmtime / Issue #2223 Support for SpiderMonkey&#x27;s &quot;Wasm A...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="211075503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232223%20Support%20for%20SpiderMonkey%27s%20%22Wasm%20A.../near/211075503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232223.20Support.20for.20SpiderMonkey.27s.20.22Wasm.20A.2E.2E.2E.html#211075503">(Sep 23 2020 at 23:49)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/2223#issuecomment-698029547">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2223">Issue #2223</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @bnjbvr</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift", "cranelift:area:aarch64", "cranelift:meta"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>bnjbvr: cranelift</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="211167469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232223%20Support%20for%20SpiderMonkey%27s%20%22Wasm%20A.../near/211167469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232223.20Support.20for.20SpiderMonkey.27s.20.22Wasm.20A.2E.2E.2E.html#211167469">(Sep 24 2020 at 17:56)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2223#issuecomment-698496338">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2223">Issue #2223</a>:</p>
<blockquote>
<p>Updated for x64, thanks! I see a few failures on SpiderMonkey-x64 with e.g. <code>jit-test/tests/wasm/bigint/bigint.js</code> (and I have to test with <code>--no-wasm-simd</code> to get Cranelift now on x64); I'm not sure if this is pre-existing, since we don't run the new x64 backend on CI there; but all of the basic functionality seems to work, so the basic stack-slot setup in this PR should be correct, I think.</p>
</blockquote>



<a name="211683835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232223%20Support%20for%20SpiderMonkey%27s%20%22Wasm%20A.../near/211683835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232223.20Support.20for.20SpiderMonkey.27s.20.22Wasm.20A.2E.2E.2E.html#211683835">(Sep 29 2020 at 21:03)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2223#issuecomment-700985368">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2223">Issue #2223</a>:</p>
<blockquote>
<p>Updated -- that was a fun one to track down! (Ten points to <del>Gryffindor</del> <code>rr</code>...).</p>
<p>The problem is that we weren't restoring the TLS register in the epilogue -- unlike IonMonkey, we do not treat the TLS register as an unallocatable fixed register, but rather we just copy its value to an ordinary SSA value on function entry. Apparently we were free to clobber it previously, but now we are not. Easy enough to handle in the clobber-restore sequences.</p>
<p>When vendored in, this passes SpiderMonkey's jit-tests on both x64 (<code>--wasm-compiler=cranelift --no-wasm-simd</code>) and aarch64 (<code>--wasm-compiler=cranelift</code>).</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>