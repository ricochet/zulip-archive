<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3402 Remove more old backend ISA concepts · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html">wasmtime / PR #3402 Remove more old backend ISA concepts</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="255665539"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255665539" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255665539">(Sep 30 2021 at 23:29)</a>:</h4>
<p>bnjbvr opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3402">PR #3402</a> from <code>unify-targetisa-mach-backend</code> to <code>main</code>:</p>
<blockquote>
<p>This also paves the way for unifying <code>TargetIsa</code> and <code>MachBackend</code>, since now they map one to one. In theory the two traits could be merged, which would be nice to limit the number of total concepts. Also they have quite different responsibilities, so it might be fine to keep them separate. Any thoughts @cfallin?</p>
<p>Interestingly, this PR started as removing<code>RegInfo</code> from the <code>TargetIsa</code> trait since the adapter returned a dummy value there. From the fallout, noticed that all <code>Display</code> implementations didn't needed an ISA anymore (since these were only used to render ISA specific registers). Also the whole family of <code>RegInfo</code> / <code>ValueLoc</code> / <code>RegUnit</code> was exclusively used for the old backend, and these could be removed. Notably, some IR instructions needed to be removed, because they were using <code>RegUnit</code> too: this was the oddball of <code>regfill</code> / <code>regmove</code> / <code>regspill</code> / <code>copy_special</code>, which were IR instructions inserted by the old regalloc. Fare thee well!</p>
</blockquote>



<a name="255665617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255665617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255665617">(Sep 30 2021 at 23:30)</a>:</h4>
<p>bnjbvr edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3402">PR #3402</a> from <code>unify-targetisa-mach-backend</code> to <code>main</code>:</p>
<blockquote>
<p>This also paves the way for unifying <code>TargetIsa</code> and <code>MachBackend</code>, since now they map one to one. In theory the two traits could be merged, which would be nice to limit the number of total concepts. Also they have quite different responsibilities, so it might be fine to keep them separate. Any thoughts @cfallin?</p>
<p>Interestingly, this PR started as removing<code>RegInfo</code> from the <code>TargetIsa</code> trait since the adapter returned a dummy value there. From the fallout, noticed that all <code>Display</code> implementations didn't needed an ISA anymore (since these were only used to render ISA specific registers). Also the whole family of <code>RegInfo</code> / <code>ValueLoc</code> / <code>RegUnit</code> was exclusively used for the old backend, and these could be removed. Notably, some IR instructions needed to be removed, because they were using <code>RegUnit</code> too: this was the oddball of <code>regfill</code> / <code>regmove</code> / <code>regspill</code> / <code>copy_special</code>, which were IR instructions inserted by the old regalloc. Fare thee well!</p>
<p>(feel free to squash the commits before merging, the history of this PR is a bit messy right now)</p>
</blockquote>



<a name="255668406"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255668406" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255668406">(Sep 30 2021 at 23:58)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-768462494">PR review</a>.</p>



<a name="255689726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255689726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255689726">(Oct 01 2021 at 04:49)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-768557316">PR review</a>.</p>



<a name="255689727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255689727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255689727">(Oct 01 2021 at 04:49)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r719934183">PR review comment</a>:</p>
<blockquote>
<p>Can you directly implement Display for Signature?</p>
</blockquote>



<a name="255689817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255689817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255689817">(Oct 01 2021 at 04:50)</a>:</h4>
<p>bjorn3 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r719934183">PR review comment</a>.</p>



<a name="255689842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255689842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255689842">(Oct 01 2021 at 04:51)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-768557822">PR review</a>.</p>



<a name="255689843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255689843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255689843">(Oct 01 2021 at 04:51)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r719934634">PR review comment</a>:</p>
<blockquote>
<p>Same</p>
</blockquote>



<a name="255690318"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255690318" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255690318">(Oct 01 2021 at 04:58)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-768560262">PR review</a>.</p>



<a name="255690319"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255690319" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255690319">(Oct 01 2021 at 04:58)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r719936715">PR review comment</a>:</p>
<blockquote>
<p>I think I use this in cg_clif.</p>
</blockquote>



<a name="255690446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255690446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255690446">(Oct 01 2021 at 05:00)</a>:</h4>
<p>bjorn3 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r719936715">PR review comment</a>.</p>



<a name="255690733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255690733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255690733">(Oct 01 2021 at 05:03)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-768562244">PR review</a>.</p>



<a name="255690734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/255690734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#255690734">(Oct 01 2021 at 05:03)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r719938321">PR review comment</a>:</p>
<blockquote>
<p>Same re Display.</p>
</blockquote>



<a name="256019432"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256019432" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256019432">(Oct 04 2021 at 07:54)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-769968113">PR review</a>.</p>



<a name="256019433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256019433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256019433">(Oct 04 2021 at 07:54)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r721121178">PR review comment</a>:</p>
<blockquote>
<p>Indeed, thanks!</p>
</blockquote>



<a name="256019440"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256019440" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256019440">(Oct 04 2021 at 07:54)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#pullrequestreview-769968240">PR review</a>.</p>



<a name="256019443"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256019443" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256019443">(Oct 04 2021 at 07:54)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r721121257">PR review comment</a>:</p>
<blockquote>
<p>Kept as i.</p>
</blockquote>



<a name="256019452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256019452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256019452">(Oct 04 2021 at 07:54)</a>:</h4>
<p>bnjbvr edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3402#discussion_r721121257">PR review comment</a>.</p>



<a name="256020426"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256020426" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256020426">(Oct 04 2021 at 08:03)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3402">PR #3402</a> from <code>unify-targetisa-mach-backend</code> to <code>main</code>.</p>



<a name="256023938"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233402%20Remove%20more%20old%20backend%20ISA%20concepts/near/256023938" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233402.20Remove.20more.20old.20backend.20ISA.20concepts.html#256023938">(Oct 04 2021 at 08:36)</a>:</h4>
<p>bnjbvr merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3402">PR #3402</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>