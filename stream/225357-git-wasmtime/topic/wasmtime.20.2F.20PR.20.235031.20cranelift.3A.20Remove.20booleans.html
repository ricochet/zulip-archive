<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5031 cranelift: Remove booleans · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html">wasmtime / PR #5031 cranelift: Remove booleans</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="303684545"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303684545" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303684545">(Oct 12 2022 at 17:17)</a>:</h4>
<p>elliottt edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>:</p>
<blockquote>
<p>Remove the boolean types from cranelift, and the associated instructions <code>breduce</code>, <code>bextend</code>, <code>bconst</code>, and <code>bint</code>. Standardize on using <code>1</code>/<code>0</code> for the return value from instructions that produce scalar boolean results, and <code>-1</code>/<code>0</code> for boolean vector elements.</p>
<p>Fixes #3205 <br>
&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="303705913"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303705913" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303705913">(Oct 12 2022 at 19:18)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303711803"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303711803" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303711803">(Oct 12 2022 at 19:59)</a>:</h4>
<p><strong>elliottt</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> as ready for review.</p>



<a name="303712030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303712030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303712030">(Oct 12 2022 at 20:00)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a>.</p>



<a name="303731245"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303731245" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303731245">(Oct 12 2022 at 22:31)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303732924"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303732924" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303732924">(Oct 12 2022 at 22:48)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139791990">PR review</a>.</p>



<a name="303732925"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303732925" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303732925">(Oct 12 2022 at 22:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993950735">PR review comment</a>:</p>
<blockquote>
<p>we can probably call this file something other than <code>b1.clif</code> now -- maybe <code>conditional_values.clif</code> or something?</p>
</blockquote>



<a name="303732926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303732926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303732926">(Oct 12 2022 at 22:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993955454">PR review comment</a>:</p>
<blockquote>
<p>s/false/0/ here (or "and require the return value to be nonzero")?</p>
</blockquote>



<a name="303732927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303732927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303732927">(Oct 12 2022 at 22:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993954120">PR review comment</a>:</p>
<blockquote>
<p>So nice to see this mess of canonicalization and type-coercion go away!</p>
</blockquote>



<a name="303732928"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303732928" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303732928">(Oct 12 2022 at 22:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993949489">PR review comment</a>:</p>
<blockquote>
<p>I think this could get a bit better (one instruction shorter) with</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">tst</span><span class="w"> </span><span class="n">w0</span><span class="p">,</span><span class="w"> </span>#<span class="mi">255</span><span class="w"></span>
<span class="n">csel</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<p>(<code>tst w0, #255</code> is an alias for <code>ands wzr, w0, #255</code>; if we don't have machinst support for that yet it should be easy as another ALU op, one bit different from <code>and</code>)</p>
</blockquote>



<a name="303732929"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303732929" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303732929">(Oct 12 2022 at 22:48)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139791990">PR review</a>.</p>



<a name="303735310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303735310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303735310">(Oct 12 2022 at 23:13)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139815870">PR review</a>.</p>



<a name="303735311"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303735311" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303735311">(Oct 12 2022 at 23:13)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993966869">PR review comment</a>:</p>
<blockquote>
<p>Great point. I like the latter phrasing, and will make that change.</p>
</blockquote>



<a name="303737737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303737737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303737737">(Oct 12 2022 at 23:36)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139837673">PR review</a>.</p>



<a name="303737738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303737738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303737738">(Oct 12 2022 at 23:36)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993982121">PR review comment</a>:</p>
<blockquote>
<p>Good point, the existing name isn't really all that meaningful going forward :)</p>
</blockquote>



<a name="303738666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303738666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303738666">(Oct 12 2022 at 23:47)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139844148">PR review</a>.</p>



<a name="303738668"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303738668" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303738668">(Oct 12 2022 at 23:47)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993987810">PR review comment</a>:</p>
<blockquote>
<p>Would you be okay with addressing this one in follow-up PR?</p>
</blockquote>



<a name="303738801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303738801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303738801">(Oct 12 2022 at 23:49)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303739290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303739290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303739290">(Oct 12 2022 at 23:54)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139850213">PR review</a>.</p>



<a name="303739291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303739291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303739291">(Oct 12 2022 at 23:54)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r993990563">PR review comment</a>:</p>
<blockquote>
<p>Yep, that's fine!</p>
</blockquote>



<a name="303747148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303747148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303747148">(Oct 13 2022 at 01:52)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1139913034">PR review</a>.</p>



<a name="303747149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303747149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303747149">(Oct 13 2022 at 01:52)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994035923">PR review comment</a>:</p>
<blockquote>
<p>I went ahead and fixed it on this branch, and found a bug with the x64 lowering of <code>select</code> in the process!</p>
</blockquote>



<a name="303747388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303747388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303747388">(Oct 13 2022 at 01:56)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303759791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303759791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303759791">(Oct 13 2022 at 05:17)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1140059245">PR review</a>.</p>



<a name="303759792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303759792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303759792">(Oct 13 2022 at 05:17)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994148516">PR review comment</a>:</p>
<blockquote>
<p>while here, a useful runtest to add might be a very slight variation on this one that intentionally tries to have nonzero bits in the upper undef bits of the <code>i8</code>-in-register, to make sure we're really testing just the low 8 bits; for example, by adding and wrapping:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">block0</span><span class="p">(</span><span class="n">v0</span>: <span class="kt">i8</span><span class="p">)</span>:
  <span class="nc">v1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">255</span><span class="w"></span>
<span class="w">  </span><span class="n">v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iadd</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="n">v0</span><span class="p">,</span><span class="w"> </span><span class="n">v1</span><span class="w"></span>
<span class="w">  </span><span class="n">brz</span><span class="w"> </span><span class="n">v2</span><span class="p">,</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<p>then it should branch for input arg <code>v0 = 1</code> even though the register will likely contain <code>256</code>...</p>
</blockquote>



<a name="303759793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303759793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303759793">(Oct 13 2022 at 05:17)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1140059245">PR review</a>.</p>



<a name="303759794"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303759794" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303759794">(Oct 13 2022 at 05:17)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994151154">PR review comment</a>:</p>
<blockquote>
<p>Good catch! Just to make sure, do we have a runtest somewhere that tests with a nonzero-but-even value to catch LSB-only checks like this?</p>
</blockquote>



<a name="303788023"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303788023" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303788023">(Oct 13 2022 at 09:21)</a>:</h4>
<p>uweigand submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1140389872">PR review</a>.</p>



<a name="303788024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303788024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303788024">(Oct 13 2022 at 09:21)</a>:</h4>
<p>uweigand created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994377560">PR review comment</a>:</p>
<blockquote>
<p>Hmm.  This helper is only called for possible scalar result types of <code>icmp</code> and <code>fcmp</code>.   These are specified as <code>&amp;Int.as_bool()</code> and <code>&amp;Float.as_bool()</code> so I thought I needed to handle multiple widths here.  But looking at this again, actually the only scalar return type of <code>as_bool</code> has always been <code>$B1</code> (and is now <code>$I8</code>), so it seems this is only type we need to handle here in the first place.</p>
</blockquote>



<a name="303788025"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303788025" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303788025">(Oct 13 2022 at 09:21)</a>:</h4>
<p>uweigand submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1140389872">PR review</a>.</p>



<a name="303799072"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303799072" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303799072">(Oct 13 2022 at 10:37)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1140425673">PR review</a>.</p>



<a name="303799073"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303799073" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303799073">(Oct 13 2022 at 10:37)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994395404">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>;; For conversions that fit in a register, we can use csetm.
</code></pre></div><br>
</p>
</blockquote>



<a name="303799077"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303799077" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303799077">(Oct 13 2022 at 10:37)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1140425673">PR review</a>.</p>



<a name="303875773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303875773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303875773">(Oct 13 2022 at 16:26)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303875942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303875942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303875942">(Oct 13 2022 at 16:27)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303876356"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303876356" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303876356">(Oct 13 2022 at 16:29)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303879279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303879279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303879279">(Oct 13 2022 at 16:43)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994888375">PR review comment</a>:</p>
<blockquote>
<p>We do in the runtests: there's a case that checks the return value with <code>2</code> as the argument to <code>select</code> in <code>runtests/br.clif</code>.</p>
</blockquote>



<a name="303879280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303879280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303879280">(Oct 13 2022 at 16:43)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1141160425">PR review</a>.</p>



<a name="303879468"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303879468" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303879468">(Oct 13 2022 at 16:44)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#pullrequestreview-1141161916">PR review</a>.</p>



<a name="303879469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303879469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303879469">(Oct 13 2022 at 16:44)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/5031#discussion_r994889267">PR review comment</a>:</p>
<blockquote>
<p>That's a great idea, I'll add that test!</p>
</blockquote>



<a name="303887537"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303887537" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303887537">(Oct 13 2022 at 17:25)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303931973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303931973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303931973">(Oct 13 2022 at 22:07)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="303940062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/303940062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#303940062">(Oct 13 2022 at 23:28)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="304558497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/304558497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#304558497">(Oct 17 2022 at 21:07)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="304561426"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/304561426" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#304561426">(Oct 17 2022 at 21:25)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="304563626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/304563626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#304563626">(Oct 17 2022 at 21:39)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a> from <code>trevor/remove-booleans</code> to <code>main</code>.</p>



<a name="304575987"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235031%20cranelift%3A%20Remove%20booleans/near/304575987" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235031.20cranelift.3A.20Remove.20booleans.html#304575987">(Oct 17 2022 at 23:00)</a>:</h4>
<p>elliottt merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5031">PR #5031</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>