<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1310 Enable jitdump profiling support by d... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html">wasmtime / PR #1310 Enable jitdump profiling support by d...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="190532293"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190532293" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190532293">(Mar 13 2020 at 17:32)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="190535540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190535540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190535540">(Mar 13 2020 at 17:57)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374504945" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374504945">PR Review</a>.</p>



<a name="190535541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190535541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190535541">(Mar 13 2020 at 17:58)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392385795" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392385795">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>performance, so typically when executing wasm you&#39;ll be quite interested in how
</pre></div>


</blockquote>



<a name="190539889"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190539889" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190539889">(Mar 13 2020 at 18:37)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="190540116"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190540116" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190540116">(Mar 13 2020 at 18:39)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="190540186"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190540186" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190540186">(Mar 13 2020 at 18:40)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="190544275"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190544275" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190544275">(Mar 13 2020 at 19:21)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="190560005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190560005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190560005">(Mar 13 2020 at 22:04)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374643603" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374643603">PR Review</a>.</p>



<a name="190560011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190560011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190560011">(Mar 13 2020 at 22:04)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392506652" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392506652">PR Review Comment</a>:</p>
<blockquote>
<p>This is great.  I see the link to it in SUMMAR.mdY, but does the SUMMARY.md get published anywhere? I could only find it on the github view of this branch by clicking through the source tree and not any official links to docs found on the opening Readme.</p>
</blockquote>



<a name="190560175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190560175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190560175">(Mar 13 2020 at 22:06)</a>:</h4>
<p>jlb6740 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392506652" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392506652">PR Review Comment</a>.</p>



<a name="190562316"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190562316" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190562316">(Mar 13 2020 at 22:34)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374653527" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374653527">PR Review</a>.</p>



<a name="190562317"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190562317" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190562317">(Mar 13 2020 at 22:34)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392514817" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392514817">PR Review Comment</a>:</p>
<blockquote>
<p>Ah yeah these are auto-published from the master branch at <a href="https://bytecodealliance.github.io/wasmtime/" target="_blank" title="https://bytecodealliance.github.io/wasmtime/">https://bytecodealliance.github.io/wasmtime/</a></p>
</blockquote>



<a name="190562405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190562405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190562405">(Mar 13 2020 at 22:35)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374653983" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374653983">PR Review</a>.</p>



<a name="190562406"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190562406" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190562406">(Mar 13 2020 at 22:35)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392515163" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392515163">PR Review Comment</a>:</p>
<blockquote>
<p>In particular the <code>SUMMARY.md</code> is the table of contents on the left hand side. More info in the <code>mdbook</code> user guide: <a href="https://rust-lang.github.io/mdBook/format/summary.html" target="_blank" title="https://rust-lang.github.io/mdBook/format/summary.html">https://rust-lang.github.io/mdBook/format/summary.html</a></p>
</blockquote>



<a name="190562979"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190562979" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190562979">(Mar 13 2020 at 22:44)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374656454" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-374656454">PR Review</a>.</p>



<a name="190562980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190562980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190562980">(Mar 13 2020 at 22:44)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392517258" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r392517258">PR Review Comment</a>:</p>
<blockquote>
<p>@fitzgen .. Ahh I see. Thanks. I clicked on docs here linked to at the bottom here: <a href="https://github.com/alexcrichton/wasmtime/tree/profiling" target="_blank" title="https://github.com/alexcrichton/wasmtime/tree/profiling">https://github.com/alexcrichton/wasmtime/tree/profiling</a> for this pr, but I didn't notice that link was going to be linking back to master. Got to be carefully following links like that.</p>
</blockquote>



<a name="190876039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/190876039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#190876039">(Mar 17 2020 at 16:39)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="191177187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191177187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191177187">(Mar 19 2020 at 21:23)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen" target="_blank" title="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a>.</p>



<a name="191177344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191177344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191177344">(Mar 19 2020 at 21:24)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="191263634"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263634" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263634">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-378156437" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-378156437">PR Review</a>.</p>



<a name="191263635"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263635" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263635">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-378156437" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-378156437">PR Review</a>.</p>



<a name="191263636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263636">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395371365" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395371365">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>    /// No profiler support.
</pre></div>


</blockquote>



<a name="191263637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263637">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395371432" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395371432">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>/// Select which profiling technique to support.
</pre></div>


</blockquote>



<a name="191263638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263638">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395371697" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395371697">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>    /// Collect profiling info for the &quot;jitdump&quot; file format, used with `perf` on Linux.
</pre></div>


</blockquote>



<a name="191263639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263639">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395376852" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395376852">PR Review Comment</a>:</p>
<blockquote>
<p>Why aren't we using <code>std::time::Instant::now</code> here? If there's a reason, it deserves a comment. If there isn't a reason, then we should use it ;)</p>
</blockquote>



<a name="191263640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191263640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191263640">(Mar 20 2020 at 16:05)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395737639" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395737639">PR Review Comment</a>:</p>
<blockquote>
<p>A screenshot here would be nice <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="191267607"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191267607" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191267607">(Mar 20 2020 at 16:33)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-378638165" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#pullrequestreview-378638165">PR Review</a>.</p>



<a name="191267608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191267608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191267608">(Mar 20 2020 at 16:33)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395755703" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310#discussion_r395755703">PR Review Comment</a>:</p>
<blockquote>
<p>Good idea! Looks like though <code>Instant</code> doesn't allow accessing nanoseconds-since-the-epoch, so I'll leave a comment saying that.</p>
</blockquote>



<a name="191269084"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191269084" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191269084">(Mar 20 2020 at 16:44)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a> from <code>profiling</code> to <code>master</code>:</p>
<blockquote>
<p>This the result of some of the investigation I was doing for #1017. I've<br>
done a number of refactorings here which culminated in a number of<br>
changes that all amount to what I think should result in jitdump support being<br>
enabled by default:</p>
<ul>
<li>
<p>Pass in a list of finished functions instead of just a range to<br>
  ensure that we're emitting jit dump data for a specific module rather<br>
  than a whole <code>CodeMemory</code> which may have other modules.</p>
</li>
<li>
<p>Define <code>ProfilingStrategy</code> in the <code>wasmtime</code> crate to have everything<br>
  locally-defined</p>
</li>
<li>
<p>Add support to the C API to enable profiling</p>
</li>
<li>Documentation added for profiling with jitdump to the book</li>
<li>
<p>Split out supported/unsupported files in <code>jitdump.rs</code> to avoid having<br>
  lots of <code>#[cfg]</code>.</p>
</li>
<li>
<p>Make dependencies optional that are only used for <code>jitdump</code>.</p>
</li>
<li>
<p>Move initialization up-front to <code>JitDumpAgent::new()</code> instead of<br>
  deferring it to the first module.</p>
</li>
<li>
<p>Pass around <code>Arc&lt;dyn ProfilingAgent&gt;</code> instead of<br>
<code>Option&lt;Arc&lt;Mutex&lt;Box&lt;dyn ProfilingAgent&gt;&gt;&gt;&gt;</code></p>
</li>
</ul>
<p>The <code>jitdump</code> Cargo feature is now enabled by default which means that<br>
our published binaries, C API artifacts, and crates will support<br>
profiling at runtime by default. The support I don't think is fully<br>
fleshed out and working but I think it's probably in a good enough spot<br>
we can get users playing around with it!</p>
</blockquote>



<a name="191269129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231310%20Enable%20jitdump%20profiling%20support%20by%20d.../near/191269129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231310.20Enable.20jitdump.20profiling.20support.20by.20d.2E.2E.2E.html#191269129">(Mar 20 2020 at 16:44)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1310" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1310">PR #1310</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>