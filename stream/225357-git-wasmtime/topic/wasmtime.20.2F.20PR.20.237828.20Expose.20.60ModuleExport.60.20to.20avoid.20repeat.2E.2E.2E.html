<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7828 Expose `ModuleExport` to avoid repeat... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html">wasmtime / PR #7828 Expose `ModuleExport` to avoid repeat...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="418378262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418378262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418378262">(Jan 27 2024 at 02:18)</a>:</h4>
<p>grovesNL edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>.</p>



<a name="418382723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418382723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418382723">(Jan 27 2024 at 03:29)</a>:</h4>
<p>grovesNL edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#issuecomment-1912915588">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>:</p>
<blockquote>
<p>Thanks for clarifying! I updated the PR to match the scheme you described.</p>
<p>Is the purpose of including <code>CompiledModuleId</code> on <code>ModuleExport</code> just out of convenience for user code, or should we compare these somewhere during <code>get_module_export</code>?</p>
</blockquote>



<a name="418387290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418387290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418387290">(Jan 27 2024 at 04:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#issuecomment-1912986726">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @peterhuene</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>peterhuene: wasmtime:api</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="418447964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418447964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418447964">(Jan 27 2024 at 21:32)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#pullrequestreview-1847288175">PR review</a>:</p>
<blockquote>
<p>Looks great thanks! Just a few minor comments but otherwise looks good to go.</p>
<blockquote>
<p>Is the purpose of including CompiledModuleId on ModuleExport just out of convenience for user code, or should we compare these somewhere during get_module_export?</p>
</blockquote>
<p>I commented below as well, but we'll want to check this when looking up exports to prevent this mistake of using the wrong module's exports to index an instance.</p>
</blockquote>



<a name="418447965"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418447965" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418447965">(Jan 27 2024 at 21:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#discussion_r1468658198">PR review comment</a>:</p>
<blockquote>
<p>Could the above method delegate to this one? Additionally could this one lookup in <code>data.exports</code> to use the cache if it's already filled in? And finally, mind adding a link to <code>Module::get_export_index</code> in the docs of this function?</p>
</blockquote>



<a name="418447966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418447966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418447966">(Jan 27 2024 at 21:32)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#pullrequestreview-1847288175">PR review</a>:</p>
<blockquote>
<p>Looks great thanks! Just a few minor comments but otherwise looks good to go.</p>
<blockquote>
<p>Is the purpose of including CompiledModuleId on ModuleExport just out of convenience for user code, or should we compare these somewhere during get_module_export?</p>
</blockquote>
<p>I commented below as well, but we'll want to check this when looking up exports to prevent this mistake of using the wrong module's exports to index an instance.</p>
</blockquote>



<a name="418447967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418447967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418447967">(Jan 27 2024 at 21:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#discussion_r1468658248">PR review comment</a>:</p>
<blockquote>
<p>Mind making these private and/or <code>pub(crate)</code>? Ideally users shouldn't have to actually look at these fields.</p>
</blockquote>



<a name="418447968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418447968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418447968">(Jan 27 2024 at 21:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#discussion_r1468658322">PR review comment</a>:</p>
<blockquote>
<p>Also, can this method perform a check that <code>export.module</code> is the same as the module used to create this instance? That prevents a mistake where you get a <code>ModuleExport</code> from one module but look it up in the wrong instance.</p>
</blockquote>



<a name="418459773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418459773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418459773">(Jan 28 2024 at 00:54)</a>:</h4>
<p>grovesNL updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>.</p>



<a name="418460069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418460069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418460069">(Jan 28 2024 at 01:00)</a>:</h4>
<p>grovesNL <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#issuecomment-1913393560">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>:</p>
<blockquote>
<p>Thank you for the feedback! I updated the PR. I moved the lookup into the shared <code>_get_export</code> function and pass the entity and index to that instead (checking the module ID is only necessary for the new function).</p>
</blockquote>



<a name="418460107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418460107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418460107">(Jan 28 2024 at 01:01)</a>:</h4>
<p>grovesNL updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>.</p>



<a name="418460786"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418460786" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418460786">(Jan 28 2024 at 01:13)</a>:</h4>
<p>grovesNL updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>.</p>



<a name="418463273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418463273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418463273">(Jan 28 2024 at 02:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7828#pullrequestreview-1847356751">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="418464717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237828%20Expose%20%60ModuleExport%60%20to%20avoid%20repeat.../near/418464717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237828.20Expose.20.60ModuleExport.60.20to.20avoid.20repeat.2E.2E.2E.html#418464717">(Jan 28 2024 at 02:29)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7828">PR #7828</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>