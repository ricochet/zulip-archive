<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7561 Configure workspace lints, enable run... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html">wasmtime / PR #7561 Configure workspace lints, enable run...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="403245532"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245532" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245532">(Nov 20 2023 at 21:07)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a> from <code>alexcrichton:lint-config</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This PR is a series of commits building up to the ability to selectively enable clippy lints to prevent issues such as <a href="https://github.com/bytecodealliance/wasmtime/issues/7558">https://github.com/bytecodealliance/wasmtime/issues/7558</a> from occurring. The root cause of the issue is the behavior of casting a smaller integer to a larger integer and switching signs. For example casting an i8 to a u32. I certainly don't remember whether this is a zero-extend or a sign-extend, and I suspect that I'm not alone. Ideally I was looking for a lint to help weed these out on CI. </p>
<p>Unfortunately rustc does not have a lint for this. Clippy, however, has a somewhat similar lint called <code>cast_sign_loss</code>. Empowered with Rust's 1.74 release and Cargo's addition of a <code>[lints]</code> configuration for workspaces, I realized this seemed like a reasonable time to kick the tires. Historically Wasmtime hasn't enabled Clippy because it's too noisy by default and it's too cumbersome to turn it off for all crates. With <code>[lints]</code> however it's a single line to turn off all clippy for the entire workspace, which felt like a much better balance to me at least.</p>
<p>First configuring <code>[lints]</code> as well as <code>[workspace.lints]</code> helped moved some lint configuration for various crates into one location. Afterwards all clippy lints were then disabled and then <code>cargo clippy</code> was added to CI. It turns out that <code>cast_sign_loss</code> is still too noisy for our purposes to enable for the whole workspace, but it can be selectively enabled for a few crates in question which do at least much of the casting for values at runtime.</p>
<p>This is intended to be somewhat of a trial run to see if we can make running Clippy in CI useful. I'm sure Clippy has other useful lints for helping to catch issues as well as helping with stylistic things for contributors. For now everything is left disabled but if desired selective lints can be enabled as necessary.</p>
</blockquote>



<a name="403245534"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245534" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245534">(Nov 20 2023 at 21:07)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-fuzz-reviewers">wasmtime-fuzz-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403245539"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245539" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245539">(Nov 20 2023 at 21:07)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/abrown">abrown</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403245540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245540">(Nov 20 2023 at 21:07)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403245543"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245543" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245543">(Nov 20 2023 at 21:07)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403245545"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245545" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245545">(Nov 20 2023 at 21:07)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403245546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403245546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403245546">(Nov 20 2023 at 21:07)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403248818"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403248818" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403248818">(Nov 20 2023 at 21:31)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7561#pullrequestreview-1740716141">PR review</a>.</p>



<a name="403259513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403259513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403259513">(Nov 20 2023 at 22:56)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<a name="403265328"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237561%20Configure%20workspace%20lints%2C%20enable%20run.../near/403265328" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237561.20Configure.20workspace.20lints.2C.20enable.20run.2E.2E.2E.html#403265328">(Nov 20 2023 at 23:50)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7561">PR #7561</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>