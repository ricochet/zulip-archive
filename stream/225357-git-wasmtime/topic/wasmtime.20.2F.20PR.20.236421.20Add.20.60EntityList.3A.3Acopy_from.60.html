<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6421 Add `EntityList::copy_from` · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html">wasmtime / PR #6421 Add `EntityList::copy_from`</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="360091598"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360091598" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360091598">(May 21 2023 at 16:53)</a>:</h4>
<p>PROMETHIA-27 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a> from <code>PROMETHIA-27:entity_list_copy_from</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This PR adds a new method to <code>EntityList</code> called <code>copy_from</code>, which works very similarly to <code>copy_within</code> on <code>Vec</code> in stdlib. It allows copying a slice from one <code>EntityList</code> to a given index in another, with only one reference to a <code>ListPool</code>. If <code>None</code> is passed for the other <code>EntityList</code> argument, it copies from within a single list. </p>
<p>This method allows efficiently copying between and within <code>EntityList</code>s without requiring unsafe (of which I'm not sure there are any sound public-facing approaches) or intermediate <code>Vec</code>s to store <code>T</code> in.</p>
<p>I'm not <em>entirely</em> confident that I've implemented this fully correctly, but I'm unaware of any ways in which it is incorrect and the moderately complex test I've added passes, as well as all others (which shouldn't be affected anyway).</p>
</blockquote>



<a name="360091601"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360091601" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360091601">(May 21 2023 at 16:53)</a>:</h4>
<p><strong>PROMETHIA-27</strong> requested <a href="https://github.com/elliottt">elliottt</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a>.</p>



<a name="360091602"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360091602" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360091602">(May 21 2023 at 16:53)</a>:</h4>
<p><strong>PROMETHIA-27</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a>.</p>



<a name="360395593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360395593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360395593">(May 22 2023 at 23:40)</a>:</h4>
<p>PROMETHIA-27 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a>.</p>



<a name="360395908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360395908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360395908">(May 22 2023 at 23:44)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1201301785">PR review comment</a>:</p>
<blockquote>
<p>Which of these asserts is expected to panic?</p>
</blockquote>



<a name="360396500"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360396500" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360396500">(May 22 2023 at 23:51)</a>:</h4>
<p>PROMETHIA-27 created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1201306555">PR review comment</a>:</p>
<blockquote>
<p>Neither; it would panic in the <code>copy_from</code>. I just copied them from the other test since they were examples that are now prohibited.</p>
</blockquote>



<a name="360417130"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360417130" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360417130">(May 23 2023 at 03:23)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1201464923">PR review comment</a>:</p>
<blockquote>
<p>Would you mind commenting the call where you expect the exception to happen, just so that it's super clear for anyone debugging the test?</p>
</blockquote>



<a name="360509248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/360509248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#360509248">(May 23 2023 at 12:00)</a>:</h4>
<p>PROMETHIA-27 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a>.</p>



<a name="361365886"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361365886" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361365886">(May 26 2023 at 15:37)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#pullrequestreview-1446493313">PR review</a>:</p>
<blockquote>
<p>This looks good to me with comments addressed, thank you!</p>
</blockquote>



<a name="361365889"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361365889" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361365889">(May 26 2023 at 15:37)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1206970933">PR review comment</a>:</p>
<blockquote>
<p>Thank you for this assertion, it definitely makes it easier to see that the use of <code>copy_within</code> is fine. Do you plan to follow-up with a PR to remove the need for the assert?</p>
</blockquote>



<a name="361365891"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361365891" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361365891">(May 26 2023 at 15:37)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1206971448">PR review comment</a>:</p>
<blockquote>
<p>Could you add a note to the doc comment that the function will panic if <code>other</code> is the same as <code>self</code>?</p>
</blockquote>



<a name="361365892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361365892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361365892">(May 26 2023 at 15:37)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#pullrequestreview-1446493313">PR review</a>:</p>
<blockquote>
<p>This looks good to me with comments addressed, thank you!</p>
</blockquote>



<a name="361545016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361545016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361545016">(May 27 2023 at 11:18)</a>:</h4>
<p>PROMETHIA-27 created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1207888423">PR review comment</a>:</p>
<blockquote>
<p>I'll try to get around to it, but it might be a minute</p>
</blockquote>



<a name="361545109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361545109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361545109">(May 27 2023 at 11:18)</a>:</h4>
<p>PROMETHIA-27 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a>.</p>



<a name="361545119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/361545119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#361545119">(May 27 2023 at 11:18)</a>:</h4>
<p>PROMETHIA-27 created <a href="https://github.com/bytecodealliance/wasmtime/pull/6421#discussion_r1207888745">PR review comment</a>:</p>
<blockquote>
<p>Done!</p>
</blockquote>



<a name="362328216"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236421%20Add%20%60EntityList%3A%3Acopy_from%60/near/362328216" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236421.20Add.20.60EntityList.3A.3Acopy_from.60.html#362328216">(May 31 2023 at 01:43)</a>:</h4>
<p>elliottt merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6421">PR #6421</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>