<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1992 Refactor the InstSize enum in the AAr... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html">wasmtime / PR #1992 Refactor the InstSize enum in the AAr...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="203255193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203255193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203255193">(Jul 08 2020 at 11:13)</a>:</h4>
<p>akirilov-arm opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1992">PR #1992</a> from <code>InstSize</code> to <code>main</code>:</p>
<blockquote>
<p>As discussed in #1748, the main issue with the <code>InstSize</code> enum was that it was used both for GPR and SIMD &amp; FP operands, even though machine instructions do not mix them in general (as in a destination register is either a GPR or not). As a result it had methods such as <code>sf_bit()</code> that made sense only for one type of operand.</p>
<p>Another issue was that the enum name was not reflecting its purpose accurately - it was meant to represent an instruction operand size, not an instruction size, which is fixed in A64 (always 4 bytes).</p>
<p>Now the enum is split into one for GPR operands and another for scalar SIMD &amp; FP operands.</p>
</blockquote>



<a name="203257705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203257705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203257705">(Jul 08 2020 at 11:45)</a>:</h4>
<p>akirilov-arm updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1992">PR #1992</a> from <code>InstSize</code> to <code>main</code>:</p>
<blockquote>
<p>As discussed in #1748, the main issue with the <code>InstSize</code> enum was that it was used both for GPR and SIMD &amp; FP operands, even though machine instructions do not mix them in general (as in a destination register is either a GPR or not). As a result it had methods such as <code>sf_bit()</code> that made sense only for one type of operand.</p>
<p>Another issue was that the enum name was not reflecting its purpose accurately - it was meant to represent an instruction operand size, not an instruction size, which is fixed in A64 (always 4 bytes).</p>
<p>Now the enum is split into one for GPR operands and another for scalar SIMD &amp; FP operands.</p>
</blockquote>



<a name="203746988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203746988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203746988">(Jul 13 2020 at 17:52)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1992#pullrequestreview-447411680">PR Review</a>.</p>



<a name="203746989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203746989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203746989">(Jul 13 2020 at 17:52)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1992#pullrequestreview-447411680">PR Review</a>.</p>



<a name="203746991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203746991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203746991">(Jul 13 2020 at 17:52)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1992#discussion_r453776742">PR Review Comment</a>:</p>
<blockquote>
<p>Perhaps use a <code>match</code> here, and panic if <code>bits</code> isn't exactly 8 / 16 / 32 / 64 / 128? I'm not sure what it would mean to have (e.g.) a 24-bit scalar...</p>
</blockquote>



<a name="203746992"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203746992" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203746992">(Jul 13 2020 at 17:52)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/1992#discussion_r453777139">PR Review Comment</a>:</p>
<blockquote>
<p>Doc-comment here indicating that it returns encoding bits</p>
</blockquote>



<a name="203838478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203838478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203838478">(Jul 14 2020 at 14:18)</a>:</h4>
<p>akirilov-arm updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1992">PR #1992</a> from <code>InstSize</code> to <code>main</code>:</p>
<blockquote>
<p>As discussed in #1748, the main issue with the <code>InstSize</code> enum was that it was used both for GPR and SIMD &amp; FP operands, even though machine instructions do not mix them in general (as in a destination register is either a GPR or not). As a result it had methods such as <code>sf_bit()</code> that made sense only for one type of operand.</p>
<p>Another issue was that the enum name was not reflecting its purpose accurately - it was meant to represent an instruction operand size, not an instruction size, which is fixed in A64 (always 4 bytes).</p>
<p>Now the enum is split into one for GPR operands and another for scalar SIMD &amp; FP operands.</p>
</blockquote>



<a name="203838733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203838733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203838733">(Jul 14 2020 at 14:20)</a>:</h4>
<p>akirilov-arm submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1992#pullrequestreview-448153195">PR Review</a>.</p>



<a name="203838734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203838734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203838734">(Jul 14 2020 at 14:20)</a>:</h4>
<p>akirilov-arm created <a href="https://github.com/bytecodealliance/wasmtime/pull/1992#discussion_r454392256">PR Review Comment</a>:</p>
<blockquote>
<p>This just mirrors the original logic in <code>InstSize</code>. Anyway, I figured out a way to express it succinctly.</p>
</blockquote>



<a name="203851307"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231992%20Refactor%20the%20InstSize%20enum%20in%20the%20AAr.../near/203851307" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231992.20Refactor.20the.20InstSize.20enum.20in.20the.20AAr.2E.2E.2E.html#203851307">(Jul 14 2020 at 15:58)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1992">PR #1992</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>