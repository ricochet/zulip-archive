<html>
<head><meta charset="utf-8"><title>wasmtime / PR #701 Virtual file support · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html">wasmtime / PR #701 Virtual file support</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189853306"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189853306" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189853306">(Mar 06 2020 at 00:47)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370013086" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370013086">PR Review</a>.</p>



<a name="189853571"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189853571" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189853571">(Mar 06 2020 at 00:52)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/701" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701">PR #701</a> from <code>virtfs</code> to <code>master</code>:</p>
<blockquote>
<p>This PR adds support for virtual files (so, file-like objects not necessarily backed by bytes on a local disk) for most WASI APIs. It also includes an implementation of virtual files (<code>InMemoryFile</code>) and directories (<code>VirtualDir</code>). Functionally this is transparent to users of wasi-common.</p>
<p>The intent here is to support operations on entities that are logically files, even if they may not be what the host OS calls "a file". These might be entirely artificial (like <code>/dev/random</code>, though <code>__wasi_random_get()</code> already exists), static data acquired over the network at open rather than at read, or some other file-like semantic that shouldn't be obligated to go through a filesystem.</p>
<p>For tests that have preopened directories, this <a href="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-3d6332bd4e89788572ef39df8db3783bR123-R128" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-3d6332bd4e89788572ef39df8db3783bR123-R128">duplicates the tests</a> for <code>VirtualDir</code>/<code>InMemoryFile</code>-backed testing. Actual test runner changes are pretty small as well: <a href="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-6bb07f6d2e62ac9c41406cd4d888db1aR29-R41" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-6bb07f6d2e62ac9c41406cd4d888db1aR29-R41">https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-6bb07f6d2e62ac9c41406cd4d888db1aR29-R41</a>. Additionally, I have a small branch against <code>lucet</code>,  <a href="https://github.com/bytecodealliance/lucet/pull/375" target="_blank" title="https://github.com/bytecodealliance/lucet/pull/375">https://github.com/bytecodealliance/lucet/pull/375</a>, to see this in action on our test programs there.</p>
<p>(edit: updated description to reflect that this is no longer a draft PR)</p>
</blockquote>



<a name="189895908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189895908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189895908">(Mar 06 2020 at 14:12)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370348735" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370348735">PR Review</a>.</p>



<a name="189895909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189895909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189895909">(Mar 06 2020 at 14:12)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/701#discussion_r388923543" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701#discussion_r388923543">PR Review Comment</a>:</p>
<blockquote>
<p>Cool! I guess we can refactor this in a subsequent PR :-)</p>
</blockquote>



<a name="189896235"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189896235" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189896235">(Mar 06 2020 at 14:15)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370349533" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370349533">PR Review</a>.</p>



<a name="189896236"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189896236" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189896236">(Mar 06 2020 at 14:15)</a>:</h4>
<p>kubkon submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370349533" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701#pullrequestreview-370349533">PR Review</a>.</p>



<a name="189896237"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189896237" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189896237">(Mar 06 2020 at 14:15)</a>:</h4>
<p>kubkon created <a href="https://github.com/bytecodealliance/wasmtime/pull/701#discussion_r388924175" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701#discussion_r388924175">PR Review Comment</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span>pub(crate) fn path_create_directory(base: &amp;File, path: &amp;str) -&gt; Result&lt;()&gt; {
</pre></div>


<p>Looks like an explicit lifetime is not needed here after all.</p>
</blockquote>



<a name="189916740"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189916740" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189916740">(Mar 06 2020 at 17:46)</a>:</h4>
<p>iximeow updated <a href="https://github.com/bytecodealliance/wasmtime/pull/701" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701">PR #701</a> from <code>virtfs</code> to <code>master</code>:</p>
<blockquote>
<p>This PR adds support for virtual files (so, file-like objects not necessarily backed by bytes on a local disk) for most WASI APIs. It also includes an implementation of virtual files (<code>InMemoryFile</code>) and directories (<code>VirtualDir</code>). Functionally this is transparent to users of wasi-common.</p>
<p>The intent here is to support operations on entities that are logically files, even if they may not be what the host OS calls "a file". These might be entirely artificial (like <code>/dev/random</code>, though <code>__wasi_random_get()</code> already exists), static data acquired over the network at open rather than at read, or some other file-like semantic that shouldn't be obligated to go through a filesystem.</p>
<p>For tests that have preopened directories, this <a href="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-3d6332bd4e89788572ef39df8db3783bR123-R128" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-3d6332bd4e89788572ef39df8db3783bR123-R128">duplicates the tests</a> for <code>VirtualDir</code>/<code>InMemoryFile</code>-backed testing. Actual test runner changes are pretty small as well: <a href="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-6bb07f6d2e62ac9c41406cd4d888db1aR29-R41" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-6bb07f6d2e62ac9c41406cd4d888db1aR29-R41">https://github.com/bytecodealliance/wasmtime/pull/701/files#diff-6bb07f6d2e62ac9c41406cd4d888db1aR29-R41</a>. Additionally, I have a small branch against <code>lucet</code>,  <a href="https://github.com/bytecodealliance/lucet/pull/375" target="_blank" title="https://github.com/bytecodealliance/lucet/pull/375">https://github.com/bytecodealliance/lucet/pull/375</a>, to see this in action on our test programs there.</p>
<p>(edit: updated description to reflect that this is no longer a draft PR)</p>
</blockquote>



<a name="189924387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23701%20Virtual%20file%20support/near/189924387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23701.20Virtual.20file.20support.html#189924387">(Mar 06 2020 at 19:08)</a>:</h4>
<p>iximeow merged <a href="https://github.com/bytecodealliance/wasmtime/pull/701" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/701">PR #701</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>