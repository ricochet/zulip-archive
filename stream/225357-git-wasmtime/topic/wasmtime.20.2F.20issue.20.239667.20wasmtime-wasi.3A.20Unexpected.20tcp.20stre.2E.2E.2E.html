<html>
<head><meta charset="utf-8"><title>wasmtime / issue #9667 wasmtime-wasi: Unexpected tcp stre... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239667.20wasmtime-wasi.3A.20Unexpected.20tcp.20stre.2E.2E.2E.html">wasmtime / issue #9667 wasmtime-wasi: Unexpected tcp stre...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="484870254"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239667%20wasmtime-wasi%3A%20Unexpected%20tcp%20stre.../near/484870254" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239667.20wasmtime-wasi.3A.20Unexpected.20tcp.20stre.2E.2E.2E.html#484870254">(Nov 28 2024 at 09:05)</a>:</h4>
<p>Heap-Hop edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9667">issue #9667</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/67674881db5fbdbba8594feb52655aaa351a5f77/crates/wasi/src/tcp.rs#L719-L723">https://github.com/bytecodealliance/wasmtime/blob/67674881db5fbdbba8594feb52655aaa351a5f77/crates/wasi/src/tcp.rs#L719-L723</a></p>
<p>Returning <code>0</code> for <code>std::io::ErrorKind::WouldBlock</code> causes downstream to interpret it as a closed stream, see: <br>
<a href="https://github.com/yoshuawuyts/wstd/issues/25#issuecomment-2493294087">https://github.com/yoshuawuyts/wstd/issues/25#issuecomment-2493294087</a>.<br>
<a href="https://github.com/yoshuawuyts/wstd/blob/5ce367add5e7bcb569b6487453cb9ba94468dc99/src/io/copy.rs#L12">https://github.com/yoshuawuyts/wstd/blob/5ce367add5e7bcb569b6487453cb9ba94468dc99/src/io/copy.rs#L12</a></p>
<p>This is also found in:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/67674881db5fbdbba8594feb52655aaa351a5f77/crates/test-programs/src/bin/preview2_tcp_streams.rs#L17-L22">https://github.com/bytecodealliance/wasmtime/blob/67674881db5fbdbba8594feb52655aaa351a5f77/crates/test-programs/src/bin/preview2_tcp_streams.rs#L17-L22</a></p>
<p><del>Given that the <code>wit</code> files already include many <code>would-block</code> errors, would it make sense to extend <code>stream-error</code> to include a <code>would-block</code>?</del><br>
</p>
</blockquote>



<a name="484933596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239667%20wasmtime-wasi%3A%20Unexpected%20tcp%20stre.../near/484933596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239667.20wasmtime-wasi.3A.20Unexpected.20tcp.20stre.2E.2E.2E.html#484933596">(Nov 28 2024 at 14:29)</a>:</h4>
<p>Heap-Hop <a href="https://github.com/bytecodealliance/wasmtime/issues/9667#issuecomment-2506253514">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9667">issue #9667</a>:</p>
<blockquote>
<p>@pchickey <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/12070585313/job/33660435175?pr=9691#step:18:419">https://github.com/bytecodealliance/wasmtime/actions/runs/12070585313/job/33660435175?pr=9691#step:18:419</a></p>
</blockquote>



<a name="484957857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239667%20wasmtime-wasi%3A%20Unexpected%20tcp%20stre.../near/484957857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239667.20wasmtime-wasi.3A.20Unexpected.20tcp.20stre.2E.2E.2E.html#484957857">(Nov 28 2024 at 16:45)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/9667#issuecomment-2506498842">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9667">issue #9667</a>:</p>
<blockquote>
<p>Thanks! Its a holiday weekend here so I’ll get to this next week.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>