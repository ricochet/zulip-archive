<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1455 cranelift-object: mark output as usin... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html">wasmtime / PR #1455 cranelift-object: mark output as usin...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="192544064"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192544064" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192544064">(Apr 01 2020 at 15:16)</a>:</h4>
<p>froydnj opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1455" title="https://github.com/bytecodealliance/wasmtime/pull/1455">PR #1455</a> from <code>object-noexecstack</code> to <code>master</code>:</p>
<blockquote>
<p>The <code>faerie</code> crate does this by default.  <code>object</code> itself does not, but<br>
it seems reasonable to make this change for parity between<br>
<code>cranelift-faerie</code> and <code>cranelift-object</code>.</p>
</blockquote>



<a name="192549869"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192549869" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192549869">(Apr 01 2020 at 15:53)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385721827" title="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385721827">PR Review</a>.</p>



<a name="192549870"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192549870" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192549870">(Apr 01 2020 at 15:53)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#discussion_r401723075" title="https://github.com/bytecodealliance/wasmtime/pull/1455#discussion_r401723075">PR Review Comment</a>:</p>
<blockquote>
<p>Should this only be added for GNU systems or is it fine to just keep it on other systems without purpose?</p>
</blockquote>



<a name="192549931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192549931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192549931">(Apr 01 2020 at 15:53)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385722293" title="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385722293">PR Review</a>.</p>



<a name="192552242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192552242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192552242">(Apr 01 2020 at 16:08)</a>:</h4>
<p>froydnj submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385735741" title="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385735741">PR Review</a>.</p>



<a name="192552243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192552243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192552243">(Apr 01 2020 at 16:08)</a>:</h4>
<p>froydnj created <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#discussion_r401734362" title="https://github.com/bytecodealliance/wasmtime/pull/1455#discussion_r401734362">PR Review Comment</a>:</p>
<blockquote>
<p>I read this as "should we only add this for <code>*gnu</code> targets (e.g. not FreeBSD)" or "should we unconditionally add it everywhere (e.g. Darwin, Windows)", is that correct?  I don't think we should add it everywhere, so that leaves just the first question.</p>
<p>Browsing through assembly files in Firefox (Firefox code itself and various third-party libraries), it looks like people are inconsistent in their choices: some restrict this note to Linux-only and some restrict it to ELF-only.  I think making the condition <code>target_lexicon::OperatingSystem::Linux</code> would be fine-ish (I don't know what the *BSDs do with respect to this section; I see that <code>lld</code> ignores this section entirely and controls executable stack-ness with a command-line switch).  I don't think I'd want to try to condition on <code>*gnu</code>-ness; matching on <a href="https://docs.rs/target-lexicon/0.10.0/target_lexicon/enum.Environment.html" title="https://docs.rs/target-lexicon/0.10.0/target_lexicon/enum.Environment.html"><code>target_lexicon::Environment</code></a> to catch all of the cases would be annoying, I think -- and maybe you also have to catch musl-ness etc. as well?</p>
<p>Making it ELF-only seems like the safest option, and the linker should just drop these sections anyway.</p>
</blockquote>



<a name="192553582"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192553582" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192553582">(Apr 01 2020 at 16:19)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385744388" title="https://github.com/bytecodealliance/wasmtime/pull/1455#pullrequestreview-385744388">PR Review</a>.</p>



<a name="192553584"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192553584" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192553584">(Apr 01 2020 at 16:19)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1455#discussion_r401741385" title="https://github.com/bytecodealliance/wasmtime/pull/1455#discussion_r401741385">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>I read this as "should we only add this for *gnu targets (e.g. not FreeBSD)" or "should we unconditionally add it everywhere (e.g. Darwin, Windows)", is that correct?</p>
</blockquote>
<p>Almost. I meant should this be added for all ELF systems, or only GNU based ones.</p>
<blockquote>
<p>I think making the condition target_lexicon::OperatingSystem::Linux would be fine-ish</p>
</blockquote>
<p>There are several non-Linux systems which use a GNU userspace, like Hurd and (as option?) Plan 9.</p>
<blockquote>
<p>I see that lld ignores this section entirely and controls executable stack-ness with a command-line switch</p>
</blockquote>
<p><span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> <code>.note.GNU-stack</code> makes it way too easy to accidentally end up with an executable stack.</p>
<blockquote>
<p>Making it ELF-only seems like the safest option, and the linker should just drop these sections anyway.</p>
</blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>
</blockquote>



<a name="192553795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231455%20cranelift-object%3A%20mark%20output%20as%20usin.../near/192553795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231455.20cranelift-object.3A.20mark.20output.20as.20usin.2E.2E.2E.html#192553795">(Apr 01 2020 at 16:20)</a>:</h4>
<p>froydnj merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1455" title="https://github.com/bytecodealliance/wasmtime/pull/1455">PR #1455</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>