<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1246 Refactor SIMD implementation · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html">wasmtime / PR #1246 Refactor SIMD implementation</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189920533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189920533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189920533">(Mar 06 2020 at 18:27)</a>:</h4>
<p>abrown opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">PR #1246</a> from <code>refactor-simd</code> to <code>master</code>:</p>
<blockquote>
<p>Before adding the remaining SIMD instructions, I thought it would be good to clean up the current implementation. I have tried to be very careful to avoid any change to behavior when renaming/moving things around. The changes are:</p>
<ul>
<li>To reduce compile times (along the lines of #1168), I separated out some instructions and legalizations into their own <code>define</code> methods</li>
<li>For filetest clarity, I renamed all x86 SIMD filetests with a <code>simd-</code> prefix and removed the <code>%test_</code> prefix of the individual test functions (I've noticed that Cranelift chops off the ends of those functions so the <code>test_</code> prefix can hide which test is failing)</li>
</ul>
</blockquote>



<a name="189935720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189935720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189935720">(Mar 06 2020 at 21:21)</a>:</h4>
<p><strong>peterhuene</strong> requested <a href="https://github.com/bnjbvr" target="_blank" title="https://github.com/bnjbvr">bnjbvr</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">PR #1246</a>.</p>



<a name="189935727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189935727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189935727">(Mar 06 2020 at 21:21)</a>:</h4>
<p><strong>peterhuene</strong> requested <a href="https://github.com/bnjbvr" target="_blank" title="https://github.com/bnjbvr">bnjbvr</a>, and <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">PR #1246</a>.</p>



<a name="189935731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189935731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189935731">(Mar 06 2020 at 21:21)</a>:</h4>
<p><strong>peterhuene</strong> requested <a href="https://github.com/peterhuene" target="_blank" title="https://github.com/peterhuene">peterhuene</a>, <a href="https://github.com/bnjbvr" target="_blank" title="https://github.com/bnjbvr">bnjbvr</a>, and <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">PR #1246</a>.</p>



<a name="189935901"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189935901" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189935901">(Mar 06 2020 at 21:23)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370635149" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370635149">PR Review</a>.</p>



<a name="189938169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938169">(Mar 06 2020 at 21:51)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370646185" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370646185">PR Review</a>.</p>



<a name="189938170"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938170" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938170">(Mar 06 2020 at 21:51)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370646185" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370646185">PR Review</a>.</p>



<a name="189938171"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938171" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938171">(Mar 06 2020 at 21:51)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#discussion_r389161299" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#discussion_r389161299">PR Review Comment</a>:</p>
<blockquote>
<p>Please keep comments wrapped at 100 columns or so (which is the rustfmt column limit, except it doesn't automatically split up comments).</p>
</blockquote>



<a name="189938172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938172">(Mar 06 2020 at 21:51)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#discussion_r389159841" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#discussion_r389159841">PR Review Comment</a>:</p>
<blockquote>
<p>Why is this line being removed?</p>
</blockquote>



<a name="189938705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938705">(Mar 06 2020 at 21:58)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370652059" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370652059">PR Review</a>.</p>



<a name="189938706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938706">(Mar 06 2020 at 21:58)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#discussion_r389164236" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#discussion_r389164236">PR Review Comment</a>:</p>
<blockquote>
<p>As we discussed offline, this is a <code>run</code> test, so it naturally uses the host as the target.</p>
</blockquote>



<a name="189938718"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189938718" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189938718">(Mar 06 2020 at 21:58)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370652181" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246#pullrequestreview-370652181">PR Review</a>.</p>



<a name="189940610"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189940610" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189940610">(Mar 06 2020 at 22:22)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">PR #1246</a> from <code>refactor-simd</code> to <code>master</code>:</p>
<blockquote>
<p>Before adding the remaining SIMD instructions, I thought it would be good to clean up the current implementation. I have tried to be very careful to avoid any change to behavior when renaming/moving things around. The changes are:</p>
<ul>
<li>To reduce compile times (along the lines of #1168), I separated out some instructions and legalizations into their own <code>define</code> methods</li>
<li>For filetest clarity, I renamed all x86 SIMD filetests with a <code>simd-</code> prefix and removed the <code>%test_</code> prefix of the individual test functions (I've noticed that Cranelift chops off the ends of those functions so the <code>test_</code> prefix can hide which test is failing)</li>
</ul>
</blockquote>



<a name="189942956"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231246%20Refactor%20SIMD%20implementation/near/189942956" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231246.20Refactor.20SIMD.20implementation.html#189942956">(Mar 06 2020 at 22:57)</a>:</h4>
<p>abrown merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1246" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1246">PR #1246</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>