<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1232 Integrate Lightbeam with latest Wasmt... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html">wasmtime / PR #1232 Integrate Lightbeam with latest Wasmt...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189789224"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189789224" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189789224">(Mar 05 2020 at 13:15)</a>:</h4>
<p>Vurich opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. Additionally, this PR implements the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
</blockquote>



<a name="189789901"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189789901" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189789901">(Mar 05 2020 at 13:20)</a>:</h4>
<p>Vurich edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="189790075"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189790075" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189790075">(Mar 05 2020 at 13:21)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="189803001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803001">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-369632425" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-369632425">PR Review</a>.</p>



<a name="189803003"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803003" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803003">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-369632425" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-369632425">PR Review</a>.</p>



<a name="189803004"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803004" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803004">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388342393" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388342393">PR Review Comment</a>:</p>
<blockquote>
<p>Was this TODO left intentionally?</p>
</blockquote>



<a name="189803005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803005">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388345795" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388345795">PR Review Comment</a>:</p>
<blockquote>
<p><code>TryFrom</code>? Should probably be something like </p>
<div class="codehilite"><pre><span></span><span class="kt">u32</span>::<span class="n">try_from</span><span class="p">(</span><span class="n">function_body</span><span class="p">.</span><span class="n">module_offset</span><span class="p">).</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Module offset overflowed u32&quot;</span><span class="p">)</span><span class="w"></span>
</pre></div>


</blockquote>



<a name="189803006"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803006" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803006">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388344358" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388344358">PR Review Comment</a>:</p>
<blockquote>
<p>Could this under/overflow?</p>
</blockquote>



<a name="189803007"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803007" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803007">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388353404" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388353404">PR Review Comment</a>:</p>
<blockquote>
<p>Redundant <code>;</code>?</p>
</blockquote>



<a name="189803008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803008">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388366113" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388366113">PR Review Comment</a>:</p>
<blockquote>
<p>Was this commented out intentionally?</p>
</blockquote>



<a name="189803009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803009">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388346948" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388346948">PR Review Comment</a>:</p>
<blockquote>
<p>Naming is inconsistent with other variables. Should probably be <code>offset_sink</code>.</p>
</blockquote>



<a name="189803048"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/189803048" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#189803048">(Mar 05 2020 at 15:32)</a>:</h4>
<p>0x7CFE deleted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388353404" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r388353404">PR Review Comment</a>.</p>



<a name="190115707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115707">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-371477789" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-371477789">PR Review</a>.</p>



<a name="190115708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115708">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-371477789" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-371477789">PR Review</a>.</p>



<a name="190115709"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115709" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115709">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389920822" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389920822">PR Review Comment</a>:</p>
<blockquote>
<p>In this patch, the only thing calling this <code>vmctx_builtin_function</code> has a <code>BuiltinFunctionIndex</code> which is converted to a <code>u32</code> with <code>.index()</code>. Instead of converting it to <code>u32</code> and back to <code>BuiltinFunctionIndex</code>, could we just pass around a <code>BuiltinFunctionIndex</code> everywhere?</p>
</blockquote>



<a name="190115710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115710">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389928260" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389928260">PR Review Comment</a>:</p>
<blockquote>
<p>I don't see <code>auto_enums</code> being used anywhere in this patch; is it needed?</p>
</blockquote>



<a name="190115711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115711">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389936714" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389936714">PR Review Comment</a>:</p>
<blockquote>
<p>Switching the wasm decoder is a very big change, and it's not clear what motivates it, or how it's connected to the rest of the PR. Could you split this part into a separate PR so that we can discuss it separately?</p>
</blockquote>



<a name="190115712"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115712" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115712">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389946317" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389946317">PR Review Comment</a>:</p>
<blockquote>
<p>Would it be possible to split out the changes that introduce the dependency on <code>chain_one</code> into a separate PR? Changes introducing new external dependencies are something we'd like to consider carefully, and it's difficult to do that when it's bundled together with the rest of the changes here.</p>
</blockquote>



<a name="190115713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190115713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190115713">(Mar 09 2020 at 20:43)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389931774" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r389931774">PR Review Comment</a>:</p>
<blockquote>
<p>Is this dependency on <code>hashers</code> needed?</p>
</blockquote>



<a name="190500110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190500110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190500110">(Mar 13 2020 at 13:08)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="190500604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190500604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190500604">(Mar 13 2020 at 13:13)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="190502066"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190502066" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190502066">(Mar 13 2020 at 13:28)</a>:</h4>
<p>Vurich submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-374297930" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-374297930">PR Review</a>.</p>



<a name="190502067"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190502067" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190502067">(Mar 13 2020 at 13:28)</a>:</h4>
<p>Vurich created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r392226586" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r392226586">PR Review Comment</a>:</p>
<blockquote>
<p>So as we weren't integrated with the latest Wasmtime for a while, this PR includes some changes that were implemented separately, before the integration. This work was part of two features: firstly, implementing trap information, and secondly converting Lightbeam to use <code>R: Read</code> everywhere instead of requiring a slice. It was used for the trap information as it hands control of the reader back to Lightbeam, so that Lightbeam can act independently of the parser WRT source location and other metadata. Specifically, it makes it so that Lightbeam can get the current position without requiring <code>wasmparser</code> to implement a specific accessor for the specific property we want. Both of these features would be very difficult to include separately to the rest of the work, as the integration with master was implemented on top of them. You can check the tests for <code>wasm-reader</code>, though, as it has an extensive test suite comparing it against <code>wasmparser</code>.</p>
</blockquote>



<a name="190504276"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/190504276" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#190504276">(Mar 13 2020 at 13:48)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="191589905"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/191589905" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#191589905">(Mar 24 2020 at 10:23)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="191592674"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/191592674" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#191592674">(Mar 24 2020 at 10:49)</a>:</h4>
<p>Vurich submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-380192886" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-380192886">PR Review</a>.</p>



<a name="191592675"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/191592675" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#191592675">(Mar 24 2020 at 10:49)</a>:</h4>
<p>Vurich created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r397060304" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r397060304">PR Review Comment</a>:</p>
<blockquote>
<p>Unfortunately the <code>BuiltinFunctionIndex</code> passed to this function and the <code>BuiltinFunctionIndex</code> used in the implementation of this function are not the same. I had to copy-paste the implementation to get the correct indices for the built-in functions and use <code>u32</code> for the types in the trait because otherwise I get cyclical dependencies - many of the types I would need to use are defined in <code>wasmtime-environ</code>, but Lightbeam is itself a dependency of <code>wasmtime-environ</code>.</p>
</blockquote>



<a name="191592696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/191592696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#191592696">(Mar 24 2020 at 10:50)</a>:</h4>
<p>Vurich edited <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r397060304" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r397060304">PR Review Comment</a>.</p>



<a name="192036261"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/192036261" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#192036261">(Mar 27 2020 at 15:43)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="192260680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/192260680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#192260680">(Mar 30 2020 at 14:10)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="192375884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/192375884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#192375884">(Mar 31 2020 at 11:28)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="192377425"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/192377425" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#192377425">(Mar 31 2020 at 11:46)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="192380324"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/192380324" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#192380324">(Mar 31 2020 at 12:16)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="192397428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/192397428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#192397428">(Mar 31 2020 at 14:31)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="193524481"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/193524481" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#193524481">(Apr 09 2020 at 23:51)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-391198375" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-391198375">PR Review</a>.</p>



<a name="193524483"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/193524483" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#193524483">(Apr 09 2020 at 23:51)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-391198375" title="https://github.com/bytecodealliance/wasmtime/pull/1232#pullrequestreview-391198375">PR Review</a>.</p>



<a name="193524484"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/193524484" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#193524484">(Apr 09 2020 at 23:51)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r406535349" title="https://github.com/bytecodealliance/wasmtime/pull/1232#discussion_r406535349">PR Review Comment</a>:</p>
<blockquote>
<p>Ok. Could you add TODO comments mentioning that, as we discussed offline, the better approach here would be to start factoring out some of this into a separate crate that both Lightbeam and Cranelift could use?</p>
</blockquote>



<a name="195055201"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/195055201" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#195055201">(Apr 23 2020 at 12:48)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="195393658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/195393658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#195393658">(Apr 27 2020 at 09:40)</a>:</h4>
<p>Vurich updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a> from <code>master</code> to <code>master</code>:</p>
<blockquote>
<p>This PR closes #979, as it integrates those changes along with the removal of <code>multi_mut</code> mentioned in that PR. All the spec tests are passing now, there were many weird bugs related to Lightbeam's lack of proper abstraction around the actual codegen, so hopefully this kind of change won't be so difficult in the future. This PR also implements trap info and the <code>ModuleAddressMap</code> debuginfo tagging in Lightbeam, although it's hard to tell if it is integrated correctly as there are no tests for it and as far as I can tell it's not possible to dump this information anywhere.</p>
<p>You'll see that because of the aforementioned lack of abstraction, a lot of the changes for the caller vmctx work seem pretty janky. I have plans to remove all the jankyness, but I figured it was most important to just get it working again before starting on any work doing rearchitecturing.</p>
<p>Additionally, there are a lot of indentation changes in <code>function_body</code> which make the +/- inaccurate and the diff hard to read, so consider using the "Hide whitespace changes" option in the diff settings.</p>
</blockquote>



<a name="195782741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231232%20Integrate%20Lightbeam%20with%20latest%20Wasmt.../near/195782741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231232.20Integrate.20Lightbeam.20with.20latest.20Wasmt.2E.2E.2E.html#195782741">(Apr 29 2020 at 23:26)</a>:</h4>
<p>sunfishcode merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1232" title="https://github.com/bytecodealliance/wasmtime/pull/1232">PR #1232</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>