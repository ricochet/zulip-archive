<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2826 Cranelift: srem.8 and srem.i16 not... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html">wasmtime / Issue #2826 Cranelift: srem.8 and srem.i16 not...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="234219046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234219046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234219046">(Apr 12 2021 at 19:48)</a>:</h4>
<p>bjorn3 labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<h3><code>.clif</code> Test Case</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">function</span><span class="w"> </span><span class="n">u0</span>:<span class="mi">42</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i8</span><span class="p">,</span><span class="w"> </span><span class="kt">i8</span><span class="w"> </span><span class="n">system_v</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="n">block0</span>:
    <span class="nc">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i32</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v36</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">brz</span><span class="w"> </span><span class="n">v21</span><span class="p">,</span><span class="w"> </span><span class="n">block10</span><span class="w"></span>
<span class="w">    </span><span class="n">jump</span><span class="w"> </span><span class="n">block6</span><span class="w"></span>

<span class="n">block6</span>:
    <span class="nc">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>

<span class="n">block10</span>:
    <span class="nc">v27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">srem</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="n">v0</span><span class="p">,</span><span class="w"> </span><span class="n">v36</span><span class="w"></span>
<span class="w">    </span><span class="n">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<ul>
<li>Compile for x86_64</li>
</ul>
<h3>Expected Results</h3>
<p>Compiles</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">dst_size</span><span class="p">.</span><span class="n">is_one_of</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="n">OperandSize</span>::<span class="n">Size32</span><span class="p">,</span><span class="w"> </span><span class="n">OperandSize</span>::<span class="n">Size64</span><span class="p">])</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">50</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">imm</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">emit</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="n">emit</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">492</span>:<span class="mi">32</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachInstEmit</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2804</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">vcode</span>::<span class="n">VCode</span><span class="o">&lt;</span><span class="n">I</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">machinst</span><span class="o">/</span><span class="n">vcode</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">531</span>:<span class="mi">17</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">63</span>:<span class="mi">22</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">197</span>:<span class="mi">26</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile_and_emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">137</span>:<span class="mi">20</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Cranelift version or commit: 67cc42d4c39cb95eafd6b1b0304326ba609ca7e9</p>
<p>Operating system: N/A</p>
<p>Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>Likely introduced in <a href="https://github.com/bytecodealliance/wasmtime/pull/2763">https://github.com/bytecodealliance/wasmtime/pull/2763</a>.</p>
<p>I also saw another error when trying to update Cranelift, but I haven't found a standalone repro yet:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">rustc</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">not</span><span class="w"> </span><span class="n">implemented</span>: <span class="nc">integer</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span>: <span class="kt">i16</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bjorn</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">67</span><span class="n">cc42d</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1134</span>:<span class="mi">26</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">store</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">gen_store_stack_multi</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">ABICalleeImpl</span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi</span>::<span class="n">ABICallee</span><span class="o">&gt;</span>::<span class="n">gen_spill</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">add_spills_reloads_and_moves</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">edit_inst_stream</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">regalloc</span>::<span class="n">bt_main</span>::<span class="n">alloc_main</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">regalloc</span>::<span class="n">allocate_registers_with_opts</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">compile</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="o">&lt;</span><span class="n">cranelift_object</span>::<span class="n">backend</span>::<span class="n">ObjectModule</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_module</span>::<span class="n">module</span>::<span class="n">Module</span><span class="o">&gt;</span>::<span class="n">define_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">base</span>::<span class="n">codegen_fn</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">module_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">rustc_query_system</span>::<span class="n">dep_graph</span>::<span class="n">graph</span>::<span class="n">DepGraph</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span>::<span class="n">with_task</span><span class="w"></span>
<span class="w">  </span><span class="mi">17</span>: <span class="o">&lt;</span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">adapters</span>::<span class="n">map</span>::<span class="n">Map</span><span class="o">&lt;</span><span class="n">I</span><span class="p">,</span><span class="n">F</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">traits</span>::<span class="n">iterator</span>::<span class="nb">Iterator</span><span class="o">&gt;</span>::<span class="n">fold</span><span class="w"></span>
<span class="w">  </span><span class="mi">18</span>: <span class="o">&lt;</span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="n">spec_from_iter</span>::<span class="n">SpecFromIter</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">I</span><span class="o">&gt;&gt;</span>::<span class="n">from_iter</span><span class="w"></span>
<span class="w">  </span><span class="mi">19</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">20</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">21</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">run_aot</span><span class="w"></span>
<span class="w">  </span><span class="mi">22</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">23</span>: <span class="o">&lt;</span><span class="n">rustc_codegen_cranelift</span>::<span class="n">CraneliftCodegenBackend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rustc_codegen_ssa</span>::<span class="n">traits</span>::<span class="n">backend</span>::<span class="n">CodegenBackend</span><span class="o">&gt;</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">24</span>: <span class="nc">rustc_interface</span>::<span class="n">passes</span>::<span class="n">QueryContext</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">25</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="n">Queries</span>::<span class="n">ongoing_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">26</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_interface</span>::<span class="n">interface</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">27</span>: <span class="nc">rustc_span</span>::<span class="n">with_source_map</span><span class="w"></span>
<span class="w">  </span><span class="mi">28</span>: <span class="nc">rustc_interface</span>::<span class="n">interface</span>::<span class="n">create_compiler_and_run</span><span class="w"></span>
<span class="w">  </span><span class="mi">29</span>: <span class="nc">scoped_tls</span>::<span class="n">ScopedKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">set</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">internal</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">error</span>: <span class="nc">unexpected</span><span class="w"> </span><span class="n">panic</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">Unrecognized</span><span class="w"> </span><span class="n">option</span>: <span class="o">'</span><span class="na">clif</span><span class="o">'</span>

<span class="nc">Instance</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">def</span>: <span class="nc">Item</span><span class="p">(</span><span class="n">WithOptConstParam</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">did</span>: <span class="nc">DefId</span><span class="p">(</span><span class="mi">0</span>:<span class="mi">581</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">core</span><span class="p">[</span><span class="mi">8231</span><span class="p">]</span>::<span class="n">num</span>::<span class="n">dec2flt</span>::<span class="n">rawfp</span>::<span class="n">big_to_fp</span><span class="p">),</span><span class="w"> </span><span class="n">const_param_did</span>: <span class="nb">None</span> <span class="p">}),</span><span class="w"> </span><span class="n">substs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">_ZN4core3num7dec2flt5rawfp9big_to_fp17h0ff476ec949ff22dE</span><span class="w"></span>
</code></pre></div>
</blockquote>



<a name="234219047"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234219047" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234219047">(Apr 12 2021 at 19:48)</a>:</h4>
<p>bjorn3 opened <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<h3><code>.clif</code> Test Case</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">function</span><span class="w"> </span><span class="n">u0</span>:<span class="mi">42</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i8</span><span class="p">,</span><span class="w"> </span><span class="kt">i8</span><span class="w"> </span><span class="n">system_v</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="n">block0</span>:
    <span class="nc">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i32</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v36</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">brz</span><span class="w"> </span><span class="n">v21</span><span class="p">,</span><span class="w"> </span><span class="n">block10</span><span class="w"></span>
<span class="w">    </span><span class="n">jump</span><span class="w"> </span><span class="n">block6</span><span class="w"></span>

<span class="n">block6</span>:
    <span class="nc">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>

<span class="n">block10</span>:
    <span class="nc">v27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">srem</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="n">v0</span><span class="p">,</span><span class="w"> </span><span class="n">v36</span><span class="w"></span>
<span class="w">    </span><span class="n">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<ul>
<li>Compile for x86_64</li>
</ul>
<h3>Expected Results</h3>
<p>Compiles</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">dst_size</span><span class="p">.</span><span class="n">is_one_of</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="n">OperandSize</span>::<span class="n">Size32</span><span class="p">,</span><span class="w"> </span><span class="n">OperandSize</span>::<span class="n">Size64</span><span class="p">])</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">50</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">imm</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">emit</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="n">emit</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">492</span>:<span class="mi">32</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachInstEmit</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2804</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">vcode</span>::<span class="n">VCode</span><span class="o">&lt;</span><span class="n">I</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">machinst</span><span class="o">/</span><span class="n">vcode</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">531</span>:<span class="mi">17</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">63</span>:<span class="mi">22</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">197</span>:<span class="mi">26</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile_and_emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">137</span>:<span class="mi">20</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Cranelift version or commit: 67cc42d4c39cb95eafd6b1b0304326ba609ca7e9</p>
<p>Operating system: N/A</p>
<p>Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>Likely introduced in <a href="https://github.com/bytecodealliance/wasmtime/pull/2763">https://github.com/bytecodealliance/wasmtime/pull/2763</a>.</p>
<p>I also saw another error when trying to update Cranelift, but I haven't found a standalone repro yet:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">rustc</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">not</span><span class="w"> </span><span class="n">implemented</span>: <span class="nc">integer</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span>: <span class="kt">i16</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bjorn</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">67</span><span class="n">cc42d</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1134</span>:<span class="mi">26</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">store</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">gen_store_stack_multi</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">ABICalleeImpl</span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi</span>::<span class="n">ABICallee</span><span class="o">&gt;</span>::<span class="n">gen_spill</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">add_spills_reloads_and_moves</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">edit_inst_stream</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">regalloc</span>::<span class="n">bt_main</span>::<span class="n">alloc_main</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">regalloc</span>::<span class="n">allocate_registers_with_opts</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">compile</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="o">&lt;</span><span class="n">cranelift_object</span>::<span class="n">backend</span>::<span class="n">ObjectModule</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_module</span>::<span class="n">module</span>::<span class="n">Module</span><span class="o">&gt;</span>::<span class="n">define_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">base</span>::<span class="n">codegen_fn</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">module_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">rustc_query_system</span>::<span class="n">dep_graph</span>::<span class="n">graph</span>::<span class="n">DepGraph</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span>::<span class="n">with_task</span><span class="w"></span>
<span class="w">  </span><span class="mi">17</span>: <span class="o">&lt;</span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">adapters</span>::<span class="n">map</span>::<span class="n">Map</span><span class="o">&lt;</span><span class="n">I</span><span class="p">,</span><span class="n">F</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">traits</span>::<span class="n">iterator</span>::<span class="nb">Iterator</span><span class="o">&gt;</span>::<span class="n">fold</span><span class="w"></span>
<span class="w">  </span><span class="mi">18</span>: <span class="o">&lt;</span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="n">spec_from_iter</span>::<span class="n">SpecFromIter</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">I</span><span class="o">&gt;&gt;</span>::<span class="n">from_iter</span><span class="w"></span>
<span class="w">  </span><span class="mi">19</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">20</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">21</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">run_aot</span><span class="w"></span>
<span class="w">  </span><span class="mi">22</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">23</span>: <span class="o">&lt;</span><span class="n">rustc_codegen_cranelift</span>::<span class="n">CraneliftCodegenBackend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rustc_codegen_ssa</span>::<span class="n">traits</span>::<span class="n">backend</span>::<span class="n">CodegenBackend</span><span class="o">&gt;</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">24</span>: <span class="nc">rustc_interface</span>::<span class="n">passes</span>::<span class="n">QueryContext</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">25</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="n">Queries</span>::<span class="n">ongoing_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">26</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_interface</span>::<span class="n">interface</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">27</span>: <span class="nc">rustc_span</span>::<span class="n">with_source_map</span><span class="w"></span>
<span class="w">  </span><span class="mi">28</span>: <span class="nc">rustc_interface</span>::<span class="n">interface</span>::<span class="n">create_compiler_and_run</span><span class="w"></span>
<span class="w">  </span><span class="mi">29</span>: <span class="nc">scoped_tls</span>::<span class="n">ScopedKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">set</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">internal</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">error</span>: <span class="nc">unexpected</span><span class="w"> </span><span class="n">panic</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">Unrecognized</span><span class="w"> </span><span class="n">option</span>: <span class="o">'</span><span class="na">clif</span><span class="o">'</span>

<span class="nc">Instance</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">def</span>: <span class="nc">Item</span><span class="p">(</span><span class="n">WithOptConstParam</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">did</span>: <span class="nc">DefId</span><span class="p">(</span><span class="mi">0</span>:<span class="mi">581</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">core</span><span class="p">[</span><span class="mi">8231</span><span class="p">]</span>::<span class="n">num</span>::<span class="n">dec2flt</span>::<span class="n">rawfp</span>::<span class="n">big_to_fp</span><span class="p">),</span><span class="w"> </span><span class="n">const_param_did</span>: <span class="nb">None</span> <span class="p">}),</span><span class="w"> </span><span class="n">substs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">_ZN4core3num7dec2flt5rawfp9big_to_fp17h0ff476ec949ff22dE</span><span class="w"></span>
</code></pre></div>
</blockquote>



<a name="234219048"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234219048" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234219048">(Apr 12 2021 at 19:48)</a>:</h4>
<p>bjorn3 labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<h3><code>.clif</code> Test Case</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">function</span><span class="w"> </span><span class="n">u0</span>:<span class="mi">42</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i8</span><span class="p">,</span><span class="w"> </span><span class="kt">i8</span><span class="w"> </span><span class="n">system_v</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="n">block0</span>:
    <span class="nc">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i32</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v36</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">brz</span><span class="w"> </span><span class="n">v21</span><span class="p">,</span><span class="w"> </span><span class="n">block10</span><span class="w"></span>
<span class="w">    </span><span class="n">jump</span><span class="w"> </span><span class="n">block6</span><span class="w"></span>

<span class="n">block6</span>:
    <span class="nc">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>

<span class="n">block10</span>:
    <span class="nc">v27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">srem</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="n">v0</span><span class="p">,</span><span class="w"> </span><span class="n">v36</span><span class="w"></span>
<span class="w">    </span><span class="n">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<ul>
<li>Compile for x86_64</li>
</ul>
<h3>Expected Results</h3>
<p>Compiles</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">dst_size</span><span class="p">.</span><span class="n">is_one_of</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="n">OperandSize</span>::<span class="n">Size32</span><span class="p">,</span><span class="w"> </span><span class="n">OperandSize</span>::<span class="n">Size64</span><span class="p">])</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">50</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">imm</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">emit</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="n">emit</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">492</span>:<span class="mi">32</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachInstEmit</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2804</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">vcode</span>::<span class="n">VCode</span><span class="o">&lt;</span><span class="n">I</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">machinst</span><span class="o">/</span><span class="n">vcode</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">531</span>:<span class="mi">17</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">63</span>:<span class="mi">22</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">197</span>:<span class="mi">26</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile_and_emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">137</span>:<span class="mi">20</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Cranelift version or commit: 67cc42d4c39cb95eafd6b1b0304326ba609ca7e9</p>
<p>Operating system: N/A</p>
<p>Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>Likely introduced in <a href="https://github.com/bytecodealliance/wasmtime/pull/2763">https://github.com/bytecodealliance/wasmtime/pull/2763</a>.</p>
<p>I also saw another error when trying to update Cranelift, but I haven't found a standalone repro yet:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">rustc</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">not</span><span class="w"> </span><span class="n">implemented</span>: <span class="nc">integer</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span>: <span class="kt">i16</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bjorn</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">67</span><span class="n">cc42d</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1134</span>:<span class="mi">26</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">store</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">gen_store_stack_multi</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">ABICalleeImpl</span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi</span>::<span class="n">ABICallee</span><span class="o">&gt;</span>::<span class="n">gen_spill</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">add_spills_reloads_and_moves</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">edit_inst_stream</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">regalloc</span>::<span class="n">bt_main</span>::<span class="n">alloc_main</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">regalloc</span>::<span class="n">allocate_registers_with_opts</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">compile</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="o">&lt;</span><span class="n">cranelift_object</span>::<span class="n">backend</span>::<span class="n">ObjectModule</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_module</span>::<span class="n">module</span>::<span class="n">Module</span><span class="o">&gt;</span>::<span class="n">define_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">base</span>::<span class="n">codegen_fn</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">module_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">rustc_query_system</span>::<span class="n">dep_graph</span>::<span class="n">graph</span>::<span class="n">DepGraph</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span>::<span class="n">with_task</span><span class="w"></span>
<span class="w">  </span><span class="mi">17</span>: <span class="o">&lt;</span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">adapters</span>::<span class="n">map</span>::<span class="n">Map</span><span class="o">&lt;</span><span class="n">I</span><span class="p">,</span><span class="n">F</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">traits</span>::<span class="n">iterator</span>::<span class="nb">Iterator</span><span class="o">&gt;</span>::<span class="n">fold</span><span class="w"></span>
<span class="w">  </span><span class="mi">18</span>: <span class="o">&lt;</span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="n">spec_from_iter</span>::<span class="n">SpecFromIter</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">I</span><span class="o">&gt;&gt;</span>::<span class="n">from_iter</span><span class="w"></span>
<span class="w">  </span><span class="mi">19</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">20</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">21</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">run_aot</span><span class="w"></span>
<span class="w">  </span><span class="mi">22</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">23</span>: <span class="o">&lt;</span><span class="n">rustc_codegen_cranelift</span>::<span class="n">CraneliftCodegenBackend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rustc_codegen_ssa</span>::<span class="n">traits</span>::<span class="n">backend</span>::<span class="n">CodegenBackend</span><span class="o">&gt;</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">24</span>: <span class="nc">rustc_interface</span>::<span class="n">passes</span>::<span class="n">QueryContext</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">25</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="n">Queries</span>::<span class="n">ongoing_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">26</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_interface</span>::<span class="n">interface</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">27</span>: <span class="nc">rustc_span</span>::<span class="n">with_source_map</span><span class="w"></span>
<span class="w">  </span><span class="mi">28</span>: <span class="nc">rustc_interface</span>::<span class="n">interface</span>::<span class="n">create_compiler_and_run</span><span class="w"></span>
<span class="w">  </span><span class="mi">29</span>: <span class="nc">scoped_tls</span>::<span class="n">ScopedKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">set</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">internal</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">error</span>: <span class="nc">unexpected</span><span class="w"> </span><span class="n">panic</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">Unrecognized</span><span class="w"> </span><span class="n">option</span>: <span class="o">'</span><span class="na">clif</span><span class="o">'</span>

<span class="nc">Instance</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">def</span>: <span class="nc">Item</span><span class="p">(</span><span class="n">WithOptConstParam</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">did</span>: <span class="nc">DefId</span><span class="p">(</span><span class="mi">0</span>:<span class="mi">581</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">core</span><span class="p">[</span><span class="mi">8231</span><span class="p">]</span>::<span class="n">num</span>::<span class="n">dec2flt</span>::<span class="n">rawfp</span>::<span class="n">big_to_fp</span><span class="p">),</span><span class="w"> </span><span class="n">const_param_did</span>: <span class="nb">None</span> <span class="p">}),</span><span class="w"> </span><span class="n">substs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">_ZN4core3num7dec2flt5rawfp9big_to_fp17h0ff476ec949ff22dE</span><span class="w"></span>
</code></pre></div>
</blockquote>



<a name="234222597"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234222597" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234222597">(Apr 12 2021 at 20:12)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/2826#issuecomment-818144913">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<p>Thanks for the report! I can take a look at some point, but I'm deep in a bunch of other stuff right now, so if you have some time and are willing to look at the lowering (I suspect it may just be a matter of using a narrower form), I'd be grateful and would be happy to review.</p>
<p>The regalloc issue I think may have come from a recent PR from @abrown that touched <code>Inst::store</code>; @abrown would you be willing to take a look to make sure spills/reloads of narrow values are handled properly?</p>
</blockquote>



<a name="234264499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234264499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234264499">(Apr 13 2021 at 03:54)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/wasmtime/issues/2826#issuecomment-818411816">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<p>Yeah, I can take a look.</p>
</blockquote>



<a name="234461334"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234461334" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234461334">(Apr 14 2021 at 08:33)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/2826#issuecomment-819338695">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<p>Fixed by #2828 and #2833.</p>
</blockquote>



<a name="234461335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232826%20Cranelift%3A%20srem.8%20and%20srem.i16%20not.../near/234461335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232826.20Cranelift.3A.20srem.2E8.20and.20srem.2Ei16.20not.2E.2E.2E.html#234461335">(Apr 14 2021 at 08:33)</a>:</h4>
<p>bjorn3 closed <a href="https://github.com/bytecodealliance/wasmtime/issues/2826">Issue #2826</a>:</p>
<blockquote>
<h3><code>.clif</code> Test Case</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">function</span><span class="w"> </span><span class="n">u0</span>:<span class="mi">42</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i8</span><span class="p">,</span><span class="w"> </span><span class="kt">i8</span><span class="w"> </span><span class="n">system_v</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="n">block0</span>:
    <span class="nc">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i32</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">v36</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iconst</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="n">brz</span><span class="w"> </span><span class="n">v21</span><span class="p">,</span><span class="w"> </span><span class="n">block10</span><span class="w"></span>
<span class="w">    </span><span class="n">jump</span><span class="w"> </span><span class="n">block6</span><span class="w"></span>

<span class="n">block6</span>:
    <span class="nc">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>

<span class="n">block10</span>:
    <span class="nc">v27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">srem</span><span class="p">.</span><span class="kt">i8</span><span class="w"> </span><span class="n">v0</span><span class="p">,</span><span class="w"> </span><span class="n">v36</span><span class="w"></span>
<span class="w">    </span><span class="n">trap</span><span class="w"> </span><span class="n">user0</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3>Steps to Reproduce</h3>
<ul>
<li>Compile for x86_64</li>
</ul>
<h3>Expected Results</h3>
<p>Compiles</p>
<h3>Actual Results</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">dst_size</span><span class="p">.</span><span class="n">is_one_of</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="n">OperandSize</span>::<span class="n">Size32</span><span class="p">,</span><span class="w"> </span><span class="n">OperandSize</span>::<span class="n">Size64</span><span class="p">])</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="mi">2</span><span class="n">fd73fabe469357a12c2c974c140f67e7cdd76d0</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">50</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">imm</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">666</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">emit</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="n">emit</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">492</span>:<span class="mi">32</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachInstEmit</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2804</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">vcode</span>::<span class="n">VCode</span><span class="o">&lt;</span><span class="n">I</span><span class="o">&gt;</span>::<span class="n">emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">machinst</span><span class="o">/</span><span class="n">vcode</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">531</span>:<span class="mi">17</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">63</span>:<span class="mi">22</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">197</span>:<span class="mi">26</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile_and_emit</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">137</span>:<span class="mi">20</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Cranelift version or commit: 67cc42d4c39cb95eafd6b1b0304326ba609ca7e9</p>
<p>Operating system: N/A</p>
<p>Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>Likely introduced in <a href="https://github.com/bytecodealliance/wasmtime/pull/2763">https://github.com/bytecodealliance/wasmtime/pull/2763</a>.</p>
<p>I also saw another error when trying to update Cranelift, but I haven't found a standalone repro yet:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">rustc</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">not</span><span class="w"> </span><span class="n">implemented</span>: <span class="nc">integer</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span>: <span class="kt">i16</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bjorn</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">checkouts</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="mi">41807828</span><span class="n">cb3a7a7e</span><span class="o">/</span><span class="mi">67</span><span class="n">cc42d</span><span class="o">/</span><span class="n">cranelift</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">inst</span><span class="o">/</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1134</span>:<span class="mi">26</span><span class="w"></span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span><span class="w"></span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c051c5ddda79f45fad196ca3a4690251e377d043</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">92</span>:<span class="mi">14</span><span class="w"></span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">Inst</span>::<span class="n">store</span><span class="w"></span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">gen_store_stack_multi</span><span class="w"></span>
<span class="w">   </span><span class="mi">4</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi_impl</span>::<span class="n">ABICalleeImpl</span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">abi</span>::<span class="n">ABICallee</span><span class="o">&gt;</span>::<span class="n">gen_spill</span><span class="w"></span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">add_spills_reloads_and_moves</span><span class="w"></span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">regalloc</span>::<span class="n">inst_stream</span>::<span class="n">edit_inst_stream</span><span class="w"></span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">regalloc</span>::<span class="n">bt_main</span>::<span class="n">alloc_main</span><span class="w"></span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">regalloc</span>::<span class="n">allocate_registers_with_opts</span><span class="w"></span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">compile</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">10</span>: <span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">MachBackend</span><span class="o">&gt;</span>::<span class="n">compile_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span><span class="w"></span>
<span class="w">  </span><span class="mi">12</span>: <span class="o">&lt;</span><span class="n">cranelift_object</span>::<span class="n">backend</span>::<span class="n">ObjectModule</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cranelift_module</span>::<span class="n">module</span>::<span class="n">Module</span><span class="o">&gt;</span>::<span class="n">define_function</span><span class="w"></span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">base</span>::<span class="n">codegen_fn</span><span class="w"></span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">module_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">rustc_query_system</span>::<span class="n">dep_graph</span>::<span class="n">graph</span>::<span class="n">DepGraph</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span>::<span class="n">with_task</span><span class="w"></span>
<span class="w">  </span><span class="mi">17</span>: <span class="o">&lt;</span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">adapters</span>::<span class="n">map</span>::<span class="n">Map</span><span class="o">&lt;</span><span class="n">I</span><span class="p">,</span><span class="n">F</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">core</span>::<span class="n">iter</span>::<span class="n">traits</span>::<span class="n">iterator</span>::<span class="nb">Iterator</span><span class="o">&gt;</span>::<span class="n">fold</span><span class="w"></span>
<span class="w">  </span><span class="mi">18</span>: <span class="o">&lt;</span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="n">spec_from_iter</span>::<span class="n">SpecFromIter</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">I</span><span class="o">&gt;&gt;</span>::<span class="n">from_iter</span><span class="w"></span>
<span class="w">  </span><span class="mi">19</span>: <span class="nc">rustc_session</span>::<span class="n">utils</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_session</span>::<span class="n">session</span>::<span class="n">Session</span><span class="o">&gt;</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">20</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">time</span><span class="w"></span>
<span class="w">  </span><span class="mi">21</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">aot</span>::<span class="n">run_aot</span><span class="w"></span>
<span class="w">  </span><span class="mi">22</span>: <span class="nc">rustc_codegen_cranelift</span>::<span class="n">driver</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">23</span>: <span class="o">&lt;</span><span class="n">rustc_codegen_cranelift</span>::<span class="n">CraneliftCodegenBackend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rustc_codegen_ssa</span>::<span class="n">traits</span>::<span class="n">backend</span>::<span class="n">CodegenBackend</span><span class="o">&gt;</span>::<span class="n">codegen_crate</span><span class="w"></span>
<span class="w">  </span><span class="mi">24</span>: <span class="nc">rustc_interface</span>::<span class="n">passes</span>::<span class="n">QueryContext</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">25</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="n">Queries</span>::<span class="n">ongoing_codegen</span><span class="w"></span>
<span class="w">  </span><span class="mi">26</span>: <span class="nc">rustc_interface</span>::<span class="n">queries</span>::<span class="o">&lt;</span><span class="k">impl</span><span class="w"> </span><span class="n">rustc_interface</span>::<span class="n">interface</span>::<span class="n">Compiler</span><span class="o">&gt;</span>::<span class="n">enter</span><span class="w"></span>
<span class="w">  </span><span class="mi">27</span>: <span class="nc">rustc_span</span>::<span class="n">with_source_map</span><span class="w"></span>
<span class="w">  </span><span class="mi">28</span>: <span class="nc">rustc_interface</span>::<span class="n">interface</span>::<span class="n">create_compiler_and_run</span><span class="w"></span>
<span class="w">  </span><span class="mi">29</span>: <span class="nc">scoped_tls</span>::<span class="n">ScopedKey</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span>::<span class="n">set</span><span class="w"></span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">internal</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">error</span>: <span class="nc">unexpected</span><span class="w"> </span><span class="n">panic</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">Unrecognized</span><span class="w"> </span><span class="n">option</span>: <span class="o">'</span><span class="na">clif</span><span class="o">'</span>

<span class="nc">Instance</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">def</span>: <span class="nc">Item</span><span class="p">(</span><span class="n">WithOptConstParam</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">did</span>: <span class="nc">DefId</span><span class="p">(</span><span class="mi">0</span>:<span class="mi">581</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">core</span><span class="p">[</span><span class="mi">8231</span><span class="p">]</span>::<span class="n">num</span>::<span class="n">dec2flt</span>::<span class="n">rawfp</span>::<span class="n">big_to_fp</span><span class="p">),</span><span class="w"> </span><span class="n">const_param_did</span>: <span class="nb">None</span> <span class="p">}),</span><span class="w"> </span><span class="n">substs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">_ZN4core3num7dec2flt5rawfp9big_to_fp17h0ff476ec949ff22dE</span><span class="w"></span>
</code></pre></div>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>