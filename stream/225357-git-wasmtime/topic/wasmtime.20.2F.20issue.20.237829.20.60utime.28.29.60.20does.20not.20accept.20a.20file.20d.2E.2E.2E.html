<html>
<head><meta charset="utf-8"><title>wasmtime / issue #7829 `utime()` does not accept a file d... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html">wasmtime / issue #7829 `utime()` does not accept a file d...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="418346734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/418346734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#418346734">(Jan 26 2024 at 20:27)</a>:</h4>
<p><a href="https://github.com/brettcannon">brettcannon</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">Issue #7829</a>.</p>



<a name="418346736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/418346736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#418346736">(Jan 26 2024 at 20:27)</a>:</h4>
<p>brettcannon opened <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>TODO: upload Wasm file here</p>
<h3>Steps to Reproduce</h3>
<ul>
<li><a href="https://github.com/python/cpython/blob/07236f5b39a2e534cf190cd4f7c73300d209520b/Lib/test/test_posix.py#L452-L454">https://github.com/python/cpython/blob/07236f5b39a2e534cf190cd4f7c73300d209520b/Lib/test/test_posix.py#L452-L454</a></li>
</ul>
<h3>Expected Results</h3>
<p>Test should pass (it does under preview 1).</p>
<h3>Actual Results</h3>
<p>Raises errno 63: <a href="https://docs.python.org/3/library/errno.html#errno.ENOSR"><code>ENOSR</code></a> (out of stream resources).</p>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 17.0.0</p>
<p>Operating system: Linux/WSL</p>
<p>Architecture: x64</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?</p>
<p>Success logs under preview 1: <br>
<a href="https://github.com/bytecodealliance/wasmtime/files/14069110/success-utime-fd.txt">success-utime-fd.txt</a></p>
<p>Failure logs under preview 2:<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/14069114/failure-utime-fd.txt">failure-utime-fd.txt</a><br>
</p>
</blockquote>



<a name="418356242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/418356242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#418356242">(Jan 26 2024 at 21:52)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1912743404">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<p>Could you perhaps reupload the failure logs? It currently seems to be empty and/or says success with no extra logs</p>
</blockquote>



<a name="418365697"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/418365697" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#418365697">(Jan 26 2024 at 23:31)</a>:</h4>
<p>brettcannon <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1912825812">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/files/14070134/failure-utime-fd.txt">failure-utime-fd.txt</a></p>
<p>Sorry about that!</p>
</blockquote>



<a name="419955165"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/419955165" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#419955165">(Feb 06 2024 at 00:51)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1928579086">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<p>@elliottt and I investigated this and will be posting a fix shortly.</p>
</blockquote>



<a name="419957346"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/419957346" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#419957346">(Feb 06 2024 at 01:15)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1928598422">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<p>@brettcannon We read the test source you linked to and believed we reproduced it in PR #7876 with a modification to one of our existing tests, and then fixed it in the same PR. I don't know how to run your tests locally to verify that this fixed it, but we think we got the underlying bug in our implementation fixed now. Please verify for us whether this is a fix when you have time, and also if it changes the status of any other of your posix tests, which exercise a lot more than our test suite.</p>
</blockquote>



<a name="420111867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/420111867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#420111867">(Feb 06 2024 at 18:45)</a>:</h4>
<p>brettcannon <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1930550657">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<blockquote>
<p>I don't know how to run your tests locally to verify that this fixed it</p>
</blockquote>
<p>FYI I'm working on better docs for this, but <a href="https://github.com/python/cpython/tree/main/Tools/wasm#wasi-wasm32-wasi">https://github.com/python/cpython/tree/main/Tools/wasm#wasi-wasm32-wasi</a> are the current docs if you're interested.</p>
<blockquote>
<p>Please verify for us whether this is a fix when you have time</p>
</blockquote>
<p>Will do! I'll plan to give it a try this week.</p>
<blockquote>
<p>if it changes the status of any other of your posix tests, which exercise a lot more than our test suite.</p>
</blockquote>
<p>Yeah, Python's test suite is old and extensive for this sort of thing: we're great at exercising C compilers and OSs. <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span> If you're ever interested in trying to get the Python test suite set up as a 3rd-party test suite to run, just let me know.</p>
</blockquote>



<a name="420758107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/420758107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#420758107">(Feb 10 2024 at 01:20)</a>:</h4>
<p>brettcannon <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1936792577">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<p>Commented at <a href="https://github.com/bytecodealliance/wasmtime/pull/7876#issuecomment-1936792352">https://github.com/bytecodealliance/wasmtime/pull/7876#issuecomment-1936792352</a> about the PR passing CPython's test suite.</p>
</blockquote>



<a name="421534078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/421534078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#421534078">(Feb 14 2024 at 21:15)</a>:</h4>
<p>pchickey closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>TODO: upload Wasm file here</p>
<h3>Steps to Reproduce</h3>
<ul>
<li><a href="https://github.com/python/cpython/blob/07236f5b39a2e534cf190cd4f7c73300d209520b/Lib/test/test_posix.py#L452-L454">https://github.com/python/cpython/blob/07236f5b39a2e534cf190cd4f7c73300d209520b/Lib/test/test_posix.py#L452-L454</a></li>
</ul>
<h3>Expected Results</h3>
<p>Test should pass (it does under preview 1).</p>
<h3>Actual Results</h3>
<p>Raises errno 63: <a href="https://docs.python.org/3/library/errno.html#errno.ENOSR"><code>ENOSR</code></a> (out of stream resources).</p>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: 17.0.0</p>
<p>Operating system: Linux/WSL</p>
<p>Architecture: x64</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?</p>
<p>Success logs under preview 1: <br>
<a href="https://github.com/bytecodealliance/wasmtime/files/14069110/success-utime-fd.txt">success-utime-fd.txt</a></p>
<p>Failure logs under preview 2:<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/14069114/failure-utime-fd.txt">failure-utime-fd.txt</a><br>
</p>
</blockquote>



<a name="421534079"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237829%20%60utime%28%29%60%20does%20not%20accept%20a%20file%20d.../near/421534079" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237829.20.60utime.28.29.60.20does.20not.20accept.20a.20file.20d.2E.2E.2E.html#421534079">(Feb 14 2024 at 21:15)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/7829#issuecomment-1944615597">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7829">issue #7829</a>:</p>
<blockquote>
<p>This landed in <code>main</code> and in <code>release-18.0.0</code> so I'm going to close it now. We chose not to release this fix as a patch release on <code>release-17.0.0</code> but if someone really needs it before 18 goes out in 7 days, we still could.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>