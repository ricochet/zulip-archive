<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3933 Take N mutations from `wasm-mutate... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html">wasmtime / issue #3933 Take N mutations from `wasm-mutate...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="275447074"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233933%20Take%20N%20mutations%20from%20%60wasm-mutate.../near/275447074" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html#275447074">(Mar 15 2022 at 22:59)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/issues/3933">issue #3933</a>:</p>
<blockquote>
<p>This will let us reuse <code>wasm-mutate</code>'s e-graph, if it constructed one, which is important since it can be expensive to construct and we want to amortize that.</p>
<p>Will need to use thread locals or something though to stash the iterator between calls to the custom mutator though.</p>
</blockquote>



<a name="275447075"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233933%20Take%20N%20mutations%20from%20%60wasm-mutate.../near/275447075" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html#275447075">(Mar 15 2022 at 22:59)</a>:</h4>
<p>fitzgen labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3933">issue #3933</a>:</p>
<blockquote>
<p>This will let us reuse <code>wasm-mutate</code>'s e-graph, if it constructed one, which is important since it can be expensive to construct and we want to amortize that.</p>
<p>Will need to use thread locals or something though to stash the iterator between calls to the custom mutator though.</p>
</blockquote>



<a name="275447126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233933%20Take%20N%20mutations%20from%20%60wasm-mutate.../near/275447126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html#275447126">(Mar 15 2022 at 22:59)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/issues/3933#issuecomment-1068545012">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3933">issue #3933</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "fuzzing"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: fuzzing</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="277191368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233933%20Take%20N%20mutations%20from%20%60wasm-mutate.../near/277191368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html#277191368">(Mar 30 2022 at 18:59)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/3933#issuecomment-1083509268">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3933">issue #3933</a>:</p>
<blockquote>
<p>Hm actually every time that libfuzzer calls our custom mutate hook with a specific input and seed, it expects the hook to return the same mutation. That would kinda break if we are first checking "do we have an existing iterator of mutations to draw from in thread local storage?" first rather than computing a fresh mutation from scratch.</p>
<p>Ideally libfuzzer would just let us return multiple mutations directly :-/</p>
<p>Not 100% sure how to resolve this, since we really <em>do</em> want to take advantage of the iterator to amortize the cost of e-graph construction.</p>
<p>Anyone have ideas?</p>
<p>Maybe it is actually just fine if we don't obey the same-input-and-seed-leads-to-same-mutation invariant?</p>
</blockquote>



<a name="277192388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233933%20Take%20N%20mutations%20from%20%60wasm-mutate.../near/277192388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html#277192388">(Mar 30 2022 at 19:07)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/3933#issuecomment-1083518922">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3933">issue #3933</a>:</p>
<blockquote>
<p>Would trying multiple wasm functions derived from the same wasm-mutate e-graph in a single libfuzzer fuzz round work? And then use a new e-graph for the next fuzz round.</p>
</blockquote>



<a name="277196454"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233933%20Take%20N%20mutations%20from%20%60wasm-mutate.../near/277196454" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233933.20Take.20N.20mutations.20from.20.60wasm-mutate.2E.2E.2E.html#277196454">(Mar 30 2022 at 19:45)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/3933#issuecomment-1083554515">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3933">issue #3933</a>:</p>
<blockquote>
<p>An e-graph is specific to a single expression, so the same expression would need to occur in multiple functions. And we would need to search and find all instances of that expression. I don't think this will be particularly fruitful.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>