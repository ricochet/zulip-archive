<html>
<head><meta charset="utf-8"><title>wasmtime / PR #819 Adds JIT profiling support using ittapi · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html">wasmtime / PR #819 Adds JIT profiling support using ittapi</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="190032241"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/190032241" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#190032241">(Mar 08 2020 at 23:20)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="190034698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/190034698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#190034698">(Mar 09 2020 at 00:47)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191663042"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191663042" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191663042">(Mar 24 2020 at 19:48)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191663108"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191663108" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191663108">(Mar 24 2020 at 19:49)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191667125"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191667125" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191667125">(Mar 24 2020 at 20:24)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191682790"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191682790" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191682790">(Mar 24 2020 at 22:50)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191684398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191684398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191684398">(Mar 24 2020 at 23:13)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191688467"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191688467" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191688467">(Mar 25 2020 at 00:04)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191751951"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751951" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751951">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381188002" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381188002">PR Review</a>.</p>



<a name="191751952"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751952" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751952">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381188002" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381188002">PR Review</a>.</p>



<a name="191751953"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751953" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751953">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397887160" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397887160">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW <code>jitdump</code> didn't actually require any extra C libraries or anything, so the ease of building it was why I went ahead and placed it in the default features. For the ittapi crate, however, it requires a native non-Rust toolchain, so we may want to leave this out of the default features for now while we sort out the build requirements there?</p>
</blockquote>



<a name="191751954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751954">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397888157" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397888157">PR Review Comment</a>:</p>
<blockquote>
<p>Is this perhaps stuck around from an old merge conflict?</p>
</blockquote>



<a name="191751955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751955">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397888772" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397888772">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW idiomatically <code>use</code> statements all appear at the top of the module</p>
</blockquote>



<a name="191751956"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751956" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751956">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397890023" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397890023">PR Review Comment</a>:</p>
<blockquote>
<p>How come this is cached internally? I don't think we publish code for the same module twice, so wouldn't we want to always create a new method id?</p>
</blockquote>



<a name="191751957"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751957" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751957">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397889444" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397889444">PR Review Comment</a>:</p>
<blockquote>
<p>This <code>.unwrap()</code> is likely to panic since I don't think that all wasm modules have names associated with them</p>
</blockquote>



<a name="191751958"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751958" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751958">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397890648" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397890648">PR Review Comment</a>:</p>
<blockquote>
<p>If this needs to be hooked up to get vtune working, I'd recommend implementing <code>Drop for VTuneAgent</code> which would call this method</p>
</blockquote>



<a name="191751961"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751961" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751961">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397891441" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397891441">PR Review Comment</a>:</p>
<blockquote>
<p>Is the <code>Box</code> here necessary in that <code>ijIT_NotifyEvent</code> is freeing the memory it's given? If the free isn't happening this may be a memory leak, but the <code>Box</code> isn't necessary here either if all that's needed is a pointer. For that you can just do <code>&amp;mut jmethod as *mut _ as *mut _</code></p>
</blockquote>



<a name="191751962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751962">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397889054" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397889054">PR Review Comment</a>:</p>
<blockquote>
<p>This may be stray now at this point?</p>
</blockquote>



<a name="191751963"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751963" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751963">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397891939" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397891939">PR Review Comment</a>:</p>
<blockquote>
<p>Should this be an argument to <code>module_load</code> perhaps? To try to get the source filename if possible?</p>
</blockquote>



<a name="191751964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191751964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191751964">(Mar 25 2020 at 14:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397892067" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r397892067">PR Review Comment</a>:</p>
<blockquote>
<p>er that is, an argument on the trait</p>
</blockquote>



<a name="191794004"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191794004" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191794004">(Mar 25 2020 at 18:48)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381440243" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381440243">PR Review</a>.</p>



<a name="191794005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191794005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191794005">(Mar 25 2020 at 18:48)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398090736" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398090736">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>@jlb6740 it looks like the new crate here is pulling in bindgen at build time I think, right? That's a pretty hefty dependency and one we'd ideally rather avoid. Would it be possible to check in the generated bindings from bindgen via a scheme like <a href="https://github.com/pepyakin/binaryen-rs/pull/52" title="https://github.com/pepyakin/binaryen-rs/pull/52">pepyakin/binaryen-rs#52</a> perhaps?</p>
</blockquote>
<p>Hi @alexcrichton, thanks for the comments. The profiling facilitated by a C library (<a href="https://github.com/intel/ittapi" title="https://github.com/intel/ittapi">https://github.com/intel/ittapi</a>) for instrumentation and tracing and so there is a sys crate that uses bindgen to create the rust interface.  Right now I think that crate isn't properly guarded on a windows build so that needs to be corrected, but it works well on linux. Yes .. we can make any update ... I am trying to digest the change here: <a href="https://github.com/pepyakin/binaryen-rs/pull/52/files" title="https://github.com/pepyakin/binaryen-rs/pull/52/files">https://github.com/pepyakin/binaryen-rs/pull/52/files</a>. Did you remove the build time dependence on bindgen .. do it ahead of time and put the resulting file in <a href="http://bindings.rs" title="http://bindings.rs">bindings.rs</a>? Is that what I am looking at there?</p>
</blockquote>



<a name="191794041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191794041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191794041">(Mar 25 2020 at 18:48)</a>:</h4>
<p>jlb6740 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398090736" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398090736">PR Review Comment</a>.</p>



<a name="191794139"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191794139" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191794139">(Mar 25 2020 at 18:49)</a>:</h4>
<p>jlb6740 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398090736" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398090736">PR Review Comment</a>.</p>



<a name="191803250"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191803250" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191803250">(Mar 25 2020 at 19:58)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381490197" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381490197">PR Review</a>.</p>



<a name="191803251"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191803251" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191803251">(Mar 25 2020 at 19:58)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398131617" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398131617">PR Review Comment</a>:</p>
<blockquote>
<p>@jlb6740 right yeah, I moved it to a <code>dev-dependencies</code> section so it's still verified that the bindings are correct on <code>cargo test</code>, but otherwise the generated bindings are checked into the tree so <code>bindgen</code> isn't needed at build time, only when testing the ittapi-rs crate</p>
</blockquote>



<a name="191814043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191814043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191814043">(Mar 25 2020 at 21:35)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398184719" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398184719">PR Review Comment</a>:</p>
<blockquote>
<p>This is a good question. I saved this for supporting other calls that would rely on the same methodID. Right now this pr only calls method_load for a function and then moves on, but there are other events that can be recorded that aren't included with this particular patch (<a href="https://software.intel.com/en-us/vtune-help-ijit-notifyevent" title="https://software.intel.com/en-us/vtune-help-ijit-notifyevent">https://software.intel.com/en-us/vtune-help-ijit-notifyevent</a>). Also .. I wasn't sure what the invoke flag was allowing now. In the past I ran an example wondering why my codes were running twice, only to realize I was using invoke when I did not need to. This was some <a href="http://action.rs" title="http://action.rs">action.rs</a> file where I had extra hooks, which looks like it is gone now but I was calling profiling hooks twice when maybe it wasn't needed. I wanted to cache methodID to prepare for this possibility as well.</p>
<p>Also note, this instrumentation is targeting jitted code but future updates should include APIs for help in instrumenting wasmtime itself: <a href="https://software.intel.com/en-us/vtune-help-instrumenting-your-application#2CCDFEFA-30CD-4899-A86B-54C9F873C823" title="https://software.intel.com/en-us/vtune-help-instrumenting-your-application#2CCDFEFA-30CD-4899-A86B-54C9F873C823">https://software.intel.com/en-us/vtune-help-instrumenting-your-application#2CCDFEFA-30CD-4899-A86B-54C9F873C823</a>. This is different from recording the methodID, but the same VTune agent interface here I expected would be used to cash domain ids and other handles that help with marking regions. </p>
</blockquote>



<a name="191814044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191814044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191814044">(Mar 25 2020 at 21:35)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381554353" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381554353">PR Review</a>.</p>



<a name="191825150"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191825150" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191825150">(Mar 25 2020 at 23:46)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381615181" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-381615181">PR Review</a>.</p>



<a name="191825151"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191825151" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191825151">(Mar 25 2020 at 23:46)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658">PR Review Comment</a>:</p>
<blockquote>
<p>It doesn't at all ...  it seems to only have purpose if you want to stop profiling and any point while code is still executing. Having drop for VTuneAgent call this would probably be a good idea nonetheless though.  +1</p>
</blockquote>



<a name="191825158"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191825158" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191825158">(Mar 25 2020 at 23:46)</a>:</h4>
<p>jlb6740 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658">PR Review Comment</a>.</p>



<a name="191825165"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191825165" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191825165">(Mar 25 2020 at 23:46)</a>:</h4>
<p>jlb6740 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658">PR Review Comment</a>.</p>



<a name="191825183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191825183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191825183">(Mar 25 2020 at 23:46)</a>:</h4>
<p>jlb6740 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398237658">PR Review Comment</a>.</p>



<a name="191902666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191902666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191902666">(Mar 26 2020 at 15:37)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382134439" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382134439">PR Review</a>.</p>



<a name="191902667"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191902667" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191902667">(Mar 26 2020 at 15:37)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398671136" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r398671136">PR Review Comment</a>:</p>
<blockquote>
<p>Ah ok caching makes sense, but I think that here it may make more sense to insert it into the map and assert that it was the first time we saw it? Modules should only be reigstered once and this would allow other VTune methods to get called as well.</p>
</blockquote>



<a name="191967587"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191967587" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191967587">(Mar 27 2020 at 01:00)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191979918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191979918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191979918">(Mar 27 2020 at 06:13)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382600828" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382600828">PR Review</a>.</p>



<a name="191979919"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191979919" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191979919">(Mar 27 2020 at 06:13)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399054093" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399054093">PR Review Comment</a>:</p>
<blockquote>
<p>Sorry .. missed this comment earlier. Yeah, that would be great. I looked at instantiate_module and I don't see anywhere the path to the file is being preserved. Is this something possible now?</p>
</blockquote>



<a name="191981775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191981775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191981775">(Mar 27 2020 at 06:54)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="191981800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191981800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191981800">(Mar 27 2020 at 06:55)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382615167" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382615167">PR Review</a>.</p>



<a name="191981801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/191981801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#191981801">(Mar 27 2020 at 06:55)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399066726" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399066726">PR Review Comment</a>:</p>
<blockquote>
<p>Great! Thanks. It shouldn't be freed. I think was some legacy when I didn't quite now how to represent this. Converts to pointer to jmethod and then coerces to the c_void type expected.</p>
</blockquote>



<a name="192027590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192027590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192027590">(Mar 27 2020 at 14:47)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382925058" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-382925058">PR Review</a>.</p>



<a name="192027592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192027592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192027592">(Mar 27 2020 at 14:47)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399318239" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399318239">PR Review Comment</a>:</p>
<blockquote>
<p>Yeah we don't actually really ever have a filename right now, but it seems like it'd be best if the caller of the profiler would be inventing a filename like this rather than relying on each profiler to invent its own filename. We could eventually thread through a filename from something like <code>Module::from_file</code> to here when we get around to binding it.</p>
</blockquote>



<a name="192046870"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192046870" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192046870">(Mar 27 2020 at 16:49)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-383032288" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-383032288">PR Review</a>.</p>



<a name="192046871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192046871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192046871">(Mar 27 2020 at 16:49)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399403376" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399403376">PR Review Comment</a>:</p>
<blockquote>
<p>Ok, make sense. I'll add the argument and make up the name at the call site. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="192090461"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192090461" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192090461">(Mar 27 2020 at 23:02)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-383244462" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-383244462">PR Review</a>.</p>



<a name="192090462"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192090462" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192090462">(Mar 27 2020 at 23:02)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399575638" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399575638">PR Review Comment</a>:</p>
<blockquote>
<p>You know, I was thinking if filename should eventually come from the module, well the module is already passed in. We already pull the module_name (if exists) and method_name from the module and the only reason we don't pull the filename too is because it isn't there. I think ultimately we actually may not want this added to the interface. In the next push I've only added it to event load to see what you think, but if you still think it should be a part of the interface and passed in from the jit call site, then I can add it there too.  </p>
</blockquote>



<a name="192097434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192097434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192097434">(Mar 28 2020 at 01:07)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-383267995" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-383267995">PR Review</a>.</p>



<a name="192097435"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192097435" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192097435">(Mar 28 2020 at 01:07)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399599136" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r399599136">PR Review Comment</a>:</p>
<blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="192158458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192158458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192158458">(Mar 29 2020 at 06:01)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192211781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192211781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192211781">(Mar 30 2020 at 05:06)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192308946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192308946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192308946">(Mar 30 2020 at 19:53)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-384177001" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-384177001">PR Review</a>.</p>



<a name="192308947"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192308947" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192308947">(Mar 30 2020 at 19:53)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-384177001" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-384177001">PR Review</a>.</p>



<a name="192308949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192308949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192308949">(Mar 30 2020 at 19:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r400451397" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r400451397">PR Review Comment</a>:</p>
<blockquote>
<p>I think this may still need to be removed?</p>
</blockquote>



<a name="192308950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192308950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192308950">(Mar 30 2020 at 19:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r400452649" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r400452649">PR Review Comment</a>:</p>
<blockquote>
<p>I think this may not exist in the C API yet? (should just be a few extra lines here and there for this PR)</p>
</blockquote>



<a name="192340512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192340512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192340512">(Mar 31 2020 at 02:42)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-384365448" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-384365448">PR Review</a>.</p>



<a name="192340513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192340513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192340513">(Mar 31 2020 at 02:42)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r400609309" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r400609309">PR Review Comment</a>:</p>
<blockquote>
<p>Lol .. Yes sorry. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>  I was following your lead and didn't go back and add. I see support here should be added in crates/c-api and will do that next push. </p>
</blockquote>



<a name="192585932"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192585932" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192585932">(Apr 01 2020 at 20:09)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192588243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192588243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192588243">(Apr 01 2020 at 20:27)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192588627"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192588627" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192588627">(Apr 01 2020 at 20:30)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192588715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192588715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192588715">(Apr 01 2020 at 20:30)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192595227"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192595227" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192595227">(Apr 01 2020 at 21:28)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-385962251" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-385962251">PR Review</a>.</p>



<a name="192595228"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192595228" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192595228">(Apr 01 2020 at 21:28)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-385962251" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-385962251">PR Review</a>.</p>



<a name="192595229"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192595229" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192595229">(Apr 01 2020 at 21:28)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r401920497" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r401920497">PR Review Comment</a>:</p>
<blockquote>
<p>I think this may be missing from the commit by accident?</p>
</blockquote>



<a name="192595230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192595230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192595230">(Apr 01 2020 at 21:28)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r401920619" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r401920619">PR Review Comment</a>:</p>
<blockquote>
<p>Oh dear I see what you mean, it looks like some mangling has definitely gone awry here by accident :(</p>
</blockquote>



<a name="192602401"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192602401" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192602401">(Apr 01 2020 at 22:54)</a>:</h4>
<p>jlb6740 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-386004521" title="https://github.com/bytecodealliance/wasmtime/pull/819#pullrequestreview-386004521">PR Review</a>.</p>



<a name="192602402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192602402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192602402">(Apr 01 2020 at 22:54)</a>:</h4>
<p>jlb6740 created <a href="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r401956891" title="https://github.com/bytecodealliance/wasmtime/pull/819#discussion_r401956891">PR Review Comment</a>:</p>
<blockquote>
<p>Let me just remove this.</p>
</blockquote>



<a name="192607244"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192607244" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192607244">(Apr 01 2020 at 23:59)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192607258"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192607258" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192607258">(Apr 01 2020 at 23:59)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192607314"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192607314" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192607314">(Apr 02 2020 at 00:00)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192607617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192607617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192607617">(Apr 02 2020 at 00:05)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192612868"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192612868" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192612868">(Apr 02 2020 at 01:48)</a>:</h4>
<p>jlb6740 updated <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a> from <code>add-vtune-ittapi-support</code> to <code>master</code>:</p>
<blockquote>
<p>This patch adds initial support for ittapi which is an open<br>
source profiling api for instrumentation and tracing and profiling<br>
of jitted code.</p>
<p>Build:<br>
    cargo build --features=profiling<br>
Profile: // Using amplxe-cl from VTune<br>
    amplxe-cl -v -collect hostpost target/debug/wasmtime --jitprofile test.wasm</p>
<p>Note, Vtune is a free open source profiling tool for identifying performance bottlenecks. This patch which brings in ittapi-rs when the profiling feature is enabled, currently only supports the profiling of jitted code but I am investigating using ittapi for profiling of wasmtime itself with a future patch that builds on this one.</p>
</blockquote>



<a name="192669417"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%23819%20Adds%20JIT%20profiling%20support%20using%20ittapi/near/192669417" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.23819.20Adds.20JIT.20profiling.20support.20using.20ittapi.html#192669417">(Apr 02 2020 at 14:04)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/819" title="https://github.com/bytecodealliance/wasmtime/pull/819">PR #819</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>