<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2125 wasi-common: high resolution timer... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232125.20wasi-common.3A.20high.20resolution.20timer.2E.2E.2E.html">wasmtime / Issue #2125 wasi-common: high resolution timer...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="206501109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232125%20wasi-common%3A%20high%20resolution%20timer.../near/206501109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232125.20wasi-common.3A.20high.20resolution.20timer.2E.2E.2E.html#206501109">(Aug 10 2020 at 19:12)</a>:</h4>
<p>pchickey opened <a href="https://github.com/bytecodealliance/wasmtime/issues/2125">Issue #2125</a>:</p>
<blockquote>
<p>As we know, in the browser space there are various concerns around speculative execution attacks (Spectre etc) that are mitigated in part by reducing the precision of timers available to untrusted code.</p>
<p>Presently, <code>wasi-common</code>'s timer APIs provide resolution as high as the underlying OS provides.</p>
<p>I propose implementing a configurable timing-precision-reduced mode to the <code>wasi-common</code> crate. The precision available will configured as part of the <code>WasiCtxBuilder</code>. Full resolution will still be available to users who want it, but one open question is whether the default should be full resolution or some reduced value. Different browsers have set different default precision levels - FF and Edge 20us, Chrome 100us, Safari 1ms according to <a href="https://github.com/w3c/hr-time/issues/56">https://github.com/w3c/hr-time/issues/56</a>.</p>
<p>The following well-commented implementation in Firefox looks like a good reference on how clamping and jitter should work: <a href="https://searchfox.org/mozilla-central/source/toolkit/components/resistfingerprinting/nsRFPService.cpp#446">https://searchfox.org/mozilla-central/source/toolkit/components/resistfingerprinting/nsRFPService.cpp#446</a></p>
</blockquote>



<a name="206501110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232125%20wasi-common%3A%20high%20resolution%20timer.../near/206501110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232125.20wasi-common.3A.20high.20resolution.20timer.2E.2E.2E.html#206501110">(Aug 10 2020 at 19:12)</a>:</h4>
<p>pchickey labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2125">Issue #2125</a>:</p>
<blockquote>
<p>As we know, in the browser space there are various concerns around speculative execution attacks (Spectre etc) that are mitigated in part by reducing the precision of timers available to untrusted code.</p>
<p>Presently, <code>wasi-common</code>'s timer APIs provide resolution as high as the underlying OS provides.</p>
<p>I propose implementing a configurable timing-precision-reduced mode to the <code>wasi-common</code> crate. The precision available will configured as part of the <code>WasiCtxBuilder</code>. Full resolution will still be available to users who want it, but one open question is whether the default should be full resolution or some reduced value. Different browsers have set different default precision levels - FF and Edge 20us, Chrome 100us, Safari 1ms according to <a href="https://github.com/w3c/hr-time/issues/56">https://github.com/w3c/hr-time/issues/56</a>.</p>
<p>The following well-commented implementation in Firefox looks like a good reference on how clamping and jitter should work: <a href="https://searchfox.org/mozilla-central/source/toolkit/components/resistfingerprinting/nsRFPService.cpp#446">https://searchfox.org/mozilla-central/source/toolkit/components/resistfingerprinting/nsRFPService.cpp#446</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>