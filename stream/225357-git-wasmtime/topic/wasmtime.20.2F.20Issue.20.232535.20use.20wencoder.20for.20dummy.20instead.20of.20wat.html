<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2535 use wencoder for dummy instead of wat · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html">wasmtime / Issue #2535 use wencoder for dummy instead of wat</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="221195972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/221195972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#221195972">(Dec 30 2020 at 07:40)</a>:</h4>
<p>misapprehand <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-752361716">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>fix  <a href="https://github.com/bytecodealliance/wasmtime/issues/2498">#2498</a></p>
</blockquote>



<a name="221198332"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/221198332" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#221198332">(Dec 30 2020 at 08:36)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-752375019">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "fuzzing"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: fuzzing</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="224322529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224322529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224322529">(Jan 28 2021 at 13:07)</a>:</h4>
<p>misapprehand <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769040402">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>@fitzgen  module_section is only in <a href="https://github.com/WebAssembly/module-linking/blob/master/proposals/module-linking/Explainer.md">module link proposals</a> and the section order is different from <a href="https://webassembly.github.io/spec/core/binary/modules.html#sections">current order</a>.  I use the current one and add module_section to the data section. If I do not that, module_section is useless. So I not sure if it is right?  Thanks</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Module</span>::<span class="n">new</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="o">....</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">module_section</span><span class="p">);</span><span class="w">   </span><span class="o">&lt;---</span><span class="w">  </span><span class="n">module_section</span><span class="w"></span>

<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">finish</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
</blockquote>



<a name="224372102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224372102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224372102">(Jan 28 2021 at 18:36)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769290162">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>Yeah, our fuzzers support module linking, and we don't want to lose that coverage, so you'll have to maintain that functionality as well. That means that there are some sections that can be repeated in any order at the start of a module:</p>
<blockquote>
<p><a href="https://github.com/WebAssembly/module-linking/blob/master/proposals/module-linking/Explainer.md#binary-format-considerations">This proposal instead loosens the section ordering rules such that the 5 initial sections (Type, Import, Module, Instance, Alias) can appear in any order, any number of times each.</a></p>
</blockquote>
<p>If you're having trouble adding these sections in the right order, it may make sense to have a <code>initial_sections: Vec&lt;InitialSection&gt;</code> member in the generator, where <code>InitialSection</code> is an <code>enum</code> of those 5 initial sections, and whenever you need to add something to an initial section, if the last section in <code>self.initial_sections</code> isn't the section you need to add to, then push a new section of the right type and add your entity to that new section. Does that make sense?</p>
<p>Again, if this is going too deep and you want to back out, no worries, I understand that this wasn't really the "good first issue" I thought it was, sorry :(</p>
</blockquote>



<a name="224396649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224396649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224396649">(Jan 28 2021 at 21:42)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769418703">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>By the way, I've added some tests for the dummy imports behavior to the <code>main</code> branch, and they might be helpful for your work in this PR since they check the expected results of the dummy imports (without requiring all the rest of the fuzzing infrastructure). If you rebase on <code>main</code> then you can run them via</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">cargo</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">wasmtime</span><span class="o">-</span><span class="n">fuzzing</span><span class="w"></span>
</code></pre></div><br>
</p>
</blockquote>



<a name="224472485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224472485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224472485">(Jan 29 2021 at 13:50)</a>:</h4>
<p>misapprehand <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769816459">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p><a href="https://github.com/WebAssembly/module-linking/blob/master/proposals/module-linking/Explainer.md#binary-format-considerations">This proposal instead loosens the section ordering rules such that the 5 initial sections (Type, Import, Module, Instance, Alias) can appear in any order, any number of times each.</a></p>
</blockquote>
</blockquote>
<p>@fitzgen  I try to catch your point</p>
<ol>
<li>We use proposal section order</li>
<li>ModuleSection can put any place in the module</li>
</ol>
<p>Next is my solution for section order. I set the module_section at last. Is it right?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Module</span>::<span class="n">new</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">custom_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">type_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">import_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">function_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">table_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">memory_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">global_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">export_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">start_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">element_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">code_section</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">section</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">module_section</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">module</span><span class="p">.</span><span class="n">finish</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
</blockquote>



<a name="224473798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224473798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224473798">(Jan 29 2021 at 14:01)</a>:</h4>
<p>misapprehand <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769822395">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>@fitzgen  I pass the cargo test -p wasmtime-fuzzing, but can not pass ci test.  And I also pass the </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">cargo</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">features</span><span class="w"> </span><span class="n">test</span><span class="o">-</span><span class="n">programs</span><span class="o">/</span><span class="n">test_programs</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">all</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">lightbeam</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">wasmtime</span><span class="o">-</span><span class="n">lightbeam</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">wasmtime</span><span class="o">-</span><span class="n">wasi</span><span class="o">-</span><span class="n">nn</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">wasmtime</span><span class="o">-</span><span class="n">wasi</span><span class="o">-</span><span class="n">crypto</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="o">-</span><span class="n">automata</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="o">-</span><span class="n">fuzzing</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="o">-</span><span class="kr">macro</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="o">-</span><span class="n">runtime</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="o">-</span><span class="n">test</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">&gt;</span><span class="w">       </span><span class="o">--</span><span class="n">exclude</span><span class="w"> </span><span class="n">peepmatic</span><span class="o">-</span><span class="n">souper</span><span class="w"></span>
</code></pre></div>
<p>which broken in ci.</p>
<p>And when i run  ./ci/run-experimental-x64-ci.sh, it fails</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w"> </span><span class="n">cargo</span>:<span class="nc">rerun</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="n">changed</span><span class="o">=</span><span class="n">wasi</span><span class="o">-</span><span class="n">tests</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="w"></span>

<span class="w">  </span><span class="o">---</span><span class="w"> </span><span class="n">stderr</span><span class="w"></span>
<span class="w">     </span><span class="n">Compiling</span><span class="w"> </span><span class="n">wasi</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">10.0</span><span class="o">+</span><span class="n">wasi</span><span class="o">-</span><span class="n">snapshot</span><span class="o">-</span><span class="n">preview1</span><span class="w"></span>
<span class="w">  </span><span class="n">error</span><span class="p">[</span><span class="n">E0463</span><span class="p">]</span>: <span class="nc">can</span><span class="o">'</span><span class="na">t</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="k">crate</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">core</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">the</span><span class="w"> </span><span class="err">`</span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasi</span><span class="err">`</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">installed</span><span class="w"></span>

<span class="w">  </span><span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">error</span><span class="w"></span>

<span class="w">  </span><span class="n">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="kr">try</span><span class="w"> </span><span class="err">`</span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">explain</span><span class="w"> </span><span class="n">E0463</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
<span class="w">  </span><span class="n">error</span>: <span class="nc">could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="err">`</span><span class="n">wasi</span><span class="err">`</span><span class="w"></span>

<span class="w">  </span><span class="n">To</span><span class="w"> </span><span class="n">learn</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">--</span><span class="n">verbose</span><span class="p">.</span><span class="w"></span>
<span class="w">  </span><span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">Building</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">exit</span><span class="w"> </span><span class="n">code</span>: <span class="mi">101</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">crates</span><span class="o">/</span><span class="n">test</span><span class="o">-</span><span class="n">programs</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">69</span>:<span class="mi">13</span><span class="w"></span>
<span class="w">  </span><span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
     <span class="mi">0</span>: <span class="nc">rust_begin_unwind</span><span class="w"></span>
<span class="w">               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c0b64d97beebb09325b5587abed39f4f1621026f</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">493</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">     </span><span class="mi">1</span>: <span class="nc">std</span>::<span class="n">panicking</span>::<span class="n">begin_panic_fmt</span><span class="w"></span>
<span class="w">               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c0b64d97beebb09325b5587abed39f4f1621026f</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">std</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">435</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">     </span><span class="mi">2</span>: <span class="nc">build_script_build</span>::<span class="n">wasi_tests</span>::<span class="n">build_tests</span><span class="w"></span>
<span class="w">               </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">69</span>:<span class="mi">13</span><span class="w"></span>
<span class="w">     </span><span class="mi">3</span>: <span class="nc">build_script_build</span>::<span class="n">wasi_tests</span>::<span class="n">build_and_generate_tests</span><span class="w"></span>
<span class="w">               </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">49</span>:<span class="mi">9</span><span class="w"></span>
<span class="w">     </span><span class="mi">4</span>: <span class="nc">build_script_build</span>::<span class="n">main</span><span class="w"></span>
<span class="w">               </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">8</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">     </span><span class="mi">5</span>: <span class="nc">core</span>::<span class="n">ops</span>::<span class="n">function</span>::<span class="nb">FnOnce</span>::<span class="n">call_once</span><span class="w"></span>
<span class="w">               </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">c0b64d97beebb09325b5587abed39f4f1621026f</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">ops</span><span class="o">/</span><span class="n">function</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">227</span>:<span class="mi">5</span><span class="w"></span>
</code></pre></div>
<p>the result of <code>rustup target list</code> is.   I have already install wasm32-wasi</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">thumbv7neon</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnueabihf</span><span class="w"></span>
<span class="n">thumbv8m</span><span class="p">.</span><span class="n">base</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="w"></span>
<span class="n">thumbv8m</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="w"></span>
<span class="n">thumbv8m</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabihf</span><span class="w"></span>
<span class="n">wasm32</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">emscripten</span><span class="w"></span>
<span class="n">wasm32</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">unknown</span><span class="w"> </span><span class="p">(</span><span class="n">installed</span><span class="p">)</span><span class="w"></span>
<span class="n">wasm32</span><span class="o">-</span><span class="n">wasi</span><span class="w"> </span><span class="p">(</span><span class="n">installed</span><span class="p">)</span><span class="w">                                </span><span class="o">&lt;-----</span><span class="w"> </span><span class="n">installed</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">darwin</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">fortanix</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">sgx</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">fuchsia</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">android</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">windows</span><span class="o">-</span><span class="n">gnu</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">windows</span><span class="o">-</span><span class="n">msvc</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">rumprun</span><span class="o">-</span><span class="n">netbsd</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">sun</span><span class="o">-</span><span class="n">solaris</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">freebsd</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">illumos</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="w"> </span><span class="p">(</span><span class="n">installed</span><span class="p">)</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnux32</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">musl</span><span class="w"></span>
<span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">netbsd</span><span class="w"></span>
</code></pre></div>
<p>Can you help me ? <br>
Thanks</p>
</blockquote>



<a name="224503413"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224503413" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224503413">(Jan 29 2021 at 17:09)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769931337">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>@misapprehand the <code>run-experimental-x64-ci.sh</code> script uses nightly Rust (see in the script the <code>$CARGO_VERSION</code> variable), so you'll need to install the <code>wasm32-wasi</code> target for nightly as well:</p>
<p><code>rustup target add --toolchain nightly wasm32-wasi</code></p>
</blockquote>



<a name="224507739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224507739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224507739">(Jan 29 2021 at 17:41)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769948069">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<p>@misapprehand if you want to run all tests for all crates, you need to make sure you have git submodules checked out and, as @cfallin mentioned, the <code>wasm32-wasi</code> target installed. Run thse commands before trying again:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">rustup</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasi</span><span class="w"></span>
<span class="n">git</span><span class="w"> </span><span class="n">submodule</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="o">--</span><span class="n">init</span><span class="w"></span>
</code></pre></div>
<blockquote>
<p>Next is my solution for section order. I set the module_section at last. Is it right?</p>
</blockquote>
<p>Not quite.</p>
<p>The order is</p>
<ul>
<li>(Type, Import, Module, Instance, Alias) sections repeated in any order, any number of times. (This is where the <code>initial_sections</code> vec comes in that I mentioned above)</li>
<li>Function section</li>
<li>Table section</li>
<li>Memory section</li>
<li>Global section</li>
<li>Export section</li>
<li>Start section</li>
<li>Element section</li>
<li>Code section</li>
<li>Data section</li>
</ul>
<p>Where custom sections can come in between all other sections. Although we shouldn't need any of the custom, start, element, or data sections when generating these dummy imports.</p>
</blockquote>



<a name="224507850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224507850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224507850">(Jan 29 2021 at 17:41)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-769948466">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<blockquote>
<p>I pass the cargo test -p wasmtime-fuzzing</p>
</blockquote>
<p>Did you rebase on top of the <code>main</code> branch? Because I wouldn't expect the current iteration of code to pass the tests on the <code>main</code> branch.</p>
</blockquote>



<a name="224576651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232535%20use%20wencoder%20for%20dummy%20instead%20of%20wat/near/224576651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232535.20use.20wencoder.20for.20dummy.20instead.20of.20wat.html#224576651">(Jan 30 2021 at 09:47)</a>:</h4>
<p>misapprehand <a href="https://github.com/bytecodealliance/wasmtime/pull/2535#issuecomment-770185606">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2535">Issue #2535</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p>I pass the cargo test -p wasmtime-fuzzing</p>
</blockquote>
<p>Did you rebase on top of the <code>main</code> branch? Because I wouldn't expect the current iteration of code to pass the tests on the <code>main</code> branch.</p>
</blockquote>
<p>Sorry, I forget it.  Now, I can run test. With your test program, I think I see the target. </p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>