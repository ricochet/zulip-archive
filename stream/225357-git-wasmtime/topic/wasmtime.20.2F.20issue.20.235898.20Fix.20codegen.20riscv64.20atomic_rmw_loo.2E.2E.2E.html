<html>
<head><meta charset="utf-8"><title>wasmtime / issue #5898 Fix codegen riscv64 atomic_rmw_loo... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html">wasmtime / issue #5898 Fix codegen riscv64 atomic_rmw_loo...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="338990616"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/338990616" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#338990616">(Mar 02 2023 at 02:07)</a>:</h4>
<p>jameysharp <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1451167206">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>This is failing the test in <code>tests/spec_testsuite/proposals/threads/atomic.wast</code> on line 142, because <code>atomic_rmw</code> is expected to return the _old_ value at the address, not the newly-written value.</p>
<p>To fix #5884, I think you should write the result of <code>AtomicOP::extract</code> to <code>dst</code> instead of writing it to <code>t0</code>, and update later instructions accordingly.</p>
</blockquote>



<a name="338992442"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/338992442" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#338992442">(Mar 02 2023 at 02:33)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1451183740">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>@jameysharp , Thanks, The <code>atomic_rmw_loop </code> kinda of little complex. I think I want  to recheck it when I have time.</p>
</blockquote>



<a name="338994089"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/338994089" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#338994089">(Mar 02 2023 at 02:55)</a>:</h4>
<p>jameysharp <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1451197619">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>Yeah, I had a difficult time understanding what the loop was doing. I suspect we can improve it, and I'd be happy to discuss it further when you have time.</p>
</blockquote>



<a name="338996400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/338996400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#338996400">(Mar 02 2023 at 03:23)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1451241004">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>@jameysharp sure.</p>
</blockquote>



<a name="339236415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/339236415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#339236415">(Mar 03 2023 at 01:15)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1452794935">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>There is a <code>CI</code> failure Without errors.</p>
</blockquote>



<a name="339240642"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/339240642" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#339240642">(Mar 03 2023 at 02:00)</a>:</h4>
<p>jameysharp <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1452828061">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>I tried re-running just the failed CI jobs, but then extra jobs ran, which failed without useful logs, and I don't understand why. I'll have to look into this again next week if nobody else gets to it first.</p>
</blockquote>



<a name="339243619"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235898%20Fix%20codegen%20riscv64%20atomic_rmw_loo.../near/339243619" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235898.20Fix.20codegen.20riscv64.20atomic_rmw_loo.2E.2E.2E.html#339243619">(Mar 03 2023 at 02:39)</a>:</h4>
<p>yuyang-ok <a href="https://github.com/bytecodealliance/wasmtime/pull/5898#issuecomment-1452871789">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/5898">issue #5898</a>:</p>
<blockquote>
<p>@jameysharp Ok,thanks.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>