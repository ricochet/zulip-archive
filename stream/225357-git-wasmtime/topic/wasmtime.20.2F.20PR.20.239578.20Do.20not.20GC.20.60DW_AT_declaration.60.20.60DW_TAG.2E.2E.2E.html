<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9578 Do not GC `DW_AT_declaration` `DW_TAG... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html">wasmtime / PR #9578 Do not GC `DW_AT_declaration` `DW_TAG...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="481008875"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481008875" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481008875">(Nov 06 2024 at 22:08)</a>:</h4>
<p>SingleAccretion opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a> from <code>SingleAccretion:DI-Decl</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units, therefore, they cannot be GCed away from their parent DIEs (most likely ones defining a type). This is the same situation as with, e. g. class member variables (fields).</p>
<p>Fixes #9512.</p>
</blockquote>



<a name="481010646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481010646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481010646">(Nov 06 2024 at 22:22)</a>:</h4>
<p>SingleAccretion updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<a name="481010739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481010739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481010739">(Nov 06 2024 at 22:23)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units, therefore, they cannot be GCed away from their parent type DIEs. This is the same situation as with, e. g. class member variables (fields).</p>
<p>Fixes #9512.</p>
</blockquote>



<a name="481010771"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481010771" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481010771">(Nov 06 2024 at 22:23)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units for any given type. This is the same situation as with, e. g. class member variables (fields).</p>
<p>Fixes #9512.</p>
</blockquote>



<a name="481010948"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481010948" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481010948">(Nov 06 2024 at 22:25)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units for any given type. This is the same situation as with, e. g. class member variables (fields).</p>
<p>Furthermore, even for ordinary C declarations, deleting them can theoretically mess up the expression evaluator (since a function that was supposed to be in scope no longer is).</p>
<p>Fixes #9512.</p>
</blockquote>



<a name="481011053"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481011053" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481011053">(Nov 06 2024 at 22:26)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units for any given type. This is the same situation as with, e. g. class member variables (fields).</p>
<p>Furthermore, even for ordinary C declarations, deleting them can theoretically mess up the expression evaluator (since a function that was supposed to be in scope no longer is). This is mostly a theoretical concern, however, as calling functions in the context of translated DWARF is currently deeply broken anyway.</p>
<p>Fixes #9512.</p>
</blockquote>



<a name="481011837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481011837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481011837">(Nov 06 2024 at 22:33)</a>:</h4>
<p>SingleAccretion updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<a name="481011845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481011845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481011845">(Nov 06 2024 at 22:33)</a>:</h4>
<p><strong>SingleAccretion</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a> as ready for review.</p>



<a name="481011846"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481011846" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481011846">(Nov 06 2024 at 22:33)</a>:</h4>
<p><strong>SingleAccretion</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<a name="481011847"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481011847" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481011847">(Nov 06 2024 at 22:33)</a>:</h4>
<p><strong>SingleAccretion</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<a name="481012090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481012090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481012090">(Nov 06 2024 at 22:35)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units for any given type. This is the same situation as with, e. g., class member variables (fields).</p>
<p>Furthermore, even for ordinary C declarations, deleting them can theoretically mess up the expression evaluator (since a function that was supposed to be in scope no longer is). This is mostly a theoretical concern, however, as calling functions in the context of translated DWARF is currently deeply broken anyway.</p>
<p>Fixes #9512.</p>
</blockquote>



<a name="481012546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481012546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481012546">(Nov 06 2024 at 22:39)</a>:</h4>
<p>SingleAccretion updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<a name="481012816"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481012816" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481012816">(Nov 06 2024 at 22:42)</a>:</h4>
<p>SingleAccretion edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>:</p>
<blockquote>
<p>Declarations must be consistent across compilation units for any given type. This is the same situation as with, e. g., class member variables (fields).</p>
<p>Furthermore, even for ordinary C declarations, deleting them can theoretically mess up the expression evaluator (since a function that was supposed to be in scope no longer is). This is mostly a theoretical concern, however, as calling functions in the context of translated DWARF is currently deeply broken anyway.</p>
<p>Fixes #9512.</p>
<p>I've also tweaked the dumping of DIE offsets for easier cross-referencing with llvm-dwarfump.</p>
</blockquote>



<a name="481013427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481013427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481013427">(Nov 06 2024 at 22:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9578#pullrequestreview-2419588160">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="481013437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481013437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481013437">(Nov 06 2024 at 22:48)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<a name="481015960"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239578%20Do%20not%20GC%20%60DW_AT_declaration%60%20%60DW_TAG.../near/481015960" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239578.20Do.20not.20GC.20.60DW_AT_declaration.60.20.60DW_TAG.2E.2E.2E.html#481015960">(Nov 06 2024 at 23:13)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9578">PR #9578</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>