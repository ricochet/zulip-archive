<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3696 Fix `isatty` in WASI. · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html">wasmtime / PR #3696 Fix `isatty` in WASI.</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="268470570"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268470570" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268470570">(Jan 18 2022 at 23:19)</a>:</h4>
<p>sunfishcode opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3696">PR #3696</a> from <code>sunfishcode/isatty</code> to <code>main</code>:</p>
<blockquote>
<p>WASI doesn't have an <code>isatty</code> ioctl or syscall, so wasi-libc's <code>isatty</code><br>
implementation uses the file descriptor type and rights to determine if<br>
the file descriptor is likely to be a tty. The real fix here will be to<br>
add an <code>isatty</code> call to WASI. But for now, have Wasmtime set the<br>
filetype and rights for file descriptors so that wasi-libc's <code>isatty</code><br>
works as expected.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="268474972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268474972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268474972">(Jan 19 2022 at 00:09)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-856112770">PR review</a>.</p>



<a name="268502605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268502605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268502605">(Jan 19 2022 at 07:58)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787435848">PR review comment</a>:</p>
<blockquote>
<p>Can this be cfg(unix) and cfg(not(unix)) instead?</p>
</blockquote>



<a name="268502606"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268502606" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268502606">(Jan 19 2022 at 07:58)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-856418817">PR review</a>.</p>



<a name="268545971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268545971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268545971">(Jan 19 2022 at 14:22)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3696">PR #3696</a> from <code>sunfishcode/isatty</code> to <code>main</code>.</p>



<a name="268551678"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268551678" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268551678">(Jan 19 2022 at 15:01)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-856924675">PR review</a>.</p>



<a name="268551679"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268551679" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268551679">(Jan 19 2022 at 15:01)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787840233">PR review comment</a>:</p>
<blockquote>
<p>Could <code>atty</code> be used on all platforms? (on Unix does <code>atty</code> differ from <code>rustix</code>?)</p>
</blockquote>



<a name="268557590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268557590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268557590">(Jan 19 2022 at 15:40)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-856981839">PR review</a>.</p>



<a name="268557591"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268557591" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268557591">(Jan 19 2022 at 15:40)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787879747">PR review comment</a>:</p>
<blockquote>
<p>On Linux rustix can use inline asm, while atty always uses libc.</p>
</blockquote>



<a name="268559153"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268559153" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268559153">(Jan 19 2022 at 15:51)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-856996808">PR review</a>.</p>



<a name="268559155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268559155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268559155">(Jan 19 2022 at 15:51)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787890363">PR review comment</a>:</p>
<blockquote>
<p>My reason for using rustix here was that cap-std-sync already depends on rustix for other things, so this avoids adding a new dependency on <code>atty</code> on unix-family platforms.</p>
<p>Rustix's isatty uses the same ioctl as musl, which is a different ioctl from what glibc uses, but the difference shouldn't matter in practice.</p>
</blockquote>



<a name="268560347"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268560347" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268560347">(Jan 19 2022 at 15:58)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-857007645">PR review</a>.</p>



<a name="268560348"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268560348" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268560348">(Jan 19 2022 at 15:58)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787898030">PR review comment</a>:</p>
<blockquote>
<p>Hm ok, personally I'm not a fan of having a lot of "if linux else everyone else this" because it seems like it'll just cause tons of Linux-specific or not-Linux-specific issues. This is pretty minor though.</p>
</blockquote>



<a name="268560813"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268560813" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268560813">(Jan 19 2022 at 16:01)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-857011785">PR review</a>.</p>



<a name="268560814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268560814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268560814">(Jan 19 2022 at 16:01)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787900935">PR review comment</a>:</p>
<blockquote>
<p>The actual change uses <code>cfg(unix)</code>, so it isn't Linux-specific.</p>
</blockquote>



<a name="268561812"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268561812" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268561812">(Jan 19 2022 at 16:07)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-857021503">PR review</a>.</p>



<a name="268561814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268561814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268561814">(Jan 19 2022 at 16:07)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r787907227">PR review comment</a>:</p>
<blockquote>
<p>Oh sure but it's the same thing with Windows. Crates like <code>atty</code> which provide a platform-agnostic interface at least theoretically deal with the portability within them (and afaik <code>atty</code> is widely used and well vetted). If we specifically <em>don't</em> use that then we're subject to all the bugs that <code>atty</code> would get except we'll get them instead (theoretically) at some later point.</p>
<p>But again this is personal preference and this is minor. I don't like to pervasively use platform-specific crates, instead using platform-specific crates in very specific situations and otherwise favoring platform-agnostic crates for heavy usage.</p>
</blockquote>



<a name="268897753"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268897753" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268897753">(Jan 21 2022 at 20:16)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-859988159">PR review</a>.</p>



<a name="268897754"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268897754" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268897754">(Jan 21 2022 at 20:16)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r789967691">PR review comment</a>:</p>
<blockquote>
<p>I changed the first to <code>cfg(unix)</code>, but I think <code>cfg(windows)</code> makes sense for the second. If we port to a non-Unix non-Windows platform in the future, we should figure out what <code>isatty</code> means for that platform.</p>
</blockquote>



<a name="268897755"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268897755" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268897755">(Jan 21 2022 at 20:16)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-859988159">PR review</a>.</p>



<a name="268901909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268901909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268901909">(Jan 21 2022 at 20:55)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-860018189">PR review</a>.</p>



<a name="268901910"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268901910" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268901910">(Jan 21 2022 at 20:55)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r789988520">PR review comment</a>:</p>
<blockquote>
<p>The isatty crate would figure that out, right?</p>
</blockquote>



<a name="268901918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268901918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268901918">(Jan 21 2022 at 20:55)</a>:</h4>
<p>bjorn3 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r789988520">PR review comment</a>.</p>



<a name="268904011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268904011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268904011">(Jan 21 2022 at 21:13)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-860031384">PR review</a>.</p>



<a name="268904014"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268904014" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268904014">(Jan 21 2022 at 21:13)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r789997706">PR review comment</a>:</p>
<blockquote>
<p>Not in its current form, because the atty crate currently has no interface for passing in a handle. It just supports literal stdin, stdout, and stderr. Possibly that will change in the future, and then we could simplify code like this.</p>
</blockquote>



<a name="268908009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268908009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268908009">(Jan 21 2022 at 21:51)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-860062307">PR review</a>.</p>



<a name="268908010"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268908010" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268908010">(Jan 21 2022 at 21:51)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r790018328">PR review comment</a>:</p>
<blockquote>
<p>In this case yes, but in <a href="http://stdio.rs">stdio.rs</a> you are using atty on stdin only for windows. There the <code>#[cfg(windows)]</code> can be turned into <code>#[cfg(not(unix))]</code> without issues.</p>
</blockquote>



<a name="268908504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268908504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268908504">(Jan 21 2022 at 21:56)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3696">PR #3696</a> from <code>sunfishcode/isatty</code> to <code>main</code>.</p>



<a name="268908515"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268908515" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268908515">(Jan 21 2022 at 21:56)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-860065477">PR review</a>.</p>



<a name="268908516"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268908516" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268908516">(Jan 21 2022 at 21:56)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r790020695">PR review comment</a>:</p>
<blockquote>
<p>Ah, ok. I've now made this change.</p>
</blockquote>



<a name="268931663"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268931663" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268931663">(Jan 22 2022 at 02:54)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3696">PR #3696</a> from <code>sunfishcode/isatty</code> to <code>main</code>.</p>



<a name="268931722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268931722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268931722">(Jan 22 2022 at 02:54)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-860159432">PR review</a>.</p>



<a name="268931724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268931724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268931724">(Jan 22 2022 at 02:54)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r790094526">PR review comment</a>:</p>
<blockquote>
<p>I've now factored this to use a platform-agnostic crate, so that Wasmtime's own code avoids the <code>cfg</code>s here.</p>
</blockquote>



<a name="268932713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/268932713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#268932713">(Jan 22 2022 at 03:12)</a>:</h4>
<p>sunfishcode updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3696">PR #3696</a> from <code>sunfishcode/isatty</code> to <code>main</code>.</p>



<a name="269120667"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269120667" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269120667">(Jan 24 2022 at 15:20)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-861109968">PR review</a>.</p>



<a name="269120668"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269120668" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269120668">(Jan 24 2022 at 15:20)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r790848215">PR review comment</a>:</p>
<blockquote>
<p>To clarify I'm fine either way, mostly just stating my own personal preference. But also, this looks the same as before, so unsure if this is intended to stay as-is or whether a commit was forgotten? (this PR is fine to merge whenever imo, I don't feel any need to debate fine detatils like this)</p>
</blockquote>



<a name="269122302"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269122302" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269122302">(Jan 24 2022 at 15:31)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-861125799">PR review</a>.</p>



<a name="269122304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269122304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269122304">(Jan 24 2022 at 15:31)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r790859316">PR review comment</a>:</p>
<blockquote>
<p>This one now has <code>#[cfg(unix)]</code> and <code>#[cfg(not(unix))]</code>. The other is left as <code>#[cfg(unix)]</code> and <code>#[cfg(windows)]</code> without fallback for non-unix, non-windows platforms.</p>
</blockquote>



<a name="269161987"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269161987" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269161987">(Jan 24 2022 at 19:43)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#discussion_r791095196">PR review comment</a>:</p>
<blockquote>
<p>That's consistent with <code>impl AsFd for File</code> under <code>cfg(unix)</code> which is already there. Ideally we should support non-windows-non-unix, but that's a bigger change.</p>
<p>And, I'm working on a change which will help; I plan to replace all these isatty implementations with a new is-terminal crate which supports windows, unix, and (to the extent possible) non-windows-non-unix with a single API. I'll do it in a separate PR because I need to make a few other changes to avoid cargo deny flagging it for duplicate dependency versions.</p>
</blockquote>



<a name="269161989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269161989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269161989">(Jan 24 2022 at 19:43)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3696#pullrequestreview-861439604">PR review</a>.</p>



<a name="269162307"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233696%20Fix%20%60isatty%60%20in%20WASI./near/269162307" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233696.20Fix.20.60isatty.60.20in.20WASI.2E.html#269162307">(Jan 24 2022 at 19:45)</a>:</h4>
<p>sunfishcode merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3696">PR #3696</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>