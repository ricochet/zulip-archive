<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7791 Update the Wasmi fuzzing oracle to ve... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html">wasmtime / PR #7791 Update the Wasmi fuzzing oracle to ve...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="416523538"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416523538" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416523538">(Jan 18 2024 at 08:52)</a>:</h4>
<p>Robbepop opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a> from <code>Robbepop:rf-update-wasmi-fuzzer</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Currently Wasmtime uses the 2 years old Wasmi version <code>0.20.0</code>.</p>
<p>Since then Wasmi has improved substantially and added support for new Wasm proposals such as <code>bulk-memory</code>, <code>reference-types</code> and <code>tail-calls</code> which we can now enable.</p>
<p>Besides that the most notable change are performance improvements which should make fuzzing with Wasmi a tiny bit faster.</p>
</blockquote>



<a name="416523539"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416523539" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416523539">(Jan 18 2024 at 08:52)</a>:</h4>
<p><strong>Robbepop</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="416523541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416523541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416523541">(Jan 18 2024 at 08:52)</a>:</h4>
<p><strong>Robbepop</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="416523542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416523542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416523542">(Jan 18 2024 at 08:52)</a>:</h4>
<p><strong>Robbepop</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="416523925"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416523925" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416523925">(Jan 18 2024 at 08:54)</a>:</h4>
<p>Robbepop edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Currently Wasmtime uses the 2 years old Wasmi version <code>0.20.0</code>.</p>
<p>Since then Wasmi has improved substantially and added support for new Wasm proposals such as <code>bulk-memory</code>, <code>reference-types</code> and <code>tail-calls</code> which we can now enable.<br>
Wasmi <code>v0.31.0</code> has recently been audited and is used by some large projects, thus is a lot more battle tested than the previous <code>v0.20.0</code>.</p>
<p>Besides that the most notable change are performance improvements which should make fuzzing with Wasmi a tiny bit faster.</p>
</blockquote>



<a name="416524343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416524343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416524343">(Jan 18 2024 at 08:56)</a>:</h4>
<p>Robbepop edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Currently Wasmtime uses the 2 years old Wasmi version <code>0.20.0</code>.</p>
<p>Since then Wasmi has improved substantially and added support for new Wasm proposals such as <code>bulk-memory</code>, <code>reference-types</code> and <code>tail-calls</code> which we can now enable.<br>
Wasmi <code>v0.31.0</code> has recently been audited and is used by some large projects, thus is a lot more battle tested than the previous <code>v0.20.0</code>.</p>
<p>Besides that the most notable change are performance improvements which should make fuzzing with Wasmi a tiny bit faster.</p>
<p>Look into the future: Since roughly half a year I am working on the next major Wasmi version <code>v0.32.0</code> which is a complete rewrite of the Wasmi executor featuring a much more powerful register-machine execution model. I hope that it becomes stable enough for use soon to provide it as fuzzing oracle to Wasmtime. Due to the changes we refer to the new Wasmi version as Wasmi (register) and the old Wasmi as Wasmi (stack). It might even make sense to have both versions as oracles at the same time because they have very different strengths.</p>
</blockquote>



<a name="416524419"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416524419" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416524419">(Jan 18 2024 at 08:57)</a>:</h4>
<p>Robbepop edited <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Currently Wasmtime uses the 2 years old Wasmi version <code>0.20.0</code>.</p>
<p>Since then Wasmi has improved substantially and added support for new Wasm proposals such as <code>bulk-memory</code>, <code>reference-types</code> and <code>tail-calls</code> which we can now enable.<br>
Wasmi <code>v0.31.0</code> has recently been audited and is used by some large projects, thus is a lot more battle tested than the previous <code>v0.20.0</code>.</p>
<p>Besides that the most notable change are performance improvements which should make fuzzing with Wasmi a tiny bit faster.</p>
<p>Look into the future: Since roughly half a year I am working on the next major Wasmi version <code>v0.32.0</code> which is a complete rewrite of the Wasmi executor featuring a much more powerful register-machine execution model and optional lazy compilation &amp; validation. I hope that it becomes stable enough for use soon to provide it as fuzzing oracle to Wasmtime. Due to the changes we refer to the new Wasmi version as Wasmi (register) and the old Wasmi as Wasmi (stack). It might even make sense to have both versions as oracles at the same time because they have very different strengths.</p>
</blockquote>



<a name="416524781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416524781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416524781">(Jan 18 2024 at 08:58)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1898057710">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>With respect to <code>cargo vet</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">  </span><span class="n">wasmi</span>:<span class="mf">0.31.1</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">[</span><span class="s">"safe-to-run"</span><span class="p">]</span>
<span class="w">  </span><span class="n">wasmi_arena</span>:<span class="mf">0.4.0</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">[</span><span class="s">"safe-to-run"</span><span class="p">]</span>
<span class="w">  </span><span class="n">wasmi_core</span>:<span class="mf">0.13.0</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">[</span><span class="s">"safe-to-run"</span><span class="p">]</span>
<span class="w">  </span><span class="n">wasmparser</span><span class="o">-</span><span class="n">nostd</span>:<span class="mf">0.100.1</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">[</span><span class="s">"safe-to-run"</span><span class="p">]</span>
</code></pre></div>
<p>All those crates are maintained by Wasmi maintainers (me).</p>
</blockquote>



<a name="416544300"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416544300" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416544300">(Jan 18 2024 at 10:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1898233737">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "fuzzing"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: fuzzing</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="416576217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416576217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416576217">(Jan 18 2024 at 13:57)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="416579016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416579016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416579016">(Jan 18 2024 at 14:10)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="416579289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416579289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416579289">(Jan 18 2024 at 14:12)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1898554884">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>I am a bit unsure about the new <code>wasmi::Config</code> handling in <code>diff_wasmi.rs</code> with the mutable <code>Config</code> parameter in <code>WasmiEngine::new</code>.</p>
</blockquote>



<a name="416579355"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416579355" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416579355">(Jan 18 2024 at 14:12)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1898554884">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>I am a bit unsure about the new <code>wasmi::Config</code> handling in <code>diff_wasmi.rs</code> with the mutable <code>Config</code> parameter in <code>WasmiEngine::new</code>. Review &amp; feedback required.</p>
</blockquote>



<a name="416579471"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416579471" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416579471">(Jan 18 2024 at 14:13)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1898554884">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>I am a bit unsure about the new <code>wasmi::Config</code> handling in <code>diff_wasmi.rs</code> with the mutable <code>Config</code> parameter in <code>WasmiEngine::new</code>. Review &amp; feedback required.<br>
In the changes I made Wasmi now better respects the input <code>config</code> and adjusts its <code>wasmi::Config</code> to it as much as possible and sets the other <code>config</code> flags to <code>false</code> in case Wasmi does not support that feature, yet.</p>
</blockquote>



<a name="416613375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416613375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416613375">(Jan 18 2024 at 17:03)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#pullrequestreview-1830174300">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>



<a name="416613376"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416613376" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416613376">(Jan 18 2024 at 17:03)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#pullrequestreview-1830174300">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>



<a name="416613377"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416613377" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416613377">(Jan 18 2024 at 17:03)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#discussion_r1457741400">PR review comment</a>:</p>
<blockquote>
<p>This all looks right to me, thanks! The intention here is that the differential engine (wasmi here) both configures itself based on <code>Config</code> but additionally updates <code>Config</code> with anything it can't support. So for example simd is disabled here unconditionally in <code>Config</code> because wasmi doesn't support it, but you're doing the right thing otherwise where features are conditionally enabled in wasmi depending on <code>Config</code> for those that wasmi supports.</p>
<p>Two minor comments here:</p>
<ul>
<li>This is setting <code>threads_enabled = false</code> twice</li>
<li>The <code>min_tables</code> and <code>max_tables</code> handling can probably be removed if wasmi supports reference types which is where multiple tables were added.</li>
</ul>
<p>If you'd like, it might be good to leave some comments here too along the lines of:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// force generated modules to never have features that wasmi doesn't support</span>
</code></pre></div>
<p>or something like that</p>
</blockquote>



<a name="416632085"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416632085" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416632085">(Jan 18 2024 at 19:02)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="416632155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416632155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416632155">(Jan 18 2024 at 19:02)</a>:</h4>
<p>Robbepop submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#pullrequestreview-1830379172">PR review</a>.</p>



<a name="416632156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416632156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416632156">(Jan 18 2024 at 19:02)</a>:</h4>
<p>Robbepop created <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#discussion_r1457867685">PR review comment</a>:</p>
<blockquote>
<p>I have implemented your code review suggestions.</p>
</blockquote>



<a name="416632345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416632345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416632345">(Jan 18 2024 at 19:03)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1899048505">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>
<p>Wasmi <code>v0.31.0</code> is no longer in development so I am not going to support the standard <code>wasmparser</code> for it, however, I am going to think about the implications doing so for future Wasmi versions starting from <code>v0.32.0</code> once released. Since Wasmi already has a <code>std</code> crate feature it might be simple to just use <code>wasmparser</code> if it is enabled and use <code>wasmparser-nostd</code> otherwise.</p>
</blockquote>



<a name="416632500"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416632500" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416632500">(Jan 18 2024 at 19:04)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1899048505">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>
<p>Wasmi <code>v0.31.0</code> is no longer in development so I am not going to support the standard <code>wasmparser</code> for it, however, I am going to think about the implications doing so for future Wasmi versions starting from <code>v0.32.0</code> once released. Since Wasmi already has a <code>std</code> crate feature it might be simple to just use <code>wasmparser</code> if it is enabled and use <code>wasmparser-nostd</code> otherwise.</p>
<p>From Wasmi's perspective though it would obviously the most ideal solution to simply have <code>no_std</code> support in the <code>wasmparser</code> crate.</p>
</blockquote>



<a name="416632550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416632550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416632550">(Jan 18 2024 at 19:04)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1899048505">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>
<p>Wasmi <code>v0.31.0</code> is no longer in development so I am not going to support the standard <code>wasmparser</code> for it, however, I am going to think about the implications doing so for future Wasmi versions starting from <code>v0.32.0</code> once released. Since Wasmi already has a <code>std</code> crate feature it might be simple to just use <code>wasmparser</code> if it is enabled and use <code>wasmparser-nostd</code> otherwise.</p>
<p>From Wasmi's perspective though it would obviously the most ideal solution to simply have <code>no_std</code> support in the <code>wasmparser</code> crate. Maintaining the <code>wasmparser_nostd</code> fork is okay but not perfect for synchronization.</p>
</blockquote>



<a name="416634150"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416634150" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416634150">(Jan 18 2024 at 19:15)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1899048505">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>
<p>Wasmi <code>v0.31.0</code> is no longer in development so I am not going to support the standard <code>wasmparser</code> for it, however, I am going to think about the implications doing so for future Wasmi versions starting from <code>v0.32.0</code> once released. Since Wasmi already has a <code>std</code> crate feature it might be simple to just use <code>wasmparser</code> if it is enabled and use <code>wasmparser-nostd</code> otherwise.</p>
<p>I have have a wishful thinking for <code>no_std</code> support in the official <code>wasmparser</code> crate one day. :)</p>
</blockquote>



<a name="416813006"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416813006" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416813006">(Jan 19 2024 at 16:15)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1899048505">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Thanks!</p>
<p>To avoid a new vet of <code>wasmparser-nostd</code> would it be possible to conditionally build wasmi with the official <code>wasmparser</code> crate instead? That way we could get that auto-vetted.</p>
</blockquote>
<p>Wasmi <code>v0.31.0</code> is no longer in development so I am not going to support the standard <code>wasmparser</code> for it, however, I am going to think about the implications doing so for future Wasmi versions starting from <code>v0.32.0</code> once released. Since Wasmi already has a <code>std</code> crate feature it might be simple to just use <code>wasmparser</code> if it is enabled and use <code>wasmparser-nostd</code> otherwise.</p>
<p>I have a wishful thinking for <code>no_std</code> support in the official <code>wasmparser</code> crate one day. :)</p>
</blockquote>



<a name="416822502"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416822502" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416822502">(Jan 19 2024 at 16:53)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1900759987">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Ah ok, in that case this is going to have to hold off until one of us gets a chance to vet the dependencies here. I'm stretched a bit thin at the moment so it may be a bit before I can personally get to this (but others can of course beat me to it)</p>
</blockquote>



<a name="416824909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/416824909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#416824909">(Jan 19 2024 at 17:03)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1900774601">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Please tell me if and how I can help with vetting. :)</p>
</blockquote>



<a name="417309820"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417309820" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417309820">(Jan 22 2024 at 20:28)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904751808">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>



<a name="417318097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417318097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417318097">(Jan 22 2024 at 21:25)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. I never intended this to be a long lasting effort but here we are.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There are a good deal of unit, integration, e2e and fuzz tests.<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies some many months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much less complex than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417321757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417321757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417321757">(Jan 22 2024 at 21:50)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. I never intended this to be a long lasting effort but here we are.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There are a good deal of unit, integration, e2e and fuzz tests.<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much less complex than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417322113"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417322113" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417322113">(Jan 22 2024 at 21:52)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. I never intended this to be a long lasting effort but here we are.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There is a good deal of tests. (unit, integration, e2e, fuzz)<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much less complex than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417322335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417322335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417322335">(Jan 22 2024 at 21:53)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. I never intended this to be a long lasting effort but here we are. In that spirit I think it even lacks tests but <code>wasmparser-nostd</code> passes the <code>wasmparser</code> testsuite so I thought it would be good enough as temporary solution at that time.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There is a good deal of tests. (unit, integration, e2e, fuzz)<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much less complex than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417322473"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417322473" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417322473">(Jan 22 2024 at 21:54)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. Focus was to write it as simple as possible since I never intended this to be a long lasting effort but here we are. In that spirit I think it even lacks tests but <code>wasmparser-nostd</code> passes the <code>wasmparser</code> testsuite so I thought it would be good enough as temporary solution at that time.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There is a good deal of tests. (unit, integration, e2e, fuzz)<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much less complex than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417323551"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417323551" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417323551">(Jan 22 2024 at 22:01)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. Focus was to write it as simple as possible since I never intended this to be a long lasting effort but here we are. In that spirit I think it even lacks tests but <code>wasmparser-nostd</code> passes the <code>wasmparser</code> testsuite so I thought it would be good enough as temporary solution at that time.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There is a good deal of tests. (unit, integration, e2e, fuzz) (ignoring the <code>indexmap-nostd</code> crate)<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much less complex than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417323672"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417323672" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417323672">(Jan 22 2024 at 22:02)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. Focus was to write it as simple as possible since I never intended this to be a long lasting effort but here we are. In that spirit I think it even lacks tests but <code>wasmparser-nostd</code> passes the <code>wasmparser</code> testsuite so I thought it would be good enough as temporary solution at that time.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There is a good deal of tests. (unit, integration, e2e, fuzz) (ignoring the <code>indexmap-nostd</code> crate)<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.0</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.0</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.0</code> is much simpler than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417323952"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417323952" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417323952">(Jan 22 2024 at 22:04)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904846331">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>Thanks for catching this bug! The code is quite old and hasn't seen a lot of love lately.</p>
<blockquote>
<p>Otherwise the <code>wasmparser-nostd</code> diff is quite large or larger than I remember from the <code>wasmparser</code> diff, so diffing those directories is requiring a good deal of time to go through to verify it's the same. Additionally I haven't even gotten to <code>wasmi</code> yet which glancing at it is quite large and additionally contains a good deal of <code>unsafe</code> code to check.</p>
</blockquote>
<p>The unfortunate truth is that especially with the component model a lot of very <code>no_std</code> unfriendly abstractions such as the <code>IndexMap</code> has been added which required me to come up with my own <code>no_std</code> friendly version of it. Focus was to write it as simple as possible since I never intended this to be a long lasting effort but here we are. In that spirit I think it even lacks tests but <code>wasmparser-nostd</code> passes the <code>wasmparser</code> testsuite so I thought it would be good enough as temporary solution at that time.</p>
<blockquote>
<p>Currently though wasmi is only used for fuzzing so it doesn't necessarily need a thorough review or strict vetting. Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>To provide you with a bit of transparency here about the state of Wasmi:</p>
<ul>
<li>
<p>Cons:</p>
<p>- I work on the project alone.<br>
  - There are pretty much no code reviews due to above point.<br>
  - There is a fair amount of <code>unsafe</code> code use, but mostly in the Wasmi bytecode executor.</p>
</li>
<li>
<p>Pros:</p>
<p>- There is a good deal of tests. (unit, integration, e2e, fuzz) (ignoring the <code>indexmap-nostd</code> crate)<br>
  - We do have a very extensive CI (incl. <code>miri</code>)<br>
  - Wasmi <code>v0.31.1</code> is already used in production by different companies for some months.<br>
  - Wasmi <code>v0.31.1</code> has received a security audit by SRLabs.<br>
  - Wasmi <code>0.31.1</code> is much simpler than the Wasmi <code>v0.32.0-beta.n</code> (on <code>master</code>).<br>
</p>
</li>
</ul>
</blockquote>



<a name="417324270"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417324270" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417324270">(Jan 22 2024 at 22:06)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="417324367"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417324367" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417324367">(Jan 22 2024 at 22:07)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904909201">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>I just made this use Wasmi <code>v0.31.1</code> instead of <code>v0.31.0</code> which is more explicit. Note that <code>v0.31.0</code> got yanked some time ago.</p>
</blockquote>



<a name="417425640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417425640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417425640">(Jan 23 2024 at 11:29)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1904909201">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>I just made this use Wasmi <code>v0.31.1</code> instead of <code>v0.31.0</code> which is more explicit. Note that <code>v0.31.0</code> got yanked some time ago so even previously we already used <code>0.31.1</code>.</p>
</blockquote>



<a name="417500212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417500212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417500212">(Jan 23 2024 at 18:01)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1906624052">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Do others have thoughts on whether we should add exemptions for this dependency as opposed to vetting it?</p>
</blockquote>
<p>I'm happy with adding a cargo vet exemption for <code>wasmi 0.31.1</code> which notes that its only intended to be used in the context of testing. I don't think there is any real benefit to our project to have a higher bar than wasmi already meets for the sake of a fuzzing oracle.</p>
</blockquote>



<a name="417509960"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417509960" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417509960">(Jan 23 2024 at 18:59)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1906733756">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>I'm happy with adding a cargo vet exemption for <code>wasmi 0.31.1</code> which notes that its only intended to be used in the context of testing. I don't think there is any real benefit to our project to have a higher bar than wasmi already meets for the sake of a fuzzing oracle.</p>
</blockquote>
<p>Agreed.</p>
</blockquote>



<a name="417636122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417636122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417636122">(Jan 24 2024 at 12:37)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1908042701">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>btw. I just published a new <code>wasmi_arena v0.4.1</code> and yanked <code>v0.4.0</code> with the unsoundness fix. (<a href="https://crates.io/crates/wasmi_arena/0.4.1">https://crates.io/crates/wasmi_arena/0.4.1</a>)</p>
</blockquote>



<a name="417636213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417636213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417636213">(Jan 24 2024 at 12:37)</a>:</h4>
<p>Robbepop edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1908042701">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Reading over some code I think that <a href="https://github.com/paritytech/wasmi/blob/27def282b06613e770d0ab96de88b9909973a12b/crates/arena/src/component_vec.rs#L18-L19">this impl</a> is not sound as it's supposed to be <code>T: Sync</code>. Additionally though I don't think you should need the <code>unsafe impl</code> at all. You can try changing the <code>PhantomData</code> to either <code>fn() -&gt; Idx</code> or <code>fn(Idx)</code> I think as one of them might require the impl and one might not.</p>
</blockquote>
<p>btw. I just published a new <code>wasmi_arena v0.4.1</code> patch release and yanked <code>v0.4.0</code>.</p>
</blockquote>



<a name="417682230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417682230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417682230">(Jan 24 2024 at 16:26)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1908482885">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Ok I've posted <a href="https://github.com/bytecodealliance/wasmtime/pull/7810">https://github.com/bytecodealliance/wasmtime/pull/7810</a> with new vet metadata. If you rebase this PR on top of that once it lands should be good to go</p>
</blockquote>



<a name="417704205"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417704205" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417704205">(Jan 24 2024 at 18:33)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="417705060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417705060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417705060">(Jan 24 2024 at 18:38)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1908710880">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Something went terribly wrong with the rebase ... let me investigate ...</p>
</blockquote>



<a name="417705734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417705734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417705734">(Jan 24 2024 at 18:42)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="417705795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417705795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417705795">(Jan 24 2024 at 18:43)</a>:</h4>
<p>Robbepop deleted a <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1908710880">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<p>Something went terribly wrong with the rebase ... let me investigate ...</p>
</blockquote>



<a name="417706403"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417706403" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417706403">(Jan 24 2024 at 18:46)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<a name="417711436"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417711436" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417711436">(Jan 24 2024 at 19:19)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#pullrequestreview-1842188192">PR review</a>:</p>
<blockquote>
<p>Thanks for the patience while we figure out the vetting, and thanks again for helping us out with the update!</p>
</blockquote>



<a name="417713520"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417713520" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417713520">(Jan 24 2024 at 19:32)</a>:</h4>
<p>Robbepop <a href="https://github.com/bytecodealliance/wasmtime/pull/7791#issuecomment-1908787639">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>:</p>
<blockquote>
<blockquote>
<p>Thanks for the patience while we figure out the vetting, and thanks again for helping us out with the update!</p>
</blockquote>
<p>Happy to help and thanks for having Wasmi as fuzzing oracle! :)</p>
</blockquote>



<a name="417955483"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237791%20Update%20the%20Wasmi%20fuzzing%20oracle%20to%20ve.../near/417955483" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237791.20Update.20the.20Wasmi.20fuzzing.20oracle.20to.20ve.2E.2E.2E.html#417955483">(Jan 24 2024 at 20:08)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7791">PR #7791</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>