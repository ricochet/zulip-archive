<html>
<head><meta charset="utf-8"><title>wasmtime / PR #7773 Winch: Float conversion instructions · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html">wasmtime / PR #7773 Winch: Float conversion instructions</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="412564569"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412564569" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412564569">(Jan 12 2024 at 15:19)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<a name="412564570"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412564570" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412564570">(Jan 12 2024 at 15:19)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<a name="412564571"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412564571" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412564571">(Jan 12 2024 at 15:19)</a>:</h4>
<p>jeffcharles opened <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a> from <code>jeffcharles:winch-float-conversion-instructions</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
Part of #6528. Adds support for the following instructions to Winch:</p>
<ul>
<li><code>i32.trunc_f32_s</code></li>
<li><code>i32.trunc_f32_u</code></li>
<li><code>i32.trunc_f64_s</code></li>
<li><code>i32.trunc_f64_u</code></li>
<li><code>i64.trunc_f32_s</code></li>
<li><code>i64.trunc_f32_u</code></li>
<li><code>i64.trunc_f64_s</code></li>
<li><code>i64.trunc_f64_u</code></li>
<li><code>i32.reinterpret_f32</code></li>
<li><code>i64.reinterpret_f64</code></li>
<li><code>f32.convert_i32_s</code></li>
<li><code>f32.convert_i32_u</code></li>
<li><code>f32.convert_i64_s</code></li>
<li><code>f32.convert_i64_u</code></li>
<li><code>f64.convert_i32_s</code></li>
<li><code>f64.convert_i32_u</code></li>
<li><code>f64.convert_i64_s</code></li>
<li><code>f64.convert_i64_u</code></li>
<li><code>f32.reinterpret_i32</code></li>
<li><code>f64.reinterpret_i64</code></li>
<li><code>f32.demote_f64</code></li>
<li><code>f64.promote_f32</code></li>
</ul>
</blockquote>



<a name="412564572"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412564572" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412564572">(Jan 12 2024 at 15:19)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-fuzz-reviewers">wasmtime-fuzz-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<a name="412564573"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412564573" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412564573">(Jan 12 2024 at 15:19)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<a name="412578824"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412578824" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412578824">(Jan 12 2024 at 16:30)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/7773#pullrequestreview-1818633863">PR review</a>:</p>
<blockquote>
<p>LGTM, thanks!</p>
</blockquote>



<a name="412585318"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412585318" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412585318">(Jan 12 2024 at 17:04)</a>:</h4>
<p>jeffcharles <a href="https://github.com/bytecodealliance/wasmtime/pull/7773#issuecomment-1889659394">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>:</p>
<blockquote>
<p>Not sure why <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/7504830983/job/20432782059">https://github.com/bytecodealliance/wasmtime/actions/runs/7504830983/job/20432782059</a> failed. Running <code>cargo test --target=x86_64-apple-darwin -- wast::Winch --nocapture</code> locally shows everything as passing.</p>
</blockquote>



<a name="412588532"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412588532" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412588532">(Jan 12 2024 at 17:23)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/7773#issuecomment-1889684076">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>:</p>
<blockquote>
<p>It's because the conversion spec tests assert for traps <a href="https://github.com/bytecodealliance/wasmtime/pull/7773/files#diff-823efed0acf795e9245a551aadae26695321f840cbe4b51b12410b26bde35c45R70">https://github.com/bytecodealliance/wasmtime/pull/7773/files#diff-823efed0acf795e9245a551aadae26695321f840cbe4b51b12410b26bde35c45R70</a> and currently since Winch doesn't fully encode unwind information, any tests that trap will fail on Windows. You need to add the conversion suites that trap here <a href="https://github.com/bytecodealliance/wasmtime/blob/main/build.rs#L210">https://github.com/bytecodealliance/wasmtime/blob/main/build.rs#L210</a></p>
</blockquote>



<a name="412603871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412603871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412603871">(Jan 12 2024 at 19:03)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<a name="412603872"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412603872" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412603872">(Jan 12 2024 at 19:03)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<a name="412614246"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%237773%20Winch%3A%20Float%20conversion%20instructions/near/412614246" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.237773.20Winch.3A.20Float.20conversion.20instructions.html#412614246">(Jan 12 2024 at 20:19)</a>:</h4>
<p>saulecabrera merged <a href="https://github.com/bytecodealliance/wasmtime/pull/7773">PR #7773</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>