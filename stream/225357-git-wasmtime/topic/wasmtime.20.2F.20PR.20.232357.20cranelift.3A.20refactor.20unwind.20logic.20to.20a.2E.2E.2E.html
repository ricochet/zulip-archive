<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2357 cranelift: refactor unwind logic to a... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html">wasmtime / PR #2357 cranelift: refactor unwind logic to a...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="215522809"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215522809" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215522809">(Nov 03 2020 at 23:12)</a>:</h4>
<p><strong>yurydelendik</strong> requested <a href="https://github.com/peterhuene">peterhuene</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a>.</p>



<a name="215522810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215522810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215522810">(Nov 03 2020 at 23:12)</a>:</h4>
<p>yurydelendik opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
</ul>
</blockquote>



<a name="215583639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215583639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215583639">(Nov 04 2020 at 14:01)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
</ul>
</blockquote>



<a name="215590677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215590677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215590677">(Nov 04 2020 at 14:51)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
</ul>
</blockquote>



<a name="215616259"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215616259" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215616259">(Nov 04 2020 at 17:40)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
</ul>
</blockquote>



<a name="215639135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215639135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215639135">(Nov 04 2020 at 20:46)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
</ul>
</blockquote>



<a name="215711299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215711299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215711299">(Nov 05 2020 at 13:33)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
<li>Record initial stack pointer offset (as in CIE)</li>
</ul>
<p>The changes allows furthe introduction of fastcall logic and support of ARM-like architectures.</p>
</blockquote>



<a name="215717567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215717567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215717567">(Nov 05 2020 at 14:23)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
<li>Record initial stack pointer offset (as in CIE)</li>
</ul>
<p>The changes allows furthe introduction of fastcall logic and support of ARM-like architectures.</p>
</blockquote>



<a name="215764558"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764558" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764558">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524527196">PR Review</a>.</p>



<a name="215764560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764560">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524527196">PR Review</a>.</p>



<a name="215764561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764561">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518252528">PR Review Comment</a>:</p>
<blockquote>
<p>s/intermidate/intermediate/</p>
</blockquote>



<a name="215764562"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764562" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764562">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518253144">PR Review Comment</a>:</p>
<blockquote>
<p>s/speficied/specified/ (and below)</p>
</blockquote>



<a name="215764563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764563">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518265995">PR Review Comment</a>:</p>
<blockquote>
<p>Outdated comment (not just one word-size but configurable)?</p>
</blockquote>



<a name="215764564"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764564" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764564">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518274450">PR Review Comment</a>:</p>
<blockquote>
<p>This is pretty counter-intuitive to me without more context: maybe a comment describing the scheme would help. I think what is going on is: if the call-frame address is already defined in terms of a frame register, then this call overrides that definition (<code>Cfa</code> sets both reg and offset); but if no frame register is defined, then this call defines the given register to be the frame register. Is that right?</p>
<p>I'm not sure I understand the semantics fully either. "Frame register" implies to me a register that does not move, and elsewhere in this impl, we conditionally adjust offsets based on whether or not we're using a frame register. It seems that whether or not we're using a frame register is determined by how many times we call <code>set_cfa_reg</code> (whether odd or even count, I think?), which is confusing to me.</p>
</blockquote>



<a name="215764565"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215764565" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215764565">(Nov 05 2020 at 19:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518320505">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm -- long-term, I think it might make more sense to generate the necessary <code>UnwindCode</code> sequence directly in prologue/epilogue generation, rather than reverse-engineering the VCode sequence; this feels somewhat fragile (we have to keep in mind this translation if we change the ABI code). Out of scope for this PR, but I wonder if you have any thoughts on that...</p>
</blockquote>



<a name="215769192"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769192" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769192">(Nov 05 2020 at 20:25)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524638570">PR Review</a>.</p>



<a name="215769193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769193">(Nov 05 2020 at 20:25)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518342958">PR Review Comment</a>:</p>
<blockquote>
<p>"Reliable and Fast DWARF-Based Stack Unwinding" (<a href="https://hal.inria.fr/hal-02297690/document">https://hal.inria.fr/hal-02297690/document</a>), actually states the how hard it is to keep the unwind info in sync while performing optimizations as one of it's reasons to generate unwind info from the actual assembly.</p>
</blockquote>



<a name="215769743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769743">(Nov 05 2020 at 20:29)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518340362">PR Review Comment</a>:</p>
<blockquote>
<p>This is really strange to me as this <code>rsp</code> isn't really a frame pointer and if this is only necessary to incur a call to <code>set_cfa_reg</code> for popping <code>rbp</code> in SystemV unwind information generation then I'd prefer it done a different way.</p>
</blockquote>



<a name="215769744"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769744" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769744">(Nov 05 2020 at 20:29)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518312654">PR Review Comment</a>:</p>
<blockquote>
<p>nit: should we keep this a constant?</p>
</blockquote>



<a name="215769745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769745">(Nov 05 2020 at 20:29)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524601172">PR Review</a>.</p>



<a name="215769746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769746">(Nov 05 2020 at 20:29)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518318832">PR Review Comment</a>:</p>
<blockquote>
<p>Perhaps a <code>filter_map</code> here instead of returning an empty <code>Vec</code> for the last epilogue?</p>
<p>Also, if there's always two elements in the <code>Vec</code>, I wonder if <code>UnwindInfo&lt;Reg&gt;::epilogues_unwind_codes</code> should be <code>Vec&lt;[(CodeOffset, UnwindCode&lt;Reg&gt;); 2]&gt;</code> to reduce these small allocations?</p>
</blockquote>



<a name="215769747"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769747" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769747">(Nov 05 2020 at 20:29)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518344264">PR Review Comment</a>:</p>
<blockquote>
<p>I'm also having a hard time understanding why this is necessary from what it was previously implemented, namely recording a CFA change for the restore of <code>rbp</code> (i.e. in <code>restore_reg</code>) rather than having a strange, to me at least, "set frame pointer to <code>rsp</code>" unwind operation with these changes that causes the call to <code>set_cfa_reg</code>.</p>
<p>Yury, is there a semantic difference to the resulting baseline changes?</p>
<p>specifically:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">DW_CFA_def_cfa</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"></span>
<span class="n">DW_CFA_same_value</span><span class="p">(</span><span class="n">rbp</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>and </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">DW_CFA_same_value</span><span class="w"> </span><span class="p">(</span><span class="n">rbp</span><span class="p">)</span><span class="w"></span>
<span class="n">DW_CFA_def_cfa</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</blockquote>



<a name="215769748"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769748" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769748">(Nov 05 2020 at 20:29)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524601172">PR Review</a>.</p>



<a name="215769877"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215769877" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215769877">(Nov 05 2020 at 20:30)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518344264">PR Review Comment</a>.</p>



<a name="215770458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215770458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215770458">(Nov 05 2020 at 20:35)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518348393">PR Review Comment</a>:</p>
<blockquote>
<p>The more I think about this, the more I wonder if <code>UnwindInfo&lt;Reg&gt;::epilogues_unwind_codes</code> is even necessary rather than letting the unwind format consume the epilogue ranges from <code>UnwindInfoContext</code> and handle the remember state / restore state logic (which is DWARF-specific anyway).</p>
</blockquote>



<a name="215770460"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215770460" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215770460">(Nov 05 2020 at 20:35)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524645426">PR Review</a>.</p>



<a name="215770816"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215770816" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215770816">(Nov 05 2020 at 20:38)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518350143">PR Review Comment</a>:</p>
<blockquote>
<p>On an aside: do we have any test cases for <code>DW_CFA_remember_state</code>/<code>DW_CFA_restore_state</code>?  A quick grep doesn't show any results.</p>
</blockquote>



<a name="215770817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215770817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215770817">(Nov 05 2020 at 20:38)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524647639">PR Review</a>.</p>



<a name="215771154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215771154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215771154">(Nov 05 2020 at 20:42)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524649752">PR Review</a>.</p>



<a name="215771155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215771155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215771155">(Nov 05 2020 at 20:42)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518351807">PR Review Comment</a>:</p>
<blockquote>
<p><code>DW_CFA_def_cfa(rsp, 8)</code> and <code>DW_CFA_same_value(rbp)</code> affect different states, so in this case order is not relevant. </p>
<p>I'll add <code>ResetFramePointer</code> to restore CFA to its default value, as specified as the CIE.</p>
</blockquote>



<a name="215771451"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215771451" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215771451">(Nov 05 2020 at 20:44)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524651667">PR Review</a>.</p>



<a name="215771452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215771452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215771452">(Nov 05 2020 at 20:44)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518353295">PR Review Comment</a>:</p>
<blockquote>
<p>A different unwind operation (e.g. <code>RestoreFramePointer</code>) I think makes sense to me <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="215772332"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215772332" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215772332">(Nov 05 2020 at 20:52)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
<li>Record initial stack pointer offset (as in CIE)</li>
</ul>
<p>The changes allows furthe introduction of fastcall logic and support of ARM-like architectures.</p>
</blockquote>



<a name="215772934"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215772934" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215772934">(Nov 05 2020 at 20:57)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518360074">PR Review Comment</a>:</p>
<blockquote>
<p>Per the discussion in the other comment thread, I think this will be resolved with a new <code>RestoreFramePointer</code> unwind code.</p>
</blockquote>



<a name="215772936"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215772936" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215772936">(Nov 05 2020 at 20:57)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524660495">PR Review</a>.</p>



<a name="215773005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215773005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215773005">(Nov 05 2020 at 20:58)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524660793">PR Review</a>.</p>



<a name="215773008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215773008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215773008">(Nov 05 2020 at 20:58)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518360266">PR Review Comment</a>:</p>
<blockquote>
<p>It is a TODO -- added a comment about that. The test is <code>test_multi_return_func</code> at unwind/system.rs</p>
</blockquote>



<a name="215773013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215773013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215773013">(Nov 05 2020 at 20:58)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518360074">PR Review Comment</a>.</p>



<a name="215773203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215773203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215773203">(Nov 05 2020 at 20:59)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524661927">PR Review</a>.</p>



<a name="215773204"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215773204" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215773204">(Nov 05 2020 at 20:59)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518361147">PR Review Comment</a>:</p>
<blockquote>
<p>Ah, missed that as I was looking for a file test.</p>
</blockquote>



<a name="215782021"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215782021" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215782021">(Nov 05 2020 at 22:22)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a> from <code>pub-unwindcode</code> to <code>main</code>:</p>
<blockquote>
<p>Prepares code for #2313</p>
<ul>
<li>Make cranelift_codegen::isa::unwind::input public</li>
<li>Move <code>UnwindCode</code>'s common <code>offset</code> field out of the structure</li>
<li>Make <code>MachCompileResult::unwind_info</code> more generic</li>
<li>Record initial stack pointer offset (as in CIE)</li>
</ul>
<p>The changes allows furthe introduction of fastcall logic and support of ARM-like architectures.</p>
</blockquote>



<a name="215782726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215782726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215782726">(Nov 05 2020 at 22:31)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524724176">PR Review</a>.</p>



<a name="215782727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215782727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215782727">(Nov 05 2020 at 22:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#discussion_r518409908">PR Review Comment</a>:</p>
<blockquote>
<p>Interesting; one thing to note is that the prologue generation in our case happens right before code emission, after any optimizations, but point taken that there is a potential for mismatch. I suppose as long as we are careful with any changes to the prologue code that the translation still works (though the tests look quite good here so that gives me confidence).</p>
</blockquote>



<a name="215782865"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215782865" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215782865">(Nov 05 2020 at 22:32)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2357#pullrequestreview-524724813">PR Review</a>.</p>



<a name="215785033"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232357%20cranelift%3A%20refactor%20unwind%20logic%20to%20a.../near/215785033" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232357.20cranelift.3A.20refactor.20unwind.20logic.20to.20a.2E.2E.2E.html#215785033">(Nov 05 2020 at 22:57)</a>:</h4>
<p>yurydelendik merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2357">PR #2357</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>