<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3724 s390x: Migrate branches and traps ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html">wasmtime / issue #3724 s390x: Migrate branches and traps ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="270050879"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233724%20s390x%3A%20Migrate%20branches%20and%20traps%20.../near/270050879" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html#270050879">(Jan 31 2022 at 15:38)</a>:</h4>
<p>uweigand <a href="https://github.com/bytecodealliance/wasmtime/pull/3724#issuecomment-1025911418">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3724">issue #3724</a>:</p>
<blockquote>
<p>Can this be merged now or are you waiting on any action from my side?   I have other patches I'd like to submit and this is causing merge conflicts ...</p>
<p>As to the question of moving <code>emit_safepoint</code> to the common prelude, my preference would still be for other architecture maintainers to implement this for their platform as fits them best, and once it is done for all, we can still merge any definitions that end up the same back into the common prelude ...</p>
</blockquote>



<a name="270076622"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233724%20s390x%3A%20Migrate%20branches%20and%20traps%20.../near/270076622" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html#270076622">(Jan 31 2022 at 18:05)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/3724#issuecomment-1026058793">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3724">issue #3724</a>:</p>
<blockquote>
<blockquote>
<p>Can this be merged now or are you waiting on any action from my side?</p>
</blockquote>
<p>I think just the nitpicks that we didn't already discuss and agree could wait for follow ups:</p>
<ul>
<li>moving <code>emit_safepoint</code> into the prelude, and</li>
<li>moving its external rust implementation into <code>wasmtime/cranelift/codegen/src/machinst/isle.rs</code>.</li>
</ul>
</blockquote>



<a name="270082542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233724%20s390x%3A%20Migrate%20branches%20and%20traps%20.../near/270082542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html#270082542">(Jan 31 2022 at 18:42)</a>:</h4>
<p>uweigand <a href="https://github.com/bytecodealliance/wasmtime/pull/3724#issuecomment-1026091560">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3724">issue #3724</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Can this be merged now or are you waiting on any action from my side?</p>
</blockquote>
<p>I think just the nitpicks that we didn't already discuss and agree could wait for follow ups:</p>
<div class="codehilite"><pre><span></span><code>* moving `emit_safepoint` into the prelude, and

* moving its external rust implementation into `wasmtime/cranelift/codegen/src/machinst/isle.rs`.
</code></pre></div>

</blockquote>
<p>But that was just what we discussed: As I understand, x64 will need a _different_ <code>emit_safepoint</code> implementation due the move mitosis stuff, so it's not clear this can be shared.</p>
</blockquote>



<a name="270090153"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233724%20s390x%3A%20Migrate%20branches%20and%20traps%20.../near/270090153" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html#270090153">(Jan 31 2022 at 19:26)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/3724#issuecomment-1026128847">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3724">issue #3724</a>:</p>
<blockquote>
<p>Ah right. Then just the <code>decl</code> and <code>extern</code> bits need to move to <code>prelude.isle</code> and the implementations can be pre-backend. We can stub out the other backends with <code>unimplemented!()</code> for now.</p>
</blockquote>



<a name="270102201"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233724%20s390x%3A%20Migrate%20branches%20and%20traps%20.../near/270102201" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html#270102201">(Jan 31 2022 at 20:48)</a>:</h4>
<p>uweigand <a href="https://github.com/bytecodealliance/wasmtime/pull/3724#issuecomment-1026195214">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3724">issue #3724</a>:</p>
<blockquote>
<blockquote>
<p>Ah right. Then just the <code>decl</code> and <code>extern</code> bits need to move to <code>prelude.isle</code> and the implementations can be pre-backend. We can stub out the other backends with <code>unimplemented!()</code> for now.</p>
</blockquote>
<p>I'm happy to do that, but I'd really prefer this to be a separate PR.  That will still touch all backends and their generated files, and I'd prefer not to entangle this with this back-end change, which is already quite large as-is ...</p>
</blockquote>



<a name="270112023"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233724%20s390x%3A%20Migrate%20branches%20and%20traps%20.../near/270112023" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233724.20s390x.3A.20Migrate.20branches.20and.20traps.20.2E.2E.2E.html#270112023">(Jan 31 2022 at 21:59)</a>:</h4>
<p>uweigand <a href="https://github.com/bytecodealliance/wasmtime/pull/3724#issuecomment-1026253833">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3724">issue #3724</a>:</p>
<blockquote>
<blockquote>
<p>Okay, we can do that in follow ups then.</p>
</blockquote>
<p>Thanks!  The follow up is now here:  <a href="https://github.com/bytecodealliance/wasmtime/pull/3745">https://github.com/bytecodealliance/wasmtime/pull/3745</a></p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>