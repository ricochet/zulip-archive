<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2678 x86-64 Windows fastcall ABI support. · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html">wasmtime / PR #2678 x86-64 Windows fastcall ABI support.</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="227381222"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227381222" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227381222">(Feb 23 2021 at 04:31)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/abrown">abrown</a> and <a href="https://github.com/bnjbvr">bnjbvr</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a>.</p>



<a name="227381223"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227381223" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227381223">(Feb 23 2021 at 04:31)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/abrown">abrown</a> and <a href="https://github.com/bnjbvr">bnjbvr</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a>.</p>



<a name="227381224"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227381224" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227381224">(Feb 23 2021 at 04:31)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>:</p>
<blockquote>
<p>This adds support for the "fastcall" ABI, which is the native C/C++ ABI<br>
on Windows platforms on x86-64. It is similar to but not exactly like<br>
System V; primarily, its argument register assignments are different,<br>
and it requires stack shadow space.</p>
<p>Note that this also adjusts the handling of multi-register values in the<br>
shared ABI implementation, and with this change, adjusts handling of<br>
<code>i128</code>s on <em>both</em> Fastcall/x64 <em>and</em> SysV/x64 platforms. This was done<br>
to align with actual behavior by the "rustc ABI" on both platforms, as<br>
mapped out experimentally (Compiler Explorer link in comments).</p>
<p>Note also that this does <em>not</em> add x64 unwind info on Windows. That will<br>
come in a future PR (but is planned!).</p>
<p>Finally, note that this does not add any tests that actually <em>execute</em><br>
with the fastcall ABI on Windows, because we are not testing the new<br>
backend on Windows on our CI setup; test coverage is via filetests for<br>
now. We could possibly Windows-with-new-backend CI if we wanted to,<br>
though I don't think the Wasmtime-internal use cases will make use of<br>
Fastcall.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="227381343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227381343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227381343">(Feb 23 2021 at 04:33)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="227381428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227381428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227381428">(Feb 23 2021 at 04:34)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="227389994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227389994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227389994">(Feb 23 2021 at 07:04)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-596039528">PR Review</a>.</p>



<a name="227389995"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227389995" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227389995">(Feb 23 2021 at 07:04)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r580806613">PR Review Comment</a>:</p>
<blockquote>
<p>This feature doesn't exist.</p>
</blockquote>



<a name="227393537"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227393537" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227393537">(Feb 23 2021 at 07:58)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="227393619"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227393619" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227393619">(Feb 23 2021 at 07:59)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-596068673">PR Review</a>.</p>



<a name="227393620"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227393620" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227393620">(Feb 23 2021 at 07:59)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r580829859">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, the changes in <code>parser.rs</code> were unintended, sorry about that -- part of my experiments in removing the old backend altogether. (I'll put together a draft PR for that soon-ish.) Reverted this file.</p>
</blockquote>



<a name="227484243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227484243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227484243">(Feb 23 2021 at 18:56)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="227487102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/227487102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#227487102">(Feb 23 2021 at 19:14)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228005108"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005108" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005108">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-599956053">PR Review</a>.</p>



<a name="228005109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005109">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-599956053">PR Review</a>.</p>



<a name="228005110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005110">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583929385">PR Review Comment</a>:</p>
<blockquote>
<p>Weird... this _is_ used by <code>SseOpcode</code>, right?</p>
</blockquote>



<a name="228005111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005111">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583935758">PR Review Comment</a>:</p>
<blockquote>
<p>documentation: not immediately obvious why this is needed.</p>
</blockquote>



<a name="228005112"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005112" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005112">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583932519">PR Review Comment</a>:</p>
<blockquote>
<p>Can we add an issue URL here?</p>
</blockquote>



<a name="228005113"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005113" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005113">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583934987">PR Review Comment</a>:</p>
<blockquote>
<p>Not sure I understand why these should change... The default ABI should still be System V and that hasn't really changed, right?</p>
</blockquote>



<a name="228005114"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005114" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005114">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583939820">PR Review Comment</a>:</p>
<blockquote>
<p>It seems like we should be throwing/panicking before an <code>ABIArgPart::None</code> is ever allowed.</p>
</blockquote>



<a name="228005115"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005115" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005115">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583936844">PR Review Comment</a>:</p>
<blockquote>
<p>It sort of feels like the <code>Type</code> should be attached to <code>ABIArg</code>, not <code>ABIArgPart</code>--how do we know what <code>ABIArg</code>'s original type is?</p>
</blockquote>



<a name="228005116"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005116" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005116">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583941591">PR Review Comment</a>:</p>
<blockquote>
<p>I wouldn't mind including links like <a href="https://docs.microsoft.com/en-us/cpp/build/x64-calling-convention">this one</a> in some of the docs.</p>
</blockquote>



<a name="228005117"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005117" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005117">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583945005">PR Review Comment</a>:</p>
<blockquote>
<p>Perhaps we should <code>debug_assert</code> or something here that we are still aligned?</p>
</blockquote>



<a name="228005118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005118">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583947916">PR Review Comment</a>:</p>
<blockquote>
<p>I think we need to reconcile this with <a href="https://docs.microsoft.com/en-us/cpp/build/x64-calling-convention?view=msvc-160#example-of-return-value-2---128-bit-result">the example</a> from the Microsoft docs; their <code>__m128</code> is being returned in XMM0.</p>
</blockquote>



<a name="228005119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005119">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583949056">PR Review Comment</a>:</p>
<blockquote>
<p>BTW, what is happening with multi-return? Is some code somewhere else panicking to avoid this case or should we be panicking here?</p>
</blockquote>



<a name="228005120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005120">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583944523">PR Review Comment</a>:</p>
<blockquote>
<p>We don't have a "store on the stack" <code>Inst</code>?</p>
</blockquote>



<a name="228005121"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005121" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005121">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583953277">PR Review Comment</a>:</p>
<blockquote>
<p>I've seen this type of thing enough that we may want to create an inline function <code>align</code> somewhere.</p>
</blockquote>



<a name="228005122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005122">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583951477">PR Review Comment</a>:</p>
<blockquote>
<p>More detail? <code>panic!("unable to save fastcall callee register for the register class: {}", r.get_class())</code></p>
</blockquote>



<a name="228005123"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228005123" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228005123">(Feb 26 2021 at 22:25)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583937515">PR Review Comment</a>:</p>
<blockquote>
<p>I guess the same applies to <code>purpose</code>: what happens if <code>self.parts()[1]</code> has a different purpose than <code>self.parts()[0]</code>?</p>
</blockquote>



<a name="228006141"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228006141" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228006141">(Feb 26 2021 at 22:33)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600002998">PR Review</a>.</p>



<a name="228006143"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228006143" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228006143">(Feb 26 2021 at 22:33)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583961539">PR Review Comment</a>:</p>
<blockquote>
<p>This is used by <code>ValueRegs</code>'s packed encoding -- it doesn't have a length field, instead using "invalid" sentinels for parts beyond the needed part-count. Perhaps my reuse of <code>ValueRegs</code> rather than something simpler like <code>Vec&lt;ABIArgPart&gt;</code> is the real issue -- in hindsight it's probably better to just do that!</p>
</blockquote>



<a name="228006311"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228006311" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228006311">(Feb 26 2021 at 22:34)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600003453">PR Review</a>.</p>



<a name="228006312"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228006312" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228006312">(Feb 26 2021 at 22:34)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583961919">PR Review Comment</a>:</p>
<blockquote>
<p>The latter case violates an intended invariant (if that's not asserted I'll add it -- will check). The <code>Type</code> is actually specific to the <code>ABIArgPart</code> -- we use it to generate loads/stores just for that part.</p>
</blockquote>



<a name="228006563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228006563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228006563">(Feb 26 2021 at 22:36)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583962558">PR Review Comment</a>:</p>
<blockquote>
<p>Our prior <code>i128</code> impl for SysV ABI was actually wrong w.r.t. Rust's ABI; this PR aligns them for SysV as well. (I'm actually surprised we didn't catch this earlier, but I suppose all of the cg_clif tests so far haven't had an <code>i128</code> arg that straddles the 6th and 7th machine words, i.e. the half-reg-and-half-stack case, which is what causes the difference.)</p>
</blockquote>



<a name="228006564"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228006564" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228006564">(Feb 26 2021 at 22:36)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600004195">PR Review</a>.</p>



<a name="228007012"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228007012" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228007012">(Feb 26 2021 at 22:39)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r583963786">PR Review Comment</a>:</p>
<blockquote>
<p>So this is actually the most interesting unresolved question here, I think. It appears that <code>rustc</code> behaves for ABI purposes as if <code>i128</code> is just two <code>i64</code>s; this affects returns (rax/rdx) and also the way that args are assigned (lower half can be in reg and upper half on stack).</p>
<p>This raises the question whether cg_clif needs to change or whether we need to document that our <code>i128</code>s are basically lowered to <code>i64</code> pairs for ABI purposes and are not treated as true 128-bit values. The former is possible (and then we can just punt on <code>i128</code>s in fastcall) but requires changes on @bjorn3's end -- thoughts?</p>
</blockquote>



<a name="228007013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228007013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228007013">(Feb 26 2021 at 22:39)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600005640">PR Review</a>.</p>



<a name="228039728"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228039728" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228039728">(Feb 27 2021 at 07:07)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600113790">PR Review</a>.</p>



<a name="228039729"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228039729" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228039729">(Feb 27 2021 at 07:07)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584070011">PR Review Comment</a>:</p>
<blockquote>
<p>Rustc forces all scalars &gt; 8 bytes to be passed by reference: <a href="https://github.com/rust-lang/rust/blob/9fa580b1175018b0a276b0bc68f9827a106f7260/compiler/rustc_target/src/abi/call/x86_win64.rs#L23">https://github.com/rust-lang/rust/blob/9fa580b1175018b0a276b0bc68f9827a106f7260/compiler/rustc_target/src/abi/call/x86_win64.rs#L23</a> This means that i128 is never used as argument type by rustc for WindowsFastcall.</p>
</blockquote>



<a name="228100694"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228100694" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228100694">(Feb 28 2021 at 03:10)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600212541">PR Review</a>.</p>



<a name="228100695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228100695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228100695">(Feb 28 2021 at 03:10)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584223216">PR Review Comment</a>:</p>
<blockquote>
<p>Interesting -- that seems to be inconsistent with what the actual compiler output shows (or at least, I may be misunderstanding in which cases the "scalars &gt; 8 bytes" by-ref rule applies): in <a href="https://godbolt.org/z/PhG3ob">this example</a>, the <code>i128</code> args are being passed as two <code>i64</code>s, by value. Does cg_clif perform this decomposition as well (i.e. use <code>i64</code>s in the CLIF)?</p>
</blockquote>



<a name="228169408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228169408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228169408">(Mar 01 2021 at 00:51)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600330850">PR Review</a>.</p>



<a name="228169409"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228169409" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228169409">(Mar 01 2021 at 00:51)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584392180">PR Review Comment</a>:</p>
<blockquote>
<p>@bjorn3 reading a bit more on the cg_clif side: I see at least <a href="https://github.com/bjorn3/rustc_codegen_cranelift/blob/86c594426f247ae34ef12f5e4dfd97f5ffe093c8/src/codegen_i128.rs#L47">here</a> a libcall invocation that uses <code>I128</code> types directly, and <a href="https://github.com/bjorn3/rustc_codegen_cranelift/blob/master/src/abi/mod.rs">in the general ABI mapping</a> I see some stuff related to "spread" args (used for tuples it seems?) but no explicit handling for <code>i128</code>s. (Does rustc's front/middle-end say that <code>i128</code>s are "spread" across <code>i64</code>s?)</p>
<p>A possible solution: we could invent an ABI variant, essentially, that adds "rustc-compatible <code>i128</code> handling" on top of SysV or Fastcall. Perhaps <code>CallConv::SystemVRust</code> and <code>CallConv::WindowsFastcallRust</code>. Then we can keep the <code>i128</code>-becomes-two-<code>i64</code>s handling on the Cranelift side, and everything should basically work. When in vanilla <code>SystemV</code> or <code>WindowsFastcall</code>, I would then propose that we actually panic if we see an <code>i128</code>, unless/until we later implement this in a strictly spec-compliant way.</p>
<p>Thoughts?</p>
</blockquote>



<a name="228189899"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228189899" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228189899">(Mar 01 2021 at 07:16)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600440667">PR Review</a>.</p>



<a name="228189900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228189900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228189900">(Mar 01 2021 at 07:16)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584488448">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>I see at least here a libcall invocation that uses I128 types directly</p>
</blockquote>
<p>In the Windows support PR these arguments are passed by reference when comliling for Windows: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/pull/1145/files#diff-0c7a9de394376b33448baed91218bb8167a6d7cac581590442cfb81b9f6e63f7R39">https://github.com/bjorn3/rustc_codegen_cranelift/pull/1145/files#diff-0c7a9de394376b33448baed91218bb8167a6d7cac581590442cfb81b9f6e63f7R39</a></p>
<blockquote>
<p>Does rustc's front/middle-end say that i128s are "spread" across i64s?</p>
</blockquote>
<p>No, it just directly passes it to LLVM for SystemV and forces it to be passed Indirect on Windows.</p>
<blockquote>
<p>A possible solution: we could invent an ABI variant, essentially, that adds "rustc-compatible i128 handling" on top of SysV or Fastcall.</p>
</blockquote>
<p>The SystemV abi defines how <code>__int128</code> needs to be passed.</p>
</blockquote>



<a name="228224149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228224149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228224149">(Mar 01 2021 at 12:50)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600696824">PR Review</a>.</p>



<a name="228224150"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228224150" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228224150">(Mar 01 2021 at 12:50)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584685857">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>Interesting -- that seems to be inconsistent with what the actual compiler output shows (or at least, I may be misunderstanding in which cases the "scalars &gt; 8 bytes" by-ref rule applies): in this example, the i128 args are being passed as two i64s, by value. Does cg_clif perform this decomposition as well (i.e. use i64s in the CLIF)?</p>
</blockquote>
<p>In that example the "Rust" abi is used instead of the "C" abi. The "Rust" abi has the extra rule that any value that fits into two registers is given the <code>Cast(CastTarget::from(Reg { kind: RegKind::Integer, size: 128 }))</code> pass mode. This is independent of the real type of the value. It even works for structs. <a href="https://github.com/rust-lang/rust/blob/d2731d8e9338d8fe844e19d3fbb39617753e65f4/compiler/rustc_middle/src/ty/layout.rs#L2894-L2897">https://github.com/rust-lang/rust/blob/d2731d8e9338d8fe844e19d3fbb39617753e65f4/compiler/rustc_middle/src/ty/layout.rs#L2894-L2897</a></p>
</blockquote>



<a name="228266851"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228266851" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228266851">(Mar 01 2021 at 17:03)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600962330">PR Review</a>.</p>



<a name="228266852"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228266852" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228266852">(Mar 01 2021 at 17:03)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584889631">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, indeed. I hadn't realized that the Rust ABI would differ here (my naive understanding was that it had mostly to do with struct layout details, eg allowing fields to be reordered, but I see that's not the only thing!).</p>
<p>So, my earlier thoughts stemmed from that Compiler Explorer example and my resulting assumption that rustc was doing something weird and not-quite-standards-compliant with <code>i128</code>s, but that we would have to handle this in Cranelift in a function that specifies standard ABI. But, indeed, if I add <code>extern "C"</code> to the signature, I see that rustc does the Fastcall-compliant thing with by-ref args.</p>
<p>I see now that (correct me if I am wrong here) it appears that cg_clif will do the appropriate translation to SysV/Fastcall-compliant details for a Rust ABI signature; so we don't need to special-case this, and instead just need to implement the standard and nothing more.</p>
<p>The part I was hoping to avoid ("panic if we see an i128") was having to implement the by-ref semantics as well for <code>i128</code>, as this adds extra complexity and another case. The only time that we would see this would be when interfacing with a C-ABI function that uses <code>i128</code>; either as an <code>extern "C"</code> in rustc + cg_clif, or with an <code>__int128</code> in a hypothetical future C/C++ frontend to Cranelift (or some other language that has 128-bit types). But, at least the first case (<code>extern "C" with i128 with with cg_clif</code>) is possible to trigger, so we should handle it.</p>
<p>I'll (i) implement by-ref for i128s, (ii) rip out the Rust ABI-specific details on Fastcall, and then (iii) add a whole bunch of tests for these dark corners.</p>
</blockquote>



<a name="228267382"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228267382" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228267382">(Mar 01 2021 at 17:06)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584889631">PR Review Comment</a>.</p>



<a name="228267512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228267512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228267512">(Mar 01 2021 at 17:07)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584889631">PR Review Comment</a>.</p>



<a name="228269269"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228269269" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228269269">(Mar 01 2021 at 17:18)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600977836">PR Review</a>.</p>



<a name="228269270"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228269270" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228269270">(Mar 01 2021 at 17:18)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584901934">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>rip out the Rust ABI-specific details on Fastcall</p>
</blockquote>
<p>If you are talking about passing i128 in two registers, that is still necessary for <code>extern "Rust"</code> as the abi of cg_clif and cg_llvm should match.</p>
</blockquote>



<a name="228270129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228270129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228270129">(Mar 01 2021 at 17:23)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600982978">PR Review</a>.</p>



<a name="228270130"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228270130" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228270130">(Mar 01 2021 at 17:23)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584905915">PR Review Comment</a>:</p>
<blockquote>
<p>Hmm, now I am confused again. I had meant the code that implements "<code>i128</code> at CLIF level becomes two <code>i64</code>s in fastcall signature", because that is not Fastcall-compliant. If a frontend (cg_clif or any other) does this split, though, then that would still work as any other <code>i64</code> args would.</p>
<p>So to clarify: are you saying that <code>cg_clif</code> will pass <code>i128</code> args for <code>extern "Rust"</code> functions? (My understanding is no...)</p>
</blockquote>



<a name="228270414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228270414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228270414">(Mar 01 2021 at 17:25)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600984504">PR Review</a>.</p>



<a name="228270415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228270415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228270415">(Mar 01 2021 at 17:25)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584907125">PR Review Comment</a>:</p>
<blockquote>
<p>For <code>extern "C"</code> functions it will pass it by reference. For <code>extern "Rust"</code> functions it will pass <code>i128</code> args.</p>
</blockquote>



<a name="228271196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228271196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228271196">(Mar 01 2021 at 17:30)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-600988953">PR Review</a>.</p>



<a name="228271197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228271197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228271197">(Mar 01 2021 at 17:30)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584910863">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>For extern "Rust" functions it will pass i128 args.</p>
</blockquote>
<p>OK, so then for Rust ABI compatibility, this requires functionality in Cranelift that goes beyond standard Fastcall, right? If we implement fastcall-compliant handling of <code>i128</code>s, then Cranelift will generate by-ref arg passing code, and this will not be compatible with other Rust code (which splits into two <code>i64</code> registers), as shown in the Compiler Explorer example. This was the reason I had suggested Rust-specific variants of <code>CallConv</code> above. Does that make sense?</p>
</blockquote>



<a name="228273525"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228273525" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228273525">(Mar 01 2021 at 17:42)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-601000290">PR Review</a>.</p>



<a name="228273527"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228273527" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228273527">(Mar 01 2021 at 17:42)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r584919604">PR Review Comment</a>:</p>
<blockquote>
<p>Makes sense, though I think it is more of an LLVM-specific variant, as it is an LLVM extension to support i128 passed in two registers. LLVM also for example supports passing three return values in registers, unlike SystemV which only allows two. This extension is supported by the old x86 backend already, but not in the new backend. cg_clif doesn't use more than two return registers, so that extension doesn't matter.</p>
</blockquote>



<a name="228711583"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711583" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711583">(Mar 04 2021 at 03:45)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603679260">PR Review</a>.</p>



<a name="228711584"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711584" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711584">(Mar 04 2021 at 03:45)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587055993">PR Review Comment</a>:</p>
<blockquote>
<p>The <code>BMI2</code> variant is never constructed and was triggering a warning, so I've moved the pragma there, though I can remove this drive-by warning fixup and we can do a separate warning cleanup (the new backend build isn't fully warning-clean yet) if you'd prefer!</p>
</blockquote>



<a name="228711592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711592">(Mar 04 2021 at 03:45)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228711593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711593">(Mar 04 2021 at 03:45)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603679369">PR Review</a>.</p>



<a name="228711594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711594">(Mar 04 2021 at 03:45)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587056259">PR Review Comment</a>:</p>
<blockquote>
<p>Done!</p>
</blockquote>



<a name="228711671"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711671" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711671">(Mar 04 2021 at 03:46)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603679711">PR Review</a>.</p>



<a name="228711672"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711672" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711672">(Mar 04 2021 at 03:46)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587056865">PR Review Comment</a>:</p>
<blockquote>
<p>Changed -- this has now been refactored so that we have a <code>Vec</code> of <code>ABIArgSlot</code>s (old "parts") and don't overload <code>ValueRegs</code>.</p>
</blockquote>



<a name="228711697"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711697" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711697">(Mar 04 2021 at 03:47)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603679951">PR Review</a>.</p>



<a name="228711698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711698">(Mar 04 2021 at 03:47)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587057372">PR Review Comment</a>:</p>
<blockquote>
<p>Fixed this in refactor -- <code>purpose</code> is part of toplevel <code>ABIArg::Slots</code> variant which contains vec of slot descriptions, so there is no duplication.</p>
</blockquote>



<a name="228711751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711751">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228711758"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711758" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711758">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603680328">PR Review</a>.</p>



<a name="228711760"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711760" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711760">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587058119">PR Review Comment</a>:</p>
<blockquote>
<p>Done!</p>
</blockquote>



<a name="228711815"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711815" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711815">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603680467">PR Review</a>.</p>



<a name="228711816"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711816" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711816">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587058379">PR Review Comment</a>:</p>
<blockquote>
<p>Fixed via refactor; not using <code>ValueRegs</code> anymore so no <code>None</code> sentinel variant is needed.</p>
</blockquote>



<a name="228711830"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711830" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711830">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603680576">PR Review</a>.</p>



<a name="228711831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711831">(Mar 04 2021 at 03:48)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587058695">PR Review Comment</a>:</p>
<blockquote>
<p>Did one better; just used alignment helper.</p>
</blockquote>



<a name="228711860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711860">(Mar 04 2021 at 03:49)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603680796">PR Review</a>.</p>



<a name="228711861"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711861" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711861">(Mar 04 2021 at 03:49)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587059165">PR Review Comment</a>:</p>
<blockquote>
<p>Resolved in latest update -- this behavior is now under the <code>enable_llvm_abi_extensions</code> flag as discussed in the comments below.</p>
</blockquote>



<a name="228711885"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711885" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711885">(Mar 04 2021 at 03:49)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603680975">PR Review</a>.</p>



<a name="228711886"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711886" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711886">(Mar 04 2021 at 03:49)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587059538">PR Review Comment</a>:</p>
<blockquote>
<p>Done! <code>align_to()</code> now used throughout this ABI code (and corresponding aarch64 code too).</p>
</blockquote>



<a name="228711899"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711899" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711899">(Mar 04 2021 at 03:50)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603681028">PR Review</a>.</p>



<a name="228711900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228711900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228711900">(Mar 04 2021 at 03:50)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587059675">PR Review Comment</a>:</p>
<blockquote>
<p>Done!</p>
</blockquote>



<a name="228712034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228712034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228712034">(Mar 04 2021 at 03:51)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603681416">PR Review</a>.</p>



<a name="228712035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228712035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228712035">(Mar 04 2021 at 03:51)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587060446">PR Review Comment</a>:</p>
<blockquote>
<p>With more return values, we use the return-area pointer, similar to what happens under SysV. This is, properly speaking, an extension (for both ABIs); but it's necessary for e.g. Wasm multi-value support.</p>
</blockquote>



<a name="228712164"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228712164" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228712164">(Mar 04 2021 at 03:53)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228712254"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228712254" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228712254">(Mar 04 2021 at 03:54)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603682438">PR Review</a>.</p>



<a name="228712255"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228712255" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228712255">(Mar 04 2021 at 03:54)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#discussion_r587062734">PR Review Comment</a>:</p>
<blockquote>
<p>Switched to the usual <code>store</code> helper; not sure why the old code didn't use this.</p>
</blockquote>



<a name="228712421"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228712421" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228712421">(Mar 04 2021 at 03:56)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-603683182">PR Review</a>.</p>



<a name="228714736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228714736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228714736">(Mar 04 2021 at 04:25)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228721882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228721882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228721882">(Mar 04 2021 at 05:55)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228722002"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228722002" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228722002">(Mar 04 2021 at 05:57)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228722783"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228722783" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228722783">(Mar 04 2021 at 06:08)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228816480"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228816480" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228816480">(Mar 04 2021 at 17:36)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="228991188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228991188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228991188">(Mar 05 2021 at 17:23)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2678#pullrequestreview-605441521">PR Review</a>.</p>



<a name="228996636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/228996636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#228996636">(Mar 05 2021 at 17:59)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a> from <code>x64-fastcall</code> to <code>main</code>.</p>



<a name="229004210"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232678%20x86-64%20Windows%20fastcall%20ABI%20support./near/229004210" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232678.20x86-64.20Windows.20fastcall.20ABI.20support.2E.html#229004210">(Mar 05 2021 at 18:46)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2678">PR #2678</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>