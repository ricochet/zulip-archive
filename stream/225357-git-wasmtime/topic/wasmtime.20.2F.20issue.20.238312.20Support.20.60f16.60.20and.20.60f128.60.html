<html>
<head><meta charset="utf-8"><title>wasmtime / issue #8312 Support `f16` and `f128` · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238312.20Support.20.60f16.60.20and.20.60f128.60.html">wasmtime / issue #8312 Support `f16` and `f128`</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="431726677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238312%20Support%20%60f16%60%20and%20%60f128%60/near/431726677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238312.20Support.20.60f16.60.20and.20.60f128.60.html#431726677">(Apr 07 2024 at 03:22)</a>:</h4>
<p>tgross35 opened <a href="https://github.com/bytecodealliance/wasmtime/issues/8312">issue #8312</a>:</p>
<blockquote>
<p>Thanks for filing a feature request! Please fill out the TODOs below.</p>
<h4>Feature</h4>
<p>Add support for 16-bit and 128-bit IEEE floating point numbers.</p>
<h4>Benefit</h4>
<p>This will allow using these types with <code>rustc_codegen_clif</code>, as described at <a href="https://github.com/rust-lang/rustc_codegen_cranelift/issues/1461">https://github.com/rust-lang/rustc_codegen_cranelift/issues/1461</a></p>
<h4>Implementation</h4>
<p>Unsure</p>
<h4>Alternatives</h4>
<p>Unsure, maybe it would be possible to stub out these types if adding them is difficult.</p>
</blockquote>



<a name="438141044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238312%20Support%20%60f16%60%20and%20%60f128%60/near/438141044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238312.20Support.20.60f16.60.20and.20.60f128.60.html#438141044">(May 11 2024 at 23:26)</a>:</h4>
<p><a href="https://github.com/jameysharp">jameysharp</a> added the cranelift label to <a href="https://github.com/bytecodealliance/wasmtime/issues/8312">Issue #8312</a>.</p>



<a name="438141045"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238312%20Support%20%60f16%60%20and%20%60f128%60/near/438141045" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238312.20Support.20.60f16.60.20and.20.60f128.60.html#438141045">(May 11 2024 at 23:26)</a>:</h4>
<p><a href="https://github.com/jameysharp">jameysharp</a> added the cranelift:area:clif label to <a href="https://github.com/bytecodealliance/wasmtime/issues/8312">Issue #8312</a>.</p>



<a name="438143605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%238312%20Support%20%60f16%60%20and%20%60f128%60/near/438143605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.238312.20Support.20.60f16.60.20and.20.60f128.60.html#438143605">(May 12 2024 at 00:21)</a>:</h4>
<p>jameysharp <a href="https://github.com/bytecodealliance/wasmtime/issues/8312#issuecomment-2106068334">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/8312">issue #8312</a>:</p>
<blockquote>
<p>Adding the types is pretty easy, I think, and extending CLIF floating-point instructions to allow the new types is also pretty easy. Successfully compiling anything that uses the types is the hard part, I imagine.</p>
<p>I think the places to add the types are:</p>
<ul>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/e6f9ca5efa0c4bf59c9cf133d9abeaab63ec07bb/cranelift/codegen/meta/src/cdsl/typevar.rs#L646">https://github.com/bytecodealliance/wasmtime/blob/e6f9ca5efa0c4bf59c9cf133d9abeaab63ec07bb/cranelift/codegen/meta/src/cdsl/typevar.rs#L646</a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/e6f9ca5efa0c4bf59c9cf133d9abeaab63ec07bb/cranelift/codegen/meta/src/shared/types.rs#L44-L73">https://github.com/bytecodealliance/wasmtime/blob/e6f9ca5efa0c4bf59c9cf133d9abeaab63ec07bb/cranelift/codegen/meta/src/shared/types.rs#L44-L73</a></li>
<li>various places in <a href="https://github.com/bytecodealliance/wasmtime/blob/e6f9ca5efa0c4bf59c9cf133d9abeaab63ec07bb/cranelift/codegen/src/ir/types.rs">https://github.com/bytecodealliance/wasmtime/blob/e6f9ca5efa0c4bf59c9cf133d9abeaab63ec07bb/cranelift/codegen/src/ir/types.rs</a></li>
</ul>
<p>Once the tests are passing again after that, I think you'll have a compiler that will accept f16/f128 instructions. But if you use them, then it will fail later: during lowering on all backends; in the interpreter; in compiletests and runtests; and in fuzzing.</p>
<p>I think this is a fairly large project, but if rustc needs these types, I think it's reasonable to add the types in one PR and then work on adding implementations for them everywhere over time.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>