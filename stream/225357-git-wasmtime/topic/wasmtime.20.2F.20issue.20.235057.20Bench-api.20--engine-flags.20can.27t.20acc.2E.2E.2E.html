<html>
<head><meta charset="utf-8"><title>wasmtime / issue #5057 Bench-api --engine-flags can&#x27;t acc... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html">wasmtime / issue #5057 Bench-api --engine-flags can&#x27;t acc...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="304137364"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304137364" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304137364">(Oct 15 2022 at 00:18)</a>:</h4>
<p>brianjjones opened <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>TODO: upload Wasm file here</p>
<h3>Steps to Reproduce</h3>
<p>1.) Build bench-api.<br>
2.) sightglass-cli benchmark ... --engine-flags '--wasi-modules experimental-wasi-nn'</p>
<h3>Expected Results</h3>
<p>Benchmark runs to completion</p>
<h3>Actual Results</h3>
<p>error: Found argument '--wasi-modules experimental-wasi-nn' which wasn't expected, or isn't valid in this context</p>
<h3>Versions and Environment</h3>
<p>wasmtime commit ff0c45b4a069a84b131c8265d8d14c2f7d0566d7</p>
<p>Operating system: ubuntu 20.04</p>
<p>Architecture: x86</p>
<h3>Extra Info</h3>
<p>--engine-flags appears to not be able to accept a string that starts with --, so you are unable to set the flag needed to cause wasi-nn to be linked at runtime. This means wasi-nn can't be used by Sightglass currently.<br>
</p>
</blockquote>



<a name="304137365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304137365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304137365">(Oct 15 2022 at 00:18)</a>:</h4>
<p>brianjjones labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>TODO: upload Wasm file here</p>
<h3>Steps to Reproduce</h3>
<p>1.) Build bench-api.<br>
2.) sightglass-cli benchmark ... --engine-flags '--wasi-modules experimental-wasi-nn'</p>
<h3>Expected Results</h3>
<p>Benchmark runs to completion</p>
<h3>Actual Results</h3>
<p>error: Found argument '--wasi-modules experimental-wasi-nn' which wasn't expected, or isn't valid in this context</p>
<h3>Versions and Environment</h3>
<p>wasmtime commit ff0c45b4a069a84b131c8265d8d14c2f7d0566d7</p>
<p>Operating system: ubuntu 20.04</p>
<p>Architecture: x86</p>
<h3>Extra Info</h3>
<p>--engine-flags appears to not be able to accept a string that starts with --, so you are unable to set the flag needed to cause wasi-nn to be linked at runtime. This means wasi-nn can't be used by Sightglass currently.<br>
</p>
</blockquote>



<a name="304137432"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304137432" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304137432">(Oct 15 2022 at 00:20)</a>:</h4>
<p>brianjjones <a href="https://github.com/bytecodealliance/wasmtime/issues/5057#issuecomment-1279608712">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>@abrown This is the issue we discussed today.</p>
</blockquote>



<a name="304141212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304141212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304141212">(Oct 15 2022 at 01:25)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/issues/5057#issuecomment-1279624361">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>It works if you do <code>--engine-flags="--foo"</code> with the <code>=</code> in there. This makes sense to me since the CLI parser otherwise can't determine whether this should be parsed as <code>["--engine-flags", "--foo"]</code> or <code>["--engine-flags=--foo"]</code>.</p>
</blockquote>



<a name="304533097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304533097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304533097">(Oct 17 2022 at 18:45)</a>:</h4>
<p>brianjjones <a href="https://github.com/bytecodealliance/wasmtime/issues/5057#issuecomment-1281320028">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>Ah good to know thanks. It still fails to set wasi-modules.wasi-nn when I use <code>--engine-flags="--wasi-modules=experimental-wasi-nn"</code> .  Which results in <code>target/debug/sightglass-cli benchmark benchmarks/wasi-nn/benchmark.wasm --engine engines/wasmtime/libengine.so --engine-flags=-wasi-modules=experimental-wasi-nn </code></p>
<p>Any ideas on what else could be going wrong?</p>
</blockquote>



<a name="304533378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304533378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304533378">(Oct 17 2022 at 18:46)</a>:</h4>
<p>brianjjones edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/5057#issuecomment-1281320028">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>Ah good to know thanks. It still fails to set wasi-modules.wasi-nn when I use <code>--engine-flags="--wasi-modules=experimental-wasi-nn"</code> .  Which results in <code>target/debug/sightglass-cli benchmark benchmarks/wasi-nn/benchmark.wasm --engine engines/wasmtime/libengine.so --engine-flags=--wasi-modules=experimental-wasi-nn </code></p>
<p>Any ideas on what else could be going wrong?</p>
</blockquote>



<a name="304538851"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304538851" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304538851">(Oct 17 2022 at 19:14)</a>:</h4>
<p>brianjjones edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/5057#issuecomment-1281320028">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>Ah good to know thanks. It still fails to set wasi-modules.wasi-nn when I use <code>--engine-flags="--wasi-modules=experimental-wasi-nn"</code> .  Which results in <code>target/debug/sightglass-cli benchmark benchmarks/wasi-nn/benchmark.wasm --engine engines/wasmtime/libengine.so --engine-flags=--wasi-modules=experimental-wasi-nn </code></p>
<p>Any ideas on what else could be going wrong?</p>
<p>Edit: It appears BenchState::new is being passed None for options. I'm looking into it to see if I can offer a fix.</p>
</blockquote>



<a name="304587422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304587422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304587422">(Oct 18 2022 at 00:37)</a>:</h4>
<p>brianjjones <a href="https://github.com/bytecodealliance/wasmtime/issues/5057#issuecomment-1281665631">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>This appears to be a Sightglass issue, so most likely not a Wasmtime bug. </p>
</blockquote>



<a name="304587423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%235057%20Bench-api%20--engine-flags%20can%27t%20acc.../near/304587423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.235057.20Bench-api.20--engine-flags.20can.27t.20acc.2E.2E.2E.html#304587423">(Oct 18 2022 at 00:37)</a>:</h4>
<p>brianjjones closed <a href="https://github.com/bytecodealliance/wasmtime/issues/5057">issue #5057</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>TODO: upload Wasm file here</p>
<h3>Steps to Reproduce</h3>
<p>1.) Build bench-api.<br>
2.) sightglass-cli benchmark ... --engine-flags '--wasi-modules experimental-wasi-nn'</p>
<h3>Expected Results</h3>
<p>Benchmark runs to completion</p>
<h3>Actual Results</h3>
<p>error: Found argument '--wasi-modules experimental-wasi-nn' which wasn't expected, or isn't valid in this context</p>
<h3>Versions and Environment</h3>
<p>wasmtime commit ff0c45b4a069a84b131c8265d8d14c2f7d0566d7</p>
<p>Operating system: ubuntu 20.04</p>
<p>Architecture: x86</p>
<h3>Extra Info</h3>
<p>--engine-flags appears to not be able to accept a string that starts with --, so you are unable to set the flag needed to cause wasi-nn to be linked at runtime. This means wasi-nn can't be used by Sightglass currently.<br>
</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>