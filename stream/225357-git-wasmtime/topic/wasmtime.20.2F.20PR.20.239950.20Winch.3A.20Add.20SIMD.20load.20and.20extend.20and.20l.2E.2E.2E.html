<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9950 Winch: Add SIMD load and extend and l... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html">wasmtime / PR #9950 Winch: Add SIMD load and extend and l...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="492533845"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492533845" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492533845">(Jan 08 2025 at 15:57)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/abrown">abrown</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492533846"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492533846" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492533846">(Jan 08 2025 at 15:57)</a>:</h4>
<p>jeffcharles opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a> from <code>jeffcharles:winch-add-load-extend-splat-instructions</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
Part of #8093. Adds support on x64 with AVX2 for:</p>
<ul>
<li><code>v128.load8x8_s</code></li>
<li><code>v128.load8x8_u</code></li>
<li><code>v128.load16x4_s</code></li>
<li><code>v128.load16x4_u</code></li>
<li><code>v128.load32x2_s</code></li>
<li><code>v128.load32x2_u</code></li>
<li><code>v128.load8_splat</code></li>
<li><code>v128.load16_splat</code></li>
<li><code>v128.load32_splat</code></li>
<li><code>v128.load64_splat</code></li>
</ul>
<p>I've changed <code>wasm_load</code> on the macroassemblers to take a <code>LoadKind</code> instead of <code>Option&lt;ExtendKind&gt;</code> to model the additional vector operations (vector extends and splats), but I'm open to changing that to a different abstraction.</p>
</blockquote>



<a name="492533848"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492533848" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492533848">(Jan 08 2025 at 15:57)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492533849"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492533849" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492533849">(Jan 08 2025 at 15:57)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492533850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492533850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492533850">(Jan 08 2025 at 15:57)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492537177"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492537177" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492537177">(Jan 08 2025 at 16:14)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#issuecomment-2578070764">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>:</p>
<blockquote>
<p>I can take this review.</p>
</blockquote>



<a name="492537191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492537191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492537191">(Jan 08 2025 at 16:14)</a>:</h4>
<p><strong>saulecabrera</strong> requested <a href="https://github.com/saulecabrera">saulecabrera</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492555719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492555719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492555719">(Jan 08 2025 at 17:44)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#issuecomment-2578260409">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @saulecabrera</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "winch"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>saulecabrera: winch</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="492596386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492596386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492596386">(Jan 08 2025 at 22:51)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492824469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492824469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492824469">(Jan 09 2025 at 21:45)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1908892259">PR review comment</a>:</p>
<blockquote>
<p>Could you return an error here instead of panicking? I've done a refactoring across the compiler to ensure that panics are minimal, particularly for unimplemented/unsupported features. This ensures that we can can successfully run spec tests even when there's partial support for Wasm proposals. </p>
<p>Perhaps we can introduce a new <code>Unimplemeted*</code> enum entry here <a href="https://github.com/bytecodealliance/wasmtime/blob/main/winch/codegen/src/codegen/error.rs#L7">https://github.com/bytecodealliance/wasmtime/blob/main/winch/codegen/src/codegen/error.rs#L7</a>, something around the lines of <code>UnimplementedLoadKind</code></p>
</blockquote>



<a name="492824470"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492824470" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492824470">(Jan 09 2025 at 21:45)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2540055334">PR review</a>:</p>
<blockquote>
<p>Looking good! Left some comments inline. </p>
</blockquote>



<a name="492824471"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492824471" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492824471">(Jan 09 2025 at 21:45)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1909467285">PR review comment</a>:</p>
<blockquote>
<p>Nit: can we remove this enum entry and keep <code>Option&lt;LoadKind&gt;</code> instead? Or where you envisioning this approach to be easier to consume in the callee as opposed to using an <code>Option</code>? </p>
</blockquote>



<a name="492824472"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492824472" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492824472">(Jan 09 2025 at 21:45)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1909456778">PR review comment</a>:</p>
<blockquote>
<p>Given that we're starting with avx2 as our baseline, I wonder if we should emit the <code>vpmov*</code> variants here. </p>
</blockquote>



<a name="492968496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492968496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492968496">(Jan 10 2025 at 15:04)</a>:</h4>
<p>jeffcharles submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2542665736">PR review</a>.</p>



<a name="492968501"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492968501" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492968501">(Jan 10 2025 at 15:04)</a>:</h4>
<p>jeffcharles created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1910499410">PR review comment</a>:</p>
<blockquote>
<p>We could. I figured if they are equivalent instructions that are supported on older chipsets, we could emit those so there would be less work to support non-AVX CPUs in the future given we only need to support 128-bit vectors. One thing I'm not clear on is if <code>Vpmov*</code> instructions are faster or not. If they are faster, then it would probably make sense to emit those instead.</p>
</blockquote>



<a name="492969655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492969655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492969655">(Jan 10 2025 at 15:10)</a>:</h4>
<p>jeffcharles submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2542680379">PR review</a>.</p>



<a name="492969657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492969657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492969657">(Jan 10 2025 at 15:10)</a>:</h4>
<p>jeffcharles created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1910508264">PR review comment</a>:</p>
<blockquote>
<p>It's a little easier on the callee side IMO since we can avoid nesting a match inside another match or an if-let. It's possible that <code>None</code> is not the appropriate name for this variant and something like <code>Plain</code> or <code>Simple</code> might be more appropriate.</p>
</blockquote>



<a name="492970948"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492970948" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492970948">(Jan 10 2025 at 15:17)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2542695133">PR review</a>.</p>



<a name="492970949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492970949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492970949">(Jan 10 2025 at 15:17)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1910517396">PR review comment</a>:</p>
<blockquote>
<p>My expectation is that they are probably more performant, but I haven't performed any meaningful benchmarks. Aside from the potential performance benefit, my comment here is for consistency mostly: given that we aren't planning on doing any checks/emission for anything other than avx2 for SIMD at least initially, I'd prefer if we could default to emitting avx2 only to start. My expectation is that when thinking about fallbacks for anything &lt; avx2, it will require substantial work regardless given that we'd probably want to find a way to share that implementation with what already exists in Cranelift.</p>
</blockquote>



<a name="492971553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492971553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492971553">(Jan 10 2025 at 15:20)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2542702366">PR review</a>.</p>



<a name="492971555"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492971555" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492971555">(Jan 10 2025 at 15:20)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1910521641">PR review comment</a>:</p>
<blockquote>
<p>It's been a bit since I last checked, and I also haven't benchmarked, but IIRC the Intel optimization guide recommended either using exclusively VEX instructions (ones with the <code>v*</code> prefix) or exclusively non-VEX instructions. It's got something subtle to do with CPU state and such. It generally has to do with the fact that VEX instructions mutate the entire register contents as opposed to SSE which only mutate the lower 128-bits. This means that SSE instructions can accidentally create false dependencies between instructions.</p>
<p>The rule of thumb I used in Cranelift at least was to try to unconditionally prefer <code>v*</code> VEX instructions when AVX is enabled as I think that's what Intel assumes compilers are doing to make things faster</p>
</blockquote>



<a name="492972320"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492972320" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492972320">(Jan 10 2025 at 15:24)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2542711182">PR review</a>.</p>



<a name="492972323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492972323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492972323">(Jan 10 2025 at 15:24)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1910526692">PR review comment</a>:</p>
<blockquote>
<p>I don't want to bikeshed too much here, I think the comment is clear enough, so I'm good if you'd like to leave it this way. </p>
</blockquote>



<a name="492973515"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492973515" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492973515">(Jan 10 2025 at 15:30)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492983097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492983097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492983097">(Jan 10 2025 at 16:22)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="492986419"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/492986419" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#492986419">(Jan 10 2025 at 16:41)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2542941427">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="493025696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493025696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493025696">(Jan 10 2025 at 21:07)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493031213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493031213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493031213">(Jan 10 2025 at 21:54)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493031884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493031884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493031884">(Jan 10 2025 at 21:59)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493041393"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493041393" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493041393">(Jan 10 2025 at 23:35)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493353139"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493353139" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493353139">(Jan 13 2025 at 13:36)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#pullrequestreview-2546629125">PR review</a>.</p>



<a name="493353142"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493353142" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493353142">(Jan 13 2025 at 13:36)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/9950#discussion_r1913203663">PR review comment</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="suggestion"><pre><span></span><code>                let unsupported = ["spec_testsuite/simd_align.wast"];
</code></pre></div>
<p>This is why the PR is still failing in CI. I tested the change in my arm64 machine FWIW. </p>
</blockquote>



<a name="493373365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493373365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493373365">(Jan 13 2025 at 15:01)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493375817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493375817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493375817">(Jan 13 2025 at 15:11)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493381081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493381081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493381081">(Jan 13 2025 at 15:34)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/saulecabrera">saulecabrera</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<a name="493385472"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239950%20Winch%3A%20Add%20SIMD%20load%20and%20extend%20and%20l.../near/493385472" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239950.20Winch.3A.20Add.20SIMD.20load.20and.20extend.20and.20l.2E.2E.2E.html#493385472">(Jan 13 2025 at 15:53)</a>:</h4>
<p>saulecabrera merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9950">PR #9950</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>