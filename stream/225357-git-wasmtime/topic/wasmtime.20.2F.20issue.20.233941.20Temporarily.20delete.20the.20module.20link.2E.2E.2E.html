<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3941 Temporarily delete the module link... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html">wasmtime / issue #3941 Temporarily delete the module link...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="275705512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/275705512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#275705512">(Mar 17 2022 at 18:25)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>This was discussed in today's Wasmtime meeting but I wanted to open an issue here to get feedback on this as well. In the near future I hope to start implementing the component model inside of Wasmtime which will be a significant step up from the existing module linking implementation that we have today. Previously when implementing the component model in the wasm-tools repository we decided that this development work would happen on a <code>component-model</code> branch and eventually we'd merge that back into <code>main</code>. The main reason for doing this was to ensure that the module linking implementation in Wasmtime could continue to live on.</p>
<p>This immediately creates an issue for Wasmtime, however, in landing the component model implementation. Primarily there are no crates.io-crates to use in Wasmtime for the wasm-tools crates to work with the component model. Additionally Wasmtime as a project seems much more likely to have "big changes" in the time it takes to implement the component model which can make merging a <code>component-model</code> branch back into <code>main</code> extra-hard.</p>
<p>For these reasons my proposal in today's meeting was that we merge the <code>component-model</code> branch of wasm-tools into the <code>main</code> branch. In doing so we would then "schedule" the deletion of the module linking implementation in Wasmtime for the next update of the <code>wasm-tools</code> crates. This would then over time be replaced with an implementation of the component model as I fill it out.</p>
<p>I'd like to get others' feedback on this because it would entail deleting an active, but unstable, feature of Wasmtime -- the module linking proposal. In doing some planning of the component model I don't think much of the existing module linking implementation is likely to be used line-for-line as-is right now. Most of the parsing/validation/types/etc are significantly different and some design decisions that affected the module linking implementation are not present with the component model (such as core wasm modules are only at leaf nodes, not any node). </p>
<p>This means the two primary users of the module linking proposal at this time, wizer and the spidermonkey integration in wit-bindgen, would need to be disabled temporarily while the component model is implemented.</p>
<p>cc @peterhuene and @tschneidereit I'm particularly interested in y'all's thoughts on this.</p>
</blockquote>



<a name="275705526"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/275705526" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#275705526">(Mar 17 2022 at 18:25)</a>:</h4>
<p>alexcrichton labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>This was discussed in today's Wasmtime meeting but I wanted to open an issue here to get feedback on this as well. In the near future I hope to start implementing the component model inside of Wasmtime which will be a significant step up from the existing module linking implementation that we have today. Previously when implementing the component model in the wasm-tools repository we decided that this development work would happen on a <code>component-model</code> branch and eventually we'd merge that back into <code>main</code>. The main reason for doing this was to ensure that the module linking implementation in Wasmtime could continue to live on.</p>
<p>This immediately creates an issue for Wasmtime, however, in landing the component model implementation. Primarily there are no crates.io-crates to use in Wasmtime for the wasm-tools crates to work with the component model. Additionally Wasmtime as a project seems much more likely to have "big changes" in the time it takes to implement the component model which can make merging a <code>component-model</code> branch back into <code>main</code> extra-hard.</p>
<p>For these reasons my proposal in today's meeting was that we merge the <code>component-model</code> branch of wasm-tools into the <code>main</code> branch. In doing so we would then "schedule" the deletion of the module linking implementation in Wasmtime for the next update of the <code>wasm-tools</code> crates. This would then over time be replaced with an implementation of the component model as I fill it out.</p>
<p>I'd like to get others' feedback on this because it would entail deleting an active, but unstable, feature of Wasmtime -- the module linking proposal. In doing some planning of the component model I don't think much of the existing module linking implementation is likely to be used line-for-line as-is right now. Most of the parsing/validation/types/etc are significantly different and some design decisions that affected the module linking implementation are not present with the component model (such as core wasm modules are only at leaf nodes, not any node). </p>
<p>This means the two primary users of the module linking proposal at this time, wizer and the spidermonkey integration in wit-bindgen, would need to be disabled temporarily while the component model is implemented.</p>
<p>cc @peterhuene and @tschneidereit I'm particularly interested in y'all's thoughts on this.</p>
</blockquote>



<a name="275711341"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/275711341" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#275711341">(Mar 17 2022 at 19:10)</a>:</h4>
<p>peterhuene <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1071234643">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>Would the merge of <code>component-model</code> into <code>main</code> be gated on the inclusion of updates to <code>wast</code> and <code>wasm-smith</code> so that we can have better confidence in the tools' implementations via tests and fuzzing?</p>
<p>So I'm on the same page, when you say "disabled" with regards to wizer, does that mean just deleting the existing module linking implementation in that tool? There are obviously important dependencies on wizer that aren't using module linking, so I want to ensure we don't break those users.</p>
<p>I'm less concerned about wit-bindgen-spidermonkey since it's not on any critical paths (yet) and the work to update it isn't predicated on the implementation in wasmtime as it should have what it needs today to start encoding components, although it'd likely benefit from work I'm doing right now on <code>wit-component</code> to encode wit interface definitions.</p>
<p>Regarding <code>wasmlink</code>, which also has dependency on the module linking proposal, I think that we should fully deprecate and/or remove that tool as it's entirely unnecessary now. It's great for demos, but linking two core modules together and generating adapter functions in wasm isn't needed as the component model implementation moves forward.</p>
</blockquote>



<a name="275711450"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/275711450" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#275711450">(Mar 17 2022 at 19:11)</a>:</h4>
<p>peterhuene edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1071234643">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>Would the merge of <code>component-model</code> into <code>main</code> be gated on the inclusion of updates to <code>wast</code> and <code>wasm-smith</code> so that we can have better confidence in the tools' implementations via tests and fuzzing?</p>
<p>So I'm on the same page, when you say "disabled" with regards to wizer, does that mean just deleting the existing module linking implementation in that tool? There are obviously important dependencies on wizer that aren't using module linking, so I want to ensure we don't break those users.</p>
<p>I'm less concerned about wit-bindgen-spidermonkey since it's not on any critical paths (yet) and the work to update it isn't predicated on the implementation in wasmtime as it should have what it needs today to start encoding components, although it'd likely benefit from work I'm doing right now on <code>wit-component</code> to encode wit interface definitions and create components from core modules.</p>
<p>Regarding <code>wasmlink</code>, which also has dependency on the module linking proposal, I think that we should fully deprecate and/or remove that tool as it's entirely unnecessary now. It's great for demos, but linking two core modules together and generating adapter functions in wasm isn't needed as the component model implementation moves forward.</p>
</blockquote>



<a name="275737543"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/275737543" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#275737543">(Mar 17 2022 at 22:39)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1071699287">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>I think we'd need wast/wasm-smith/etc to call the feature complete, but I'm don't think we'd gate the merge to <code>main</code> on them. Basically I think we should consider all module-linking-using things as "dead code walking" which will be deleted as soon as its convenient and otherwise the component model is a work-in-progress proposal which has varying degrees of support in our tooling until everything is finished (which will take some time). That being said though writing tests is gonna be hard without <code>wast</code>.</p>
<p>For disabling I mostly just mean either disabling the tests or otherwise deleting the relevant code. Where it makes sense I think the code can be kept to be transformed to work with the component model but otherwise if the code isn't too applicable to the component model I think it's fine to delete (which is where I believe Wasmtime itself sits)</p>
<p>Also sorry I forgot about <code>wasmlink</code>! I agree on the conclusions though.</p>
</blockquote>



<a name="276391107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/276391107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#276391107">(Mar 23 2022 at 19:57)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>This was discussed in today's Wasmtime meeting but I wanted to open an issue here to get feedback on this as well. In the near future I hope to start implementing the component model inside of Wasmtime which will be a significant step up from the existing module linking implementation that we have today. Previously when implementing the component model in the wasm-tools repository we decided that this development work would happen on a <code>component-model</code> branch and eventually we'd merge that back into <code>main</code>. The main reason for doing this was to ensure that the module linking implementation in Wasmtime could continue to live on.</p>
<p>This immediately creates an issue for Wasmtime, however, in landing the component model implementation. Primarily there are no crates.io-crates to use in Wasmtime for the wasm-tools crates to work with the component model. Additionally Wasmtime as a project seems much more likely to have "big changes" in the time it takes to implement the component model which can make merging a <code>component-model</code> branch back into <code>main</code> extra-hard.</p>
<p>For these reasons my proposal in today's meeting was that we merge the <code>component-model</code> branch of wasm-tools into the <code>main</code> branch. In doing so we would then "schedule" the deletion of the module linking implementation in Wasmtime for the next update of the <code>wasm-tools</code> crates. This would then over time be replaced with an implementation of the component model as I fill it out.</p>
<p>I'd like to get others' feedback on this because it would entail deleting an active, but unstable, feature of Wasmtime -- the module linking proposal. In doing some planning of the component model I don't think much of the existing module linking implementation is likely to be used line-for-line as-is right now. Most of the parsing/validation/types/etc are significantly different and some design decisions that affected the module linking implementation are not present with the component model (such as core wasm modules are only at leaf nodes, not any node). </p>
<p>This means the two primary users of the module linking proposal at this time, wizer and the spidermonkey integration in wit-bindgen, would need to be disabled temporarily while the component model is implemented.</p>
<p>cc @peterhuene and @tschneidereit I'm particularly interested in y'all's thoughts on this.</p>
</blockquote>



<a name="276919879"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/276919879" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#276919879">(Mar 28 2022 at 19:24)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1081049491">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>I have a question regarding this change: is it safe to assume that moving forward, while the component model changes land, any security/critical fixes will be ported to the last version of wasmtime supporting module linking? For context, at Shopify we have a couple of production use-cases using module linking in its current state and we were wondering about this. I hoping to get some light on this question to determine what are our options here; given the complexity of the changes related to the component model, my assumptions are that these changes might take a while to land but also that other important fixes might land too in the meantime. Any insight on this is appreciated!</p>
</blockquote>



<a name="276935846"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/276935846" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#276935846">(Mar 28 2022 at 21:51)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1081188329">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>With our current <a href="https://docs.wasmtime.dev/stability-release.html">release process</a> since module linking was never on-by-default we actually wouldn't have prior made backports for security fixes, they'd just have gone in as usual and get released with the next major version. In that sense we don't currently have plans to backport any module linking fixes.</p>
<p>That being said the decision to remove module linking was largely under the pretext that we didn't know of any active users and it wouldn't be too much of a burden for smaller uses like wit-bindgen and wizer to pause testing of module linking temporarily. You're right that it will take some time to implement the component model to get it to the same level of fidelity of support that module linking had.</p>
<p>If y'all are using module linking internally though and find it difficult to move away would you be up for attending a Wasmtime meeting to discuss your use case? If not a one-off call would also be fine. It's definitely not intended that this would cause too much churn!</p>
</blockquote>



<a name="276939454"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/276939454" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#276939454">(Mar 28 2022 at 22:40)</a>:</h4>
<p>saulecabrera edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1081049491">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>I have a question regarding this change: is it safe to assume that moving forward, while the component model changes land, any security/critical fixes will be ported to the last version of wasmtime supporting module linking? For context, at Shopify we have a couple of production use-cases using module linking in its current state and we were wondering about this. I'm hoping to get some light on this question to determine what are our options here; given the complexity of the changes related to the component model, my assumptions are that these changes might take a while to land but also that other important fixes might land too in the meantime. Any insight on this is appreciated!</p>
</blockquote>



<a name="276942945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233941%20Temporarily%20delete%20the%20module%20link.../near/276942945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233941.20Temporarily.20delete.20the.20module.20link.2E.2E.2E.html#276942945">(Mar 28 2022 at 23:33)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/issues/3941#issuecomment-1081252452">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3941">issue #3941</a>:</p>
<blockquote>
<p>@alexcrichton thanks for all the details!</p>
<blockquote>
<p>If y'all are using module linking internally though and find it difficult to move away would you be up for attending a Wasmtime meeting to discuss your use case? If not a one-off call would also be fine.</p>
</blockquote>
<p>I'm definitely interested in joining the meetings, unfortunately I have a small conflict this week, so a one-off call works best this week.<br>
</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>