<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5140 [wip] Cleanup wasmi fuzzing code · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html">wasmtime / PR #5140 [wip] Cleanup wasmi fuzzing code</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="306443858"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306443858" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306443858">(Oct 27 2022 at 13:03)</a>:</h4>
<p>Robbepop opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5140">PR #5140</a> from <code>rf-cleanup-wasmi-fuzzer</code> to <code>main</code>:</p>
<blockquote>
<p>Just some minor clean ups to the <code>wasmi</code> fuzzer code.<br>
Unfortunately due to compilation/linkage problems with the OCaml based spec interpreter I could not run the fuzz tests locally so there might be bugs that I have to fix ... :/</p>
<p>Can we run fuzz tests via CI?</p>
</blockquote>



<a name="306463445"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306463445" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306463445">(Oct 27 2022 at 14:37)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5140">PR #5140</a> from <code>rf-cleanup-wasmi-fuzzer</code> to <code>main</code>.</p>



<a name="306464419"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306464419" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306464419">(Oct 27 2022 at 14:42)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#pullrequestreview-1158423992">PR review</a>.</p>



<a name="306464421"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306464421" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306464421">(Oct 27 2022 at 14:42)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#discussion_r1006971503">PR review comment</a>:</p>
<blockquote>
<p>Could the <code>.unwrap()</code> be retained here and on <code>memory</code>? If the export isn't present or is of a different type that's a bug in the fuzz harness which we need to fix and the <code>.unwrap()</code> helps uncoveri t.</p>
</blockquote>



<a name="306464609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306464609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306464609">(Oct 27 2022 at 14:43)</a>:</h4>
<p>Robbepop submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#pullrequestreview-1158425790">PR review</a>.</p>



<a name="306464610"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306464610" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306464610">(Oct 27 2022 at 14:43)</a>:</h4>
<p>Robbepop created <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#discussion_r1006972768">PR review comment</a>:</p>
<blockquote>
<p>yeah I just noticed that this <code>unwrap</code> might have been intentional for exactly that purpose. I will try to fix it.</p>
</blockquote>



<a name="306465216"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306465216" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306465216">(Oct 27 2022 at 14:45)</a>:</h4>
<p>Robbepop created <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#discussion_r1006976083">PR review comment</a>:</p>
<blockquote>
<p>under what circumstances is <code>get_global</code> supposed to return <code>Some</code> value?</p>
</blockquote>



<a name="306465217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306465217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306465217">(Oct 27 2022 at 14:45)</a>:</h4>
<p>Robbepop submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#pullrequestreview-1158430793">PR review</a>.</p>



<a name="306465292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306465292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306465292">(Oct 27 2022 at 14:46)</a>:</h4>
<p>Robbepop edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#discussion_r1006976083">PR review comment</a>.</p>



<a name="306466298"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306466298" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306466298">(Oct 27 2022 at 14:50)</a>:</h4>
<p>Robbepop submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#pullrequestreview-1158440035">PR review</a>.</p>



<a name="306466299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306466299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306466299">(Oct 27 2022 at 14:50)</a>:</h4>
<p>Robbepop created <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#discussion_r1006982391">PR review comment</a>:</p>
<blockquote>
<p>Something like</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="bp">self</span><span class="p">.</span><span class="n">instance</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">get_export</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">store</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">and_then</span><span class="p">(</span><span class="n">wasmi</span>::<span class="n">Extern</span>::<span class="n">into_global</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">global</span><span class="o">|</span><span class="w"> </span><span class="n">global</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">store</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">DiffValue</span>::<span class="n">from</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">unwrap</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">into</span><span class="p">()</span><span class="w"></span>
<span class="err">```</span><span class="w"></span>
<span class="n">Or</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">back</span><span class="o">?</span><span class="w"></span>
<span class="o">~~~</span><span class="w"></span>
</code></pre></div><br>
</p>
</blockquote>



<a name="306466825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306466825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306466825">(Oct 27 2022 at 14:52)</a>:</h4>
<p>Robbepop updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5140">PR #5140</a> from <code>rf-cleanup-wasmi-fuzzer</code> to <code>main</code>.</p>



<a name="306469103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306469103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306469103">(Oct 27 2022 at 15:02)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#pullrequestreview-1158467632">PR review</a>.</p>



<a name="306469104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306469104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306469104">(Oct 27 2022 at 15:02)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5140#discussion_r1006999638">PR review comment</a>:</p>
<blockquote>
<p>This is intended for JS where JS can't get the value of an exported <code>v128</code> global, for example. So only for situations where the engine for some reason is unable to retrieve the value. For <code>wasmi</code> though it should be able to retrieve the value in all situations.</p>
</blockquote>



<a name="306474975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235140%20%5Bwip%5D%20Cleanup%20wasmi%20fuzzing%20code/near/306474975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235140.20.5Bwip.5D.20Cleanup.20wasmi.20fuzzing.20code.html#306474975">(Oct 27 2022 at 15:28)</a>:</h4>
<p><strong>Robbepop</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/5140">PR #5140</a> as ready for review.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>