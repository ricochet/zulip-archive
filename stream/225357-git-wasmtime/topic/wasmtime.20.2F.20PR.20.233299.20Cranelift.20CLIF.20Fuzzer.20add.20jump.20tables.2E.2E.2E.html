<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3299 Cranelift CLIF Fuzzer add jump tables... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html">wasmtime / PR #3299 Cranelift CLIF Fuzzer add jump tables...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="251925190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251925190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251925190">(Sep 03 2021 at 18:43)</a>:</h4>
<p>afonso360 opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3299">PR #3299</a> from <code>fuzzer-brtable</code> to <code>main</code>:</p>
<blockquote>
<p>Hey!</p>
<p>A small addition #3094. This is the last planned branch instruction for the CLIF fuzzer (since <a href="https://github.com/bytecodealliance/wasmtime/issues/3249">it looks like <code>brif</code>/<code>brff</code> are going to be removed</a>), and means that we have completed the branch / jump part of the fuzzer <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> </p>
<p>This change independently found #3100 which was fixed in #3282.</p>
</blockquote>



<a name="251925995"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251925995" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251925995">(Sep 03 2021 at 18:49)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3299">PR #3299</a> from <code>fuzzer-brtable</code> to <code>main</code>:</p>
<blockquote>
<p>Hey!</p>
<p>A small addition to #3094. This is the last planned branch instruction for the CLIF fuzzer (since <a href="https://github.com/bytecodealliance/wasmtime/issues/3249">it looks like <code>brif</code>/<code>brff</code> are going to be removed</a>), and means that we have completed the branch / jump part of the fuzzer <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> </p>
<p>This change independently found #3100 which was fixed in #3282.</p>
</blockquote>



<a name="251928133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251928133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251928133">(Sep 03 2021 at 19:06)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#pullrequestreview-746401717">PR review</a>.</p>



<a name="251928134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251928134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251928134">(Sep 03 2021 at 19:06)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#pullrequestreview-746401717">PR review</a>.</p>



<a name="251928135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251928135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251928135">(Sep 03 2021 at 19:06)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#discussion_r702109640">PR review comment</a>:</p>
<blockquote>
<p>The "empty blockparams" condition is of course necessary, but how do we guard against cases where no blocks fit this requirement, and we end up doing a <code>choose()</code> on an empty list (which will panic)? Possibly I'm just missing this invariant elsewhere -- if so, could you add a comment describing why it'll always succeed, and maybe an <code>assert!(target_blocks.len() &gt; 0)</code> or somesuch?</p>
</blockquote>



<a name="251929423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929423">(Sep 03 2021 at 19:17)</a>:</h4>
<p>afonso360 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#discussion_r702115352">PR review comment</a>:</p>
<blockquote>
<p>This already happens all the time. i.e. we are never guaranteed to generate variables of any type, so any instruction that requests a value of a type that doesn't exist ends up doing a choose on an empty block.</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/3db8043a0284dd40e2859f8df3e05e730a706624/cranelift/fuzzgen/src/function_generator.rs#L194-L198">https://github.com/bytecodealliance/wasmtime/blob/3db8043a0284dd40e2859f8df3e05e730a706624/cranelift/fuzzgen/src/function_generator.rs#L194-L198</a></p>
<p>What ends up happening here, is that choose returns an error, we bubble the error up and into cargo-fuzz, which marks this input as invalid and starts another round of fuzzing.<br>
</p>
</blockquote>



<a name="251929424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929424">(Sep 03 2021 at 19:17)</a>:</h4>
<p>afonso360 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#pullrequestreview-746409150">PR review</a>.</p>



<a name="251929626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929626">(Sep 03 2021 at 19:19)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#discussion_r702115352">PR review comment</a>.</p>



<a name="251929798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929798">(Sep 03 2021 at 19:21)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#pullrequestreview-746411110">PR review</a>.</p>



<a name="251929800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929800">(Sep 03 2021 at 19:21)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#discussion_r702116920">PR review comment</a>:</p>
<blockquote>
<p>Ah, great, the key bit is that the failure bubbles up; I couldn't recall if <code>choose()</code> just panics in this case instead. All good then -- I'll go ahead and merge, thanks!</p>
</blockquote>



<a name="251929801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929801">(Sep 03 2021 at 19:21)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#discussion_r702115352">PR review comment</a>.</p>



<a name="251929838"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251929838" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251929838">(Sep 03 2021 at 19:21)</a>:</h4>
<p>afonso360 edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3299#discussion_r702115352">PR review comment</a>.</p>



<a name="251932497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233299%20Cranelift%20CLIF%20Fuzzer%20add%20jump%20tables.../near/251932497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233299.20Cranelift.20CLIF.20Fuzzer.20add.20jump.20tables.2E.2E.2E.html#251932497">(Sep 03 2021 at 19:43)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3299">PR #3299</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>