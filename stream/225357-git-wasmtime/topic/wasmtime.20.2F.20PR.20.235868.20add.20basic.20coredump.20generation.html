<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5868 add basic coredump generation · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html">wasmtime / PR #5868 add basic coredump generation</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="329797256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329797256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329797256">(Feb 23 2023 at 19:02)</a>:</h4>
<p>xtuc opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>:</p>
<blockquote>
<p>This change adds a basic coredump generation after a WebAssembly trap was entered. The coredump includes rudimentary stack / process debugging information.</p>
<p>A new CLI argument is added to enable coredump generation:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">coredump</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">trap</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">coredump</span><span class="o">/</span><span class="n">directory</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">wasm</span>
</code></pre></div>
<p>See ./docs/examples-coredump.md for a working example.</p>
<p>Refs <a href="https://github.com/bytecodealliance/wasmtime/issues/5732">https://github.com/bytecodealliance/wasmtime/issues/5732</a></p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="329798733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329798733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329798733">(Feb 23 2023 at 19:10)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1311977364">PR review</a>.</p>



<a name="329798735"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329798735" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329798735">(Feb 23 2023 at 19:10)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116135812">PR review comment</a>:</p>
<blockquote>
<p>For context, unix kernels allows to template the coredump path (<a href="https://sigquit.wordpress.com/2009/03/13/the-core-pattern/">https://sigquit.wordpress.com/2009/03/13/the-core-pattern/</a>) using variables starting with %. We might want to support them in the future.</p>
</blockquote>



<a name="329798762"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329798762" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329798762">(Feb 23 2023 at 19:10)</a>:</h4>
<p>xtuc edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116135812">PR review comment</a>.</p>



<a name="329806277"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806277" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806277">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312025406">PR review</a>.</p>



<a name="329806278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806278">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312025406">PR review</a>.</p>



<a name="329806279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806279">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116169016">PR review comment</a>:</p>
<blockquote>
<p>This is also visible on CI, but we're stricter-than-average about the dependencies we pull in for Wasmtime. Relying on something external here is fine but this specifically pulls in a number of things which I think we'll want to change/address:</p>
<ul>
<li><code>colored</code> - in theory this shouldn't be necessary for just building core dumps</li>
<li><code>core-wasm-ast</code> - this looks like it may be duplicating the functionality of the already-in-use <code>wasmparser</code> crate perhaps? If that's the case we'd prefer to only have one definition of parsing wasm within wasmtime. </li>
<li><code>hermit-abi</code> - I think this is due to the <code>num_cpus</code> update, but is the update required?</li>
<li><code>threadpool</code> - I think in theory this shouldn't be necessary for a core dump builder</li>
<li><code>wasm-printer</code> - does this perhaps duplicate the functionality already present in <code>wasmprinter</code>? If so like <code>wasmparser</code> it would be best to only have one implementation of this rather than multiple.</li>
</ul>
<p>I'll also note that we're also already using the <code>wasm-encoder</code> crate for creating core wasm modules, so if core dump functionality could be added to that or somehow leverage that I think that would be ideal.</p>
</blockquote>



<a name="329806280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806280">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116169394">PR review comment</a>:</p>
<blockquote>
<p>You can shorten this a bit with just <code>bail!("...")</code> if you'd like</p>
</blockquote>



<a name="329806281"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806281" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806281">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116171690">PR review comment</a>:</p>
<blockquote>
<p>Handling errors here is a bit interesting because while these operations are fallible I don't think that the error here wants to necessarily "overwrite" the trap error. I also don't know of a great way to "fuse" errors either. Perhaps for tnow this could log a warning message or similar?</p>
</blockquote>



<a name="329806282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806282">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116169969">PR review comment</a>:</p>
<blockquote>
<p>This'll want to be a fallible conversion, only emitting a backtrace in the core dump if <code>WasmBacktrace</code> is available I think. (as opposed to returning a different kind of error if the backtrace is missing)</p>
</blockquote>



<a name="329806283"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806283" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806283">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116172287">PR review comment</a>:</p>
<blockquote>
<p>The backtrace frames here should also have offset information to get to the precise opcode if you'd like to add that.</p>
</blockquote>



<a name="329806284"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329806284" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329806284">(Feb 23 2023 at 19:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116170316">PR review comment</a>:</p>
<blockquote>
<p>I think this logic below may want to be conditional on a <code>err.is::&lt;wasmtime::Trap&gt;()</code> condition since there's a number of other unrelated things that could go wrong during execution.</p>
</blockquote>



<a name="329811997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329811997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329811997">(Feb 23 2023 at 20:25)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312091132">PR review</a>.</p>



<a name="329811998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329811998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329811998">(Feb 23 2023 at 20:25)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116213331">PR review comment</a>:</p>
<blockquote>
<p><code>colored</code>, <code>threadpool</code> and <code>num_cpus</code>  are dependencies not directly used by <code>wasm-coredump-builder</code>, I'll make sure to remove them.</p>
<p><code>core-wasm-ast</code> (in theory, just defines the stucts to represent coredump) and <code>wasm-printer</code> (maybe a bad name, it's used to serialize the coredump to binary Wasm) are required by <code>wasm-coredump-builder</code>. </p>
<blockquote>
<p>I'll also note that we're also already using the wasm-encoder crate for creating core wasm modules, so if core dump functionality could be added to that or somehow leverage that I think that would be ideal.</p>
</blockquote>
<p>That's indeed duplicated features with my crates. I believe I can rewrite <code>wasm-coredump-builder</code> to only use <code>wasm-encoder</code>. A disadvantage of that approach on my side is that it won't integrate well with my tools / crates, but could be specific to wasmtime. </p>
</blockquote>



<a name="329812549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329812549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329812549">(Feb 23 2023 at 20:29)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312095332">PR review</a>.</p>



<a name="329812550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329812550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329812550">(Feb 23 2023 at 20:29)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116216384">PR review comment</a>:</p>
<blockquote>
<p>Good point. Same with the errors bellow, I'll change the code to allow coredump generation to fail gracefully.</p>
</blockquote>



<a name="329812875"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329812875" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329812875">(Feb 23 2023 at 20:30)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312097597">PR review</a>.</p>



<a name="329812876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329812876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329812876">(Feb 23 2023 at 20:30)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116217982">PR review comment</a>:</p>
<blockquote>
<p>Yeah, we'll probably want that in the future. I haven't changed (or decided) the coredump format to allow <code>funcidx</code> in addition to <code>codeoffset</code> yet.</p>
</blockquote>



<a name="329813315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329813315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329813315">(Feb 23 2023 at 20:33)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312100618">PR review</a>.</p>



<a name="329813316"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/329813316" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#329813316">(Feb 23 2023 at 20:33)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116220075">PR review comment</a>:</p>
<blockquote>
<p>With the libararified / modular CLI approach, dependecies wouldn't matter as much right?</p>
</blockquote>



<a name="331123292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/331123292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#331123292">(Feb 23 2023 at 21:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312144148">PR review</a>.</p>



<a name="331123296"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/331123296" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#331123296">(Feb 23 2023 at 21:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116247420">PR review comment</a>:</p>
<blockquote>
<p>To clarify I don't mean to pass judgement on which one should be used per se, but within the context of Wasmtime's dependency graph we'd prefer to keep only one implementation of things rather than bringing together various islands of ecosystems. I don't mean to say that you should rewrite crates on top of the crates in the <code>wasm-tools</code> repository (although feedback on those is always appreciated), but I believe that <code>wasm-encoder</code> is high-level enough and the core dump format is simple enough that doing it "inline" as opposed to using an external crate wouldn't be the end of the world (not that using an external crate is wrong, again just trying to keep the dependencies in Wasmtime under control)</p>
</blockquote>



<a name="335044380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/335044380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#335044380">(Feb 23 2023 at 21:50)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312194005">PR review</a>.</p>



<a name="335044382"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/335044382" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#335044382">(Feb 23 2023 at 21:50)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116281969">PR review comment</a>:</p>
<blockquote>
<p>yeah I understand, I wasn't trying to argue against. I'm planning to rewrite <code>wasm-coredump-builder</code> to depend only on a new coredump specific encoding crate + <code>wasm-encoder</code>. That should address the concern.</p>
</blockquote>



<a name="336357767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336357767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336357767">(Feb 23 2023 at 22:49)</a>:</h4>
<p>xtuc updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>.</p>



<a name="336358284"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336358284" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336358284">(Feb 23 2023 at 22:53)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1312262796">PR review</a>.</p>



<a name="336358285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336358285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336358285">(Feb 23 2023 at 22:53)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1116331240">PR review comment</a>:</p>
<blockquote>
<p>I published a new version of <code>wasm-coredump-builder</code> that depends on <code>wasm-encoder</code> and two coredump specific crates:</p>
<ul>
<li><a href="https://github.com/xtuc/wasm-coredump/tree/main/lib/coredump-encoder">https://github.com/xtuc/wasm-coredump/tree/main/lib/coredump-encoder</a></li>
<li><a href="https://github.com/xtuc/wasm-coredump/tree/main/lib/coredump-types">https://github.com/xtuc/wasm-coredump/tree/main/lib/coredump-types</a></li>
</ul>
<p>I'm not sure why <code>num_cpus</code> has been updated. Is it still related to my change?</p>
</blockquote>



<a name="336525474"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336525474" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336525474">(Feb 24 2023 at 16:19)</a>:</h4>
<p>xtuc updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>.</p>



<a name="336526219"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336526219" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336526219">(Feb 24 2023 at 16:22)</a>:</h4>
<p><strong>xtuc</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a>.</p>



<a name="336537356"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537356" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537356">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1313907463">PR review</a>.</p>



<a name="336537357"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537357" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537357">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1313907463">PR review</a>.</p>



<a name="336537358"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537358" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537358">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117311319">PR review comment</a>:</p>
<blockquote>
<p>I think this <code>err</code> is the wrong one being returned here (but I think it's just a small mistake due to name shadowing)</p>
</blockquote>



<a name="336537359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537359">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117324983">PR review comment</a>:</p>
<blockquote>
<p>For now we're enforcing that the edits to the <code>supply-chain/*</code> folder are only done by "trusted reviewers" of the project since this affects our supply-chain security (and others who import these audits). To that end thanks for adding these here, but our current process (which isn't well documented) is that if a contributor needs new vet entries we <a href="https://github.com/bytecodealliance/wasmtime/pull/5878">post a separate PR</a> which the contributor's PR is then rebased on top of.</p>
<p>Once that PR lands, though, you should be able to rebase this PR on top of that one and back out the changes to the <code>supply-chain/*</code> directory. </p>
</blockquote>



<a name="336537364"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537364" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537364">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117328484">PR review comment</a>:</p>
<blockquote>
<p>Since this will be a user-facing error message I think it might be better to reword this as "no wasm backtrace found to generate core dump with" or something along those lines.</p>
</blockquote>



<a name="336537365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537365">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117327738">PR review comment</a>:</p>
<blockquote>
<p>Sorry the context is lost on the prior comment with the update here, but again while this isn't a blocker not including the function offset seems like it could hinder the usefulness of backtraces since you don't get where you are in a function, just that you're in a certain function. If you're exploring a certian <code>unreachable</code> condition, for example, there'd be no way to figure out which one in a function was hit.</p>
</blockquote>



<a name="336537366"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537366" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537366">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117328959">PR review comment</a>:</p>
<blockquote>
<p>Could the <code>.map_err</code> here become <code>.context(..)</code>?</p>
</blockquote>



<a name="336537367"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537367" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537367">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117330048">PR review comment</a>:</p>
<blockquote>
<p>As a minor nit stylistically our error messages start with lowercase letters (including the "Core dumped at ..." message below)</p>
</blockquote>



<a name="336537368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336537368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336537368">(Feb 24 2023 at 17:06)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117329510">PR review comment</a>:</p>
<blockquote>
<p>Could this error also contain the path name?</p>
</blockquote>



<a name="336545041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336545041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336545041">(Feb 24 2023 at 17:43)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314004486">PR review</a>.</p>



<a name="336545042"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336545042" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336545042">(Feb 24 2023 at 17:43)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117383828">PR review comment</a>:</p>
<blockquote>
<p>Yes, good catch!</p>
</blockquote>



<a name="336545487"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336545487" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336545487">(Feb 24 2023 at 17:45)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314009127">PR review</a>.</p>



<a name="336545488"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336545488" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336545488">(Feb 24 2023 at 17:45)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117386628">PR review comment</a>:</p>
<blockquote>
<p>Ok, thanks.</p>
</blockquote>



<a name="336546972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336546972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336546972">(Feb 24 2023 at 17:52)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314018691">PR review</a>.</p>



<a name="336546973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336546973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336546973">(Feb 24 2023 at 17:52)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117397172">PR review comment</a>:</p>
<blockquote>
<p>The error is from <code>wasm-coredump-builder</code> and is type <code>Box&lt;dyn std::error::Error + Sync + Send&gt;</code> instead of the usual <code>anyhow::Error</code>. Is that a problem?</p>
</blockquote>



<a name="336547461"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336547461" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336547461">(Feb 24 2023 at 17:54)</a>:</h4>
<p>xtuc updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>.</p>



<a name="336547753"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336547753" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336547753">(Feb 24 2023 at 17:55)</a>:</h4>
<p>xtuc edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117386628">PR review comment</a>.</p>



<a name="336547835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336547835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336547835">(Feb 24 2023 at 17:56)</a>:</h4>
<p>xtuc edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117386628">PR review comment</a>.</p>



<a name="336551359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336551359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336551359">(Feb 24 2023 at 18:12)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117434434">PR review comment</a>:</p>
<blockquote>
<p>I opened <a href="https://github.com/WebAssembly/tool-conventions/pull/202">https://github.com/WebAssembly/tool-conventions/pull/202</a> to add <code>funcidx</code> to the coredump format.</p>
</blockquote>



<a name="336551360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336551360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336551360">(Feb 24 2023 at 18:12)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314049822">PR review</a>.</p>



<a name="336554494"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336554494" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336554494">(Feb 24 2023 at 18:27)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314069025">PR review</a>.</p>



<a name="336554495"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336554495" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336554495">(Feb 24 2023 at 18:27)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117455731">PR review comment</a>:</p>
<blockquote>
<p>unfortunately, I don't see a way to retrieve the instruction offset in <a href="https://docs.rs/wasmtime/6.0.0/wasmtime/struct.FrameInfo.html">https://docs.rs/wasmtime/6.0.0/wasmtime/struct.FrameInfo.html</a>.</p>
<p>There's a  method to retrieve the func offset in the module: <a href="https://docs.rs/wasmtime/6.0.0/wasmtime/struct.FrameInfo.html#method.func_offset">https://docs.rs/wasmtime/6.0.0/wasmtime/struct.FrameInfo.html#method.func_offset</a>.</p>
</blockquote>



<a name="336555565"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336555565" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336555565">(Feb 24 2023 at 18:33)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314075804">PR review</a>.</p>



<a name="336555566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336555566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336555566">(Feb 24 2023 at 18:33)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117462848">PR review comment</a>:</p>
<blockquote>
<p>It looks like <code>func_offset</code> is actually what is needed? The documentation reads "Returns the offset from the original wasm module’s function to this frame’s program counter." i.e., it encodes <code>PC - function_start</code>, the offset of the instruction. (The name is somewhat confusing though -- "offset in function" rather than "offset of function"!)</p>
</blockquote>



<a name="336556624"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336556624" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336556624">(Feb 24 2023 at 18:38)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314082658">PR review</a>.</p>



<a name="336556626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336556626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336556626">(Feb 24 2023 at 18:38)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117470074">PR review comment</a>:</p>
<blockquote>
<p>Ah great, I misunderstood. Thanks</p>
</blockquote>



<a name="336571822"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336571822" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336571822">(Feb 24 2023 at 20:05)</a>:</h4>
<p>xtuc updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>.</p>



<a name="336571915"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336571915" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336571915">(Feb 24 2023 at 20:06)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1314182215">PR review</a>.</p>



<a name="336571916"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/336571916" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#336571916">(Feb 24 2023 at 20:06)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1117579349">PR review comment</a>:</p>
<blockquote>
<p>Added <code>codeoffset</code>.</p>
</blockquote>



<a name="337884738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/337884738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#337884738">(Feb 24 2023 at 20:59)</a>:</h4>
<p>xtuc edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>:</p>
<blockquote>
<p>This change adds a basic coredump generation after a WebAssembly trap was entered. The coredump includes rudimentary stack / process debugging information.</p>
<p>A new CLI argument is added to enable coredump generation:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasmtime</span><span class="w"> </span><span class="o">--</span><span class="n">coredump</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">trap</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">coredump</span><span class="o">/</span><span class="n">file</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">wasm</span>
</code></pre></div>
<p>See ./docs/examples-coredump.md for a working example.</p>
<p>Refs <a href="https://github.com/bytecodealliance/wasmtime/issues/5732">https://github.com/bytecodealliance/wasmtime/issues/5732</a></p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[x] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="338452361"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338452361" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338452361">(Feb 27 2023 at 21:19)</a>:</h4>
<p>xtuc updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>.</p>



<a name="338617827"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338617827" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338617827">(Feb 28 2023 at 15:31)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1317871271">PR review</a>.</p>



<a name="338617829"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338617829" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338617829">(Feb 28 2023 at 15:31)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1317871271">PR review</a>.</p>



<a name="338617831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338617831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338617831">(Feb 28 2023 at 15:31)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1120253304">PR review comment</a>:</p>
<blockquote>
<p>It's a problem insofar as the error's contexet is all lost here, only displaying one error in a possible chain of errors contained within the trait object. Whether your library exercises that I'm not sure, though.</p>
</blockquote>



<a name="338617833"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338617833" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338617833">(Feb 28 2023 at 15:31)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1120251982">PR review comment</a>:</p>
<blockquote>
<p>Should this perhaps be a conditional invocation of <code>.codeoffset</code> due to it not always being available?</p>
</blockquote>



<a name="338619913"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338619913" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338619913">(Feb 28 2023 at 15:39)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1317899534">PR review</a>.</p>



<a name="338619914"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338619914" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338619914">(Feb 28 2023 at 15:39)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1120273895">PR review comment</a>:</p>
<blockquote>
<p>It's not a problem for my library, for now, as it doesn't add context to errors.</p>
</blockquote>



<a name="338620265"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338620265" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338620265">(Feb 28 2023 at 15:41)</a>:</h4>
<p>xtuc submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#pullrequestreview-1317902384">PR review</a>.</p>



<a name="338620267"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338620267" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338620267">(Feb 28 2023 at 15:41)</a>:</h4>
<p>xtuc created <a href="https://github.com/bytecodealliance/wasmtime/pull/5868#discussion_r1120276241">PR review comment</a>:</p>
<blockquote>
<p>The result would be the same; <code>codeoffset</code> has to be specified in coredump and can default to 0 if unknown. At least now, it's explicit.</p>
</blockquote>



<a name="338680590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338680590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338680590">(Feb 28 2023 at 20:03)</a>:</h4>
<p>xtuc updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a> from <code>sven/basic-coredump</code> to <code>main</code>.</p>



<a name="338691956"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235868%20add%20basic%20coredump%20generation/near/338691956" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235868.20add.20basic.20coredump.20generation.html#338691956">(Feb 28 2023 at 21:06)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5868">PR #5868</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>