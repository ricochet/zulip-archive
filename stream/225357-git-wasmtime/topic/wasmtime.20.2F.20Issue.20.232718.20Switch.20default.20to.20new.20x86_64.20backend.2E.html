<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2718 Switch default to new x86_64 backend. · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html">wasmtime / Issue #2718 Switch default to new x86_64 backend.</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="229617430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/229617430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#229617430">(Mar 10 2021 at 08:02)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-795051314">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>Switching to "Ready to Review" to get a CI run, but this should still not be merged yet.</p>
</blockquote>



<a name="229736820"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/229736820" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#229736820">(Mar 10 2021 at 20:23)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-796039961">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>Hmm -- I'm not able to reproduce the segfault with the beta toolchain; I've tested on my usual Fedora 33 and then also Ubuntu 18.04 as GitHub uses. I'm wondering if it may be either a CPU-feature issue or a heisenbug -- will continue to probe at this.</p>
</blockquote>



<a name="229740852"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/229740852" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#229740852">(Mar 10 2021 at 20:45)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-796075017">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>I wonder if it would be possible to get GHA to generate a core dump that could be uploaded as artifact.</p>
</blockquote>



<a name="231902446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/231902446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#231902446">(Mar 26 2021 at 01:39)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-807866512">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>These specify which backend to use to run the test (either new, ie "machinst", or legacy).</p>
<p>On Thu, Mar 25, 2021, at 18:19, Johnnie Birch wrote:<br>
&gt; </p>
<blockquote>
<p><strong><em>@</em></strong>.**** commented on this pull request.</p>
</blockquote>
<blockquote>
<p>In cranelift/filetests/filetests/isa/x64/amode-opt.clif &lt;<a href="https://github.com/bytecodealliance/wasmtime/pull/2718#discussion_r601946045">https://github.com/bytecodealliance/wasmtime/pull/2718#discussion_r601946045</a>&gt;:</p>
</blockquote>
<blockquote>
<blockquote>
<p>@@ -1,6 +1,5 @@<br>
 test compile<br>
-target x86_64<br>
-feature "experimental_x64"<br>
+target x86_64 machinst</p>
</blockquote>
<p>What do the new file test targets (machinst and legacy) mean?</p>
</blockquote>
<blockquote>
<p>—<br>
You are receiving this because you authored the thread.<br>
Reply to this email directly, view it on GitHub &lt;<a href="https://github.com/bytecodealliance/wasmtime/pull/2718#pullrequestreview-621707505">https://github.com/bytecodealliance/wasmtime/pull/2718#pullrequestreview-621707505</a>&gt;, or unsubscribe &lt;<a href="https://github.com/notifications/unsubscribe-auth/AABUYVFUXNT3KK4IZAHMRO3TFPOJFANCNFSM4Y5NTKNQ">https://github.com/notifications/unsubscribe-auth/AABUYVFUXNT3KK4IZAHMRO3TFPOJFANCNFSM4Y5NTKNQ</a>&gt;.</p>
</blockquote>
</blockquote>



<a name="232363505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/232363505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#232363505">(Mar 30 2021 at 02:16)</a>:</h4>
<p>cfallin edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-807866512">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>On Thu, Mar 25, 2021, at 18:19, Johnnie Birch wrote:</p>
<blockquote>
<p><strong><em>@</em></strong>.**** commented on this pull request.</p>
</blockquote>
<blockquote>
<p>In cranelift/filetests/filetests/isa/x64/amode-opt.clif &lt;<a href="https://github.com/bytecodealliance/wasmtime/pull/2718#discussion_r601946045">https://github.com/bytecodealliance/wasmtime/pull/2718#discussion_r601946045</a>&gt;:</p>
</blockquote>
<blockquote>
<blockquote>
<p>@@ -1,6 +1,5 @@<br>
test compile<br>
-target x86_64<br>
-feature "experimental_x64"<br>
+target x86_64 machinst</p>
</blockquote>
<p>What do the new file test targets (machinst and legacy) mean?</p>
</blockquote>
<p>These specify which backend to use to run the test (either new, ie "machinst", or legacy).</p>
</blockquote>



<a name="232501454"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/232501454" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#232501454">(Mar 30 2021 at 21:32)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-810591607">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>Rebased to latest. The current plan described in the recently merged <a href="https://github.com/bytecodealliance/rfcs/issues/10">bytecodealliance/rfcs#10</a> is to:</p>
<ol>
<li>Wait until next week as the oss-fuzz fuzzers run with the new backend enabled (turned on in <a href="https://github.com/google/oss-fuzz/issues/5518">google/oss-fuzz#5518</a>).</li>
<li>Make a final release of wasmtime/Cranelift with the current (old) default backend.</li>
<li>Review and merge this PR.</li>
</ol>
</blockquote>



<a name="232599586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/232599586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#232599586">(Mar 31 2021 at 14:20)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-811104086">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>FWIW the fuzzers are definitely working because they already fixed a fuzz bug that was about a timeout in the old backend. Our of curiosity is there any particular reason to wait for one more release rather than considering the last release of wasmtime the last release with the old backend as the default?</p>
</blockquote>



<a name="232627538"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/232627538" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#232627538">(Mar 31 2021 at 17:01)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-811254287">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>That's a good question -- the intent in the RFC was to have a latest-possible snapshot with as many features as possible supported on the old backend with the old backend on by default. Looking through the PR history since 0.25.0, though, it doesn't look like we landed any <em>major</em> user-visible feature, except for some things (SIMD tidbits on new x64 backend, macOS/aarch64) that are not relevant if one is using the old backend. (Please do let me know if I've missed something!)</p>
<p>Given that, I think it fits the spirit of the transition plan in the RFC to take 0.25.0 as the last-good old-backend-as-default release, and just merge this after a bit more fuzzing time. Curious what others think, of course!</p>
</blockquote>



<a name="233196660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232718%20Switch%20default%20to%20new%20x86_64%20backend./near/233196660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232718.20Switch.20default.20to.20new.20x86_64.20backend.2E.html#233196660">(Apr 05 2021 at 16:38)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/2718#issuecomment-813492011">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2718">Issue #2718</a>:</p>
<blockquote>
<p>So there have been no fuzzbugs related to the new backend since we switched the fuzzers over; as per the above, I think this means we're ready to switch the default! Merging now.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>