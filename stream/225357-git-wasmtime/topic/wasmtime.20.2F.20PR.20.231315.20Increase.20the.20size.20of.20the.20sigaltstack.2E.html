<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1315 Increase the size of the sigaltstack. · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html">wasmtime / PR #1315 Increase the size of the sigaltstack.</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="190554395"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190554395" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190554395">(Mar 13 2020 at 21:03)</a>:</h4>
<p>sunfishcode opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315">PR #1315</a> from <code>bigger-sigaltstack-rust</code> to <code>master</code>:</p>
<blockquote>
<p>Rust's stack overflow handler installs a sigaltstack stack with size<br>
SIGSTKSZ, which is too small for some of the things we do in signal<br>
handlers, and as of this writing lacks a guard page. Install bigger<br>
sigaltstack stacks so that we have enough space, and have a guard page.</p>
<p>This is similar to <a href="https://github.com/bytecodealliance/wasmtime/pull/1298" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1298">https://github.com/bytecodealliance/wasmtime/pull/1298</a> but rewritten in Rust </p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" target="_blank" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="190556368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556368">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-374623960" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-374623960">PR Review</a>.</p>



<a name="190556369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556369">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392481961" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392481961">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW panicking in destructors is pretty sketchy, and panicking in a TLS destructor is sort of even sketchier (almost guaranteed to abort the process). Perhaps these could switch to <code>debug_assert</code> statements?</p>
</blockquote>



<a name="190556370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556370">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392483302" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392483302">PR Review Comment</a>:</p>
<blockquote>
<p>Since <code>Tls</code> is constructed with a null <code>ss_sp</code> before we call <code>mmap</code>, I think this'll want to check for null and bail out because <code>mmap</code> would have failed.</p>
</blockquote>



<a name="190556371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556371">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-374623960" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-374623960">PR Review</a>.</p>



<a name="190556372"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556372" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556372">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392482906" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392482906">PR Review Comment</a>:</p>
<blockquote>
<p>Instead of raising a trap could this perhaps bubble up some sort of error to the caller? I don't think the raising mechanism is needed here if this is reorganized a bit, for example the caller could do:</p>
<div class="codehilite"><pre><span></span><span class="cp">#[cfg(unix)]</span><span class="w"></span>
<span class="n">unix</span>::<span class="n">setup_sigaltstack</span><span class="p">()</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
</pre></div>


<p>and internally this module would check the TLS variable, and if it's not initialized would perform inline initialization which would bubble this error up through returns rather than a longjmp</p>
</blockquote>



<a name="190556373"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556373" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556373">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392486294" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392486294">PR Review Comment</a>:</p>
<blockquote>
<p>I might recommend something like:</p>
<div class="codehilite"><pre><span></span><span class="n">thread_local</span><span class="o">!</span><span class="p">(</span><span class="k">static</span><span class="w"> </span><span class="n">TLS</span>: <span class="nc">RefCell</span><span class="o">&lt;</span><span class="n">Tls</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RefCell</span>::<span class="n">new</span><span class="p">(</span><span class="n">Tls</span>::<span class="nb">None</span><span class="p">);</span><span class="w"></span>

<span class="k">enum</span> <span class="nc">Tls</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">None</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">Allocated</span><span class="p">(</span><span class="n">Sigaltstack</span><span class="p">),</span><span class="w"> </span><span class="c1">// `Drop for Sigaltstack` frees stuff</span>
<span class="w">    </span><span class="n">CheckedAlready</span><span class="p">),</span><span class="w"> </span><span class="c1">// sigaltstack was previously big enough</span>
<span class="p">}</span><span class="w"></span>
</pre></div>


</blockquote>



<a name="190556374"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556374" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556374">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392484471" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392484471">PR Review Comment</a>:</p>
<blockquote>
<p>FWIW this may be a bit easier with <code>let mut old_stack = mem::zeroed()</code> to make it a bit more portable if that ever comes up</p>
</blockquote>



<a name="190556375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556375">(Mar 13 2020 at 21:22)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392485545" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392485545">PR Review Comment</a>:</p>
<blockquote>
<p>I think these checks may want to move up to the front actually and not be assertions but rather runtime checks. With the C embedding we're not actually guaranteed the sigaltstack is set up (which I'm just now realizing is probably bad) because the Rust main function didn't happen. Additionally the application may have its own sigaltstack handled somewhere else.</p>
<p>I think we'll want to check the current sigaltstack here and if it's big enough just skip all this entirely, and then for flags I'm not really sure we need to check too much, but I don't think we should panic if the embedder has a particular configuration.</p>
</blockquote>



<a name="190556791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556791">(Mar 13 2020 at 21:26)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-374629059" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-374629059">PR Review</a>.</p>



<a name="190556792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/190556792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#190556792">(Mar 13 2020 at 21:26)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392489228" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r392489228">PR Review Comment</a>:</p>
<blockquote>
<p>just a note, the default signal stack should have a guard page soon: <a href="https://github.com/rust-lang/rust/pull/69969" target="_blank" title="https://github.com/rust-lang/rust/pull/69969">https://github.com/rust-lang/rust/pull/69969</a></p>
</blockquote>



<a name="191724508"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/191724508" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#191724508">(Mar 25 2020 at 10:22)</a>:</h4>
<p>eust-dfinity submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-381017754" title="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-381017754">PR Review</a>.</p>



<a name="191724509"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/191724509" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#191724509">(Mar 25 2020 at 10:22)</a>:</h4>
<p>eust-dfinity created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r397746069" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r397746069">PR Review Comment</a>:</p>
<blockquote>
<p>FYI in Dfinity we use std::cmp::max(SIGSTKSZ, 24 * 1024) here, because SIGSTKSZ on MacOS is already huge (128K) and reserving 512K per thread for the signal stack seemed like too much</p>
</blockquote>



<a name="192848696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192848696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192848696">(Apr 03 2020 at 18:51)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">PR #1315</a> from <code>bigger-sigaltstack-rust</code> to <code>master</code>:</p>
<blockquote>
<p>Rust's stack overflow handler installs a sigaltstack stack with size<br>
SIGSTKSZ, which is too small for some of the things we do in signal<br>
handlers, and as of this writing lacks a guard page. Install bigger<br>
sigaltstack stacks so that we have enough space, and have a guard page.</p>
<p>This is similar to <a href="https://github.com/bytecodealliance/wasmtime/pull/1298" title="https://github.com/bytecodealliance/wasmtime/pull/1298">https://github.com/bytecodealliance/wasmtime/pull/1298</a> but rewritten in Rust </p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="192848846"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192848846" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192848846">(Apr 03 2020 at 18:52)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">PR #1315</a> from <code>bigger-sigaltstack-rust</code> to <code>master</code>:</p>
<blockquote>
<p>Rust's stack overflow handler installs a sigaltstack stack with size<br>
SIGSTKSZ, which is too small for some of the things we do in signal<br>
handlers, and as of this writing lacks a guard page. Install bigger<br>
sigaltstack stacks so that we have enough space, and have a guard page.</p>
<p>This is similar to <a href="https://github.com/bytecodealliance/wasmtime/pull/1298" title="https://github.com/bytecodealliance/wasmtime/pull/1298">https://github.com/bytecodealliance/wasmtime/pull/1298</a> but rewritten in Rust </p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="192850485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192850485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192850485">(Apr 03 2020 at 19:05)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">PR #1315</a> from <code>bigger-sigaltstack-rust</code> to <code>master</code>:</p>
<blockquote>
<p>Rust's stack overflow handler installs a sigaltstack stack with size<br>
SIGSTKSZ, which is too small for some of the things we do in signal<br>
handlers, and as of this writing lacks a guard page. Install bigger<br>
sigaltstack stacks so that we have enough space, and have a guard page.</p>
<p>This is similar to <a href="https://github.com/bytecodealliance/wasmtime/pull/1298" title="https://github.com/bytecodealliance/wasmtime/pull/1298">https://github.com/bytecodealliance/wasmtime/pull/1298</a> but rewritten in Rust </p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="192861272"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192861272" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192861272">(Apr 03 2020 at 20:42)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r403318007" title="https://github.com/bytecodealliance/wasmtime/pull/1315#discussion_r403318007">PR Review Comment</a>:</p>
<blockquote>
<p>s/reigster/register/</p>
</blockquote>



<a name="192861273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192861273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192861273">(Apr 03 2020 at 20:42)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-387566118" title="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-387566118">PR Review</a>.</p>



<a name="192861274"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192861274" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192861274">(Apr 03 2020 at 20:42)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-387566118" title="https://github.com/bytecodealliance/wasmtime/pull/1315#pullrequestreview-387566118">PR Review</a>.</p>



<a name="192866912"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192866912" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192866912">(Apr 03 2020 at 21:36)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">PR #1315</a> from <code>bigger-sigaltstack-rust</code> to <code>master</code>:</p>
<blockquote>
<p>Rust's stack overflow handler installs a sigaltstack stack with size<br>
SIGSTKSZ, which is too small for some of the things we do in signal<br>
handlers, and as of this writing lacks a guard page. Install bigger<br>
sigaltstack stacks so that we have enough space, and have a guard page.</p>
<p>This is similar to <a href="https://github.com/bytecodealliance/wasmtime/pull/1298" title="https://github.com/bytecodealliance/wasmtime/pull/1298">https://github.com/bytecodealliance/wasmtime/pull/1298</a> but rewritten in Rust </p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md" title="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;</p>
</blockquote>



<a name="192866931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231315%20Increase%20the%20size%20of%20the%20sigaltstack./near/192866931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231315.20Increase.20the.20size.20of.20the.20sigaltstack.2E.html#192866931">(Apr 03 2020 at 21:36)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1315" title="https://github.com/bytecodealliance/wasmtime/pull/1315">PR #1315</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>