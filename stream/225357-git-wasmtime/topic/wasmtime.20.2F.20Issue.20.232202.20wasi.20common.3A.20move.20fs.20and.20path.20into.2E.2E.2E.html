<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2202 wasi common: move fs and path into... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232202.20wasi.20common.3A.20move.20fs.20and.20path.20into.2E.2E.2E.html">wasmtime / Issue #2202 wasi common: move fs and path into...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="210082133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232202%20wasi%20common%3A%20move%20fs%20and%20path%20into.../near/210082133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232202.20wasi.20common.3A.20move.20fs.20and.20path.20into.2E.2E.2E.html#210082133">(Sep 15 2020 at 01:25)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/2202#issuecomment-692404649">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2202">Issue #2202</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @kubkon</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasi"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>kubkon: wasi</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="210325119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232202%20wasi%20common%3A%20move%20fs%20and%20path%20into.../near/210325119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232202.20wasi.20common.3A.20move.20fs.20and.20path.20into.2E.2E.2E.html#210325119">(Sep 16 2020 at 21:54)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/pull/2202#issuecomment-693685887">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2202">Issue #2202</a>:</p>
<blockquote>
<p>rebased on top of main after #2201 merged </p>
</blockquote>



<a name="210325131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232202%20wasi%20common%3A%20move%20fs%20and%20path%20into.../near/210325131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232202.20wasi.20common.3A.20move.20fs.20and.20path.20into.2E.2E.2E.html#210325131">(Sep 16 2020 at 21:54)</a>:</h4>
<p>pchickey edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/2202#issuecomment-693685887">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2202">Issue #2202</a>:</p>
<blockquote>
<p>This PR has been rebased on top of main after #2201 merged </p>
</blockquote>



<a name="211075882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232202%20wasi%20common%3A%20move%20fs%20and%20path%20into.../near/211075882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232202.20wasi.20common.3A.20move.20fs.20and.20path.20into.2E.2E.2E.html#211075882">(Sep 23 2020 at 23:55)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/pull/2202#issuecomment-698032121">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2202">Issue #2202</a>:</p>
<blockquote>
<p>wrt the Rights flags: right now, the canonical definition of the rights type is in the witx snapshot, but if we evolve how rights work, I expect the first thing we'll do is make the canonical definition a type defined in wasi-common, and then define conversion functions for whenever we need to represent those to the guest via each snapshot we support.</p>
<p>wrt separation of responsibilities: first off, theres a big overlap between <code>Handle</code> and <code>Entry</code> right now, which needs design work still. I'm not 100% sure how to resolve these yet. My goal is that the handle/entry concept will be responsible for exporting all types used in its interfaces. Whether those types are imported from a given snapshot's wiggle generated code, or defined canonically without wiggle, is an implementation detail.</p>
<p>At the moment, snapshots manipulate the entry table (mostly <code>get_entry</code> but some <code>remove_entry</code> and <code>insert_entry_at</code>) and call <code>Entry</code> methods (though they do so with types exported by <code>crate::handle</code>... admittedly this is muddled). Since we want to define many snapshots that will usually look a lot alike, I tried to move as much complexity out of these bodies as possible, while exposing as few pointers (and, with them, assumptions about how guest programs represent things in memory) to the <code>Entry</code> methods as possible. Unfortunately, I haven't figured out how to do this with absolutely no pointers, unless we reintroduce mut vs const borrows to the wiggle api so that const borrows can overlap.</p>
<p>Then, each snapshot will be responsible for calling the handle/entry concept, converting any of its interfaces's types to and from the ones expected by the <code>Entry</code> methods. Whichever snapshot's types get exported by <code>crate::handle</code> gets to skip this converting to/from code. For all of the types in snapshot 0, we'll have to define conversion functions, but the overwhelming majority of them should compile to a no-op because the representation is exactly the same.</p>
<p>This PR leaves this work incomplete - #2205 is still a work in progress at completing that abstraction with the scheduler methods.</p>
</blockquote>



<a name="218621665"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232202%20wasi%20common%3A%20move%20fs%20and%20path%20into.../near/218621665" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232202.20wasi.20common.3A.20move.20fs.20and.20path.20into.2E.2E.2E.html#218621665">(Dec 02 2020 at 21:23)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/pull/2202#issuecomment-737503934">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/2202">Issue #2202</a>:</p>
<blockquote>
<p>Closing, I'm taking another tack on this work based on cap-std &amp; system-interface.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>