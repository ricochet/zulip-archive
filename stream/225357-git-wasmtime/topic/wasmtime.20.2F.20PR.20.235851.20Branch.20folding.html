<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5851 Branch folding · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235851.20Branch.20folding.html">wasmtime / PR #5851 Branch folding</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="329475267"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235851%20Branch%20folding/near/329475267" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235851.20Branch.20folding.html#329475267">(Feb 22 2023 at 16:37)</a>:</h4>
<p>mmitton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5851">PR #5851</a> from <code>branch_folding</code> to <code>main</code>:</p>
<blockquote>
<p>I have implemented branch folding for constant value conditionals inside the egraph midend.  This covers BrIf and BrTable, converting them to Jump instructions and removing edges in the ControlFlowGraph and updating the DominatorTree, detecting unreachable code and removing them as well.</p>
<p>This necessitated having mutable access to the DominatorTree in egraph, so it had to be removed from AliasAnalysis and passed to AliasAnalysis for the functions that needed it.  As a side benefit, this cleaned up some lifetimes sprinkled around to have a reference to DominatorTree in AliasAnalysis.</p>
<p>A block is determined to be unreachable if it no longer has any predecessors or has one predecessor and is the head of a loop.</p>
<p>After folding the branch and removing pred/succ to dead code, when a block is processed, a check is made to see if there are parameters to the block and there is one and only one pred to the block.  If this is the case, the parameters are detached from the block and aliased to the passed arguments in the BlockCall.</p>
<p>I have chatted briefly with @cfallin while implementing this, and he suggested I create a PR to let people review the changes.</p>
</blockquote>



<a name="329491453"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235851%20Branch%20folding/near/329491453" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235851.20Branch.20folding.html#329491453">(Feb 22 2023 at 17:44)</a>:</h4>
<p>mmitton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5851">PR #5851</a> from <code>branch_folding</code> to <code>main</code>.</p>



<a name="338579254"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235851%20Branch%20folding/near/338579254" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235851.20Branch.20folding.html#338579254">(Feb 28 2023 at 12:53)</a>:</h4>
<p>mmitton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5851">PR #5851</a> from <code>branch_folding</code> to <code>main</code>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>