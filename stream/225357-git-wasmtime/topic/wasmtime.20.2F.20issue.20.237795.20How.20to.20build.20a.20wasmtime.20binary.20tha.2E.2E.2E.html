<html>
<head><meta charset="utf-8"><title>wasmtime / issue #7795 How to build a wasmtime binary tha... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html">wasmtime / issue #7795 How to build a wasmtime binary tha...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="416724273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/416724273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#416724273">(Jan 19 2024 at 07:46)</a>:</h4>
<p>BenSunWhiteBoard opened <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Hi, I download the release binary, seems it doesn't enable memory64 by default, my running result:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>./wasmtime<span class="w"> </span>test.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>WebAssembly<span class="w"> </span>module

Caused<span class="w"> </span>by:
<span class="w">        </span>Invalid<span class="w"> </span>input<span class="w"> </span>WebAssembly<span class="w"> </span>code<span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span><span class="m">440</span>:<span class="w"> </span>memory64<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>enabled<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span>memories
</code></pre></div>
<p>I really appreciate it if someone could help me with how to build a wasmtime that could run memory64 wasm file. And if I enable memory64, can I still run memory32 wasm file? <br>
</p>
</blockquote>



<a name="416724283"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/416724283" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#416724283">(Jan 19 2024 at 07:46)</a>:</h4>
<p>BenSunWhiteBoard edited <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Hi, I download the release binary, seems it doesn't enable memory64 by default, my running result:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>./wasmtime<span class="w"> </span>test.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>WebAssembly<span class="w"> </span>module

Caused<span class="w"> </span>by:
<span class="w">        </span>Invalid<span class="w"> </span>input<span class="w"> </span>WebAssembly<span class="w"> </span>code<span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span><span class="m">440</span>:<span class="w"> </span>memory64<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>enabled<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span>memories
</code></pre></div>
<p>I really appreciate it if someone could help me with how to build a wasmtime that could run memory64 wasm file. And if I enable memory64, can I still run memory32 wasm file? <br>
</p>
</blockquote>



<a name="416757653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/416757653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#416757653">(Jan 19 2024 at 11:19)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/7795#issuecomment-1900222315">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Try <code>wasmtime -W memory64=y test.wasm</code>.</p>
</blockquote>



<a name="416803797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/416803797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#416803797">(Jan 19 2024 at 15:39)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7795#issuecomment-1900646607">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Yes memory64 support is not a compile-time feature but a runtime feature, so @bjorn3's suggestion should work, but I'll hold off on closing this until @BenSunWhiteBoard you confirm it works for you</p>
</blockquote>



<a name="417386532"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/417386532" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#417386532">(Jan 23 2024 at 07:36)</a>:</h4>
<p>BenSunWhiteBoard <a href="https://github.com/bytecodealliance/wasmtime/issues/7795#issuecomment-1905452970">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Thanks! I tried it with some handwritten wasm samples, and it did work.<br>
One more question though: If wasi-libc support wasm64 after <a href="https://github.com/WebAssembly/wasi-libc/pull/444">https://github.com/WebAssembly/wasi-libc/pull/444</a> got merged, there will be new import WASI APIs like <code>fd_close_wasm64</code>. If I understand correctly, it wouldn't be too much work to add a new interface for it from the implementation of <code>fd_close</code> right? I think it's safe to say that at least a large potion of code can be reused. Does wasmtime plan to support those interface in the near future if wasm64 got supported in wasi-libc and wasi-sdk?</p>
</blockquote>



<a name="417501665"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/417501665" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#417501665">(Jan 23 2024 at 18:10)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/7795#issuecomment-1906639400">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>memory64 support for wasm is not specified at this time and it's not clear to me that there's an "obvious" design of how to implement it. That PR is one option but isn't necessarily the only one. In that sense it's hard to say what a memory64 wasi would take effort-wise because to me it's not clear to me what the work will be</p>
</blockquote>



<a name="417992451"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/417992451" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#417992451">(Jan 25 2024 at 01:28)</a>:</h4>
<p>BenSunWhiteBoard closed <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Hi, I download the release binary, seems it doesn't enable memory64 by default, my running result:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>./wasmtime<span class="w"> </span>test.wasm
Error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>WebAssembly<span class="w"> </span>module

Caused<span class="w"> </span>by:
<span class="w">        </span>Invalid<span class="w"> </span>input<span class="w"> </span>WebAssembly<span class="w"> </span>code<span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span><span class="m">440</span>:<span class="w"> </span>memory64<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>enabled<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span>memories
</code></pre></div>
<p>I really appreciate it if someone could help me with how to build a wasmtime that could run memory64 wasm file. And if I enable memory64, can I still run memory32 wasm file? <br>
</p>
</blockquote>



<a name="417992452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%237795%20How%20to%20build%20a%20wasmtime%20binary%20tha.../near/417992452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.237795.20How.20to.20build.20a.20wasmtime.20binary.20tha.2E.2E.2E.html#417992452">(Jan 25 2024 at 01:28)</a>:</h4>
<p>BenSunWhiteBoard <a href="https://github.com/bytecodealliance/wasmtime/issues/7795#issuecomment-1909196107">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/7795">issue #7795</a>:</p>
<blockquote>
<p>Thanks for your kind reply! I have no further questions </p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>