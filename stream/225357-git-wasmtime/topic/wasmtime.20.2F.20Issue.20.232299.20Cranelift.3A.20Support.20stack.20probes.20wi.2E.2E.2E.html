<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #2299 Cranelift: Support stack probes wi... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232299.20Cranelift.3A.20Support.20stack.20probes.20wi.2E.2E.2E.html">wasmtime / Issue #2299 Cranelift: Support stack probes wi...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="213708321"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%232299%20Cranelift%3A%20Support%20stack%20probes%20wi.../near/213708321" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.232299.20Cranelift.3A.20Support.20stack.20probes.20wi.2E.2E.2E.html#213708321">(Oct 18 2020 at 14:16)</a>:</h4>
<p>bjorn3 opened <a href="https://github.com/bytecodealliance/wasmtime/issues/2299">Issue #2299</a>:</p>
<blockquote>
<p>&lt;!-- Please try to describe precisely what you would like to do in<br>
Cranelift/Wasmtime and/or expect from it. You can answer the questions below if<br>
they're relevant and delete this text before submitting. Thanks for opening an<br>
issue! --&gt;</p>
<h4>Feature</h4>
<p>LLVM has support for performing the stack probes directly in the function prologue instead of calling an external function. (see <a href="https://github.com/rust-lang/rust/pull/77885">https://github.com/rust-lang/rust/pull/77885</a> for using this in Rust)</p>
<h4>Benefit</h4>
<p>This can be faster due to being able to unroll the stack probe loop. It also avoids having to provide an external stack probe function. This makes it possible to enable stack probing in cg_clif. (<a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/661">https://github.com/bjorn3/rustc_codegen_cranelift/issues/661</a>)</p>
<h4>Implementation</h4>
<p>This should only be implemented for the machinst backends. It should probably be added to either the <code>gen_prologue</code> implementation or <code>gen_prologue</code> caller.</p>
<h4>Alternatives</h4>
<p>Keep using an external stack probe function with the associated drawbacks.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>