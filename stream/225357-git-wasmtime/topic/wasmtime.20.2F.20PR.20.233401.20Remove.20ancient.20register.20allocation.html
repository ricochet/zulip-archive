<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3401 Remove ancient register allocation · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html">wasmtime / PR #3401 Remove ancient register allocation</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="255626513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255626513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255626513">(Sep 30 2021 at 18:42)</a>:</h4>
<p>bnjbvr opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3401">PR #3401</a> from <code>remove-old-regalloc</code> to <code>main</code>:</p>
<blockquote>
<p>There's still a lot that can be done, but that'll be enough playing for tonight :-)</p>
<p>This removes the old register allocation, and the entire folder <code>regalloc</code> that contained related code, like live range analysis, etc. and quite a lot in binemit too (maybe that can be entirely removed too with additional effort?).</p>
</blockquote>



<a name="255627519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627519">(Sep 30 2021 at 18:49)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-768222035">PR review</a>.</p>



<a name="255627604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627604">(Sep 30 2021 at 18:50)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-768222462">PR review</a>.</p>



<a name="255627605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627605">(Sep 30 2021 at 18:50)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#discussion_r719673262">PR review comment</a>:</p>
<blockquote>
<p>Can you add a FIXME to make this non-optional?</p>
</blockquote>



<a name="255627716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627716">(Sep 30 2021 at 18:51)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3401">PR #3401</a> from <code>remove-old-regalloc</code> to <code>main</code>.</p>



<a name="255627718"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627718" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627718">(Sep 30 2021 at 18:51)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-768223488">PR review</a>.</p>



<a name="255627719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627719">(Sep 30 2021 at 18:51)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#discussion_r719673977">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        // FIXME: make this non optional
        let backend = isa.get_mach_backend().expect("only mach backends nowadays");
</code></pre></div><br>
</p>
</blockquote>



<a name="255627747"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627747" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627747">(Sep 30 2021 at 18:51)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3401">PR #3401</a> from <code>remove-old-regalloc</code> to <code>main</code>.</p>



<a name="255627850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627850">(Sep 30 2021 at 18:52)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-768224272">PR review</a>.</p>



<a name="255627851"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255627851" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255627851">(Sep 30 2021 at 18:52)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#discussion_r719674550">PR review comment</a>:</p>
<blockquote>
<p>More generally, I expect that we'll continue to tweak the data structures to remove <code>Option&lt;&gt;</code>s on new bits and delete the old bits; the CLIF function representation still has some bits that can go (<code>jt_offsets</code> for example?) too.</p>
</blockquote>



<a name="255628280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255628280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255628280">(Sep 30 2021 at 18:55)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-768226937">PR review</a>.</p>



<a name="255628282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255628282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255628282">(Sep 30 2021 at 18:55)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#discussion_r719676521">PR review comment</a>:</p>
<blockquote>
<p>I'd expect that too, yeah. The fact that so many things were marked <code>pub</code> (and not <code>pub(crate)</code>) make it so the compiler is not seeing all the dead code out there.</p>
</blockquote>



<a name="255633200"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255633200" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255633200">(Sep 30 2021 at 19:27)</a>:</h4>
<p>bnjbvr merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3401">PR #3401</a>.</p>



<a name="255790092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255790092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255790092">(Oct 01 2021 at 18:45)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-769279269">PR review</a>.</p>



<a name="255790093"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/255790093" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#255790093">(Oct 01 2021 at 18:45)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#discussion_r720468809">PR review comment</a>:</p>
<blockquote>
<p>Can <code>EncCursor</code> be removed entirely? It doesn't update encodings anymore.</p>
</blockquote>



<a name="256021002"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/256021002" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#256021002">(Oct 04 2021 at 08:09)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#pullrequestreview-769981955">PR review</a>.</p>



<a name="256021003"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233401%20Remove%20ancient%20register%20allocation/near/256021003" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233401.20Remove.20ancient.20register.20allocation.html#256021003">(Oct 04 2021 at 08:09)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/3401#discussion_r721131444">PR review comment</a>:</p>
<blockquote>
<p>Sounds like yes!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>