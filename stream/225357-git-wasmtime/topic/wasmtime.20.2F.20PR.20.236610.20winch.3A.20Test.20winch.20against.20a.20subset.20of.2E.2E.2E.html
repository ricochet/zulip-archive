<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6610 winch: Test winch against a subset of... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html">wasmtime / PR #6610 winch: Test winch against a subset of...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="368051081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/368051081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#368051081">(Jun 20 2023 at 20:49)</a>:</h4>
<p>saulecabrera opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a> from <code>saulecabrera:winch-wast</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>With the introduction of control flow, Winch is getting to a point in which it would be beneficial to have some sort of run tests rather only filetests. Run tests make it easier to verify that the introduction of new features or bug fixes won't cause any regressions or bugs. They also make it easier to verify the behavior of the code generated by Winch.</p>
<p>The idea behind this change is to test Winch against a subset of the official spec test suite. Any unsupported tests will be commented out from the spec tests and as more features are added the corresponding tests will be uncommented. This involves a bit of duplication with regards to the spec tests, but the ideal end state is to have Winch be just another strategy in <code>build.rs</code> and have both compilers use <code>./tests/spec_testsuite</code> instead of using a custom directory for Winch once Winch offers feature parity.</p>
<p>Note that I'm currently collecting feedback on this idea, and for that reason, I've only included the block spec as an example. </p>
<p>We discussed this idea during today's Winch meeting: <a href="https://github.com/bytecodealliance/meetings/blob/main/winch/2023/winch-06-20.md">https://github.com/bytecodealliance/meetings/blob/main/winch/2023/winch-06-20.md</a></p>
<p>@cfallin and @alexcrichton I'm interested in your thoughts regarding this change. </p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="368065519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/368065519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#368065519">(Jun 20 2023 at 22:26)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6610#pullrequestreview-1489196934">PR review</a>:</p>
<blockquote>
<p>Glad to see Winch shaping up!</p>
<p>In the long run I don't think the test organization matters too too much as long as it's being tested, but in the interim one thing I might recommend is to "attempt" to run all tests with Winch but have <code>#[ignore]</code> on almost all of them. Similar to how riscv64 runs all the tests but skips anything simd related. That'd avoid having two copies of the tests and would attempt, by default, to run everything in Winch and Winch would have an allow-list that slowly grows or a deny-list that slowly gets smaller.</p>
</blockquote>



<a name="368087997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/368087997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#368087997">(Jun 21 2023 at 01:41)</a>:</h4>
<p>saulecabrera edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>:</p>
<blockquote>
<p>With the introduction of control flow, Winch is getting to a point in which it would be beneficial to have some sort of run tests rather than only filetests. Run tests make it easier to verify that the introduction of new features or bug fixes won't cause any regressions or bugs. They also make it easier to verify the behavior of the code generated by Winch.</p>
<p>The idea behind this change is to test Winch against a subset of the official spec test suite. Any unsupported tests will be commented out from the spec tests and as more features are added the corresponding tests will be uncommented. This involves a bit of duplication with regards to the spec tests, but the ideal end state is to have Winch be just another strategy in <code>build.rs</code> and have both compilers use <code>./tests/spec_testsuite</code> instead of using a custom directory for Winch once Winch offers feature parity.</p>
<p>Note that I'm currently collecting feedback on this idea, and for that reason, I've only included the block spec as an example. </p>
<p>We discussed this idea during today's Winch meeting: <a href="https://github.com/bytecodealliance/meetings/blob/main/winch/2023/winch-06-20.md">https://github.com/bytecodealliance/meetings/blob/main/winch/2023/winch-06-20.md</a></p>
<p>@cfallin and @alexcrichton I'm interested in your thoughts regarding this change. </p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="370853145"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/370853145" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#370853145">(Jun 29 2023 at 16:45)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="370932935"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/370932935" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#370932935">(Jun 29 2023 at 21:47)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371112341"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371112341" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371112341">(Jun 30 2023 at 11:37)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371116520"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371116520" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371116520">(Jun 30 2023 at 11:49)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371122382"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371122382" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371122382">(Jun 30 2023 at 12:06)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371123299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371123299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371123299">(Jun 30 2023 at 12:09)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371269363"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371269363" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371269363">(Jun 30 2023 at 18:41)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371270857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371270857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371270857">(Jun 30 2023 at 18:47)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371273650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371273650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371273650">(Jun 30 2023 at 18:58)</a>:</h4>
<p><strong>saulecabrera</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a> as ready for review.</p>



<a name="371273656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371273656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371273656">(Jun 30 2023 at 18:58)</a>:</h4>
<p><strong>saulecabrera</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371273657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371273657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371273657">(Jun 30 2023 at 18:58)</a>:</h4>
<p><strong>saulecabrera</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371273659"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371273659" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371273659">(Jun 30 2023 at 18:58)</a>:</h4>
<p><strong>saulecabrera</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371274328"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371274328" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371274328">(Jun 30 2023 at 19:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6610#pullrequestreview-1507749146">PR review</a>.</p>



<a name="371274397"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371274397" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371274397">(Jun 30 2023 at 19:01)</a>:</h4>
<p>saulecabrera has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="371277911"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/371277911" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#371277911">(Jun 30 2023 at 19:14)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="372133479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/372133479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#372133479">(Jul 03 2023 at 21:31)</a>:</h4>
<p>saulecabrera updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<a name="372142668"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236610%20winch%3A%20Test%20winch%20against%20a%20subset%20of.../near/372142668" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236610.20winch.3A.20Test.20winch.20against.20a.20subset.20of.2E.2E.2E.html#372142668">(Jul 03 2023 at 22:55)</a>:</h4>
<p>saulecabrera merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6610">PR #6610</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>