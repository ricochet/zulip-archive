<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1774 Multi-value return support on aarc... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html">wasmtime / Issue #1774 Multi-value return support on aarc...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="198959887"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/198959887" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#198959887">(May 27 2020 at 22:09)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-634969784">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @bnjbvr</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift", "cranelift:area:aarch64", "cranelift:area:x64"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>bnjbvr: cranelift</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="198960621"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/198960621" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#198960621">(May 27 2020 at 22:17)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-634973039">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<p>The SystemV abi on AArch64 uses <code>x0</code> and <code>x1</code> to return pairs of integers. Could you please do that in Cranelif too? Even if only in the non baldrdash variant of the abi?</p>
</blockquote>



<a name="198968121"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/198968121" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#198968121">(May 27 2020 at 23:50)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-635004145">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<blockquote>
<p>The SystemV abi on AArch64 uses <code>x0</code> and <code>x1</code> to return pairs of integers. Could you please do that in Cranelif too? Even if only in the non baldrdash variant of the abi?</p>
</blockquote>
<p>Happy to take a followup patch for this, but perhaps not in the initial patch, if only because I don't have a way to test it easily. As far as I can tell, the principle in the past (e.g. in #1178) was to keep the ABI as simple as possible initially. I'm not opposed to declaring that we achieve full SysV ABI compatibility eventually, but it's a higher bar for sure!</p>
</blockquote>



<a name="198997343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/198997343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#198997343">(May 28 2020 at 08:56)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-635212438">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<p>Keeping the abi simple is fine, but I want to have all the primitives necessary to implement full SystemV abi support from the clif ir producer side.</p>
</blockquote>



<a name="199037098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/199037098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#199037098">(May 28 2020 at 15:19)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-635416006">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<p>@bjorn3: after more thought, I think it actually wouldn't be too bad to at least give a "all return values are in registers; error if &gt; K returns" (K = 8 on aarch64?) mode. Perhaps we can define this to be the default if we're not in Baldrdash (SpiderMonkey) mode. This would give you the building blocks needed to legalize whatever other ABI (SysV or otherwise) down to CLIF. Does that sound reasonable?</p>
</blockquote>



<a name="199039099"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/199039099" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#199039099">(May 28 2020 at 15:34)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-635424338">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>
</blockquote>



<a name="199438692"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231774%20Multi-value%20return%20support%20on%20aarc.../near/199438692" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231774.20Multi-value.20return.20support.20on.20aarc.2E.2E.2E.html#199438692">(Jun 02 2020 at 00:23)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/1774#issuecomment-637195345">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1774">Issue #1774</a>:</p>
<blockquote>
<p>Updated to return values in x0-x7 by default.</p>
<p>@bnjbvr, PTAL -- I think we'll need to land this first before we can version-bump vendored Cranelift in SpiderMonkey and fix the issues there. Thanks!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>