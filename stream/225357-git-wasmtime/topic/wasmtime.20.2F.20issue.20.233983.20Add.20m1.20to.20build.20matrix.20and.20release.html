<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3983 Add m1 to build matrix and release · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html">wasmtime / issue #3983 Add m1 to build matrix and release</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="277320383"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277320383" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277320383">(Mar 31 2022 at 18:19)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1084948900">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>Thanks for this! I don't think that CI can run the tests since I believe it's x86_64 hardware, but we should probably be able to add a builder so long as it doesn't take unduly long in CI. I think though that the <code>build-tarballs.sh</code> script needs to be updated for the new target</p>
</blockquote>



<a name="277323474"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277323474" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277323474">(Mar 31 2022 at 18:44)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1084976016">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>This seems fine to me as long as we have some testing on the releases -- unfortunately GitHub Actions still does not support macOS/aarch64 (see <a href="https://github.com/actions/virtual-environments/issues/2187">actions/virtual-environments#2187</a>) so we can't run our tests in CI. (This has been the blocker for M1 support so far.) Last I heard, Embark Studios folks were running their own internal CI on M1 systems (@bnjbvr can you confirm this is still active?) -- if we have that, and if #3955 goes in so we have two weeks between branching a release and publishing it, then we could rely on Embark to notify us if there is some breakage with a given release. Not optimal, but it's something. Thoughts?</p>
</blockquote>



<a name="277323622"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277323622" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277323622">(Mar 31 2022 at 18:45)</a>:</h4>
<p>cfallin edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1084976016">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>This seems fine to me as long as we have some testing on the releases -- unfortunately GitHub Actions still does not support macOS/aarch64 (see <a href="https://github.com/actions/virtual-environments/issues/2187">actions/virtual-environments#2187</a>) so we can't run our tests in CI. (This has been the blocker for adding official M1 releases so far, though we've had unofficial support in-tree thanks to @bnjbvr.) Last I heard, Embark Studios folks were running their own internal CI on M1 systems (@bnjbvr can you confirm this is still active?) -- if we have that, and if #3955 goes in so we have two weeks between branching a release and publishing it, then we could rely on Embark to notify us if there is some breakage with a given release. Not optimal, but it's something. Thoughts?</p>
</blockquote>



<a name="277433984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277433984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277433984">(Apr 01 2022 at 15:19)</a>:</h4>
<p>ricochet <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1086029814">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>If we have a release milestone, we can do manual testing on a m1 and sign-off for releases. Not ideal, but workable. I would gladly volunteer until an automated solution is put in place.</p>
<p>A different option would be to use a self-hosted runner. Now that AWS and other providers have aarch64-darwin VM's, we could kickoff a workflow for verifying the m1 binary. This issue seems a little closer to completion than the a hosted VM but that's just a guess <a href="https://github.com/actions/runner/issues/805">https://github.com/actions/runner/issues/805</a>.</p>
</blockquote>



<a name="277439378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277439378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277439378">(Apr 01 2022 at 15:57)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1086081681">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>I think even with a custom runner our hands are sort of tied because GitHub's own official recommendation is that for public repositories you shouldn't use self-hosted runners for security reasons. If you're ok manually verifying that builds are ok that may be the best way to go. With the release process from <a href="https://github.com/bytecodealliance/wasmtime/pull/3955">https://github.com/bytecodealliance/wasmtime/pull/3955</a> there will be a 2-week window between when a release branch is created and when it's actually published which should provide a good opportunity to test on non-CI-tested-platforms.</p>
<p>If you'd like it could also be set up to notify you. We could apply a tag to the PR and then using our <a href="https://github.com/bytecodealliance/wasmtime/blob/main/.github/subscribe-to-label.json">labeling bot</a> you'd get auto-cc'd on any PRs related to a major version bump</p>
</blockquote>



<a name="277754052"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277754052" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277754052">(Apr 04 2022 at 16:05)</a>:</h4>
<p>bnjbvr <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1087741835">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>Confirming that we still do have some nightly CI job running the test suite (using the checked-in scripts) every day, using the latest commit on main at the time of running the CI job. <a href="https://buildkite.com/embark-studios/wasmtime-aarch64-apple-darwin/builds?branch=main">Results are public</a>, but only we at Embark Studios can start jobs etc.</p>
</blockquote>



<a name="277813068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277813068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277813068">(Apr 05 2022 at 00:37)</a>:</h4>
<p>ricochet <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1088153188">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>That's fantastic. Then this might be ready to merge? I added a reference to embark's CI so that it will be part of the initial PR for releases.</p>
</blockquote>



<a name="277886543"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/277886543" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#277886543">(Apr 05 2022 at 14:25)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1088774251">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>Oh I think CI is still failing on this, the <code>build-tarballs.sh</code> script needs an update to use the right path to the artifacts (right now it assumes <code>target/release/*</code> since macOS previously didn't cross-compile but now it's sometimes in <code>target/aarch64-apple-darwin/release/*</code>)</p>
</blockquote>



<a name="278072230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/278072230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#278072230">(Apr 06 2022 at 19:14)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1090663311">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<p>I think the matrix entry for the test build may have snuck back in? Otherwise though the script changes look good to me, thanks!</p>
<p>To double-check, can you confirm the release <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/21038406010">on this page</a> works locally for you? <a href="https://github.com/bytecodealliance/wasmtime/suites/5958536883/artifacts/204640148">This should be the direct link there</a></p>
</blockquote>



<a name="278088724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233983%20Add%20m1%20to%20build%20matrix%20and%20release/near/278088724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233983.20Add.20m1.20to.20build.20matrix.20and.20release.html#278088724">(Apr 06 2022 at 21:28)</a>:</h4>
<p>ricochet <a href="https://github.com/bytecodealliance/wasmtime/pull/3983#issuecomment-1090826207">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/3983">issue #3983</a>:</p>
<blockquote>
<blockquote>
<p>I think the matrix entry for the test build may have snuck back in? Otherwise though the script changes look good to me, thanks!</p>
</blockquote>
<p>Ack!</p>
<blockquote>
<p>To double-check, can you confirm the release <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/21038406010">on this page</a> works locally for you? <a href="https://github.com/bytecodealliance/wasmtime/suites/5958536883/artifacts/204640148">This should be the direct link there</a></p>
</blockquote>
<p>LGTM tried the example and ran a compile on one of my wasm modules.</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>./wasmtime --version
wasmtime <span class="m">0</span>.37.0
</code></pre></div>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>