<html>
<head><meta charset="utf-8"><title>wasmtime / PR #4107 Don&#x27;t make a value label range smalle... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234107.20Don.27t.20make.20a.20value.20label.20range.20smalle.2E.2E.2E.html">wasmtime / PR #4107 Don&#x27;t make a value label range smalle...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="281419458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234107%20Don%27t%20make%20a%20value%20label%20range%20smalle.../near/281419458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234107.20Don.27t.20make.20a.20value.20label.20range.20smalle.2E.2E.2E.html#281419458">(May 06 2022 at 10:20)</a>:</h4>
<p>bnjbvr opened <a href="https://github.com/bytecodealliance/wasmtime/pull/4107">PR #4107</a> from <code>fix-value-label-range</code> to <code>release-0.36.0</code>:</p>
<blockquote>
<p>I see this code has disappeared from <code>main</code> with the port to regalloc2,<br>
but it seems there was a bug affecting 0.36.0 (and previous versions)<br>
where the end of a range could end up being placed before the start of<br>
that range, triggering an assertion in <code>ValueLabelRangeBuilders::process_label</code> (<code>assert_lt!(range_start, range_end);</code>). I think the only way this could happen was that, during construction of these value label ranges, we'd<br>
"extend" a range with the new end of an instruction, but the end of that<br>
instruction is located before the end of the range we're overwriting, so we'd end up incorrectly "compressing" a value range to the left! The fix is quite simple and consists in taking the maximum value of the new end offset and the previous end offset, I think.</p>
<p>Upstreaming in case it's of interest to get a tiny dot release (or have this patch ride along other security fixes) for this in<br>
0.36.0, otherwise I can put it on an internal fork if preferred, as this<br>
is a real-world issue affecting our users who are trying to use debugging.</p>
</blockquote>



<a name="281729431"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%234107%20Don%27t%20make%20a%20value%20label%20range%20smalle.../near/281729431" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.234107.20Don.27t.20make.20a.20value.20label.20range.20smalle.2E.2E.2E.html#281729431">(May 09 2022 at 18:55)</a>:</h4>
<p>bnjbvr closed without merge <a href="https://github.com/bytecodealliance/wasmtime/pull/4107">PR #4107</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>