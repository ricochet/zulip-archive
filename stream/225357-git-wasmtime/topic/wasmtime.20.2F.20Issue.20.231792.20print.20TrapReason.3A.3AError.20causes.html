<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1792 print TrapReason::Error causes · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html">wasmtime / Issue #1792 print TrapReason::Error causes</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="199227796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199227796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199227796">(May 30 2020 at 00:22)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636245544">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>This is actually intentional I believe that <code>Display for T</code> where <code>T: Error</code> should only print one "stack frame" of error. The full backtrace of errors (causes) should be printed elsewhere. The connection via <code>fn source</code> should cause other libraries, like <code>anyhow</code> print the full list of causes. Could you elaborate a bit on how this came up for you?</p>
</blockquote>



<a name="199228760"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199228760" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199228760">(May 30 2020 at 00:40)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636248331">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @peterhuene</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>peterhuene: wasmtime:api</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="199228769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199228769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199228769">(May 30 2020 at 00:40)</a>:</h4>
<p>leoyvens <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636248364">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>@alexcrichton It didn't actually come up for me, but I think the full information is what we want in the context of this impl. The only use of this <code>Display</code> impl is here <a href="https://github.com/bytecodealliance/wasmtime/blob/master/crates/wasmtime/src/trap.rs#L190">https://github.com/bytecodealliance/wasmtime/blob/master/crates/wasmtime/src/trap.rs#L190</a> where we proceed to print the full WASM backtrace, and therefore are probably also interested in the full list of causes. It might be clearer if this <code>Display</code> impl was removed and inlined there.</p>
</blockquote>



<a name="199380611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199380611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199380611">(Jun 01 2020 at 15:11)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636914568">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>The purpose of <code>Display</code> for each error in the backtrace of errors is to print just that specific error. Part of wasm errors is the wasm callstack, so they're printed with wasm traps. Idiomatic error handling in Rust would not work if <code>Trap</code> printed out its own backtrace of errors, because then it would be incompatible with crates like <code>anyhow</code> which assume errors don't do that.</p>
</blockquote>



<a name="199382093"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199382093" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199382093">(Jun 01 2020 at 15:22)</a>:</h4>
<p>leoyvens <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636920222">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>@alexcrichton I think I get it, so if I want to print causes, I should do something like:</p>
<div class="codehilite"><pre><span></span><code>format!(&quot;{:#}&quot;, anyhow::Error::from(trap));
</code></pre></div>


<p>And we don't want that to print the causes twice.</p>
<p>Would it make sense to support <code>{:#}</code> directly in the <code>Display</code> for <code>TrapReason</code> and  <code>Trap</code>, as convenience so this can be just <code>format!("{:#}", trap)</code>.</p>
</blockquote>



<a name="199382263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199382263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199382263">(Jun 01 2020 at 15:23)</a>:</h4>
<p>leoyvens edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636920222">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>@alexcrichton I think I get it, so if I want to print causes, I should do something like:</p>
<div class="codehilite"><pre><span></span><code>format!(&quot;{:#}&quot;, anyhow::Error::from(trap));
</code></pre></div>


<p>And we don't want that to print the causes twice.</p>
<p>Would it make sense to support <code>{:#}</code> directly in the <code>Display</code> for <code>TrapReason</code> and  <code>Trap</code>, as convenience so this can be just <code>format!("{:#}", trap)</code>?</p>
</blockquote>



<a name="199385974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199385974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199385974">(Jun 01 2020 at 15:53)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636936254">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>AFAIK most types implementing <code>Error</code> do not support the ability to print their full backtrace. To do that you need to either write your own function or use a catch-all error type like <code>anyhow::Error</code> which explicitly has support for this (or convert to <code>Box&lt;Error + ...&gt;</code>)</p>
</blockquote>



<a name="199389406"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231792%20print%20TrapReason%3A%3AError%20causes/near/199389406" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231792.20print.20TrapReason.3A.3AError.20causes.html#199389406">(Jun 01 2020 at 16:19)</a>:</h4>
<p>leoyvens <a href="https://github.com/bytecodealliance/wasmtime/pull/1792#issuecomment-636964733">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/1792">Issue #1792</a>:</p>
<blockquote>
<p>Alright, closing this then, thanks for the explanations.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>