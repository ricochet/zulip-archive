<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6358 winch: Implement new trampolines · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html">wasmtime / issue #6358 winch: Implement new trampolines</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="356990227"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/356990227" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#356990227">(May 09 2023 at 13:46)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1540158695">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @saulecabrera</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "winch"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>saulecabrera: winch</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="357012502"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/357012502" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#357012502">(May 09 2023 at 15:01)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1540316561">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<p>Random thought about pinned registers -- while this isn't a problem for winch yet the final set of trampolines are the libcall trampolines which enter the runtime for instructions like <code>memory.grow</code>. These trampolines are still handwritten asm and don't come from Cranelift, and they don't handle anything about pinned registers and such at this time. Not to say they couldn't, just something to keep in mind.</p>
</blockquote>



<a name="358566673"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358566673" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358566673">(May 15 2023 at 20:37)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1548539899">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<p>@alexcrichton I've addressed all of your comments; I think this is ready for another pass. I've opted to leave the translation between <code>ptr_size &lt;&gt; ValType</code> as a TODO for now. </p>
<p>Regarding your other comments, I've introduced <code>wasmtime-environ</code> as a dependency to <code>winch-codegen</code> as discussed during our last meeting, which allows for a direct usage of  <code>VMOffsets</code> and <code>FooIndex</code> types across trampolines. After this PR lands, I'll update the other pre-existing code that uses <code>winch_environ::FuncEnv</code>. </p>
</blockquote>



<a name="358567037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358567037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358567037">(May 15 2023 at 20:39)</a>:</h4>
<p>saulecabrera edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1548539899">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<p>@alexcrichton I've addressed all of your comments; I think this is ready for another pass. I've opted to leave the translation between <code>ptr_size &lt;&gt; ValType</code> as a TODO for now. </p>
<p>Regarding your other comments, I've introduced <code>wasmtime-environ</code> as a dependency to <code>winch-codegen</code> as discussed during our last meeting, which allows for a direct usage of  <code>VMOffsets</code> and <code>FooIndex</code> types across trampolines. After this PR lands, I'll update the other pre-existing code that uses <code>winch_environ::FuncEnv</code>. <br>
</p>
</blockquote>



<a name="358571025"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358571025" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358571025">(May 15 2023 at 21:05)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1548577183">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<p>I'm not exactly sure why the MIRI check is failing.</p>
</blockquote>



<a name="358725856"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358725856" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358725856">(May 16 2023 at 13:08)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1549639305">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<blockquote>
<p>I'm not exactly sure why the MIRI check is failing.</p>
</blockquote>
<p>I realized that all the other tests are ignoring miri, so I applied the same attribute to Winch's tests. </p>
</blockquote>



<a name="358783477"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358783477" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358783477">(May 16 2023 at 16:19)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1549982165">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<p>Agreed; @cfallin, added you as a reviewer, let me know if you have any thoughts!</p>
</blockquote>



<a name="358784475"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358784475" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358784475">(May 16 2023 at 16:23)</a>:</h4>
<p>saulecabrera edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1549982165">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<p>Agreed; @cfallin, re-added you as a reviewer, let me know if you have any thoughts!</p>
</blockquote>



<a name="358798707"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236358%20winch%3A%20Implement%20new%20trampolines/near/358798707" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236358.20winch.3A.20Implement.20new.20trampolines.html#358798707">(May 16 2023 at 17:15)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/6358#issuecomment-1550066097">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6358">issue #6358</a>:</p>
<blockquote>
<blockquote>
<p>Agreed; @cfallin, re-added you as a reviewer, let me know if you have any thoughts!</p>
</blockquote>
<p>Yep, I'll take a look now!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>