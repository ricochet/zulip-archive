<html>
<head><meta charset="utf-8"><title>wasmtime / issue #4659 Cranelift: disallow marking entry ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234659.20Cranelift.3A.20disallow.20marking.20entry.20.2E.2E.2E.html">wasmtime / issue #4659 Cranelift: disallow marking entry ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="292632485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234659%20Cranelift%3A%20disallow%20marking%20entry%20.../near/292632485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234659.20Cranelift.3A.20disallow.20marking.20entry.20.2E.2E.2E.html#292632485">(Aug 09 2022 at 18:23)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/pull/4659#issuecomment-1209722602">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4659">issue #4659</a>:</p>
<blockquote>
<blockquote>
<p>This is a nonsensical constraint: the entry block must come first in the<br>
compiled code's layout, so it cannot also be sunk to the end of the<br>
function.</p>
</blockquote>
<p>If you want to mark all blocks calling a cold function as cold, you did have to special case the entry block if the entry block isn't allowed to be cold. cg_clif just barely avoids this issue as the first codegened MIR basic block corresponds to the second Cranelift basic block as the entry block only handles storing arguments in the right location.</p>
</blockquote>



<a name="292637134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%234659%20Cranelift%3A%20disallow%20marking%20entry%20.../near/292637134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.234659.20Cranelift.3A.20disallow.20marking.20entry.20.2E.2E.2E.html#292637134">(Aug 09 2022 at 18:51)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/4659#issuecomment-1209755973">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/4659">issue #4659</a>:</p>
<blockquote>
<p>That's a fair point, but it still seems like a reasonable thing for a producer to have to ensure, IMHO; the only way it could be valid would be if the entire function body is marked cold, and that doesn't make sense (cold compared to what?).</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>