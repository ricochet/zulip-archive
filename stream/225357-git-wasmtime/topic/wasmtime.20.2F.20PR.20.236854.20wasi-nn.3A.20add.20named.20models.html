<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6854 wasi-nn: add named models · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html">wasmtime / PR #6854 wasi-nn: add named models</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="385569010"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569010" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569010">(Aug 17 2023 at 00:50)</a>:</h4>
<p>abrown opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a> from <code>abrown:registries</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This implements named models in Wasmtime; see the commit messages for more details.</p>
</blockquote>



<a name="385569012"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569012" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569012">(Aug 17 2023 at 00:50)</a>:</h4>
<p><strong>abrown</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="385569013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569013">(Aug 17 2023 at 00:50)</a>:</h4>
<p><strong>abrown</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="385569014"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569014" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569014">(Aug 17 2023 at 00:50)</a>:</h4>
<p><strong>abrown</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="385569026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569026">(Aug 17 2023 at 00:50)</a>:</h4>
<p><strong>abrown</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="385569976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569976">(Aug 17 2023 at 00:56)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1581613757">PR review</a>.</p>



<a name="385569978"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385569978" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385569978">(Aug 17 2023 at 00:56)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1296568358">PR review comment</a>:</p>
<blockquote>
<p>I'm not quite happy with using this script for testing. It was good initially to get things working but I would prefer to be using <code>cargo test</code> instead. The problem is that there is a dependency expectation: this can only run if the system has OpenVINO installed, which will not always be the case for developers running <code>cargo test</code>.</p>
<p>I can think of two workarounds:</p>
<ul>
<li><code>#[ignore]</code> the OpenVINO-specific tests and add some comments telling developers to turn them on to fully test the system</li>
<li>add some checks at the beginning of each test to early-exit if OpenVINO is not available; the issue with this is that users may see "false success" if something goes wrong in the environment, so perhaps a <code>FORCE_RUN_OPENVINO_TESTS</code> env variable is necessary?</li>
</ul>
<p>Interested in some feedback on whether one of those approaches is better than this script!</p>
</blockquote>



<a name="385713139"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385713139" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385713139">(Aug 17 2023 at 16:36)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1583022334">PR review</a>.</p>



<a name="385713140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385713140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385713140">(Aug 17 2023 at 16:36)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1297474006">PR review comment</a>:</p>
<blockquote>
<p>Another thing I'm not quite sure of is whether this should return <code>Option&lt;&amp;mut Graph&gt;</code>, <code>Option&lt;&amp;Graph&gt;</code>, or even <code>Option&lt;Graph&gt;</code> (seeing as how <code>Graph</code> is just an <code>Arc</code>-wrapper). We immediately clone the graph and I removed the mutability requirement for <code>BackendGraph::init_execution_context</code>... @geekbeast , any opinions from implementing other kinds of <code>GraphRegistry</code>?</p>
</blockquote>



<a name="385713185"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385713185" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385713185">(Aug 17 2023 at 16:36)</a>:</h4>
<p>abrown edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1297474006">PR review comment</a>.</p>



<a name="385987997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385987997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385987997">(Aug 18 2023 at 20:57)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1585214670">PR review</a>.</p>



<a name="385987998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/385987998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#385987998">(Aug 18 2023 at 20:57)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1298860511">PR review comment</a>:</p>
<blockquote>
<p>Personally I like your second suggestion and matches what I was going to suggest as well. We do run a higher risk of not actually running the tests in CI but I think running something by default as part of <code>cargo test --workspace</code> is a good mitigating factor for that.</p>
</blockquote>



<a name="386169908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386169908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386169908">(Aug 20 2023 at 01:40)</a>:</h4>
<p>geekbeast submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1585773054">PR review</a>.</p>



<a name="386169910"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386169910" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386169910">(Aug 20 2023 at 01:40)</a>:</h4>
<p>geekbeast created <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1299287269">PR review comment</a>:</p>
<blockquote>
<p>If the tests are for wasi-nn, we should just have a test backend that does something basic like an affine layer. </p>
<p>If this is testing integration we should think about how we handle multiple backends. This same issue will come up with pytorch, onnxruntime, tf, etc. </p>
</blockquote>



<a name="386653127"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386653127" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386653127">(Aug 22 2023 at 16:46)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1589909288">PR review</a>.</p>



<a name="386653129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386653129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386653129">(Aug 22 2023 at 16:46)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1301930202">PR review comment</a>:</p>
<blockquote>
<p>@alexcrichton, I have a whole other set of commits ready for switching to that kind of testing. Just waiting on a review of this one because the new testing also covers the <code>load_by_name</code> logic added here.</p>
</blockquote>



<a name="386677937"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386677937" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386677937">(Aug 22 2023 at 19:17)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1590164421">PR review</a>:</p>
<blockquote>
<p>I can't review the wasi-nn stuff specifically really, it all seems reasonable though. The <code>src/commands/run.rs</code> bits look good to me, although I might recommend renaming <code>--graph</code> to something like <code>--wasi-nn-graph</code> or <code>--nn-graph</code> or something like that perhaps to make it a bit more clear it's for wasi-nn as opposed to something else graph-related (not that we have much else like that right now)</p>
</blockquote>



<a name="386710367"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386710367" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386710367">(Aug 22 2023 at 23:15)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="386711321"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386711321" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386711321">(Aug 22 2023 at 23:26)</a>:</h4>
<p>abrown updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="386713026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386713026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386713026">(Aug 22 2023 at 23:46)</a>:</h4>
<p>abrown has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="386721981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386721981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386721981">(Aug 23 2023 at 00:55)</a>:</h4>
<p>abrown merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6854">PR #6854</a>.</p>



<a name="386960000"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386960000" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386960000">(Aug 23 2023 at 22:40)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#pullrequestreview-1592513612">PR review</a>.</p>



<a name="386960001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236854%20wasi-nn%3A%20add%20named%20models/near/386960001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236854.20wasi-nn.3A.20add.20named.20models.html#386960001">(Aug 23 2023 at 22:40)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/6854#discussion_r1303613013">PR review comment</a>:</p>
<blockquote>
<p>Ok, check out <a href="https://github.com/bytecodealliance/wasmtime/pull/6895">https://github.com/bytecodealliance/wasmtime/pull/6895</a> if you're interested in where I went with this.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>