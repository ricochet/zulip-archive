<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3721 Cranelift: ARM32 backend: active m... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html">wasmtime / issue #3721 Cranelift: ARM32 backend: active m...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="269171499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/269171499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#269171499">(Jan 24 2022 at 20:56)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>In the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/meetings/cranelift/2022/cranelift-01-24.md">Cranelift biweekly</a> today, we discussed the ARM32 backend and how to handle it with respect to our ISLE transition, and maintenance / breaking changes in internal APIs in general.</p>
<p>The current state of the ARM32 backend is incomplete: it supports 32-bit code, but panics on any 64-bit operation, so it does not yet support (for example) Wasm-MVP with the <code>cranelift-wasm</code> frontend, nor would it support most code generated by <code>cg_clif</code>. The intent when merging the partial backend was to allow it to mature in-tree with further contributions. However, that hasn't materialized in the year or so since merging.</p>
<p>We have made changes as needed to keep it compiling, but there is a larger question of what happens to an incomplete backend with no active maintainers or users, especially if it implies more significant amounts of work. With our ISLE DSL transition, we would need to invest nontrivial time to move the backend over; and the upcoming regalloc2 transition would require more effort as well.</p>
<p>It seems reasonable to ask: if the backend is incomplete, and no one is using or maintaining it, should we remove it instead? Consensus in our meeting today was that this seems reasonable. However, if anyone would like to work toward a usable and maintained ARM32 backend, now is the time to step forward!</p>
<p>Thoughts?</p>
</blockquote>



<a name="269469167"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/269469167" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#269469167">(Jan 26 2022 at 19:37)</a>:</h4>
<p>akirilov-arm labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>In the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/meetings/cranelift/2022/cranelift-01-24.md">Cranelift biweekly</a> today, we discussed the ARM32 backend and how to handle it with respect to our ISLE transition, and maintenance / breaking changes in internal APIs in general.</p>
<p>The current state of the ARM32 backend is incomplete: it supports 32-bit code, but panics on any 64-bit operation, so it does not yet support (for example) Wasm-MVP with the <code>cranelift-wasm</code> frontend, nor would it support most code generated by <code>cg_clif</code>. The intent when merging the partial backend was to allow it to mature in-tree with further contributions. However, that hasn't materialized in the year or so since merging.</p>
<p>We have made changes as needed to keep it compiling, but there is a larger question of what happens to an incomplete backend with no active maintainers or users, especially if it implies more significant amounts of work. With our ISLE DSL transition, we would need to invest nontrivial time to move the backend over; and the upcoming regalloc2 transition would require more effort as well.</p>
<p>It seems reasonable to ask: if the backend is incomplete, and no one is using or maintaining it, should we remove it instead? Consensus in our meeting today was that this seems reasonable. However, if anyone would like to work toward a usable and maintained ARM32 backend, now is the time to step forward!</p>
<p>Thoughts?</p>
</blockquote>



<a name="269469168"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/269469168" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#269469168">(Jan 26 2022 at 19:37)</a>:</h4>
<p>akirilov-arm labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>In the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/meetings/cranelift/2022/cranelift-01-24.md">Cranelift biweekly</a> today, we discussed the ARM32 backend and how to handle it with respect to our ISLE transition, and maintenance / breaking changes in internal APIs in general.</p>
<p>The current state of the ARM32 backend is incomplete: it supports 32-bit code, but panics on any 64-bit operation, so it does not yet support (for example) Wasm-MVP with the <code>cranelift-wasm</code> frontend, nor would it support most code generated by <code>cg_clif</code>. The intent when merging the partial backend was to allow it to mature in-tree with further contributions. However, that hasn't materialized in the year or so since merging.</p>
<p>We have made changes as needed to keep it compiling, but there is a larger question of what happens to an incomplete backend with no active maintainers or users, especially if it implies more significant amounts of work. With our ISLE DSL transition, we would need to invest nontrivial time to move the backend over; and the upcoming regalloc2 transition would require more effort as well.</p>
<p>It seems reasonable to ask: if the backend is incomplete, and no one is using or maintaining it, should we remove it instead? Consensus in our meeting today was that this seems reasonable. However, if anyone would like to work toward a usable and maintained ARM32 backend, now is the time to step forward!</p>
<p>Thoughts?</p>
</blockquote>



<a name="269610608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/269610608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#269610608">(Jan 27 2022 at 17:50)</a>:</h4>
<p>posborne <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1023489327">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>Hi @cfallin, I understand the situation you and the maintainers are in.  We are not currently a user of wasmtime/cranelift on arm32 but we have been evaluating projects to potentially target wasm via wasmtime on our fleet of IoT hubs.  To consider use of wasmtime/cranelift, arm32 support is a must as we continue to support software updates for a very large number of products using arm32 (in addition to products based on aarch64/x86_64/etc.) and would guess that this is true for other potential users in this space.  Thus far, one of the reasons we have not yet built solutions around wasm is the lack of arm32 support which we had hoped would be something that would get love from ARM or others.</p>
<p>I will reach out to some of my contacts within the broader Samsung org to see if we are currently in a position to provide any assistance; I do feel that if IoT is in fact an area where we would like wasmtime/cranelift to be applicable along with the goal of providing a portable bytecode that arm32 support is a critical feature.</p>
</blockquote>



<a name="269614724"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/269614724" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#269614724">(Jan 27 2022 at 18:14)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1023510178">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>@posborne -- hello and thanks for helping out here!</p>
<p>For context, I think it would probably take 1-2 months of full-time work by a compiler engineer to bring the current incomplete arm32 backend up to a working state where it supports Wasm, and would need ongoing engagement by someone who would address bugs, keep the backend up-to-date wrt other refactors, etc.</p>
<p>We also are reaching a point where we'll need to do <em>something</em> soon, as we have ongoing efforts to update the architecture-independent bits of the compiler (e.g. the register allocator) and an unmaintained backend becomes a blocker for those. So, if someone were to jump in and adopt the arm32 backend, it would need to be somewhat soon.</p>
<p>I don't doubt the value of arm32 at all, and all else being equal, would love to have full and complete support for it! It's really just a matter of resources. And, it's worth mentioning that if we do end up removing it from the tree now, someone would always be welcome to step in, grab the old source from git history as a starting point, and bring it up to date, then contribute it, as long as there is a reasonable ongoing-maintenance story.</p>
</blockquote>



<a name="269655610"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/269655610" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#269655610">(Jan 27 2022 at 23:17)</a>:</h4>
<p>posborne <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1023729055">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>@cfallin Thank you for the context; I think we're on the same page and, unfortunately, don't think we'll have the resources available to help in the near term so I think the plan to remove the half-baked arm32 for now makes sense (though I have still reached out to confirm).  I just wanted to make sure we expressed our interest in targeting arm32 but also appreciate the need to move the project forward.</p>
</blockquote>



<a name="270715490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/270715490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#270715490">(Feb 04 2022 at 13:39)</a>:</h4>
<p>sparker-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1029994303">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>A smaller issue, but isn't cranelift's ABI also currently hard-coded for 64-bit architectures only?</p>
<p>Either way, an unmaintained (and unusable?) backend seems like quite a burden for a project that wants to change.</p>
</blockquote>



<a name="270736299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/270736299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#270736299">(Feb 04 2022 at 16:13)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1030133487">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>@posborne Is your IoT use case based on M profile cores (e.g. Cortex-M4) or A profile ones (such as Cortex-A53)?</p>
</blockquote>



<a name="270928296"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/270928296" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#270928296">(Feb 07 2022 at 03:28)</a>:</h4>
<p>posborne <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1031036368">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<blockquote>
<p>@posborne Is your IoT use case based on M profile cores (e.g. Cortex-M4) or A profile ones (such as Cortex-A53)?</p>
</blockquote>
<p>We target a variety of application processors running embedded Linux in addition to targets running Android or Tizen.  The two targets with greatest volume in production are the NXP IMX6UL and IMX6ULL which are both Cortex-A7 (we also target several aarch64 based processors).  We don't currently have any integrations on MIPS or RISC-V but both of those have come up as possibilities at different points in time. </p>
</blockquote>



<a name="271603834"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/271603834" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#271603834">(Feb 11 2022 at 16:50)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/3721#issuecomment-1036408916">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>OK, so definitely the A profile.</p>
<p>The reason I am asking is that while it is feasible to add support for the M profile to Cranelift (since it is mostly just a code generator), it would be a challenge to do the same to Wasmtime because the latter depends on a full-featured operating system like Linux (that provides mechanisms such as <code>mmap()</code>); the M profile processors have difficulties supporting environments of that kind (given that they lack memory management units, among other limitations). This is somewhat similar to <a href="https://docs.wasmtime.dev/stability-platform-support.html#what-about-no_std">supporting <code>#[no_std]</code></a>.</p>
</blockquote>



<a name="271902336"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233721%20Cranelift%3A%20ARM32%20backend%3A%20active%20m.../near/271902336" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233721.20Cranelift.3A.20ARM32.20backend.3A.20active.20m.2E.2E.2E.html#271902336">(Feb 14 2022 at 23:03)</a>:</h4>
<p>cfallin closed <a href="https://github.com/bytecodealliance/wasmtime/issues/3721">issue #3721</a>:</p>
<blockquote>
<p>In the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/meetings/cranelift/2022/cranelift-01-24.md">Cranelift biweekly</a> today, we discussed the ARM32 backend and how to handle it with respect to our ISLE transition, and maintenance / breaking changes in internal APIs in general.</p>
<p>The current state of the ARM32 backend is incomplete: it supports 32-bit code, but panics on any 64-bit operation, so it does not yet support (for example) Wasm-MVP with the <code>cranelift-wasm</code> frontend, nor would it support most code generated by <code>cg_clif</code>. The intent when merging the partial backend was to allow it to mature in-tree with further contributions. However, that hasn't materialized in the year or so since merging.</p>
<p>We have made changes as needed to keep it compiling, but there is a larger question of what happens to an incomplete backend with no active maintainers or users, especially if it implies more significant amounts of work. With our ISLE DSL transition, we would need to invest nontrivial time to move the backend over; and the upcoming regalloc2 transition would require more effort as well.</p>
<p>It seems reasonable to ask: if the backend is incomplete, and no one is using or maintaining it, should we remove it instead? Consensus in our meeting today was that this seems reasonable. However, if anyone would like to work toward a usable and maintained ARM32 backend, now is the time to step forward!</p>
<p>Thoughts?</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>