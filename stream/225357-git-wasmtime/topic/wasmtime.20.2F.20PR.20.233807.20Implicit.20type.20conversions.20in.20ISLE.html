<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3807 Implicit type conversions in ISLE · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html">wasmtime / PR #3807 Implicit type conversions in ISLE</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="272873292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272873292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272873292">(Feb 22 2022 at 22:07)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/3807">PR #3807</a> from <code>isle-implicit-conversions</code> to <code>main</code>:</p>
<blockquote>
<p>An initial sketch of the ISLE compiler implementation for implicit type conversions (#3753). I can clean it up a bit but this is the general shape at least.</p>
<p>Two implementation bits: (i) I opted to add conversions as their own IR node type, rather than try lowering these to extractors/constructors to share that code, as the operations are just a tiny bit different (not associated with a term, for example); and (ii) there is the option to denote a converter as returning a borrow or a value -- the former is useful in patterns, the latter may be necessary if the converted value does not already exist inside the original or in the context, and we also always clone to a value when in the right-hand side to avoid holding a borrow on the mut context.</p>
<p>I'll work a bit further ahead by trying to use this to simplify some of the lowering rules, to make sure it actually works as we hope it will (but any such use will be merged by a later PR).</p>
<p>cc @fitzgen for thoughts?</p>
</blockquote>



<a name="272874727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272874727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272874727">(Feb 22 2022 at 22:19)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3807">PR #3807</a> from <code>isle-implicit-conversions</code> to <code>main</code>.</p>



<a name="272995791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995791">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891514672">PR review</a>.</p>



<a name="272995793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995793">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813201821">PR review comment</a>:</p>
<blockquote>
<p>Thanks <em>so</em> much for writing these tests! &lt;3</p>
</blockquote>



<a name="272995794"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995794" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995794">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813193970">PR review comment</a>:</p>
<blockquote>
<p>nitpick: missing trailing newline. and since I'm here, "for unit tests only" is kinda redundant since that is what <code>dev-dependencies</code> effectively are already.</p>
</blockquote>



<a name="272995795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995795">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813190465">PR review comment</a>:</p>
<blockquote>
<p>Or just manually factor out the conversions into a single conversion with a <code>let</code>.</p>
<p>Bringing up CSE here is opening up more questions about implementation and how we guarantee that this is actually semantics-preserving than it answers in my mind, so sort of seems like a distraction from what is otherwise prescriptive documentation.</p>
</blockquote>



<a name="272995796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995796">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813210420">PR review comment</a>:</p>
<blockquote>
<p>Can we have tests for when</p>
<ul>
<li>the term is defined and has a constructor, but the conversion is in extractor position (and the term does not have an extractor)</li>
<li>vice versa with constructor position</li>
</ul>
</blockquote>



<a name="272995797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995797">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813219751">PR review comment</a>:</p>
<blockquote>
<p>Package this up into a helper function like you've done for the exprs?</p>
</blockquote>



<a name="272995798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/272995798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#272995798">(Feb 23 2022 at 19:00)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891514672">PR review</a>.</p>



<a name="273002839"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002839" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002839">(Feb 23 2022 at 19:55)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3807">PR #3807</a> from <code>isle-implicit-conversions</code> to <code>main</code>.</p>



<a name="273002960"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002960" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002960">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891607795">PR review</a>.</p>



<a name="273002962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002962">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813265995">PR review comment</a>:</p>
<blockquote>
<p>Done!</p>
</blockquote>



<a name="273002981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002981">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891607907">PR review</a>.</p>



<a name="273002982"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002982" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002982">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813266083">PR review comment</a>:</p>
<blockquote>
<p>Added!</p>
</blockquote>



<a name="273002996"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002996" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002996">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891608099">PR review</a>.</p>



<a name="273002997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273002997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273002997">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813266218">PR review comment</a>:</p>
<blockquote>
<p>Yup, I'm glad we have them now!</p>
</blockquote>



<a name="273003009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273003009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273003009">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891608203">PR review</a>.</p>



<a name="273003011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273003011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273003011">(Feb 23 2022 at 19:56)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813266287">PR review comment</a>:</p>
<blockquote>
<p>Fixed!</p>
</blockquote>



<a name="273003062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273003062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273003062">(Feb 23 2022 at 19:57)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#pullrequestreview-891608660">PR review</a>.</p>



<a name="273003063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273003063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273003063">(Feb 23 2022 at 19:57)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/3807#discussion_r813266637">PR review comment</a>:</p>
<blockquote>
<p>Good point, just removed this parenthetical for now; we can work out the details and document appropriately if/when we need to do this.</p>
</blockquote>



<a name="273004335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273004335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273004335">(Feb 23 2022 at 20:06)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3807">PR #3807</a> from <code>isle-implicit-conversions</code> to <code>main</code>.</p>



<a name="273005372"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273005372" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273005372">(Feb 23 2022 at 20:15)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3807">PR #3807</a> from <code>isle-implicit-conversions</code> to <code>main</code>.</p>



<a name="273012455"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233807%20Implicit%20type%20conversions%20in%20ISLE/near/273012455" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233807.20Implicit.20type.20conversions.20in.20ISLE.html#273012455">(Feb 23 2022 at 21:15)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3807">PR #3807</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>