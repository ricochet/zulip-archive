<html>
<head><meta charset="utf-8"><title>wasmtime / PR #2226 machinst x64: enable CLIF testing · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html">wasmtime / PR #2226 machinst x64: enable CLIF testing</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="211149674"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211149674" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211149674">(Sep 24 2020 at 15:41)</a>:</h4>
<p>bnjbvr opened <a href="https://github.com/bytecodealliance/wasmtime/pull/2226">PR #2226</a> from <code>x64-clif-testing</code> to <code>main</code>:</p>
<blockquote>
<p>This adds a new feature experimental_x64 for CLIF tests.</p>
<p>A test is run in the new x64 backend iff:</p>
<ul>
<li>
<p>either the test doesn't have an x86_64 target requirement, signaling<br>
it must be target agnostic or not run on this target.</p>
</li>
<li>
<p>or the test does require the x86_64 target, and the test is marked<br>
with the <code>experimental_x64</code> feature.</p>
</li>
</ul>
<p>This required one workaround in the parser. The reason is that the<br>
parser will try to use information not provided by the TargetIsa adapter<br>
for the Mach backends, like register names. In particular, parsing test<br>
may fail before the test runner realizes that the test must not be run.<br>
In this case, we early return an almost-empty TestFile from the parser,<br>
under the same conditions as above, so that the caller may filter out<br>
the test properly.</p>
<p>This also copies two tests from the test suite using the new backend,<br>
for demonstration purposes.</p>
</blockquote>



<a name="211176147"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211176147" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211176147">(Sep 24 2020 at 19:08)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#pullrequestreview-495870599">PR Review</a>.</p>



<a name="211176148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211176148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211176148">(Sep 24 2020 at 19:08)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#pullrequestreview-495870599">PR Review</a>.</p>



<a name="211176149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211176149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211176149">(Sep 24 2020 at 19:08)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#discussion_r494547055">PR Review Comment</a>:</p>
<blockquote>
<p>I would have expected these tests under <code>.../filetests/isa/x64</code>?</p>
</blockquote>



<a name="211176150"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211176150" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211176150">(Sep 24 2020 at 19:08)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#discussion_r494548515">PR Review Comment</a>:</p>
<blockquote>
<p>And looking at the <code>filetest</code> structure more closely, what do you think about a slight re-organization in a separate PR:</p>
<ul>
<li><code>filetests/vcode/*</code> get moved under <code>filetests/isa</code></li>
<li>move a bunch of the optimization directories under a new <code>filetests/opt</code><br>
I'm just thinking that finding where to put new tests is getting challenging.</li>
</ul>
</blockquote>



<a name="211176190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211176190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211176190">(Sep 24 2020 at 19:08)</a>:</h4>
<p>abrown edited <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#discussion_r494548515">PR Review Comment</a>.</p>



<a name="211176219"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211176219" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211176219">(Sep 24 2020 at 19:08)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#pullrequestreview-495870599">PR Review</a>.</p>



<a name="211230518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211230518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211230518">(Sep 25 2020 at 08:24)</a>:</h4>
<p>bnjbvr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#pullrequestreview-496211705">PR Review</a>.</p>



<a name="211230520"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211230520" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211230520">(Sep 25 2020 at 08:24)</a>:</h4>
<p>bnjbvr created <a href="https://github.com/bytecodealliance/wasmtime/pull/2226#discussion_r494828608">PR Review Comment</a>:</p>
<blockquote>
<p>I've moved them over to isa/x64; for the rest, I'm not sure what you mean by the optimization directories, so we could discuss it somewhere convenient.</p>
</blockquote>



<a name="211230579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211230579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211230579">(Sep 25 2020 at 08:25)</a>:</h4>
<p>bnjbvr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/2226">PR #2226</a> from <code>x64-clif-testing</code> to <code>main</code>:</p>
<blockquote>
<p>This adds a new feature experimental_x64 for CLIF tests.</p>
<p>A test is run in the new x64 backend iff:</p>
<ul>
<li>
<p>either the test doesn't have an x86_64 target requirement, signaling<br>
it must be target agnostic or not run on this target.</p>
</li>
<li>
<p>or the test does require the x86_64 target, and the test is marked<br>
with the <code>experimental_x64</code> feature.</p>
</li>
</ul>
<p>This required one workaround in the parser. The reason is that the<br>
parser will try to use information not provided by the TargetIsa adapter<br>
for the Mach backends, like register names. In particular, parsing test<br>
may fail before the test runner realizes that the test must not be run.<br>
In this case, we early return an almost-empty TestFile from the parser,<br>
under the same conditions as above, so that the caller may filter out<br>
the test properly.</p>
<p>This also copies two tests from the test suite using the new backend,<br>
for demonstration purposes.</p>
</blockquote>



<a name="211234384"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%232226%20machinst%20x64%3A%20enable%20CLIF%20testing/near/211234384" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.232226.20machinst.20x64.3A.20enable.20CLIF.20testing.html#211234384">(Sep 25 2020 at 09:12)</a>:</h4>
<p>bnjbvr merged <a href="https://github.com/bytecodealliance/wasmtime/pull/2226">PR #2226</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>