<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6691 Implement component model resources i... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html">wasmtime / PR #6691 Implement component model resources i...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="372684315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372684315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372684315">(Jul 05 2023 at 18:38)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a> from <code>alexcrichton:resources</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[ ] destructors</li>
<li>[ ] <code>(borrow $T)</code></li>
<li>[ ] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[ ] fill out all <code>/// TODO</code> documentation</li>
<li>[ ] Land and publish <code>wasm-tools</code> changes</li>
</ul>
</blockquote>



<a name="372721518"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372721518" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372721518">(Jul 05 2023 at 22:00)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1515418490">PR review</a>.</p>



<a name="372721519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372721519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372721519">(Jul 05 2023 at 22:00)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1515418490">PR review</a>.</p>



<a name="372721521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372721521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372721521">(Jul 05 2023 at 22:00)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1253684902">PR review comment</a>:</p>
<blockquote>
<p>This is probably not a huge optimization, but these two instructions to compute the new <code>rep</code> value can be emitted into <code>call_func_ref_block</code> instead so that they're not executed if there is no destructor.<br>
</p>
</blockquote>



<a name="372721522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372721522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372721522">(Jul 05 2023 at 22:00)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1253697391">PR review comment</a>:</p>
<blockquote>
<p>I'm curious why this code is checking for the function pointer being null, instead of testing the least significant bit of the value returned by <code>resource_drop</code>. Do we ever have a <code>Some</code> value with a null destructor pointer?</p>
</blockquote>



<a name="372725459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372725459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372725459">(Jul 05 2023 at 22:33)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="372725766"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372725766" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372725766">(Jul 05 2023 at 22:35)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1253721400">PR review comment</a>:</p>
<blockquote>
<p>Ah they end up being two different conditions. First is that <code>resource.drop</code> can be used to drop either own or borrow values, so the first check is basically "which did I drop?". The second check is "ok is there actually a destructor?". So a return value of 0 from the intrinsic means "you dropped a borrow do nothing else". Otherwise the return value is <code>(rep &lt;&lt; 1) | 1</code> where the destructor, if specified, is invoked with <code>rep</code>.</p>
<p>As I type this out though I realize that whether or not the destructor is specified is actually static so there's actually no need for a runtime check of the funcref, all that needs to be checked is the return value from the drop intrinsic to see if it's an own/borrow.</p>
</blockquote>



<a name="372726739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372726739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372726739">(Jul 05 2023 at 22:45)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="372730188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372730188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372730188">(Jul 05 2023 at 23:18)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[x] destructors</li>
<li>[ ] <code>(borrow $T)</code></li>
<li>[ ] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[ ] fill out all <code>/// TODO</code> documentation</li>
<li>[ ] Land and publish <code>wasm-tools</code> changes</li>
</ul>
</blockquote>



<a name="372766420"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372766420" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372766420">(Jul 06 2023 at 04:43)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="372940280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372940280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372940280">(Jul 06 2023 at 15:28)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="372978295"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372978295" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372978295">(Jul 06 2023 at 17:46)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="372995157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/372995157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#372995157">(Jul 06 2023 at 18:59)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="373017794"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/373017794" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#373017794">(Jul 06 2023 at 20:50)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1515481477">PR review</a>.</p>



<a name="373017796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/373017796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#373017796">(Jul 06 2023 at 20:50)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1515481477">PR review</a>.</p>



<a name="373017798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/373017798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#373017798">(Jul 06 2023 at 20:50)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1254875829">PR review comment</a>:</p>
<blockquote>
<p>Can this use <a href="https://doc.rust-lang.org/stable/std/ptr/struct.NonNull.html#method.cast"><code>NonNull::cast</code></a>?</p>
</blockquote>



<a name="373017799"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/373017799" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#373017799">(Jul 06 2023 at 20:50)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1254888027">PR review comment</a>:</p>
<blockquote>
<p>This comment should be updated to reflect its meaning.</p>
</blockquote>



<a name="373017800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/373017800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#373017800">(Jul 06 2023 at 20:50)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1253730463">PR review comment</a>:</p>
<blockquote>
<p>This comment about the null check is now out of date; it'd be good to mention what you said earlier about the type being known statically.</p>
</blockquote>



<a name="374077916"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374077916" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374077916">(Jul 10 2023 at 20:30)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374078225"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374078225" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374078225">(Jul 10 2023 at 20:32)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374078542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374078542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374078542">(Jul 10 2023 at 20:34)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374079595"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374079595" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374079595">(Jul 10 2023 at 20:40)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374085538"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374085538" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374085538">(Jul 10 2023 at 21:14)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374091491"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374091491" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374091491">(Jul 10 2023 at 21:53)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374327256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374327256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374327256">(Jul 11 2023 at 16:30)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374345450"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374345450" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374345450">(Jul 11 2023 at 17:43)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="374972657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/374972657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#374972657">(Jul 13 2023 at 15:26)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="375018398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375018398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375018398">(Jul 13 2023 at 18:03)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[x] destructors</li>
<li>[x] <code>(borrow $T)</code></li>
<li>[ ] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[ ] fill out all <code>/// TODO</code> documentation</li>
<li>[ ] Land and publish <code>wasm-tools</code> changes</li>
</ul>
</blockquote>



<a name="375018407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375018407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375018407">(Jul 13 2023 at 18:03)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[x] destructors</li>
<li>[x] <code>(borrow $T)</code></li>
<li>[x] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[ ] fill out all <code>/// TODO</code> documentation</li>
<li>[ ] Land and publish <code>wasm-tools</code> changes</li>
</ul>
</blockquote>



<a name="375018426"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375018426" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375018426">(Jul 13 2023 at 18:03)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[x] destructors</li>
<li>[x] <code>(borrow $T)</code></li>
<li>[x] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[ ] fill out all <code>/// TODO</code> documentation</li>
<li>[x] Land and publish <code>wasm-tools</code> changes</li>
</ul>
</blockquote>



<a name="375018500"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375018500" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375018500">(Jul 13 2023 at 18:03)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[x] destructors</li>
<li>[x] <code>(borrow $T)</code></li>
<li>[x] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[ ] fill out all <code>/// TODO</code> documentation</li>
<li>[x] Land and publish <code>wasm-tools</code> changes</li>
</ul>
<p>Closes #6583</p>
</blockquote>



<a name="375028628"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375028628" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375028628">(Jul 13 2023 at 18:40)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="375060339"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375060339" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375060339">(Jul 13 2023 at 20:58)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="375329205"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375329205" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375329205">(Jul 14 2023 at 16:51)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="375329240"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375329240" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375329240">(Jul 14 2023 at 16:51)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is a work-in-progress of implementing the resource type of the component model in Wasmtime. My goal at this time is to implement everything necessary to get <code>*.wast</code> and embedder API tests working. This has notable omissions which are deferred to a future PR:</p>
<ul>
<li>No support in <code>component::bindgen!</code></li>
<li>No support for component-to-component resources (fact compiler)</li>
</ul>
<p>Remaining items:</p>
<ul>
<li>[x] destructors</li>
<li>[x] <code>(borrow $T)</code></li>
<li>[x] probably more tests</li>
<li>[ ] rewrite this OP with more words</li>
<li>[x] fill out all <code>/// TODO</code> documentation</li>
<li>[x] Land and publish <code>wasm-tools</code> changes</li>
</ul>
<p>Closes #6583</p>
</blockquote>



<a name="375330851"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375330851" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375330851">(Jul 14 2023 at 16:57)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>:</p>
<blockquote>
<p>This PR is an implementation of the resource datatype in the component model <a href="https://github.com/webassembly/component-model">as specified upstream</a>. The goal of this PR is to get lots of the low-level infrastructure for resources sorted out, but not 100% of the story as there's still remaining work. Features implemented in this PR are:</p>
<ul>
<li>Validation, translation, and compilation of resources now works</li>
<li>Implementation of all resource-related intrinsics such as <code>resource.{rep,new,drop}</code></li>
<li>Updates to the compiled image of components as necessary for intrinsics</li>
<li>Implementation of runtime state of resources, aka tables, in component instances</li>
<li>Updates to type-checking and type-matching to take resources into account</li>
<li>Implementation of an embedding API for host-defined resources</li>
<li>Implementation of an embedding API for guest-defined resources</li>
<li>An initial suite of test which showcase basic behavior of resources and the capabilities of the embedding API</li>
</ul>
<p>This is intended to be a solid implementation for all the "internals" of resources throughout Wasmtime. It's expected that all further work will be much easier, less invasive, and not so large a scale. Or at least that's the hope. Note though that this is not a 100% complete story for resources in Wasmtime. For example it's still not possible to take a WIT off the shelf with resources and use that with Wasmtime. Key missing features in Wasmtime related to resources are:</p>
<ul>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/6722">https://github.com/bytecodealliance/wasmtime/issues/6722</a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/6696">https://github.com/bytecodealliance/wasmtime/issues/6696</a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/issues/6724">https://github.com/bytecodealliance/wasmtime/issues/6724</a></li>
</ul>
<p>This work is a prerequisite for the above, though, and the hope additionally is that the above can all start to progress in parallel with this work as a basis. Basically getting enough in that everything is no longer bottlenecked on me but it's possible to start building out from here.</p>
<p>Closes #6583</p>
</blockquote>



<a name="375330872"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375330872" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375330872">(Jul 14 2023 at 16:57)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="375330888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375330888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375330888">(Jul 14 2023 at 16:57)</a>:</h4>
<p><strong>alexcrichton</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a> as ready for review.</p>



<a name="375330891"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/375330891" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#375330891">(Jul 14 2023 at 16:57)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377380166"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380166" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380166">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1533760057">PR review</a>:</p>
<blockquote>
<p>r=me with nitpicks below</p>
</blockquote>



<a name="377380168"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380168" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380168">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1265944645">PR review comment</a>:</p>
<blockquote>
<p>This isn't just for transcodes, right? Outdated comment?</p>
</blockquote>



<a name="377380169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380169">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1265945031">PR review comment</a>:</p>
<blockquote>
<p>It would be nice to have an index newtype for libcalls.</p>
</blockquote>



<a name="377380170"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380170" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380170">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1533760057">PR review</a>:</p>
<blockquote>
<p>r=me with nitpicks below</p>
</blockquote>



<a name="377380171"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380171" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380171">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1265945191">PR review comment</a>:</p>
<blockquote>
<p>Can this be read only?</p>
</blockquote>



<a name="377380172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380172">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1265948425">PR review comment</a>:</p>
<blockquote>
<p>Copy paste comment needs to be inverted.</p>
</blockquote>



<a name="377380173"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380173" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380173">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1265945269">PR review comment</a>:</p>
<blockquote>
<p>This as well?</p>
</blockquote>



<a name="377380174"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380174" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380174">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1265939610">PR review comment</a>:</p>
<blockquote>
<p>Can we emit an assertion in the generated code for this when <code>cfg(debug_assertions)</code>?</p>
</blockquote>



<a name="377380175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380175">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270844608">PR review comment</a>:</p>
<blockquote>
<p>Can we make this branch <code>unreachable!()</code>?</p>
</blockquote>



<a name="377380177"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380177" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380177">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270854751">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>    /// definition which should refer to a resource itself.
</code></pre></div><br>
</p>
</blockquote>



<a name="377380178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380178">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270868526">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>    /// Unlike `resource_id_to_table_index` this is required to be eagerly
</code></pre></div><br>
</p>
</blockquote>



<a name="377380179"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380179" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380179">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270864876">PR review comment</a>:</p>
<blockquote>
<p>Sometimes "wasmparser" has backticks and sometimes it doesn't in this big doc comment. We should be consistent. I personally prefer backticks but this is obviously not a big deal.</p>
<p>(Thanks, btw, for writing this nice big doc comment!)</p>
</blockquote>



<a name="377380180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380180">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270865733">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>//! and then from then on purely talk about table indices. Each component
</code></pre></div><br>
</p>
</blockquote>



<a name="377380181"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380181" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380181">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270877472">PR review comment</a>:</p>
<blockquote>
<p>Copy-paste doc comment is misleading</p>
</blockquote>



<a name="377380182"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380182" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380182">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270862529">PR review comment</a>:</p>
<blockquote>
<p>Non-resource types are structural, not nominal, right?</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>//! such as `list`, `record`, and `string` are considered "structural" where two
//! types are considered equal if their components are equal. For example `(list
//! $a)` and `(list $b)` are the same if `$a` and `$b` are the same. Resources,
</code></pre></div><br>
</p>
</blockquote>



<a name="377380183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380183">(Jul 21 2023 at 17:40)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270863946">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>//! Given the subtlety here the goal is to lean on `wasmparser` as much as
</code></pre></div><br>
</p>
</blockquote>



<a name="377380184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380184">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270892700">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        // signature for `resource.drop` is mentioned somewhere, and if the
        // wasm-to-native trampoline for `resource.drop` hasn't been created yet
        // then insert that here. This is possibly required by destruction of
</code></pre></div><br>
</p>
</blockquote>



<a name="377380185"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380185" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380185">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270894054">PR review comment</a>:</p>
<blockquote>
<p>Not sure I am 100% following so take this with a grain of salt, but can this just check whether <code>ret.resource_drop_wasm_to_native_trampoline.is_some()</code> instead of maintaining a hash set if all compile keys?</p>
</blockquote>



<a name="377380186"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380186" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380186">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270913973">PR review comment</a>:</p>
<blockquote>
<p>If a component takes two resource type imports, and is instantiated from the host with the same resource for both imports, and we get the <code>ResourceType</code> for each of those imports <em>from that component</em>, will both of those result in the same <code>ResourceType</code>? That is, even though the compiled component cannot know they are the same, at the Wasmtime API level when we do reflection on the instantiated component, do we see through everything and determine they are the same? I think we should, and I think we should test this if we don't already.</p>
</blockquote>



<a name="377380187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380187">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270899001">PR review comment</a>:</p>
<blockquote>
<p>Kind of annoying we have to thread this through everything specially, when we worked so hard to avoid that elsewhere. Can we perhaps give it it a known compile key or something, so we can just look it up in the various output maps or whatever? Rather than add a special field to all of our compiler's structs. Not sure this is feasible but I'd like to just push in that direction if possible.</p>
</blockquote>



<a name="377380188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380188">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270926720">PR review comment</a>:</p>
<blockquote>
<p>Nice.</p>
</blockquote>



<a name="377380189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380189">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270914427">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>/// component model provides is that the `u32` is not forgeable by guests and
</code></pre></div><br>
</p>
</blockquote>



<a name="377380191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377380191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377380191">(Jul 21 2023 at 17:41)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270925141">PR review comment</a>:</p>
<blockquote>
<p>The parenthetical could be clarified a bit:</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>///   doesn't go further and test for equality in the guest itself (for example
///   two different heap allocations of `Box&lt;u32&gt;` can be equal in normal Rust if they contain
///   the same value, but will never be considered equal when compared as `Val::Resource`s).
</code></pre></div><br>
</p>
</blockquote>



<a name="377398763"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377398763" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377398763">(Jul 21 2023 at 18:49)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1541658057">PR review</a>.</p>



<a name="377398764"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377398764" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377398764">(Jul 21 2023 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270984256">PR review comment</a>:</p>
<blockquote>
<p>This branch is hit at runtime so it can't be <code>unreachable!</code>, but I'll update the comment to clarify that.</p>
</blockquote>



<a name="377399028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377399028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377399028">(Jul 21 2023 at 18:50)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1541658967">PR review</a>.</p>



<a name="377399031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377399031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377399031">(Jul 21 2023 at 18:50)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270984793">PR review comment</a>:</p>
<blockquote>
<p>Oops heh yes I mean the exact opposite of what I say</p>
</blockquote>



<a name="377401693"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377401693" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377401693">(Jul 21 2023 at 19:01)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1541677935">PR review</a>.</p>



<a name="377401694"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377401694" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377401694">(Jul 21 2023 at 19:01)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270992453">PR review comment</a>:</p>
<blockquote>
<p>Correct! Added a test as well <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="377401696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377401696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377401696">(Jul 21 2023 at 19:01)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1270992453">PR review comment</a>.</p>



<a name="377407689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377407689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377407689">(Jul 21 2023 at 19:24)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1541728292">PR review</a>.</p>



<a name="377407693"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377407693" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377407693">(Jul 21 2023 at 19:24)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1271009860">PR review comment</a>:</p>
<blockquote>
<p>It's a bit subtle and worth a comment that's not currently present, but this is doing 2 things where first it's determining if a trampoline is required and if so creating a <code>CompileKey</code> for it. Next it's detecting if that key was already compiled for some previous trampoline, and if not it adds it.</p>
<p>In that sense this is the "root" where <code>resource_drop_wasm_to_native_trampoline</code> is first set to <code>Some</code>, so it can't piggy-back on anything else.</p>
<p>That being said coupled with your below concern I'll see if I can clean this up a bit.</p>
</blockquote>



<a name="377412611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377412611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377412611">(Jul 21 2023 at 19:48)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377412729"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377412729" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377412729">(Jul 21 2023 at 19:48)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#pullrequestreview-1541764570">PR review</a>.</p>



<a name="377412731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377412731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377412731">(Jul 21 2023 at 19:48)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/6691#discussion_r1271030546">PR review comment</a>:</p>
<blockquote>
<p>True! There's a newtype for core wasm libcalls but I was a bit hesitant to duplicate all the macro machinery for that as well since the libcalls already duplicate other macro machinery.</p>
</blockquote>



<a name="377413825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377413825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377413825">(Jul 21 2023 at 19:54)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377420603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377420603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377420603">(Jul 21 2023 at 20:27)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377420800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377420800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377420800">(Jul 21 2023 at 20:28)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377426665"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377426665" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377426665">(Jul 21 2023 at 20:58)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377426676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377426676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377426676">(Jul 21 2023 at 20:58)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377436553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377436553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377436553">(Jul 21 2023 at 21:59)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377436576"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377436576" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377436576">(Jul 21 2023 at 21:59)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<a name="377452614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236691%20Implement%20component%20model%20resources%20i.../near/377452614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236691.20Implement.20component.20model.20resources.20i.2E.2E.2E.html#377452614">(Jul 22 2023 at 00:06)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6691">PR #6691</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>