<html>
<head><meta charset="utf-8"><title>wasmtime / issue #9300 gdb complains about loadable secti... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239300.20gdb.20complains.20about.20loadable.20secti.2E.2E.2E.html">wasmtime / issue #9300 gdb complains about loadable secti...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="472536892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239300%20gdb%20complains%20about%20loadable%20secti.../near/472536892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239300.20gdb.20complains.20about.20loadable.20secti.2E.2E.2E.html#472536892">(Sep 24 2024 at 17:00)</a>:</h4>
<p><a href="https://github.com/bjorn3">bjorn3</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/9300">Issue #9300</a>.</p>



<a name="472536898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239300%20gdb%20complains%20about%20loadable%20secti.../near/472536898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239300.20gdb.20complains.20about.20loadable.20secti.2E.2E.2E.html#472536898">(Sep 24 2024 at 17:00)</a>:</h4>
<p>bjorn3 opened <a href="https://github.com/bytecodealliance/wasmtime/issues/9300">issue #9300</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Any wasm module.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li><code>wasmtime run -Ddebug-info=y /path/to/wasm</code></li>
<li><code>gdb -p $(pidof wasmtime)</code></li>
</ul>
<h3>Expected Results</h3>
<p>Gdb doesn't emit any warnings.</p>
<h3>Actual Results</h3>
<p>Gdb emits the following warnings:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.engine"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.bti"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".eh_frame"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.addrmap"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.traps"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".rodata.wasm"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".name.wasm"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>

<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.info"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7fdb64515010</span><span class="o">&gt;</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: v16.0.0, but almost certainly reproduces with current Wasmtime given that I can't see any recent changes to the relevant code.</p>
<p>Operating system: Linux</p>
<p>Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>This can probably be fixed by either clearing the loadable flag of all these sections or adding them to actual segments in case they are meant to be used at runtime like in the case of <code>.eh_frame</code> and <code>.rodata.wasm</code>.</p>
</blockquote>



<a name="472538533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239300%20gdb%20complains%20about%20loadable%20secti.../near/472538533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239300.20gdb.20complains.20about.20loadable.20secti.2E.2E.2E.html#472538533">(Sep 24 2024 at 17:09)</a>:</h4>
<p>bjorn3 edited <a href="https://github.com/bytecodealliance/wasmtime/issues/9300">issue #9300</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Any wasm module.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li><code>wasmtime run -Ddebug-info=y /path/to/wasm</code></li>
<li><code>gdb -p $(pidof wasmtime)</code></li>
</ul>
<h3>Expected Results</h3>
<p>Gdb doesn't emit any warnings.</p>
<h3>Actual Results</h3>
<p>Gdb emits the following warnings:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.engine"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.bti"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".eh_frame"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.addrmap"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.traps"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".rodata.wasm"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".name.wasm"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
<span class="n">warning</span><span class="p">:</span><span class="w"> </span><span class="nc">Loadable</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="s">".wasmtime.info"</span><span class="w"> </span><span class="n">outside</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">ELF</span><span class="w"> </span><span class="n">segments</span>
<span class="w">  </span><span class="k">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">in</span><span class="o">-</span><span class="n">memory</span><span class="o">@</span><span class="mh">0x7f21a5259010</span><span class="o">&gt;</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: v25.0.0</p>
<p>Operating system: Linux</p>
<p>Architecture: x86_64</p>
<h3>Extra Info</h3>
<p>This can probably be fixed by either clearing the loadable flag of all these sections or adding them to actual segments in case they are meant to be used at runtime like in the case of <code>.eh_frame</code> and <code>.rodata.wasm</code>.</p>
</blockquote>



<a name="472574426"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%239300%20gdb%20complains%20about%20loadable%20secti.../near/472574426" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.239300.20gdb.20complains.20about.20loadable.20secti.2E.2E.2E.html#472574426">(Sep 24 2024 at 21:11)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/9300#issuecomment-2372394525">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/9300">issue #9300</a>:</p>
<blockquote>
<p>I suspect the fix is that in <a href="https://github.com/bytecodealliance/wasmtime/blob/0ed182e1e2273f957255e1c895d4108a8c74ce41/crates/environ/src/compile/module_artifacts.rs">this file</a> our usage of <code>SectionKind::ReadOnlyData</code> is probably all wrong and it may want to be something like <code>SectionKind::Metadata</code> or similar. Wasmtime doesn't use these flags at all so the choice of kind here is basically arbitrary from Wasmtime's perspective, but it'd be great to remove these warnings and get a "more correct" elf file too! Would you be able to test out <code>SectionKind::Metadata</code> and see if gdb still emits these warnings?</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>