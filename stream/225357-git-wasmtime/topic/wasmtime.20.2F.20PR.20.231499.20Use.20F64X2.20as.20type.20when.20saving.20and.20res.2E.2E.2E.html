<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1499 Use F64X2 as type when saving and res... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html">wasmtime / PR #1499 Use F64X2 as type when saving and res...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="193671594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193671594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193671594">(Apr 11 2020 at 17:53)</a>:</h4>
<p>samrat opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1499" title="https://github.com/bytecodealliance/wasmtime/pull/1499">PR #1499</a> from <code>fix-xmm-type</code> to <code>master</code>:</p>
<blockquote>
<p>When adding floating-point registers as callee-saved register to block- and function parameter lists add them as <code>F64X2</code> arguments.</p>
<p>Fixes #1497 </p>
</blockquote>



<a name="193672241"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193672241" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193672241">(Apr 11 2020 at 18:08)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-391788185" title="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-391788185">PR Review</a>.</p>



<a name="193672242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193672242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193672242">(Apr 11 2020 at 18:08)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#discussion_r407093321" title="https://github.com/bytecodealliance/wasmtime/pull/1499#discussion_r407093321">PR Review Comment</a>:</p>
<blockquote>
<p>This line should be removed.</p>
</blockquote>



<a name="193673832"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193673832" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193673832">(Apr 11 2020 at 18:48)</a>:</h4>
<p>samrat updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1499" title="https://github.com/bytecodealliance/wasmtime/pull/1499">PR #1499</a> from <code>fix-xmm-type</code> to <code>master</code>:</p>
<blockquote>
<p>When adding floating-point registers as callee-saved register to block- and function parameter lists add them as <code>F64X2</code> arguments.</p>
<p>Fixes #1497 </p>
</blockquote>



<a name="193694416"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193694416" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193694416">(Apr 12 2020 at 04:52)</a>:</h4>
<p>samrat updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1499" title="https://github.com/bytecodealliance/wasmtime/pull/1499">PR #1499</a> from <code>fix-xmm-type</code> to <code>master</code>:</p>
<blockquote>
<p>When adding floating-point registers as callee-saved register to block- and function parameter lists add them as <code>F64X2</code> arguments.</p>
<p>Fixes #1497 </p>
</blockquote>



<a name="193697753"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193697753" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193697753">(Apr 12 2020 at 06:40)</a>:</h4>
<p>samrat updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1499" title="https://github.com/bytecodealliance/wasmtime/pull/1499">PR #1499</a> from <code>fix-xmm-type</code> to <code>master</code>:</p>
<blockquote>
<p>When adding floating-point registers as callee-saved register to block- and function parameter lists add them as <code>F64X2</code> arguments.</p>
<p>Fixes #1497 </p>
</blockquote>



<a name="193792171"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193792171" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193792171">(Apr 13 2020 at 16:47)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-392268951" title="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-392268951">PR Review</a>.</p>



<a name="193792172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193792172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193792172">(Apr 13 2020 at 16:47)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-392268951" title="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-392268951">PR Review</a>.</p>



<a name="193792173"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193792173" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193792173">(Apr 13 2020 at 16:47)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#discussion_r407580129" title="https://github.com/bytecodealliance/wasmtime/pull/1499#discussion_r407580129">PR Review Comment</a>:</p>
<blockquote>
<p>The astute reader may ask, "why did prologue sizes change if this was supposed to be a no-op cleanup-style change?"</p>
<p>It turns out my <code>F64 causes a whole XMM register to be preserved anyway.</code> comment became a lie between when I wrote it and when #1216 landed. Or maybe I was wrong the whole time? It was generating <code>movsd</code> (for example, <code>f2 41 0f 11 33</code>), where with this change Cranelift generates <code>movups</code> (-&gt; <code>41 0f 11 33</code>, one byte shorter).</p>
<p>This is why prologues are shorter, but more importantly, <code>movsd</code> only works with the low 64 bits of its xmm argument! <code>movups</code> is the correct instruction (<code>movaps</code> would also be acceptable), which moves the entire 128 bits.</p>
</blockquote>



<a name="193792269"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193792269" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193792269">(Apr 13 2020 at 16:48)</a>:</h4>
<p>iximeow merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1499" title="https://github.com/bytecodealliance/wasmtime/pull/1499">PR #1499</a>.</p>



<a name="193792966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193792966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193792966">(Apr 13 2020 at 16:55)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-392275990" title="https://github.com/bytecodealliance/wasmtime/pull/1499#pullrequestreview-392275990">PR Review</a>.</p>



<a name="193792967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231499%20Use%20F64X2%20as%20type%20when%20saving%20and%20res.../near/193792967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231499.20Use.20F64X2.20as.20type.20when.20saving.20and.20res.2E.2E.2E.html#193792967">(Apr 13 2020 at 16:55)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/wasmtime/pull/1499#discussion_r407586019" title="https://github.com/bytecodealliance/wasmtime/pull/1499#discussion_r407586019">PR Review Comment</a>:</p>
<blockquote>
<p>Aha! I was about to ask that very question. (Don't know how astute of a reader I am, though.) Thanks for the explanation.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>