<html>
<head><meta charset="utf-8"><title>wasmtime / PR #6013 cranelift: Add narrower and wider con... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html">wasmtime / PR #6013 cranelift: Add narrower and wider con...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="341593074"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341593074" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341593074">(Mar 13 2023 at 23:27)</a>:</h4>
<p>elliottt opened <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>:</p>
<blockquote>
<p>In service of merging #5947, add the <code>narrower</code> and <code>wider</code> constraints to the <code>TypeVar</code> type in the instruction DSL.</p>
<p>These two new constraints capture the situation where an instruction requires that its output be either narrower or wider than one of its input arguments. Instructions that fit one of these two patterns include: <code>uextend</code>, <code>sextend</code>, <code>ireduce</code>, <code>fpromote</code>, and <code>fdemote</code>. Previously these constraints were validated by special case typechecking behavior in the verifier, and with their addition those special cases can now be removed.</p>
<p>The benefit to #5947 is that the constraints are now available to the <code>function_generator</code> module when determining which arguments to select for random instruction instantiations. This gets us a bit closer to being able to use the generated opcode list as the source of truth for how we generate arbitrary instructions.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="341593098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341593098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341593098">(Mar 13 2023 at 23:27)</a>:</h4>
<p><strong>elliottt</strong> requested <a href="https://github.com/jameysharp">jameysharp</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a>.</p>



<a name="341594867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341594867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341594867">(Mar 13 2023 at 23:47)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338145740">PR review</a>.</p>



<a name="341594869"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341594869" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341594869">(Mar 13 2023 at 23:47)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134726568">PR review comment</a>:</p>
<blockquote>
<p>This function doesn't capture the case where a variable depends on a parent that refines yet another parent. It might be worth thinking a bit about how this would work, though we don't currently have any instructions that combine constraints like that.</p>
</blockquote>



<a name="341595026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341595026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341595026">(Mar 13 2023 at 23:49)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338148674">PR review</a>.</p>



<a name="341595027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341595027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341595027">(Mar 13 2023 at 23:49)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134727470">PR review comment</a>:</p>
<blockquote>
<p>It might be worth adding a <code>BitSet::singleton</code> function to make it a bit more obvious what's going on here.</p>
</blockquote>



<a name="341597104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341597104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341597104">(Mar 14 2023 at 00:12)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338142398">PR review</a>.</p>



<a name="341597105"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341597105" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341597105">(Mar 14 2023 at 00:12)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134725536">PR review comment</a>:</p>
<blockquote>
<p>I think this control flow is equivalent (since it's at the end of the loop where <code>continue</code> is implicit) and maybe easier to reason about.</p>
<div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        if let Some(tv) = typ.free_typevar() {
            if &amp;tv != ctrl_typevar {
                return Err("type variable in output not derived from ctrl_typevar".into());
            }

            // Variables derived from the control variable are ok, but we remember if they refine
            // the control variable, as that still requires another type to instantiate.
            refines_output = typ.refines_parent();
        }
</code></pre></div>
<p>Also, how should <code>refines_output</code> be set if there are multiple output values? Should it be <code>true</code> if _any_ result type is a refinement?</p>
</blockquote>



<a name="341597106"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341597106" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341597106">(Mar 14 2023 at 00:12)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338142398">PR review</a>.</p>



<a name="341597107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341597107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341597107">(Mar 14 2023 at 00:12)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134726402">PR review comment</a>:</p>
<blockquote>
<p>This assertion message and the corresponding one for <code>Wider</code> don't reflect that you extended them to floats as well.</p>
</blockquote>



<a name="341597108"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341597108" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341597108">(Mar 14 2023 at 00:12)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134731735">PR review comment</a>:</p>
<blockquote>
<p>I think, in conjunction with the good comment here mentioning <code>2^8</code>, that it's more clear to just use the constant <code>8</code> as the upper bound:</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>                    tys.ints = BitSet::from_range(ctrl_type_bits as u8, 8);
</code></pre></div><br>
</p>
</blockquote>



<a name="341597109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341597109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341597109">(Mar 14 2023 at 00:12)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134733530">PR review comment</a>:</p>
<blockquote>
<p>Very nice to get rid of the <code>lane_bits</code> checks in the verifier. Can't we also get rid of the <code>lane_count</code> checks? And at that point delete the <code>typecheck_special</code> cases for the <code>Unary</code> format entirely?</p>
</blockquote>



<a name="341600642"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341600642" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341600642">(Mar 14 2023 at 00:46)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>.</p>



<a name="341601284"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601284" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601284">(Mar 14 2023 at 00:52)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338252534">PR review</a>.</p>



<a name="341601285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601285">(Mar 14 2023 at 00:52)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134758989">PR review comment</a>:</p>
<blockquote>
<p>I had meant to do that, but apparently only got as far as the comment <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
</blockquote>



<a name="341601504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601504">(Mar 14 2023 at 00:54)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338253631">PR review</a>.</p>



<a name="341601506"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601506" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601506">(Mar 14 2023 at 00:54)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134760405">PR review comment</a>:</p>
<blockquote>
<p>Hah, the only remaining checks were for vector arguments, and none of those instructions support vectors now. Great catch!</p>
</blockquote>



<a name="341601590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601590">(Mar 14 2023 at 00:55)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>.</p>



<a name="341601613"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601613" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601613">(Mar 14 2023 at 00:55)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>.</p>



<a name="341601617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341601617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341601617">(Mar 14 2023 at 00:55)</a>:</h4>
<p><strong>elliottt</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> as ready for review.</p>



<a name="341602083"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602083" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602083">(Mar 14 2023 at 01:00)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>.</p>



<a name="341602173"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602173" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602173">(Mar 14 2023 at 01:01)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338255944">PR review</a>.</p>



<a name="341602174"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602174" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602174">(Mar 14 2023 at 01:01)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338255944">PR review</a>.</p>



<a name="341602175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602175">(Mar 14 2023 at 01:01)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134764390">PR review comment</a>:</p>
<blockquote>
<p>I'm still wondering how this should work if the instruction has multiple value results. Right now, <code>refines_output</code> is set by the _last_ value result, which doesn't seem right. Should it be set true if _any_ value result is a refinement?</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>            if typ.refines_parent() {
                refines_output = true;
            }
</code></pre></div><br>
</p>
</blockquote>



<a name="341602176"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602176" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602176">(Mar 14 2023 at 01:01)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134762969">PR review comment</a>:</p>
<blockquote>
<p>I snuck a variable inlining in there so this let-binding should be dead now <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
</blockquote>



<a name="341602616"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602616" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602616">(Mar 14 2023 at 01:04)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338260267">PR review</a>.</p>



<a name="341602617"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602617" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602617">(Mar 14 2023 at 01:04)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#discussion_r1134767593">PR review comment</a>:</p>
<blockquote>
<p>Yep, I think you're correct: it should be true if any result is a refinement. Thanks for catching this!</p>
</blockquote>



<a name="341602628"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602628" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602628">(Mar 14 2023 at 01:05)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>.</p>



<a name="341602804"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341602804" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341602804">(Mar 14 2023 at 01:06)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/6013#pullrequestreview-1338261216">PR review</a>.</p>



<a name="341840531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341840531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341840531">(Mar 14 2023 at 16:05)</a>:</h4>
<p>elliottt updated <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a> from <code>trevor/narrower-instruction-constraint</code> to <code>main</code>.</p>



<a name="341859229"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%236013%20cranelift%3A%20Add%20narrower%20and%20wider%20con.../near/341859229" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.236013.20cranelift.3A.20Add.20narrower.20and.20wider.20con.2E.2E.2E.html#341859229">(Mar 14 2023 at 17:15)</a>:</h4>
<p>elliottt merged <a href="https://github.com/bytecodealliance/wasmtime/pull/6013">PR #6013</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>