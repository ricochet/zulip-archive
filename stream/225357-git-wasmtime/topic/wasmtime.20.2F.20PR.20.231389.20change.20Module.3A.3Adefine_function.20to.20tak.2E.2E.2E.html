<html>
<head><meta charset="utf-8"><title>wasmtime / PR #1389 change Module::define_function to tak... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html">wasmtime / PR #1389 change Module::define_function to tak...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="191612903"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191612903" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191612903">(Mar 24 2020 at 13:59)</a>:</h4>
<p>froydnj opened <a href="https://github.com/bytecodealliance/wasmtime/pull/1389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389">PR #1389</a> from <code>define-function-trap-sink</code> to <code>master</code>:</p>
<blockquote>
<p>Experience with the <code>define_function</code> API has shown that returning borrowed slices of <code>TrapSite</code> is not ideal: the returned slice represents a borrow on the entire <code>Module</code>, which makes calling back into methods taking <code>&amp;mut self</code> a bit tricky.</p>
<p>To eliminate the problem, let's require the callers of <code>define_function</code> to provide <code>TrapSink</code> instances.  This style of API enables them to control when and how traps are collected, and makes the <code>object</code> and <code>faerie</code> backends simpler/more efficient by not having to worry about trap collection.</p>
<p>This has been discussed in #1184 and #1214.  I opted not to go this route because I thought the <code>&amp;[TrapSite]</code> version was easier.  Experience has shown that was a mistake.</p>
</blockquote>



<a name="191612904"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191612904" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191612904">(Mar 24 2020 at 13:59)</a>:</h4>
<p><strong>froydnj</strong> requested <a href="https://github.com/pchickey" target="_blank" title="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/1389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389">PR #1389</a>.</p>



<a name="191623705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191623705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191623705">(Mar 24 2020 at 15:10)</a>:</h4>
<p>froydnj updated <a href="https://github.com/bytecodealliance/wasmtime/pull/1389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389">PR #1389</a> from <code>define-function-trap-sink</code> to <code>master</code>:</p>
<blockquote>
<p>Experience with the <code>define_function</code> API has shown that returning borrowed slices of <code>TrapSite</code> is not ideal: the returned slice represents a borrow on the entire <code>Module</code>, which makes calling back into methods taking <code>&amp;mut self</code> a bit tricky.</p>
<p>To eliminate the problem, let's require the callers of <code>define_function</code> to provide <code>TrapSink</code> instances.  This style of API enables them to control when and how traps are collected, and makes the <code>object</code> and <code>faerie</code> backends simpler/more efficient by not having to worry about trap collection.</p>
<p>This has been discussed in #1184 and #1214.  I opted not to go this route because I thought the <code>&amp;[TrapSite]</code> version was easier.  Experience has shown that was a mistake.</p>
</blockquote>



<a name="191645614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191645614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191645614">(Mar 24 2020 at 17:28)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/1389#pullrequestreview-380540142" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389#pullrequestreview-380540142">PR Review</a>.</p>



<a name="191646650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191646650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191646650">(Mar 24 2020 at 17:35)</a>:</h4>
<p>froydnj closed without merge <a href="https://github.com/bytecodealliance/wasmtime/pull/1389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389">PR #1389</a>.</p>



<a name="191646656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191646656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191646656">(Mar 24 2020 at 17:35)</a>:</h4>
<p>froydnj reopened <a href="https://github.com/bytecodealliance/wasmtime/pull/1389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389">PR #1389</a> from <code>define-function-trap-sink</code> to <code>master</code>:</p>
<blockquote>
<p>Experience with the <code>define_function</code> API has shown that returning borrowed slices of <code>TrapSite</code> is not ideal: the returned slice represents a borrow on the entire <code>Module</code>, which makes calling back into methods taking <code>&amp;mut self</code> a bit tricky.</p>
<p>To eliminate the problem, let's require the callers of <code>define_function</code> to provide <code>TrapSink</code> instances.  This style of API enables them to control when and how traps are collected, and makes the <code>object</code> and <code>faerie</code> backends simpler/more efficient by not having to worry about trap collection.</p>
<p>This has been discussed in #1184 and #1214.  I opted not to go this route because I thought the <code>&amp;[TrapSite]</code> version was easier.  Experience has shown that was a mistake.</p>
</blockquote>



<a name="191646715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%231389%20change%20Module%3A%3Adefine_function%20to%20tak.../near/191646715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.231389.20change.20Module.3A.3Adefine_function.20to.20tak.2E.2E.2E.html#191646715">(Mar 24 2020 at 17:36)</a>:</h4>
<p>froydnj merged <a href="https://github.com/bytecodealliance/wasmtime/pull/1389" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/1389">PR #1389</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>