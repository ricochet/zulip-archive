<html>
<head><meta charset="utf-8"><title>wasmtime / PR #5319 Remove sig data arg and ret fields to... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html">wasmtime / PR #5319 Remove sig data arg and ret fields to...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="311771984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311771984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311771984">(Nov 23 2022 at 08:09)</a>:</h4>
<p>tnachen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>:</p>
<blockquote>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="311873629"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311873629" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311873629">(Nov 23 2022 at 17:37)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1191965000">PR review</a>.</p>



<a name="311873630"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311873630" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311873630">(Nov 23 2022 at 17:37)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1191965000">PR review</a>.</p>



<a name="311873631"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311873631" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311873631">(Nov 23 2022 at 17:37)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1030714531">PR review comment</a>:</p>
<blockquote>
<p>This isn't important, but I personally prefer to not use a closure if it's just passing its argument to a function or a tuple constructor. Like this:</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        self.0.checked_sub(1).map(Sig)
</code></pre></div><br>
</p>
</blockquote>



<a name="311873632"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311873632" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311873632">(Nov 23 2022 at 17:37)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1030720061">PR review comment</a>:</p>
<blockquote>
<p>This version of <code>num_args</code> would be slightly simpler if it looked more like the old definition of <code>Caller::num_args</code>:</p>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        let len = self.args(sig).len();
        if self.sigs[sig].stack_ret_arg.is_some() {
            len - 1
        } else {
            len
        }
</code></pre></div><br>
</p>
</blockquote>



<a name="311873633"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311873633" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311873633">(Nov 23 2022 at 17:37)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1030721333">PR review comment</a>:</p>
<blockquote>
<p>The result of calling <code>slice::len</code> is a <code>usize</code>, so this call to <code>usize::from</code> isn't necessary in this version.</p>
</blockquote>



<a name="311874557"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311874557" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311874557">(Nov 23 2022 at 17:43)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="311874597"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311874597" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311874597">(Nov 23 2022 at 17:43)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="311877034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/311877034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#311877034">(Nov 23 2022 at 17:58)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="312125626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312125626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312125626">(Nov 25 2022 at 06:56)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="312127148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312127148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312127148">(Nov 25 2022 at 07:12)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="312127469"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312127469" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312127469">(Nov 25 2022 at 07:16)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="312234309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312234309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312234309">(Nov 25 2022 at 17:50)</a>:</h4>
<p>tnachen edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>:</p>
<blockquote>
<p>Addressing #5183<br>
&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="312704158"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312704158" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312704158">(Nov 28 2022 at 19:22)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1196415272">PR review</a>.</p>



<a name="312704159"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312704159" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312704159">(Nov 28 2022 at 19:22)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1196415272">PR review</a>.</p>



<a name="312704160"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312704160" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312704160">(Nov 28 2022 at 19:22)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1033957049">PR review comment</a>:</p>
<blockquote>
<p>Pre-existing, but since <code>Sig</code> is now a newtype wrapper around <code>u32</code> and is <code>Copy</code>, we should probably just take an arg <code>abi: Sig</code> and avoid this dereference.</p>
</blockquote>



<a name="312704161"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312704161" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312704161">(Nov 28 2022 at 19:22)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1033959090">PR review comment</a>:</p>
<blockquote>
<p>Can we add a note here on the indexing scheme? Something like "Arguments for a given <code>sig</code> are in the args array at indicies <code>args_end[sig - 1]..args_end[sig]</code>, or <code>0..args_end[sig]</code> if <code>sig</code> is <code>0</code>.</p>
<p>(And the <code>args_end</code> value is an exclusive endpoint, i.e. not included, so <code>..</code> above is correct, right?)</p>
</blockquote>



<a name="312704162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312704162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312704162">(Nov 28 2022 at 19:22)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1033960569">PR review comment</a>:</p>
<blockquote>
<p>Or, reading more below, I guess it's a little more complex because args and rets are contiguous for a given <code>Sig</code>, but we should give the appropriate ranges here and describe the scheme regardless.</p>
</blockquote>



<a name="312704273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312704273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312704273">(Nov 28 2022 at 19:23)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1033959090">PR review comment</a>.</p>



<a name="312705859"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312705859" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312705859">(Nov 28 2022 at 19:32)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1196435749">PR review</a>.</p>



<a name="312705860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/312705860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#312705860">(Nov 28 2022 at 19:32)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1033970518">PR review comment</a>:</p>
<blockquote>
<p>I had @tnachen make some changes along these lines in a previous PR, but I decided not to ask for that in function signatures that weren't otherwise changed in this PR.</p>
<p>It would be a good follow-up PR to fix all the functions that currently take <code>&amp;Sig</code> to take <code>Sig</code> instead. I currently see examples in <code>cranelift/codegen/src/isa/s390x/lower/isle.rs</code>, <code>cranelift/codegen/src/machinst/abi.rs</code>, and <code>cranelift/codegen/src/machinst/isle.rs</code>.</p>
</blockquote>



<a name="313000333"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313000333" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313000333">(Nov 30 2022 at 07:25)</a>:</h4>
<p>tnachen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a> from <code>tnachen/sigdata_size</code> to <code>main</code>.</p>



<a name="313000971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313000971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313000971">(Nov 30 2022 at 07:30)</a>:</h4>
<p>tnachen created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1035614212">PR review comment</a>:</p>
<blockquote>
<p>@cfallin added more comments, let me know if this looks good?</p>
</blockquote>



<a name="313000972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313000972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313000972">(Nov 30 2022 at 07:30)</a>:</h4>
<p>tnachen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1198806343">PR review</a>.</p>



<a name="313000998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313000998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313000998">(Nov 30 2022 at 07:30)</a>:</h4>
<p>tnachen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1198806603">PR review</a>.</p>



<a name="313001000"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313001000" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313001000">(Nov 30 2022 at 07:30)</a>:</h4>
<p>tnachen created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1035614388">PR review comment</a>:</p>
<blockquote>
<p>Sg will make these changes after this one merged</p>
</blockquote>



<a name="313082854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313082854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313082854">(Nov 30 2022 at 15:18)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1036104421">PR review comment</a>:</p>
<blockquote>
<p>Looks great, thanks!</p>
</blockquote>



<a name="313082855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313082855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313082855">(Nov 30 2022 at 15:18)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1199524026">PR review</a>.</p>



<a name="313083028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313083028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313083028">(Nov 30 2022 at 15:19)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1199525811">PR review</a>.</p>



<a name="313083061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313083061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313083061">(Nov 30 2022 at 15:19)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/5319">PR #5319</a>.</p>



<a name="313628862"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313628862" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313628862">(Dec 03 2022 at 03:57)</a>:</h4>
<p>tnachen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1203319750">PR review</a>.</p>



<a name="313628863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313628863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313628863">(Dec 03 2022 at 03:57)</a>:</h4>
<p>tnachen created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1038688580">PR review comment</a>:</p>
<blockquote>
<p>I try to make this change but looks like &amp;Sig is generated from isle as generated code, and all non-primitive types declared as arg funcs in isle seems to be all generated as references. Should we leave this or try to change how isle code gen works?</p>
</blockquote>



<a name="313629090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313629090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313629090">(Dec 03 2022 at 04:00)</a>:</h4>
<p>tnachen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1203320084">PR review</a>.</p>



<a name="313629092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313629092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313629092">(Dec 03 2022 at 04:00)</a>:</h4>
<p>tnachen created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1038688916">PR review comment</a>:</p>
<blockquote>
<p>Or change (type Sig extern (enum)) into (type Sig (primitive u32)) ?<br>
</p>
</blockquote>



<a name="313629179"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313629179" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313629179">(Dec 03 2022 at 04:01)</a>:</h4>
<p>tnachen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1203323999">PR review</a>.</p>



<a name="313629180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/313629180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#313629180">(Dec 03 2022 at 04:01)</a>:</h4>
<p>tnachen created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1038690468">PR review comment</a>:</p>
<blockquote>
<p>Actually that doesn't work as it only generate args with u32 and not Sig anymore</p>
</blockquote>



<a name="314313147"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/314313147" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#314313147">(Dec 06 2022 at 19:47)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1041390342">PR review comment</a>:</p>
<blockquote>
<p>Oh, I see! I just learned how ISLE decides when to borrow last week while I've been rewriting its code generation, so this hadn't occurred to me.</p>
<p>It isn't important to get rid of the <code>&amp;Sig</code> borrows. But if you'd like to try working on the ISLE compiler, I think I can now guide you through fixing this. Let me know if you're interested; if so, I'll write up a plan.</p>
</blockquote>



<a name="314313149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/314313149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#314313149">(Dec 06 2022 at 19:47)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1207213463">PR review</a>.</p>



<a name="314393637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/314393637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#314393637">(Dec 07 2022 at 07:41)</a>:</h4>
<p>tnachen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1207917147">PR review</a>.</p>



<a name="314393639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/314393639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#314393639">(Dec 07 2022 at 07:41)</a>:</h4>
<p>tnachen created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1041859757">PR review comment</a>:</p>
<blockquote>
<p>@jameysharp I'm game! I think I kind of have a idea looking at a codebase, but I'm still new :) </p>
</blockquote>



<a name="315268497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/315268497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#315268497">(Dec 11 2022 at 23:58)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#pullrequestreview-1212778891">PR review</a>.</p>



<a name="315268498"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%235319%20Remove%20sig%20data%20arg%20and%20ret%20fields%20to.../near/315268498" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.235319.20Remove.20sig.20data.20arg.20and.20ret.20fields.20to.2E.2E.2E.html#315268498">(Dec 11 2022 at 23:58)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/wasmtime/pull/5319#discussion_r1045320964">PR review comment</a>:</p>
<blockquote>
<p>So I looked into this more, and I think this doesn't need ISLE compiler changes. I think it should work to change <code>(type Sig extern (enum))</code> to <code>(type Sig (primitive Sig))</code> and then fix the hand-written parts to match. Do you want to give that a try?</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>