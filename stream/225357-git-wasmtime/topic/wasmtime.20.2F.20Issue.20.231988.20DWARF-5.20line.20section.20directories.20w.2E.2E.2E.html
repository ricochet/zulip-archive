<html>
<head><meta charset="utf-8"><title>wasmtime / Issue #1988 DWARF-5 line section directories w... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html">wasmtime / Issue #1988 DWARF-5 line section directories w...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="203095186"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203095186" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203095186">(Jul 07 2020 at 12:26)</a>:</h4>
<p>ggreif labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>For a DWARF-5 equipped <code>.wasm</code> file, translated to <code>.o</code> (via <code>wasmtime wasm2obj -g</code>) the containing directories are mixed up:</p>
<ul>
<li>from</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x000288fa
         version: 5
...
include_directories[  0] = &quot;.&quot;
include_directories[  1] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  2] = &quot;tests/debug/testsuite&quot;
file_names[  0]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
file_names[  1]:
</code></pre></div>


<ul>
<li>to:</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x0000e747
         version: 4
...
include_directories[  1] = &quot;.&quot;
include_directories[  2] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  3] = &quot;tests/debug/testsuite&quot;
file_names[  1]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
</code></pre></div>


<p>Since the latter is one-based, the index but be incremented.</p>
<p>(I'm working on a PR.)</p>
</blockquote>



<a name="203095187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203095187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203095187">(Jul 07 2020 at 12:26)</a>:</h4>
<p>ggreif opened <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>For a DWARF-5 equipped <code>.wasm</code> file, translated to <code>.o</code> (via <code>wasmtime wasm2obj -g</code>) the containing directories are mixed up:</p>
<ul>
<li>from</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x000288fa
         version: 5
...
include_directories[  0] = &quot;.&quot;
include_directories[  1] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  2] = &quot;tests/debug/testsuite&quot;
file_names[  0]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
file_names[  1]:
</code></pre></div>


<ul>
<li>to:</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x0000e747
         version: 4
...
include_directories[  1] = &quot;.&quot;
include_directories[  2] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  3] = &quot;tests/debug/testsuite&quot;
file_names[  1]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
</code></pre></div>


<p>Since the latter is one-based, the index but be incremented.</p>
<p>(I'm working on a PR.)</p>
</blockquote>



<a name="203095225"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203095225" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203095225">(Jul 07 2020 at 12:26)</a>:</h4>
<p>ggreif edited <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>For a DWARF-5 equipped <code>.wasm</code> file, translated to <code>.o</code> (via <code>wasmtime wasm2obj -g</code>) the containing directories are mixed up:</p>
<ul>
<li>from</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x000288fa
         version: 5
...
include_directories[  0] = &quot;.&quot;
include_directories[  1] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  2] = &quot;tests/debug/testsuite&quot;
file_names[  0]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
file_names[  1]:
</code></pre></div>


<ul>
<li>to:</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x0000e747
         version: 4
...
include_directories[  1] = &quot;.&quot;
include_directories[  2] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  3] = &quot;tests/debug/testsuite&quot;
file_names[  1]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
</code></pre></div>


<p>Since the latter is one-based, the index must be incremented.</p>
<p>(I'm working on a PR.)</p>
</blockquote>



<a name="203095802"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203095802" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203095802">(Jul 07 2020 at 12:33)</a>:</h4>
<p>ggreif <a href="https://github.com/bytecodealliance/wasmtime/issues/1988#issuecomment-654824584">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>Alternatively we could honour this commentary from the DWARF-5 standard:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Prior to DWARF Version 5, the current directory was not represented in the directories field and a directory index of 0 implicitly referred to that directory as found in the DW_AT_comp_dir attribute of the compilation unit debugging information entry. In DWARF Version 5, the current directory is explicitly present in the directories field. This is needed to support the common practice of stripping all but the line number sections (.debug_line and .debug_line_str) from an executable.</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>



<a name="203095815"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203095815" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203095815">(Jul 07 2020 at 12:33)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1988#issuecomment-654824584">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>Alternatively we could honour this commentary from the DWARF-5 standard:</p>
<blockquote>
<p>Prior to DWARF Version 5, the current directory was not represented in the directories field and a directory index of 0 implicitly referred to that directory as found in the DW_AT_comp_dir attribute of the compilation unit debugging information entry. In DWARF Version 5, the current directory is explicitly present in the directories field. This is needed to support the common practice of stripping all but the line number sections (.debug_line and .debug_line_str) from an executable.</p>
</blockquote>
</blockquote>



<a name="203096155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203096155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203096155">(Jul 07 2020 at 12:37)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1988#issuecomment-654824584">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>Alternatively we could honour this commentary from the DWARF-5 standard:</p>
<blockquote>
<p>Prior to DWARF Version 5, the current directory was not represented in the directories field and a directory index of 0 implicitly referred to that directory as found in the DW_AT_comp_dir attribute of the compilation unit debugging information entry. In DWARF Version 5, the current directory is explicitly present in the directories field. This is needed to support the common practice of stripping all but the line number sections (.debug_line and .debug_line_str) from an executable.<br>
This is a bit more involved, since, it needs to compare the translation unit's directory with the DWARF-5 <code>.debug_line</code> section's <code>include_directories[0]</code> entry, and when equal, jettison the latter, keeping the file indices.</p>
</blockquote>
</blockquote>



<a name="203096178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203096178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203096178">(Jul 07 2020 at 12:37)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1988#issuecomment-654824584">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>Alternatively we could honour this commentary from the DWARF-5 standard:</p>
<blockquote>
<p>Prior to DWARF Version 5, the current directory was not represented in the directories field and a directory index of 0 implicitly referred to that directory as found in the DW_AT_comp_dir attribute of the compilation unit debugging information entry. In DWARF Version 5, the current directory is explicitly present in the directories field. This is needed to support the common practice of stripping all but the line number sections (.debug_line and .debug_line_str) from an executable.</p>
</blockquote>
<p>This is a bit more involved, since, it needs to compare the translation unit's directory with the DWARF-5 <code>.debug_line</code> section's <code>include_directories[0]</code> entry, and when equal, jettison the latter, keeping the file indices.</p>
</blockquote>



<a name="203096203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203096203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203096203">(Jul 07 2020 at 12:37)</a>:</h4>
<p>ggreif edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/1988#issuecomment-654824584">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>Alternatively we could honour this commentary from the DWARF-5 standard:</p>
<blockquote>
<p>Prior to DWARF Version 5, the current directory was not represented in the directories field and a directory index of 0 implicitly referred to that directory as found in the DW_AT_comp_dir attribute of the compilation unit debugging information entry. In DWARF Version 5, the current directory is explicitly present in the directories field. This is needed to support the common practice of stripping all but the line number sections (.debug_line and .debug_line_str) from an executable.</p>
</blockquote>
<p>This is a bit more involved, since it needs to compare the translation unit's directory with the DWARF-5 <code>.debug_line</code> section's <code>include_directories[0]</code> entry, and when equal, jettison the latter, keeping the file indices.</p>
</blockquote>



<a name="203125169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20Issue%20%231988%20DWARF-5%20line%20section%20directories%20w.../near/203125169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20Issue.20.231988.20DWARF-5.20line.20section.20directories.20w.2E.2E.2E.html#203125169">(Jul 07 2020 at 16:20)</a>:</h4>
<p>yurydelendik closed <a href="https://github.com/bytecodealliance/wasmtime/issues/1988">Issue #1988</a>:</p>
<blockquote>
<p>For a DWARF-5 equipped <code>.wasm</code> file, translated to <code>.o</code> (via <code>wasmtime wasm2obj -g</code>) the containing directories are mixed up:</p>
<ul>
<li>from</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x000288fa
         version: 5
...
include_directories[  0] = &quot;.&quot;
include_directories[  1] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  2] = &quot;tests/debug/testsuite&quot;
file_names[  0]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
file_names[  1]:
</code></pre></div>


<ul>
<li>to:</li>
</ul>
<div class="codehilite"><pre><span></span><code>.debug_line contents:
debug_line[0x00000000]
Line table prologue:
    total_length: 0x0000e747
         version: 4
...
include_directories[  1] = &quot;.&quot;
include_directories[  2] = &quot;&lt;moc-asset&gt;&quot;
include_directories[  3] = &quot;tests/debug/testsuite&quot;
file_names[  1]:
           name: &quot;fib-wasm.mo&quot;
      dir_index: 2
</code></pre></div>


<p>Since the latter is one-based, the index must be incremented.</p>
<p>(I'm working on a PR.)</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>