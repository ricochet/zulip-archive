<html>
<head><meta charset="utf-8"><title>wasmtime / PR #8065 Fix generating bindings for dead code · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html">wasmtime / PR #8065 Fix generating bindings for dead code</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="425421967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425421967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425421967">(Mar 08 2024 at 00:28)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/8065">PR #8065</a> from <code>alexcrichton:fix-gen-bindings-for-dead-code</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This commit fixes a bindgen problem where dead types, which had no generated bindings, could be referred to from other dead types, which did have generated bindings. The fix is to not generate code for dead types at all by fixing how type information is analyzed.</p>
<p>Closes #8057</p>
</blockquote>



<a name="425421968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425421968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425421968">(Mar 08 2024 at 00:28)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8065">PR #8065</a>.</p>



<a name="425421969"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425421969" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425421969">(Mar 08 2024 at 00:28)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8065">PR #8065</a>.</p>



<a name="425440479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425440479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425440479">(Mar 08 2024 at 03:34)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#pullrequestreview-1923965094">PR review</a>.</p>



<a name="425440480"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425440480" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425440480">(Mar 08 2024 at 03:34)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#discussion_r1517123001">PR review comment</a>:</p>
<blockquote>
<p>Not clear to me how this tests liveness since both interfaces are part of the imports?</p>
</blockquote>



<a name="425538926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425538926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425538926">(Mar 08 2024 at 15:19)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#pullrequestreview-1925106269">PR review</a>.</p>



<a name="425538927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425538927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425538927">(Mar 08 2024 at 15:19)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#discussion_r1517853873">PR review comment</a>:</p>
<blockquote>
<p>Ah good point, I should clarify, liveness is calculated in terms of what's used by imported/exported functions. No function actually uses <code>dead-type</code> or <code>v</code> but <code>live-type</code> is used by a function, and so we don't generate bindings for <code>dead-type</code> and this PR fixes a bug where we previously tried to generate bindings for <code>v</code> despite nothing using it.</p>
</blockquote>



<a name="425640698"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/425640698" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#425640698">(Mar 09 2024 at 03:44)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/dicej">dicej</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8065">PR #8065</a>.</p>



<a name="426462524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426462524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426462524">(Mar 14 2024 at 03:17)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/elliottt">elliottt</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/8065">PR #8065</a>.</p>



<a name="426599459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426599459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426599459">(Mar 14 2024 at 18:06)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#pullrequestreview-1937416986">PR review</a>.</p>



<a name="426599460"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426599460" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426599460">(Mar 14 2024 at 18:06)</a>:</h4>
<p>elliottt created <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#discussion_r1525305283">PR review comment</a>:</p>
<blockquote>
<p>Does doing this step first mean that the calls to <code>self.type_info</code> in <code>type_info_func</code> should never traverse the whole type (due to the early exit if the entry exists already)?</p>
</blockquote>



<a name="426599461"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426599461" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426599461">(Mar 14 2024 at 18:06)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#pullrequestreview-1937416986">PR review</a>.</p>



<a name="426616681"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426616681" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426616681">(Mar 14 2024 at 19:46)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#pullrequestreview-1937593729">PR review</a>.</p>



<a name="426616682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426616682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426616682">(Mar 14 2024 at 19:46)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/8065#discussion_r1525410669">PR review comment</a>:</p>
<blockquote>
<p>Not for this, but the below bits would still need it for setting the owned/borrowed bits.</p>
<p>It's probably best to switching this to <code>LiveSet</code> one day as a future refactoring</p>
</blockquote>



<a name="426620934"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%238065%20Fix%20generating%20bindings%20for%20dead%20code/near/426620934" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.238065.20Fix.20generating.20bindings.20for.20dead.20code.html#426620934">(Mar 14 2024 at 20:15)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/8065">PR #8065</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>