<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3183 Wasmtime doesn&#x27;t work on Linux AAr... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html">wasmtime / issue #3183 Wasmtime doesn&#x27;t work on Linux AAr...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="249287184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/249287184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#249287184">(Aug 12 2021 at 20:15)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p>As of <a href="https://github.com/bytecodealliance/wasmtime/pull/3180">https://github.com/bytecodealliance/wasmtime/pull/3180</a> Wasmtime will stop workong on AArch64 Linux with PAC enabled. Debugging this issue at <a href="#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding">https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding</a> seems to indicate that this is a libgcc bug which only accidentally worked before because the <code>DW_OP_lit0</code> we specify for register 34, the pointer auth enabling register, just happened to show up at an even address in memory. After #3180 the encoding of the FDE is changing just enough that some expressions show up at odd addresses, which tricks libgcc to thinking that pointer authentication is enabled, when it actually isn't.</p>
<p>This commit is tracking improving this by either figuring out a workaround for gcc, implementing pointer authentication, or something similar.</p>
</blockquote>



<a name="274130347"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/274130347" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#274130347">(Mar 04 2022 at 13:47)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/3183#issuecomment-1059176038">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=104689">An associated libgcc issue</a> has been created.</p>
</blockquote>



<a name="281819188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/281819188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#281819188">(May 10 2022 at 12:53)</a>:</h4>
<p>akirilov-arm labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p>As of <a href="https://github.com/bytecodealliance/wasmtime/pull/3180">https://github.com/bytecodealliance/wasmtime/pull/3180</a> Wasmtime will stop workong on AArch64 Linux with PAC enabled. Debugging this issue at <a href="#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding">https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding</a> seems to indicate that this is a libgcc bug which only accidentally worked before because the <code>DW_OP_lit0</code> we specify for register 34, the pointer auth enabling register, just happened to show up at an even address in memory. After #3180 the encoding of the FDE is changing just enough that some expressions show up at odd addresses, which tricks libgcc to thinking that pointer authentication is enabled, when it actually isn't.</p>
<p>This commit is tracking improving this by either figuring out a workaround for gcc, implementing pointer authentication, or something similar.</p>
</blockquote>



<a name="281819189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/281819189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#281819189">(May 10 2022 at 12:53)</a>:</h4>
<p>akirilov-arm labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p>As of <a href="https://github.com/bytecodealliance/wasmtime/pull/3180">https://github.com/bytecodealliance/wasmtime/pull/3180</a> Wasmtime will stop workong on AArch64 Linux with PAC enabled. Debugging this issue at <a href="#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding">https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding</a> seems to indicate that this is a libgcc bug which only accidentally worked before because the <code>DW_OP_lit0</code> we specify for register 34, the pointer auth enabling register, just happened to show up at an even address in memory. After #3180 the encoding of the FDE is changing just enough that some expressions show up at odd addresses, which tricks libgcc to thinking that pointer authentication is enabled, when it actually isn't.</p>
<p>This commit is tracking improving this by either figuring out a workaround for gcc, implementing pointer authentication, or something similar.</p>
</blockquote>



<a name="281871061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/281871061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#281871061">(May 10 2022 at 19:04)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/3183#issuecomment-1122759960">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p>And <a href="https://gcc.gnu.org/pipermail/gcc-patches/2022-May/594414.html">a patch</a> has been posted.</p>
</blockquote>



<a name="284399788"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/284399788" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#284399788">(May 30 2022 at 19:30)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/3183#issuecomment-1141433769">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p>The fix has been <a href="https://gcc.gnu.org/git/?p=gcc.git;a=commit;h=0d344b557604e966dc7f91739881f03e1f221efd">committed</a>.</p>
</blockquote>



<a name="285541331"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233183%20Wasmtime%20doesn%27t%20work%20on%20Linux%20AAr.../near/285541331" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233183.20Wasmtime.20doesn.27t.20work.20on.20Linux.20AAr.2E.2E.2E.html#285541331">(Jun 09 2022 at 14:17)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/3183">issue #3183</a>:</p>
<blockquote>
<p>As of <a href="https://github.com/bytecodealliance/wasmtime/pull/3180">https://github.com/bytecodealliance/wasmtime/pull/3180</a> Wasmtime will stop workong on AArch64 Linux with PAC enabled. Debugging this issue at <a href="#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding">https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime/topic/arm64.2C.20pointer.20auth.2C.20unwinding</a> seems to indicate that this is a libgcc bug which only accidentally worked before because the <code>DW_OP_lit0</code> we specify for register 34, the pointer auth enabling register, just happened to show up at an even address in memory. After #3180 the encoding of the FDE is changing just enough that some expressions show up at odd addresses, which tricks libgcc to thinking that pointer authentication is enabled, when it actually isn't.</p>
<p>This commit is tracking improving this by either figuring out a workaround for gcc, implementing pointer authentication, or something similar.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>