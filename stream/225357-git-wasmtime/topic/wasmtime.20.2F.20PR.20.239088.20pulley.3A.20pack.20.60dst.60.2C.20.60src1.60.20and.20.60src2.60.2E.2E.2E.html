<html>
<head><meta charset="utf-8"><title>wasmtime / PR #9088 pulley: pack `dst`, `src1` and `src2`... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html">wasmtime / PR #9088 pulley: pack `dst`, `src1` and `src2`...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="457201596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457201596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457201596">(Aug 07 2024 at 21:03)</a>:</h4>
<p>Kmeakin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a> from <code>Kmeakin:km/pulley-packed-binary-operands</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Pack the <code>dst</code>, <code>src1</code> and <code>src2</code> register operands of binary operators into 2 bytes. Solves the <code>TODO</code> at the top of <code>lib.rs</code></p>
</blockquote>



<a name="457201598"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457201598" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457201598">(Aug 07 2024 at 21:03)</a>:</h4>
<p><strong>Kmeakin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="457201599"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457201599" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457201599">(Aug 07 2024 at 21:03)</a>:</h4>
<p><strong>Kmeakin</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="457204449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457204449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457204449">(Aug 07 2024 at 21:22)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="457204563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457204563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457204563">(Aug 07 2024 at 21:22)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#issuecomment-2274371846">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>:</p>
<blockquote>
<p>Reassigned @fitzgen to review, I'm not sure how this intersects with your other plans to add instructions with large offsets etc; happy to review this myself if you'd like otherwise.</p>
</blockquote>



<a name="457208316"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457208316" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457208316">(Aug 07 2024 at 21:44)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="457208482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457208482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457208482">(Aug 07 2024 at 21:45)</a>:</h4>
<p>Kmeakin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>:</p>
<blockquote>
<p>Pack the <code>dst</code>, <code>src1</code> and <code>src2</code> register operands of binary operators into 2 bytes. Solves the <code>TODO</code> at the top of <code>lib.rs</code>.</p>
<p>This required moving the special registers into their own register class, and adding <code>smov</code> and <code>spush</code>/<code>spop</code> to interact with SP/FP.</p>
</blockquote>



<a name="457208801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457208801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457208801">(Aug 07 2024 at 21:49)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="457219237"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457219237" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457219237">(Aug 07 2024 at 22:59)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2226312147">PR review</a>:</p>
<blockquote>
<p>Thanks! <code>BinaryOperands</code> is exactly what I was imagining!</p>
<p>I'd prefer holding off on merging this until I can land the Cranelift backend for Pulley though, just so that I don't have to chase instruction set updates, and we can start evolving the backend and the instruction set together and keep them in sync.</p>
</blockquote>



<a name="457219239"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457219239" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457219239">(Aug 07 2024 at 22:59)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2226312147">PR review</a>:</p>
<blockquote>
<p>Thanks! <code>BinaryOperands</code> is exactly what I was imagining!</p>
<p>I'd prefer holding off on merging this until I can land the Cranelift backend for Pulley though, just so that I don't have to chase instruction set updates, and we can start evolving the backend and the instruction set together and keep them in sync.</p>
</blockquote>



<a name="457219240"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457219240" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457219240">(Aug 07 2024 at 22:59)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1708042337">PR review comment</a>:</p>
<blockquote>
<p>I was indeed thinking that the special registers would only be accessed from special instructions, but I think we can do even more here by bundling the whole function prologue and epilogue up into instructions that just take the size to decrement the stack frame by:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">enter_frame</span><span class="w"> </span><span class="mi">16</span>
<span class="o">..</span><span class="p">.</span>
<span class="n">exit_frame</span><span class="w"> </span><span class="mi">16</span>
<span class="n">ret</span>
</code></pre></div>
<p>where</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">enter_frame</span><span class="w"> </span><span class="n">N</span>

<span class="o">==&gt;</span>

<span class="n">push</span><span class="w"> </span><span class="n">lr</span>
<span class="n">push</span><span class="w"> </span><span class="n">fp</span>
<span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span>
<span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span>
</code></pre></div>
<p>and the opposite for <code>exit_frame N</code>.</p>
</blockquote>



<a name="457219241"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457219241" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457219241">(Aug 07 2024 at 22:59)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1708045495">PR review comment</a>:</p>
<blockquote>
<p>Why all these changes? Seems unrelated?</p>
</blockquote>



<a name="457219243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457219243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457219243">(Aug 07 2024 at 22:59)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1708057872">PR review comment</a>:</p>
<blockquote>
<p>Could we split this out into its own PR?</p>
</blockquote>



<a name="457219245"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457219245" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457219245">(Aug 07 2024 at 22:59)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1708056792">PR review comment</a>:</p>
<blockquote>
<p>We shouldn't need this, or any other general instructions for the special registers. They should only be manipulated by instructions that are doing other stuff as well, eg <code>call</code> will set <code>lr</code>. But these registers aren't allocated by our register allocator and are reserved for their special purpose, so we shouldn't need to have general instructions for them.</p>
</blockquote>



<a name="457243453"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/457243453" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#457243453">(Aug 08 2024 at 02:04)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#issuecomment-2274800454">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "pulley"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: pulley</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="459513545"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459513545" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459513545">(Aug 09 2024 at 16:05)</a>:</h4>
<p>Kmeakin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2230568934">PR review</a>.</p>



<a name="459513546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459513546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459513546">(Aug 09 2024 at 16:05)</a>:</h4>
<p>Kmeakin created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1711732495">PR review comment</a>:</p>
<blockquote>
<p>Encodes the invariant that registers are always in the range <code>0..32</code>, so indexing into the registers array can never fail. The other option would be to use the <code>#[rustc_layout_scalar_valid_range_end(31)]</code> attribute, but that is nightly-only.</p>
</blockquote>



<a name="459517681"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459517681" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459517681">(Aug 09 2024 at 16:24)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2230606660">PR review</a>.</p>



<a name="459517683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459517683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459517683">(Aug 09 2024 at 16:24)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1711761382">PR review comment</a>:</p>
<blockquote>
<p>Are you saying we get better codegen with <code>enum</code>s here? That's neat, I wouldn't have expected the LLVM IR that rustc emits to change.</p>
</blockquote>



<a name="459520757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459520757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459520757">(Aug 09 2024 at 16:40)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="459521398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459521398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459521398">(Aug 09 2024 at 16:44)</a>:</h4>
<p>Kmeakin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2230645582">PR review</a>.</p>



<a name="459521399"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459521399" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459521399">(Aug 09 2024 at 16:44)</a>:</h4>
<p>Kmeakin created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1711791357">PR review comment</a>:</p>
<blockquote>
<p><a href="https://godbolt.org/z/jPrq5bc45">https://godbolt.org/z/jPrq5bc45</a></p>
<p>rustc emits calls to <code>assume</code> for types that have niches, and starting from LLVM 19 function parameters can have <code>range</code> metadata attached directly</p>
</blockquote>



<a name="459521940"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459521940" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459521940">(Aug 09 2024 at 16:48)</a>:</h4>
<p>Kmeakin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2230651250">PR review</a>.</p>



<a name="459521941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459521941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459521941">(Aug 09 2024 at 16:48)</a>:</h4>
<p>Kmeakin created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1711796217">PR review comment</a>:</p>
<blockquote>
<p>I'm a bit confused about the purpose of the <code>N</code> to <code>enter_frame</code>/<code>exit_frame</code>. Each <code>push</code>/<code>pop</code> will itself automatically adjust the sp by <code>size_of&lt;*u8&gt;()</code>. So in the case of no other registers being stored on the stack, the argument will be zero. In the case where other registers need to be saved on the stack, <code>xpush{32,64}</code> and <code>xpop{32,64}</code> will also adjust the sp by 4/8 bytes. So in either case the argument is not needed? I don't think there is any scenario where you would need to adjust the stack pointer without also reading/writing from/to the stack </p>
</blockquote>



<a name="459522060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459522060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459522060">(Aug 09 2024 at 16:49)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="459524018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459524018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459524018">(Aug 09 2024 at 17:00)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="459526796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459526796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459526796">(Aug 09 2024 at 17:10)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="459527589"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459527589" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459527589">(Aug 09 2024 at 17:13)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2230690435">PR review</a>.</p>



<a name="459527590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459527590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459527590">(Aug 09 2024 at 17:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1711830093">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>I'm a bit confused about the purpose of the <code>N</code> to <code>enter_frame</code>/<code>exit_frame</code>.</p>
</blockquote>
<p>To allocate the stack frame for this function, including all of its regalloc spills and all that.</p>
<p>That said, the way that Cranelift is organized and the abstraction boundaries it has might make doing the full function prologue in a single instruction difficult. We might have to settle for two instructions:</p>
<ol>
<li>a macro instruction for <code>push lr; push fp; fp = sp</code> (and the opposite for exiting the function, maybe just fold this into <code>ret</code>)</li>
<li>an instruction for allocating and deallocating stack space: <code>sp = sp +/- imm32</code></li>
</ol>
<p>See <code>gen_prologue_frame_setup</code>, <code>gen_epilogue_frame_restore</code>, and <code>gen_sp_reg_adjust</code> in <code>../pulley_shared/abi.rs</code> in <a href="https://github.com/bytecodealliance/wasmtime/pull/9089">https://github.com/bytecodealliance/wasmtime/pull/9089</a> (or the equivalent methods in, e.g., <code>../aarch64/abi.rs</code>). I'm thinking that each of these should produce a single macro instruction because they otherwise always generate the exact same sequence of instructions modulo immediate constant values.</p>
<p>The benefit of a single macro instruction, compared to a sequence of composable and more general instructions, is performance. The expensive part of an interpreter is roundtripping through the opcode loop, by using macro instructions we are amortizing that cost.</p>
<p>Does that make sense?</p>
</blockquote>



<a name="459540327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459540327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459540327">(Aug 09 2024 at 18:05)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="459560229"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459560229" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459560229">(Aug 09 2024 at 19:35)</a>:</h4>
<p>Kmeakin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2230919523">PR review</a>.</p>



<a name="459560230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459560230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459560230">(Aug 09 2024 at 19:35)</a>:</h4>
<p>Kmeakin created <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#discussion_r1712049325">PR review comment</a>:</p>
<blockquote>
<p>Decided the extra argument was not needed after all:<br>
<a href="#narrow/stream/217126-wasmtime/topic/Pulley.20registers/near/459533622">https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime/topic/Pulley.20registers/near/459533622</a></p>
</blockquote>



<a name="459580069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459580069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459580069">(Aug 09 2024 at 21:33)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="459580654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/459580654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#459580654">(Aug 09 2024 at 21:37)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="462863327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/462863327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#462863327">(Aug 16 2024 at 22:12)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#issuecomment-2294376958">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>:</p>
<blockquote>
<p>Heads up: the Pulley backend for Cranelift landed in #9089 and I think this can be rebased and landed now</p>
</blockquote>



<a name="462865078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/462865078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#462865078">(Aug 16 2024 at 22:31)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463400020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463400020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463400020">(Aug 19 2024 at 13:07)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463419985"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463419985" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463419985">(Aug 19 2024 at 14:25)</a>:</h4>
<p><strong>Kmeakin</strong> requested <a href="https://github.com/abrown">abrown</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463419988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463419988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463419988">(Aug 19 2024 at 14:25)</a>:</h4>
<p><strong>Kmeakin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463419991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463419991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463419991">(Aug 19 2024 at 14:25)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463420303"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463420303" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463420303">(Aug 19 2024 at 14:27)</a>:</h4>
<p>Kmeakin edited <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>:</p>
<blockquote>
<p>Pack the <code>dst</code>, <code>src1</code> and <code>src2</code> register operands of binary operators into 2 bytes. Solves the <code>TODO</code> at the top of <code>lib.rs</code>.</p>
<p>~This required moving the special registers into their own register class, and adding <code>smov</code> and <code>spush</code>/<code>spop</code> to interact with SP/FP.~<br>
I held off on splitting special registers into their own <code>SReg</code> class because I'm not sure how to integrate it with ISLE/Regalloc</p>
</blockquote>



<a name="463424644"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463424644" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463424644">(Aug 19 2024 at 14:47)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463430266"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463430266" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463430266">(Aug 19 2024 at 15:05)</a>:</h4>
<p>Kmeakin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<a name="463502624"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463502624" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463502624">(Aug 19 2024 at 20:10)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/9088#pullrequestreview-2246371649">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="463507008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%239088%20pulley%3A%20pack%20%60dst%60%2C%20%60src1%60%20and%20%60src2%60.../near/463507008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.239088.20pulley.3A.20pack.20.60dst.60.2C.20.60src1.60.20and.20.60src2.60.2E.2E.2E.html#463507008">(Aug 19 2024 at 20:27)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/9088">PR #9088</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>