<html>
<head><meta charset="utf-8"><title>wasmtime / issue #6844 Add support for vector in DataValu... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html">wasmtime / issue #6844 Add support for vector in DataValu...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="384669315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384669315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384669315">(Aug 14 2023 at 06:54)</a>:</h4>
<p>gurry <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1676776746">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<p><code>DataValueExt::int()</code> doesn't currently seem to have any tests. Please let me know if I should add any tests for this PR or for <code>DataValueExt::int()</code> in general.</p>
</blockquote>



<a name="384670064"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384670064" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384670064">(Aug 14 2023 at 06:58)</a>:</h4>
<p>gurry edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1676776746">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<p><code>DataValueExt::int()</code> doesn't currently seem to have any tests. Please let me know if I should add any tests for this PR or for <code>DataValueExt::int()</code> in general.</p>
<p>Wonder if it would be a good idea to create a test from the <code>.clif</code> in #6827 </p>
</blockquote>



<a name="384677542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384677542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384677542">(Aug 14 2023 at 07:32)</a>:</h4>
<p>gurry <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1676820615">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<p>Just saw that the test already exists:</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/30d086f78e1e53cc52f3918aba3edf397d98b6d7/cranelift/filetests/filetests/runtests/simd-ineg.clif#L30-L35">https://github.com/bytecodealliance/wasmtime/blob/30d086f78e1e53cc52f3918aba3edf397d98b6d7/cranelift/filetests/filetests/runtests/simd-ineg.clif#L30-L35</a> </p>
<p>So just enabled it for the interpreter.</p>
</blockquote>



<a name="384677589"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384677589" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384677589">(Aug 14 2023 at 07:32)</a>:</h4>
<p>gurry edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1676820615">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<p>Just saw that the test already exists:</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/30d086f78e1e53cc52f3918aba3edf397d98b6d7/cranelift/filetests/filetests/runtests/simd-ineg.clif#L30-L35">https://github.com/bytecodealliance/wasmtime/blob/30d086f78e1e53cc52f3918aba3edf397d98b6d7/cranelift/filetests/filetests/runtests/simd-ineg.clif#L30-L35</a> </p>
<p>So I've enabled it for the interpreter.</p>
</blockquote>



<a name="384738248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384738248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384738248">(Aug 14 2023 at 11:17)</a>:</h4>
<p>gurry <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1677135031">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<p>Thanks @afonso360 </p>
<p>In order to test with an 8 byte vector input to <code>DataValueExt::int()</code> I tried adding the following test to <code>simd-ineg.clif</code> but it crashed with the below trace:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">cargo</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">--</span><span class="n">test</span><span class="w"> </span><span class="n">filetests</span>
<span class="w">    </span><span class="n">Finished</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">[</span><span class="n">unoptimized</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">debuginfo</span><span class="p">]</span><span class="w"> </span><span class="n">target</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mf">0.47</span><span class="n">s</span>
<span class="w">     </span><span class="n">Running</span><span class="w"> </span><span class="n">tests</span><span class="o">/</span><span class="n">filetests</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="p">([</span><span class="o">..</span><span class="p">.]</span><span class="err">\</span><span class="n">wasmtime</span><span class="err">\</span><span class="n">target</span><span class="err">\</span><span class="n">debug</span><span class="err">\</span><span class="n">deps</span><span class="err">\</span><span class="n">filetests</span><span class="o">-</span><span class="n">d08e13383c5d8a1e</span><span class="p">.</span><span class="n">exe</span><span class="p">)</span>
<span class="n">slow</span>: <span class="mf">0.026</span><span class="w"> </span><span class="n">filetests</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">wasm</span><span class="err">\</span><span class="n">aarch64</span><span class="o">-</span><span class="n">relaxed</span><span class="o">-</span><span class="n">simd</span><span class="p">.</span><span class="n">wat</span>
<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">worker</span><span class="w"> </span>#<span class="mi">2</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">'</span><span class="na">called</span><span class="w"> </span><span class="err">`</span><span class="nb">Option</span>::<span class="n">unwrap</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">`</span><span class="nb">None</span><span class="err">`</span><span class="w"> </span><span class="n">value</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">cranelift</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">isa</span><span class="err">\</span><span class="n">x64</span><span class="err">\</span><span class="n">lower</span><span class="err">\</span><span class="n">isle</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">550</span>:<span class="mi">21</span>
<span class="n">stack</span><span class="w"> </span><span class="n">backtrace</span>:
   <span class="mi">0</span>: <span class="nc">std</span>::<span class="n">panicking</span>::<span class="n">begin_panic_handler</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="err">\</span><span class="n">std</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">593</span>
<span class="w">   </span><span class="mi">1</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic_fmt</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="err">\</span><span class="n">core</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">67</span>
<span class="w">   </span><span class="mi">2</span>: <span class="nc">core</span>::<span class="n">panicking</span>::<span class="n">panic</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="o">/</span><span class="n">library</span><span class="err">\</span><span class="n">core</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">117</span>
<span class="w">   </span><span class="mi">3</span>: <span class="nc">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">option</span>::<span class="nb">Option</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">args</span>::<span class="n">Gpr</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>::<span class="n">unwrap</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">inst</span>::<span class="n">args</span>::<span class="n">Gpr</span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="err">\</span><span class="n">library</span><span class="err">\</span><span class="n">core</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">option</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">935</span>
<span class="w">   </span><span class="mi">4</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="k">impl</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">gpr_new</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">isa</span><span class="err">\</span><span class="n">x64</span><span class="err">\</span><span class="n">lower</span><span class="err">\</span><span class="n">isle</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">550</span>
<span class="w">   </span><span class="mi">5</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">constructor_put_in_gpr</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">isle</span>::<span class="n">IsleContext</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">MInst</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="n">C</span>:<span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">gurinder</span><span class="p">.</span><span class="n">singh</span><span class="err">\</span><span class="n">Projects</span><span class="err">\</span><span class="n">Personal</span><span class="err">\</span><span class="n">wasmtime_dev</span><span class="err">\</span><span class="n">wasmtime</span><span class="err">\</span><span class="n">target</span><span class="err">\</span><span class="n">debug</span><span class="err">\</span><span class="n">build</span><span class="err">\</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="o">-</span><span class="mf">3e0280</span><span class="n">ce8237aaeb</span><span class="err">\</span><span class="n">out</span><span class="err">\</span><span class="n">isle_x64</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2610</span>
<span class="w">   </span><span class="mi">6</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">constructor_lower</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">isle</span>::<span class="n">IsleContext</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">MInst</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="n">C</span>:<span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">gurinder</span><span class="p">.</span><span class="n">singh</span><span class="err">\</span><span class="n">Projects</span><span class="err">\</span><span class="n">Personal</span><span class="err">\</span><span class="n">wasmtime_dev</span><span class="err">\</span><span class="n">wasmtime</span><span class="err">\</span><span class="n">target</span><span class="err">\</span><span class="n">debug</span><span class="err">\</span><span class="n">build</span><span class="err">\</span><span class="n">cranelift</span><span class="o">-</span><span class="n">codegen</span><span class="o">-</span><span class="mf">3e0280</span><span class="n">ce8237aaeb</span><span class="err">\</span><span class="n">out</span><span class="err">\</span><span class="n">isle_x64</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">16695</span>
<span class="w">   </span><span class="mi">7</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">lower</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">isa</span><span class="err">\</span><span class="n">x64</span><span class="err">\</span><span class="n">lower</span><span class="err">\</span><span class="n">isle</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">64</span>
<span class="w">   </span><span class="mi">8</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="k">impl</span><span class="cp">$</span><span class="mi">1</span>::<span class="n">lower</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">isa</span><span class="err">\</span><span class="n">x64</span><span class="err">\</span><span class="n">lower</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">325</span>
<span class="w">   </span><span class="mi">9</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">lower</span>::<span class="n">Lower</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">MInst</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>::<span class="n">lower_clif_block</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">MInst</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="o">&gt;</span><span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">machinst</span><span class="err">\</span><span class="n">lower</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">743</span>
<span class="w">  </span><span class="mi">10</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">lower</span>::<span class="n">Lower</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">MInst</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>::<span class="n">lower</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">lower</span>::<span class="n">isle</span>::<span class="n">generated_code</span>::<span class="n">MInst</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">machinst</span><span class="err">\</span><span class="n">lower</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1067</span>
<span class="w">  </span><span class="mi">11</span>: <span class="nc">cranelift_codegen</span>::<span class="n">machinst</span>::<span class="n">compile</span>::<span class="n">compile</span><span class="o">&lt;</span><span class="n">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">machinst</span><span class="err">\</span><span class="n">compile</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">40</span>
<span class="w">  </span><span class="mi">12</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="n">X64Backend</span>::<span class="n">compile_vcode</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">isa</span><span class="err">\</span><span class="n">x64</span><span class="err">\</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">61</span>
<span class="w">  </span><span class="mi">13</span>: <span class="nc">cranelift_codegen</span>::<span class="n">isa</span>::<span class="n">x64</span>::<span class="k">impl</span><span class="cp">$</span><span class="mi">1</span>::<span class="n">compile_function</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">isa</span><span class="err">\</span><span class="n">x64</span><span class="err">\</span><span class="k">mod</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">73</span>
<span class="w">  </span><span class="mi">14</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile_stencil</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">146</span>
<span class="w">  </span><span class="mi">15</span>: <span class="nc">cranelift_codegen</span>::<span class="n">context</span>::<span class="n">Context</span>::<span class="n">compile</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">codegen</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">context</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">206</span>
<span class="w">  </span><span class="mi">16</span>: <span class="nc">cranelift_jit</span>::<span class="n">backend</span>::<span class="k">impl</span><span class="cp">$</span><span class="mi">2</span>::<span class="n">define_function_with_control_plane</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">jit</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">backend</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">689</span>
<span class="w">  </span><span class="mi">17</span>: <span class="nc">cranelift_filetests</span>::<span class="n">function_runner</span>::<span class="n">TestFileCompiler</span>::<span class="n">define_function</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">function_runner</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">248</span>
<span class="w">  </span><span class="mi">18</span>: <span class="nc">cranelift_filetests</span>::<span class="n">function_runner</span>::<span class="n">TestFileCompiler</span>::<span class="n">add_functions</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">function_runner</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">148</span>
<span class="w">  </span><span class="mi">19</span>: <span class="nc">cranelift_filetests</span>::<span class="n">function_runner</span>::<span class="n">TestFileCompiler</span>::<span class="n">add_testfile</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">function_runner</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">165</span>
<span class="w">  </span><span class="mi">20</span>: <span class="nc">cranelift_filetests</span>::<span class="n">test_run</span>::<span class="n">compile_testfile</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">test_run</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">127</span>
<span class="w">  </span><span class="mi">21</span>: <span class="nc">cranelift_filetests</span>::<span class="n">test_run</span>::<span class="k">impl</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">run_target</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">test_run</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">197</span>
<span class="w">  </span><span class="mi">22</span>: <span class="nc">cranelift_filetests</span>::<span class="n">runone</span>::<span class="n">run</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">runone</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">102</span>
<span class="w">  </span><span class="mi">23</span>: <span class="nc">cranelift_filetests</span>::<span class="n">concurrent</span>::<span class="n">worker_thread</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">concurrent</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">152</span>
<span class="w">  </span><span class="mi">24</span>: <span class="nc">std</span>::<span class="n">panicking</span>::<span class="kr">try</span>::<span class="n">do_call</span><span class="o">&lt;</span><span class="n">cranelift_filetests</span>::<span class="n">concurrent</span>::<span class="n">worker_thread</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">closure_env</span><span class="cp">$</span><span class="mi">0</span><span class="p">,</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">result</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">time</span>::<span class="n">Duration</span><span class="p">,</span><span class="n">anyhow</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="err">\</span><span class="n">library</span><span class="err">\</span><span class="n">std</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">500</span>
<span class="w">  </span><span class="mi">25</span>: <span class="nc">std</span>::<span class="n">panicking</span>::<span class="kr">try</span>::<span class="n">do_catch</span><span class="o">&lt;</span><span class="n">cranelift_filetests</span>::<span class="n">concurrent</span>::<span class="n">worker_thread</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">closure_env</span><span class="cp">$</span><span class="mi">0</span><span class="p">,</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">result</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">time</span>::<span class="n">Duration</span><span class="p">,</span><span class="n">anyhow</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>
<span class="w">  </span><span class="mi">26</span>: <span class="nc">std</span>::<span class="n">panicking</span>::<span class="kr">try</span><span class="o">&lt;</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">result</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">time</span>::<span class="n">Duration</span><span class="p">,</span><span class="n">anyhow</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">,</span><span class="n">cranelift_filetests</span>::<span class="n">concurrent</span>::<span class="n">worker_thread</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">closure_env</span><span class="cp">$</span><span class="mi">0</span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="err">\</span><span class="n">library</span><span class="err">\</span><span class="n">std</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">panicking</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">464</span>
<span class="w">  </span><span class="mi">27</span>: <span class="nc">std</span>::<span class="n">panic</span>::<span class="n">catch_unwind</span><span class="o">&lt;</span><span class="n">cranelift_filetests</span>::<span class="n">concurrent</span>::<span class="n">worker_thread</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>::<span class="n">closure_env</span><span class="cp">$</span><span class="mi">0</span><span class="p">,</span><span class="n">enum2</span><span class="cp">$</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">result</span>::<span class="nb">Result</span><span class="o">&lt;</span><span class="n">core</span>::<span class="n">time</span>::<span class="n">Duration</span><span class="p">,</span><span class="n">anyhow</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">rustc</span><span class="o">/</span><span class="n">eb26296b556cef10fb713a38f3d16b9886080f26</span><span class="err">\</span><span class="n">library</span><span class="err">\</span><span class="n">std</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">panic</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">142</span>
<span class="w">  </span><span class="mi">28</span>: <span class="nc">cranelift_filetests</span>::<span class="n">concurrent</span>::<span class="n">worker_thread</span>::<span class="n">closure</span><span class="cp">$</span><span class="mi">0</span>
<span class="w">             </span><span class="n">at</span><span class="w"> </span><span class="p">.</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">src</span><span class="err">\</span><span class="n">concurrent</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">152</span>
<span class="n">note</span>: <span class="nb">Some</span> <span class="nc">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">omitted</span><span class="p">,</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="n">full</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">backtrace</span><span class="p">.</span>
<span class="n">FAIL</span><span class="w"> </span><span class="n">filetests</span><span class="err">\</span><span class="n">filetests</span><span class="err">\</span><span class="n">runtests</span><span class="err">\</span><span class="n">simd</span><span class="o">-</span><span class="n">ineg</span><span class="p">.</span><span class="n">clif</span>: <span class="nc">panicked</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span>#<span class="mi">2</span>: <span class="nc">called</span><span class="w"> </span><span class="err">`</span><span class="nb">Option</span>::<span class="n">unwrap</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">`</span><span class="nb">None</span><span class="err">`</span><span class="w"> </span><span class="n">value</span>
<span class="mi">1355</span><span class="w"> </span><span class="n">tests</span>
<span class="n">Error</span>: <span class="mi">1</span><span class="w"> </span><span class="n">failure</span>
<span class="n">error</span>: <span class="nc">test</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">rerun</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="err">`</span><span class="o">--</span><span class="n">test</span><span class="w"> </span><span class="n">filetests</span><span class="err">`</span>
</code></pre></div>
<p>While the interpreter worked fine, it was the compiler that crashed. Is this expected?<br>
</p>
</blockquote>



<a name="384740376"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384740376" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384740376">(Aug 14 2023 at 11:24)</a>:</h4>
<p>afonso360 <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1677143898">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<blockquote>
<p>While the interpreter worked fine, it was the compiler that crashed. Is this expected?</p>
</blockquote>
<p>Well, sort of. Ideally we would be able to compile all clif code, but 64 bit SIMD support is <em>very</em> incomplete both in the backends and in the interpreter itself. The only architectures that support it are AArch64 and RISC-V.</p>
<p>I think X86_64 has never supported it, so yeah I would expect it to crash there.</p>
</blockquote>



<a name="384740638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384740638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384740638">(Aug 14 2023 at 11:25)</a>:</h4>
<p>afonso360 edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1677143898">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<blockquote>
<p>While the interpreter worked fine, it was the compiler that crashed. Is this expected?</p>
</blockquote>
<p>Well, sort of. Ideally we would be able to compile all clif code, but 64 bit SIMD support is <em>very</em> incomplete both in the backends and in the interpreter itself. The only architectures that support it are AArch64 and RISC-V (And neither of those fully support it!).</p>
<p>I think X86_64 has never supported it, so yeah I would expect it to crash there.</p>
</blockquote>



<a name="384741625"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%236844%20Add%20support%20for%20vector%20in%20DataValu.../near/384741625" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.236844.20Add.20support.20for.20vector.20in.20DataValu.2E.2E.2E.html#384741625">(Aug 14 2023 at 11:28)</a>:</h4>
<p>gurry <a href="https://github.com/bytecodealliance/wasmtime/pull/6844#issuecomment-1677149047">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/6844">issue #6844</a>:</p>
<blockquote>
<p>Okay, makes sense. Thanks <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>