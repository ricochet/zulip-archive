<html>
<head><meta charset="utf-8"><title>wasmtime / PR #3800 Fuzz cranelift cpu flag settings with... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html">wasmtime / PR #3800 Fuzz cranelift cpu flag settings with...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="271893403"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271893403" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271893403">(Feb 14 2022 at 21:42)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/3800">PR #3800</a> from <code>fuzz-codegen-settings</code> to <code>main</code>:</p>
<blockquote>
<p>This commit updates the <code>Config</code> fuzz-generator to consume some of the<br>
input as configuration settings for codegen flags we pass to cranelift.<br>
This should allow for ideally some more coverage where settings are<br>
disabled or enabled, ideally finding possible bugs in feature-specific<br>
implementations or generic implementations that are rarely used if the<br>
feature-specific ones almost always take precedent.</p>
<p>The technique used in this commit is to weight selection of codegen<br>
settings less frequently than using the native settings. Afterwards each<br>
listed feature is individually enabled or disabled depending on the<br>
input fuzz data, and if a feature is enabled but the host doesn't<br>
actually support it then the fuzz input is rejected with a log message.<br>
The goal here is to still have many fuzz inputs accepted but also ensure<br>
determinism across hosts. If there's a bug specifically related to<br>
enabling a flag then running it on a host without the flag should<br>
indicate that the flag isn't supported rather than silently leaving it<br>
disabled and reporting the fuzz case a success.</p>
<p>&lt;!--</p>
<p>Please ensure that the following steps are all taken care of before submitting<br>
the PR.</p>
<ul>
<li>
<p>[ ] This has been discussed in issue #..., or if not, please tell us why<br>
  here.</p>
</li>
<li>
<p>[ ] A short description of what this does, why it is needed; if the<br>
  description becomes long, the matter should probably be discussed in an issue<br>
  first.</p>
</li>
<li>
<p>[ ] This PR contains test cases, if meaningful.</p>
</li>
<li>[ ] A reviewer from the core maintainer team has been assigned for this PR.<br>
  If you don't know who could review this, please indicate so. The list of<br>
  suggested reviewers on the right can help you.</li>
</ul>
<p>Please ensure all communication adheres to the <a href="https://github.com/bytecodealliance/wasmtime/blob/master/CODE_OF_CONDUCT.md">code of
conduct</a>.<br>
--&gt;<br>
</p>
</blockquote>



<a name="271893495"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271893495" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271893495">(Feb 14 2022 at 21:43)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/3800">PR #3800</a>.</p>



<a name="271898274"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271898274" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271898274">(Feb 14 2022 at 22:23)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3800#pullrequestreview-882254376">PR review</a>.</p>



<a name="271898275"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271898275" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271898275">(Feb 14 2022 at 22:23)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3800#pullrequestreview-882254376">PR review</a>.</p>



<a name="271898276"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271898276" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271898276">(Feb 14 2022 at 22:23)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/3800#discussion_r806286167">PR review comment</a>:</p>
<blockquote>
<p>By the way, I added a method upstream the other day that can make this a little nicer: <a href="https://docs.rs/arbitrary/latest/arbitrary/struct.Unstructured.html#method.ratio">https://docs.rs/arbitrary/latest/arbitrary/struct.Unstructured.html#method.ratio</a></p>
<p>(fwiw, I also added this method too: <a href="https://docs.rs/arbitrary/latest/arbitrary/struct.Unstructured.html#method.arbitrary_loop">https://docs.rs/arbitrary/latest/arbitrary/struct.Unstructured.html#method.arbitrary_loop</a>)</p>
</blockquote>



<a name="271992190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271992190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271992190">(Feb 15 2022 at 15:43)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3800">PR #3800</a> from <code>fuzz-codegen-settings</code> to <code>main</code>.</p>



<a name="271992204"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271992204" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271992204">(Feb 15 2022 at 15:43)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/3800#pullrequestreview-883195234">PR review</a>.</p>



<a name="271992205"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271992205" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271992205">(Feb 15 2022 at 15:43)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/3800#discussion_r806981373">PR review comment</a>:</p>
<blockquote>
<p>Nice!</p>
</blockquote>



<a name="271993682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271993682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271993682">(Feb 15 2022 at 15:53)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3800">PR #3800</a> from <code>fuzz-codegen-settings</code> to <code>main</code>.</p>



<a name="271995146"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/271995146" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#271995146">(Feb 15 2022 at 16:01)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/3800">PR #3800</a> from <code>fuzz-codegen-settings</code> to <code>main</code>.</p>



<a name="272033236"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%233800%20Fuzz%20cranelift%20cpu%20flag%20settings%20with.../near/272033236" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.233800.20Fuzz.20cranelift.20cpu.20flag.20settings.20with.2E.2E.2E.html#272033236">(Feb 15 2022 at 20:27)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/3800">PR #3800</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>