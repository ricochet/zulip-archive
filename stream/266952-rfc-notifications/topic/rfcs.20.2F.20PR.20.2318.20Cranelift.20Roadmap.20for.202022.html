<html>
<head><meta charset="utf-8"><title>rfcs / PR #18 Cranelift Roadmap for 2022 · rfc-notifications · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/index.html">rfc-notifications</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html">rfcs / PR #18 Cranelift Roadmap for 2022</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="263384038"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263384038" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263384038">(Dec 02 2021 at 01:52)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/rfcs/pull/18">PR #18</a> from <code>cranelift-2022</code> to <code>main</code>:</p>
<blockquote>
<p><a href="https://github.com/cfallin/rfcs/blob/cranelift-2022/accepted/cranelift-roadmap-2022.md">Markdown rendered</a></p>
<p>This is a roadmap for work on Cranelift in 2022, highlighting areas of interest and outlining the major projects that we want to focus on in the next year. It is meant to be part guiding document, part aspirational collection of interesting ideas and possibilities. As with <a href="https://github.com/bytecodealliance/rfcs/pull/8">last year's roadmap</a>, we likely won't accomplish all of it, though if we're fortunate we may achieve a good amount of it.</p>
<p>Thanks to @fitzgen for feedback on a draft, and many others (see Acknowledgments at end) for general input on these topics.</p>
<p>Apologies if this misses anything important -- I tried to be as comprehensive as possible, while still coalescing into general themes. I'm very curious what the community thinks and how folks feel about these ideas!</p>
</blockquote>



<a name="263405147"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263405147" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263405147">(Dec 02 2021 at 08:27)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821178452">PR review</a>.</p>



<a name="263405148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263405148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263405148">(Dec 02 2021 at 08:27)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r760858083">PR review comment</a>:</p>
<blockquote>
<p>There is also another design constraint: It shouldn't break parallel compilation to ensure that we don't drastically regress compilation times. Function compilation is currently entirely parallelizable as everything is local. Inlining however is an inherently non-local optimization.</p>
</blockquote>



<a name="263405408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263405408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263405408">(Dec 02 2021 at 08:30)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821182021">PR review</a>.</p>



<a name="263405409"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263405409" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263405409">(Dec 02 2021 at 08:30)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r760860867">PR review comment</a>:</p>
<blockquote>
<p>DWARF exception handling also requires a tail call to <code>_Unwind_Resume</code>.</p>
</blockquote>



<a name="263405592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263405592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263405592">(Dec 02 2021 at 08:33)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821184657">PR review</a>.</p>



<a name="263405593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263405593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263405593">(Dec 02 2021 at 08:33)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r760862860">PR review comment</a>:</p>
<blockquote>
<p>Also the landingpad must be able to take parameters. The x86_64 DWARF exception handling allows up to 4. Rustc requires 2.</p>
</blockquote>



<a name="263406052"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263406052" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263406052">(Dec 02 2021 at 08:36)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821188283">PR review</a>.</p>



<a name="263406053"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263406053" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263406053">(Dec 02 2021 at 08:36)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r760865700">PR review comment</a>:</p>
<blockquote>
<p>You could also differentially fuzz between perturbations of the same input.</p>
</blockquote>



<a name="263406245"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263406245" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263406245">(Dec 02 2021 at 08:38)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821190329">PR review</a>.</p>



<a name="263406246"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263406246" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263406246">(Dec 02 2021 at 08:38)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r760867222">PR review comment</a>:</p>
<blockquote>
<p>A moonshot idea, but what about exposing these details to the user. Then they could try to make better decisions than the compiler while still being guaranteed (assuming no bugs in clif) that the output isn't a miscompilation.</p>
</blockquote>



<a name="263407794"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263407794" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263407794">(Dec 02 2021 at 08:53)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821205957">PR review</a>.</p>



<a name="263407795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263407795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263407795">(Dec 02 2021 at 08:53)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r760878859">PR review comment</a>:</p>
<blockquote>
<p>This is definitely way-out-there, but I do like the idea of a programmable meta layer as a first-class user-exposed interface. In the EDA (electronic design automation) world, tools have pretty much all standardized on Tcl as a command language, and one can write scripts like "optimization1; optimization2; simplify x y z; ...". Similarly for the "strategy layer" in proof-automation/verification tools. This would need a lot of thought and is lower-priority than any of the work that directly benefits correctness testing, but, yes, cool idea!</p>
</blockquote>



<a name="263481928"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263481928" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263481928">(Dec 02 2021 at 18:36)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821863726">PR review</a>.</p>



<a name="263481929"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263481929" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263481929">(Dec 02 2021 at 18:36)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821863726">PR review</a>.</p>



<a name="263481930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263481930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263481930">(Dec 02 2021 at 18:36)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r761353223">PR review comment</a>:</p>
<blockquote>
<p>I think we actually <em>don't</em> want to encourage the use of things like <code>ref_to_int</code> and <code>int_to_ref</code>. This will still either suffer from the "whoops, no stack map entry for this value because its an <code>int</code> and not a <code>ref</code>" problem, or we will have to start adding stack map entries for <code>int</code>s derived from a <code>ref</code>, but then where do we stop? What about <code>int</code>s derived from an <code>int</code> derived from a <code>ref</code>? It gets messy really quick. Instead, I think we want to allow using <code>ref</code>s as address operands for loads and stores, and maybe a few other places where <code>int</code> operands are currently allowed, but <code>ref</code>s aren't (maybe even make <code>ref</code> usable <em>everywhere</em> <code>int</code> is, basically making them exactly the same <em>except</em> that <code>ref</code>s get stack map entries).</p>
<p>But all of this is a bit too much in the weeds for a roadmap RFC. I think it suffices to say that we should make <code>r{32,64}</code> usable for non-opaque GC objects where we can load from/store to their fields (including fields that are themselves <code>r{32,64}</code>s) inline instead of only with out-of-line VM functions like what would be required now.</p>
</blockquote>



<a name="263486522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263486522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263486522">(Dec 02 2021 at 19:10)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-821917101">PR review</a>.</p>



<a name="263486524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263486524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263486524">(Dec 02 2021 at 19:10)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r761391061">PR review comment</a>:</p>
<blockquote>
<p>Yeah, that's a good point. I guess I had been imagining the lowering of a field access to be a "cast to int, mask off the tag bits, and load, while carefully avoiding safepoints" sort of operation (because the ref is dead/unrooted after the cast). But that's a big footgun. First-class operators that use refs as pointers are almost certainly better in that regard. </p>
<p>One consideration I had in mind is that the conversion from ref to actual pointer actually needs to be a little bit flexible to work in various runtimes: I'm aware of at least low-bit tagging (classical "pointers are aligned so use 2/3 tag bits"), NaN boxing or upper-bit tagging generally (top 16 bits), and the JVM's "compressed oop" design where a 32-bit pointer is used in 64-bit space with <code>base + oop &lt;&lt; 3</code> (allowing a 2^35 / 32 GiB heap). We could in theory have a load_ref/store_ref that takes a mask, a shift, and an addend, but maybe there's something better.</p>
<p>Another possibility that occurs to me: allow casts to ints, and allow the user to generate CLIF as needed, but <em>also</em> take the ref itself as an arg to the load/store. This requires keeping the ref alive up to the point of use, at least at the CLIF level. (If the load/store isn't a safepoint for the particular runtime then the lowering can drop it.) So we'd have <code>int := ref_to_int r; actual_ptr := arbitrary_conversion(int); value := load_ref actual_ptr, r</code>.</p>
<p>Anyway, yeah, I'll update the RFC to be more generic on this point but this will be an interesting design discussion to have later!</p>
</blockquote>



<a name="263580652"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263580652" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263580652">(Dec 03 2021 at 13:39)</a>:</h4>
<p>eqrion submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-822663018">PR review</a>.</p>



<a name="263580653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/263580653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#263580653">(Dec 03 2021 at 13:39)</a>:</h4>
<p>eqrion created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r761944580">PR review comment</a>:</p>
<blockquote>
<p>I’d like to add another point on the design space of deriving pointers from GC objects, although agreed that it warrants a deeper discussion elsewhere.</p>
<p>An issue SpiderMonkey will have with the Wasm-GC proposal when we add optimizing support is that some of our GC objects are represented as a GC ref to a cell which contains a regular heap pointer to the actual data. The outline data’s lifetime is tied to the GC object and is freed with a finalizer. When we access a field/element for an object then, we need to acquire the data pointer and then get the field/element from the data pointer.</p>
<p>There’s a potential hazard here however if the GC ref’s lifetime ends before the use of the data pointer and there is a safepoint/collection after the GC ref’s lifetime ends and before the use of the data pointer. This can’t be solved with just allowing r32/r64 to be manipulated as integers as the derived data pointer is not a ref that can be traced and shouldn’t get a stackmap entry. SM solves this by adding a synthetic use of the original GC ref to any loads using the data pointer. This extends the lifetime of the GC ref to match all uses of the data pointer. There may be other solutions here as well.</p>
<p>Additionally, the outline data representation for GC objects is a pain for codegen efficiency and ideally would be eliminated. But that will require some work in the SM GC that may not be feasible right away.</p>
</blockquote>



<a name="264841303"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/264841303" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#264841303">(Dec 14 2021 at 11:09)</a>:</h4>
<p>akirilov-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-831347395">PR review</a>.</p>



<a name="264841304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/264841304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#264841304">(Dec 14 2021 at 11:09)</a>:</h4>
<p>akirilov-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r768558823">PR review comment</a>:</p>
<blockquote>
<p>Should we mention the flexible vectors proposal (given that @sparker-arm is looking at it)?</p>
</blockquote>



<a name="265250175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250175">(Dec 17 2021 at 03:32)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/rfcs/pull/18">PR #18</a> from <code>cranelift-2022</code> to <code>main</code>.</p>



<a name="265250344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250344">(Dec 17 2021 at 03:36)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-834810848">PR review</a>.</p>



<a name="265250345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250345">(Dec 17 2021 at 03:36)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r771083141">PR review comment</a>:</p>
<blockquote>
<p>That's a good point, thanks! I added a paragraph that describes the tradeoff. The three design points I can think of right away are</p>
<ul>
<li>Some sort of snapshotting, so that each function can be mutated separately while also accessing the function-to-be-inlined in a read-only way; or</li>
<li>Some kind of partially-parallel design, where we "stratify" the callgraph into a DAG of SCCs then scan a parallel frontier of inlining up the DAG, from leafs to roots, processing serially within each SCC (this is maximally parallel while still allowing the inliner to see already-inlined versions of functions it might in turn inline); or</li>
<li>Make inlining a special, optional, more costly pass that just operates serially, and takes a mutable borrow of the whole module or modules (collection of functions). This might be the best way to start.</li>
</ul>
</blockquote>



<a name="265250359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250359">(Dec 17 2021 at 03:36)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-834810941">PR review</a>.</p>



<a name="265250361"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250361" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250361">(Dec 17 2021 at 03:36)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r771083197">PR review comment</a>:</p>
<blockquote>
<p>Added "and dataflow", thanks!</p>
</blockquote>



<a name="265250371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250371">(Dec 17 2021 at 03:37)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-834811037">PR review</a>.</p>



<a name="265250372"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250372" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250372">(Dec 17 2021 at 03:37)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r771083283">PR review comment</a>:</p>
<blockquote>
<p>Yes, that's a good idea; added a mention of this.</p>
</blockquote>



<a name="265250386"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250386" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250386">(Dec 17 2021 at 03:38)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-834811345">PR review</a>.</p>



<a name="265250387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250387">(Dec 17 2021 at 03:38)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r771083560">PR review comment</a>:</p>
<blockquote>
<p>Updated this description to note that there is a design space to explore, and some constraints (avoiding rooting issues, also being flexible across different reference representations, such as indirection or tagging approaches).</p>
</blockquote>



<a name="265250429"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250429" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250429">(Dec 17 2021 at 03:38)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-834811395">PR review</a>.</p>



<a name="265250430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/265250430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#265250430">(Dec 17 2021 at 03:38)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/18#discussion_r771083629">PR review comment</a>:</p>
<blockquote>
<p>Added, thanks!</p>
</blockquote>



<a name="269180203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/269180203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#269180203">(Jan 24 2022 at 22:12)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-861574422">PR review</a>.</p>



<a name="269268789"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/269268789" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#269268789">(Jan 25 2022 at 15:01)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-862414880">PR review</a>.</p>



<a name="269279064"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/269279064" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#269279064">(Jan 25 2022 at 16:06)</a>:</h4>
<p>radu-matei submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-862514294">PR review</a>.</p>



<a name="269285480"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/269285480" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#269285480">(Jan 25 2022 at 16:48)</a>:</h4>
<p>mingqiusun closed without merge <a href="https://github.com/bytecodealliance/rfcs/pull/18">PR #18</a>.</p>



<a name="269285613"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/269285613" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#269285613">(Jan 25 2022 at 16:49)</a>:</h4>
<p>mingqiusun reopened <a href="https://github.com/bytecodealliance/rfcs/pull/18">PR #18</a> from <code>cranelift-2022</code> to <code>main</code>.</p>



<a name="269304137"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/269304137" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#269304137">(Jan 25 2022 at 18:46)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/rfcs/pull/18#pullrequestreview-862720230">PR review</a>.</p>



<a name="270792682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/270792682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#270792682">(Feb 05 2022 at 00:46)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/rfcs/pull/18">PR #18</a>.</p>



<a name="281195827"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2318%20Cranelift%20Roadmap%20for%202022/near/281195827" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2318.20Cranelift.20Roadmap.20for.202022.html#281195827">(May 04 2022 at 18:05)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/rfcs/pull/18">PR #18</a> from <code>cranelift-2022</code> to <code>main</code>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/rfcs/blob/main/accepted/cranelift-roadmap-2022.md">Markdown rendered</a></p>
<p>This is a roadmap for work on Cranelift in 2022, highlighting areas of interest and outlining the major projects that we want to focus on in the next year. It is meant to be part guiding document, part aspirational collection of interesting ideas and possibilities. As with <a href="https://github.com/bytecodealliance/rfcs/pull/8">last year's roadmap</a>, we likely won't accomplish all of it, though if we're fortunate we may achieve a good amount of it.</p>
<p>Thanks to @fitzgen for feedback on a draft, and many others (see Acknowledgments at end) for general input on these topics.</p>
<p>Apologies if this misses anything important -- I tried to be as comprehensive as possible, while still coalescing into general themes. I'm very curious what the community thinks and how folks feel about these ideas!</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>