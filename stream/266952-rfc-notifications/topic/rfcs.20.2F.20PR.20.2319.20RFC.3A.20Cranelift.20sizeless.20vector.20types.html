<html>
<head><meta charset="utf-8"><title>rfcs / PR #19 RFC: Cranelift sizeless vector types · rfc-notifications · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/index.html">rfc-notifications</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html">rfcs / PR #19 RFC: Cranelift sizeless vector types</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="265279263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279263">(Dec 17 2021 at 10:38)</a>:</h4>
<p>sparker-arm opened <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>:</p>
<blockquote>
<p>Copyright (c) 2021, Arm Limited.</p>
</blockquote>



<a name="265279447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279447">(Dec 17 2021 at 10:40)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835085273">PR review</a>.</p>



<a name="265279448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279448">(Dec 17 2021 at 10:40)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771289479">PR review comment</a>:</p>
<blockquote>
<p>Please take it from the special types range instead.</p>
</blockquote>



<a name="265279685"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279685" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279685">(Dec 17 2021 at 10:42)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771290882">PR review comment</a>:</p>
<blockquote>
<p>Riscv allows smaller vectors, right?</p>
</blockquote>



<a name="265279686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279686">(Dec 17 2021 at 10:42)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835089236">PR review</a>.</p>



<a name="265279770"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279770" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279770">(Dec 17 2021 at 10:43)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835092003">PR review</a>.</p>



<a name="265279771"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265279771" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265279771">(Dec 17 2021 at 10:43)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771291635">PR review comment</a>:</p>
<blockquote>
<p>Will operations like <code>iadd</code> work just like with regular vectors?</p>
</blockquote>



<a name="265282087"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265282087" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265282087">(Dec 17 2021 at 11:05)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835112880">PR review</a>.</p>



<a name="265282088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265282088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265282088">(Dec 17 2021 at 11:05)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771310562">PR review comment</a>:</p>
<blockquote>
<p>Yes, apparently so, but the flexible vector spec does not.</p>
</blockquote>



<a name="265282296"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265282296" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265282296">(Dec 17 2021 at 11:07)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835114667">PR review</a>.</p>



<a name="265282297"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265282297" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265282297">(Dec 17 2021 at 11:07)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771311848">PR review comment</a>:</p>
<blockquote>
<p>Yes, I think most polymorphic instructions can just be extended for sizeless types too. I've currently implemented: iadd, isub, imul, fadd, fsub and splat.</p>
</blockquote>



<a name="265284220"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265284220" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265284220">(Dec 17 2021 at 11:27)</a>:</h4>
<p>akirilov-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835131121">PR review</a>.</p>



<a name="265284221"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265284221" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265284221">(Dec 17 2021 at 11:27)</a>:</h4>
<p>akirilov-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771323710">PR review comment</a>:</p>
<blockquote>
<p>Also, the flexible vectors specification might introduce the requirement that the underlying vector length is a power of 2, even though the Arm SVE and the RISC-V V extension, I suppose, do not have similar restrictions. Whether our IR should cover more than the common use cases (such as the Wasm flexible vectors, power-of-2 vector sizes, etc.) is something to discuss.</p>
</blockquote>



<a name="265365343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265365343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265365343">(Dec 17 2021 at 21:50)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-835662906">PR review</a>.</p>



<a name="265365344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/265365344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#265365344">(Dec 17 2021 at 21:50)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r771711221">PR review comment</a>:</p>
<blockquote>
<p>It seems to me that supporting more general expressivity at the CLIF level is a good thing to establish early on if we plan to do it at all, or else we'll bake in a lot of assumptions to code that operates on these types, over time. So non-power-of-2 sizes is something to include (and test for) early. It does seem valuable to me to support this if underlying hardware commonly does.</p>
<p>On the other hand, we don't want to come up with a design that requires handling difficult edge-cases; emulating smaller vector support than the fundamental unit seems like a good example of that. (Edge-cases if one were to try to emulate with bigger ops involve e.g. ensuring loads/stores don't run beyond the end of the heap, and having smaller alignments than usual.) So scaling down to 64 bits seems like an unreasonable goal just because one possible future platform supports it. So, I'd tentatively suggest a 128-bit minimum size.</p>
</blockquote>



<a name="266849333"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/266849333" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#266849333">(Jan 04 2022 at 19:02)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-843901415">PR review</a>.</p>



<a name="266849334"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/266849334" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#266849334">(Jan 04 2022 at 19:02)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-843901415">PR review</a>.</p>



<a name="266849335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/266849335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#266849335">(Jan 04 2022 at 19:02)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r778315519">PR review comment</a>:</p>
<blockquote>
<p>To avoid ambiguity, we should rename <code>is_vector</code> to <code>is_sized_vector</code> if we move forward with this.</p>
</blockquote>



<a name="270217400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/270217400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#270217400">(Feb 01 2022 at 14:18)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="270218705"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/270218705" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#270218705">(Feb 01 2022 at 14:26)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-869203615">PR review</a>.</p>



<a name="270218706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/270218706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#270218706">(Feb 01 2022 at 14:26)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r796648005">PR review comment</a>:</p>
<blockquote>
<p>Updated in latest version.</p>
</blockquote>



<a name="271901278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271901278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271901278">(Feb 14 2022 at 22:53)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-882271718">PR review</a>.</p>



<a name="271901279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271901279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271901279">(Feb 14 2022 at 22:53)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-882271718">PR review</a>.</p>



<a name="271901280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271901280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271901280">(Feb 14 2022 at 22:53)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r806300030">PR review comment</a>:</p>
<blockquote>
<p>What does "vector_scale" mean in this context? Number of basic-vector-register units in the vector value's width, or...?</p>
</blockquote>



<a name="271901281"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271901281" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271901281">(Feb 14 2022 at 22:53)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r806299155">PR review comment</a>:</p>
<blockquote>
<p>We can definitely talk about designs that allow for different spill slot sizes; I can imagine a notion of "multiple spill slot spaces" (i.e., different index domains managed separately).</p>
<p>But I think the simplest approach here is what we had talked about before: allocate vector registers as the basic unit; they are as wide as they are, and both v128-typed values and bigger-sizeless-typed values allocate one vector register. The spillslot then needs to be as big as the actual register width but otherwise this scheme seems reasonable enough to me.</p>
<p>(FWIW, <a href="http://regalloc.rs">regalloc.rs</a> and regalloc2 have the same design regarding spillslot abstractions and API, so the same considerations apply both before and after migration)</p>
</blockquote>



<a name="271901282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271901282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271901282">(Feb 14 2022 at 22:53)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r806302028">PR review comment</a>:</p>
<blockquote>
<p>Key question that remains for me here just from reading the RFC: at what time do we know the size (i.e., at compile time or only at runtime -- I think in discussion you had said it will be known at compile time?), and then how is this communicated to the ABI code?</p>
<p>Is the size of a sizeless vector actually always given by a method on the <code>TargetIsa</code>, and this is meant to be queried by the ABI code? Or does it have to be passed into the prologue somehow by e.g. giving it a global value that loads this config from a vmctx or register or...?</p>
</blockquote>



<a name="271952024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271952024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271952024">(Feb 15 2022 at 10:13)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-882756342">PR review</a>.</p>



<a name="271952025"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271952025" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271952025">(Feb 15 2022 at 10:13)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r806667049">PR review comment</a>:</p>
<blockquote>
<p>This is the number of bytes of a  'sizeless' vector, allowing us to take a slot index and calculate an address. </p>
</blockquote>



<a name="271952403"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271952403" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271952403">(Feb 15 2022 at 10:16)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-882760375">PR review</a>.</p>



<a name="271952404"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271952404" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271952404">(Feb 15 2022 at 10:16)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r806669962">PR review comment</a>:</p>
<blockquote>
<p>The current proposal only gets us half way to the runtime length support, as the register allocator wants a fixed number for a the size of a spill slot for a given register class. I've tried to enable 'sizeless' as much as possible with the hope of playing with regalloc2 to enable full runtime support later. So, for now, TargetIsa would have to provide a fixed size and so TargetIsa is passed, instead of settings::Flags, when calling new on ABICalleeImpl.</p>
</blockquote>



<a name="271955495"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271955495" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271955495">(Feb 15 2022 at 10:44)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-882793981">PR review</a>.</p>



<a name="271955496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/271955496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#271955496">(Feb 15 2022 at 10:44)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r806694524">PR review comment</a>:</p>
<blockquote>
<p>I'd add that modifying the backend ABI implementations to further support runtime lengths shouldn't be complicated but there is the issue of the frame size calculation for stack size checks and offset initialization, and I haven't looked into this much.</p>
</blockquote>



<a name="272834971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272834971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272834971">(Feb 22 2022 at 17:10)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890107468">PR review</a>.</p>



<a name="272834974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272834974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272834974">(Feb 22 2022 at 17:10)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812172076">PR review comment</a>:</p>
<blockquote>
<p>@cfallin, @sparker-arm: I just caught up on all of the recent discussion above for how to implement this proposal in a platform-agnostic way, etc. It's good stuff and I think I understand a lot better your thoughts from the examples given.</p>
<p>I do think, though, that this point is unaddressed by the comments about creating dynamic types in the prologue: if we create a dynamic type of a certain length, how then could we change that length dynamically? @penzn included a <a href="https://github.com/WebAssembly/flexible-vectors/blob/main/proposals/flexible-vectors/FlexibleVectorsThirdTier.md">set of <code>set_length</code> instructions</a> (with caveats about needing more discussion). @sunfishcode had an alternate design idea here and, @sparker-arm, you've commented in the issue (<a href="https://github.com/WebAssembly/flexible-vectors/issues/21">https://github.com/WebAssembly/flexible-vectors/issues/21</a>).</p>
<p>My point is: I sense a mismatch with this dynamic type idea and <code>set_length</code> and I think we should figure that out (here or in the flexible vectors repository) before something gets designed that precludes it.</p>
</blockquote>



<a name="272835034"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272835034" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272835034">(Feb 22 2022 at 17:11)</a>:</h4>
<p>abrown edited <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812172076">PR review comment</a>.</p>



<a name="272836430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272836430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272836430">(Feb 22 2022 at 17:19)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890119271">PR review</a>.</p>



<a name="272836431"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272836431" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272836431">(Feb 22 2022 at 17:19)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812180553">PR review comment</a>:</p>
<blockquote>
<p>Ah, that is a really interesting twist!</p>
<p>I haven't fully digested the examples in that issue but e.g. the existence of a <code>vec_loop</code> primitive together with dynamically-sized vectors makes me think that somehow there should be a lowering step involved: once the code reaches CLIF, there is no more vector-specific loop primitive, so whatever blocking or grouping that the <code>vec_loop</code> does, and how it interacts with the truly dynamic and resizable size, should be lowered onto "fixed for the function invocation"-sized chunks.</p>
<p>Also from a codegen perspective, resizable types have implications on stackframe layout: what does it mean for the regalloc if we end up having to spill <code>v0</code>, but <code>v0</code> has a type whose size changes throughout the function body?</p>
<p>So I think there is a difficulty/complexity jump from "dynamically sized, known at function entry" and "dynamically sized, changes size at arbitrary times" and we should figure out if we can lower the latter (at Wasm level) onto the former (at CLIF level) if we can. Curious if there are other ideas here though!</p>
</blockquote>



<a name="272837964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272837964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272837964">(Feb 22 2022 at 17:30)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890134441">PR review</a>.</p>



<a name="272837965"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272837965" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272837965">(Feb 22 2022 at 17:30)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812190803">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>resizable types have implications on stackframe layout</p>
</blockquote>
<p>Brainstorming: it feels like there are two parts here, 1) the size of the slot that needs to be spilled, which could be the "max vector size on this uarch," like the <code>dt0</code> example above, and 2) the number of lanes used by that vector, which could be modified by <code>set_length</code>. Even if only the lowest few lanes are used, the entire vector can be spilled, right?</p>
</blockquote>



<a name="272838261"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272838261" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272838261">(Feb 22 2022 at 17:32)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890136671">PR review</a>.</p>



<a name="272838262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272838262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272838262">(Feb 22 2022 at 17:32)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812192727">PR review comment</a>:</p>
<blockquote>
<p>I guess I'm saying that the type need not be resizable, but there should be some other way to express how much of that type is being used.</p>
</blockquote>



<a name="272838280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272838280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272838280">(Feb 22 2022 at 17:32)</a>:</h4>
<p>abrown edited <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812192727">PR review comment</a>.</p>



<a name="272848023"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272848023" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272848023">(Feb 22 2022 at 18:40)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890214866">PR review</a>.</p>



<a name="272848028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272848028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272848028">(Feb 22 2022 at 18:40)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812249888">PR review comment</a>:</p>
<blockquote>
<p>Yep, that's true; maybe what we want is an extra parameter on the operations that actually use the vector, to indicate how many lanes to operate on. So the type is <code>Nxi32</code> where N is the max size (could be dynamic, but fixed at function entry); and we then do an add on <code>Mxi32</code> units, where <code>M</code> was set by the latest <code>set_length</code>. I think this would imply tracking a separate "current length" variable for each dynamically-typed-and-resizable vector in the Wasm translator when building the SSA for CLIF. Does that seem reasonable?</p>
</blockquote>



<a name="272849953"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272849953" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272849953">(Feb 22 2022 at 18:55)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890230571">PR review</a>.</p>



<a name="272849954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272849954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272849954">(Feb 22 2022 at 18:55)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812261480">PR review comment</a>:</p>
<blockquote>
<p>I think Petr's idea for <code>set_length</code> was even more dynamic than that--it can accept arbitrary <code>i32</code> values from the stack. I might be misunderstanding what you mean, but we wouldn't know what that <code>M</code> is until runtime, so it couldn't be fixed during translation. But maybe you mean that that "variable" in translation would be made available for <code>set_length</code> to change at runtime?</p>
</blockquote>



<a name="272853504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272853504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272853504">(Feb 22 2022 at 19:19)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890256610">PR review</a>.</p>



<a name="272853507"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272853507" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272853507">(Feb 22 2022 at 19:19)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812280373">PR review comment</a>:</p>
<blockquote>
<p>Yes, exactly, it would be a variable that has an SSA <code>Value</code> at any given program point, like other Wasm locals, so truly dynamic. Then we could have something like <code>add_dynamic.dt0 v0, v1, v2</code> where <code>v0</code> and <code>v1</code> have type <code>dt0</code> (which is <code>Nxi32</code>, set to the max possible size), and <code>v2</code> is an <code>i32</code> that tells the op how many lanes to operate on.</p>
</blockquote>



<a name="272918037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272918037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272918037">(Feb 23 2022 at 08:38)</a>:</h4>
<p>sparker-arm submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-890753721">PR review</a>.</p>



<a name="272918038"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/272918038" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#272918038">(Feb 23 2022 at 08:38)</a>:</h4>
<p>sparker-arm created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r812658919">PR review comment</a>:</p>
<blockquote>
<p>Just to note, my understanding was the vec_loop construct won't be pursued and instead predication, as @cfallin is suggesting here, will be the way to go. We can add predicated operations for those if/when it happens. As @abrown said, when it comes to spilling, I also presume predication (set_length) won't affect this, we'll still spill a whole register.</p>
</blockquote>



<a name="277858305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/277858305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#277858305">(Apr 05 2022 at 10:50)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="278707920"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/278707920" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#278707920">(Apr 12 2022 at 15:16)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="279636857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279636857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279636857">(Apr 21 2022 at 05:06)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-948047434">PR review</a>.</p>



<a name="279636858"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279636858" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279636858">(Apr 21 2022 at 05:06)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-948047434">PR review</a>.</p>



<a name="279636859"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279636859" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279636859">(Apr 21 2022 at 05:06)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r854776283">PR review comment</a>:</p>
<blockquote>
<p>Indeed, "not allowed" rather than just "not expected" -- the semantics are as-if loaded once in the prologue.</p>
</blockquote>



<a name="279636860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279636860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279636860">(Apr 21 2022 at 05:06)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/19#discussion_r854776408">PR review comment</a>:</p>
<blockquote>
<p>s/accidently/accidentally/</p>
</blockquote>



<a name="279650322"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279650322" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279650322">(Apr 21 2022 at 08:30)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="279650405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279650405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279650405">(Apr 21 2022 at 08:31)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="279663006"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279663006" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279663006">(Apr 21 2022 at 10:50)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="279734615"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/279734615" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#279734615">(Apr 21 2022 at 20:21)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-949174157">PR review</a>.</p>



<a name="280034040"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/280034040" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#280034040">(Apr 25 2022 at 07:52)</a>:</h4>
<p><strong>sparker-arm</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a>.</p>



<a name="280350131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/280350131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#280350131">(Apr 27 2022 at 13:32)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="280457037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/280457037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#280457037">(Apr 28 2022 at 07:51)</a>:</h4>
<p>sparker-arm updated <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a> from <code>cranelift-sizeless-vector</code> to <code>main</code>.</p>



<a name="280529496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/280529496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#280529496">(Apr 28 2022 at 17:37)</a>:</h4>
<p>penzn submitted <a href="https://github.com/bytecodealliance/rfcs/pull/19#pullrequestreview-956825650">PR review</a>.</p>



<a name="281861683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2319%20RFC%3A%20Cranelift%20sizeless%20vector%20types/near/281861683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2319.20RFC.3A.20Cranelift.20sizeless.20vector.20types.html#281861683">(May 10 2022 at 17:52)</a>:</h4>
<p>sparker-arm merged <a href="https://github.com/bytecodealliance/rfcs/pull/19">PR #19</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>