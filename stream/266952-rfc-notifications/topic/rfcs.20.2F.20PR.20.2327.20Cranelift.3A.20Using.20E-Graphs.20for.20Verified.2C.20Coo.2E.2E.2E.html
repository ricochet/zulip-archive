<html>
<head><meta charset="utf-8"><title>rfcs / PR #27 Cranelift: Using E-Graphs for Verified, Coo... · rfc-notifications · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/index.html">rfc-notifications</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html">rfcs / PR #27 Cranelift: Using E-Graphs for Verified, Coo...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="287971503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287971503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287971503">(Jun 30 2022 at 03:59)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/rfcs/pull/27">PR #27</a> from <code>cranelift-egraphs</code> to <code>main</code>:</p>
<blockquote>
<p><a href="https://github.com/cfallin/rfcs/blob/cranelift-egraphs/accepted/cranelift-egraph.md">Rendered</a></p>
<p>This RFC proposes to add a <a href="https://en.wikipedia.org/wiki/Compiler#Middle_end">middle-end optimization framework</a> to Cranelift based on <a href="https://en.wikipedia.org/wiki/E-graph">e-graphs</a>. A middle-end<br>
optimization framework works to improve the target-independent <a href="https://en.wikipedia.org/wiki/Intermediate_representation">IR (intermediate representation)</a>, <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/docs/ir.md">CLIF</a>, before Cranelift translates it to machine instructions. Cranelift already has some basic  ptimizations in this category: <a href="https://en.wikipedia.org/wiki/Value_numbering">Global Value Numbering (GVN)</a>, <a href="https://en.wikipedia.org/wiki/Loop-invariant_code_motion">Loop-Independent Code Motion (LICM)</a>, <a href="https://en.wikipedia.org/wiki/Constant_folding">Constant folding</a>, and most recently, a very basic form of <a href="https://en.wikipedia.org/wiki/Alias_analysis">alias analysis</a> and redundant-load elimination. However, the current situation falls short in several ways.</p>
<p>The RFC will first describe how the current situation suffers from three problems: how to order and interleave these optimizations as we build more of them (the <em>phase-ordering problem</em>), how to ensure they are correct when they are all delicate hand-written code (the <em>verification problem</em>), and how to make it easier to build up a large body of known simplifications without tedious handwritten code. It will then describe how an e-graph-based framework could address all<br>
three of these problems. It will describe some novel contributions in how to encode control flow in e-graphs (necessary in order to use e-graphs to optimize whole function bodies) developed during initial experimentation. Then finally it will discuss how we can use our existing rewrite-rule DSL, <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/isle/docs/language-reference.md">ISLE</a>, to describe rewrites on the e-graph.</p>
</blockquote>



<a name="287991551"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287991551" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287991551">(Jun 30 2022 at 08:23)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r910746950">PR review comment</a>:</p>
<blockquote>
<p>*hash-consing</p>
</blockquote>



<a name="287991554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287991554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287991554">(Jun 30 2022 at 08:23)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1024468246">PR review</a>.</p>



<a name="287991695"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287991695" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287991695">(Jun 30 2022 at 08:24)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1024470093">PR review</a>.</p>



<a name="287991696"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287991696" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287991696">(Jun 30 2022 at 08:24)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r910748217">PR review comment</a>:</p>
<blockquote>
<p>*function</p>
</blockquote>



<a name="287991751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287991751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287991751">(Jun 30 2022 at 08:25)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1024470985">PR review</a>.</p>



<a name="287991754"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/287991754" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#287991754">(Jun 30 2022 at 08:25)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r910748873">PR review comment</a>:</p>
<blockquote>
<p>*using</p>
</blockquote>



<a name="288070863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288070863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288070863">(Jun 30 2022 at 18:44)</a>:</h4>
<p>eqrion created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r911348157">PR review comment</a>:</p>
<blockquote>
<p>I've not had a chance to read this paper yet [1], but do you know if PEG's are another graph-based IR in this category?</p>
<p>[1] <a href="https://rosstate.org/publications/eqsat/">https://rosstate.org/publications/eqsat/</a></p>
</blockquote>



<a name="288070865"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288070865" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288070865">(Jun 30 2022 at 18:44)</a>:</h4>
<p>eqrion submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1025351257">PR review</a>.</p>



<a name="288072739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288072739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288072739">(Jun 30 2022 at 19:00)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1025368471">PR review</a>.</p>



<a name="288072740"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288072740" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288072740">(Jun 30 2022 at 19:00)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r911359784">PR review comment</a>:</p>
<blockquote>
<p>Thanks for the link -- I wasn't aware of PEGs previously, but they look to be in the same family as the other approaches! The theta-nodes for loops (see e.g. Fig. 2 in the POPL 2009 paper) indicate to me that these are region-based, like VSDGs, so the same discussion points apply (vs. the retained-CFG-skeleton approach here). I see also in the description that they compute each node at most once, and as a result do partial-redundancy elimination, whereas we take an approach trying to preserve our existing GVN semantics and only compute a value when we know it will be used, which is generally safer from an optimization-always-improves-perf point of view.</p>
</blockquote>



<a name="288078029"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288078029" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288078029">(Jun 30 2022 at 19:45)</a>:</h4>
<p>jameysharp submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1025413944">PR review</a>.</p>



<a name="288078030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288078030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288078030">(Jun 30 2022 at 19:45)</a>:</h4>
<p>jameysharp created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r911390807">PR review comment</a>:</p>
<blockquote>
<p>I haven't checked whether this applies to Program Expression Graphs specifically, but similar dataflow-based IRs like the <a href="https://homes.cs.washington.edu/~mernst/pubs/vdg-popl94.pdf">Value Dependence Graph</a> don't preserve non-termination. A loop that doesn't terminate might not define any values used later and would then be removed, "because CFG values that are not demanded do not appear." Also, the "Equality Saturation" paper you cited has a whole side thing (section 6.1) about handling side-effects like heap access, because that's another challenge for purely dataflow IRs.</p>
<p>This is what distinguishes the Value State Dependence Graph and the newer Regionalized VSDG. Treating state and termination dependencies as additional pseudo-dataflow edges means any topological sort of the graph is a valid serialization.</p>
<p>I assume Chris' approach preserves termination and side effects (at the cost of missing some optimization opportunities that might be safe) but I haven't looked at it carefully enough yet to understand how it does that. From what I've heard so far I suspect it's different than anything I've seen in the literature.</p>
</blockquote>



<a name="288078169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288078169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288078169">(Jun 30 2022 at 19:46)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/rfcs/pull/27">PR #27</a> from <code>cranelift-egraphs</code> to <code>main</code>.</p>



<a name="288078504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288078504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288078504">(Jun 30 2022 at 19:49)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1025418133">PR review</a>.</p>



<a name="288078505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/288078505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#288078505">(Jun 30 2022 at 19:49)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r911393685">PR review comment</a>:</p>
<blockquote>
<p>Yes, the approach proposed in this RFC preserves both termination and side-effects in a somewhat simple way: by just keeping that part of the CFG around. Or more precisely, it maintains a "skeleton", which is a list of eclass IDs in each basic block of side-effecting ops in original order. This is then used during the scoped elaboration to schedule the pure ops back into the spaces between them. One nice property of this, also, is that we stay close enough to the original CFG that we could actually do the roundtrip in a way that never has to move instruction data (memory traffic is expensive!) except when a node is truly duplicated: the skeleton's instructions are stored in the original <code>ir::Function</code>, and the original copy of each e-node remains in the <code>ir::Function</code> as well.</p>
</blockquote>



<a name="293625907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293625907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293625907">(Aug 15 2022 at 21:45)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/rfcs/pull/27">PR #27</a> from <code>cranelift-egraphs</code> to <code>main</code>.</p>



<a name="293748208"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748208" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748208">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1074243423">PR review</a>.</p>



<a name="293748209"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748209" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748209">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1074243423">PR review</a>.</p>



<a name="293748210"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748210" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748210">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946864808">PR review comment</a>:</p>
<blockquote>
<p>Total nit: loop-invariant not loop-independent</p>
</blockquote>



<a name="293748212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748212">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946866390">PR review comment</a>:</p>
<blockquote>
<p>the re-inventing the wheel problem :D </p>
</blockquote>



<a name="293748213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748213">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946878115">PR review comment</a>:</p>
<blockquote>
<p>Nit: if we're being precise, in the egraph itself, the references are to other eclasses, not other enodes. Unless aegraphs differ from egg-style egraphs here? </p>
</blockquote>



<a name="293748214"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748214" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748214">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946874078">PR review comment</a>:</p>
<blockquote>
<p>Ruler would be another good external cite here: <a href="https://www.mwillsey.com/papers/ruler">https://www.mwillsey.com/papers/ruler</a></p>
</blockquote>



<a name="293748215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748215">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946875477">PR review comment</a>:</p>
<blockquote>
<p>Nit: ID not defined at this point</p>
</blockquote>



<a name="293748217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748217">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946873714">PR review comment</a>:</p>
<blockquote>
<p>Might be worth mentioning here that verification results still need to trust the rule application engine, but that in the rule-based world, you get to centralize the core that you need to trust.</p>
</blockquote>



<a name="293748219"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293748219" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293748219">(Aug 16 2022 at 16:07)</a>:</h4>
<p>avanhatt created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r946967052">PR review comment</a>:</p>
<blockquote>
<p>Basic question (sorry): is there an external source that detailed the operations/behavior on a scoped hashmap? When I've implemented GVN in the past it's been with a standard hashmap. I want to think of the scoped hashmap as conceptually equivalent to a stack of hashmaps, but I don't think that's quite right when a value spans multiple scopes.</p>
</blockquote>



<a name="293914068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914068">(Aug 17 2022 at 14:57)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/rfcs/pull/27">PR #27</a> from <code>cranelift-egraphs</code> to <code>main</code>.</p>



<a name="293914211"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914211" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914211">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1075902711">PR review</a>.</p>



<a name="293914212"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914212" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914212">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r948054129">PR review comment</a>:</p>
<blockquote>
<p>I just added a paragraph to describe this -- thanks! The basic idea is that it's like a lexical-scoping lookup: inserts add to deepest scope, lookups scan scopes from inner to outer.</p>
</blockquote>



<a name="293914235"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914235" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914235">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1075903168">PR review</a>.</p>



<a name="293914236"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914236" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914236">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r948054338">PR review comment</a>:</p>
<blockquote>
<p>Updated, thanks!</p>
</blockquote>



<a name="293914269"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914269" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914269">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1075904104">PR review</a>.</p>



<a name="293914272"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914272" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914272">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r948054587">PR review comment</a>:</p>
<blockquote>
<p>Updated, to "same canonical representation"</p>
</blockquote>



<a name="293914282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914282">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r948054699">PR review comment</a>:</p>
<blockquote>
<p>Added!</p>
</blockquote>



<a name="293914283"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914283" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914283">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1075904542">PR review</a>.</p>



<a name="293914299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914299">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1075904991">PR review</a>.</p>



<a name="293914301"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914301" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914301">(Aug 17 2022 at 14:58)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r948054944">PR review comment</a>:</p>
<blockquote>
<p>Yes, excellent point.</p>
</blockquote>



<a name="293914335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914335">(Aug 17 2022 at 14:59)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1075905430">PR review</a>.</p>



<a name="293914336"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/293914336" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#293914336">(Aug 17 2022 at 14:59)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/rfcs/pull/27#discussion_r948055231">PR review comment</a>:</p>
<blockquote>
<p>Fixed!</p>
</blockquote>



<a name="294909319"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/294909319" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#294909319">(Aug 23 2022 at 16:58)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1082534859">PR review</a>.</p>



<a name="295092486"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/295092486" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#295092486">(Aug 24 2022 at 17:24)</a>:</h4>
<p>avanhatt submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1084239876">PR review</a>.</p>



<a name="295099484"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/295099484" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#295099484">(Aug 24 2022 at 18:06)</a>:</h4>
<p>uweigand submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1084293314">PR review</a>.</p>



<a name="295151641"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/295151641" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#295151641">(Aug 25 2022 at 02:13)</a>:</h4>
<p>elliottt submitted <a href="https://github.com/bytecodealliance/rfcs/pull/27#pullrequestreview-1084699733">PR review</a>.</p>



<a name="297619650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/297619650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#297619650">(Sep 07 2022 at 15:58)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/rfcs/pull/27">PR #27</a>.</p>



<a name="297619744"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2327%20Cranelift%3A%20Using%20E-Graphs%20for%20Verified%2C%20Coo.../near/297619744" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2327.20Cranelift.3A.20Using.20E-Graphs.20for.20Verified.2C.20Coo.2E.2E.2E.html#297619744">(Sep 07 2022 at 15:58)</a>:</h4>
<p>cfallin edited <a href="https://github.com/bytecodealliance/rfcs/pull/27">PR #27</a> from <code>cranelift-egraphs</code> to <code>main</code>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/rfcs/blob/main/accepted/cranelift-egraph.md">Rendered</a></p>
<p>This RFC proposes to add a <a href="https://en.wikipedia.org/wiki/Compiler#Middle_end">middle-end optimization framework</a> to Cranelift based on <a href="https://en.wikipedia.org/wiki/E-graph">e-graphs</a>. A middle-end<br>
optimization framework works to improve the target-independent <a href="https://en.wikipedia.org/wiki/Intermediate_representation">IR (intermediate representation)</a>, <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/docs/ir.md">CLIF</a>, before Cranelift translates it to machine instructions. Cranelift already has some basic  ptimizations in this category: <a href="https://en.wikipedia.org/wiki/Value_numbering">Global Value Numbering (GVN)</a>, <a href="https://en.wikipedia.org/wiki/Loop-invariant_code_motion">Loop-Independent Code Motion (LICM)</a>, <a href="https://en.wikipedia.org/wiki/Constant_folding">Constant folding</a>, and most recently, a very basic form of <a href="https://en.wikipedia.org/wiki/Alias_analysis">alias analysis</a> and redundant-load elimination. However, the current situation falls short in several ways.</p>
<p>The RFC will first describe how the current situation suffers from three problems: how to order and interleave these optimizations as we build more of them (the <em>phase-ordering problem</em>), how to ensure they are correct when they are all delicate hand-written code (the <em>verification problem</em>), and how to make it easier to build up a large body of known simplifications without tedious handwritten code. It will then describe how an e-graph-based framework could address all<br>
three of these problems. It will describe some novel contributions in how to encode control flow in e-graphs (necessary in order to use e-graphs to optimize whole function bodies) developed during initial experimentation. Then finally it will discuss how we can use our existing rewrite-rule DSL, <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/isle/docs/language-reference.md">ISLE</a>, to describe rewrites on the e-graph.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>