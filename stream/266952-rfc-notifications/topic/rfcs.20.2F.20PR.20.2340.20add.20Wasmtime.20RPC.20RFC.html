<html>
<head><meta charset="utf-8"><title>rfcs / PR #40 add Wasmtime RPC RFC · rfc-notifications · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/index.html">rfc-notifications</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html">rfcs / PR #40 add Wasmtime RPC RFC</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="480055052"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480055052" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480055052">(Nov 01 2024 at 13:51)</a>:</h4>
<p>rvolosatovs opened <a href="https://github.com/bytecodealliance/rfcs/pull/40">PR #40</a> from <code>rvolosatovs:wasmtime-rpc</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Refs <a href="https://github.com/bytecodealliance/wasmtime/issues/7348">https://github.com/bytecodealliance/wasmtime/issues/7348</a><br>
Refs #39 </p>
<p><a href="https://github.com/rvolosatovs/rfcs/blob/wasmtime-plugins/accepted/wasmtime-plugins.md">Rendered</a></p>
</blockquote>



<a name="480055166"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480055166" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480055166">(Nov 01 2024 at 13:52)</a>:</h4>
<p>rvolosatovs edited <a href="https://github.com/bytecodealliance/rfcs/pull/40">PR #40</a>:</p>
<blockquote>
<p>Refs <a href="https://github.com/bytecodealliance/wasmtime/issues/7348">https://github.com/bytecodealliance/wasmtime/issues/7348</a><br>
Refs <a href="https://github.com/bytecodealliance/rfcs/pull/39#issuecomment-2451907457">https://github.com/bytecodealliance/rfcs/pull/39#issuecomment-2451907457</a></p>
<p><a href="https://github.com/rvolosatovs/rfcs/blob/wasmtime-plugins/accepted/wasmtime-plugins.md">Rendered</a></p>
</blockquote>



<a name="480055299"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480055299" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480055299">(Nov 01 2024 at 13:52)</a>:</h4>
<p>rvolosatovs edited <a href="https://github.com/bytecodealliance/rfcs/pull/40">PR #40</a>:</p>
<blockquote>
<p>Refs <a href="https://github.com/bytecodealliance/wasmtime/issues/7348">https://github.com/bytecodealliance/wasmtime/issues/7348</a><br>
Refs <a href="https://github.com/bytecodealliance/rfcs/pull/39#issuecomment-2451907457">https://github.com/bytecodealliance/rfcs/pull/39#issuecomment-2451907457</a></p>
<p><a href="https://github.com/rvolosatovs/rfcs/blob/wasmtime-rpc/accepted/wasmtime-rpc.md">Rendered</a></p>
</blockquote>



<a name="480056124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056124">(Nov 01 2024 at 13:58)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410122963">PR review</a>.</p>



<a name="480056126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056126">(Nov 01 2024 at 13:58)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825850846">PR review comment</a>:</p>
<blockquote>
<p>It seems like this wouldn't allow using multiple plugins at the same time. Only a single plugin exposing multiple interfaces. Maybe a syntax like <code>-P import=wasi:keyvalue=wrpc+tcp://[::1]:7761 -P import=wasi:nn=wrpc+unix://run/user/1000/wasi_nn.sock</code> would work?</p>
</blockquote>



<a name="480056529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056529">(Nov 01 2024 at 14:00)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410127706">PR review</a>.</p>



<a name="480056531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056531">(Nov 01 2024 at 14:00)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825853545">PR review comment</a>:</p>
<blockquote>
<p>If a default port is used, should it be registered with IANA? And what should the default be for unix domain sockets? <code>/run/user/&lt;uid&gt;/&lt;package_name&gt;.sock</code>?</p>
</blockquote>



<a name="480056848"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056848" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056848">(Nov 01 2024 at 14:02)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410131294">PR review</a>.</p>



<a name="480056849"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056849" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056849">(Nov 01 2024 at 14:02)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825855662">PR review comment</a>:</p>
<blockquote>
<p>How is authentication handled? Would it require a CA certificate or are self-signed certificates allowed?</p>
</blockquote>



<a name="480056988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056988">(Nov 01 2024 at 14:03)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410133037">PR review</a>.</p>



<a name="480056989"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480056989" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480056989">(Nov 01 2024 at 14:03)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825856884">PR review comment</a>:</p>
<blockquote>
<p>The only option that would allow backward compatibility on the Wasmtime side I think would be to make plugins shadow builtin implementations.</p>
</blockquote>



<a name="480057654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480057654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480057654">(Nov 01 2024 at 14:08)</a>:</h4>
<p>rvolosatovs created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825861716">PR review comment</a>:</p>
<blockquote>
<p>Definitely open to suggestions here, I struggled to come up with a design, which would not feel overloaded and as I mention in the <em>open questions</em> section. I've decided to start with a singleton plugin because of the CLI design concerns and the fact that shared state (e.g. resources) gets increasingly more tricky as number of plugins grows.</p>
<p>Perhaps we would just need to come up with <code>wasmtime.toml</code>-or-similar config file eventually, which would define the mapping, since mapping every single interface to an endpoint on the CLI feels quite tedious if the number of interfaces is large.<br>
That's probably not much worse than the likes of <code>docker run -v$path:$path -w$path</code>, so perhaps endpoint per-interface is fine at least to start with</p>
</blockquote>



<a name="480057655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480057655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480057655">(Nov 01 2024 at 14:08)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410140962">PR review</a>.</p>



<a name="480059337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480059337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480059337">(Nov 01 2024 at 14:19)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410163784">PR review</a>.</p>



<a name="480059338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480059338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480059338">(Nov 01 2024 at 14:19)</a>:</h4>
<p>rvolosatovs created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825875236">PR review comment</a>:</p>
<blockquote>
<p>I chose <code>7761</code> pretty arbitrarily, if this RFC is accepted and we're happy with this number, IANA registration sounds like the right thing to pursue.</p>
<p>In terms of the UDS path I guess we'd need to first determine if we want plugins to be composable or if we want it to be a singleton. If we go the multiple-plugins route:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$os</span><span class="o">-</span><span class="n">specific</span><span class="o">-</span><span class="n">runtime</span><span class="o">-</span><span class="n">dir</span><span class="o">/</span><span class="n">wrpc</span><span class="o">/</span><span class="n">wasi</span><span class="o">/</span><span class="cp">$name</span><span class="p">.</span><span class="n">sock</span>
</code></pre></div>
<p>e.g.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="cp">$uid</span><span class="o">/</span><span class="n">wrpc</span><span class="o">/</span><span class="n">wasi</span><span class="o">/</span><span class="n">http</span><span class="p">.</span><span class="n">sock</span>
<span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="cp">$uid</span><span class="o">/</span><span class="n">wrpc</span><span class="o">/</span><span class="n">wasi</span><span class="o">/</span><span class="n">keyvalue</span><span class="p">.</span><span class="n">sock</span>
<span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="cp">$uid</span><span class="o">/</span><span class="n">wrpc</span><span class="o">/</span><span class="n">myorg</span><span class="o">/</span><span class="n">mypackage</span><span class="p">.</span><span class="n">sock</span>
</code></pre></div>
<p>seems like a reasonable default for wRPC-based plugins on UDS.</p>
</blockquote>



<a name="480060718"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480060718" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480060718">(Nov 01 2024 at 14:27)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/rfcs/pull/40#pullrequestreview-2410179448">PR review</a>.</p>



<a name="480060719"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480060719" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480060719">(Nov 01 2024 at 14:27)</a>:</h4>
<p>rvolosatovs created <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825884951">PR review comment</a>:</p>
<blockquote>
<p>Depends on the implementation, ultimately <code>wasmtime</code> CLI user would be the one to decide, one thing to note though is that in current implementation, SAN is (ab?)used to specify the function being called: <a href="https://github.com/bytecodealliance/wrpc/blob/628e6bf79416ca2671d0a3c79ac25949f9bf84d8/crates/transport-quic/src/lib.rs#L29-L42">https://github.com/bytecodealliance/wrpc/blob/628e6bf79416ca2671d0a3c79ac25949f9bf84d8/crates/transport-quic/src/lib.rs#L29-L42</a></p>
<p>Currently, self-signed or not, the server (plugin) needs to generate a cert with appropriate SANs.</p>
<p>This can easily be changed/made configurable to e.g. be specified in the stream header as done for e.g. TCP and UDS <a href="https://github.com/bytecodealliance/wrpc/blob/628e6bf79416ca2671d0a3c79ac25949f9bf84d8/crates/transport/src/frame/conn/client.rs#L33-L43">https://github.com/bytecodealliance/wrpc/blob/628e6bf79416ca2671d0a3c79ac25949f9bf84d8/crates/transport/src/frame/conn/client.rs#L33-L43</a><br>
I feel like being able to sign served plugin capabilities may come in quite handy, but I don't have strong feelings about this</p>
</blockquote>



<a name="480060909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480060909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480060909">(Nov 01 2024 at 14:28)</a>:</h4>
<p>rvolosatovs edited <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825861716">PR review comment</a>.</p>



<a name="480060999"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480060999" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480060999">(Nov 01 2024 at 14:29)</a>:</h4>
<p>rvolosatovs edited <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825861716">PR review comment</a>.</p>



<a name="480103586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/266952-rfc-notifications/topic/rfcs%20/%20PR%20%2340%20add%20Wasmtime%20RPC%20RFC/near/480103586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RFC notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/266952-rfc-notifications/topic/rfcs.20.2F.20PR.20.2340.20add.20Wasmtime.20RPC.20RFC.html#480103586">(Nov 01 2024 at 19:10)</a>:</h4>
<p>rvolosatovs edited <a href="https://github.com/bytecodealliance/rfcs/pull/40#discussion_r1825884951">PR review comment</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>