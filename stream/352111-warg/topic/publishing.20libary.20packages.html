<html>
<head><meta charset="utf-8"><title>publishing libary packages · warg · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/index.html">warg</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html">publishing libary packages</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="420242632"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420242632" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420242632">(Feb 07 2024 at 12:39)</a>:</h4>
<p>Do I understand correctly that is expected for each component implementing a world from a wit file to be it's own package in warg, and the wit file also being published to a separate package encoded in it's own wasm file?<br>
If that's the case, is there a standard way in warg to describe the relationship between the implementation components and the wit component? </p>
<p>Or is there a way to merge the implementation .wasm components with the wasm encoded wit?</p>
<p>Or can a package  consist of multiple wasm files?</p>



<a name="420247357"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420247357" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420247357">(Feb 07 2024 at 13:05)</a>:</h4>
<p>Has been helpful writing this down.</p>
<p>Library users only ever import the interface definitions from the wit component.<br>
Implementations are only specified when composing components.</p>
<p>Correct?</p>



<a name="420251473"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420251473" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420251473">(Feb 07 2024 at 13:27)</a>:</h4>
<p>What happens when specifying conflicting implementations i.e. two components  each specify an implementation for a subset of the interfaces, but these subsets intersect?</p>



<a name="420312874"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420312874" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Calvin Prewitt <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420312874">(Feb 07 2024 at 18:12)</a>:</h4>
<p>Great questions! Some of these answers are still being figured out. Here are some partial answers.</p>
<p>A single Wasm binary is what you publish with Warg. However, that binary could be composed of other components that either are bundled in the binary or just referenced with an import statement that needs to be resolved by the registry. So a single Wasm binary could be a composition of multiple Wasm binaries.</p>
<p>A Wasm component binary could be just the binary representation of a WIT text file. Or it could have an implementation of those interfaces. Both are publishable components.</p>
<p>You might want to publish interfaces by themselves if you want them to be reused and targeted by multiple component implementations.</p>



<a name="420463471"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420463471" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420463471">(Feb 08 2024 at 13:59)</a>:</h4>
<p>If a wit file is intended to have multiple implementations (like the WASI specs) then you would publish it as a standalone binary-encoded wit package. If you just want a representation of a particular component's imports/exports then you don't need a separate package; components are self-describing in that way.</p>



<a name="420467177"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420467177" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420467177">(Feb 08 2024 at 14:16)</a>:</h4>
<p>I think I missed this, but do we have a way to create a "binary-encoded wit package" right now? with no implementations, just the module with the world(s)?</p>



<a name="420467784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420467784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420467784">(Feb 08 2024 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="480579">@Lann Martin</span> <br>
How would I import  a "implementation" without a separate wit component defining it's interfaces?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">example</span>:<span class="nc">add</span><span class="p">;</span>

<span class="n">interface</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">add</span>: <span class="nc">func</span><span class="p">(</span><span class="n">a</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">world</span><span class="w"> </span><span class="n">adder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">add</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>When I create a component with <code>cargo component</code> which confines to the adder world, I then get this fairly unhelpful wit back.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">wit</span><span class="w"> </span><span class="n">target</span><span class="o">/</span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasi</span><span class="o">/</span><span class="n">release</span><span class="o">/</span><span class="n">adder</span><span class="p">.</span><span class="n">wasm</span>
<span class="n">package</span><span class="w"> </span><span class="n">root</span>:<span class="nc">component</span><span class="p">;</span>

<span class="n">world</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">example</span>:<span class="nc">add</span><span class="o">/</span><span class="n">add</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>



<a name="420467860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420467860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Calvin Prewitt <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420467860">(Feb 08 2024 at 14:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="268586">Ralph</span> <a href="#narrow/stream/352111-warg/topic/publishing.20libary.20packages/near/420467177">said</a>:</p>
<blockquote>
<p>I think I missed this, but do we have a way to create a "binary-encoded wit package" right now? with no implementations, just the module with the world(s)?</p>
</blockquote>
<p><a href="https://crates.io/crates/wit">https://crates.io/crates/wit</a></p>



<a name="420468140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420468140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420468140">(Feb 08 2024 at 14:21)</a>:</h4>
<p><span class="user-mention" data-user-id="268586">@Ralph</span> </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">wit</span><span class="w"> </span><span class="n">wit</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">out</span><span class="p">.</span><span class="n">wasm</span>
</code></pre></div>



<a name="420469143"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420469143" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Calvin Prewitt <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420469143">(Feb 08 2024 at 14:26)</a>:</h4>
<p><span class="user-mention" data-user-id="674089">@Paul Scheduikat</span> </p>
<p>There's some rough edges importing implementations right now. I know <span class="user-mention" data-user-id="253989">@Peter Huene</span> and <span class="user-mention" data-user-id="486181">@Daniel Macovei</span> are working through the issues.</p>



<a name="420469274"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420469274" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420469274">(Feb 08 2024 at 14:27)</a>:</h4>
<p>no, this is great! I had missed that you could create an <em>interface-only</em> module</p>



<a name="420469305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420469305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420469305">(Feb 08 2024 at 14:27)</a>:</h4>
<p>That's wonderful!!!!</p>



<a name="420469667"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420469667" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420469667">(Feb 08 2024 at 14:29)</a>:</h4>
<p><span class="user-mention" data-user-id="479055">@Calvin Prewitt</span> The interface types are probably already contained in the binary is there a way to convert them to wit?</p>



<a name="420469805"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420469805" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420469805">(Feb 08 2024 at 14:29)</a>:</h4>
<p>I do know you can extract them easily enough, but it's .wit-to-module that I'd missed.....</p>



<a name="420470463"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420470463" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420470463">(Feb 08 2024 at 14:32)</a>:</h4>
<p>wasm-tools component wit HelloWorld.wasm<br>
package root:root;</p>
<p>world root {<br>
}</p>



<a name="420470520"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420470520" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420470520">(Feb 08 2024 at 14:33)</a>:</h4>
<p>but THAT has an implementation.....</p>



<a name="420471049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420471049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420471049">(Feb 08 2024 at 14:35)</a>:</h4>
<p><span class="user-mention" data-user-id="674089">@Paul Scheduikat</span> I believe this prints a component's interface as wit: <code>wasm-tools component wit component.wasm</code></p>



<a name="420471278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420471278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Calvin Prewitt <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420471278">(Feb 08 2024 at 14:36)</a>:</h4>
<p><span class="user-mention" data-user-id="674089">@Paul Scheduikat</span> The tooling will get more integrated and easier for workflows. But <code>wasm-tools component wit filepath/filename.wasm</code> will print to to stdoout.</p>



<a name="420471428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420471428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Calvin Prewitt <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420471428">(Feb 08 2024 at 14:37)</a>:</h4>
<p>I just ran it on <code>wasi:http</code> encoded as binary and outputted to <code>.wit</code> text file. Works as expected.</p>



<a name="420471964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420471964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Calvin Prewitt <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420471964">(Feb 08 2024 at 14:40)</a>:</h4>
<p>Doc comments will survive the roundtrip to binary and back to <code>.wit</code> text file. But you will end up with a single <code>.wit</code> file and lose the original directory structure of separate <code>.wit</code> files.</p>



<a name="420472008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420472008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420472008">(Feb 08 2024 at 14:40)</a>:</h4>
<p>Only for interface components for implementations it doesn't:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">wit</span><span class="w"> </span><span class="n">adder</span><span class="p">.</span><span class="n">wasm</span>
<span class="n">package</span><span class="w"> </span><span class="n">root</span>:<span class="nc">component</span><span class="p">;</span>

<span class="n">world</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">example</span>:<span class="nc">calculate</span><span class="o">/</span><span class="n">add</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>It is contained in the binary tho:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">wit</span><span class="w"> </span><span class="n">adder</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">t</span>
<span class="p">(</span><span class="n">component</span>
<span class="w">  </span><span class="p">(</span><span class="k">type</span> <span class="p">(;</span><span class="mi">0</span><span class="p">;)</span>
<span class="w">    </span><span class="p">(</span><span class="n">component</span>
<span class="w">      </span><span class="p">(</span><span class="k">type</span> <span class="p">(;</span><span class="mi">0</span><span class="p">;)</span>
<span class="w">        </span><span class="p">(</span><span class="n">component</span>
<span class="w">          </span><span class="p">(</span><span class="k">type</span> <span class="p">(;</span><span class="mi">0</span><span class="p">;)</span>
<span class="w">            </span><span class="p">(</span><span class="n">instance</span>
<span class="w">              </span><span class="p">(</span><span class="k">type</span> <span class="p">(;</span><span class="mi">0</span><span class="p">;)</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="s">"a"</span><span class="w"> </span><span class="kt">u32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="s">"b"</span><span class="w"> </span><span class="kt">u32</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="kt">u32</span><span class="p">)))</span>
<span class="w">              </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="p">(;</span><span class="mi">0</span><span class="p">;)</span><span class="w"> </span><span class="s">"add"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="mi">0</span><span class="p">)))</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">          </span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="p">(;</span><span class="mi">0</span><span class="p">;)</span><span class="w"> </span><span class="s">"example:calculate/add"</span><span class="w"> </span><span class="p">(</span><span class="n">instance</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="mi">0</span><span class="p">)))</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">      </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="p">(;</span><span class="mi">0</span><span class="p">;)</span><span class="w"> </span><span class="s">"root:component/root"</span><span class="w"> </span><span class="p">(</span><span class="n">component</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="mi">0</span><span class="p">)))</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="p">(;</span><span class="mi">1</span><span class="p">;)</span><span class="w"> </span><span class="s">"root"</span><span class="w"> </span><span class="p">(</span><span class="k">type</span> <span class="mi">0</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="o">@</span><span class="n">producers</span>
<span class="w">    </span><span class="p">(</span><span class="n">processed</span><span class="o">-</span><span class="n">by</span><span class="w"> </span><span class="s">"wit-component"</span><span class="w"> </span><span class="s">"0.20.1"</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>



<a name="420472102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420472102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420472102">(Feb 08 2024 at 14:41)</a>:</h4>
<p>AH, yes, is there an issue for that?</p>



<a name="420472842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420472842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420472842">(Feb 08 2024 at 14:44)</a>:</h4>
<p>Sorry in your example what does your original component's wit look like?</p>



<a name="420473123"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420473123" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420473123">(Feb 08 2024 at 14:46)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span> </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">example</span>:<span class="nc">calculate</span><span class="p">;</span>

<span class="n">interface</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">add</span>: <span class="nc">func</span><span class="p">(</span><span class="n">a</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">world</span><span class="w"> </span><span class="n">adder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">add</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>



<a name="420474162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420474162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420474162">(Feb 08 2024 at 14:51)</a>:</h4>
<p>It's not that it "only works for interface components".  It's that the binary you printed has a different wit than the wit you used to create the component.</p>



<a name="420474265"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420474265" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420474265">(Feb 08 2024 at 14:52)</a>:</h4>
<p>Paul, are you testing out the component book example?</p>



<a name="420474327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420474327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420474327">(Feb 08 2024 at 14:52)</a>:</h4>
<p>Yes rust component example</p>



<a name="420474417"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420474417" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420474417">(Feb 08 2024 at 14:52)</a>:</h4>
<p>Sorry I know that's confusing.  But if you look at the <code>wat</code> you shared, that is a component that exports a component type that is described by the wit you shared,  which is a different component than the one described by the wit</p>



<a name="420475070"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475070" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475070">(Feb 08 2024 at 14:56)</a>:</h4>
<p>The tool could recurse into the nested interfaces. You wouldn't always want to do that unconditionally but it is functionality that could be added.</p>



<a name="420475542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475542">(Feb 08 2024 at 14:58)</a>:</h4>
<p>Are you using cargo-component?  It seems like your <code>wat</code> was handwritten</p>



<a name="420475546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475546">(Feb 08 2024 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="480579">Lann Martin</span> <a href="#narrow/stream/352111-warg/topic/publishing.20libary.20packages/near/420475070">said</a>:</p>
<blockquote>
<p>The tool could recurse into the nested interfaces. You wouldn't always want to do that unconditionally but it is functionality that could be added.</p>
</blockquote>
<p>it would be nice to be able to pass a <code>--tree</code> option to recurse, though in many cases those interfaces are not exposed to the outside caller.</p>



<a name="420475654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475654">(Feb 08 2024 at 14:58)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span> <br>
No cargo component.</p>



<a name="420475746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475746">(Feb 08 2024 at 14:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="486181">Daniel Macovei</span> <a href="#narrow/stream/352111-warg/topic/publishing.20libary.20packages/near/420475542">said</a>:</p>
<blockquote>
<p>Are you using cargo-component?  It seems like your <code>wat</code> was handwritten</p>
</blockquote>
<p>he's doing the book's wat example: <a href="https://component-model.bytecodealliance.org/tutorial.html">https://component-model.bytecodealliance.org/tutorial.html</a></p>



<a name="420475772"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475772" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475772">(Feb 08 2024 at 14:59)</a>:</h4>
<p>Correct, <span class="user-mention" data-user-id="674089">@Paul Scheduikat</span> ?</p>



<a name="420475906"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420475906" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420475906">(Feb 08 2024 at 14:59)</a>:</h4>
<p>Was surprised there aren't any wasi interfaces in your output</p>



<a name="420476111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420476111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420476111">(Feb 08 2024 at 15:00)</a>:</h4>
<p>Basically, Paul is user testing the tutorial for us :-) we need to take notes and file prs and issues :-)</p>



<a name="420476200"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420476200" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420476200">(Feb 08 2024 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span> You only get those if your code is directly runnable.</p>



<a name="420476933"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420476933" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420476933">(Feb 08 2024 at 15:04)</a>:</h4>
<p><span class="user-mention" data-user-id="268586">@Ralph</span> The tutorial works, there is just just no example of composing multiple self written packages together.</p>



<a name="420476976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420476976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420476976">(Feb 08 2024 at 15:04)</a>:</h4>
<p>^^</p>



<a name="420476995"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420476995" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420476995">(Feb 08 2024 at 15:04)</a>:</h4>
<p>right, this is interesting!</p>



<a name="420477008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420477008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420477008">(Feb 08 2024 at 15:04)</a>:</h4>
<p>great!</p>



<a name="420477397"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420477397" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420477397">(Feb 08 2024 at 15:06)</a>:</h4>
<p>It's a little tricky because composition is the intersection of using several tools together here.  You're asking about warg, cargo-component, wasm-tools component wit, and then there are also a variety of ways to perform the composition.</p>



<a name="420477444"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420477444" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420477444">(Feb 08 2024 at 15:06)</a>:</h4>
<p>I'll see about doing that later today and submit a pr to the doc repo</p>



<a name="420477534"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420477534" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420477534">(Feb 08 2024 at 15:07)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span> is right, but that shouldn't bother us too much at this point methinhks. once language tooling kicks in, that will all change anyway....</p>



<a name="420477643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420477643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420477643">(Feb 08 2024 at 15:07)</a>:</h4>
<p>Yes this use case definitely is something we care about making more intuitive, it's just going to take some time I think.  Folks are aware it's not intuitive</p>



<a name="420477977"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420477977" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420477977">(Feb 08 2024 at 15:09)</a>:</h4>
<p>But specifically I think one of the take aways is that while wasm-tools could support recursion when it prints wit, probably a common point of confusion is that the top level wit for a binary generated by cargo-component <em>exports</em> the wit that you use to create the binary, meaning it <em>is not</em> going to have the same wit you used generate the component</p>



<a name="420478026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420478026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420478026">(Feb 08 2024 at 15:09)</a>:</h4>
<p>One needs to understand that to start playing around with composition</p>



<a name="420478050"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420478050" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420478050">(Feb 08 2024 at 15:10)</a>:</h4>
<p>And that probably isn't clear from the component book</p>



<a name="420478741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420478741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420478741">(Feb 08 2024 at 15:12)</a>:</h4>
<p>squillace@idiopath:~/work/hello-wasi-http/target/wasm32-wasi/debug$ wasm-tools component wit hello_wasi_http.wasm<br>
package root:component;</p>
<p>world root {<br>
  import wasi:io/error@0.2.0;<br>
  import wasi:io/streams@0.2.0;<br>
  import wasi:cli/stdout@0.2.0;<br>
  import wasi:cli/stderr@0.2.0;<br>
  import wasi:cli/stdin@0.2.0;<br>
  import wasi:http/types@0.2.0;</p>
<p>export wasi:http/incoming-handler@0.2.0;<br>
}</p>



<a name="420478855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420478855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420478855">(Feb 08 2024 at 15:13)</a>:</h4>
<p>if it were a composed component, you'd be right, only the top level things would be visible; I like the tree idea, though....</p>



<a name="420478937"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420478937" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420478937">(Feb 08 2024 at 15:13)</a>:</h4>
<p>that's Dan's rust wasi:http hello world</p>



<a name="420479118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420479118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420479118">(Feb 08 2024 at 15:14)</a>:</h4>
<p>lemme go find the wit: <br>
<a href="/user_uploads/15107/7MUXIPREd-1p7eHioEI2BDjc/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/15107/7MUXIPREd-1p7eHioEI2BDjc/image.png" title="image.png"><img src="/user_uploads/15107/7MUXIPREd-1p7eHioEI2BDjc/image.png"></a></div>



<a name="420479472"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420479472" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420479472">(Feb 08 2024 at 15:16)</a>:</h4>
<p>hmm if you have the code available it looks like that one might actually have several wit files</p>



<a name="420479723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420479723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420479723">(Feb 08 2024 at 15:17)</a>:</h4>
<p>Dan had this one running throughout the RC flow, so early on you had to have the wit to compile, and it hasn't been rearranged: <a href="https://github.com/sunfishcode/hello-wasi-http">https://github.com/sunfishcode/hello-wasi-http</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/sunfishcode/hello-wasi-http" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/fa36c47887a9d645890975830588bb9d4190ee96\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333333356337666533623235663435343738313134316464633334336361346433393138343165313066616166636636626532343831646231613666356335632f73756e66697368636f64652f68656c6c6f2d776173692d68747470)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/sunfishcode/hello-wasi-http" title="GitHub - sunfishcode/hello-wasi-http">GitHub - sunfishcode/hello-wasi-http</a></div><div class="message_embed_description">Contribute to sunfishcode/hello-wasi-http development by creating an account on GitHub.</div></div></div>



<a name="420479900"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420479900" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420479900">(Feb 08 2024 at 15:18)</a>:</h4>
<p>which was why I was asking whether we even could now build only wit files!</p>



<a name="420479953"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420479953" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420479953">(Feb 08 2024 at 15:18)</a>:</h4>
<p>I was "used to" having to have the physical .wit to build</p>



<a name="420480384"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420480384" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420480384">(Feb 08 2024 at 15:20)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span> <br>
I still don't really understand how I would do this. The following is loosely contrived from the tutorial, but simplified and I now want to split it up in two packages.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">docs</span>:<span class="nc">add</span><span class="p">;</span>

<span class="n">interface</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">add</span>: <span class="nc">func</span><span class="p">(</span><span class="n">a</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">world</span><span class="w"> </span><span class="n">adder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">add</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The adder world is then built to a component with <code>cargo component</code>.</p>
<p>This results in the <code>adder.wasm</code> file implementing the adder world.</p>
<p>I then create a new project (component) with <code>cargo component new</code> and only copy over the <code>adder.wasm</code> file.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">docs</span>:<span class="nc">calculator</span><span class="p">;</span>

<span class="n">world</span><span class="w"> </span><span class="n">calculator</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">docs</span>:<span class="nc">add</span>:<span class="nc">add</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>What are the steps to implement the calculator world?</p>



<a name="420480780"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420480780" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420480780">(Feb 08 2024 at 15:22)</a>:</h4>
<p>So that's the part where you write rust code in your <code>cargo component</code> project</p>



<a name="420481098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481098">(Feb 08 2024 at 15:24)</a>:</h4>
<p>The rust code isn't included in the docs, but you would import the bindings in your <code>lib.rs</code> and reference the interfaces you're implementing from <code>bindings</code>.  This is the part where the <code>cargo-component</code> docs are your friend <a href="https://github.com/bytecodealliance/cargo-component?tab=readme-ov-file#getting-started">https://github.com/bytecodealliance/cargo-component?tab=readme-ov-file#getting-started</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/cargo-component?tab=readme-ov-file#getting-started" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/f17c09d9684534460c5921b3d5b1baa85111405d\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f336563323666316462626532633266336632643539653066303965316365393431636533333564346364653063366338316665613731623836363435653931342f62797465636f6465616c6c69616e63652f636172676f2d636f6d706f6e656e74)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/cargo-component?tab=readme-ov-file#getting-started" title="GitHub - bytecodealliance/cargo-component: A Cargo subcommand for creating WebAssembly components based on the component model proposal.">GitHub - bytecodealliance/cargo-component: A Cargo subcommand for creating WebAssembly components based on the component model proposal.</a></div><div class="message_embed_description">A Cargo subcommand for creating WebAssembly components based on the component model proposal. - GitHub - bytecodealliance/cargo-component: A Cargo subcommand for creating WebAssembly components bas...</div></div></div>



<a name="420481124"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481124" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481124">(Feb 08 2024 at 15:24)</a>:</h4>
<p>As a meta-point, this thread might get more relevant eyeballs in <a class="stream" data-stream-id="327223" href="/#narrow/stream/327223-wit-bindgen">#wit-bindgen</a></p>



<a name="420481233"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481233" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481233">(Feb 08 2024 at 15:24)</a>:</h4>
<p>agreed; can you move it? I'm not a zulip master, I confess.</p>



<a name="420481239"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481239" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481239">(Feb 08 2024 at 15:25)</a>:</h4>
<p>#bleg</p>



<a name="420481360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481360">(Feb 08 2024 at 15:25)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span>  But I need the type information for <code>docs:add:add;</code>to be able to use it in rust. I now only have adder.wasm which although it contains the type information isn't easily usable.</p>



<a name="420481572"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481572" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481572">(Feb 08 2024 at 15:26)</a>:</h4>
<p><code>cargo-component</code> leverages <code>wit-bindgen</code> which creates the rust types you need from your wit and exposes them in the <code>bindings</code> module it generates for you</p>



<a name="420481898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481898">(Feb 08 2024 at 15:27)</a>:</h4>
<p>in the link i shared there's this snippet</p>



<a name="420481914"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481914" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481914">(Feb 08 2024 at 15:27)</a>:</h4>
<p>I do get that I can copy over the wit interface declaration from the other project, but as I have learned now I should be able to import it with just the <code>adder.wasm</code> file.</p>



<a name="420481918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420481918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420481918">(Feb 08 2024 at 15:27)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">mod</span> <span class="nn">bindings</span><span class="p">;</span>

<span class="k">use</span><span class="w"> </span><span class="n">bindings</span>::<span class="n">Guest</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">Component</span><span class="p">;</span>

<span class="k">impl</span><span class="w"> </span><span class="n">Guest</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Component</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="sd">/// Say hello!</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">hello_world</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span>
<span class="w">        </span><span class="s">"Hello, World!"</span><span class="p">.</span><span class="n">to_string</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



<a name="420482792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420482792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420482792">(Feb 08 2024 at 15:31)</a>:</h4>
<p><span class="user-mention" data-user-id="486181">@Daniel Macovei</span> I do understand how to implement components in rust.</p>



<a name="420482841"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420482841" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420482841">(Feb 08 2024 at 15:31)</a>:</h4>
<p>Sorry it's a little confusing what you're trying to import where.  A little later on I can try and push an example that recreates the example in the book.  Without having looked too closely at it though you need to create two different cargo-component projects, one for the calculator, and one for adder, and then compose the output binaries</p>



<a name="420482910"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420482910" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420482910">(Feb 08 2024 at 15:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="674089">Paul Scheduikat</span> <a href="#narrow/stream/352111-warg/topic/publishing.20libary.20packages/near/420482792">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="486181">Daniel Macovei</span> I do understand how to implement components in rust.</p>
</blockquote>
<p>Sure thing, sorry for mistaking that as the point of confusion</p>



<a name="420483062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420483062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420483062">(Feb 08 2024 at 15:32)</a>:</h4>
<p>I think the point is the book doesn't discuss the "composing" or "binding together" of the components, am I correct, Paul?</p>



<a name="420483910"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420483910" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420483910">(Feb 08 2024 at 15:36)</a>:</h4>
<p>I know how I would compose these two packages together. </p>
<blockquote>
<p>If a wit file is intended to have multiple implementations (like the WASI specs) then you would publish it as a standalone binary-encoded wit package. If you just want a representation of a particular component's imports/exports then you don't need a separate package; components are self-describing in that way.</p>
</blockquote>
<p>I don't understand how I would go about it when downloading just a implementation <code>wasm</code> component from a registry, without a separate wit package defining the interfaces.</p>



<a name="420484126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420484126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420484126">(Feb 08 2024 at 15:37)</a>:</h4>
<p>EXACTLY</p>



<a name="420484309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420484309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420484309">(Feb 08 2024 at 15:38)</a>:</h4>
<p>up to now, I've been copying around the wit files for implementations; the question is how to <em>reference</em> those types by pointing at an interface-only component module.</p>



<a name="420484479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420484479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420484479">(Feb 08 2024 at 15:39)</a>:</h4>
<p>Let's ignore the registry part for a moment, because that is just a location. First we should be able to replicate this locally and document that in the book.</p>



<a name="420484634"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/352111-warg/topic/publishing%20libary%20packages/near/420484634" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Scheduikat <a href="https://bytecodealliance.github.io/zulip-archive/stream/352111-warg/topic/publishing.20libary.20packages.html#420484634">(Feb 08 2024 at 15:40)</a>:</h4>
<p>Agree registry is irrelevant here.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>