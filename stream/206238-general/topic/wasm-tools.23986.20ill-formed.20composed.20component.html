<html>
<head><meta charset="utf-8"><title>wasm-tools#986 ill-formed composed component · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html">wasm-tools#986 ill-formed composed component</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="351138144"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351138144" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351138144">(Apr 19 2023 at 19:33)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> re: <a href="https://github.com/bytecodealliance/wasm-tools/issues/986#issuecomment-1513679423">your request for a reproduction of the wasm component issue</a>: <br>
<a href="/user_uploads/15107/7z_3sj-CIYyTc6IKTY2jI136/broken-composed.wasm">broken-composed.wasm</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasm-tools/issues/986#issuecomment-1513679423" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/fe1ead4f83d6a45b61c8451b1ed543211591a08f\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f383365376536323038626332643838623866656230626636363365656664396333353961666136653264313031626238666332366334306164333765653933312f62797465636f6465616c6c69616e63652f7761736d2d746f6f6c732f6973737565732f393836)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasm-tools/issues/986#issuecomment-1513679423" title="`wasm-compose` creating an ill formed wasm component · Issue #986 · bytecodealliance/wasm-tools">`wasm-compose` creating an ill formed wasm component · Issue #986 · bytecodealliance/wasm-tools</a></div><div class="message_embed_description">I'm still seeing issues after #977 has been fixed. This is what I'm seeing: $ wasm-tools component wit broken-composed.wasm Error: failed to decode WIT document Caused by: 0: failed to decode WIT f...</div></div></div>



<a name="351141304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351141304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351141304">(Apr 19 2023 at 19:53)</a>:</h4>
<p><span class="user-mention" data-user-id="590805">@Ryan Levick (rylev)</span> do you have the source modules here that I could play with? Either the source code or the input <code>*.wasm</code> core wasm as input to <code>wit-component</code></p>



<a name="351145354"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351145354" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351145354">(Apr 19 2023 at 20:17)</a>:</h4>
<p>hm ok I think I see the issue, and it looks like this is unrelated to <code>wasm-tools compose</code> but is instead a bug in <code>wit-component</code> which requires nested components to expose, which only <code>wasm-tools compose</code> builds</p>



<a name="351146555"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351146555" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351146555">(Apr 19 2023 at 20:25)</a>:</h4>
<p>I think I have an idea of how to fix, but it'll have to wait until the resources PR is merged since it'll build on that.</p>



<a name="351146604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351146604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351146604">(Apr 19 2023 at 20:26)</a>:</h4>
<p>this raw binary component will become invalid with that PR, however, but when made vaild (by re-running <code>wit-component</code>) the new binary should work with the future PR I have in mind</p>



<a name="351152480"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351152480" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351152480">(Apr 19 2023 at 21:04)</a>:</h4>
<p>Sounds good to me. If you have the energy to write up a sentence or two with more detail on the issue I'd love to hear it (trying to solidify my understanding of the binary format), but no worries if you don't get around to it <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="351153607"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351153607" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351153607">(Apr 19 2023 at 21:11)</a>:</h4>
<p>oh sure!</p>
<p>The way that wit-component works is that it walks the type information as produced by <code>wasmparser</code>'s validation phase, notably it doesn't walk the component manually itself (that's what <code>wasmparser</code> does during validation). The problem with nested components, however, is that the final exported item from the outer component in your example is referring to an imported type of an inner component. This means that during wit-component's walk over the type of the component itself it never actually encountered the inner types, meaning it never registered anything for them.</p>
<p>The solution I have in mind is that these types are supplied when the outer component is instantiating the inner component. During this process type-substitution is already happening for resource types and I figure it can be updated to happen for normal types as well. For example if you satisfy a type import with a type, then that type you provided should be used to substitute the final type of the component.</p>
<p>Given this when wit-component walks over the type information it'll find that <code>http-types</code>, which is imported by the outer component, is the exact same type IDs that's exported by the result, meaning that it shouldn't "miss" anything due to it being internal to a component.</p>
<p>Or at least that's the theory! The type substitution support isn't there today in wasmparser but it's available with the resources PR, which I think should be relatively easy to piggy-back onto.</p>



<a name="351154206"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351154206" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351154206">(Apr 19 2023 at 21:15)</a>:</h4>
<p>Nice. The explanation of the problem matches my mental model (which I'm very happy about). I'll check out the resources PR to see if I can grok what's happening there. The proposed solution sounds clear to me</p>



<a name="351154219"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351154219" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351154219">(Apr 19 2023 at 21:15)</a>:</h4>
<p>Thanks for the explainer!</p>



<a name="351154692"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351154692" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351154692">(Apr 19 2023 at 21:18)</a>:</h4>
<p>If you've got the original source or core wasm modules I can test out a solution too</p>



<a name="351154746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351154746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351154746">(Apr 19 2023 at 21:18)</a>:</h4>
<p>I was thinking to test out my idea but it requires a new component due to the new validation rules which make the existing one invalid</p>



<a name="351154752"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351154752" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351154752">(Apr 19 2023 at 21:19)</a>:</h4>
<p>but re-running <code>wit-component</code> should be all that's necessary</p>



<a name="351154861"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351154861" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351154861">(Apr 19 2023 at 21:19)</a>:</h4>
<p>i'm currently reviewing the resource types PR so hopefully we can get that merged in soon to help with a basis for a fix</p>



<a name="351158310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351158310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351158310">(Apr 19 2023 at 21:46)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> here are the wasm components I'm trying to compose:</p>
<p><a href="/user_uploads/15107/oHprOuUxR6zb9oKIt-uWKhcF/base.wasm">base.wasm</a><br>
<a href="/user_uploads/15107/3AJMxNqCRVzFikg0ofH0L9Mr/adapter.wasm">adapter.wasm</a><br>
<a href="/user_uploads/15107/dSZfXmzETa57jLiCJMG7v5oF/config.yml">config.yml</a></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wasm</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="n">compose</span><span class="w"> </span><span class="o">--</span><span class="n">output</span><span class="w"> </span><span class="n">broken</span><span class="o">-</span><span class="n">composed</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">yml</span><span class="w"> </span><span class="n">base</span><span class="p">.</span><span class="n">wasm</span>
</code></pre></div>



<a name="351159706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351159706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351159706">(Apr 19 2023 at 21:56)</a>:</h4>
<p><span class="user-mention" data-user-id="590805">@Ryan Levick (rylev)</span> do you have the pre-wit-component core wasm outputs?</p>



<a name="351159735"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351159735" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351159735">(Apr 19 2023 at 21:56)</a>:</h4>
<p>those look like they're both already components</p>



<a name="351160121"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351160121" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351160121">(Apr 19 2023 at 21:59)</a>:</h4>
<p>If you're using <code>cargo-component</code>, there's no good way to tell it to not componentize the core module in-place (if you're on macOS, however, a quirk of how cargo copies rather than hardlinks the deps to the target directory will keep the module in the deps directory)</p>



<a name="351160285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351160285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351160285">(Apr 19 2023 at 22:00)</a>:</h4>
<p>ah ok, in that case I'll keep poking, I'm trying to handwrite a minimal test case but am running into a few issues</p>



<a name="351160298"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351160298" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351160298">(Apr 19 2023 at 22:00)</a>:</h4>
<p>a hack would be to manually depend your project on the bindings crate and do a <code>cargo build --target wasm32...</code></p>



<a name="351160489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351160489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351160489">(Apr 19 2023 at 22:02)</a>:</h4>
<p>if we might find it helpful for the future, can add a <code>--keep-module</code> option or something so that it preserves the core module (perhaps copies it to <code>foo.core.wasm</code>)</p>



<a name="351161131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351161131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351161131">(Apr 19 2023 at 22:07)</a>:</h4>
<p><a href="/user_uploads/15107/_f43bQaueiNis01xDDwSaDwf/bloom_filter.wasm">base.wasm</a></p>
<p>Luckily I'm using macOS so the core module was in the deps folder</p>



<a name="351161158"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351161158" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351161158">(Apr 19 2023 at 22:07)</a>:</h4>
<p>I don't have easy access to the adapter core module but I can get that too if it makes life easier</p>



<a name="351173666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351173666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351173666">(Apr 20 2023 at 00:25)</a>:</h4>
<p>ok thanks! I've discovered a fuzz bug (probably should have run this sooner with this branch) which I need to bottom out and may require larger changes to fix</p>



<a name="351398614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351398614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351398614">(Apr 20 2023 at 18:17)</a>:</h4>
<p>Ok all the fuzz issues I think are now fixed and the output of <code>wit-component</code> has changed even more. This additionally necessitated adding a test case which showcases the type-substitution behavior so now the type-substitution logic I was alluding to is now included in the PR.</p>
<p>I believe the basic tl;dr; is that your issue will be fixed with the PR as-is. I haven't fully tested though. Are you able to check out the PR and see that toolchain works for you?</p>



<a name="351656686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351656686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351656686">(Apr 21 2023 at 15:04)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> I can give it a try, but I think I'll need to update Cargo component to use your latest changes. I will try that out and let you know if everything works.</p>



<a name="351669499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351669499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351669499">(Apr 21 2023 at 15:49)</a>:</h4>
<p>Unfortunately, I'm getting an error, but I'm unsure if it's a mistake on my end (to reproduce the set up of my original issue, I have to update wasm-tools and wit-bindgen dependencies in many places).</p>



<a name="351669594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351669594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351669594">(Apr 21 2023 at 15:50)</a>:</h4>
<p>I'm getting this error: <code>func not valid to be used as import (at offset 0x24ae86)</code></p>



<a name="351669686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351669686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351669686">(Apr 21 2023 at 15:50)</a>:</h4>
<p>Here's the component in question: <a href="/user_uploads/15107/hcL0lweuxDzeOh1lqTbp7Zh2/component.wasm">component.wasm</a></p>



<a name="351669773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351669773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351669773">(Apr 21 2023 at 15:50)</a>:</h4>
<p>(note this is before any composition - it's just during "componentization" - when we are taking core modules and making them components)</p>



<a name="351670070"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351670070" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351670070">(Apr 21 2023 at 15:52)</a>:</h4>
<p>It would probably help if we could make <code>validate_and_register_named_types</code> return what is not valid instead of returning just a bool</p>



<a name="351670504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351670504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351670504">(Apr 21 2023 at 15:54)</a>:</h4>
<p>hm ok that may be a further bug, I'll try to dig in in a bit</p>



<a name="351671162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351671162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351671162">(Apr 21 2023 at 15:57)</a>:</h4>
<p>Looks like there is a record definition for a "request" type that might not be exported?</p>



<a name="351671749"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351671749" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351671749">(Apr 21 2023 at 15:59)</a>:</h4>
<p>At some point <a href="https://github.com/alexcrichton/wasm-tools/blob/e675aff4c56755f866c89cb8ab7d4259605ac983/crates/wasmparser/src/validator/types.rs#L1913">this check</a> returns false.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/alexcrichton/wasm-tools/blob/e675aff4c56755f866c89cb8ab7d4259605ac983/crates/wasmparser/src/validator/types.rs#L1913" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/bfe6c616aa8b0795a1f323663262762923feddc8\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f303038326632646564366262636531333166373162303462356638663132313236343964653265366361376430653136333333353434353539323132376363332f616c65786372696368746f6e2f7761736d2d746f6f6c73)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/alexcrichton/wasm-tools/blob/e675aff4c56755f866c89cb8ab7d4259605ac983/crates/wasmparser/src/validator/types.rs#L1913" title="wasm-tools/types.rs at e675aff4c56755f866c89cb8ab7d4259605ac983 · alexcrichton/wasm-tools">wasm-tools/types.rs at e675aff4c56755f866c89cb8ab7d4259605ac983 · alexcrichton/wasm-tools</a></div><div class="message_embed_description">Low level tooling for WebAssembly . Contribute to alexcrichton/wasm-tools development by creating an account on GitHub.</div></div></div>



<a name="351672713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351672713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351672713">(Apr 21 2023 at 16:03)</a>:</h4>
<p>(deleted)</p>



<a name="351825752"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/351825752" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#351825752">(Apr 22 2023 at 09:24)</a>:</h4>
<p>Unfortunately it's going to take some time to update the tooling on my end to test all of this (we're on an old version of wit-bindgen and upgrading is not trivial).</p>



<a name="353209171"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353209171" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353209171">(Apr 27 2023 at 10:17)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> I think I'm still seeing the same issue with everything upgrade to the latest version of wasm-tools including your recently merged resources PR and including transitive wasm-tools dependencies of wit-bindgen:</p>
<div class="codehilite" data-code-language="wit"><pre><span></span><code>  (type (;28;) (record (field "status" 26) (field "headers" 27) (field "body" 24)))
  (type (;29;) (func (param "req" 25) (result 28)))
  (alias core export 3 "inbound-http#handle-request" (core func (;54;)))
  (alias core export 3 "cabi_post_inbound-http#handle-request" (core func (;55;)))
  (func (;25;) (type 29) (canon lift (core func 54) (memory 0) (realloc 10) string-encoding=utf8 (post-return 55)))
  (component (;0;)
    (alias outer 1 29 (type (;0;)))
    (import "import-handle-request" (func (;0;) (type 0)))
</code></pre></div>
<p>The "import-handle-request" has an aliased type to a non-exported type (the record type "28"). Would you expect this to be fixed already? Perhaps I'm missing some transitive dependency on wasm-tools somewhere?</p>



<a name="353244854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353244854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353244854">(Apr 27 2023 at 11:42)</a>:</h4>
<p>Hmm... So it does indeed look like I was missing a transitive dependency on wasm-tools somewhere. I've updated that, and now I'm running into a different issue...</p>



<a name="353244874"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353244874" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353244874">(Apr 27 2023 at 11:42)</a>:</h4>
<p>Investigating...</p>



<a name="353247396"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353247396" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353247396">(Apr 27 2023 at 11:47)</a>:</h4>
<p>I'm now getting the following error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">missing</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">instantiation</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="err">`</span><span class="n">import</span><span class="o">-</span><span class="k">type</span><span class="o">-</span><span class="n">method</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="n">at</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="mh">0x247c7f</span><span class="p">)</span>
</code></pre></div>
<p>But it seems fine to me when inspecting the  wat</p>
<div class="codehilite" data-code-language="WebAssembly"><pre><span></span><code>  <span class="p">(</span><span class="k">type</span> <span class="cm">(;18;)</span> <span class="p">(</span><span class="err">enum</span> <span class="s2">"get"</span> <span class="s2">"post"</span> <span class="s2">"put"</span> <span class="s2">"delete"</span> <span class="s2">"patch"</span> <span class="s2">"head"</span> <span class="s2">"options"</span><span class="p">))</span>
  <span class="c1">;; ....</span>
  <span class="p">(</span><span class="err">instance</span> <span class="cm">(;10;)</span> <span class="p">(</span><span class="err">instantiate</span> <span class="mi">0</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-func-handle-request"</span> <span class="p">(</span><span class="k">func</span> <span class="mi">25</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-method"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">18</span><span class="p">))</span> <span class="c1">;; It seems to think this is missing</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-uri"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">19</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-headers"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">21</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-params"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">22</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-body"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">23</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-request"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">25</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-http-status"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">26</span><span class="p">))</span>
      <span class="p">(</span><span class="err">with</span> <span class="s2">"import-type-response"</span> <span class="p">(</span><span class="k">type</span> <span class="mi">28</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">)</span>
</code></pre></div>



<a name="353248492"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353248492" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353248492">(Apr 27 2023 at 11:49)</a>:</h4>
<p>(as a side note, this seems to only be happening when programmatically instantiating a component not when running <code>wasm-tools validate</code>)</p>



<a name="353256574"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353256574" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353256574">(Apr 27 2023 at 12:06)</a>:</h4>
<p>I think this too is a dangling dependency that has an old wasm-tools version <span aria-label="weary" class="emoji emoji-1f629" role="img" title="weary">:weary:</span></p>



<a name="353271163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353271163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353271163">(Apr 27 2023 at 12:38)</a>:</h4>
<p>Please ignore everything above. I finally was able to update <em>everything</em> to the latest version of wasm-tools (including wit-bindgen, wasmtime, etc.), and it works!</p>



<a name="353271539"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353271539" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353271539">(Apr 27 2023 at 12:39)</a>:</h4>
<p>Closed <a href="https://github.com/bytecodealliance/wasm-tools/issues/986">https://github.com/bytecodealliance/wasm-tools/issues/986</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasm-tools/issues/986" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/de26a2307ae2c93b5419c926b9d4496293a82431\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f666331383164383665643936313134373439623336653961326532613334363662353531353439643735656231383434333766313762326134303436656166352f62797465636f6465616c6c69616e63652f7761736d2d746f6f6c732f6973737565732f393836)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasm-tools/issues/986" title="`wasm-compose` creating an ill formed wasm component · Issue #986 · bytecodealliance/wasm-tools">`wasm-compose` creating an ill formed wasm component · Issue #986 · bytecodealliance/wasm-tools</a></div><div class="message_embed_description">I'm still seeing issues after #977 has been fixed. This is what I'm seeing: $ wasm-tools component wit broken-composed.wasm Error: failed to decode WIT document Caused by: 0: failed to decode WIT f...</div></div></div>



<a name="353272203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353272203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353272203">(Apr 27 2023 at 12:41)</a>:</h4>
<p>This may have uncovered an issue with wasm-compose though...</p>



<a name="353280472"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353280472" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353280472">(Apr 27 2023 at 12:58)</a>:</h4>
<p>Nevermind. So many moving parts, but I got it working.</p>



<a name="353283201"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353283201" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353283201">(Apr 27 2023 at 13:04)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> sorry for the ping again. This exercise has shown me that the full stack of tools seems to be working with the latest version of wasm-tools. Do we have a timeline for cutting a new release? I'd be happy to help update the world when the new version lands.</p>



<a name="353313458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353313458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353313458">(Apr 27 2023 at 14:06)</a>:</h4>
<p>Heh well I'm glad at least everything's working! I'll do a release today for all the various crates</p>



<a name="353317677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353317677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353317677">(Apr 27 2023 at 14:14)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasm-tools/pull/1002">https://github.com/bytecodealliance/wasm-tools/pull/1002</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasm-tools/pull/1002" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/3531a48afbfa53fef4c18f7c3da2a17fb5a4e6cc\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f303838623638363237616431613635396634666230386631356131663732656534366365633338393063643630643163613662353565373338653734346163352f62797465636f6465616c6c69616e63652f7761736d2d746f6f6c732f70756c6c2f31303032)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasm-tools/pull/1002" title="Bump crate versions by alexcrichton · Pull Request #1002 · bytecodealliance/wasm-tools">Bump crate versions by alexcrichton · Pull Request #1002 · bytecodealliance/wasm-tools</a></div><div class="message_embed_description">I think I got all the major/minor bumps right here this time around, but
I think soon we'll need to move to an "always bump major" strategy since
otherwise these are becoming pretty inter-dependent...</div></div></div>



<a name="353329122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353329122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353329122">(Apr 27 2023 at 14:38)</a>:</h4>
<p>I can send PRs to cargo-component, wit-bindgen, etc. once this lands if that would be helpful</p>



<a name="353329475"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353329475" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353329475">(Apr 27 2023 at 14:38)</a>:</h4>
<p>it would indeed!</p>



<a name="353404929"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353404929" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353404929">(Apr 27 2023 at 17:18)</a>:</h4>
<p>ok published!</p>



<a name="353416226"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353416226" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353416226">(Apr 27 2023 at 17:44)</a>:</h4>
<p>First bump: <a href="https://github.com/bytecodealliance/wit-bindgen/pull/562">https://github.com/bytecodealliance/wit-bindgen/pull/562</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/pull/562" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/30d060b2f606428407da1e211a044512215bdbbb\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f336263383636653464383636393234376130653361323535323566373731316665363938613730633864343039613265623563343562393365616436653662352f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f70756c6c2f353632)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/pull/562" title="Update wasm-tools dependencies by rylev · Pull Request #562 · bytecodealliance/wit-bindgen">Update wasm-tools dependencies by rylev · Pull Request #562 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">Updates to latest version bumped in bytecodealliance/wasm-tools#1002</div></div></div>



<a name="353430245"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353430245" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353430245">(Apr 27 2023 at 18:18)</a>:</h4>
<p>Tests are failing. I’ll update them in a bit</p>



<a name="353446466"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353446466" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353446466">(Apr 27 2023 at 18:58)</a>:</h4>
<p>Pushed a fix. Hopefully that's enough to get the tests passing.</p>



<a name="353458561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353458561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353458561">(Apr 27 2023 at 19:31)</a>:</h4>
<p>Tests pass <span aria-label="check" class="emoji emoji-2705" role="img" title="check">:check:</span></p>



<a name="353468059"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353468059" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Levick (rylev) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353468059">(Apr 27 2023 at 19:57)</a>:</h4>
<p>Once you caught a new release for wit-bindgen I’ll update cargo-component.</p>



<a name="353476197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/353476197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#353476197">(Apr 27 2023 at 20:20)</a>:</h4>
<p>ok publishing now</p>



<a name="354068323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/354068323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mossaka (Joe) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#354068323">(Apr 28 2023 at 22:26)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="590805">@Ryan Levick (rylev)</span> for sharing and contributing. That's awesome and tons of useful info.</p>



<a name="374075930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasm-tools%23986%20ill-formed%20composed%20component/near/374075930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Khelifa Saif eddine <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasm-tools.23986.20ill-formed.20composed.20component.html#374075930">(Jul 10 2023 at 20:19)</a>:</h4>
<p>Hello everyone i have a question about wasi-nn i'm reading the code done by <span class="user-mention" data-user-id="487764">@Mossaka (Joe)</span> <span class="user-mention" data-user-id="269505">@Radu Matei</span>  and i found that under crates/wasi-nn/rust/src/ you will find a <a href="http://generated.rs">generated.rs</a> and it says inside this file : "DO NOT EDIT ,  To regenerate this file run the <code>crates/witx-bindgen</code> command"<br>
my question is how to generate this file again ? because i want to add a new backend like onnxruntime to wasi-nn and i don't know how to generate this file from witx specification can anyone help what cmd line i should write any resources anything ?</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>