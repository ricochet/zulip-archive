<html>
<head><meta charset="utf-8"><title>C++ to wasm and Cranelift IR · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html">C++ to wasm and Cranelift IR</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="190941934"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190941934" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Divya Agrawal <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190941934">(Mar 18 2020 at 06:12)</a>:</h4>
<p>Hello all, I am new to Wasm and Cranelift and wanted to play with it  with C++ code. I am trying to compile the C++ code to wasm and also to cranelift IR. I read few documents and saw that C++ exception handling and threads in Wasm are still in development/proposal phase. Given that would it be right to think about replacing the JVM jit environment with wasm at the moment ? Also any concrete starting points in that direction would be really appreciated. TIA.</p>



<a name="190966743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190966743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190966743">(Mar 18 2020 at 11:23)</a>:</h4>
<p>Exception handling and threads for WebAssembly are both <a href="https://github.com/WebAssembly/proposals/#phase-2---proposed-spec-text-available-cg--wg" target="_blank" title="https://github.com/WebAssembly/proposals/#phase-2---proposed-spec-text-available-cg--wg">stage 2 proposals</a> right now. Follow the links on that page for more info.</p>



<a name="190966872"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190966872" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190966872">(Mar 18 2020 at 11:25)</a>:</h4>
<p>Whether or not wasm is a suitable replacement for the JVM depends greatly on how you want to use it. If you need exception handling and threads, then it's not all the way there yet.</p>



<a name="190967090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190967090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Divya Agrawal <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190967090">(Mar 18 2020 at 11:28)</a>:</h4>
<p>Hi Dan, thanks a lot for your comments. Any other starting points for C++ to wasm ?</p>



<a name="190967542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190967542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190967542">(Mar 18 2020 at 11:33)</a>:</h4>
<p>Are you interested in wasm in browsers, outside of browsers, or both?</p>



<a name="190967702"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190967702" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Divya Agrawal <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190967702">(Mar 18 2020 at 11:34)</a>:</h4>
<p>outside of browsers</p>



<a name="190967787"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190967787" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190967787">(Mar 18 2020 at 11:36)</a>:</h4>
<p>wasi-sdk has packages of clang for C/C++ configured to work with wasi-libc and builds of libc++</p>



<a name="190967802"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190967802" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190967802">(Mar 18 2020 at 11:36)</a>:</h4>
<p><a href="https://github.com/WebAssembly/wasi-sdk" target="_blank" title="https://github.com/WebAssembly/wasi-sdk">https://github.com/WebAssembly/wasi-sdk</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasi-sdk" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasi-sdk" target="_blank" title="WebAssembly/wasi-sdk">WebAssembly/wasi-sdk</a></div><div class="message_embed_description">WASI-enabled WebAssembly C/C++ toolchain. Contribute to WebAssembly/wasi-sdk development by creating an account on GitHub.</div></div></div>



<a name="190968176"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190968176" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Julian Seward <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190968176">(Mar 18 2020 at 11:40)</a>:</h4>
<p>Dan, is that also available for arm64-linux?  It would be useful (for current dev work) if it was.  Currently we have to compile C++ to wasm on an x86 box and then scp it to an arm64 box for testing, which is, well, something that would be nice to be able to avoid.</p>



<a name="190968792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190968792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190968792">(Mar 18 2020 at 11:48)</a>:</h4>
<p>Unfortunately no, we don't have precompiled packages for arm64 yet.</p>



<a name="190968825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190968825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190968825">(Mar 18 2020 at 11:49)</a>:</h4>
<p>If you build it from source, it ought to work though.</p>



<a name="190969007"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190969007" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joey Gouly <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190969007">(Mar 18 2020 at 11:51)</a>:</h4>
<p>and rust/cargo should work</p>



<a name="190970318"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190970318" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Julian Seward <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190970318">(Mar 18 2020 at 12:04)</a>:</h4>
<p><span class="user-mention" data-user-id="265780">@Joey Gouly</span> sure, but I really would prefer to start with C test cases.</p>



<a name="190970457"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190970457" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Julian Seward <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190970457">(Mar 18 2020 at 12:06)</a>:</h4>
<p><span class="user-mention" data-user-id="254083">@Dan Gohman</span> do you happen to know if building from source is a complex process (mucho hoop jumping?)  Or is it something nice like ./configure ; make ; make install?</p>



<a name="190970784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190970784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190970784">(Mar 18 2020 at 12:09)</a>:</h4>
<p>It's a pretty simple process in theory: check out wasi-sdk, init the git submodules, run "make", you now have /opt/wask-sdk/bin/clang etc. and are good to go</p>



<a name="190971391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190971391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190971391">(Mar 18 2020 at 12:16)</a>:</h4>
<p>Set <code>PREFIX=...</code> on the make invocation if you want it to build somewhere else.</p>



<a name="190971414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%2B%2B%20to%20wasm%20and%20Cranelift%20IR/near/190971414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Julian Seward <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.2B.2B.20to.20wasm.20and.20Cranelift.20IR.html#190971414">(Mar 18 2020 at 12:17)</a>:</h4>
<p><span class="user-mention" data-user-id="254083">@Dan Gohman</span> thanks!  I'll give it a try.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>