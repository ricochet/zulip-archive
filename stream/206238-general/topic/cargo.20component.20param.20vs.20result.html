<html>
<head><meta charset="utf-8"><title>cargo component param vs result · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html">cargo component param vs result</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="342360176"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342360176" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342360176">(Mar 16 2023 at 16:09)</a>:</h4>
<p>When using cargo component, if there are two functions imported, and the return type of one import  corresponds to the param type of the other, is there by chance a nice way to convert a value from the wit return type to the wit param type so that you can feed the output of one import into the other?</p>



<a name="342362081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342362081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342362081">(Mar 16 2023 at 16:16)</a>:</h4>
<p>Or I guess what I'm really wondering is if it would be useful for the generated result types and param types in the bindings to implement <code>From</code> traits</p>



<a name="342373816"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342373816" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342373816">(Mar 16 2023 at 16:59)</a>:</h4>
<p>Right now, no, as the generated bindings don't know they're the same type (I assume we're not talking primitives)</p>



<a name="342374229"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342374229" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342374229">(Mar 16 2023 at 17:01)</a>:</h4>
<p>This will be solved in the future with improved id / version information in the extern descriptions plus registry support</p>



<a name="342374416"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342374416" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342374416">(Mar 16 2023 at 17:01)</a>:</h4>
<p>Oh unless I misread the question and this is all from the same wit package</p>



<a name="342374709"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342374709" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342374709">(Mar 16 2023 at 17:02)</a>:</h4>
<p>Then that's a wit-bindgen issue where the types aren't being shared correctly</p>



<a name="342375308"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342375308" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342375308">(Mar 16 2023 at 17:05)</a>:</h4>
<p>Perhaps a concrete example might clear up my confusion</p>



<a name="342381984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342381984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342381984">(Mar 16 2023 at 17:35)</a>:</h4>
<p>It is all from one wit package</p>



<a name="342382027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342382027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342382027">(Mar 16 2023 at 17:35)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">checkpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bindings</span>::<span class="n">storage</span>::<span class="n">imp_get_checkpoint</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bindings</span>::<span class="n">storage</span>::<span class="n">hash_checkpoint</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">);</span>
</code></pre></div>



<a name="342382222"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342382222" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342382222">(Mar 16 2023 at 17:36)</a>:</h4>
<p>Both functions are wit imports in the same package, but get_checkpoint returns a <code>CheckpointReturn</code> type and <code>hash_checkpoint</code> receives a <code>CheckpointParam</code> type</p>



<a name="342382411"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342382411" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342382411">(Mar 16 2023 at 17:37)</a>:</h4>
<p>so the two lines I have won't work, but if I could do <code>hash_checkpoint(CheckpointParam::from(checkpoint))</code> then this would work</p>



<a name="342384567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342384567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342384567">(Mar 16 2023 at 17:46)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">checkpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bindings</span>::<span class="n">storage</span>::<span class="n">imp_get_checkpoint</span><span class="p">();</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bindings</span>::<span class="n">storage</span>::<span class="n">hash_checkpoint</span><span class="p">(</span><span class="n">bindings</span>::<span class="n">storage</span>::<span class="n">CheckpointParam</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">contents</span>: <span class="nc">bindings</span>::<span class="n">storage</span>::<span class="n">ContentParam</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">log_root</span>: <span class="kp">&amp;</span><span class="nc">checkpoint</span><span class="p">.</span><span class="n">contents</span><span class="p">.</span><span class="n">log_root</span><span class="p">,</span>
<span class="w">          </span><span class="n">log_length</span>: <span class="nc">checkpoint</span><span class="p">.</span><span class="n">contents</span><span class="p">.</span><span class="n">log_length</span><span class="p">,</span>
<span class="w">          </span><span class="n">map_root</span>: <span class="kp">&amp;</span><span class="nc">checkpoint</span><span class="p">.</span><span class="n">contents</span><span class="p">.</span><span class="n">map_root</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">key_id</span>: <span class="kp">&amp;</span><span class="nc">checkpoint</span><span class="p">.</span><span class="n">key_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">signature</span>: <span class="kp">&amp;</span><span class="nc">checkpoint</span><span class="p">.</span><span class="n">signature</span>
<span class="w">      </span><span class="p">});</span>
</code></pre></div>



<a name="342384994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342384994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342384994">(Mar 16 2023 at 17:48)</a>:</h4>
<p>In this example, as a dev, I can do this, where I create a <code>CheckpointParam</code> myself based on the <code>CheckpointResult</code> that I have, but in general folks might have more complicated structs, and a desire to convert between the two types using a trait implemented in the bindings themselves...</p>



<a name="342385190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342385190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342385190">(Mar 16 2023 at 17:49)</a>:</h4>
<p>Essentially a <code>From</code> implementation that does what I just did above being included in the bindings</p>



<a name="342385754"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342385754" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342385754">(Mar 16 2023 at 17:52)</a>:</h4>
<p>In retrospect I see that this would have made more sense in the <code>wit-bindgen</code> stream</p>



<a name="342390874"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342390874" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342390874">(Mar 16 2023 at 18:17)</a>:</h4>
<p>Oh I see, the difference between generated param / result types for borrowing purposes, yeah</p>



<a name="342390926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342390926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342390926">(Mar 16 2023 at 18:17)</a>:</h4>
<p>Indeed, some conversions for those make sense</p>



<a name="342390951"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342390951" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342390951">(Mar 16 2023 at 18:17)</a>:</h4>
<p>and wit-bindgen would be the place</p>



<a name="342399898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342399898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342399898">(Mar 16 2023 at 19:02)</a>:</h4>
<p>Would it make sense to use a single type with <code>Cow</code>s?</p>



<a name="342401532"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/cargo%20component%20param%20vs%20result/near/342401532" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Macovei <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/cargo.20component.20param.20vs.20result.html#342401532">(Mar 16 2023 at 19:10)</a>:</h4>
<p>Posted a link to this topic over in <code>wit-bindgen</code></p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>