<html>
<head><meta charset="utf-8"><title>wasmtime wasm-c-api on Windows ... noob · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html">wasmtime wasm-c-api on Windows ... noob</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="195563557"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195563557" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195563557">(Apr 28 2020 at 13:28)</a>:</h4>
<p>bjorn: thanks. will come back to that if I need it. will stick to wasm-c-api only for now. extensions if I need them.</p>



<a name="195563926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195563926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195563926">(Apr 28 2020 at 13:30)</a>:</h4>
<p>you got this weird typedef/enum clash going on. visual studio doesn't like it.</p>
<p>typedef uint8_t wasmtime_opt_level_t;<br>
enum wasmtime_opt_level_enum { // OptLevel<br>
  WASMTIME_OPT_LEVEL_NONE,<br>
  WASMTIME_OPT_LEVEL_SPEED,<br>
  WASMTIME_OPT_LEVEL_SPEED_AND_SIZE,<br>
};</p>



<a name="195564362"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195564362" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195564362">(Apr 28 2020 at 13:33)</a>:</h4>
<p>I don't care as going wasm-c-api direct so can work around it but fyi</p>



<a name="195564554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195564554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195564554">(Apr 28 2020 at 13:34)</a>:</h4>
<p>should change my subject as this isn't WMRT, its wasmtime :)</p>



<a name="195564638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195564638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195564638">(Apr 28 2020 at 13:35)</a>:</h4>
<p>Great to hear that you have initial things working! Please do let us know about issues as you find them—this is great feedback!</p>



<a name="195564775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195564775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195564775">(Apr 28 2020 at 13:36)</a>:</h4>
<p>As <span class="user-mention" data-user-id="271313">@Benjamin Brittain</span> says, Wasmtime supports the wasm-c-api. It does have some additions, such as support for WASI, but those might not be immediately relevant to your use case, at least to begin with</p>



<a name="195564841"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195564841" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195564841">(Apr 28 2020 at 13:36)</a>:</h4>
<p>yeah, nothing like hitting something for real to see what happens :)</p>
<p>looks like I should be able to get the basics up &amp; running from here. so lets see ...</p>
<p>cheers guys :)</p>



<a name="195564853"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195564853" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Brittain <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195564853">(Apr 28 2020 at 13:37)</a>:</h4>
<p>(it also has a few things stubbed out like <code>wasm_frame_instance</code>)</p>



<a name="195565172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195565172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195565172">(Apr 28 2020 at 13:39)</a>:</h4>
<p>good point on the stubs, yes. There are some corners of the api that we've only filled in as needed</p>



<a name="195565528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195565528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195565528">(Apr 28 2020 at 13:42)</a>:</h4>
<p>runs, works as expected. clean exit. </p>
<p>&lt;&gt;&lt;&gt; contact :)</p>



<a name="195565905"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195565905" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195565905">(Apr 28 2020 at 13:45)</a>:</h4>
<p>for clean wasm-c-api, standard wasm.h header can be used with wasmtime-c-api, wasmtime.h and wasi.h just for extras</p>



<a name="195566359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195566359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195566359">(Apr 28 2020 at 13:48)</a>:</h4>
<p>had no joy compiling against your extras &amp; as noob don't need them just yet. pushed me to the standard stuff where I should be anyway so all good. can look at how to interface to your extensions when I get that far. cheers.</p>



<a name="195572647"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195572647" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195572647">(Apr 28 2020 at 14:33)</a>:</h4>
<p><span class="user-mention" data-user-id="297332">@Steve Williams</span> oh one important thing to note is that the examples in the repo should be up-to-date, but they need to be paired with the same version of wasmtime. There's been a number of changes to wasmtime-specific APIs since 0.15.0 so if you're using the examples in the repo you'll likely need to use the dev releases</p>



<a name="195578033"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195578033" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195578033">(Apr 28 2020 at 15:09)</a>:</h4>
<p>yup - understood. getting my head around standard wasm-c-api first :) </p>
<p>thanks. don't suppose there's a chatroom for that somewhere as that's not really what this room's for.</p>



<a name="195579571"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195579571" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195579571">(Apr 28 2020 at 15:19)</a>:</h4>
<p>thinking where to start. we've had versions of our scripting interface in javascript, java, csharp and native.</p>
<p>as I like c++, found this : <a href="https://github.com/alexnoz/wasm-class-sample/blob/master/dog.cc" title="https://github.com/alexnoz/wasm-class-sample/blob/master/dog.cc">https://github.com/alexnoz/wasm-class-sample/blob/master/dog.cc</a></p>
<p>maybe start there, which is comfortable for me, but not necessarily for webdevs.</p>
<p>this is a bit off topic for here but anyone for insight for what's the cleanest performant web assembly source language that will suit webdevs ?</p>
<p>with an example &amp; means of compilation. the easier it is, the better as we're going for accessibility here.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/alexnoz/wasm-class-sample/blob/master/dog.cc" style="background-image: url(https://avatars2.githubusercontent.com/u/22446806?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/alexnoz/wasm-class-sample/blob/master/dog.cc" title="alexnoz/wasm-class-sample">alexnoz/wasm-class-sample</a></div><div class="message_embed_description">A simple C++ WASM demo. Contribute to alexnoz/wasm-class-sample development by creating an account on GitHub.</div></div></div>



<a name="195581169"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195581169" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195581169">(Apr 28 2020 at 15:30)</a>:</h4>
<p>maybe I do start there. gets me a class. I'll want instances of the class to connect to their native equivalent somehow. have done this before by having a master engine class which generates instances of things, which creates the instances inside a callback, which binds in a native instance, which should be hidden from the runtime view. the native pointer is accessible from within native callbacks. </p>
<p>that's too much for here. sorry thinking out loud. I'll shut up and just do it :)</p>



<a name="195582766"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195582766" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195582766">(Apr 28 2020 at 15:41)</a>:</h4>
<p>Note that that example uses Emscripten, which means that it won't work with Wasmtime, as Wasmtime doesn't support Emscripten's ABI</p>



<a name="195582903"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195582903" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195582903">(Apr 28 2020 at 15:42)</a>:</h4>
<p>that's gold, thanks :) care to suggest something that will work ?</p>



<a name="195583039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195583039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195583039">(Apr 28 2020 at 15:43)</a>:</h4>
<p>As for source languages, I think Rust and AssemblyScript are the best supported ones right now, and are generally seen pretty positively by webdevs. C++ might work, but is seen as much scarier by most webdevs</p>



<a name="195583291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195583291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195583291">(Apr 28 2020 at 15:45)</a>:</h4>
<p>the problem is that right now you need some kind of binding layer for being able to communicate using high-level data types (as opposed to just numbers). <a href="https://github.com/WebAssembly/interface-types" title="https://github.com/WebAssembly/interface-types">Interface Types</a> will address that, but neither is the spec done, nor do we have a complete implementation in Wasmtime, nor is there a C++ toolchain for them <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/interface-types" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/interface-types" title="WebAssembly/interface-types">WebAssembly/interface-types</a></div><div class="message_embed_description">Contribute to WebAssembly/interface-types development by creating an account on GitHub.</div></div></div>



<a name="195583393"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195583393" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195583393">(Apr 28 2020 at 15:45)</a>:</h4>
<p>I know that both <span class="user-mention" data-user-id="254083">@Dan Gohman</span> and <span class="user-mention" data-user-id="253990">@fitzgen (he/him)</span> had sketches of a C++ bindings layer that could work, but I don't think there's anything you could just take and run with</p>



<a name="195583514"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195583514" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195583514">(Apr 28 2020 at 15:46)</a>:</h4>
<p>hmmmmm ....</p>



<a name="195583985"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195583985" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195583985">(Apr 28 2020 at 15:49)</a>:</h4>
<p>don't need anything fancy. I can get objects into native callbacks. if I have a void * I can scribble in there, I can tag in our native thing and in a destructor, remove it, with access in any of the methods. if you don't have a void * I can scribble in, doesn't sound the hardest job ever to add one.</p>



<a name="195584038"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195584038" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195584038">(Apr 28 2020 at 15:49)</a>:</h4>
<p>&amp; that wouldn't be accessible script side so would be safe &amp; secure.</p>



<a name="195584202"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195584202" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195584202">(Apr 28 2020 at 15:50)</a>:</h4>
<p>binding all this is the tricky bit. I've done it with other scripting APIs so just going at it should get me to the point of identifying what's missing, if anything.</p>



<a name="195584569"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195584569" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195584569">(Apr 28 2020 at 15:53)</a>:</h4>
<p>looking for a simple assemblyscript exampel, bit like the Dog C++ one above. no joy thus far.</p>



<a name="195584660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195584660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195584660">(Apr 28 2020 at 15:54)</a>:</h4>
<p>assuming its a bit like javascript, which would keep current webdevs happy, but I know nothing - this is all new to me.</p>



<a name="195584732"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195584732" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195584732">(Apr 28 2020 at 15:54)</a>:</h4>
<p>realize you guys like your rust &amp; we'll support that in due course, just don't think its the smart move right now as it does nt help migrate existing web apps over.</p>



<a name="195585842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195585842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195585842">(Apr 28 2020 at 16:01)</a>:</h4>
<p>I'm here - noob on multiple fronts whilst just about to write something tricky :)</p>
<p><a href="https://www.sitepen.com/blog/getting-started-with-assemblyscript/" title="https://www.sitepen.com/blog/getting-started-with-assemblyscript/">https://www.sitepen.com/blog/getting-started-with-assemblyscript/</a></p>
<p>gets my head in the right place. so assemblyscript it is. coz easy ish. will learn it as I go, I suppose :)</p>
<div class="message_embed"><a class="message_embed_image" href="https://www.sitepen.com/blog/getting-started-with-assemblyscript/" style="background-image: url(https://www.sitepen.com/wp-content/uploads/2020/01/og_imageV1.jpg)"></a><div class="data-container"><div class="message_embed_title"><a href="https://www.sitepen.com/blog/getting-started-with-assemblyscript/" title="Getting Started with AssemblyScript">Getting Started with AssemblyScript</a></div><div class="message_embed_description">In a previous post we looked at how to compile the popular programming language Go to WebAssembly. WebAssembly is a new programming language which provides a compact binary format for the web. In this post we’ll explore another WebAssembly target language called AssemblyScript. AssemblyScript allows developers to write strictly typed TypeScript (a typed superset of …</div></div></div>



<a name="195586290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195586290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195586290">(Apr 28 2020 at 16:04)</a>:</h4>
<p>think I'm in the scripting twilight zone :)</p>



<a name="195587514"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195587514" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195587514">(Apr 28 2020 at 16:11)</a>:</h4>
<p>here's the bit I don't understand. my native c++ engine instantiates wasmtime. wasmtime loads a wasm binary. that wasm binary asks what invoked it (my c++ thing) to create a Foo. how does whatever compiles <a href="http://mything.as" title="http://mything.as">mything.as</a> know the class Foo exists ? in .net I had a bootstrap assembly we referenced in with all this stuff defined in it.</p>



<a name="195587720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195587720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195587720">(Apr 28 2020 at 16:13)</a>:</h4>
<p>here's a snippet from our mono csharp bootstrap.</p>
<p>public class Zone<br>
   {<br>
      [DllImport("__Internal")] static extern IntPtr Zone_CreateNative();</p>
<div class="codehilite"><pre><span></span><code>  public Zone()
     {
          m_native = Zone_CreateNative();
     }

    IntPtr m_native;
</code></pre></div>


<p>}</p>
<p>Its not ideal, as the native pointer is visible script side but hopefully you can see what I'm trying to do.</p>



<a name="195588068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195588068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195588068">(Apr 28 2020 at 16:15)</a>:</h4>
<p>assemblyscript looks like rust, think I'm being conneed into migrating to rust here :) but whatever. web assembly is language neutral so can backtrack later :)</p>



<a name="195588292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195588292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195588292">(Apr 28 2020 at 16:17)</a>:</h4>
<p>so, from what I've seen, callbacks into trusted native code can be compiled or at least referenced.</p>



<a name="195589088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195589088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195589088">(Apr 28 2020 at 16:23)</a>:</h4>
<p>Then you have </p>
<p>[DllImport("__Internal")] static extern void Zone_SomeMethod(IntPtr  native);</p>
<p>void Zone::SomeMethod()<br>
{<br>
     Zone_SomeMethod(m_native);<br>
}</p>
<p>... to hook native interop into the scripted equivalent.</p>
<p>that probaby has some fancy comp sci terminology I don't understand. I just do it :)</p>



<a name="195589268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195589268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195589268">(Apr 28 2020 at 16:24)</a>:</h4>
<p>it works &amp; looks like it'll work again, but I don't want the script to be able to see its m_native handle as modifying a native pointer would be bad. as would doing unsupported things with it such as swapping handles between two instances or any other hackery.</p>



<a name="195596446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195596446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195596446">(Apr 28 2020 at 17:13)</a>:</h4>
<p>equivalent of __Internal in mono appears to be this stuff in wasm text thingy. </p>
<p>(func $print (import "" "print") (param i32) (result i32))<br>
  (func $closure (import "" "closure") (result i32))</p>
<p>which then gets bound by the runtime as per the examples.</p>
<p>so just a case of figuring out the syntax for that bit.</p>
<p>guessing I can compile that into a module other wasm stuff can bind to ... equivalent of our mono bootstrap.dll</p>
<p>but I have no idea yet as new to this stuff :)</p>



<a name="195598374"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195598374" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195598374">(Apr 28 2020 at 17:26)</a>:</h4>
<p>so ... I can hack together a bunch of import functions into a wsm text thingy, which our runtime will load &amp; fix up the pointers as per sample code examples. what I don't understand is how a wasm thing I'm compiling knows about this stuff.</p>



<a name="195598746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195598746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195598746">(Apr 28 2020 at 17:29)</a>:</h4>
<p>something like this ?</p>
<p><a href="https://github.com/AssemblyScript/assemblyscript/blob/master/tests/compiler/external.ts" title="https://github.com/AssemblyScript/assemblyscript/blob/master/tests/compiler/external.ts">https://github.com/AssemblyScript/assemblyscript/blob/master/tests/compiler/external.ts</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/AssemblyScript/assemblyscript/blob/master/tests/compiler/external.ts" style="background-image: url(https://avatars3.githubusercontent.com/u/28916798?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/AssemblyScript/assemblyscript/blob/master/tests/compiler/external.ts" title="AssemblyScript/assemblyscript">AssemblyScript/assemblyscript</a></div><div class="message_embed_description">Definitely not a TypeScript to WebAssembly compiler 🚀 - AssemblyScript/assemblyscript</div></div></div>



<a name="195599210"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195599210" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195599210">(Apr 28 2020 at 17:32)</a>:</h4>
<p>going right to basics, we got this as the simples wasm example.</p>
<p><a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.wat" title="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.wat">https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.wat</a></p>
<p>which is a precompiled script in text format. what might be the equivalent of that in assemblyscript.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.wat" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.wat" title="WebAssembly/wasm-c-api">WebAssembly/wasm-c-api</a></div><div class="message_embed_description">Wasm C API prototype. Contribute to WebAssembly/wasm-c-api development by creating an account on GitHub.</div></div></div>



<a name="195599930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195599930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195599930">(Apr 28 2020 at 17:38)</a>:</h4>
<p>ahhh :)</p>
<p><a href="https://assemblyscript.org/docs/std/" title="https://assemblyscript.org/docs/std/">https://assemblyscript.org/docs/std/</a></p>
<p>sorry, too much thinking out loud.</p>



<a name="195602015"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195602015" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195602015">(Apr 28 2020 at 17:52)</a>:</h4>
<p>I got this as my first I have no clue what I'm doing rough block out. have no idea if it compiles yet :)</p>
<p><a href="https://pastebin.com/GBz9HtuP" title="https://pastebin.com/GBz9HtuP">https://pastebin.com/GBz9HtuP</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/GBz9HtuP" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/GBz9HtuP" title="  //export declare namespace infinity   //{    //@external(&quot;bootstrap&quot;)  export  - Pastebin.com">  //export declare namespace infinity   //{    //@external("bootstrap")  export  - Pastebin.com</a></div></div></div>



<a name="195602202"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195602202" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195602202">(Apr 28 2020 at 17:54)</a>:</h4>
<p>if I can get something like that to at least run, that gets us to roughly where we were with mono. can then worry about how to lock down the native pointer &amp; perhaps specifiy it better as it doesn't need to be 64 bit on 32 bit run times.</p>



<a name="195602835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195602835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195602835">(Apr 28 2020 at 17:59)</a>:</h4>
<p>ooh, we got uintptr type. that's better. </p>
<p>sorry :)</p>



<a name="195672882"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195672882" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195672882">(Apr 29 2020 at 07:56)</a>:</h4>
<p>hi. me again, with trivial questions. wanting to experiment with assemblyscript. I'm on windows (can use linux, but I want a windows end-end solution asap). so I need asc.exe to compile. finding one seems harder than I'd expect. any clues ?</p>



<a name="195674160"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195674160" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195674160">(Apr 29 2020 at 08:07)</a>:</h4>
<p>found assemblyscript discord channel, so can ask issues specific to that tool chain over there rather than bother you lot :) sorry.</p>



<a name="195693858"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195693858" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195693858">(Apr 29 2020 at 11:24)</a>:</h4>
<p>yeah, I think the ASC Discord channel is probably better for these questions—lots more people with good knowledge of that toolchain than here <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="195698570"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698570" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698570">(Apr 29 2020 at 12:11)</a>:</h4>
<p>Its a whole world of pain. their toolchain relies on node.js which is a whole ecosystem I'd like to avoid. so I'm trying emscripten after you said not supported coz I don't see the problem if I keep within your constraints &amp; not wanting to lose my mind with crate weirdnesses either :)</p>



<a name="195698675"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698675" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698675">(Apr 29 2020 at 12:12)</a>:</h4>
<p>think I'm getting old, I just want to have a source file and have it compile. I don't want to install zigabytes of junk with weird names for stuff.<br>
I learnt a crate is a library. library is a fine word. we don't need to rename things :)</p>



<a name="195698727"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698727" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698727">(Apr 29 2020 at 12:13)</a>:</h4>
<p>this is the problem with open sores software, it gets way too nerdy. I like to keep things simple :) rant over :)</p>



<a name="195698767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698767">(Apr 29 2020 at 12:13)</a>:</h4>
<p>If your target audience are webdevs, I'm really skeptical C++ is the language to go with, but anyway, I hope things work out</p>



<a name="195698897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698897">(Apr 29 2020 at 12:15)</a>:</h4>
<p>absolutely, but right now, my audience is me to get our wasm stuff talking to our native stuff and I'm a c++ guy.</p>



<a name="195698912"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698912" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698912">(Apr 29 2020 at 12:15)</a>:</h4>
<p>(I will point out that while pears are <em>very</em> similar to apples indeed, it still makes sense to not call them apples)</p>



<a name="195698921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195698921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195698921">(Apr 29 2020 at 12:15)</a>:</h4>
<p>once wasm -&gt; native is working, we can hook up various languages on top of wasm.</p>



<a name="195699077"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195699077" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195699077">(Apr 29 2020 at 12:17)</a>:</h4>
<p>that being the point. everyone can use whatever high level stuff they want once the interfaces are established.</p>



<a name="195699323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195699323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195699323">(Apr 29 2020 at 12:19)</a>:</h4>
<p>your stuff is nice - its all the stuff over this that's got holes all over the place.</p>



<a name="195701093"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195701093" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195701093">(Apr 29 2020 at 12:35)</a>:</h4>
<p>emscripten may not be ideal, but it actually installs without too many weirdnesses and actually compiles its own examples with errors.<br>
if assemblyscript did that, I'd be using assemblyscript :)</p>



<a name="195701248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195701248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195701248">(Apr 29 2020 at 12:36)</a>:</h4>
<p>given assemblyscript targets your runtime, it'd be nice if it compiled itself to target your runtime. then node.js weirdnesses can get trashed.</p>



<a name="195704291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195704291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195704291">(Apr 29 2020 at 13:01)</a>:</h4>
<p>before I dive into this any further, how are you guys doing performance wise vs .net assembly mono &amp; microsoft implementations - close or miles out at this point. not sure how mature this stuff is. in fact, haven't much of a clue if ready for prime time.</p>



<a name="195705019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195705019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195705019">(Apr 29 2020 at 13:05)</a>:</h4>
<p>I don't think those are directly comparable, because the source languages are so different. Going from C++ or Rust, you should expect something along the lines of 50% of native performance for most usage. Not sure for AssemblyScript, but then there's no "native" version of that ...</p>
<p>Fastly have a very different use case from yours, but for that they have pretty impressive results: <a href="https://www.fastly.com/blog/lucet-performance-and-lifecycle" title="https://www.fastly.com/blog/lucet-performance-and-lifecycle">https://www.fastly.com/blog/lucet-performance-and-lifecycle</a></p>
<p>(Fastly is using a different runtime, Lucet, which is a sibling to Wasmtime and pretty much the same wrt to runtime performance)</p>
<div class="message_embed"><a class="message_embed_image" href="https://www.fastly.com/blog/lucet-performance-and-lifecycle" style="background-image: url(https://www.fastly.com/assets/blog/announcements-df453f33398ed75b7682429236182ebdc698e9d227e3c183cf3ef3f6769250ed.png?canvas=1200:630&amp;width=1200&amp;height=630&amp;fit=bounds&amp;bg-color=FFFFFF)"></a><div class="data-container"><div class="message_embed_title"><a href="https://www.fastly.com/blog/lucet-performance-and-lifecycle" title="Lucet's performance and lifecycle">Lucet's performance and lifecycle</a></div><div class="message_embed_description">Lucet, Fastly's open source WebAssembly compiler and runtime system, is designed to take WebAssembly beyond the browser. This post will introduce each step in the Lucet lifecycle, and benchmark its performance to highlight how we keep overhead low. </div></div></div>



<a name="195705485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195705485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195705485">(Apr 29 2020 at 13:08)</a>:</h4>
<p>thanks I'd like to see the results of the same benchmark running on .net and wasmtime on the same machine. mono &amp; ms for .net.</p>



<a name="195705513"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195705513" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195705513">(Apr 29 2020 at 13:09)</a>:</h4>
<p>not your problem, obv, but that's what I'd like to see.</p>



<a name="195705775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195705775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195705775">(Apr 29 2020 at 13:11)</a>:</h4>
<p>so, performance aside, lets look at practicalities. here's my minimal c++ testcase &amp; an extract of what emcc spits out.</p>
<p><a href="https://pastebin.com/r2H23Bqw" title="https://pastebin.com/r2H23Bqw">https://pastebin.com/r2H23Bqw</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/r2H23Bqw" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/r2H23Bqw" title="extern &quot;C&quot;  {  void *Zone_CreateNative();  }    class Zone  {  public:  	Zone()  - Pastebin.com">extern "C"  {  void *Zone_CreateNative();  }    class Zone  {  public:  	Zone()  - Pastebin.com</a></div></div></div>



<a name="195706051"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195706051" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195706051">(Apr 29 2020 at 13:12)</a>:</h4>
<p>Zone_CreateNative is my experimental wasm callback thingy I can fix up as per wasm-c-api example.</p>



<a name="195706188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195706188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195706188">(Apr 29 2020 at 13:13)</a>:</h4>
<p>the others are concerning. I don't understand how they resolve. is this why you were saying don't use emcc ?</p>



<a name="195706445"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195706445" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195706445">(Apr 29 2020 at 13:15)</a>:</h4>
<p>don't even want to do it quite like that, but I'd expect one unresolved from that. happy to switch languages to get what I need. doesn't have to be c++. just want to get into solution space asap. not have holes.</p>



<a name="195706608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195706608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195706608">(Apr 29 2020 at 13:16)</a>:</h4>
<p>is this one for the emcc guys ?</p>



<a name="195706671"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195706671" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195706671">(Apr 29 2020 at 13:17)</a>:</h4>
<p>ie. how to get it to spit out entirely resolved output. (except for anything deliberately external)</p>



<a name="195707918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195707918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195707918">(Apr 29 2020 at 13:26)</a>:</h4>
<p>if the answer to getting things to resolve is just switch to rust like everyone else, then I guess I do. if that's the solution path, then it is.</p>



<a name="195710030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195710030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195710030">(Apr 29 2020 at 13:41)</a>:</h4>
<p>maybe I get that as its just compiling one source file &amp; not linking. I have no clue, this is all new :)</p>



<a name="195710628"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195710628" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195710628">(Apr 29 2020 at 13:45)</a>:</h4>
<p>I won't be able to look into this enough to be able to answer these questions, I'm afraid <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span></p>



<a name="195710852"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195710852" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195710852">(Apr 29 2020 at 13:47)</a>:</h4>
<p>understood. what I need to progress further is <em>any</em> high level language that emits resolved output that runs in wasmtime. with explicit externals where I put them so I can hook them up. if that's not possible, I gotta go back to .net assembly as I need a solution not a problem.</p>



<a name="195710991"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195710991" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195710991">(Apr 29 2020 at 13:48)</a>:</h4>
<p>got to be frank - if this isn't ready, then its not. we're out of cash &amp; I've got to ship product. this is interesting but if its not ready, our v.1 will have to target .net assembly.</p>



<a name="195711097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195711097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195711097">(Apr 29 2020 at 13:48)</a>:</h4>
<p>and understand you work from wasm down. what generates that isn't your problem.</p>



<a name="195711664"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195711664" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195711664">(Apr 29 2020 at 13:52)</a>:</h4>
<p>also not sure how hiding our native pointers is going to work. in .net assembly, there's the concept of objects so we can hook something in those the managed script can't see. web assembly is lower level. everything is seen.</p>



<a name="195711889"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195711889" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195711889">(Apr 29 2020 at 13:53)</a>:</h4>
<p>if I can get a working example in <em>any</em> language, I can play around &amp; try to figure something out.</p>



<a name="195712317"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195712317" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195712317">(Apr 29 2020 at 13:56)</a>:</h4>
<p>the final issue is the only one that's appropriate for here. we need a means of securely connecting from script side to native that the script side can't see. if we can't do that, web assembly, weirdly wouldn't be secure enough to use and so got to stop there.</p>



<a name="195712936"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195712936" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195712936">(Apr 29 2020 at 13:59)</a>:</h4>
<p>if I'm understanding correctly, unlike .net assembly, web assembly doesn't have an object model. that, I think is a deal breaker as we can't connect securely. maybe I'm wrong. as I can't compile an example right now, I'm not in the code enough to be sure.</p>



<a name="195713918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195713918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195713918">(Apr 29 2020 at 14:04)</a>:</h4>
<p>to fix this, you need the concept of a hybrid class shared between native &amp; script side. the script side can call methods native side but can't see the native side pointer. I don't think you have that yet.</p>



<a name="195714035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195714035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shivam Balikondwar <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195714035">(Apr 29 2020 at 14:05)</a>:</h4>
<p>Do we have any doc/blog that discusses the wasmtime components. I just wanted to read about it and understand how the wasm code is executed.</p>



<a name="195714377"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195714377" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195714377">(Apr 29 2020 at 14:07)</a>:</h4>
<p>Hmm, I don't think we do, but that sounds like something that'd be really useful! <span class="user-mention" data-user-id="254083">@Dan Gohman</span>, is there something in this direction somewhere?</p>



<a name="195714618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195714618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195714618">(Apr 29 2020 at 14:08)</a>:</h4>
<p>is there a document or summary of the low level types supported by wasm ? is there the equivalent of a base class for objects ?</p>



<a name="195714703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195714703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195714703">(Apr 29 2020 at 14:09)</a>:</h4>
<p>did .net assembly just win ?</p>
<p>:)</p>



<a name="195715142"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195715142" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195715142">(Apr 29 2020 at 14:11)</a>:</h4>
<p>because secure. its the web. if your security derives from security in the javascript layer, you're not inherently secure, as the js layer is legacy.</p>
<p>hope I'm wrong.</p>



<a name="195717041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195717041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195717041">(Apr 29 2020 at 14:24)</a>:</h4>
<p>yes, somewhat true in case of emscripten, its binding layer give a world to wasm code. you have to be careful what you are exposing to untrusted code.</p>



<a name="195717256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195717256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195717256">(Apr 29 2020 at 14:26)</a>:</h4>
<p>thanks, yury. played around a bit more, came up with this.</p>
<p><a href="https://pastebin.com/iyMdAiuS" title="https://pastebin.com/iyMdAiuS">https://pastebin.com/iyMdAiuS</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/iyMdAiuS" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/iyMdAiuS" title="  extern &quot;C&quot;  {  void *Secure_CreateNative(const GUID &amp;type_id);  void  Secure_D - Pastebin.com">  extern "C"  {  void *Secure_CreateNative(const GUID &amp;type_id);  void  Secure_D - Pastebin.com</a></div></div></div>



<a name="195717402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195717402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195717402">(Apr 29 2020 at 14:27)</a>:</h4>
<p>but I can't, as far as I'm aware hide the secure base class away. I want the runtime to define that and never let derived types access it direct.</p>



<a name="195718863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195718863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195718863">(Apr 29 2020 at 14:36)</a>:</h4>
<p>... but then we need to be able to get stuff done so we need secure methods, which gets us to this.</p>
<p><a href="https://pastebin.com/5V2UP0nW" title="https://pastebin.com/5V2UP0nW">https://pastebin.com/5V2UP0nW</a></p>
<p>which I'm not really liking. At this point, I'm thinking .net assembly is more elegant &amp; secure.</p>
<p>like I say, hope I'm wrong, I'm noob at web assembly. I might have completely the wrong end of the stick here.</p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/5V2UP0nW" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/5V2UP0nW" title="  extern &quot;C&quot;  {  void *Secure_CreateNative(const GUID &amp;type_id);  void  Secure_D - Pastebin.com">  extern "C"  {  void *Secure_CreateNative(const GUID &amp;type_id);  void  Secure_D - Pastebin.com</a></div></div></div>



<a name="195719792"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195719792" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195719792">(Apr 29 2020 at 14:42)</a>:</h4>
<p>regardless of the language &amp; exact approach, I think this boils down to the runtime needs to define the base class for anything you need to interop with the runtime.   dot net implements that web assembly doesn't. as of current version.</p>



<a name="195721230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195721230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195721230">(Apr 29 2020 at 14:51)</a>:</h4>
<p>The Wasm security model is definitely as strong as (properly sandboxed) .Net, but the mechanisms are quite different, so I think applying the same kind of pattern matching might not be the right way to go.</p>
<p>I'd encourage you to read up on Wasm more thoroughly before jumping to conclusions. At the same time, I appreciate that you have limited time, so perhaps going with something that you're already more familiar with makes sense.</p>



<a name="195721604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195721604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195721604">(Apr 29 2020 at 14:54)</a>:</h4>
<p>in the event we deliver a solid 3d web solution, our choice of secure scripting mechanism will be fairly permanent, as javascript is for html today. <br>
so I'd like to get it right. to make a decision based on what is the best technical solution, rather than quick fix.</p>



<a name="195721821"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195721821" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195721821">(Apr 29 2020 at 14:55)</a>:</h4>
<p>as of this moment, I'm thinking .net is a better architecture. its more secure. I want to be wrong. that's why I want some straight c++ that compiles to wasm so I can see exactly what's going on.</p>



<a name="195721949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195721949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195721949">(Apr 29 2020 at 14:56)</a>:</h4>
<p>I want to try to corrupt my own example script side to see if I can. right now I'm not seeing anything stopping me.</p>



<a name="195722633"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195722633" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195722633">(Apr 29 2020 at 14:59)</a>:</h4>
<p>can even drop the c++ requirement &amp; code this in web assembly direct. I still need a base class with a runtime side pointer my runtime overload will allocate that the web assembly code can't access directly.</p>



<a name="195722661"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195722661" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195722661">(Apr 29 2020 at 14:59)</a>:</h4>
<p>Ok, all I can say at this point is that Wasm isn't less secure, and that its security model has nothing to do with JS, but I unfortunately don't have the bandwidth to talk you through the architecture. There's a wealth of information about it available, though</p>



<a name="195722801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195722801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195722801">(Apr 29 2020 at 15:00)</a>:</h4>
<p>If its not less secure, where is your base class, please.</p>



<a name="195723035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195723035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195723035">(Apr 29 2020 at 15:01)</a>:</h4>
<p>have I lost the plot here ? am I making sense ? I am new to this system. I could be completely wrong and I should read more. I picked this up a day ago. its way too early to jump to conclusions, especially before experts.</p>



<a name="195723666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195723666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195723666">(Apr 29 2020 at 15:05)</a>:</h4>
<p>there needs to be a protected pointer in classes that are shared with the runtime. what is the mechanism for ensuring script side can't access such pointers please.</p>



<a name="195723972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195723972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195723972">(Apr 29 2020 at 15:07)</a>:</h4>
<p>or, if you don't have such a thing yet, can you see the need. I get that this is new. I understand I can't have everything today and that code evolves.</p>



<a name="195725938"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195725938" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195725938">(Apr 29 2020 at 15:20)</a>:</h4>
<p>[Runtime view]  &lt;----- method  &lt;------- [wasm view]</p>
<p>to do anything on the DOM.</p>
<p>in legacy, you go via javascript. when using wasm direct, there's no javascript isolation layer.</p>



<a name="195727195"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195727195" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195727195">(Apr 29 2020 at 15:29)</a>:</h4>
<p><a href="https://webassembly.org/docs/semantics/#types" title="https://webassembly.org/docs/semantics/#types">https://webassembly.org/docs/semantics/#types</a></p>
<p>I'll add to that unprotected memory - stuff created &amp; managed by the native app DOM ("web browser") - an extension to your runtime, running in the same memory space.</p>
<p>Pointers to unprotected memory must be guarded or you just lost whatever security you had.</p>
<p>Only trusted methods - implemented runtime side should be able to access unprotected memory pointers.</p>



<a name="195731768"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195731768" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195731768">(Apr 29 2020 at 15:57)</a>:</h4>
<p>I'm heading back to mono / .net  as I need a secure performant scripting system without a bunch of legacy in the middle. if you don't have that yet, but you do in html browsers with javascript magic I don't currently comprehend, perhaps you can boil your magic javascript down to its core essentials to in effect get wasm a secure base class.  sorry I can't contribute more but funding crisis means I need to deliver an immediate solution to assure investors.</p>



<a name="195733603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195733603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195733603">(Apr 29 2020 at 16:09)</a>:</h4>
<p>Uhm, Wasm was designed with memory safety in mind, and AFAIK accessing anything out-of-bounds for instance is inherently illegal in Wasm and will result in an immediate trap. Did you perhaps have a look at <a href="https://webassembly.org/docs/security/" title="https://webassembly.org/docs/security/">this</a>?</p>



<a name="195735662"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195735662" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195735662">(Apr 29 2020 at 16:24)</a>:</h4>
<p>yeah I looked at that. obj_1 with dom handle.  obj_2 with dom handle. wasm code swaps the handles. bad stuff happens.</p>



<a name="195735871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195735871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195735871">(Apr 29 2020 at 16:26)</a>:</h4>
<p>wasm was designed with javascript running on top. when you take that away, it falls apart. show me an example with a single dom base class implemented trusted ("web browser") side, accessed wasm (untrusted script side) that I can't break.</p>



<a name="195737119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737119">(Apr 29 2020 at 16:36)</a>:</h4>
<p>Hmm, given my limited knowledge of how DOM classes actually work, I'm not sure I understand what the problem is. But that aside, is your usecase targetting Wasm + JS, or standalone Wasm?</p>



<a name="195737241"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737241" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737241">(Apr 29 2020 at 16:37)</a>:</h4>
<p>standalone. as I can do with mono. mentioned not to annoy you but to explain where solution space is.</p>



<a name="195737287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737287">(Apr 29 2020 at 16:37)</a>:</h4>
<p>Oh, not to worry, not getting annoyed, just trying to understand where you're coming from ;-)</p>



<a name="195737394"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737394" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737394">(Apr 29 2020 at 16:38)</a>:</h4>
<p>k, currently here : <a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c" title="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c">https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c" title="WebAssembly/wasm-c-api">WebAssembly/wasm-c-api</a></div><div class="message_embed_description">Wasm C API prototype. Contribute to WebAssembly/wasm-c-api development by creating an account on GitHub.</div></div></div>



<a name="195737398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737398">(Apr 29 2020 at 16:38)</a>:</h4>
<p>OK, so how do you think standalone Wasm with Wasmtime runtime say is any less secure than .NET vm?</p>



<a name="195737451"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737451" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737451">(Apr 29 2020 at 16:38)</a>:</h4>
<p>hello_callback is untrusted. I can do anything there - it's straight c</p>



<a name="195737655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737655">(Apr 29 2020 at 16:40)</a>:</h4>
<p>including call native methods using a native pointer. that example doesn't have one as its too simple but take it a step further to pull one out of its parameters and you can.</p>



<a name="195737680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737680">(Apr 29 2020 at 16:40)</a>:</h4>
<p>But <code>hello_callback</code> is the callback supplied by you, the runtime provider, is it not?</p>



<a name="195737711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737711">(Apr 29 2020 at 16:40)</a>:</h4>
<p>yes. that's what makes it trusted code. I wrote it so I trust it coz I know what its doing.</p>



<a name="195737778"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737778" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737778">(Apr 29 2020 at 16:41)</a>:</h4>
<p>So if you open up for an attack inside a callback like this, then it's the runtime's problem, is it not?</p>



<a name="195737831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737831">(Apr 29 2020 at 16:41)</a>:</h4>
<p>What I'm getting at here, is that Wasm code that's executed by your runtime is untrusted and sandboxed but only as much as you will provide in your runtime</p>



<a name="195737876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737876">(Apr 29 2020 at 16:42)</a>:</h4>
<p>absolutely. we don't open up an attack inside our callback. we're careful. we're the web browser.</p>



<a name="195737986"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195737986" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195737986">(Apr 29 2020 at 16:43)</a>:</h4>
<p>but what we have to do is give the script a reference of some kind to one of our things. lets keep it simple and say a html table.</p>



<a name="195738020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738020">(Apr 29 2020 at 16:43)</a>:</h4>
<p>say the script wants to add a row to the table, it has to tell us what table it wants to add a row to.</p>



<a name="195738048"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738048" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738048">(Apr 29 2020 at 16:43)</a>:</h4>
<p>wasm-c-api and web browser use cases are not the same</p>



<a name="195738173"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738173" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738173">(Apr 29 2020 at 16:44)</a>:</h4>
<p>I know :)  its not all about web browser. its about having trusted stuff and untrusted stuff and having some way of communicating across that divide.</p>



<a name="195738175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738175">(Apr 29 2020 at 16:44)</a>:</h4>
<p>Can you explain why two thing are mixed in the same conversation?</p>



<a name="195738199"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738199" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738199">(Apr 29 2020 at 16:44)</a>:</h4>
<p>Yeah, I'm kinda confused here as well :-)</p>



<a name="195738223"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738223" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738223">(Apr 29 2020 at 16:44)</a>:</h4>
<p>web browser / web script is the obvious example.</p>



<a name="195738258"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738258" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738258">(Apr 29 2020 at 16:45)</a>:</h4>
<p>Oh, and in WASI, you can only communicate with resources if you've given such a capability to the runtime in the first place</p>



<a name="195738332"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738332" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738332">(Apr 29 2020 at 16:45)</a>:</h4>
<p>So even if your Wasm binary wants to access <code>/dev/random</code> say, it will only be able to if and only if you, as the runtime user, will provide such a capability</p>



<a name="195738417"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738417" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738417">(Apr 29 2020 at 16:46)</a>:</h4>
<p>So I guess to answer your question, in WASI, the comms across the divide (trusted vs untrusted) should happen only via capabilities</p>



<a name="195738422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738422">(Apr 29 2020 at 16:46)</a>:</h4>
<p>Also, looks like you fond of mono, can you provide hello_callback example of how mono does embedding + callback. Is it described in <a href="https://www.mono-project.com/docs/advanced/pinvoke/" title="https://www.mono-project.com/docs/advanced/pinvoke/">https://www.mono-project.com/docs/advanced/pinvoke/</a> ?</p>



<a name="195738508"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738508" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738508">(Apr 29 2020 at 16:46)</a>:</h4>
<p>pinvoke is nasty. that's what I don't like about mono, you can call out to anything.</p>



<a name="195738645"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738645" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738645">(Apr 29 2020 at 16:47)</a>:</h4>
<p>okay</p>



<a name="195738938"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195738938" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195738938">(Apr 29 2020 at 16:50)</a>:</h4>
<p>I don't know your stuff well enough yet, but lets see if we can get an example so we're on the same page.</p>



<a name="195739172"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739172" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739172">(Apr 29 2020 at 16:52)</a>:</h4>
<p>without JS or DOM please :) wasmtime does not know what it is</p>



<a name="195739237"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739237" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739237">(Apr 29 2020 at 16:53)</a>:</h4>
<p>yeah, I know, DOM is just shorthand for trusted native. its not all about web browsers.</p>



<a name="195739244"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739244" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739244">(Apr 29 2020 at 16:53)</a>:</h4>
<p><span class="user-mention" data-user-id="297332">@Steve Williams</span> from what you've been saying, I believe that wasm would fit your use case but it may not be quite as you might imagine (and not the same as mono). The feature that wasm has to support this is called <code>anyref</code> and is part of the reference types proposal. This proposal is not currently fully implemented in Wasmtime nor is it a fully finished proposal, it's still in the stabilization process. The purpose of <code>anyref</code> is so that the host can pass a value to a wasm module which is impossible for wasm to forge. For example you could pass your html table directly to wasm, and wasm couldn't do anything with it other than pass it back to you later on (which is what it sounds like you're going for)</p>



<a name="195739371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739371">(Apr 29 2020 at 16:54)</a>:</h4>
<p>As a workaround today we implement this with table indices. The host has a table of object it wants the wasm module to have access to, for example you'd have a list of html tables on the host, and you'd pass indexes into the table to the wasm module. When calling a host API the host would then need to translate that index to a resource. The context of the API indicates that the index is to the list of html tables, and the host would bounds-check that</p>



<a name="195739375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739375">(Apr 29 2020 at 16:54)</a>:</h4>
<p>alex - that sounds about right - thank you :)</p>



<a name="195739431"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739431" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739431">(Apr 29 2020 at 16:54)</a>:</h4>
<p>this is not a perfect solution, but it is what works today. This is how WASI is implemented which works with files/directories/etc, where the host has a table of files/directories and passes i32 file descriptors to the wasm module.</p>



<a name="195739471"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739471" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739471">(Apr 29 2020 at 16:55)</a>:</h4>
<p>Once fully implemented everything will be <code>anyref</code> though where you will literally pass an unforgeable reference to a wasm module, and then wasm will later pass it back to your host imports.</p>



<a name="195739487"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739487" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739487">(Apr 29 2020 at 16:55)</a>:</h4>
<p>You are guaranteed that wasm never modified the value, and you're also guaranteed that the host constructed the value.</p>



<a name="195739611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739611">(Apr 29 2020 at 16:56)</a>:</h4>
<p>I'm not personally familiar with .NET but it is likely not as powerful as .NET. The anyref/reference-types proposal is pretty minimal and doesn't allow things like classes/extensions/etc, it's just opaque values being passed around. Whether or not that works for your use case I'm not sure.</p>



<a name="195739867"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195739867" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195739867">(Apr 29 2020 at 16:58)</a>:</h4>
<p>handles are a bit better but script side can still mess with them. I want tight binding between script side view and runtime view such that script side can't even see, never mind change its runtime side reference - however that might be represented. its stuck to it hard &amp; invisible.</p>



<a name="195740567"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195740567" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195740567">(Apr 29 2020 at 17:04)</a>:</h4>
<p>You've got no equivalent of mono_object_new     </p>
<p><a href="http://docs.go-mono.com/?link=xhtml%3adeploy%2fmono-api-object.html" title="http://docs.go-mono.com/?link=xhtml%3adeploy%2fmono-api-object.html">http://docs.go-mono.com/?link=xhtml%3adeploy%2fmono-api-object.html</a></p>



<a name="195740930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195740930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195740930">(Apr 29 2020 at 17:07)</a>:</h4>
<p>that's sounding interesting though.  if can see but can't mess with, a step in the right direction. problem is you can swap handles to drop them into views of objects they weren't created with when being malicious. in our trusted side, we cast the pointer to what we know it is to do stuff and bang things go wrong. or perform too many checks for it to be performant.</p>



<a name="195740959"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195740959" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195740959">(Apr 29 2020 at 17:07)</a>:</h4>
<p>hence don't want untrusted side to have access. at all.</p>



<a name="195741203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195741203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195741203">(Apr 29 2020 at 17:09)</a>:</h4>
<p>You can store a list of objects. The index received from wasm then points in that list of objects. For safety you then only need to perform a bounds check and you need to check if the object isn't destroyed.</p>



<a name="195741679"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195741679" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195741679">(Apr 29 2020 at 17:13)</a>:</h4>
<p>per type.  maybe. then if untrusted wants to switch its references around, it does &amp; whatever happens does, but with known types so safe &amp; result is up to the app. maybe. will let that settle.</p>



<a name="195746803"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195746803" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195746803">(Apr 29 2020 at 17:53)</a>:</h4>
<p>thanks bjorn3 :)</p>



<a name="195766561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195766561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurent Julliard <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195766561">(Apr 29 2020 at 20:37)</a>:</h4>
<p>Hi everyone. Just joining the community. I'm working on a (subset of) Ruby to Web Assembly compiler (see <a href="https://github.com/ljulliar/rlang" title="https://github.com/ljulliar/rlang">https://github.com/ljulliar/rlang</a>). I'm currently trying to integrate Rlang with Wasmtime (WASI, type interface, command line arguments,...)</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/ljulliar/rlang" style="background-image: url(https://avatars2.githubusercontent.com/u/16881?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/ljulliar/rlang" title="ljulliar/rlang">ljulliar/rlang</a></div><div class="message_embed_description">A (subset of) Ruby to WebAssembly compiler. Contribute to ljulliar/rlang development by creating an account on GitHub.</div></div></div>



<a name="195768888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195768888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195768888">(Apr 29 2020 at 20:57)</a>:</h4>
<p>Hello!</p>



<a name="195771031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195771031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195771031">(Apr 29 2020 at 21:14)</a>:</h4>
<p>update. got the basics compiling assemblyscript so should have a working example of above nonsense tomorrow :)</p>
<p>cheers all :)</p>



<a name="195775360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195775360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195775360">(Apr 29 2020 at 21:55)</a>:</h4>
<p>so ... if I'm understanding, wasmtime is just pure runtime. it doesn't understand anything about file i/o for example. so, first example of the native interfacing I'm proposing should be to add native file i/o support, then assemblyscript compiler could target wasmtime direct.</p>



<a name="195775537"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195775537" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195775537">(Apr 29 2020 at 21:57)</a>:</h4>
<p>perhaps trying to run before I can walk here, but that's current thoughts. we'll see where it leads.</p>



<a name="195779550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195779550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Brown <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195779550">(Apr 29 2020 at 22:46)</a>:</h4>
<p>The WASI code in wasmtime should give you file IO, I believe; as I glanced at the comments above, I wonder about going down the AssemblyScript route: I've been able to successfully compile C to Wasm (with some limitations) using both Emscripten and wasi-sdk</p>



<a name="195798389"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195798389" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195798389">(Apr 30 2020 at 04:51)</a>:</h4>
<p>Yeah, you can access files and directories on the host in Wasmtime via WASI and its capabilities-oriented security model.</p>



<a name="195798437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195798437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195798437">(Apr 30 2020 at 04:52)</a>:</h4>
<p>We currently only allow for preopening of the directories (preopening meaning, you can give permission to Wasmtime to access some directory on the host).</p>



<a name="195798447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195798447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Konka <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195798447">(Apr 30 2020 at 04:52)</a>:</h4>
<p>In the future, this will naturally be extended to other host resources.</p>



<a name="195808043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195808043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195808043">(Apr 30 2020 at 07:56)</a>:</h4>
<p>Morning all. So if file i/o is there already, is there anything inherently stopping assemblyscript compiling assemblyscript targeting wasmtime ?</p>
<p>I'm not understanding why their dev environment has a node.js dependency.  I'd like to see this system "float" on its own - bootstrap itself, or at the very least understand why that hasn't happened yet. If simply its just a job on the list that hasn't happened yet, that's life at the edge :)</p>
<p>EU next gen internet funding event today - most likely a dull webinar, but might interest some.</p>
<p><a href="https://www.eventbrite.co.uk/e/how-the-new-internet-architects-can-get-up-to-200k-equity-free-funding-tickets-102771361910" title="https://www.eventbrite.co.uk/e/how-the-new-internet-architects-can-get-up-to-200k-equity-free-funding-tickets-102771361910">https://www.eventbrite.co.uk/e/how-the-new-internet-architects-can-get-up-to-200k-equity-free-funding-tickets-102771361910</a></p>
<p>With regard to this project, I'd like to see AssemblyScript targeting wasmtime &amp; whatever it takes to make that happen funded.</p>
<p>Why - coz if we have a self sustaining ecosystem, we need our own stuff so make sure it's spot on.</p>
<p>Why I'm going AssemblyScript (at least for now) - I'm implementing performant secure scripting into our 3D web tech, with the primary audience for that being webdevs. AssemblyScript is the closest we have right now to what they're familiar with. I prefer C++, but I'm not currently targeting me (did that yesterday - so far so good).</p>
<div class="message_embed"><a class="message_embed_image" href="https://www.eventbrite.co.uk/e/how-the-new-internet-architects-can-get-up-to-200k-equity-free-funding-tickets-102771361910" style="background-image: url(https://img.evbuc.com/https%3A%2F%2Fcdn.evbuc.com%2Fimages%2F99655716%2F151482523619%2F1%2Foriginal.20200428-075904?w=1000&amp;auto=format%2Ccompress&amp;q=75&amp;sharp=10&amp;rect=3%2C0%2C1976%2C988&amp;s=3dbbe285604e8de6ac43a2a4705f6928)"></a><div class="data-container"><div class="message_embed_title"><a href="https://www.eventbrite.co.uk/e/how-the-new-internet-architects-can-get-up-to-200k-equity-free-funding-tickets-102771361910" title="How the New Internet Architects can get up to 200K€ equity free funding?">How the New Internet Architects can get up to 200K€ equity free funding?</a></div><div class="message_embed_description">Learn how to participate in the open call for researchers, developers, startups and SMEs can define the future of Internet.</div></div></div>



<a name="195809642"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195809642" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195809642">(Apr 30 2020 at 08:15)</a>:</h4>
<ul>
<li>AssemblyScript compiler / linker targeting wasmtime direct.</li>
</ul>



<a name="195812055"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195812055" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195812055">(Apr 30 2020 at 08:46)</a>:</h4>
<p>or, to at least prove the principle, is there any compiler to wasmtime that runs within the wasmtime runtime yet ?</p>
<p>if not does anyone have any insight as to why ? </p>
<p>is it simply nobody's been motivated to do that yet ?</p>
<p>or is there some gap I don't currently understand.</p>



<a name="195812291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195812291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195812291">(Apr 30 2020 at 08:48)</a>:</h4>
<p>with to regard to moving the assemblyscript compiler over, I think that work has merit, I'd like to see it done, but don't want to either do or manage that work as got too much on as it is. if anyone's up for doing that with eu funding (if approved - not up to me), happy to put in a word (not that anyone cares what I think) to say I think that project should be funded. reasoning above.</p>



<a name="195828329"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195828329" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195828329">(Apr 30 2020 at 11:55)</a>:</h4>
<p>ummmm .... noob intro has an error. fopen needs to be in "rb" mode, windoze :)</p>
<p>just tried loading something else into it &amp; it failed part way into a load. thought how could that possibly fail, then had that doh moment :)</p>
<p><a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c" title="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c">https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/hello.c" title="WebAssembly/wasm-c-api">WebAssembly/wasm-c-api</a></div><div class="message_embed_description">Wasm C API prototype. Contribute to WebAssembly/wasm-c-api development by creating an account on GitHub.</div></div></div>



<a name="195829422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195829422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195829422">(Apr 30 2020 at 12:06)</a>:</h4>
<p>AssemblyScript seems to want one of these things defining.</p>
<p>(import "env" "abort" (func $~lib/builtins/abort (param i32 i32 i32 i32)))</p>
<p>don't suppose anyone wants to drop some c-api hints as to how to do that. I'll figure it out but shortcuts welcome :)</p>



<a name="195830289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195830289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195830289">(Apr 30 2020 at 12:15)</a>:</h4>
<p>thats an abort function in namespace env with 4 int32 parameters ?</p>



<a name="195830431"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195830431" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195830431">(Apr 30 2020 at 12:16)</a>:</h4>
<p>in the event there's an easier way than patching this up, all ears :)</p>



<a name="195831118"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195831118" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195831118">(Apr 30 2020 at 12:23)</a>:</h4>
<p>ummm if that is a namespace thing, I don't see namespaces in the c api.  think I'm stuck.</p>
<p>here's my minimal assemblyscript test, modelled as far as possible on c-api hello.c example.</p>
<p>//// ---- code[start]</p>
<p>export declare function hello(): void</p>
<p>export function run(): void <br>
{<br>
   hello();<br>
}</p>
<p>/// --- code[end]</p>



<a name="195831282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195831282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195831282">(Apr 30 2020 at 12:25)</a>:</h4>
<p>that gets me two imports I'm not sure what to do with yet. one I'm expecting, the other seems to be some kind of a default.</p>
<p>(import "env" "abort" (func $~lib/builtins/abort (param i32 i32 i32 i32)))<br>
 (import "index" "hello" (func $assembly/index/hello))</p>
<p>suggest something like this is a noob tutorial. happy to run with it once I can see what I'm doing.</p>



<a name="195831427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195831427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195831427">(Apr 30 2020 at 12:27)</a>:</h4>
<p>export declare function is a very long winded way of saying import, but lets not mess with assembyscript syntax just yet :)</p>



<a name="195833175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195833175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195833175">(Apr 30 2020 at 12:44)</a>:</h4>
<p>also, as these are c-api questions, maybe this isn't the right place for them as you have a runtime that implements the api, you're not maintainers of the api.</p>



<a name="195835979"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195835979" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195835979">(Apr 30 2020 at 13:09)</a>:</h4>
<p>c-api examples are missing an example that resolves multiple imports from an assembly explicitly by name so I know I'm assigning things correctly.</p>
<p>docs seem light. will have another look at the headers to see if it's obvious.</p>



<a name="195837679"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195837679" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195837679">(Apr 30 2020 at 13:25)</a>:</h4>
<p>nope. checked the header. I pass in an array of external functions. I don't understand how I present that in the right order. I need to bind my implementation to its identifier not cross fingers &amp; hope things are in some pre-deterimined order ... I think. unless I can create some kind of a binding module that does have them in a guaranteed order.</p>



<a name="195838200"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195838200" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195838200">(Apr 30 2020 at 13:29)</a>:</h4>
<p>happy to pivot to your extensions api if that's required to resolve these robustly.</p>



<a name="195838550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195838550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195838550">(Apr 30 2020 at 13:32)</a>:</h4>
<p>c-api module has meta data that describes import and exports types and names.</p>



<a name="195838611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195838611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195838611">(Apr 30 2020 at 13:32)</a>:</h4>
<p>ahhh ... thanks. care to shine a light on where that is please :)</p>



<a name="195838907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195838907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195838907">(Apr 30 2020 at 13:34)</a>:</h4>
<p>searched meta in wasm.h ... nothing.</p>



<a name="195838953"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195838953" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195838953">(Apr 30 2020 at 13:34)</a>:</h4>
<p>there is an example about exports <a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/reflect.c#L128" title="https://github.com/WebAssembly/wasm-c-api/blob/master/example/reflect.c#L128">https://github.com/WebAssembly/wasm-c-api/blob/master/example/reflect.c#L128</a> , but imports will look the same, see wasm_module_exports and wasm_module_imports</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/reflect.c#L128" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasm-c-api/blob/master/example/reflect.c#L128" title="WebAssembly/wasm-c-api">WebAssembly/wasm-c-api</a></div><div class="message_embed_description">Wasm C API prototype. Contribute to WebAssembly/wasm-c-api development by creating an account on GitHub.</div></div></div>



<a name="195839338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195839338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195839338">(Apr 30 2020 at 13:37)</a>:</h4>
<p>thanks, yury. will see if I can get my head around that.</p>



<a name="195891355"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195891355" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurent Julliard <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195891355">(Apr 30 2020 at 19:44)</a>:</h4>
<p>is there a doc somewhere explaining how wasmtime run command line arguments are being passed to the _start entry point of the WASM module ?</p>



<a name="195891751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195891751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195891751">(Apr 30 2020 at 19:47)</a>:</h4>
<p>Not as such. "_start" doesn't get passed args; the program to query for them via <code>args_sizes_get</code> and <code>args_get</code> calls.</p>



<a name="195892720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195892720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurent Julliard <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195892720">(Apr 30 2020 at 19:54)</a>:</h4>
<p>Are these functions imported in the WASM module by the WASm runtime ? (let me explain: I'm writing WAT code more or less directly by hand so I cannot rely on C to wasm or Rust to WSM compiler to handle that for me)</p>



<a name="195893761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195893761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195893761">(Apr 30 2020 at 20:02)</a>:</h4>
<p>Yes, these are WASI functions, imported in a wasm module and typically implemented by the runtime.</p>



<a name="195893854"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195893854" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195893854">(Apr 30 2020 at 20:03)</a>:</h4>
<p>In a C or Rust toolchain, the code to call these and set up the user-facing argv is added by the toolchain</p>



<a name="195939400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195939400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195939400">(May 01 2020 at 07:58)</a>:</h4>
<p>A little more of my nonsense - sorry. I've got getting my head around the reflection stuff to do next but gave the whole problem some more thought.<br>
Our use case is secure performant 3D web scripting. My first thought was to go with AssemblyScript as initial webdev supported language for that. However, if I'm honest, I don't like it. The current compiler runs in node.js which means the  compiler is written in javascript. Which hardcore compiler engineers write their compilers in js ? Not many. What's the optimal compiler toolchain right now ? llvm stuff. So for webdevs, we get to rust. Which isn't a million miles away in terms of syntax from AssemblyScript. So think I pivot our connectivity to Rust. Thinking out loud. Hope that's ok. Realise entire point of WebAssembly is to be language agnostic, but all the same I have to choose one. Others can be supported later.</p>



<a name="195940677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195940677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195940677">(May 01 2020 at 08:24)</a>:</h4>
<p>Apologies if anyone here works on what I just dismissed. Maybe its great and I'm wrong.</p>



<a name="195948352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195948352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195948352">(May 01 2020 at 10:29)</a>:</h4>
<p>Ahhhh ... doh, got it. AssemblyScript compiler isn't written in javascript, it hooks into html browser tech tree javascript compilers.  So it'll be decent. However, the focus there is speed of compilation over pure optimized performance so still reckon llvm path is a better call. </p>
<p>Anyhow, we'll see. As long as interface is accessible from all, plenty of R&amp;D, competition &amp;  complementary approaches possible.</p>
<p>Not the biggest fan of Rust syntax from what I've seen, but it'll do for now.</p>



<a name="195948613"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195948613" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195948613">(May 01 2020 at 10:33)</a>:</h4>
<p>&amp; that's why AssemblyScrript compiler guys can't target wasmtime, coz they need to pull the compiler from the legacy tech tree :)</p>
<p>or maybe I'm way off. haven't checked the code, running this in my head, which isn't always right.</p>



<a name="195950738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195950738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195950738">(May 01 2020 at 11:03)</a>:</h4>
<p>This looks to be my new starting point : <a href="https://dev.to/h_ajsf/simple-rust--wasm-example-5b1m" title="https://dev.to/h_ajsf/simple-rust--wasm-example-5b1m">https://dev.to/h_ajsf/simple-rust--wasm-example-5b1m</a></p>
<p>Too much off topic rambling here, sorry, not sure where else to put it.</p>
<div class="message_embed"><a class="message_embed_image" href="https://dev.to/h_ajsf/simple-rust--wasm-example-5b1m" style="background-image: url(https://res.cloudinary.com/practicaldev/image/fetch/s--1AV03t42--/c_imagga_scale,f_auto,fl_progressive,h_500,q_auto,w_1000/https://cl.ly/7cbff8b6ef29/Image%25202018-12-08%2520at%252012.06.58%2520PM.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://dev.to/h_ajsf/simple-rust--wasm-example-5b1m" title="Simple Rust + WASM example">Simple Rust + WASM example</a></div><div class="message_embed_description">


Install rust




$ brew install rustup
$ rustup-init





Set default toolchai...</div></div></div>



<a name="195951448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195951448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195951448">(May 01 2020 at 11:15)</a>:</h4>
<p>Don't need all of that as not hooking into js/html, but lets me build a simple example. yay :)<br>
will create our own channel somewhere for this stuff soon. its off topic for here &amp; not wanting to annoy or derail anything else.<br>
but progress. back to the reflect stuff &amp; lets see if I can hook something in.</p>



<a name="195951980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195951980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195951980">(May 01 2020 at 11:23)</a>:</h4>
<p>I just learnt wasm address space is 32 bit. not a problem for now. cool. getting there :)</p>



<a name="195966942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195966942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195966942">(May 01 2020 at 14:36)</a>:</h4>
<p>ahhh ... that's better. small test, small output where I can see what's going on :) </p>
<p><a href="https://pastebin.com/3fBP5mji" title="https://pastebin.com/3fBP5mji">https://pastebin.com/3fBP5mji</a></p>
<p>love how the format has a list of function signatures &amp; each entry only references that sig id.</p>
<p>nice :)</p>
<p>going super slow as exhausted.</p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/3fBP5mji" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/3fBP5mji" title="  #[no_mangle]  extern {      fn create_native(type_id: u32) -&gt; u32;  }        # - Pastebin.com">  #[no_mangle]  extern {      fn create_native(type_id: u32) -&gt; u32;  }        # - Pastebin.com</a></div></div></div>



<a name="195972388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195972388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195972388">(May 01 2020 at 15:29)</a>:</h4>
<p>Now do clang without stdlibs :) <code>clang --target=wasm32 -nostdlib -Wl,--no-entry,--export=foobar ..</code></p>



<a name="195976775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195976775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195976775">(May 01 2020 at 16:09)</a>:</h4>
<p>Going to take it all the way Rust unless I find a good reason not to. Can come back to C++ later. Needed a reason to learn it, think I've got one :)<br>
Shame we can't do c# without all the junk yet, maybe that'll come at some point. Managed heap has its place in high level stuff &amp; the syntax is pretty sweet.</p>



<a name="195977125"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195977125" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195977125">(May 01 2020 at 16:13)</a>:</h4>
<p>I know mono can target wasm getting c# thru, but it brings with it a ton of .net baggage we don't need. I like things minimalist.</p>



<a name="195982770"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195982770" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195982770">(May 01 2020 at 17:02)</a>:</h4>
<p>not understanding why the wat for that rust test is tiny (expected) but the wasm is huge.</p>
<p>utils.wat - 525 bytes<br>
utils.wasm - 1773461 bytes </p>
<p>that's an issue we can no doubt resolve but not a production stop issue.</p>
<p>the following is however a production stop issue.</p>
<p>utils .wasm crashes wasm_instance_new in the refect example.</p>
<p>my hunch is coz there's an unresolved extern (deliberate). that's the entire point of loading this way is to scan for it so we can patch it up.</p>
<p>I need to be able to do a reflection scan or whatever the terminology is  with a gap as the point is to find the gaps so we can fill them :)</p>
<p>anything unresolved after our expected gaps are found &amp; patched is an error, but that'd be up to us to fail on or otherwise.</p>



<a name="195983332"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195983332" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195983332">(May 01 2020 at 17:06)</a>:</h4>
<p>to reproduce, the rust source is in the pastebin immediately above, compile standard rust as per the tutorial I'm working from above. <br>
load into reflect.c with s/export/import.</p>



<a name="195983405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195983405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195983405">(May 01 2020 at 17:07)</a>:</h4>
<p>fopen "rb" so the load doesn't mess up :)</p>



<a name="195983620"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195983620" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195983620">(May 01 2020 at 17:09)</a>:</h4>
<p>modified reflect.c here to save everyone a job : <a href="https://pastebin.com/1KQQqTCv" title="https://pastebin.com/1KQQqTCv">https://pastebin.com/1KQQqTCv</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/1KQQqTCv" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/1KQQqTCv" title="#include &lt;stdio.h&gt;  #include &lt;stdlib.h&gt;  #include &lt;string.h&gt;  #include &lt;inttypes - Pastebin.com">#include &lt;stdio.h&gt;  #include &lt;stdlib.h&gt;  #include &lt;string.h&gt;  #include &lt;inttypes - Pastebin.com</a></div></div></div>



<a name="195983826"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195983826" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195983826">(May 01 2020 at 17:10)</a>:</h4>
<p>if you guys need anything else to repro or I'm doing something idiotic, please let me know :) could be import loads need to be done a different way. I literally did a search &amp; replace. might be more to it.</p>



<a name="195984345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195984345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195984345">(May 01 2020 at 17:14)</a>:</h4>
<p>I'm running wasmtime-v0.15.0-x86_64-windows-c-api - happy to switch to upgrade if that's required to patch this up. also happy to fix it myself if it's trivial.</p>



<a name="195986761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195986761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195986761">(May 01 2020 at 17:33)</a>:</h4>
<p>as an alternative, if its possible to replace exported functions, could do it that way instead.</p>



<a name="195988655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195988655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195988655">(May 01 2020 at 17:49)</a>:</h4>
<p>losing it. you can load with imports that can be patched. that's what hello.c does. so it must be something specific regarding that example triggering a fault.</p>



<a name="195988853"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195988853" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195988853">(May 01 2020 at 17:51)</a>:</h4>
<p><a href="http://advance-software.com/misc/test.wasm" title="http://advance-software.com/misc/test.wasm">advance-software.com/misc/test.wasm</a></p>



<a name="195989936"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195989936" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195989936">(May 01 2020 at 18:00)</a>:</h4>
<p>nope, not losing it, if a little tired. in hello.c, the missing function (the import) is passed into wasm_instance_new so everything can resolve &amp; the file loads.</p>
<p>in the import reflection example we're throwing together here, the resolving function isn't available as we're scanning for imports prior to resolving them..</p>
<p>so its not file specific. its api misuse, an api gap or an implementation error.</p>



<a name="195996651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/195996651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#195996651">(May 01 2020 at 19:01)</a>:</h4>
<p>happy to log over here if required, or if the info in this chat is sufficient, I can swtich to something else whilst waiting for this to resolve.</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/issues" title="https://github.com/bytecodealliance/wasmtime/issues">https://github.com/bytecodealliance/wasmtime/issues</a></p>
<p>anything else I need to do at this time, please let me know.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/issues" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/issues" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="196038348"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196038348" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196038348">(May 02 2020 at 07:22)</a>:</h4>
<p>if this is tricky, maybe can figure out some way of routing everything via a single imported entrypoint for now.</p>



<a name="196038643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196038643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196038643">(May 02 2020 at 07:33)</a>:</h4>
<p>summary for those not wanting to read a wall of text : wasm-c-api reflection example is exports. flipped it to imports as per suggestion here.</p>
<p>problem: can't reflect bcoz wasm_instance_new crashes with unresolved imports, thereby making import reflection impossible at this point. unless of course I'm doing it wrong. in any case, function shouldn't crash with essentially valid input. realise this is work in progress at the edge :)</p>
<p>.... but you've got a real user here. if wasmtime is up to it &amp; license is acceptable (something bsd-ish will do), we'll go for it.</p>



<a name="196038749"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196038749" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196038749">(May 02 2020 at 07:36)</a>:</h4>
<p>turn around in a real app is about a week once I've got a way through.  single entry point as I've suggested might be a way through. I'll experiment.<br>
at the very least, I need that function not crashing as passing a function with unresolved imports we're not expecting will be outside my control. I can dive in &amp; try &amp; patch that if I have to, but that'll have to wait until I have api use side up to minimum first.</p>
<p>given there are other implementations of the api, perhaps we have to run with one of those to start with. currently have no idea what they do with the use case explained above.</p>



<a name="196038957"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196038957" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196038957">(May 02 2020 at 07:42)</a>:</h4>
<p>wasmtime website missing legal. we might open source our 3d web tech at some point, but that decision hasn't been made yet so I need to work with complementary technologies that allow us to open source as &amp; where we see fit at a time of our choosing. our direct interfacing to wasmtime will be an infinity "action" plugin - we've got those for .net, mono, java, javascript and native right now. no objection to that being open source.</p>



<a name="196039303"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196039303" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196039303">(May 02 2020 at 07:53)</a>:</h4>
<ul>
<li>as passing a wasm with unresolved exports we're not expecting will be outside my control. untrusted script devs throw what they want at it. sometimes deliberately wrong (malicious attacks).</li>
</ul>



<a name="196040419"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196040419" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196040419">(May 02 2020 at 08:23)</a>:</h4>
<blockquote>
<p>.... but you've got a real user here. if wasmtime is up to it &amp; license is acceptable (something bsd-ish will do), we'll go for it.</p>
</blockquote>
<p>Is <code>Apache-2.0 WITH LLVM-exception</code> acceptable?</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/Cargo.toml#L6" title="https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/Cargo.toml#L6">https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/Cargo.toml#L6</a></p>
<blockquote>
<p>wasmtime website missing legal.</p>
</blockquote>
<p>What exactly are you missing? You may find it at <a href="https://bytecodealliance.org/" title="https://bytecodealliance.org/">https://bytecodealliance.org/</a>. This is the website of the alliance which wasmtime is part of.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/Cargo.toml#L6" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/c284ffe6c036b8058228d576c46688968629b48c/Cargo.toml#L6" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://bytecodealliance.org/" style="background-image: url(https://bytecodealliance.org/images/avatar.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://bytecodealliance.org/" title="Bytecode Alliance">Bytecode Alliance</a></div><div class="message_embed_description">Welcome to the Bytecode Alliance</div></div></div>



<a name="196040746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196040746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196040746">(May 02 2020 at 08:32)</a>:</h4>
<blockquote>
<p>Is Apache-2.0 WITH LLVM-exception acceptable?</p>
</blockquote>
<p>Dunno yet, thanks for the link. Will review. At this point I've stated our intent &amp; configuration &amp; nobody's complained, so suspect we're good.</p>
<p>Thanks again, bjorn3</p>



<a name="196040883"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196040883" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196040883">(May 02 2020 at 08:37)</a>:</h4>
<p>hate legal, but got to have all bases covered. </p>
<p>appears to be this thing : <a href="https://www.apache.org/licenses/LICENSE-2.0" title="https://www.apache.org/licenses/LICENSE-2.0">https://www.apache.org/licenses/LICENSE-2.0</a></p>



<a name="196041009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196041009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196041009">(May 02 2020 at 08:40)</a>:</h4>
<p>My reading of this is that legal is sound. </p>
<ol start="2">
<li>Grant of Copyright License. Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such Derivative Works in Source or Object form.</li>
</ol>
<p>Though I haven't seen the llvm excemption legal yet as I don't know where that is.</p>



<a name="196041021"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196041021" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196041021">(May 02 2020 at 08:41)</a>:</h4>
<p>suspect we're good. the intent there is to be permissive which is what I'm looking for, so pretty much bsd.</p>



<a name="196041130"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196041130" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196041130">(May 02 2020 at 08:44)</a>:</h4>
<p>ahhh, here :)</p>
<p><a href="https://llvm.org/LICENSE.txt" title="https://llvm.org/LICENSE.txt">https://llvm.org/LICENSE.txt</a></p>



<a name="196041304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196041304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196041304">(May 02 2020 at 08:49)</a>:</h4>
<p>prefer BSD as these things get complicated for no good reason, that being why I prefer BSD -  its simple, but lets stay technical here unless there's a good reason to dive into legal. I don't have one. that'll do. thanks, all. wanting to contribute back too, have already done so in terms of one bugfix (sample code fopen mode) &amp; trialing this tech first in a real world application. we continue ...</p>



<a name="196044088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196044088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196044088">(May 02 2020 at 09:59)</a>:</h4>
<p>lets keep focus here to get to something production ready.</p>
<p>wasm_instance_new crashes with unresolved imports. can't have it crashing. reject with error code is minimal fix to get inside solution space.</p>



<a name="196044621"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196044621" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196044621">(May 02 2020 at 10:12)</a>:</h4>
<p>The last argument of <code>wasm_instance_new</code> is a pointer to write a pointer to a <code>wasm_trap_t</code> to. Did you pass a null pointer for it? If so, I think you will need to pass it a pointer to a variable to store the pointer in. You can initialize the variable itself to a null pointer though.</p>
<div class="codehilite"><pre><span></span><code><span class="n">wasm_trap_t</span> <span class="o">*</span><span class="n">err</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="n">wasm_instance_new</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle error</span>
<span class="p">}</span>
</code></pre></div>



<a name="196044666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196044666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196044666">(May 02 2020 at 10:14)</a>:</h4>
<p>ahhhh, is that what it is :) </p>
<p>you rock, again :)</p>
<p>/passes a virtual beer.</p>



<a name="196044703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196044703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196044703">(May 02 2020 at 10:14)</a>:</h4>
<p>will give it a shot, cheers.</p>



<a name="196044863"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196044863" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196044863">(May 02 2020 at 10:18)</a>:</h4>
<p>nope, doesn't fix it. nice try :) still crashes. if it was that, function should fail passing a null back.</p>



<a name="196044880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196044880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196044880">(May 02 2020 at 10:19)</a>:</h4>
<p>Do you have a backtrace?</p>



<a name="196045120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196045120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196045120">(May 02 2020 at 10:24)</a>:</h4>
<p>how is this even working anyway. going to show my ignorance here.</p>
<p>from hello.c</p>
<p>const wasm_extern_t* imports[] = { wasm_func_as_extern(test_func) };<br>
 own wasm_instance_t* instance = wasm_instance_new( store, module, imports, &amp;err);</p>
<p>so ... imports is wasm_extern_t**   - how do you know how long the array is ?</p>
<p>I'd have minimum null terminated, so this :</p>
<p>const wasm_extern_t* imports[] = { wasm_func_as_extern(test_func), nullptr };</p>
<p>is there some trick to get the array length I don't know about ?</p>



<a name="196045202"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196045202" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196045202">(May 02 2020 at 10:26)</a>:</h4>
<p>Looks like <code>wasm_instance_new</code> uses the amount of imports of the wasm module as length of that array: <a href="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/src/instance.rs#L52" title="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/src/instance.rs#L52">https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/src/instance.rs#L52</a></p>
<p>If you directly use <code>wasmtime_instance_new</code>, you can explicitly pass an array length.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/src/instance.rs#L52" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/src/instance.rs#L52" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="196045276"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196045276" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196045276">(May 02 2020 at 10:28)</a>:</h4>
<p>I think this should be either documented or preferably changed for <code>wasm-c-api</code>, as it is quite dangerous. cc <span class="user-mention" data-user-id="254083">@Dan Gohman</span>?</p>



<a name="196045824"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196045824" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196045824">(May 02 2020 at 10:42)</a>:</h4>
<p>wasmtime_instance_new seems to be the way to go, thanks.</p>
<p>was going to dive in &amp; fix this myself, but of course wasmtime is written in rust. I am rust noobie, I can barely throw together a 2 line test so think I should leave internals to the pros for now.</p>



<a name="196045831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196045831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196045831">(May 02 2020 at 10:42)</a>:</h4>
<p>&amp; that gets me to the wasmtime api - I have  reason to be there now, thanks. will see what other goodies are there.</p>



<a name="196045985"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196045985" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196045985">(May 02 2020 at 10:46)</a>:</h4>
<p>that I think is the crash.  an implicit length from untrusted variable input is used where the code should specify explicitly what its providing as wasmtime_instance_new indeed does. so that's my next job - see if that gets us past the hurdle. cheers :)</p>



<a name="196046662"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196046662" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196046662">(May 02 2020 at 11:06)</a>:</h4>
<p>I think minimum we need to be able to scan input wasm for how many of each time of unresolved it has &amp; then decide whether to proceed. if malicious, corrupt or unintended wasm passes me something with 1000s of unresolved, I think I want to reject it right there.</p>



<a name="196054313"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196054313" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196054313">(May 02 2020 at 14:30)</a>:</h4>
<p>wasmtime_instance_new isn't in the header. maybe I can patch it as it looks exported in the code. also perhaps time to move from distribution to build this myself if we're in active development bouncing off each other now.</p>



<a name="196054334"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196054334" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196054334">(May 02 2020 at 14:31)</a>:</h4>
<p>a distribution update with that in it would be smashing if its easy enough to do. I'd rather not dive into other people's projects if at all possible as hands full where I am.</p>



<a name="196054737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196054737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196054737">(May 02 2020 at 14:42)</a>:</h4>
<p>think I step back until I have a wasmtime.h with wasmtime_instance_new defined in it. if thoughts are just come grab trunk and build it, maybe I should. but I'd prefer a package update containing this as its essential &amp; not all about me.</p>



<a name="196054756"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196054756" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196054756">(May 02 2020 at 14:43)</a>:</h4>
<p>ahhh ... it is in truck header :)</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/include/wasmtime.h" title="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/include/wasmtime.h">https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/include/wasmtime.h</a></p>
<p>so being impatient, I suppose I have a go at building this bad boy :)</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/include/wasmtime.h" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/9364eb1d98d4b82d30ce72ec1e46ee72a1ea6a0c/crates/c-api/include/wasmtime.h" title="bytecodealliance/wasmtime">bytecodealliance/wasmtime</a></div><div class="message_embed_description">Standalone JIT-style runtime for WebAssembly, using Cranelift - bytecodealliance/wasmtime</div></div></div>



<a name="196054830"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196054830" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196054830">(May 02 2020 at 14:45)</a>:</h4>
<p>time for a distribution update as that entrypoint is required to use wasmtime.</p>



<a name="196055097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055097">(May 02 2020 at 14:52)</a>:</h4>
<p>if current wasm-c-api specifies a nullptr terminated list for imports, you're good as its then fully specified. that it doesn't is the issue. so that's a documentation fix &amp; implementation &amp; sample code fix to resolve. api can stay as it is.</p>



<a name="196055159"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055159" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055159">(May 02 2020 at 14:54)</a>:</h4>
<p>wall of text above not helps, can you explain how many modules you are trying to instantiate and how you fill the imports array?</p>



<a name="196055187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055187">(May 02 2020 at 14:55)</a>:</h4>
<p>1 test module for now but long term this is how webdevs pass us functionality so we could receive anything.</p>



<a name="196055193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055193">(May 02 2020 at 14:56)</a>:</h4>
<p>wasm-c-api does not do linking, so building the imports (linking) falls on embedder shoulder</p>



<a name="196055231"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055231" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055231">(May 02 2020 at 14:56)</a>:</h4>
<p>how many imports is in said module and what their types?</p>



<a name="196055237"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055237" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055237">(May 02 2020 at 14:56)</a>:</h4>
<p>I understand I have to provide the imports. for now, I'll go with one function uint32_t mything(uint32 class_id)</p>



<a name="196055265"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055265" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055265">(May 02 2020 at 14:57)</a>:</h4>
<p>alright, basic hello_world example covers this use case</p>



<a name="196055267"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055267" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055267">(May 02 2020 at 14:58)</a>:</h4>
<p>so I'm expecting that to be unresolved as we bind it, but this is where webdevs pass us code to run. they might have other stuff unresolved.<br>
so I need to know whats unresolved to understand if its just our stuff I'm about to patch or other stuff too (a reject)</p>



<a name="196055315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055315">(May 02 2020 at 14:58)</a>:</h4>
<p>no, hello.c doesn't cover this use case. because webdevs might pass me something with the unresolved I'm expecting &amp; perhaps a bunch of others too.</p>



<a name="196055320"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055320" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055320">(May 02 2020 at 14:59)</a>:</h4>
<p>such files should be rejects, but I have no idea what they'll pass as they're untrusted.</p>



<a name="196055325"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055325" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055325">(May 02 2020 at 14:59)</a>:</h4>
<p>correct, your code suppose to use wasm_module_imports to build imports for wasm_instance_new</p>



<a name="196055333"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055333" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055333">(May 02 2020 at 14:59)</a>:</h4>
<p>the same order</p>



<a name="196055385"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055385" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055385">(May 02 2020 at 15:00)</a>:</h4>
<p>basically you are doing linking</p>



<a name="196055402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055402">(May 02 2020 at 15:00)</a>:</h4>
<p>hang on ... light bulb moment :)</p>



<a name="196055426"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055426" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055426">(May 02 2020 at 15:01)</a>:</h4>
<p>sample code has wasm_module_imports <em>after</em> wasmtime_instance_new but there's no reason for it to be that way around.</p>



<a name="196055433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055433">(May 02 2020 at 15:01)</a>:</h4>
<p>which sample code?</p>



<a name="196055487"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055487" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055487">(May 02 2020 at 15:02)</a>:</h4>
<p>there is no sample code for wasm_module_imports, so you have to improvise and guess that the imports array is populated based on module metadata</p>



<a name="196055579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055579">(May 02 2020 at 15:04)</a>:</h4>
<p>I'm hybrid munged reflect.c and hello.c at this point.</p>



<a name="196055608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055608">(May 02 2020 at 15:05)</a>:</h4>
<p>so yeah, I can perform a wasm_module_imports prior to instantiating anything. and that's part of a sanity check.</p>



<a name="196055662"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055662" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055662">(May 02 2020 at 15:06)</a>:</h4>
<p>or maybe it is my santity check. with the minimal example we're running here, I expect 1 import. anything else is fail at that point.</p>



<a name="196055663"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055663" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055663">(May 02 2020 at 15:06)</a>:</h4>
<p>in wasmtime, we tried to map c-api to rust, maybe documentation in the rust API will help more, see e.g. <a href="https://docs.rs/wasmtime/0.16.0/wasmtime/struct.Instance.html#providing-imports" title="https://docs.rs/wasmtime/0.16.0/wasmtime/struct.Instance.html#providing-imports">https://docs.rs/wasmtime/0.16.0/wasmtime/struct.Instance.html#providing-imports</a></p>



<a name="196055746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055746">(May 02 2020 at 15:08)</a>:</h4>
<p>thanks. /0.16.0/ would help - I'm on 0.15.0 &amp; 0.16.0 has wasmtime_instance_new which I still might need :)</p>



<a name="196055765"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055765" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055765">(May 02 2020 at 15:09)</a>:</h4>
<p>Instance::new was there from old versions</p>



<a name="196055816"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055816" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055816">(May 02 2020 at 15:10)</a>:</h4>
<p>wasmtime_instance_new is not directly related to Instance::new, wasm_instance_new is</p>



<a name="196055852"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055852" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055852">(May 02 2020 at 15:11)</a>:</h4>
<p>actually now they are</p>



<a name="196055927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055927">(May 02 2020 at 15:12)</a>:</h4>
<p>this might work. I've still got a crash, but after what I think I need. let me figure out what's going bang now.</p>



<a name="196055940"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196055940" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196055940">(May 02 2020 at 15:13)</a>:</h4>
<p>to answer what sample code - the import reflection example we're working on that I'm happy to pass back.</p>



<a name="196056031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056031">(May 02 2020 at 15:15)</a>:</h4>
<p>maybe worth to sending it to wasm-c-api?</p>



<a name="196056090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056090">(May 02 2020 at 15:16)</a>:</h4>
<p>happy to send it where you want. let me clean it up first. this works, thanks so much :)</p>



<a name="196056092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056092">(May 02 2020 at 15:16)</a>:</h4>
<p>output :</p>
<p>Initializing...<br>
Loading binary...<br>
Compiling module...<br>
Extracting imports...<br>
Instantiating module...</p>
<blockquote>
<p>import 0 "create_native"<br>
func i32 -&gt; i32<br>
Shutting down...</p>
</blockquote>



<a name="196056129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056129">(May 02 2020 at 15:17)</a>:</h4>
<p>do extracting imports before "Instantiate module.." also, the module field needs to be shown</p>



<a name="196056131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056131">(May 02 2020 at 15:18)</a>:</h4>
<p>doh. so simple. now we know what we have we can reject anything that's not as expected before it has the chance to go bang, so its safe.</p>



<a name="196056191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056191">(May 02 2020 at 15:18)</a>:</h4>
<p>let me grab some more caffeine, tidy that up (its minimal) then you can check I'm doing things correctly direct if you'd like. seems good.</p>



<a name="196056208"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056208" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056208">(May 02 2020 at 15:19)</a>:</h4>
<p>right, there is a sensitive topic about what safe and what is not at <a href="https://github.com/WebAssembly/wasm-c-api/issues/132" title="https://github.com/WebAssembly/wasm-c-api/issues/132">https://github.com/WebAssembly/wasm-c-api/issues/132</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasm-c-api/issues/132" style="background-image: url(https://avatars3.githubusercontent.com/u/11578470?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasm-c-api/issues/132" title="Safety in the WebAssembly C API · Issue #132 · WebAssembly/wasm-c-api">Safety in the WebAssembly C API · Issue #132 · WebAssembly/wasm-c-api</a></div><div class="message_embed_description">The official C API for WebAssembly should strive for safety to the extent that it can, since security is critically important to many WebAssembly use cases. C is an inherently unsafe language, and ...</div></div></div>



<a name="196056331"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056331" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056331">(May 02 2020 at 15:22)</a>:</h4>
<p>summary: all good. noob stupid moment :)</p>



<a name="196056814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056814">(May 02 2020 at 15:30)</a>:</h4>
<p>I've got this for imports.c </p>
<p><a href="https://pastebin.com/kmtnVuGy" title="https://pastebin.com/kmtnVuGy">https://pastebin.com/kmtnVuGy</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://pastebin.com/kmtnVuGy" style="background-image: url(https://pastebin.com/i/facebook.png)"></a><div class="data-container"><div class="message_embed_title"><a href="https://pastebin.com/kmtnVuGy" title="  #include &lt;stdio.h&gt;  #include &lt;stdlib.h&gt;  #include &lt;string.h&gt;  #include &lt;inttyp - Pastebin.com">  #include &lt;stdio.h&gt;  #include &lt;stdlib.h&gt;  #include &lt;string.h&gt;  #include &lt;inttyp - Pastebin.com</a></div></div></div>



<a name="196056844"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196056844" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196056844">(May 02 2020 at 15:31)</a>:</h4>
<p>concern - as I'm literally getting my head around this as we go - is the thing that's giving me how many of these things there are the number of unique function signatures or the number of unique functions. I'll put together another test wasm file so I know.</p>



<a name="196057412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196057412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196057412">(May 02 2020 at 15:45)</a>:</h4>
<p>perfect. gets the number of unique functions. output from test doing exactly that as follows.</p>
<p>Initializing...<br>
Loading binary...<br>
Compiling module...<br>
Extracting imports...<br>
import 0 "create_native"                func i32 -&gt; i32<br>
import 1 "release_native"               func i32 -&gt; i32<br>
Shutting down...</p>



<a name="196057479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196057479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196057479">(May 02 2020 at 15:47)</a>:</h4>
<p>so imports.c above with whatever test wasm anyone wants - it should be able to safely load anything ready to roll.</p>
<p>and I've got what I need to continue in a safe &amp; robust way. thanks all. back on track. apologies for offroading into fail :)</p>
<p>that new sample should stop it happening again.</p>



<a name="196057618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196057618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196057618">(May 02 2020 at 15:50)</a>:</h4>
<p>might make sense to delete this thread. its quite verbose &amp; don't want to waste people's time on stuff that isn't needed. <br>
it boils down to see imports.c example code, which I've provided &amp; happy to submit somewhere if desired.</p>



<a name="196169488"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196169488" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196169488">(May 04 2020 at 11:44)</a>:</h4>
<p>thanks for the clang command line, yury. took rust for a spin. I hate it, so implementing our bootstrap in wasm/c++ . <br>
got the basics running.<br>
rust is awful. full of things done differently for no good reason.   yuk.  <br>
if others want to use it, fine, I won't be one of them :)<br>
this isn't a rust group so perhaps shouldn't have even said that &amp; realise you guys like it.<br>
you're insane :)</p>



<a name="196169973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196169973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196169973">(May 04 2020 at 11:51)</a>:</h4>
<p>... and yes, I know wasmtime is written in rust. not trying to cause offence, its just not for me. we've got solid interfacing so we can all use the language of our choice. we don't all have to choose the same one. that being the elegance of the setup. we continue ... all good :)</p>



<a name="196172639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196172639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196172639">(May 04 2020 at 12:21)</a>:</h4>
<p>Just saying you don't want to cause offense doesn't really work if it follows inflammatory language like in this case. Please tone it down.</p>



<a name="196175434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196175434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196175434">(May 04 2020 at 12:49)</a>:</h4>
<p>sure, sorry.  point was to thank yury for pointing me in the right direction.</p>
<p>simple stuff like :</p>
<p>let mut x : int32;</p>
<p>that doesn't make sense. what's wrong with var if you must have a reserved word ?</p>
<p>x : int32; </p>
<p>would be sufficient. its implicit you're declaring.</p>
<p>the language offends me, hence the tone.</p>
<p>c-like has many advantages.</p>
<p>so I tried to macro "let mut" to var &amp; couldn't.</p>
<p>at that point I decided the language doesn't let me do what I want.</p>



<a name="196175618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196175618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196175618">(May 04 2020 at 12:52)</a>:</h4>
<p>but anyhow, as stated, this isn't a rust group. just explaining why I'm pivoting back to my happy place. it has no tangible effect on our or your deliverables.</p>
<p>debug interface upgrade is where the focus should be here. I think, anyway. we can argue about rust syntax other places.</p>



<a name="196175757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/wasmtime%20wasm-c-api%20on%20Windows%20...%20noob/near/196175757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Williams <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/wasmtime.20wasm-c-api.20on.20Windows.20.2E.2E.2E.20noob.html#196175757">(May 04 2020 at 12:53)</a>:</h4>
<p>also, from c++ I can bash wasm &amp; wasmtime runtime hard to see if your security model stands up. so this is all good.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>