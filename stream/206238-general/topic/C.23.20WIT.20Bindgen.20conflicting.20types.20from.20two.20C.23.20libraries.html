<html>
<head><meta charset="utf-8"><title>C# WIT Bindgen conflicting types from two C# libraries · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html">C# WIT Bindgen conflicting types from two C# libraries</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="481221533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481221533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481221533">(Nov 08 2024 at 00:29)</a>:</h4>
<p>I have two C# packages, one called <code>LyraApi</code>, and one called <code>dotnet-guest-test</code>. The first has a WIT world, and uses bindgen to generate code. Then <code>dotnet-guest-test</code> is expected to be the WASM Component and depend on <code>LyraApi</code> to make it easier to use the API exported by the host in the component. </p>
<p>This is the wit of the guest:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="nc">witguest</span><span class="p">;</span>

<span class="sd">/// An example world for the component to target.</span>
<span class="n">world</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">lyra</span><span class="p">:</span><span class="nc">api</span><span class="o">/</span><span class="n">ecs</span><span class="p">.{</span><span class="n">ecs</span><span class="o">-</span><span class="n">world</span><span class="p">,</span><span class="w"> </span><span class="n">entity</span><span class="p">};</span>

<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">init</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">(</span><span class="n">game</span><span class="o">-</span><span class="n">world</span><span class="p">:</span><span class="w"> </span><span class="nc">borrow</span><span class="o">&lt;</span><span class="n">ecs</span><span class="o">-</span><span class="n">world</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">owning</span><span class="o">-</span><span class="n">entity</span><span class="p">:</span><span class="w"> </span><span class="nc">entity</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The package <code>lyra:api/ecs</code> is defined in some other wit files:<br>
<a href="/user_uploads/15107/z8EgrsE4jn-Z9qZKCspHwIKh/image.png">image.png</a><br>
Those wit files are also used by the csharp package <code>LyraApi</code> to generate bindings that it then wraps around to make it easier to interface with the Host. The current problem is that I cant reuse the types that were generated from <code>LyraApi</code> in the component package. They're both created from the same WIT files, but technically different types from different packages.</p>
<div class="message_inline_image"><a href="/user_uploads/15107/z8EgrsE4jn-Z9qZKCspHwIKh/image.png" title="image.png"><img data-original-dimensions="180x179" src="/user_uploads/thumbnail/15107/z8EgrsE4jn-Z9qZKCspHwIKh/image.png/840x560.webp"></a></div><p>The Rust wit-bindgen crate has a <code>with</code> field in the <a href="https://docs.rs/wit-bindgen/latest/wit_bindgen/macro.generate.html">bindgen</a> macro that would allow me to reuse types, not sure if thats something that can be done here. I have this project hosted on <a href="https://git.seanomik.net/SeanOMik/lyra-wasm-scripting-test/src/branch/dotnet-guest-test/guests/csharp">self-hosted ForgeJo instance</a> so you can see the project structure I'm trying to achieve.</p>
<div class="message_embed"><a class="message_embed_image" href="https://git.seanomik.net/SeanOMik/lyra-wasm-scripting-test/src/branch/dotnet-guest-test/guests/csharp" style='background-image: url("https://uploads.zulipusercontent.net/24564fe2b4badf949a816b741760a71e53d13b7b/68747470733a2f2f6769742e7365616e6f6d696b2e6e65742f617661746172732f37396530333566633466373938663935333233343830343930653163663065613864626634343830643863343532376231313764336465353637633463356262")'></a><div class="data-container"><div class="message_embed_title"><a href="https://git.seanomik.net/SeanOMik/lyra-wasm-scripting-test/src/branch/dotnet-guest-test/guests/csharp" title="lyra-wasm-scripting-test">lyra-wasm-scripting-test</a></div><div class="message_embed_description">A test zone for implementing WASM scripting into the Lyra engine</div></div></div>



<a name="481222273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481222273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481222273">(Nov 08 2024 at 00:37)</a>:</h4>
<p>That's certainly the kind of situation the <code>with</code> option of the Rust <code>bindgen</code> macro was intended to address, and it seems reasonable to add an equivalent option to the C# binding generator.</p>
<p>Short of implementing that, I don't know of any workarounds besides possibly editing and/or deleting some of the generated code on the <code>dotnet-guest-test</code> side to force the <code>LyraApi</code>-provided version of that code to be used instead.</p>



<a name="481223726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481223726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481223726">(Nov 08 2024 at 00:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="509936">Joel Dice</span> <a href="#narrow/channel/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries/near/481222273">said</a>:</p>
<blockquote>
<p>That's certainly the kind of situation the <code>with</code> option of the Rust <code>bindgen</code> macro was intended to address, and it seems reasonable to add an equivalent option to the C# binding generator.</p>
<p>Short of implementing that, I don't know of any workarounds besides possibly editing and/or deleting some of the generated code on the <code>dotnet-guest-test</code> side to force the <code>LyraApi</code>-provided version of that code to be used instead.</p>
</blockquote>
<p>Hmm.... Maybe I could try making a Target in the .csproj that would change the generated code to use the <code>LyraApi</code> generated versions. Should I make an issue on github for this?</p>



<a name="481239058"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481239058" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481239058">(Nov 08 2024 at 04:07)</a>:</h4>
<p>Well I used msbuild to modify the generated files after they were generated. I modified them manually but they were discarded when I rebuilt. The changes were made, and they appear to look correct, and the component will build and output a <code>.wasm</code> file.</p>
<p>However, when I try to run it under a wasmtime Rust host, the component runs into an error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Unhandled</span><span class="w"> </span><span class="n">exception</span><span class="p">.</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileNotFoundException</span><span class="p">:</span><span class="w"> </span><span class="nc">Could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">'</span><span class="na">LyraApi</span><span class="o">'</span><span class="p">.</span>
<span class="n">File</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="o">'</span><span class="na">LyraApi</span><span class="o">'</span>
<span class="w">   </span><span class="nc">at</span><span class="w"> </span><span class="n">Internal</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">TypeLoaderExceptionHelper</span><span class="p">.</span><span class="n">CreateFileNotFoundException</span><span class="p">(</span><span class="n">ExceptionStringID</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span><span class="p">)</span>
<span class="w">   </span><span class="n">at</span><span class="w"> </span><span class="n">ExampleWorld</span><span class="p">.</span><span class="n">exports</span><span class="p">.</span><span class="n">ExampleWorld</span><span class="p">.</span><span class="n">wasmExportOnInit</span><span class="p">(</span><span class="n">Int32</span><span class="p">,</span><span class="w"> </span><span class="n">Int64</span><span class="p">,</span><span class="w"> </span><span class="n">Int64</span><span class="p">)</span>
<span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">init</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span><span class="p">:</span>
<span class="w">    </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="nc">error</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="w"> </span><span class="n">backtrace</span><span class="p">:</span>
<span class="w">           </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="mh">0x5abae3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">abort</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="n">wasisdk</span><span class="p">:</span><span class="c1">//v24.0/build/sysroot/wasi-libc-wasm32-wasip2/libc-bottom-half/sources/abort.c:5:5</span>
<span class="w">           </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="mh">0x3b84d</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">.</span><span class="n">tmpmJFMmq</span><span class="o">!</span><span class="n">SystemNative_Abort</span>
<span class="w">           </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="mh">0xf841e</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">.</span><span class="n">tmpmJFMmq</span><span class="o">!</span><span class="n">S_P_CoreLib_Interop_Sys__Abort</span>
<span class="w">           </span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="mh">0x45e86d</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_System_RuntimeExceptionHelpers__FailFast</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">System</span><span class="p">.</span><span class="n">Private</span><span class="p">.</span><span class="n">CoreLib</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">RuntimeExceptionHelpers</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">320</span><span class="p">:</span><span class="mi">0</span>
<span class="w">           </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="mh">0xf7691</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_System_RuntimeExceptionHelpers__RuntimeFailFast</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">System</span><span class="p">.</span><span class="n">Private</span><span class="p">.</span><span class="n">CoreLib</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">RuntimeExceptionHelpers</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">161</span><span class="p">:</span><span class="mi">0</span>
<span class="w">           </span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="mh">0x45c3bf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_System_Runtime_EH__HandleUnhandledException</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Base</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Runtime</span><span class="o">/</span><span class="n">ExceptionHandling</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">355</span><span class="p">:</span><span class="mi">0</span>
<span class="w">           </span><span class="mi">6</span><span class="p">:</span><span class="w"> </span><span class="mh">0x214738</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">.</span><span class="n">tmpmJFMmq</span><span class="o">!</span><span class="n">dotnet_guest_test_ExampleWorld_exports_ExampleWorld__wasmExportOnInit</span><span class="cp">$F0_Filter</span>
<span class="w">           </span><span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="mh">0x3b1077</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_System_Runtime_EH__CallFilterFunclet</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Base</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Runtime</span><span class="o">/</span><span class="n">ExceptionHandling</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">163</span><span class="p">:</span><span class="mi">0</span>
<span class="w">           </span><span class="mi">8</span><span class="p">:</span><span class="w"> </span><span class="mh">0x4f9776</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_System_Runtime_EH__DispatchException</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Base</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Runtime</span><span class="o">/</span><span class="n">ExceptionHandling</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">92</span><span class="p">:</span><span class="mi">0</span>
<span class="w">           </span><span class="mi">9</span><span class="p">:</span><span class="w"> </span><span class="mh">0x45d19b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_System_Runtime_EH__RhpThrowEx</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">Runtime</span><span class="p">.</span><span class="n">Base</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Runtime</span><span class="o">/</span><span class="n">ExceptionHandling</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">0</span>
<span class="w">          </span><span class="mi">10</span><span class="p">:</span><span class="w"> </span><span class="mh">0x27de0c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_Internal_Runtime_TypeLoaderExceptionHelper__CreateFileNotFoundException</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">System</span><span class="p">.</span><span class="n">Private</span><span class="p">.</span><span class="n">CoreLib</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">Internal</span><span class="o">/</span><span class="n">Runtime</span><span class="o">/</span><span class="n">TypeLoaderExceptionHelper</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">0</span>
<span class="w">          </span><span class="mi">11</span><span class="p">:</span><span class="w"> </span><span class="mh">0x36a8b8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_P_CoreLib_Internal_Runtime_CompilerHelpers_ThrowHelpers__ThrowFileNotFoundException</span>
<span class="w">                           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">_</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">coreclr</span><span class="o">/</span><span class="n">nativeaot</span><span class="o">/</span><span class="n">System</span><span class="p">.</span><span class="n">Private</span><span class="p">.</span><span class="n">CoreLib</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">Internal</span><span class="o">/</span><span class="n">Runtime</span><span class="o">/</span><span class="n">CompilerHelpers</span><span class="o">/</span><span class="n">ThrowHelpers</span><span class="p">.</span><span class="n">cs</span><span class="p">:</span><span class="mi">88</span><span class="p">:</span><span class="mi">0</span>
<span class="w">          </span><span class="mi">12</span><span class="p">:</span><span class="w"> </span><span class="mh">0x214691</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">.</span><span class="n">tmpmJFMmq</span><span class="o">!</span><span class="n">dotnet_guest_test_ExampleWorld_exports_ExampleWorld__wasmExportOnInit</span>
<span class="w">    </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="nc">wasm</span><span class="w"> </span><span class="n">trap</span><span class="p">:</span><span class="w"> </span><span class="nc">wasm</span><span class="w"> </span><span class="err">`</span><span class="n">unreachable</span><span class="err">`</span><span class="w"> </span><span class="n">instruction</span><span class="w"> </span><span class="n">executed</span>
</code></pre></div>
<p>(the output had <code>WASMTIME_BACKTRACE_DETAILS=1</code> set)<br>
I'm guessing this is something with the WASM component expecting to import LyraApi at runtime, not sure how to fix it though.</p>



<a name="481336449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481336449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481336449">(Nov 08 2024 at 15:25)</a>:</h4>
<p>Yeah, the .NET AOT compiler will silently generate stub code which unconditionally throws a <code>FileNotFoundException</code> if it can't fine the actual code at build time.  Are you explicitly declaring a dependency on <code>LyraApi</code> in your .csproj file, e.g. as a <code>PackageReference</code>.  If so, it should be pulled in automatically as part of the build.</p>



<a name="481350342"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481350342" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Sturtevant <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481350342">(Nov 08 2024 at 16:43)</a>:</h4>
<p>the mis-matched types is a known issue, for some of the base types we would like to move them out of the generator: <a href="https://github.com/bytecodealliance/wit-bindgen/issues/1073">https://github.com/bytecodealliance/wit-bindgen/issues/1073</a>.  As for types generated by your wit, would generating the types in a seperate package and then refrencing them from LyraAPI and dotnet-guest-test help as a work around?   partial classes <a href="https://github.com/bytecodealliance/wit-bindgen/issues/1041">https://github.com/bytecodealliance/wit-bindgen/issues/1041</a> might help too?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/issues/1073" style="background-image: url(&quot;https://uploads.zulipusercontent.net/93f199d04f6c359b002e82bd2dafb179d5036241/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f303437633330663734366631376630623062396362373531386338393530643965396338393839623030306230633561326166303339313231383635623666322f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f31303733&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/issues/1073" title="c#: Put shared types in a C# lib - https://github.com/bytecodealliance/cm-dotnet · Issue #1073 · bytecodealliance/wit-bindgen">c#: Put shared types in a C# lib - https://github.com/bytecodealliance/cm-dotnet · Issue #1073 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">A language binding generator for WebAssembly interface types - c#: Put shared types in a C# lib - https://github.com/bytecodealliance/cm-dotnet · Issue #1073 · bytecodealliance/wit-bindgen</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/issues/1041" style="background-image: url(&quot;https://uploads.zulipusercontent.net/680612d3b6fe854808a92472c8920a2bab8abf35/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f303437633330663734366631376630623062396362373531386338393530643965396338393839623030306230633561326166303339313231383635623666322f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f31303431&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/issues/1041" title="C#: consider generating partial classes · Issue #1041 · bytecodealliance/wit-bindgen">C#: consider generating partial classes · Issue #1041 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">So that the project could extend the types in other files, which are not re-generated. See https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/partial-classes-and-...</div></div></div>



<a name="481350466"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481350466" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Sturtevant <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481350466">(Nov 08 2024 at 16:44)</a>:</h4>
<p>creating an issue would be helpful, especially with some example wit that would demonstrate the issue</p>



<a name="481384020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481384020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481384020">(Nov 08 2024 at 20:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="509936">Joel Dice</span> <a href="#narrow/channel/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries/near/481336449">said</a>:</p>
<blockquote>
<p>Yeah, the .NET AOT compiler will silently generate stub code which unconditionally throws a <code>FileNotFoundException</code> if it can't fine the actual code at build time.  Are you explicitly declaring a dependency on <code>LyraApi</code> in your .csproj file, e.g. as a <code>PackageReference</code>.  If so, it should be pulled in automatically as part of the build.</p>
</blockquote>
<p>I'm using ProjectReference, not PackageReference:</p>
<div class="codehilite" data-code-language="XML"><pre><span></span><code><span class="nt">&lt;ItemGroup&gt;</span>
<span class="w">  </span><span class="nt">&lt;ProjectReference</span><span class="w"> </span><span class="na">Include=</span><span class="s">"..\LyraApi\LyraApi.csproj"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ItemGroup&gt;</span>
</code></pre></div>
<p>Would <code>ProjectReference</code> not work the same as PackageReference? New to C# so I assumed the only difference was that one was so I could reference a local project.</p>



<a name="481384327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481384327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481384327">(Nov 08 2024 at 20:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="625613">James Sturtevant</span> <a href="#narrow/channel/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries/near/481350342">said</a>:</p>
<blockquote>
<p>the mis-matched types is a known issue, for some of the base types we would like to move them out of the generator: <a href="https://github.com/bytecodealliance/wit-bindgen/issues/1073">https://github.com/bytecodealliance/wit-bindgen/issues/1073</a>.  As for types generated by your wit, would generating the types in a seperate package and then refrencing them from LyraAPI and dotnet-guest-test help as a work around?</p>
</blockquote>
<p>That would work. I'm not sure how I would be able to do that though since I can't make wit-bindgen use generated bindings from another project.</p>
<blockquote>
<p>partial classes <a href="https://github.com/bytecodealliance/wit-bindgen/issues/1041">https://github.com/bytecodealliance/wit-bindgen/issues/1041</a> might help too?</p>
</blockquote>
<p>I dont think so. I want LyraApi to be a scripting api and wrap around the low level types. It would make it so the user of LyraApi doesn't have to deal with byte serialization and other low level things as much that is required to communicate with the host.</p>



<a name="481389797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481389797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481389797">(Nov 08 2024 at 21:34)</a>:</h4>
<blockquote>
<p>Would <code>ProjectReference</code> not work the same as PackageReference? New to C# so I assumed the only difference was that one was so I could reference a local project.</p>
</blockquote>
<p>I'm also new to C#, and my understanding is the same as yours, so I'm not sure what's wrong.  You might want to consider posting to <a href="https://discord.com/channels/143867839282020352/1141126727028985877">the NativeAOT-LLVM Discord thread</a> with a link to the repo and steps to reproduce.  The experts hang out there and are super helpful in my experience.</p>
<div class="message_embed"><a class="message_embed_image" href="https://discord.com/channels/143867839282020352/1141126727028985877" style="background-image: url(&quot;https://uploads.zulipusercontent.net/29a8c83fbc739f313cf0caf7112e41651b8deb75/68747470733a2f2f63646e2e646973636f72646170702e636f6d2f6173736574732f6f675f696d675f646973636f72645f686f6d652e706e67&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://discord.com/channels/143867839282020352/1141126727028985877" title="Discord - Group Chat That’s All Fun &amp; Games">Discord - Group Chat That’s All Fun &amp; Games</a></div><div class="message_embed_description">Discord is great for playing games and chilling with friends, or even building a worldwide community. Customize your own space to talk, play, and hang out.</div></div></div>



<a name="481820142"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481820142" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481820142">(Nov 11 2024 at 22:26)</a>:</h4>
<p><span class="user-mention" data-user-id="471788">@Pavel Šavara</span> is here at wasmcon, I'll see about grabbing his attention....</p>



<a name="481820821"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/C%23%20WIT%20Bindgen%20conflicting%20types%20from%20two%20C%23%20libraries/near/481820821" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/C.23.20WIT.20Bindgen.20conflicting.20types.20from.20two.20C.23.20libraries.html#481820821">(Nov 11 2024 at 22:31)</a>:</h4>
<p>I forgot to say here. The people in Discord were pretty helpful. "SingleAccretion" discovered that the way the build process of componentize-dotnet is made is broken, which causes the dependencies of my library to not be baked into the final WASM binary. Here's the messages of him explaining the issue more: <a href="https://discord.com/channels/143867839282020352/1141126727028985877/1304883306063724624">https://discord.com/channels/143867839282020352/1141126727028985877/1304883306063724624</a><br>
I can send a screenshot of the messages as well for people who don't have discord.</p>
<div class="message_embed"><a class="message_embed_image" href="https://discord.com/channels/143867839282020352/1141126727028985877/1304883306063724624" style="background-image: url(&quot;https://uploads.zulipusercontent.net/29a8c83fbc739f313cf0caf7112e41651b8deb75/68747470733a2f2f63646e2e646973636f72646170702e636f6d2f6173736574732f6f675f696d675f646973636f72645f686f6d652e706e67&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://discord.com/channels/143867839282020352/1141126727028985877/1304883306063724624" title="Discord - Group Chat That’s All Fun &amp; Games">Discord - Group Chat That’s All Fun &amp; Games</a></div><div class="message_embed_description">Discord is great for playing games and chilling with friends, or even building a worldwide community. Customize your own space to talk, play, and hang out.</div></div></div>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>