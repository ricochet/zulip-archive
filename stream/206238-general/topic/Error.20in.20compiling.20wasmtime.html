<html>
<head><meta charset="utf-8"><title>Error in compiling wasmtime · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html">Error in compiling wasmtime</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="230178157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230178157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Chege <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230178157">(Mar 13 2021 at 17:49)</a>:</h4>
<p>I am experiencing an error when running <code>cargo build --target wasm32-wasi</code> when using the latest version of wasmtime library 0.24.0</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">errno</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">2.7</span><span class="w"></span>
<span class="n">error</span><span class="p">[</span><span class="n">E0554</span><span class="p">]</span>: <span class="err">`</span><span class="cp">#![feature]</span><span class="err">`</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stable</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="n">channel</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">x43</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="mi">1</span><span class="n">ecc6299db9ec823</span><span class="o">/</span><span class="n">errno</span><span class="o">-</span><span class="mf">0.2.7</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">20</span>:<span class="mi">33</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">20</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="cp">#![cfg_attr(target_os = </span><span class="s">"wasi"</span><span class="cp">, feature(thread_local))]</span><span class="w"></span>

<span class="w"> </span><span class="err">```</span><span class="w"></span>
</code></pre></div>



<a name="230178549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230178549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Chege <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230178549">(Mar 13 2021 at 17:56)</a>:</h4>
<p>If I try compiling it with nightly <code>cargo +nightly build --target wasm32-wasi </code> it results in error</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">wat</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="mf">0.36</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">dirs</span><span class="o">-</span><span class="n">sys</span><span class="o">-</span><span class="n">next</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">1.2</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="mf">2.0</span><span class="w"></span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">semver</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">11.0</span><span class="w"></span>
<span class="n">error</span><span class="p">[</span><span class="n">E0425</span><span class="p">]</span>: <span class="nc">cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">lock</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">x43</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="mi">1</span><span class="n">ecc6299db9ec823</span><span class="o">/</span><span class="n">region</span><span class="o">-</span><span class="mf">2.2.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lock</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">30</span>:<span class="mi">7</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">30</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="n">os</span>::<span class="n">lock</span><span class="p">(</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">       </span><span class="o">^^^^</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="n">help</span>: <span class="nc">consider</span><span class="w"> </span><span class="n">importing</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">function</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">1</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">lock</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>

<span class="n">error</span><span class="p">[</span><span class="n">E0425</span><span class="p">]</span>: <span class="nc">cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">unlock</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">x43</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="mi">1</span><span class="n">ecc6299db9ec823</span><span class="o">/</span><span class="n">region</span><span class="o">-</span><span class="mf">2.2.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lock</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">60</span>:<span class="mi">7</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">60</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="n">os</span>::<span class="n">unlock</span><span class="p">(</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">       </span><span class="o">^^^^^^</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="n">help</span>: <span class="nc">consider</span><span class="w"> </span><span class="n">importing</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">function</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">1</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">unlock</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>

<span class="n">error</span><span class="p">[</span><span class="n">E0425</span><span class="p">]</span>: <span class="nc">cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">page_size</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">x43</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="mi">1</span><span class="n">ecc6299db9ec823</span><span class="o">/</span><span class="n">region</span><span class="o">-</span><span class="mf">2.2.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">page</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">16</span>:<span class="mi">39</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">16</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="n">INIT</span><span class="p">.</span><span class="n">call_once</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="n">PAGE_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span>::<span class="n">page_size</span><span class="p">());</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">                                       </span><span class="o">^^^^^^^^^</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>

<span class="n">error</span><span class="p">[</span><span class="n">E0425</span><span class="p">]</span>: <span class="nc">cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">set_protection</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">x43</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="mi">1</span><span class="n">ecc6299db9ec823</span><span class="o">/</span><span class="n">region</span><span class="o">-</span><span class="mf">2.2.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">protect</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">48</span>:<span class="mi">7</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">48</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="n">os</span>::<span class="n">set_protection</span><span class="p">(</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">       </span><span class="o">^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>

<span class="n">error</span><span class="p">[</span><span class="n">E0425</span><span class="p">]</span>: <span class="nc">cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">get_region</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>
<span class="w">   </span><span class="o">-</span>-&gt; <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">x43</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="mi">1</span><span class="n">ecc6299db9ec823</span><span class="o">/</span><span class="n">region</span><span class="o">-</span><span class="mf">2.2.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">133</span>:<span class="mi">7</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="mi">133</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="n">os</span>::<span class="n">get_region</span><span class="p">(</span><span class="n">page</span>::<span class="n">floor</span><span class="p">(</span><span class="n">address</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="o">^^^^^^^^^^</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">os</span><span class="err">`</span><span class="w"></span>

<span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>
</code></pre></div>



<a name="230178605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230178605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Chege <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230178605">(Mar 13 2021 at 17:58)</a>:</h4>
<p>My toml file</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">edition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2018"</span><span class="w"></span>

<span class="err">#</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">definitions</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span>:<span class="c1">//doc.rust-lang.org/cargo/reference/manifest.html</span>

<span class="p">[</span><span class="n">dependencies</span><span class="p">]</span><span class="w"></span>
<span class="n">wasmtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0.23.0"</span><span class="w"></span>
<span class="n">wasmtime</span><span class="o">-</span><span class="n">wasi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0.24.0"</span><span class="w"></span>
</code></pre></div>



<a name="230179165"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230179165" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230179165">(Mar 13 2021 at 18:08)</a>:</h4>
<p>Are you looking to compile wasmtime itself to wasm32-wasi?</p>



<a name="230179239"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230179239" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230179239">(Mar 13 2021 at 18:09)</a>:</h4>
<p>That isn't possible today, because wasmtime depends on several platform features not available in WASI, such as memory protections needed for JITing.</p>



<a name="230179342"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230179342" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230179342">(Mar 13 2021 at 18:11)</a>:</h4>
<p>If you're looking to compile other programs to wasm32-wasi, you don't need wasmtime or wasmtime-wasi as dependencies. The Rust standard library has built in WASI support.</p>



<a name="230179957"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Error%20in%20compiling%20wasmtime/near/230179957" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Chege <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Error.20in.20compiling.20wasmtime.html#230179957">(Mar 13 2021 at 18:23)</a>:</h4>
<p>Thanks! I was looking at the examples. But your comment solves my issue.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>