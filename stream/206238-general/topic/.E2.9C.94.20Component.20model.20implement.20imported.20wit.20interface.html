<html>
<head><meta charset="utf-8"><title>✔ Component model implement imported wit interface · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html">✔ Component model implement imported wit interface</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="376482056"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/376482056" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cole Nelms <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#376482056">(Jul 18 2023 at 22:02)</a>:</h4>
<p>I want to use wit import in wasmtime host. I want to import an interface in my wit world. Then I want to impl the imported interface functions in the wasmtime host. So far I can only impl the world, but I want to impl the imported interface.</p>
<p>I have seen this done with an exported interface in the guest component. It used syntax like: crate::exports::thing::Thing. I can't seem to get the same effect with the imports though.</p>



<a name="376742942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/376742942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#376742942">(Jul 19 2023 at 17:32)</a>:</h4>
<p>here is someone else trying to do something similar : <a href="#narrow/stream/217126-wasmtime/topic/component.20Linker.20and.20instantiate">https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime/topic/component.20Linker.20and.20instantiate</a></p>



<a name="376743030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/376743030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#376743030">(Jul 19 2023 at 17:33)</a>:</h4>
<p>see if anything in there helps you, and if not please give more specifics on what you have done so far and what you are struggling with</p>



<a name="376924933"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/376924933" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karel Hrkal (kajacx) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#376924933">(Jul 20 2023 at 10:31)</a>:</h4>
<p><span class="user-mention" data-user-id="627912">@Cole Nelms</span> Hello, I have an example of interface imports and exports in <a href="https://github.com/kajacx/wasm-playground/tree/wit-bindgen">this repo</a>. Look at the <code>guest-rust</code> for the guest code - how to call the imported functions, and <code>runtime-rust-wasmtime</code> for how to define them in the host runtime.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/kajacx/wasm-playground/tree/wit-bindgen" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/19b57c1a290c199cc4527045adc55f69e2fcd59c\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f373332663666613332623362333837366566316563336539643936363036383338333562323364663761626665366265373036663031343764333261333739612f6b616a6163782f7761736d2d706c617967726f756e64)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/kajacx/wasm-playground/tree/wit-bindgen" title="GitHub - kajacx/wasm-playground at wit-bindgen">GitHub - kajacx/wasm-playground at wit-bindgen</a></div><div class="message_embed_description">Various projects related to WASM, each in it's own branch, so that I don't have 50 repositories. - GitHub - kajacx/wasm-playground at wit-bindgen</div></div></div>



<a name="377156834"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377156834" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cole Nelms <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377156834">(Jul 21 2023 at 02:25)</a>:</h4>
<p><span class="user-mention" data-user-id="621586">@Karel Hrkal (kajacx)</span> It worked thank you. I have a few questions though. Why does the host use <code>wasmtime-wit-bindgen</code>? I deleted it and it seemed to work fine. Also, do you happen to know how to use a wit <code>record</code> inside of a wit <code>interface</code> from rust? I noticed if its just defined in the world it is in the global scope in rust, but I wanted to know how to use it in an interface.</p>



<a name="377177741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377177741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cole Nelms <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377177741">(Jul 21 2023 at 05:25)</a>:</h4>
<p><span class="user-mention" data-user-id="621586">@Karel Hrkal (kajacx)</span> Disregard the interface type question I was able to get it working by having a function that takes the type.</p>



<a name="377194369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377194369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karel Hrkal (kajacx) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377194369">(Jul 21 2023 at 07:07)</a>:</h4>
<p>"Why does the host use wasmtime-wit-bindgen? I deleted it and it seemed to work fine." I was trying a few different things and forgot to delete it, thanks for the reminder. The <code>wit-component</code> dependency was also unused.</p>



<a name="377194908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377194908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karel Hrkal (kajacx) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377194908">(Jul 21 2023 at 07:09)</a>:</h4>
<p>That's good that you managed to get the types working. Did you do it like this? <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#interfaces-worlds-and-use">https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#interfaces-worlds-and-use</a> Or did you use some other method?</p>



<a name="377418005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377418005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cole Nelms <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377418005">(Jul 21 2023 at 20:14)</a>:</h4>
<p><span class="user-mention" data-user-id="621586">@Karel Hrkal (kajacx)</span> I happened to actually be using <code>wit-component</code> so I didn't think to point that out.</p>
<p>If the wit file is like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">my</span>:<span class="nc">example</span>

<span class="n">interface</span><span class="w"> </span><span class="n">imports</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">record</span><span class="w"> </span><span class="n">my</span><span class="o">-</span><span class="k">type</span> <span class="p">{</span>
<span class="w">    </span><span class="n">active</span>: <span class="kt">bool</span><span class="p">,</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kr">do</span><span class="o">-</span><span class="n">stuff</span>: <span class="nc">func</span><span class="p">(</span><span class="n">arg</span>: <span class="nc">my</span><span class="o">-</span><span class="k">type</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">world</span><span class="w"> </span><span class="n">my</span><span class="o">-</span><span class="n">world</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">imports</span>
<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">run</span>: <span class="nc">func</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>Then in both the rust host and guest I can use the <code>my::example::imports::MyType</code> type.</p>
<p>However, if the wit file looks like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">my</span>:<span class="nc">example</span>

<span class="n">interface</span><span class="w"> </span><span class="n">imports</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">record</span><span class="w"> </span><span class="n">my</span><span class="o">-</span><span class="k">type</span> <span class="p">{</span>
<span class="w">    </span><span class="n">active</span>: <span class="kt">bool</span><span class="p">,</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">world</span><span class="w"> </span><span class="n">my</span><span class="o">-</span><span class="n">world</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">imports</span>
<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">run</span>: <span class="nc">func</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>Then I can no longer use the <code>my::example::imports::MyType</code> type. It seems that the <code>interface</code> needs a function that takes the type in order to import the type.</p>



<a name="377507227"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377507227" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karel Hrkal (kajacx) <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377507227">(Jul 22 2023 at 07:24)</a>:</h4>
<p><code>import</code> doesn't "import" the types in the interface, it specifies that the host will have to implemented the functions in the "imported" interface.</p>
<p>You can "include" a type from an interface with <code>use</code>:</p>
<div class="codehilite" data-code-language="wit"><pre><span></span><code>package example:protocol

interface types {
  record point {
    x: s32,
    y: s32,
  }
}

world my-world {
  use types.{point}

  import import-point: func(pnt: point) -&gt; point
  export move-point: func(pnt: point) -&gt; point

  import print: func(msg: string)
  // Say "Hello" to stdout, use with wasi
  export say-hello: func()
}
</code></pre></div>
<p>However, you will have to add an "empty impl" on the host, I am not sure why:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="w"> </span><span class="n">example</span>::<span class="n">protocol</span>::<span class="n">types</span>::<span class="n">Host</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>



<a name="377975731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/377975731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#377975731">(Jul 24 2023 at 03:16)</a>:</h4>
<p>this is a bug in wasmtime's wit-bindgen at the moment, it emits an trait and requires it in the linker constraints for your world for every interface in the worlds imports, even if the interface contains no functions. nobody has taken the time to fix this bug, but if youd like to work on it, it should be pretty straightforward</p>



<a name="379358596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/379358596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cole Nelms <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#379358596">(Jul 28 2023 at 04:48)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="253992">@Pat Hickey</span>  and <span class="user-mention" data-user-id="621586">@Karel Hrkal (kajacx)</span>. This can be marked as solved.</p>



<a name="379647313"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20Component%20model%20implement%20imported%20wit%20interface/near/379647313" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20Component.20model.20implement.20imported.20wit.20interface.html#379647313">(Jul 28 2023 at 22:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="421591">Bailey Hayes</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>