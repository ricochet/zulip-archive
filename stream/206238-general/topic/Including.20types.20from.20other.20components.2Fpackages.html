<html>
<head><meta charset="utf-8"><title>Including types from other components/packages · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html">Including types from other components/packages</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="454069239"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454069239" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454069239">(Jul 25 2024 at 23:22)</a>:</h4>
<p>I have a WIT component/package called <code>lyra:api</code>, it has an interface named <code>ecs</code>. I want to include a resource inside the <code>ecs</code> interface and use it in another component.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">lyra</span><span class="p">:</span><span class="nc">api</span><span class="p">;</span>

<span class="c1">// ecs.wit is adjacent to this .wit file</span>

<span class="n">world</span><span class="w"> </span><span class="n">imports</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// defines resource ecs-world</span>
<span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">ecs</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Then I have this component:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">component</span><span class="p">:</span><span class="nc">witguest</span><span class="p">;</span>

<span class="sd">/// An example world for the component to target.</span>
<span class="n">world</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">math</span><span class="p">;</span>
<span class="w">    </span><span class="n">include</span><span class="w"> </span><span class="n">lyra</span><span class="p">:</span><span class="nc">api</span><span class="o">/</span><span class="n">ecs</span><span class="p">;</span>

<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">update</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">(</span><span class="n">game</span><span class="o">-</span><span class="n">world</span><span class="p">:</span><span class="w"> </span><span class="nc">ecs</span><span class="o">-</span><span class="n">world</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>When I run <code>cargo component build</code>, I get this error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">world</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="err">`</span><span class="n">witguest</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">data_drive</span><span class="o">/</span><span class="n">Development</span><span class="o">/</span><span class="n">Rust</span><span class="o">/</span><span class="n">lyra</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">scripting</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">witguest</span><span class="o">/</span><span class="n">Cargo</span><span class="p">.</span><span class="n">toml</span><span class="p">)</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span><span class="p">:</span>
<span class="w">    </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">parse</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">data_drive</span><span class="o">/</span><span class="n">Development</span><span class="o">/</span><span class="n">Rust</span><span class="o">/</span><span class="n">lyra</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">scripting</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">witguest</span><span class="o">/</span><span class="n">wit</span><span class="err">`</span>
<span class="w">    </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="nc">name</span><span class="w"> </span><span class="err">`</span><span class="n">ecs</span><span class="o">-</span><span class="n">world</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">defined</span>
<span class="w">            </span><span class="o">-</span><span class="p">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">data_drive</span><span class="o">/</span><span class="n">Development</span><span class="o">/</span><span class="n">Rust</span><span class="o">/</span><span class="n">lyra</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">scripting</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">witguest</span><span class="o">/</span><span class="n">wit</span><span class="o">/</span><span class="n">world</span><span class="p">.</span><span class="n">wit</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">40</span>
<span class="w">             </span><span class="o">|</span>
<span class="w">          </span><span class="mi">21</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="n">export</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">update</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">(</span><span class="n">game</span><span class="o">-</span><span class="n">world</span><span class="p">:</span><span class="w"> </span><span class="nc">ecs</span><span class="o">-</span><span class="n">world</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">result</span><span class="p">;</span>
<span class="w">             </span><span class="o">|</span><span class="w">                                        </span><span class="o">^--------</span>
</code></pre></div>
<p>If you're wondering more about what my project structure is, <a href="https://git.seanomik.net/SeanOMik/lyra-wasm-scripting-test">here's the git repo</a> but it doesn't have these changes in it (I can push them to another branch).</p>



<a name="454069800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454069800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454069800">(Jul 25 2024 at 23:28)</a>:</h4>
<p>i think you need a <code>use lyra:api/imports.{ecs-world};</code></p>



<a name="454069810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454069810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454069810">(Jul 25 2024 at 23:29)</a>:</h4>
<p>in your <code>world example</code>.</p>



<a name="454069937"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454069937" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454069937">(Jul 25 2024 at 23:30)</a>:</h4>
<p>the <code>include</code> keyword means that all of the imports and exports in the <code>lyre:api/ecs</code> world will be imported/exported in your example world, but it doesnt bring those names into scope - only <code>use</code> does that.</p>



<a name="454070119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070119">(Jul 25 2024 at 23:32)</a>:</h4>
<p>Yup that was it! I spent way too long on this and it was so simple lol, thanks!</p>



<a name="454070178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070178">(Jul 25 2024 at 23:33)</a>:</h4>
<p>happy to help. this is a situation where, if we had amazing error messages like rustc, it would just tell you what to do here</p>



<a name="454070238"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070238" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070238">(Jul 25 2024 at 23:34)</a>:</h4>
<p>oh yeah, better errors would be amazing</p>



<a name="454070256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070256">(Jul 25 2024 at 23:34)</a>:</h4>
<p>I think better docs and examples would be great as well</p>



<a name="454070268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070268">(Jul 25 2024 at 23:34)</a>:</h4>
<p>which docs and examples did you use so far?</p>



<a name="454070300"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070300" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070300">(Jul 25 2024 at 23:35)</a>:</h4>
<p>I was looking at the docs here: <a href="https://component-model.bytecodealliance.org/design/wit.html">https://component-model.bytecodealliance.org/design/wit.html</a></p>



<a name="454070343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070343">(Jul 25 2024 at 23:35)</a>:</h4>
<p>I see where <code>use</code> is explained, but it doesn't show that you also use that to use things from other packages</p>



<a name="454070411"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070411" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070411">(Jul 25 2024 at 23:36)</a>:</h4>
<p>Other than the examples there, I've also been looking at the examples on the <a href="https://github.com/bytecodealliance/wit-bindgen">wit-bindgen readme</a>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen" style="background-image: url(&quot;https://uploads.zulipusercontent.net/0d4812a87f866994bb5d82932b78c81d99d91e2b/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f386437393437323437626234653037633030343537376131343463666235323864393031626536363038396137356165336566366330383130613531636464392f62797465636f6465616c6c69616e63652f7769742d62696e6467656e&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen" title="GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types">GitHub - bytecodealliance/wit-bindgen: A language binding generator for WebAssembly interface types</a></div><div class="message_embed_description">A language binding generator for WebAssembly interface types - bytecodealliance/wit-bindgen</div></div></div>



<a name="454070483"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070483" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070483">(Jul 25 2024 at 23:37)</a>:</h4>
<p>yeah i think the whole section on packages on that doc could be expanded to show a bunch more</p>



<a name="454070612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454070612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454070612">(Jul 25 2024 at 23:38)</a>:</h4>
<p>Okay, so now I'm actually running into a more complicated issue...</p>



<a name="454071090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454071090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454071090">(Jul 25 2024 at 23:41)</a>:</h4>
<p>So my plan for this project is to integrate WASM as a scripting language in a game engine. Currently I'm just starting with exposing the ECS (Entity Component System) to WASM. That requires exposing some kind of low level interfaces that include passing a <code>vec&lt;u8&gt;</code> of byte serialized components to and from the host alongside information detailing what those bytes are.</p>
<p>Because I don't want to always deal with manually (de)serializing those bytes to and from the host every time I want to get something from the ECS world, I planned on making a higher level crate that makes it nicer.</p>



<a name="454071323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454071323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454071323">(Jul 25 2024 at 23:42)</a>:</h4>
<p>In the git repo I sent above, the higher level crate is a wasm component and called <code>common-api</code>. This crate is a dependency of the <code>witguest</code> wasm component</p>



<a name="454071669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454071669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454071669">(Jul 25 2024 at 23:44)</a>:</h4>
<p>This is the <code>witguest</code> component world:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">world</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">math</span><span class="p">;</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="n">lyra</span><span class="p">:</span><span class="nc">api</span><span class="o">/</span><span class="n">ecs</span><span class="p">.{</span><span class="n">ecs</span><span class="o">-</span><span class="n">world</span><span class="p">};</span>

<span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">host</span><span class="o">-</span><span class="n">print</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="w"> </span><span class="nc">string</span><span class="p">);</span>
<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">init</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">result</span><span class="p">;</span>

<span class="w">    </span><span class="n">export</span><span class="w"> </span><span class="n">on</span><span class="o">-</span><span class="n">update</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">(</span><span class="n">game</span><span class="o">-</span><span class="n">world</span><span class="p">:</span><span class="w"> </span><span class="nc">ecs</span><span class="o">-</span><span class="n">world</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><code>ecs-world</code> is <code>imported</code> in the common-api crate (lyra:api component) but cargo-component through bindings are generating separate structs of the same name of <code>EcsWorld</code>, causing that <code>witguest</code> component not able to use the abstractions of common-api</p>



<a name="454071731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454071731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454071731">(Jul 25 2024 at 23:44)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">on_update</span><span class="p">(</span><span class="n">game_world</span><span class="p">:</span><span class="w"> </span><span class="nc">EcsWorld</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span><span class="w"> </span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">world</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">World</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="n">game_world</span><span class="p">);</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">"Guest update"</span><span class="p">);</span>

<span class="w">    </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="p">}</span>
</code></pre></div>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">[</span><span class="n">E0277</span><span class="p">]:</span><span class="w"> </span><span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">bound</span><span class="w"> </span><span class="err">`</span><span class="n">World</span><span class="p">:</span><span class="w"> </span><span class="nb">From</span><span class="o">&lt;</span><span class="n">bindings</span><span class="p">::</span><span class="n">lyra</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="n">ecs</span><span class="p">::</span><span class="n">EcsWorld</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">satisfied</span>
<span class="w">  </span><span class="o">-</span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">witguest</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">21</span>
<span class="w">   </span><span class="o">|</span>
<span class="mi">36</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="kd">let</span><span class="w"> </span><span class="n">world</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">World</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="n">game_world</span><span class="p">);</span>
<span class="w">   </span><span class="o">|</span><span class="w">                     </span><span class="o">^^^^^</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="nb">From</span><span class="o">&lt;</span><span class="n">bindings</span><span class="p">::</span><span class="n">lyra</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="n">ecs</span><span class="p">::</span><span class="n">EcsWorld</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">World</span><span class="err">`</span>
<span class="w">   </span><span class="o">|</span>
<span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">help</span><span class="p">:</span><span class="w"> </span><span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="nb">From</span><span class="o">&lt;</span><span class="n">common_api</span><span class="p">::</span><span class="n">bindings</span><span class="p">::</span><span class="n">lyra</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="n">ecs</span><span class="p">::</span><span class="n">EcsWorld</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">World</span><span class="err">`</span>
<span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">help</span><span class="p">:</span><span class="w"> </span><span class="nc">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">implementation</span><span class="p">,</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="err">`</span><span class="n">common_api</span><span class="p">::</span><span class="n">bindings</span><span class="p">::</span><span class="n">lyra</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="n">ecs</span><span class="p">::</span><span class="n">EcsWorld</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="err">`</span><span class="n">bindings</span><span class="p">::</span><span class="n">lyra</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="n">ecs</span><span class="p">::</span><span class="n">EcsWorld</span><span class="err">`</span>
</code></pre></div>



<a name="454071908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454071908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454071908">(Jul 25 2024 at 23:45)</a>:</h4>
<p>have you taken a look at the way that <code>wasmtime-wasi-http</code> reuses interfaces from the <code>wasmtime-wasi</code> crate?</p>



<a name="454072070"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072070" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072070">(Jul 25 2024 at 23:46)</a>:</h4>
<p>Ohh, no I have not. I'll take a look at that</p>



<a name="454072103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072103">(Jul 25 2024 at 23:46)</a>:</h4>
<p>oh, wait, you re talking about on the guest side.</p>



<a name="454072128"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072128" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072128">(Jul 25 2024 at 23:46)</a>:</h4>
<p>Yeah</p>



<a name="454072541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072541">(Jul 25 2024 at 23:49)</a>:</h4>
<p>I'm basically trying to create a high-level crate for making it easier to use imported interfaces that the host defines. But then the guest still needs to export some functions for the host to call which also passes those low level interfaces that need to be "raised" to the higher-level ones</p>



<a name="454072597"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072597" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072597">(Jul 25 2024 at 23:49)</a>:</h4>
<p>i dont usually use cargo-component, which invokes wit-bindgen on the users behalf, but the mechanism wit-bindgen exposes for this is the <code>with:</code> clause in the generate macro: <a href="https://docs.rs/wit-bindgen/latest/wit_bindgen/macro.generate.html">https://docs.rs/wit-bindgen/latest/wit_bindgen/macro.generate.html</a></p>



<a name="454072638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072638">(Jul 25 2024 at 23:49)</a>:</h4>
<p>i cant link to the right section in the docs, there, you have to scroll down to the comments on <code>with:</code></p>



<a name="454072671"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072671" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072671">(Jul 25 2024 at 23:49)</a>:</h4>
<p>in the final section</p>



<a name="454072710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072710">(Jul 25 2024 at 23:50)</a>:</h4>
<p>Ohhh I see it</p>



<a name="454072823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072823">(Jul 25 2024 at 23:50)</a>:</h4>
<blockquote>
<p>When generating bindings for interfaces that are not defined in the same package as <code>world</code>, <strong>this option can be used to either generate those bindings or point to already generated bindings.</strong></p>
</blockquote>



<a name="454072892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072892">(Jul 25 2024 at 23:50)</a>:</h4>
<p>Okay that seems like that is actually perfect since I also have the common-api crate as a dependency in cargo</p>



<a name="454072926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072926">(Jul 25 2024 at 23:51)</a>:</h4>
<p>I'll try that rq</p>



<a name="454072934"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454072934" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454072934">(Jul 25 2024 at 23:51)</a>:</h4>
<p>yeah its designed for this use case</p>



<a name="454074577"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454074577" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454074577">(Jul 26 2024 at 00:02)</a>:</h4>
<p>Okay I'm doing something wrong, but I'm not sure what as the docs don't explain the examples they give. This is what I'm trying in the <code>witguest</code> component:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wit_bindgen</span><span class="p">::</span><span class="n">generate</span><span class="o">!</span><span class="p">({</span>
<span class="w">    </span><span class="n">world</span><span class="p">:</span><span class="w"> </span><span class="s">"example"</span><span class="p">,</span>

<span class="w">    </span><span class="n">with</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s">"lyra:api/ecs"</span><span class="p">:</span><span class="w"> </span><span class="nc">common_api</span><span class="p">::</span><span class="n">bindings</span><span class="p">::</span><span class="n">lyra</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="n">ecs</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="p">});</span>
</code></pre></div>
<p>But when trying to compile, its not able to find the <code>lyra:api/ecs</code> package:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">         </span><span class="n">package</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span>
<span class="w">            </span><span class="o">-</span><span class="p">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">data_drive</span><span class="o">/</span><span class="n">Development</span><span class="o">/</span><span class="n">Rust</span><span class="o">/</span><span class="n">lyra</span><span class="o">-</span><span class="n">wasm</span><span class="o">-</span><span class="n">scripting</span><span class="o">-</span><span class="n">test</span><span class="o">/</span><span class="n">witguest</span><span class="o">/</span><span class="n">wit</span><span class="o">/</span><span class="n">world</span><span class="p">.</span><span class="n">wit</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">9</span>
<span class="w">             </span><span class="o">|</span>
<span class="w">          </span><span class="mi">15</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="k">use</span><span class="w"> </span><span class="n">lyra</span><span class="p">:</span><span class="nc">api</span><span class="o">/</span><span class="n">ecs</span><span class="p">.{</span><span class="n">ecs</span><span class="o">-</span><span class="n">world</span><span class="p">};</span>
<span class="w">             </span><span class="o">|</span><span class="w">         </span><span class="o">^-------</span>
</code></pre></div>



<a name="454074653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454074653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SeanOMik <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454074653">(Jul 26 2024 at 00:03)</a>:</h4>
<p>I tried to change that with to <code>"lyra:api": common_api::bindings::lyra::api</code> but that didn't work either, it gave the same error</p>



<a name="454283136"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454283136" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454283136">(Jul 26 2024 at 11:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253992">Pat Hickey</span> <a href="#narrow/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages/near/454070483">said</a>:</p>
<blockquote>
<p>yeah i think the whole section on packages on that doc could be expanded to show a bunch more</p>
</blockquote>
<p>Generally, in all past versions of such "component [object] models" shall we say, there arose <em>instantly</em> the question of creating shared versions of types that each side used such that each side of an interaction did not need to think of differently named but identical types.</p>



<a name="454283225"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Including%20types%20from%20other%20components/packages/near/454283225" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Including.20types.20from.20other.20components.2Fpackages.html#454283225">(Jul 26 2024 at 11:58)</a>:</h4>
<p>We need to take that as a standalone subject in the docs; tons and tons of threads on the zulip are quitely literally about why is the type different? how do I reuse the same type? and so on...</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>