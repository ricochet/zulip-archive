<html>
<head><meta charset="utf-8"><title>firefox wasm memory leak · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html">firefox wasm memory leak</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="205614134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614134">(Jul 31 2020 at 16:53)</a>:</h4>
<p>I compiled rustc to a wasm module using wasi. I am currently trying to make a new wasi polyfill in pure javascript. I noticed that every time I refresh the page in firefox the memory usage increases by 200MB. Only closing the tab releases this memory again after forcing a GC. Can somebody report a bug for me? I don't have a bugzilla account.</p>



<a name="205614201"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614201" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614201">(Jul 31 2020 at 16:53)</a>:</h4>
<p><span class="user-mention" data-user-id="264278">@bjorn3</span> can you use your Github account to log in with Bugzilla? It's likely people looking at your bug will ask for more information, etc. so you have better chances to see it resolved if you can answer directly</p>



<a name="205614257"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614257" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614257">(Jul 31 2020 at 16:54)</a>:</h4>
<p>(Great job compiling rustc to wasm, btw!)</p>



<a name="205614319"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614319" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614319">(Jul 31 2020 at 16:54)</a>:</h4>
<p>I didn't know you could login using github.</p>



<a name="205614422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614422">(Jul 31 2020 at 16:55)</a>:</h4>
<p>I used cg_clif as codegen backend for rustc. I was then able to run it in wasmtime.</p>



<a name="205614491"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614491" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614491">(Jul 31 2020 at 16:56)</a>:</h4>
<p>It is Cranelift's all the way to the bottom :)</p>



<a name="205614806"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614806" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614806">(Jul 31 2020 at 16:59)</a>:</h4>
<p>What is the maximum size for attachments? Can I attach the 49MB rustc_binary.wasm file?</p>



<a name="205614950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205614950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205614950">(Jul 31 2020 at 17:00)</a>:</h4>
<p>Also does it support markdown in the description?</p>



<a name="205615037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205615037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Benjamin Bouvier <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205615037">(Jul 31 2020 at 17:00)</a>:</h4>
<p>Markdown indeed is supported; max size i don't know, do you have a web server where to host it? or github pages?</p>



<a name="205615326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205615326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205615326">(Jul 31 2020 at 17:03)</a>:</h4>
<p>I don't have a web server. I can try if github pages allows it.</p>



<a name="205615448"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205615448" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205615448">(Jul 31 2020 at 17:04)</a>:</h4>
<p>Might be worth trying gzip or xz; I don't know how compressible wasm bytecode is but it has to be better than nothing</p>



<a name="205615466"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205615466" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205615466">(Jul 31 2020 at 17:04)</a>:</h4>
<p>(If you have to attach it in Bugzilla I mean)</p>



<a name="205615686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205615686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205615686">(Jul 31 2020 at 17:06)</a>:</h4>
<p>gzip: 49MB -&gt; 11MB</p>



<a name="205616659"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205616659" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205616659">(Jul 31 2020 at 17:16)</a>:</h4>
<p>I can't attach both the wasm file and the memory report when filing the report. Can I attach either after the fact?</p>



<a name="205616701"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205616701" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205616701">(Jul 31 2020 at 17:16)</a>:</h4>
<p>You should be able to, yes</p>



<a name="205616956"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205616956" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205616956">(Jul 31 2020 at 17:19)</a>:</h4>
<blockquote>
<p>This file (10.5 MB) is larger than the maximum allowed size (10.0 MB). Please consider uploading it to an online file storage and sharing the link in a bug comment instead.</p>
</blockquote>
<p>The rustc_binary.wasm file is just a bit too big.</p>



<a name="205617103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205617103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205617103">(Jul 31 2020 at 17:20)</a>:</h4>
<p><code>xz</code> or <code>bzip2</code>?</p>



<a name="205617327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205617327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205617327">(Jul 31 2020 at 17:23)</a>:</h4>
<p><code>xz</code> worked. Just 6MB.</p>



<a name="205617334"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205617334" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205617334">(Jul 31 2020 at 17:23)</a>:</h4>
<p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1656549">https://bugzilla.mozilla.org/show_bug.cgi?id=1656549</a></p>



<a name="205617463"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205617463" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205617463">(Jul 31 2020 at 17:24)</a>:</h4>
<p>bugzilla choose my user name based on my email address. Can I change it somewhere?</p>



<a name="205617523"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205617523" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205617523">(Jul 31 2020 at 17:25)</a>:</h4>
<p>ah, has to fill in realname</p>



<a name="205617837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/firefox%20wasm%20memory%20leak/near/205617837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/firefox.20wasm.20memory.20leak.html#205617837">(Jul 31 2020 at 17:28)</a>:</h4>
<p>it still leaks my email address though</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>