<html>
<head><meta charset="utf-8"><title>✔ `cargo component build` throws error after upgrade to v... · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html">✔ `cargo component build` throws error after upgrade to v...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="403600133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403600133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christoph Brewing <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403600133">(Nov 22 2023 at 14:11)</a>:</h4>
<p>I had a running project building a <strong>cargo component</strong> with <code>cargo component build</code> (v0.1.0). After an upgrade to v0.5.0, I get a diffuse error:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>component<span class="w"> </span>build<span class="w"> </span>--release
<span class="w">   </span>Compiling<span class="w"> </span>&lt;myproject&gt;<span class="w"> </span>v0.1.0<span class="w"> </span><span class="o">(</span>/&lt;myproject&gt;<span class="o">)</span>
error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span>target<span class="w"> </span>file<span class="w"> </span><span class="sb">`</span>/&lt;myproject&gt;/target/bindings/&lt;myproject&gt;/target.wasm<span class="sb">`</span>:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>

<span class="w">       </span>did<span class="w"> </span>you<span class="w"> </span>forget<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>cargo<span class="w"> </span>component<span class="w"> </span>build<span class="sb">`</span>?<span class="w"> </span><span class="o">(</span>https://github.com/bytecodealliance/cargo-component<span class="o">)</span>
<span class="w">  </span>--&gt;<span class="w"> </span>src/lib.rs:29:1
<span class="w">   </span><span class="p">|</span>
<span class="m">29</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cargo_component_bindings::generate!<span class="o">({</span><span class="w"> </span>implementor:<span class="w"> </span>Decoder<span class="w"> </span><span class="o">})</span><span class="p">;</span>
<span class="w">   </span><span class="p">|</span><span class="w"> </span>^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
<span class="w">   </span><span class="p">|</span>
<span class="w">   </span><span class="o">=</span><span class="w"> </span>note:<span class="w"> </span>this<span class="w"> </span>error<span class="w"> </span>originates<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>macro<span class="w"> </span><span class="sb">`</span>cargo_component_bindings::generate<span class="sb">`</span><span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span>Nightly<span class="w"> </span>builds,<span class="w"> </span>run<span class="w"> </span>with<span class="w"> </span>-Z<span class="w"> </span>macro-backtrace<span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>info<span class="o">)</span>

error<span class="o">[</span>E0433<span class="o">]</span>:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>resolve:<span class="w"> </span>use<span class="w"> </span>of<span class="w"> </span>undeclared<span class="w"> </span>crate<span class="w"> </span>or<span class="w"> </span>module<span class="w"> </span><span class="sb">`</span>bindings<span class="sb">`</span>
<span class="w">  </span>--&gt;<span class="w"> </span>src/lib.rs:30:5
<span class="w">   </span><span class="p">|</span>
<span class="m">30</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>use<span class="w"> </span>bindings::exports::decoder::api::decode::Guest<span class="p">;</span>
<span class="w">   </span><span class="p">|</span><span class="w">     </span>^^^^^^^^<span class="w"> </span>use<span class="w"> </span>of<span class="w"> </span>undeclared<span class="w"> </span>crate<span class="w"> </span>or<span class="w"> </span>module<span class="w"> </span><span class="sb">`</span>bindings<span class="sb">`</span>
</code></pre></div>
<p>For some reason, it is searching for a <strong>target.wasm</strong>. I do not use such a file in my project and, the contrary, was hoping that the command would generate a nice <code>.wasm</code> file for me. </p>
<p>Thank you very much for any hint.</p>



<a name="403601651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403601651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403601651">(Nov 22 2023 at 14:19)</a>:</h4>
<p>I'm not the most knowledgeable about cargo-component, but typically <code>cargo component build</code> will generate a <code>target/bindings/[..]/bindings.rs</code> file. It seems very odd that it would be looking for a <code>.wasm</code> there.</p>



<a name="403628328"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403628328" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403628328">(Nov 22 2023 at 16:35)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="253989">@Peter Huene</span></p>



<a name="403628523"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403628523" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403628523">(Nov 22 2023 at 16:36)</a>:</h4>
<p>Try running <code>cargo component upgrade --no-install</code></p>



<a name="403628782"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403628782" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403628782">(Nov 22 2023 at 16:38)</a>:</h4>
<p>The bindings crate version in <code>Cargo.toml</code> is out of date such that they didn't agree on the bindings file</p>



<a name="403629121"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403629121" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403629121">(Nov 22 2023 at 16:40)</a>:</h4>
<p>For a few versions, it generated an encoded target world (.wasm) that was fed to <code>wit-bindgen</code> to generate the bindings directly from the macro expansion; it now generates the bindings ahead of time like it used to</p>



<a name="403731715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403731715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christoph Brewing <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403731715">(Nov 23 2023 at 07:34)</a>:</h4>
<p>Either I misunderstood or it does not work: the command you propose does not provide any feedback and does not change the situation.</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>component<span class="w"> </span>upgrade<span class="w"> </span>--no-install
$
</code></pre></div>
<p>Additionally, I uninstalled <code>cargo-component</code> and installed it anew. The result is the same. Am I supposed to change anything in my project?</p>



<a name="403853524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403853524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christoph Brewing <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403853524">(Nov 23 2023 at 20:51)</a>:</h4>
<p><span class="user-mention" data-user-id="253989">@Peter Huene</span> Does that behavior reflect what you expected?</p>
<p>The way how I discovered the problem was that I created a Github Action to build my project. It installs <code>cargo component</code> and currently takes the latest version available. However, the build pipeline shows the same error as the local build (after having update <code>cargo component</code> locally).</p>



<a name="403853737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403853737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403853737">(Nov 23 2023 at 20:54)</a>:</h4>
<p>Are you running the command in the workspace? At a minimum we should improve the feedback to report that it didn't find a workspace to upgrade</p>



<a name="403853820"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403853820" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403853820">(Nov 23 2023 at 20:56)</a>:</h4>
<p>Is it supposed to automatically update your <code>cargo-component-bindings</code> dependency in any <code>Cargo.toml</code> found in your workspace to a compatible version to the CLI</p>



<a name="403853879"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403853879" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403853879">(Nov 23 2023 at 20:56)</a>:</h4>
<p>If it's not working for you, ensure the dependency is also at 0.5.0</p>



<a name="403910016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403910016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christoph Brewing <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403910016">(Nov 24 2023 at 06:56)</a>:</h4>
<p>Absolutely ... it was not (0.5.0): I still had <code>cargo-component-bindings = { git = "https://github.com/bytecodealliance/cargo-component" }</code> and that caused the confusion - sorry for that. Thank you very much!</p>



<a name="403910043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403910043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christoph Brewing <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403910043">(Nov 24 2023 at 06:56)</a>:</h4>
<p>Can you perhaps give me a last hint: previously I had a structure like </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">cargo_component_bindings</span>::<span class="n">generate</span><span class="o">!</span><span class="p">({</span><span class="w"> </span><span class="n">implementor</span>: <span class="nc">Decoder</span><span class="w"> </span><span class="p">});</span>
<span class="k">use</span><span class="w"> </span><span class="n">bindings</span>::<span class="n">Guest</span><span class="p">;</span>
<span class="c1">// [..]</span>
<span class="k">struct</span> <span class="nc">Decoder</span><span class="p">;</span>

<span class="k">impl</span><span class="w"> </span><span class="n">Guest</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Decoder</span><span class="w"> </span><span class="p">{</span>
<span class="c1">// [..]</span>
<span class="p">}</span>
</code></pre></div>
<p>This does not build anymore. I have to remove the <code>{implementor: Decoder}</code> and rename Decoder --&gt; Component in order for it to build, as you <a href="https://github.com/bytecodealliance/cargo-component">describe it here</a>. Is there still a way to give <code>Component</code> a different name?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/cargo-component" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/c9a0ce20c194a945655a7749bcf2b8b1693a4717\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f646363366162623930383431363932623834306134636639663062626563613662616136386162306533306535356133303438306665646236316438393063622f62797465636f6465616c6c69616e63652f636172676f2d636f6d706f6e656e74)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/cargo-component" title="GitHub - bytecodealliance/cargo-component: A Cargo subcommand for creating WebAssembly components based on the component model proposal.">GitHub - bytecodealliance/cargo-component: A Cargo subcommand for creating WebAssembly components based on the component model proposal.</a></div><div class="message_embed_description">A Cargo subcommand for creating WebAssembly components based on the component model proposal. - GitHub - bytecodealliance/cargo-component: A Cargo subcommand for creating WebAssembly components bas...</div></div></div>



<a name="403918691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403918691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403918691">(Nov 24 2023 at 08:06)</a>:</h4>
<p>Yes, the macro arguments changed to settings of the same name under the <code>package.metadata.component.bindings</code> table in <code>Cargo.toml</code></p>



<a name="403918791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403918791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403918791">(Nov 24 2023 at 08:07)</a>:</h4>
<p>Sorry for the less-than-smooth upgrade process</p>



<a name="403976510"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403976510" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christoph Brewing <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403976510">(Nov 24 2023 at 14:22)</a>:</h4>
<p>Nevermind, I am back in the game, using the most recent dependencies!</p>



<a name="403976528"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/%E2%9C%94%20%60cargo%20component%20build%60%20throws%20error%20after%20upgrade%20to%20v.../near/403976528" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/.E2.9C.94.20.60cargo.20component.20build.60.20throws.20error.20after.20upgrade.20to.20v.2E.2E.2E.html#403976528">(Nov 24 2023 at 14:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="595146">Christoph Brewing</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>