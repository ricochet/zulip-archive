<html>
<head><meta charset="utf-8"><title>✔ WIT compilation issue: left behind trailing whitespace · cargo-component · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/index.html">cargo-component</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html">✔ WIT compilation issue: left behind trailing whitespace</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="424725142"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424725142" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sehz <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424725142">(Mar 04 2024 at 19:04)</a>:</h4>
<p>I am getting this compilation issue with latest release of cargo component:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">[</span><span class="n">internal</span><span class="p">]</span>: <span class="nc">left</span><span class="w"> </span><span class="n">behind</span><span class="w"> </span><span class="n">trailing</span><span class="w"> </span><span class="n">whitespace</span>
<span class="w">     </span><span class="o">-</span>-&gt; <span class="o">&lt;</span><span class="n">stdin</span><span class="o">&gt;</span>:<span class="mi">21896</span>:<span class="mi">21896</span>:<span class="mi">1</span>
<span class="w">      </span><span class="o">|</span>
<span class="mi">21896</span><span class="w"> </span><span class="o">|</span>
<span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
<span class="w">      </span><span class="o">|</span>

<span class="n">warning</span>: <span class="nc">rustfmt</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">format</span><span class="p">.</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="mi">292</span><span class="w"> </span><span class="n">errors</span><span class="p">.</span>

<span class="n">thread</span><span class="w"> </span><span class="o">'</span><span class="na">main</span><span class="o">'</span><span class="w"> </span><span class="n">panicked</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">runner</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">crates</span><span class="p">.</span><span class="n">io</span><span class="o">-</span><span class="mi">6</span><span class="n">f17d22bba15001f</span><span class="o">/</span><span class="n">wit</span><span class="o">-</span><span class="n">bindgen</span><span class="o">-</span><span class="n">rust</span><span class="o">-</span><span class="mf">0.20.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">1107</span>:<span class="mi">13</span>:
<span class="nc">assertion</span><span class="w"> </span><span class="n">failed</span>: <span class="nc">status</span><span class="p">.</span><span class="n">success</span><span class="p">()</span>
<span class="n">note</span>: <span class="nc">run</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="err">`</span><span class="n">RUST_BACKTRACE</span><span class="o">=</span><span class="mi">1</span><span class="err">`</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">backtrace</span>
</code></pre></div>



<a name="424732907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424732907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424732907">(Mar 04 2024 at 19:31)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="392781">@Sehz</span>. Sorry about that! The latest version of <code>cargo-component</code> tries to format the generated bindings automatically, which is hitting some issues on vary complicated bindings.</p>
<p>We've filed <a href="https://github.com/bytecodealliance/wit-bindgen/issues/880">https://github.com/bytecodealliance/wit-bindgen/issues/880</a> to improve this.</p>
<p>In the meantime, you can disable the automatic formatting by setting <code>package.metadata.component.bindings.format</code> to <code>false</code>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wit-bindgen/issues/880" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/1ffa8bb59c174f3eb2021b05cae337e325baed89\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f303032326363353065303266353264663463643638336239636139636335666233613862666631343666366664656438343739363238663464633735303836642f62797465636f6465616c6c69616e63652f7769742d62696e6467656e2f6973737565732f383830)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wit-bindgen/issues/880" title="replace `cargo fmt` with the `prettyplease` crate · Issue #880 · bytecodealliance/wit-bindgen">replace `cargo fmt` with the `prettyplease` crate · Issue #880 · bytecodealliance/wit-bindgen</a></div><div class="message_embed_description">In order to more structurally work around code formatting issues like those described in #878, we should consider switching from cargo fmt to Dtolnay's prettyplease crate. This crate was designed s...</div></div></div>



<a name="424733089"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424733089" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424733089">(Mar 04 2024 at 19:32)</a>:</h4>
<p><del>I'll amend the release notes with the above information</del> updated!</p>



<a name="424735492"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424735492" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sehz <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424735492">(Mar 04 2024 at 19:48)</a>:</h4>
<p>Ok. that fixed the issue.  But now getting different error:  ```Error: failed to load cargo metadata</p>
<p>Caused by:<br>
<code>cargo metadata</code> exited with an error: error: failed to parse manifest at <code>Cargo.toml</code></p>
<div class="codehilite"><pre><span></span><code>Caused by:
  feature `wasm-component` includes `dep:wit-bindgen`, but `wit-bindgen` is not listed as a dependency```
</code></pre></div>

<p>I am following example here: <a href="https://github.com/bytecodealliance/cargo-component/blob/main/example/Cargo.toml">https://github.com/bytecodealliance/cargo-component/blob/main/example/Cargo.toml</a>.     If I add <code>wit-bindgen</code> as dependency like previous release , it works</p>



<a name="424735798"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424735798" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Huene <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424735798">(Mar 04 2024 at 19:50)</a>:</h4>
<p>Sounds like a feature local to your <code>Cargo.toml</code> (i.e. <code>wasm-component</code>) needs to be updated to use <code>wit-bindgen-rt</code> instead of <code>wit-bindgen</code></p>



<a name="424736069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424736069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sehz <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424736069">(Mar 04 2024 at 19:52)</a>:</h4>
<p>I am running latest version of was-component: <code>cargo component --version
cargo-component-component 0.9.0 (dc7cb41 2024-03-01 wasi:ab5a448)</code></p>



<a name="424736357"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424736357" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sehz <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424736357">(Mar 04 2024 at 19:54)</a>:</h4>
<p>never mind.  There was feature dep to cargo component.   sorry</p>



<a name="424969942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/407292-cargo-component/topic/%E2%9C%94%20WIT%20compilation%20issue%3A%20left%20behind%20trailing%20whitespace/near/424969942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/407292-cargo-component/topic/.E2.9C.94.20WIT.20compilation.20issue.3A.20left.20behind.20trailing.20whitespace.html#424969942">(Mar 05 2024 at 22:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="392781">Sehz</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>