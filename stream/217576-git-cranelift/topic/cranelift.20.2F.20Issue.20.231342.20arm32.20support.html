<html>
<head><meta charset="utf-8"><title>cranelift / Issue #1342 arm32 support · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html">cranelift / Issue #1342 arm32 support</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="185581514"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185581514" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185581514">(Jan 14 2020 at 10:18)</a>:</h4>
<p>jmkrauz opened <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<ul>
<li>
<p>What is the feature or code improvement you would like to do in Cranelift?<br>
I would like to add ARM support by implementing ARM (not Thumb) encodings/recipes and abi. I am especially interested in armv7 little endian support.</p>
</li>
<li>
<p>What is the value of adding this in Cranelift?<br>
Emit code that could run on ARM architecture.</p>
</li>
<li>
<p>Do you have an implementation plan, and/or ideas for data structures or<br>
  algorithms to use?<br>
At first i want to add basic integer operations followed by floating point instructions. I thought about implementing the latter using VFP rather than the NEON extension (As far as I know NEON does not support double precision). As for calling convention, I would like to implement AAPCS.<br>
 I already have some code that i hope to push after necessary modifications.</p>
</li>
<li>
<p>Have you considered alternative implementations? If so, how are they better<br>
  or worse than your proposal?<br>
No, but I am open to suggestions.</p>
</li>
</ul>
</blockquote>



<a name="185582664"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185582664" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185582664">(Jan 14 2020 at 10:35)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574110791" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574110791">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>There is already an issue for arm64 support: <a href="https://github.com/bytecodealliance/cranelift/issues/719" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/719">https://github.com/bytecodealliance/cranelift/issues/719</a>. Should this be merged, or is arm32 different enough at bit encoding or abi level to need a separate issue?</p>
</blockquote>



<a name="185582682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185582682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185582682">(Jan 14 2020 at 10:35)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574110791" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574110791">comment</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>There is already an issue for arm64 support: <a href="https://github.com/bytecodealliance/cranelift/issues/719" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/719">https://github.com/bytecodealliance/cranelift/issues/719</a>. Should this be merged, or is arm32 different enough at instruction encoding or abi level to need a separate issue?</p>
</blockquote>



<a name="185585086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185585086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185585086">(Jan 14 2020 at 11:08)</a>:</h4>
<p>jmkrauz <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574123487" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574123487">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>I don't know much about arm64, but I believe there are some important differences (for example on arm64 NEON supports double precision). However if someone thinks it should be merged, feel free to do it.</p>
</blockquote>



<a name="185586486"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185586486" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185586486">(Jan 14 2020 at 11:28)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131012" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131012">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>I was referring more to which bits represent an instruction. For x86/x86_64 the difference is small. Instructions with 32bit registers are often the same on x86 and x86_64, and the 64bit register variant just needs an extra byte (rex). I don't know if arm has something similar.</p>
</blockquote>



<a name="185586490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185586490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185586490">(Jan 14 2020 at 11:28)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131012" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131012">comment</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>I was referring to which bits represent an instruction. For x86/x86_64 the difference is small. Instructions with 32bit registers are often the same on x86 and x86_64, and the 64bit register variant just needs an extra byte (rex). I don't know if arm has something similar.</p>
</blockquote>



<a name="185586666"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185586666" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185586666">(Jan 14 2020 at 11:31)</a>:</h4>
<p>jmkrauz <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131923" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131923">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>On arm differences are much bigger, encodings are definitely different.</p>
</blockquote>



<a name="185586687"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185586687" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185586687">(Jan 14 2020 at 11:31)</a>:</h4>
<p>jmkrauz edited a <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131923" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574131923">comment</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>On arm differences are much bigger. Encodings are definitely different.</p>
</blockquote>



<a name="185586872"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185586872" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185586872">(Jan 14 2020 at 11:34)</a>:</h4>
<p>julian-seward1 <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574132850" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574132850">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>arm32 and arm64 are majorly different, both architecturally and at the encoding level.  I'd suggest that attempts to unify them will lead to big problems, and it would be easier to treat them as two completely unrelated architectures.</p>
<p>Also, it's worth being aware that arm32 has two different encodings: the traditional ARM encoding, and the newer Thumb2.  It will be necessary to choose one or the other, and I believe the standard recommendation is to use Thumb2.</p>
</blockquote>



<a name="185619495"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/185619495" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#185619495">(Jan 14 2020 at 17:38)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574289794" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-574289794">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>We're building a new instruction selector infrastructure (#1344), so it would likely be best for new backends to be built once that is ready (the hope is to land it in the next month or two at most!). As part of the work, we're building an ARM64 backend as well; this is quite different from ARM32, as Julian mentions, but it could serve as an example for someone building out an ARM32 backend.</p>
</blockquote>



<a name="186161143"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/186161143" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#186161143">(Jan 21 2020 at 08:01)</a>:</h4>
<p>jmkrauz <a href="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-576562826" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342#issuecomment-576562826">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<p>Ok, I will wait then.</p>
</blockquote>



<a name="189361764"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231342%20arm32%20support/near/189361764" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231342.20arm32.20support.html#189361764">(Feb 28 2020 at 23:28)</a>:</h4>
<p>alexcrichton transferred <a href="https://github.com/bytecodealliance/cranelift/issues/1342" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/1342">Issue #1342</a>:</p>
<blockquote>
<ul>
<li>
<p>What is the feature or code improvement you would like to do in Cranelift?<br>
I would like to add ARM support by implementing ARM (not Thumb) encodings/recipes and abi. I am especially interested in armv7 little endian support.</p>
</li>
<li>
<p>What is the value of adding this in Cranelift?<br>
Emit code that could run on ARM architecture.</p>
</li>
<li>
<p>Do you have an implementation plan, and/or ideas for data structures or<br>
  algorithms to use?<br>
At first i want to add basic integer operations followed by floating point instructions. I thought about implementing the latter using VFP rather than the NEON extension (As far as I know NEON does not support double precision). As for calling convention, I would like to implement AAPCS.<br>
 I already have some code that i hope to push after necessary modifications.</p>
</li>
<li>
<p>Have you considered alternative implementations? If so, how are they better<br>
  or worse than your proposal?<br>
No, but I am open to suggestions.</p>
</li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>