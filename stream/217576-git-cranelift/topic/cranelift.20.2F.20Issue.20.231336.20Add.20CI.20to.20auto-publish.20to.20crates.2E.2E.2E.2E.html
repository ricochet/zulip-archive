<html>
<head><meta charset="utf-8"><title>cranelift / Issue #1336 Add CI to auto-publish to crates.... · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231336.20Add.20CI.20to.20auto-publish.20to.20crates.2E.2E.2E.2E.html">cranelift / Issue #1336 Add CI to auto-publish to crates....</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="185358331"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231336%20Add%20CI%20to%20auto-publish%20to%20crates..../near/185358331" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231336.20Add.20CI.20to.20auto-publish.20to.20crates.2E.2E.2E.2E.html#185358331">(Jan 10 2020 at 22:37)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573233316" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573233316">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/pull/1336" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336">Issue #1336</a>:</p>
<blockquote>
<p>I've tested this out locally with <a href="https://crates.io/crates/alexcrichton-cranelift" target="_blank" title="https://crates.io/crates/alexcrichton-cranelift">my own suite of cranelift crates</a>. The publication step <a href="https://github.com/alexcrichton/cranelift/runs/384203195" target="_blank" title="https://github.com/alexcrichton/cranelift/runs/384203195">looks like this</a> and the PR step <a href="https://github.com/alexcrichton/cranelift/runs/384097249" target="_blank" title="https://github.com/alexcrichton/cranelift/runs/384097249">looks like this</a>.</p>
<p>Note that to merge this we'll need to add a <a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> token to the secret environment variables of this repository. I think the best thing to do is to set up a new user which only controls these crates. That way the token only has access to these crates, no other crates (such as another users's crates if we used one of our own personal tokens). For this purpose I've set up a user <a href="https://github.com/cranelift-auto-publish" target="_blank" title="https://github.com/cranelift-auto-publish">https://github.com/cranelift-auto-publish</a> which now has a <a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> account. If everyone's ok with this setup I'll configure the registry tokens and such before this merges.</p>
</blockquote>



<a name="185358530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231336%20Add%20CI%20to%20auto-publish%20to%20crates..../near/185358530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231336.20Add.20CI.20to.20auto-publish.20to.20crates.2E.2E.2E.2E.html#185358530">(Jan 10 2020 at 22:41)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573234270" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573234270">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/pull/1336" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336">Issue #1336</a>:</p>
<blockquote>
<p>I feel like the two-step process is what is tripping us up right now; is there any way to do the version bump and tagging all in the same PR?</p>
</blockquote>



<a name="185358774"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231336%20Add%20CI%20to%20auto-publish%20to%20crates..../near/185358774" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231336.20Add.20CI.20to.20auto-publish.20to.20crates.2E.2E.2E.2E.html#185358774">(Jan 10 2020 at 22:45)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573235394" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573235394">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/pull/1336" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336">Issue #1336</a>:</p>
<blockquote>
<p>Heh well technically CI allows us to do anything so everything is in the realm of possibility! It's largely just a question of what we want this to look like.</p>
<p>We could possibly forgo the tags entirely, and have a scheme where every merge to master compares versions against <a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> and if they changed the crate is published. I personally like the system of tags myself because it's pretty lightweight but still has a deliberate "this is the thing I'm releasing step", but I'm down for implementing whatever!</p>
</blockquote>



<a name="185359414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231336%20Add%20CI%20to%20auto-publish%20to%20crates..../near/185359414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231336.20Add.20CI.20to.20auto-publish.20to.20crates.2E.2E.2E.2E.html#185359414">(Jan 10 2020 at 22:55)</a>:</h4>
<p>abrown <a href="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573237766" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-573237766">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/pull/1336" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336">Issue #1336</a>:</p>
<blockquote>
<p>I'll defer to @sunfishcode and @bnjbvr since they will likely be the ones doing this type of stuff <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span>.</p>
</blockquote>



<a name="189362345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%231336%20Add%20CI%20to%20auto-publish%20to%20crates..../near/189362345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.231336.20Add.20CI.20to.20auto-publish.20to.20crates.2E.2E.2E.2E.html#189362345">(Feb 28 2020 at 23:36)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-592778437" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336#issuecomment-592778437">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/pull/1336" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1336">Issue #1336</a>:</p>
<blockquote>
<p>I'm gonna close this and we can recreate it later if still necessary on the wasmtime repo.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>