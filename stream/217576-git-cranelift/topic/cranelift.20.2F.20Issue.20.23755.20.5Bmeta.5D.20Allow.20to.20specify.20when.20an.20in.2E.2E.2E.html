<html>
<head><meta charset="utf-8"><title>cranelift / Issue #755 [meta] Allow to specify when an in... · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.23755.20.5Bmeta.5D.20Allow.20to.20specify.20when.20an.20in.2E.2E.2E.html">cranelift / Issue #755 [meta] Allow to specify when an in...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="189361442"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%23755%20%5Bmeta%5D%20Allow%20to%20specify%20when%20an%20in.../near/189361442" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.23755.20.5Bmeta.5D.20Allow.20to.20specify.20when.20an.20in.2E.2E.2E.html#189361442">(Feb 28 2020 at 23:25)</a>:</h4>
<p>alexcrichton transferred <a href="https://github.com/bytecodealliance/cranelift/issues/755" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/755">Issue #755</a> (assigned to bnjbvr):</p>
<blockquote>
<p>Cranelift instructions sometimes have a variant taking an immediate as one operand (e.g. <code>icmp</code> has <code>icmp_imm</code>) or a complex operand (that is, register + shifted register + offset, if I'm not mistaken; see for instance <code>load</code> which has the <code>load_complex</code> variant). These instructions are defined manually, and the <code>simple_preopt</code> pass contains a manual replacement of the normal variant by the immediate variant, for some given functions.</p>
<p>I'd like to implement helpers in the meta-language to signal that a given instruction also has an immediate variant, or a complex one. This would automatically create the new Cranelift instructions with the suffixes, so they're just plain instructions from codegen's point of view. This should allow us to have many more complex encodings (nice for performance), but also more immediate encodings (both would be great to lower register pressure), and hopefully we can have automatically generated code to replace a given instruction by its immediate (as done in simple_preopt) or its complex (as done in postopt) counterpart.</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>