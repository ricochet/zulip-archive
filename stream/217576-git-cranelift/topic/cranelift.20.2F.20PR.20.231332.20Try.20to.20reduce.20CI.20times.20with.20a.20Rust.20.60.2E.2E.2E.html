<html>
<head><meta charset="utf-8"><title>cranelift / PR #1332 Try to reduce CI times with a Rust `... · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html">cranelift / PR #1332 Try to reduce CI times with a Rust `...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="185355323"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355323" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355323">(Jan 10 2020 at 21:51)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/cranelift/pull/1332" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332">PR #1332</a> from <code>wabt-to-wat</code> to <code>master</code>:</p>
<blockquote>
<p>This commit moves the cranelift tests and tools from the <code>wabt</code> crate on<br>
<a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> (which compiles the wabt C++ codebase) to the <code>wat</code> crate on<br>
<a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> which is a Rust parser for the <code>*.wat</code> format. This was<br>
motivated by me noticing that release builds on Windows are ~5 minutes<br>
longer than Linux builds, and local timing graphs showed that <code>wabt-sys</code><br>
was by far the longest build step in the build process.</p>
<p>This commit changes the <code>clif-util</code> binary where the <code>--enable-simd</code><br>
flag is no longer respected with the text format as input, since the<br>
<code>wat</code> crate has no feature gating. This was already sort of not<br>
respected, though, since <code>--enable-simd</code> wasn't consulted for binary<br>
inputs which <code>clif-util</code> supports as well. If this isn't ok though then<br>
it should be ok to close this PR!</p>
</blockquote>



<a name="185355531"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355531" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355531">(Jan 10 2020 at 21:55)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/cranelift/pull/1332" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332">PR #1332</a> from <code>wabt-to-wat</code> to <code>master</code>:</p>
<blockquote>
<p>This commit moves the cranelift tests and tools from the <code>wabt</code> crate on<br>
<a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> (which compiles the wabt C++ codebase) to the <code>wat</code> crate on<br>
<a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> which is a Rust parser for the <code>*.wat</code> format. This was<br>
motivated by me noticing that release builds on Windows are ~5 minutes<br>
longer than Linux builds, and local timing graphs showed that <code>wabt-sys</code><br>
was by far the longest build step in the build process.</p>
<p>This commit changes the <code>clif-util</code> binary where the <code>--enable-simd</code><br>
flag is no longer respected with the text format as input, since the<br>
<code>wat</code> crate has no feature gating. This was already sort of not<br>
respected, though, since <code>--enable-simd</code> wasn't consulted for binary<br>
inputs which <code>clif-util</code> supports as well. If this isn't ok though then<br>
it should be ok to close this PR!</p>
</blockquote>



<a name="185355583"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355583" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355583">(Jan 10 2020 at 21:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/cranelift/pull/1332#discussion_r365446123" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#discussion_r365446123">PR Review Comment</a>:</p>
<blockquote>
<p>It's worth noting here that <code>wat</code> itself has the fallbacks already where if the input file is a wasm binary it won't attempt to parse it as text, it'll just return the raw binary that was read. When I removed the call to <code>read_to_end</code> here it made that a dead function, so I inlined the logic for handling <code>-</code></p>
</blockquote>



<a name="185355584"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355584" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355584">(Jan 10 2020 at 21:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341443409" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341443409">PR Review</a>.</p>



<a name="185355831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355831">(Jan 10 2020 at 21:59)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341444772" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341444772">PR Review</a>.</p>



<a name="185355832"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355832" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355832">(Jan 10 2020 at 21:59)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/cranelift/pull/1332#discussion_r365447076" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#discussion_r365447076">PR Review Comment</a>:</p>
<blockquote>
<p>I think then that we should remove the <code>add_enable_simd_flag</code>, <code>add_enable_multi_value</code>, <code>add_enable_reference_types_flag</code> functions.</p>
</blockquote>



<a name="185355970"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355970" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355970">(Jan 10 2020 at 22:00)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/cranelift/pull/1332" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332">PR #1332</a> from <code>wabt-to-wat</code> to <code>master</code>:</p>
<blockquote>
<p>This commit moves the cranelift tests and tools from the <code>wabt</code> crate on<br>
<a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> (which compiles the wabt C++ codebase) to the <code>wat</code> crate on<br>
<a href="http://crates.io" target="_blank" title="http://crates.io">crates.io</a> which is a Rust parser for the <code>*.wat</code> format. This was<br>
motivated by me noticing that release builds on Windows are ~5 minutes<br>
longer than Linux builds, and local timing graphs showed that <code>wabt-sys</code><br>
was by far the longest build step in the build process.</p>
<p>This commit changes the <code>clif-util</code> binary where the <code>--enable-simd</code><br>
flag is no longer respected with the text format as input, since the<br>
<code>wat</code> crate has no feature gating. This was already sort of not<br>
respected, though, since <code>--enable-simd</code> wasn't consulted for binary<br>
inputs which <code>clif-util</code> supports as well. If this isn't ok though then<br>
it should be ok to close this PR!</p>
</blockquote>



<a name="185355971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355971">(Jan 10 2020 at 22:00)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341445524" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341445524">PR Review</a>.</p>



<a name="185355972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185355972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185355972">(Jan 10 2020 at 22:00)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/cranelift/pull/1332#discussion_r365447597" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#discussion_r365447597">PR Review Comment</a>:</p>
<blockquote>
<p>Done!</p>
</blockquote>



<a name="185357967"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185357967" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185357967">(Jan 10 2020 at 22:31)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341457359" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332#pullrequestreview-341457359">PR Review</a>.</p>



<a name="185358023"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231332%20Try%20to%20reduce%20CI%20times%20with%20a%20Rust%20%60.../near/185358023" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231332.20Try.20to.20reduce.20CI.20times.20with.20a.20Rust.20.60.2E.2E.2E.html#185358023">(Jan 10 2020 at 22:32)</a>:</h4>
<p>abrown merged <a href="https://github.com/bytecodealliance/cranelift/pull/1332" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1332">PR #1332</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>