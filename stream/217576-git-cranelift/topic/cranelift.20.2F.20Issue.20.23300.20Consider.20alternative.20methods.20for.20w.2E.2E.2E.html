<html>
<head><meta charset="utf-8"><title>cranelift / Issue #300 Consider alternative methods for w... · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.23300.20Consider.20alternative.20methods.20for.20w.2E.2E.2E.html">cranelift / Issue #300 Consider alternative methods for w...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="188030997"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%23300%20Consider%20alternative%20methods%20for%20w.../near/188030997" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.23300.20Consider.20alternative.20methods.20for.20w.2E.2E.2E.html#188030997">(Feb 12 2020 at 17:11)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/cranelift/issues/300#issuecomment-585312630" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/300#issuecomment-585312630">commented</a> on <a href="https://github.com/bytecodealliance/cranelift/issues/300" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/300">Issue #300</a>:</p>
<blockquote>
<p>FWIW, this bit me while prototyping ARM64 (see issue <a href="https://github.com/cfallin/cranelift/issues/8" target="_blank" title="https://github.com/cfallin/cranelift/issues/8">cfallin/cranelift#8</a>) -- we should definitely look at safer API options. Perhaps just a ctor that takes a slice, and bounds-checks as it generates? Was the intent of the initial design to avoid the bounds-check overhead?</p>
</blockquote>



<a name="189361336"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20Issue%20%23300%20Consider%20alternative%20methods%20for%20w.../near/189361336" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20Issue.20.23300.20Consider.20alternative.20methods.20for.20w.2E.2E.2E.html#189361336">(Feb 28 2020 at 23:24)</a>:</h4>
<p>alexcrichton transferred <a href="https://github.com/bytecodealliance/cranelift/issues/300" target="_blank" title="https://github.com/bytecodealliance/cranelift/issues/300">Issue #300</a>:</p>
<blockquote>
<p>Currently, binemit has its own <a href="https://docs.rs/cretonne-codegen/0.5.0/cretonne_codegen/binemit/trait.CodeSink.html" target="_blank" title="https://docs.rs/cretonne-codegen/0.5.0/cretonne_codegen/binemit/trait.CodeSink.html">CodeSink</a> trait for writing binary data. It isn't entirely satisfying, in part because it's an unsafe interface -- it doesn't perform bounds checking on the underlying data. While we can provide relatively safe interfaces to protect users from misusing the API, it's harder to be absolutely certain that the number of bytes <code>compile</code> says a function needs is the number of bytes <code>emit_to_memory</code> actually writes for that function.</p>
<p>One option would be to provide a safe checked version of <code>MemoryCodeSink</code>. However, it's also worth considering evaluating available crates that provide low-level byte buffer writing functionality, including:</p>
<ul>
<li><a href="https://crates.io/crates/bytevec" target="_blank" title="https://crates.io/crates/bytevec">https://crates.io/crates/bytevec</a></li>
<li><a href="https://crates.io/crates/bytebuffer" target="_blank" title="https://crates.io/crates/bytebuffer">https://crates.io/crates/bytebuffer</a></li>
<li><a href="https://crates.io/crates/scroll" target="_blank" title="https://crates.io/crates/scroll">https://crates.io/crates/scroll</a></li>
</ul>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>