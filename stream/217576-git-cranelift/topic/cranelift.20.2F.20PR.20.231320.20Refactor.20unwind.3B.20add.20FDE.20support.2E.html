<html>
<head><meta charset="utf-8"><title>cranelift / PR #1320 Refactor unwind; add FDE support. · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html">cranelift / PR #1320 Refactor unwind; add FDE support.</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="185054354"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185054354" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185054354">(Jan 07 2020 at 21:02)</a>:</h4>
<p>yurydelendik opened <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[ ] agree on location for FDE/UNWIND_INFO logic</li>
<li>[ ] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185062266"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062266" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062266">(Jan 07 2020 at 22:34)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339549868" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339549868">PR Review</a>.</p>



<a name="185062267"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062267" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062267">(Jan 07 2020 at 22:34)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339549868" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339549868">PR Review</a>.</p>



<a name="185062268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062268">(Jan 07 2020 at 22:34)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363983856" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363983856">PR Review Comment</a>:</p>
<blockquote>
<p>On macOS DWARF relocations need to be section relative and not symbol relative.</p>
</blockquote>



<a name="185062269"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062269" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062269">(Jan 07 2020 at 22:34)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363984077" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363984077">PR Review Comment</a>:</p>
<blockquote>
<p>Leftover?</p>
</blockquote>



<a name="185062270"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062270" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062270">(Jan 07 2020 at 22:34)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363984671" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363984671">PR Review Comment</a>:</p>
<blockquote>
<p>This only works when compiling for one isa during the full process execution and is not thread safe.</p>
</blockquote>



<a name="185062363"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062363" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062363">(Jan 07 2020 at 22:35)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363985389" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363985389">PR Review Comment</a>:</p>
<blockquote>
<p>Maybe Seh and Dwarf?</p>
</blockquote>



<a name="185062365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062365">(Jan 07 2020 at 22:35)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339551709" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339551709">PR Review</a>.</p>



<a name="185062366"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185062366" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185062366">(Jan 07 2020 at 22:35)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339551709" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339551709">PR Review</a>.</p>



<a name="185063026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185063026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185063026">(Jan 07 2020 at 22:44)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339555470" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339555470">PR Review</a>.</p>



<a name="185063027"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185063027" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185063027">(Jan 07 2020 at 22:44)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363988441" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363988441">PR Review Comment</a>:</p>
<blockquote>
<p>Yes. Currently I'm just looking feedback on API design -- I'll tie ends with FDE support in a day or two.</p>
</blockquote>



<a name="185064041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185064041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185064041">(Jan 07 2020 at 22:58)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[ ] agree on location for FDE/UNWIND_INFO logic</li>
<li>[ ] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185064121"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185064121" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185064121">(Jan 07 2020 at 22:59)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339561440" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339561440">PR Review</a>.</p>



<a name="185064122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185064122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185064122">(Jan 07 2020 at 22:59)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363993161" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363993161">PR Review Comment</a>:</p>
<blockquote>
<p>Not sure if it is applied here: the FDE entry is for <code>__register_frame</code></p>
</blockquote>



<a name="185064433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185064433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185064433">(Jan 07 2020 at 23:02)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[ ] agree on location for FDE/UNWIND_INFO logic</li>
<li>[ ] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185064449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185064449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185064449">(Jan 07 2020 at 23:02)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339562842" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339562842">PR Review</a>.</p>



<a name="185064450"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185064450" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185064450">(Jan 07 2020 at 23:02)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363994312" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363994312">PR Review Comment</a>:</p>
<blockquote>
<p>Changed to <code>Libunwind</code></p>
</blockquote>



<a name="185067711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067711">(Jan 07 2020 at 23:53)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339557402" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339557402">PR Review</a>.</p>



<a name="185067712"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067712" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067712">(Jan 07 2020 at 23:53)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339557402" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339557402">PR Review</a>.</p>



<a name="185067713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067713">(Jan 07 2020 at 23:53)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363989966" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363989966">PR Review Comment</a>:</p>
<blockquote>
<p>Can we derive the kind from the <code>TargetIsa</code> (i.e. internal to its <code>emit_unwind_info</code> implementation) so it doesn't need to be passed in?  I don't particularly see a need for requesting a different kind of unwind info that doesn't match the ISA's calling convention.</p>
</blockquote>



<a name="185067714"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067714" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067714">(Jan 07 2020 at 23:53)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364007645" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364007645">PR Review Comment</a>:</p>
<blockquote>
<p>I think we'll want to pass the sink on down into <code>UnwindInfo::emit</code> so we're not double buffering these bytes (once here and then presumably in the caller's sink impl).</p>
</blockquote>



<a name="185067737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067737">(Jan 07 2020 at 23:53)</a>:</h4>
<p>peterhuene edited <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363989966" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r363989966">PR Review Comment</a>.</p>



<a name="185067843"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067843" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067843">(Jan 07 2020 at 23:55)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364008268" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364008268">PR Review Comment</a>:</p>
<blockquote>
<p>Also, I'm totally open to renaming <code>UnwindInfo</code> so it's more specific to Windows so this gets less confusing.</p>
</blockquote>



<a name="185067844"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185067844" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185067844">(Jan 07 2020 at 23:55)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339580014" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-339580014">PR Review</a>.</p>



<a name="185146835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185146835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185146835">(Jan 08 2020 at 19:17)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340085654" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340085654">PR Review</a>.</p>



<a name="185146836"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185146836" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185146836">(Jan 08 2020 at 19:17)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364398930" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364398930">PR Review Comment</a>:</p>
<blockquote>
<p>Right, but now I need to specify in which format the data was produced. The caller now have to react on type of data it receives.</p>
</blockquote>



<a name="185146857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185146857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185146857">(Jan 08 2020 at 19:17)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364398930" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364398930">PR Review Comment</a>.</p>



<a name="185146921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185146921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185146921">(Jan 08 2020 at 19:18)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340085972" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340085972">PR Review</a>.</p>



<a name="185146923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185146923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185146923">(Jan 08 2020 at 19:18)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364399181" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364399181">PR Review Comment</a>:</p>
<blockquote>
<p>Not an issue atm.</p>
</blockquote>



<a name="185146946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185146946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185146946">(Jan 08 2020 at 19:18)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[ ] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185151756"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185151756" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185151756">(Jan 08 2020 at 20:10)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340115671" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340115671">PR Review</a>.</p>



<a name="185151757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185151757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185151757">(Jan 08 2020 at 20:10)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364421466" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364421466">PR Review Comment</a>:</p>
<blockquote>
<p>I see.  Are you planning on having a sink implementation that differs based on the unwind kind then?</p>
</blockquote>



<a name="185153318"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153318" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153318">(Jan 08 2020 at 20:28)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[ ] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185153327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153327">(Jan 08 2020 at 20:28)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185153503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153503">(Jan 08 2020 at 20:30)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364429070" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364429070">PR Review Comment</a>:</p>
<blockquote>
<p>That's depend on the consumer, but in case of wasmtime, I planned to have one.</p>
</blockquote>



<a name="185153504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153504">(Jan 08 2020 at 20:30)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340125980" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340125980">PR Review</a>.</p>



<a name="185153524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153524">(Jan 08 2020 at 20:30)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364429070" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364429070">PR Review Comment</a>.</p>



<a name="185153733"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153733" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153733">(Jan 08 2020 at 20:33)</a>:</h4>
<p>peterhuene created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364430138" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364430138">PR Review Comment</a>:</p>
<blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="185153734"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185153734" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185153734">(Jan 08 2020 at 20:33)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340127460" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340127460">PR Review</a>.</p>



<a name="185158757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185158757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185158757">(Jan 08 2020 at 21:26)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340153643" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340153643">PR Review</a>.</p>



<a name="185158758"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185158758" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185158758">(Jan 08 2020 at 21:26)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340153643" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340153643">PR Review</a>.</p>



<a name="185158759"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185158759" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185158759">(Jan 08 2020 at 21:26)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364449705" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364449705">PR Review Comment</a>:</p>
<blockquote>
<p>Please check that the isa is x86_64 for both <code>map_reg</code> and <code>RETURN_ADDRESS_REGISTER</code>.</p>
</blockquote>



<a name="185160985"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185160985" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185160985">(Jan 08 2020 at 21:53)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364461711" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364461711">PR Review Comment</a>:</p>
<blockquote>
<p>okay, I probably just need to implement that for X86 too.</p>
</blockquote>



<a name="185160986"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185160986" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185160986">(Jan 08 2020 at 21:53)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340169244" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340169244">PR Review</a>.</p>



<a name="185164708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185164708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185164708">(Jan 08 2020 at 22:34)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185165279"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185165279" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185165279">(Jan 08 2020 at 22:40)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[ ] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185165302"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185165302" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185165302">(Jan 08 2020 at 22:41)</a>:</h4>
<p>yurydelendik edited <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185194917"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185194917" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185194917">(Jan 09 2020 at 09:14)</a>:</h4>
<p>philipc submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340377422" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340377422">PR Review</a>.</p>



<a name="185194918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185194918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185194918">(Jan 09 2020 at 09:14)</a>:</h4>
<p>philipc created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364628029" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r364628029">PR Review Comment</a>:</p>
<blockquote>
<p>You should change this to only enable the "write" feature (also see <a href="https://github.com/gimli-rs/gimli/pull/466" target="_blank" title="https://github.com/gimli-rs/gimli/pull/466">https://github.com/gimli-rs/gimli/pull/466</a> which reduces the number of dependencies for this).</p>
<div class="codehilite"><pre><span></span>gimli = { version = &quot;0.19.0&quot;, default-features = false, features = [&quot;write&quot;], optional = true }
</pre></div>


</blockquote>



<a name="185222823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185222823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185222823">(Jan 09 2020 at 15:36)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185259902"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185259902" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185259902">(Jan 09 2020 at 21:49)</a>:</h4>
<p>peterhuene submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340836759" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-340836759">PR Review</a>.</p>



<a name="185267775"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185267775" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185267775">(Jan 09 2020 at 23:25)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185319028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185319028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185319028">(Jan 10 2020 at 15:20)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185356683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185356683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185356683">(Jan 10 2020 at 22:10)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185356763"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185356763" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185356763">(Jan 10 2020 at 22:12)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185359256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185359256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185359256">(Jan 10 2020 at 22:52)</a>:</h4>
<p>yurydelendik updated <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a> from <code>unwind-fde</code> to <code>master</code>:</p>
<blockquote>
<p>Currently, codegen produces unwind information only for Windows platform. We need to produce this type of information for all platforms to properly produce backtrace. See <a href="https://github.com/bytecodealliance/wasmtime/pull/759" target="_blank" title="https://github.com/bytecodealliance/wasmtime/pull/759">https://github.com/bytecodealliance/wasmtime/pull/759</a></p>
<p>TODO (and requires feedback):</p>
<ul>
<li>[x] use feature to cfg existing unwind logic</li>
<li>[x] agree on location for FDE/UNWIND_INFO logic</li>
<li>[x] borrow reg mapper from #902</li>
</ul>
<p>cc @peterhuene @iximeow </p>
</blockquote>



<a name="185509717"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185509717" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185509717">(Jan 13 2020 at 16:32)</a>:</h4>
<p>yurydelendik merged <a href="https://github.com/bytecodealliance/cranelift/pull/1320" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320">PR #1320</a>.</p>



<a name="185533196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185533196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185533196">(Jan 13 2020 at 20:19)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342113077" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342113077">PR Review</a>.</p>



<a name="185533197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185533197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185533197">(Jan 13 2020 at 20:19)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366008236" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366008236">PR Review Comment</a>:</p>
<blockquote>
<p>I don't think 8-byte absolute relocations are necessarily available for all targets - specifically, as far as I know, MachO objects only permit up to dword-size relocations. This is one of the reasons I used the address encoding <code>SDATA4</code> in #902. Are qword relocations available in MachO targets? If so, I also prefer absolute relocations, but I'd like to not exclude macos here.</p>
</blockquote>



<a name="185533490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185533490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185533490">(Jan 13 2020 at 20:22)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342114664" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342114664">PR Review</a>.</p>



<a name="185533491"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185533491" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185533491">(Jan 13 2020 at 20:22)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366009432" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366009432">PR Review Comment</a>:</p>
<blockquote>
<p>checking that <code>pointer_bits()</code> is 64 is a good call, I'd neglected to think about 32-bit targets. That said, I'll put up a PR to extend these to support i686 register numbers (<code>gimli</code> already has constants for them!).</p>
<p>With 32-bit register numbers, the assert would just be <code>assert!(isa.name() == "x86")</code>, which seems redundant given that this is in isa/<strong>x86</strong>/fde.rs.</p>
</blockquote>



<a name="185533819"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185533819" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185533819">(Jan 13 2020 at 20:26)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342116821" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342116821">PR Review</a>.</p>



<a name="185533820"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185533820" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185533820">(Jan 13 2020 at 20:26)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366011034" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366011034">PR Review Comment</a>:</p>
<blockquote>
<p>other than the register mapping, and possibly code/data alignment, <code>FDE</code> generation is architecture-agnostic. I assume you rather this code in <code>cranelift-codegen</code> for use in wasmtime, but I'd like to have a very clear path to supporting other architectures. Is there another reason this would be in <code>isa/x86/</code>? If not I'd like to move it to somewhere like <code>cranelift-codegen/src/binemit/unwind.rs</code> that is more clearly independent of a specific architecture.</p>
</blockquote>



<a name="185534017"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534017" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534017">(Jan 13 2020 at 20:29)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342117962" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342117962">PR Review</a>.</p>



<a name="185534018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534018">(Jan 13 2020 at 20:29)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366011901" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366011901">PR Review Comment</a>:</p>
<blockquote>
<p>Also on the point of being architecture agnostic, I'd specifically wanted <code>DwarfRegMapper</code> to clearly indicate how to add support for non-x86_64 architectures. You mentioned wanting <code>cranelift-module</code> changed for other reasons, is there something unsuitable about <code>struct DwarfRegMapper</code> in #902? If it was sufficient, and we're just deferring non-x86 thought for the moment, I'd like to revive <code>DwarfRegMapper</code> in a subsequent PR.</p>
</blockquote>



<a name="185534193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534193">(Jan 13 2020 at 20:31)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366012782" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366012782">PR Review Comment</a>:</p>
<blockquote>
<p>I strongly prefer <code>isa::RegUnit</code> here for debugging reasons - going backwards from <code>Register</code> to <code>isa::RegUnit</code>. Does something necessitate this being <code>gimli::Register</code>?</p>
</blockquote>



<a name="185534195"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534195" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534195">(Jan 13 2020 at 20:31)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342119095" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342119095">PR Review</a>.</p>



<a name="185534315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534315">(Jan 13 2020 at 20:32)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342119722" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342119722">PR Review</a>.</p>



<a name="185534316"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534316" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534316">(Jan 13 2020 at 20:32)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366013257" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366013257">PR Review Comment</a>:</p>
<blockquote>
<p>quibble: if <code>X86_64::RA</code> were replaced with <code>return_address_reg(isa)</code>, <code>to_cfi</code> would not have any x86-specific details anymore</p>
</blockquote>



<a name="185534369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534369">(Jan 13 2020 at 20:33)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342120119" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342120119">PR Review</a>.</p>



<a name="185534370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534370">(Jan 13 2020 at 20:33)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366013540" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366013540">PR Review Comment</a>:</p>
<blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>! I'd not thought about basic blocks possibly being out of order in the layout.</p>
</blockquote>



<a name="185534550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534550">(Jan 13 2020 at 20:35)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342121288" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342121288">PR Review</a>.</p>



<a name="185534551"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185534551" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185534551">(Jan 13 2020 at 20:35)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366014477" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366014477">PR Review Comment</a>:</p>
<blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>! I was extremely unsure how to test that #902 generated expected unwind information, other than checking that Lucet could unwind correctly with those patches. This is great, thank you.</p>
</blockquote>



<a name="185535066"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185535066" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185535066">(Jan 13 2020 at 20:40)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342123979" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342123979">PR Review</a>.</p>



<a name="185535067"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185535067" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185535067">(Jan 13 2020 at 20:40)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366016546" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366016546">PR Review Comment</a>:</p>
<blockquote>
<p>I'm not sure if this just snuck by in review or not, but I'd at the very least want an explanation next to this pointer read with why it will be safe. I'd like to replace this with <code>u32::from_le_bytes(bytes.as_slice()[..8].try_into())</code> - since the checks here aren't in a particularly hot path it seems like that shouldn't be an issue?</p>
</blockquote>



<a name="185537251"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185537251" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185537251">(Jan 13 2020 at 21:03)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342136713" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342136713">PR Review</a>.</p>



<a name="185537252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185537252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185537252">(Jan 13 2020 at 21:03)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366026424" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366026424">PR Review Comment</a>:</p>
<blockquote>
<p>This serialization targets specific use case of libunwind (in context of JIT), and it requires FDE in specific format. This PR will not address other use cases.</p>
</blockquote>



<a name="185537393"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185537393" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185537393">(Jan 13 2020 at 21:05)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342137767" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342137767">PR Review</a>.</p>



<a name="185537394"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185537394" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185537394">(Jan 13 2020 at 21:05)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366027204" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366027204">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>the assert would just be assert!(isa.name() == "x86"), which seems redundant given that this is in isa/x86/fde.rs.</p>
</blockquote>
<p>yes, I just wanted to address the reviewer's comment to complete satisfaction and note that function is indeed x86 specific.</p>
</blockquote>



<a name="185537599"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185537599" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185537599">(Jan 13 2020 at 21:07)</a>:</h4>
<p>yurydelendik submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342138822" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342138822">PR Review</a>.</p>



<a name="185537600"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185537600" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185537600">(Jan 13 2020 at 21:07)</a>:</h4>
<p>yurydelendik created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366027977" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366027977">PR Review Comment</a>:</p>
<blockquote>
<p>yep, that's a bug</p>
</blockquote>



<a name="185538603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185538603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185538603">(Jan 13 2020 at 21:17)</a>:</h4>
<p>iximeow submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342144750" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342144750">PR Review</a>.</p>



<a name="185538605"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185538605" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185538605">(Jan 13 2020 at 21:17)</a>:</h4>
<p>iximeow created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366032722" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366032722">PR Review Comment</a>:</p>
<blockquote>
<p>good to know, thank you - I'll be revising #902 to support writing .eh_frame to object files, and I'll make sure to preserve this relocation style.</p>
</blockquote>



<a name="185647858"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185647858" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185647858">(Jan 14 2020 at 22:26)</a>:</h4>
<p>philipc submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342881056" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342881056">PR Review</a>.</p>



<a name="185647859"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185647859" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185647859">(Jan 14 2020 at 22:26)</a>:</h4>
<p>philipc created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366605936" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366605936">PR Review Comment</a>:</p>
<blockquote>
<p>Use <code>eh_frame.0</code> instead of <code>eh_frame.clone()</code>.</p>
</blockquote>



<a name="185648309"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185648309" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185648309">(Jan 14 2020 at 22:31)</a>:</h4>
<p>philipc submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342883315" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#pullrequestreview-342883315">PR Review</a>.</p>



<a name="185648310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231320%20Refactor%20unwind%3B%20add%20FDE%20support./near/185648310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231320.20Refactor.20unwind.3B.20add.20FDE.20support.2E.html#185648310">(Jan 14 2020 at 22:31)</a>:</h4>
<p>philipc created <a href="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366607644" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1320#discussion_r366607644">PR Review Comment</a>:</p>
<blockquote>
<p>This whole thing is fighting against the gimli API a bit. You're using <code>FrameTable</code> to write a single CIE and FDE, and then trying to figure out the FDE offset.</p>
<p>How about if gimli made the CIE/FDE write methods public, and then you can call those methods instead of using <code>FrameTable</code>, and get the FDE offset simply as <code>bytes.len()</code> prior to calling the FDE write?</p>
</blockquote>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>