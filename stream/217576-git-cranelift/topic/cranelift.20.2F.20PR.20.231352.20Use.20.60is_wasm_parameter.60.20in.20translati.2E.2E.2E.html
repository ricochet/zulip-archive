<html>
<head><meta charset="utf-8"><title>cranelift / PR #1352 Use `is_wasm_parameter` in translati... · git-cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/index.html">git-cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html">cranelift / PR #1352 Use `is_wasm_parameter` in translati...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="185847807"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185847807" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185847807">(Jan 16 2020 at 19:04)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a>.</p>



<a name="185847808"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185847808" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185847808">(Jan 16 2020 at 19:04)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a> from <code>filter-more</code> to <code>master</code>:</p>
<blockquote>
<p>Added in #1329 it's now possible for multiple parameters to be non-wasm<br>
parameters, so the previous <code>param_types</code> method is no longer suitable<br>
for acquiring all wasm-related parameters, rather then <code>FuncEnvironment</code><br>
must be consulted. This removes usage of <code>param_types()</code> as a method<br>
from the wasm translation and instead adds a custom method inline for<br>
filtering the parameters based on <code>is_wasm_parameter</code>.</p>
</blockquote>



<a name="185851880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185851880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185851880">(Jan 16 2020 at 19:45)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a> from <code>filter-more</code> to <code>master</code>:</p>
<blockquote>
<p>Added in #1329 it's now possible for multiple parameters to be non-wasm<br>
parameters, so the previous <code>param_types</code> method is no longer suitable<br>
for acquiring all wasm-related parameters, rather then <code>FuncEnvironment</code><br>
must be consulted. This removes usage of <code>param_types()</code> as a method<br>
from the wasm translation and instead adds a custom method inline for<br>
filtering the parameters based on <code>is_wasm_parameter</code>.</p>
</blockquote>



<a name="185852082"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185852082" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185852082">(Jan 16 2020 at 19:47)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a> from <code>filter-more</code> to <code>master</code>:</p>
<blockquote>
<p>Added in #1329 it's now possible for multiple parameters to be non-wasm<br>
parameters, so the previous <code>param_types</code> method is no longer suitable<br>
for acquiring all wasm-related parameters, rather then <code>FuncEnvironment</code><br>
must be consulted. This removes usage of <code>param_types()</code> as a method<br>
from the wasm translation and instead adds a custom method inline for<br>
filtering the parameters based on <code>is_wasm_parameter</code>.</p>
</blockquote>



<a name="185854304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185854304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185854304">(Jan 16 2020 at 20:09)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344183722" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344183722">PR Review</a>.</p>



<a name="185854305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185854305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185854305">(Jan 16 2020 at 20:09)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367625128" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367625128">PR Review Comment</a>:</p>
<blockquote>
<p>Can you comment on why this is <code>mut</code> and <code>Mut</code>? The ultimate function should be a non-mutating predicate.</p>
</blockquote>



<a name="185857159"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185857159" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185857159">(Jan 16 2020 at 20:36)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a> from <code>filter-more</code> to <code>master</code>:</p>
<blockquote>
<p>Added in #1329 it's now possible for multiple parameters to be non-wasm<br>
parameters, so the previous <code>param_types</code> method is no longer suitable<br>
for acquiring all wasm-related parameters, rather then <code>FuncEnvironment</code><br>
must be consulted. This removes usage of <code>param_types()</code> as a method<br>
from the wasm translation and instead adds a custom method inline for<br>
filtering the parameters based on <code>is_wasm_parameter</code>.</p>
</blockquote>



<a name="185857195"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185857195" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185857195">(Jan 16 2020 at 20:36)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344198946" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344198946">PR Review</a>.</p>



<a name="185857197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185857197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185857197">(Jan 16 2020 at 20:36)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367637018" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367637018">PR Review Comment</a>:</p>
<blockquote>
<p>Oh this is mostly just a Rust idioms thing where you idiomatically take <code>FnMut</code> since it's the most flexible. For brevity and simplicity though I've switched this to <code>Fn</code>, since <code>FnMut</code> wasn't actually needed.</p>
</blockquote>



<a name="185857230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185857230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185857230">(Jan 16 2020 at 20:37)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a> from <code>filter-more</code> to <code>master</code>:</p>
<blockquote>
<p>Added in #1329 it's now possible for multiple parameters to be non-wasm<br>
parameters, so the previous <code>param_types</code> method is no longer suitable<br>
for acquiring all wasm-related parameters, rather then <code>FuncEnvironment</code><br>
must be consulted. This removes usage of <code>param_types()</code> as a method<br>
from the wasm translation and instead adds a custom method inline for<br>
filtering the parameters based on <code>is_wasm_parameter</code>.</p>
</blockquote>



<a name="185858304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185858304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185858304">(Jan 16 2020 at 20:49)</a>:</h4>
<p>abrown submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344205963" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344205963">PR Review</a>.</p>



<a name="185858305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185858305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185858305">(Jan 16 2020 at 20:49)</a>:</h4>
<p>abrown created <a href="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367642517" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367642517">PR Review Comment</a>:</p>
<blockquote>
<blockquote>
<p>It's is_wasm_parameter because it isn't counting the number of ArgumentPurpose::Normal parameters. </p>
</blockquote>
<p>@sunfishcode, so the above is a default implementation that embedders are supposed to override?</p>
</blockquote>



<a name="185859369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185859369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185859369">(Jan 16 2020 at 21:00)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344212064" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344212064">PR Review</a>.</p>



<a name="185859371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185859371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185859371">(Jan 16 2020 at 21:00)</a>:</h4>
<p>sunfishcode created <a href="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367647002" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#discussion_r367647002">PR Review Comment</a>:</p>
<blockquote>
<p>Yeah, embedders can override it if they wish. We added this hook because Wasmtime specifically wishes to override it.</p>
</blockquote>



<a name="185951857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185951857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185951857">(Jan 17 2020 at 20:09)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/sunfishcode" target="_blank" title="https://github.com/sunfishcode">sunfishcode</a> for a review on <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a>.</p>



<a name="185952072"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185952072" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185952072">(Jan 17 2020 at 20:11)</a>:</h4>
<p>sunfishcode submitted <a href="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344815964" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352#pullrequestreview-344815964">PR Review</a>.</p>



<a name="185952096"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217576-git-cranelift/topic/cranelift%20/%20PR%20%231352%20Use%20%60is_wasm_parameter%60%20in%20translati.../near/185952096" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GitHub <a href="https://bytecodealliance.github.io/zulip-archive/stream/217576-git-cranelift/topic/cranelift.20.2F.20PR.20.231352.20Use.20.60is_wasm_parameter.60.20in.20translati.2E.2E.2E.html#185952096">(Jan 17 2020 at 20:11)</a>:</h4>
<p>sunfishcode merged <a href="https://github.com/bytecodealliance/cranelift/pull/1352" target="_blank" title="https://github.com/bytecodealliance/cranelift/pull/1352">PR #1352</a>.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>