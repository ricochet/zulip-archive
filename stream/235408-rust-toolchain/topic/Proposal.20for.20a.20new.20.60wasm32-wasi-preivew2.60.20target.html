<html>
<head><meta charset="utf-8"><title>Proposal for a new `wasm32-wasi-preivew2` target · rust-toolchain · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/index.html">rust-toolchain</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html">Proposal for a new `wasm32-wasi-preivew2` target</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="404431356"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404431356" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404431356">(Nov 27 2023 at 15:06)</a>:</h4>
<p>I've opened a <a href="https://github.com/rust-lang/compiler-team/issues/694">MCP on the Rust project</a> for the addition of a new target which would correspond to components</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rust-lang/compiler-team/issues/694" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/fc3576dba06cf5c3bb088d6e18116549915defa3\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323235343538353937306537303432363965656630636162653839383734306332376239393064646563656334303232646135346636643239373437316331342f727573742d6c616e672f636f6d70696c65722d7465616d2f6973737565732f363934)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rust-lang/compiler-team/issues/694" title="New Tier-3 target: `wasm32-wasi-preview2` · Issue #694 · rust-lang/compiler-team">New Tier-3 target: `wasm32-wasi-preview2` · Issue #694 · rust-lang/compiler-team</a></div><div class="message_embed_description">Proposal This is a proposal to add a new Tier 3 target to the Rust compiler named wasm32-wasi-preview2. This new target will be unlike preexisting WebAssembly targets in two major ways: The default...</div></div></div>



<a name="404454248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454248">(Nov 27 2023 at 17:03)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> we already had an MCP accepted for that</p>



<a name="404454262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454262">(Nov 27 2023 at 17:03)</a>:</h4>
<p>let me pull it back up</p>



<a name="404454342"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454342" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454342">(Nov 27 2023 at 17:04)</a>:</h4>
<p><a href="https://github.com/rust-lang/compiler-team/issues/594">https://github.com/rust-lang/compiler-team/issues/594</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rust-lang/compiler-team/issues/594" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/19f4056d9d854488d766d6a3a4838dbd84dcbfd8\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f366562386566363832623865663238653138396464363735356664646133616331636437636438353463343333646465633562656237666230356564363162642f727573742d6c616e672f636f6d70696c65722d7465616d2f6973737565732f353934)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rust-lang/compiler-team/issues/594" title="New tier-2 target for `wasm32-wasi-preview2` · Issue #594 · rust-lang/compiler-team">New tier-2 target for `wasm32-wasi-preview2` · Issue #594 · rust-lang/compiler-team</a></div><div class="message_embed_description">Proposal In 2019 the first version of the WASI spec was released (what we now call "WASI Preview 1"), and support was added to rustc as the tier-2 wasm32-wasi target. The folks working on WASI have...</div></div></div>



<a name="404454383"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454383" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454383">(Nov 27 2023 at 17:04)</a>:</h4>
<p>Unless you're proposing it should actually be a tier-3 supported platform?</p>



<a name="404454420"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454420" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454420">(Nov 27 2023 at 17:04)</a>:</h4>
<p>oh I had forgotten about this and didn't search well enough</p>



<a name="404454467"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454467" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454467">(Nov 27 2023 at 17:05)</a>:</h4>
<p>lemme reread this</p>



<a name="404454780"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454780" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454780">(Nov 27 2023 at 17:06)</a>:</h4>
<p>oh wow right that's a long zulip thread</p>



<a name="404454800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454800">(Nov 27 2023 at 17:07)</a>:</h4>
<p>the only thing it doesn't do is require outputting actual WASI packages - the proposal basically leaves that up to <code>cargo-component</code></p>



<a name="404454865"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454865" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454865">(Nov 27 2023 at 17:07)</a>:</h4>
<p>yeah so coming back to this in my opinion we should walk back the ambitions of this target and probably go through an MCP again</p>



<a name="404454894"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454894" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454894">(Nov 27 2023 at 17:07)</a>:</h4>
<p>I should clarify all of this though and update with respect to that MCP</p>



<a name="404454929"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404454929" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404454929">(Nov 27 2023 at 17:07)</a>:</h4>
<p>Chiefly I think that we should get the compiler output of <code>wasm32-wasi-preview2</code> to be a component, not a core wasm module</p>



<a name="404455024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455024">(Nov 27 2023 at 17:08)</a>:</h4>
<p>That, and being tier 3 to start, is a pretty big difference from the prior and reflects some recent thinking about how it better enables an incremental implementation of the target</p>



<a name="404455052"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455052" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455052">(Nov 27 2023 at 17:08)</a>:</h4>
<p>thanks for pointing this out though and apologies for forgetting about it!</p>



<a name="404455062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455062">(Nov 27 2023 at 17:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> <a href="#narrow/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target/near/404454929">said</a>:</p>
<blockquote>
<p>Chiefly I think that we should get the compiler output of <code>wasm32-wasi-preview2</code> to be a component, not a core wasm module</p>
</blockquote>
<p>strong agree with this, if we think this is practical</p>



<a name="404455084"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455084" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455084">(Nov 27 2023 at 17:08)</a>:</h4>
<p>I do actually disagree that it should be a tier 3 target though</p>



<a name="404455122"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455122" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455122">(Nov 27 2023 at 17:09)</a>:</h4>
<p>We had that discussion as part of accepting the MCP</p>



<a name="404455138"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455138" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455138">(Nov 27 2023 at 17:09)</a>:</h4>
<p>let me rephrase the tier part, this should start as tier 3, get developed, and then move to tier 2 when we're ready</p>



<a name="404455159"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455159" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455159">(Nov 27 2023 at 17:09)</a>:</h4>
<p>I'm wary of over-promising at the beginning when we're still figuring all this out</p>



<a name="404455189"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455189" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455189">(Nov 27 2023 at 17:09)</a>:</h4>
<p>and e.g. want to open the path to incrementally implementing things</p>



<a name="404455226"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455226" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455226">(Nov 27 2023 at 17:09)</a>:</h4>
<p>e.g. to produce a component the thinking is to use a custom linker, not <code>wasm-ld</code>, which is a wrapper around <code>wasm-ld</code> plus more component stuff</p>



<a name="404455333"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455333" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455333">(Nov 27 2023 at 17:10)</a>:</h4>
<p>and we can't reasonably get that to a "perfect" state on day 1, so starting at tier 3 is hopefully going to give some runway to fix bugs and break things before getting to tier 2</p>



<a name="404455353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455353">(Nov 27 2023 at 17:10)</a>:</h4>
<p>the whole time though it should all be usable via <code>-Zbuild-std</code></p>



<a name="404455370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455370">(Nov 27 2023 at 17:10)</a>:</h4>
<p>okay okay</p>



<a name="404455378"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455378" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455378">(Nov 27 2023 at 17:10)</a>:</h4>
<p>I see that argument</p>



<a name="404455422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455422">(Nov 27 2023 at 17:10)</a>:</h4>
<p>I should go reread the dicsussion though to address some of those points</p>



<a name="404455521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455521">(Nov 27 2023 at 17:11)</a>:</h4>
<p>In the accepted proposal we basically made the case that tier 2 was fine, since it was mostly about maybe changing things in the stdlib / targeting a new version of <code>wasi-libc</code></p>



<a name="404455548"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455548" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455548">(Nov 27 2023 at 17:11)</a>:</h4>
<p>But crucially we weren't touching the backend or codegen</p>



<a name="404455641"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455641" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455641">(Nov 27 2023 at 17:12)</a>:</h4>
<p>In your proposal you're explicitly saying that you <em>do</em> want to target the codegen bits, swapping out the linker</p>



<a name="404455653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455653">(Nov 27 2023 at 17:12)</a>:</h4>
<p>yeah if we envision an entirely new binary format output I think it may change the calculus there</p>



<a name="404455670"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455670" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455670">(Nov 27 2023 at 17:12)</a>:</h4>
<p>yeah</p>



<a name="404455685"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455685" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455685">(Nov 27 2023 at 17:12)</a>:</h4>
<p>Yeah, I think that's reasonable</p>



<a name="404455721"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455721" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455721">(Nov 27 2023 at 17:12)</a>:</h4>
<p>ok cool I'll summarize all this in the Zulip thread and edit the proposal as well</p>



<a name="404455735"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455735" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455735">(Nov 27 2023 at 17:13)</a>:</h4>
<p>one more thing</p>



<a name="404455841"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404455841" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404455841">(Nov 27 2023 at 17:13)</a>:</h4>
<p>I think it would be wise that as part of the re-MCP, we make sure we get sign-off on acceptance criteria for when we can bump it to stage 2</p>



<a name="404456119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456119">(Nov 27 2023 at 17:15)</a>:</h4>
<p>To make sure that we can initiative the "bump to tier 2" process by pointing to something which was already accepted, rather than needing to re-engage with the process</p>



<a name="404456155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456155">(Nov 27 2023 at 17:15)</a>:</h4>
<p>makes sense yeah, but I'm not actually sure what that would entail? I wrote up <a href="https://github.com/rust-lang/compiler-team/issues/694">some stuff under "Next Steps"</a> but that's more target-specific rather than project policies, so I'm not sure if we'd want to add anything more there over what is already required of tier 2</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rust-lang/compiler-team/issues/694" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/fc3576dba06cf5c3bb088d6e18116549915defa3\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323235343538353937306537303432363965656630636162653839383734306332376239393064646563656334303232646135346636643239373437316331342f727573742d6c616e672f636f6d70696c65722d7465616d2f6973737565732f363934)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rust-lang/compiler-team/issues/694" title="New Tier-3 target: `wasm32-wasi-preview2` · Issue #694 · rust-lang/compiler-team">New Tier-3 target: `wasm32-wasi-preview2` · Issue #694 · rust-lang/compiler-team</a></div><div class="message_embed_description">Proposal This is a proposal to add a new Tier 3 target to the Rust compiler named wasm32-wasi-preview2. This new target will be unlike preexisting WebAssembly targets in two major ways: The default...</div></div></div>



<a name="404456337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456337">(Nov 27 2023 at 17:16)</a>:</h4>
<p>oh okay, fair enough</p>



<a name="404456418"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456418" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456418">(Nov 27 2023 at 17:16)</a>:</h4>
<p>I'll make sure to note this in the discussion though</p>



<a name="404456425"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456425" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456425">(Nov 27 2023 at 17:17)</a>:</h4>
<p>I guess I'm coming at this from having put in significant work to get the MCP to be tier 2 lol</p>



<a name="404456444"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456444" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456444">(Nov 27 2023 at 17:17)</a>:</h4>
<p>that "Next Steps" is intended to be a set of criteria for tier 2</p>



<a name="404456459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456459">(Nov 27 2023 at 17:17)</a>:</h4>
<p>So maybe I'm a little scarred going into this, being a bit wary of re-doing the entire discussion</p>



<a name="404456491"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404456491" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404456491">(Nov 27 2023 at 17:17)</a>:</h4>
<p>no that's a good point and I want to learn from that heh</p>



<a name="404459370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404459370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404459370">(Nov 27 2023 at 17:35)</a>:</h4>
<p>ok I think I've noted in the places with updates, but lemme know if I missed anything</p>



<a name="404459398"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404459398" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404459398">(Nov 27 2023 at 17:35)</a>:</h4>
<p>or if you'd recommend making wording stronger anywhere or similar</p>



<a name="404461419"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404461419" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404461419">(Nov 27 2023 at 17:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="594829">Denys Zadorozhnyi</span> has marked this topic as resolved.</p>



<a name="404461433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404461433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404461433">(Nov 27 2023 at 17:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="594829">Denys Zadorozhnyi</span> has marked this topic as unresolved.</p>



<a name="404476400"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404476400" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christof Petig <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404476400">(Nov 27 2023 at 19:28)</a>:</h4>
<p>My understanding is that the binary version of components will change once the component model is accepted as stable, basically rendering all tooling incompatible over night - is this going to be part of 1.0? <br>
I fear that until then, given enough popularity of preview2, everybody became used to the temporary version number - and it becomes the new de-facto binary standard.</p>



<a name="404476940"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/235408-rust-toolchain/topic/Proposal%20for%20a%20new%20%60wasm32-wasi-preivew2%60%20target/near/404476940" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/235408-rust-toolchain/topic/Proposal.20for.20a.20new.20.60wasm32-wasi-preivew2.60.20target.html#404476940">(Nov 27 2023 at 19:32)</a>:</h4>
<p>You're right that the version number will change, and I'm told by Luke that this is the same transition that core wasm itself went through. The current vision is that the version number will change but no other changes will be made, so binary parsers can validate that either the spec-defined version is present or the version just-before stabilization. So in that sense everything won't break overnight, there will be a long period where existing parsers will accept both</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>