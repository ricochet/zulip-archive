<html>
<head><meta charset="utf-8"><title>Basic hello-wasi-http-js sample from ground up · jco · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/index.html">jco</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html">Basic hello-wasi-http-js sample from ground up</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="416788028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788028">(Jan 19 2024 at 14:22)</a>:</h4>
<p>OK, bear with me, but I want to use javascript (NOT my language, though easy learn) to create a wasi:http component for preview 2. I can do custom wit components easily enough using this sample: <a href="https://github.com/bytecodealliance/ComponentizeJS/blob/main/EXAMPLE.md">https://github.com/bytecodealliance/ComponentizeJS/blob/main/EXAMPLE.md</a>. What is done up front is to take a .wit file and then implement the function listed there, nothing fancy. So far so good. So I have the wasi wit block in a repo.... But I need to understand the <em>binding step</em> for js. In the example above, you merely reference <code>hello</code> and then implement <code>hello</code> and call <code>jco componentize</code> and you have a component.</p>



<a name="416788049"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788049" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788049">(Jan 19 2024 at 14:22)</a>:</h4>
<p>But that's custom wit.</p>



<a name="416788254"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788254" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788254">(Jan 19 2024 at 14:24)</a>:</h4>
<p>so for wasi:http, do I need to implement this?</p>



<a name="416788272"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788272" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788272">(Jan 19 2024 at 14:24)</a>:</h4>
<p>interface incoming-handler {<br>
  use types.{incoming-request, response-outparam};</p>
<p>/// This function is invoked with an incoming HTTP Request, and a resource<br>
  /// <code>response-outparam</code> which provides the capability to reply with an HTTP<br>
  /// Response. The response is sent by calling the <code>response-outparam.set</code><br>
  /// method, which allows execution to continue after the response has been<br>
  /// sent. This enables both streaming to the response body, and performing other<br>
  /// work.<br>
  ///<br>
  /// The implementor of this function must write a response to the<br>
  /// <code>response-outparam</code> before returning, or else the caller will respond<br>
  /// with an error on its behalf.<br>
  handle: func(<br>
    request: incoming-request,<br>
    response-out: response-outparam<br>
  );<br>
}</p>



<a name="416788640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788640">(Jan 19 2024 at 14:26)</a>:</h4>
<p>what I'm missing as a newbie here is the <em>binding mechanism</em> between the WIT function " and the js needed to implement it. Do I simply "implement the function" name, as I can do with the above <code>hello</code> function?</p>



<a name="416788726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788726">(Jan 19 2024 at 14:26)</a>:</h4>
<p>or is there a js binding generator for wasi:http/proxy that I need to locate and them merely "import" the types to use?</p>



<a name="416788766"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416788766" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416788766">(Jan 19 2024 at 14:27)</a>:</h4>
<p>i get that concept, and I'm golden here.</p>



<a name="416798622"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416798622" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416798622">(Jan 19 2024 at 15:14)</a>:</h4>
<p>wait, are these they: do I just need to reference them in the package.json?</p>



<a name="416798625"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416798625" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416798625">(Jan 19 2024 at 15:14)</a>:</h4>
<p>},<br>
  "devDependencies": {<br>
    "@bytecodealliance/jco": "^0.14.2",<br>
    "@bytecodealliance/preview2-shim": "^0.14.2",</p>



<a name="416800433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416800433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416800433">(Jan 19 2024 at 15:23)</a>:</h4>
<p>I'm not sure if the shim includes wasi-http but in general yes, you add jco to your devDependencies and preview2-shim to your dependencies and then jco transpile'd components "just work" but as I said I only use preview2, I didn't follow. the wasi-http changes yet</p>



<a name="416801501"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416801501" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416801501">(Jan 19 2024 at 15:27)</a>:</h4>
<p>I'm on preview 12_05, so that's fine</p>



<a name="416802653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416802653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416802653">(Jan 19 2024 at 15:33)</a>:</h4>
<p>sorry for not using</p>



<a name="416802689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416802689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416802689">(Jan 19 2024 at 15:33)</a>:</h4>
<div class="codehilite" data-code-language="code"><pre><span></span><code>
</code></pre></div>



<a name="416843011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416843011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Guy Bedford <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416843011">(Jan 19 2024 at 18:33)</a>:</h4>
<p>in terms of the JS to define to componentize, you'd want to write a JS file like:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">incomingHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">handle</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span><span class="w"> </span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">};</span>
</code></pre></div>
<p>we do have an example of using outgoing handler in ComponentizeJS in <a href="https://github.com/bytecodealliance/jco/blob/main/test/fixtures/componentize/wasi-http-proxy/source.js">https://github.com/bytecodealliance/jco/blob/main/test/fixtures/componentize/wasi-http-proxy/source.js</a> although it doesn't contain the incoming handler currently, so you'd need to check the types to figure it out.</p>
<p>Generating template JS / TypeScript bindings for these ComponentizeJS workflows has been a TODO for a while... agreed it should be a thing.</p>



<a name="416849056"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416849056" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416849056">(Jan 19 2024 at 19:08)</a>:</h4>
<p>thanks Guy; if I've imported preview2-shim and npm intalled, I seem to get the incomingHandler type and it resolves, so hopefully that's really all I need to do.....</p>



<a name="416849304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416849304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416849304">(Jan 19 2024 at 19:10)</a>:</h4>
<p>when you say generating bindings, what do you mean that's not:<br>
<a href="/user_uploads/15107/sc1y3mfmySJmTeJ4TKEI1DkU/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/15107/sc1y3mfmySJmTeJ4TKEI1DkU/image.png" title="image.png"><img src="/user_uploads/15107/sc1y3mfmySJmTeJ4TKEI1DkU/image.png"></a></div>



<a name="416850136"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850136" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Guy Bedford <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850136">(Jan 19 2024 at 19:15)</a>:</h4>
<p>that looks right, although in ComponentizeJS the bindings have a different import convention - <code>import 'wasi:http@0.2.0-rc-2024-01-16/incoming-handler</code> etc instead</p>



<a name="416850278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Guy Bedford <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850278">(Jan 19 2024 at 19:16)</a>:</h4>
<p>but if you are just having this import for IDE types to work out making it an <code>import type { IncomingHandler } from '@bytecodealliance/preview2/http'</code> might make sense with <code>tsc</code> itself stripping that out</p>



<a name="416850348"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850348" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850348">(Jan 19 2024 at 19:16)</a>:</h4>
<p>at least with jco transpile, it does put the .d.ts files in the right locations and IDEs can just autocomplete imports</p>



<a name="416850427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Guy Bedford <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850427">(Jan 19 2024 at 19:17)</a>:</h4>
<p>yeah so if we had something similar for ComponentizeJS it might be useful to generate types that work for authoring components to arbitrary WIT</p>



<a name="416850489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850489">(Jan 19 2024 at 19:17)</a>:</h4>
<p>well, from my position I've been building all the wasi:http languages as best I can</p>



<a name="416850660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850660">(Jan 19 2024 at 19:18)</a>:</h4>
<p>I have dan's rust, Joe's go, and Joel's Python implementations of incomingHandler(). So here I am, wanting to make a JavaScript incomingHandler() impl for comparison.</p>



<a name="416850711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850711">(Jan 19 2024 at 19:19)</a>:</h4>
<p>but I couldn't figure out where to get the .js/.ts types for wasi:http</p>



<a name="416850888"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416850888" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416850888">(Jan 19 2024 at 19:20)</a>:</h4>
<p>npm install preview2-shim gave them to me, which sure seemed easy to me......</p>



<a name="416851133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851133">(Jan 19 2024 at 19:21)</a>:</h4>
<p>but note, once I have this running I'll be at the point where I need to create a module from the .js (with spidermonkey) and then I can make that module a component.</p>



<a name="416851291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851291">(Jan 19 2024 at 19:22)</a>:</h4>
<p>I think that's where componentizeJS comes in, it should implement the "make a component out of a js file and spidermonkey" step</p>



<a name="416851404"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851404" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851404">(Jan 19 2024 at 19:23)</a>:</h4>
<p>that's what I think, too, but isn't jco component that comment?</p>



<a name="416851412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851412">(Jan 19 2024 at 19:23)</a>:</h4>
<p>command?</p>



<a name="416851447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851447">(Jan 19 2024 at 19:23)</a>:</h4>
<p>because help says that YOU MUST have a component on the argument line</p>



<a name="416851558"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851558" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851558">(Jan 19 2024 at 19:24)</a>:</h4>
<p>yeah I also was confused, from the docs both implement the same, <span class="user-mention" data-user-id="553681">@Guy Bedford</span> probably needs to answer that</p>



<a name="416851576"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851576" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851576">(Jan 19 2024 at 19:24)</a>:</h4>
<p>whoops, no, I'm wrong</p>



<a name="416851582"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851582" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851582">(Jan 19 2024 at 19:24)</a>:</h4>
<p>apologies</p>



<a name="416851786"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851786" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851786">(Jan 19 2024 at 19:25)</a>:</h4>
<p>It appears I need to: <code>jco componentize -w &lt;path&gt; -o hello-wasi-http-js.wasm index.js</code></p>



<a name="416851793"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851793" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851793">(Jan 19 2024 at 19:25)</a>:</h4>
<p>transpile takes a component and turns that into browser and node-compatible js, componentize seems to implement the same as componentizeJS does, if going by the docs?</p>



<a name="416851803"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851803" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851803">(Jan 19 2024 at 19:25)</a>:</h4>
<p>and that should work</p>



<a name="416851927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851927">(Jan 19 2024 at 19:26)</a>:</h4>
<p>yeah, just working over Guy's stuff so I can complain because he and wassim and yosh and others worked so hard</p>



<a name="416851930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851930">(Jan 19 2024 at 19:26)</a>:</h4>
<p>:-)</p>



<a name="416851973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416851973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416851973">(Jan 19 2024 at 19:26)</a>:</h4>
<p>goint to give this a try</p>



<a name="416852010"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416852010" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416852010">(Jan 19 2024 at 19:26)</a>:</h4>
<p>if it works, I'm going to drink and tell Guy it's amazing</p>



<a name="416852268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/416852268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#416852268">(Jan 19 2024 at 19:28)</a>:</h4>
<p>it was a weird feeling the first time I ran my own pyo3+python based example in a browser, it's impressive how far the component model has come :)</p>



<a name="483985273"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483985273" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483985273">(Nov 22 2024 at 20:22)</a>:</h4>
<p><span class="user-mention" data-user-id="268586">@Ralph</span> Do you have your example hosted somewhere? I'm also struggling to know the correct implementation for my incoming request handler response object.</p>



<a name="483985460"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483985460" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483985460">(Nov 22 2024 at 20:23)</a>:</h4>
<p>Oh geez, I'll look for it. But I bet <span class="user-mention" data-user-id="553681">@Guy Bedford</span> or <span class="user-mention" data-user-id="763150">@Tomasz Andrzejak</span> has one newer</p>



<a name="483985529"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483985529" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483985529">(Nov 22 2024 at 20:24)</a>:</h4>
<p>That was a while back</p>



<a name="483986145"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986145" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986145">(Nov 22 2024 at 20:28)</a>:</h4>
<p>Thanks, I just found it at <a href="https://github.com/squillace/hello-wasi-http">https://github.com/squillace/hello-wasi-http</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/squillace/hello-wasi-http" style="background-image: url(&quot;https://uploads.zulipusercontent.net/c24ad6092db1b8b1ba43cef0db13a1d64c5b9833/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333738316666633737383363386533633263656566383634393361313037613033393561663565346336613733373765306639323138396436373035643364652f737175696c6c6163652f68656c6c6f2d776173692d68747470&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/squillace/hello-wasi-http" title="GitHub - squillace/hello-wasi-http: simple repo to demonstrate how to debug Rust wasm components with wasmtime">GitHub - squillace/hello-wasi-http: simple repo to demonstrate how to debug Rust wasm components with wasmtime</a></div><div class="message_embed_description">simple repo to demonstrate how to debug Rust wasm components with wasmtime - squillace/hello-wasi-http</div></div></div>



<a name="483986243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986243">(Nov 22 2024 at 20:29)</a>:</h4>
<p>Rust is easy</p>



<a name="483986253"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986253" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986253">(Nov 22 2024 at 20:29)</a>:</h4>
<p>Javascript is FUN</p>



<a name="483986263"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986263" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986263">(Nov 22 2024 at 20:29)</a>:</h4>
<p>Python is FUN</p>



<a name="483986274"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986274" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986274">(Nov 22 2024 at 20:29)</a>:</h4>
<p>Rust... Boring</p>



<a name="483986286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986286">(Nov 22 2024 at 20:29)</a>:</h4>
<p>haha yeah, sorry. I copied wrong tab <a href="https://github.com/squillace/hello-wasi-http-js">https://github.com/squillace/hello-wasi-http-js</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/squillace/hello-wasi-http-js" style="background-image: url(&quot;https://uploads.zulipusercontent.net/f0266686e7955ca76fc943c03d8027340704514e/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f366464653336393363396131393462653535316132343439623866303761616133363139343234303064373936396338333565613631343264636638323366332f737175696c6c6163652f68656c6c6f2d776173692d687474702d6a73&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/squillace/hello-wasi-http-js" title="GitHub - squillace/hello-wasi-http-js: hello world for wasi-http using js and jco">GitHub - squillace/hello-wasi-http-js: hello world for wasi-http using js and jco</a></div><div class="message_embed_description">hello world for wasi-http using js and jco. Contribute to squillace/hello-wasi-http-js development by creating an account on GitHub.</div></div></div>



<a name="483986560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986560">(Nov 22 2024 at 20:31)</a>:</h4>
<p>That's old</p>



<a name="483986561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986561">(Nov 22 2024 at 20:31)</a>:</h4>
<p>Ill iterate on this and see what I can get</p>



<a name="483986577"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986577" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986577">(Nov 22 2024 at 20:31)</a>:</h4>
<p>Hope it works</p>



<a name="483986625"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986625" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986625">(Nov 22 2024 at 20:31)</a>:</h4>
<blockquote>
<p>That's old<br>
do you have a newer example? :D (hope builds)</p>
</blockquote>



<a name="483986663"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986663" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986663">(Nov 22 2024 at 20:31)</a>:</h4>
<p>Now a days of ask <span class="user-mention" data-user-id="763150">@Tomasz Andrzejak</span> because he's supposed to teach me how it's done</p>



<a name="483986745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986745">(Nov 22 2024 at 20:32)</a>:</h4>
<p>But I think he's asleep now</p>



<a name="483986779"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986779" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986779">(Nov 22 2024 at 20:32)</a>:</h4>
<p>Il send a new one soon or get him to do it</p>



<a name="483986849"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986849" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986849">(Nov 22 2024 at 20:32)</a>:</h4>
<p>But it's Friday night in Europe so I'm buzzed and I'm on my way to drunk</p>



<a name="483986864"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483986864" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483986864">(Nov 22 2024 at 20:32)</a>:</h4>
<p>Do forgive me</p>



<a name="483988248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/483988248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#483988248">(Nov 22 2024 at 20:42)</a>:</h4>
<p>enjoy your night! thanks <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span></p>



<a name="484280949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484280949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484280949">(Nov 25 2024 at 12:03)</a>:</h4>
<p>Hey a bit late, but <code>jco</code> has an examples folder now with some examples that you might found useful:</p>
<p><a href="https://github.com/bytecodealliance/jco/tree/main/examples/components">https://github.com/bytecodealliance/jco/tree/main/examples/components</a></p>
<p>There absolutely should be a HTTP hello world example in there as well but there isn't (yet), but you can use the one from wasmcloud as a stand-in!</p>
<p><a href="https://github.com/wasmCloud/wasmCloud/tree/main/examples/typescript/components/http-hello-world">https://github.com/wasmCloud/wasmCloud/tree/main/examples/typescript/components/http-hello-world</a></p>
<p>Written in TS, but you can obviously remove the transpilation steps :)</p>
<p>No need to use wasmCloud either -- if you reference the <code>package.json</code> you can see the jco build command!</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/tree/main/examples/components" style="background-image: url(&quot;https://uploads.zulipusercontent.net/69996b768baddc5d6e6e87fa3b05c88cbedf830f/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f653036643133373237386239366233613365343232613961313030356239343030323731396432373466303530636565303738313538626535343139376463362f62797465636f6465616c6c69616e63652f6a636f&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/tree/main/examples/components" title="jco/examples/components at main · bytecodealliance/jco">jco/examples/components at main · bytecodealliance/jco</a></div><div class="message_embed_description">JavaScript toolchain for working with WebAssembly Components - bytecodealliance/jco</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/wasmCloud/wasmCloud/tree/main/examples/typescript/components/http-hello-world" style="background-image: url(&quot;https://uploads.zulipusercontent.net/16762fc1438fdc6db4a0ad2e5782897700aa9a1f/68747470733a2f2f7265706f7369746f72792d696d616765732e67697468756275736572636f6e74656e742e636f6d2f3330343430333639322f31643761333062662d366433642d346161312d386663322d333663623031303938346463&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/wasmCloud/wasmCloud/tree/main/examples/typescript/components/http-hello-world" title="wasmCloud/examples/typescript/components/http-hello-world at main · wasmCloud/wasmCloud">wasmCloud/examples/typescript/components/http-hello-world at main · wasmCloud/wasmCloud</a></div><div class="message_embed_description">wasmCloud is an open source Cloud Native Computing Foundation (CNCF) project that enables teams to build, manage, and scale polyglot apps across any cloud, K8s, or edge. - wasmCloud/wasmCloud</div></div></div>



<a name="484337745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484337745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484337745">(Nov 25 2024 at 15:57)</a>:</h4>
<p>Victor thank you so much!</p>



<a name="484426092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484426092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484426092">(Nov 26 2024 at 03:01)</a>:</h4>
<p>Maybe im missing so js knowledge, but where do the object definitions come from? I see in the example you linked the type files referenced, but there is no implementation library included. Are these somehow fulfilled by the wasmCloud runtime? Else im not seeing how it would work as is</p>



<a name="484427756"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484427756" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484427756">(Nov 26 2024 at 03:20)</a>:</h4>
<p>looks like the preview shim implements them, <a href="https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/http.js#L605">https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/http.js#L605</a><br>
but it isn't in the dependency list of the pkg.json file at <a href="https://github.com/wasmCloud/wasmCloud/blob/main/examples/typescript/components/http-hello-world/package.json">https://github.com/wasmCloud/wasmCloud/blob/main/examples/typescript/components/http-hello-world/package.json</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/http.js#L605" style="background-image: url(&quot;https://uploads.zulipusercontent.net/78ae1ad324b1a4e09506c864aa04a6390220c06d/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f366231376363316333663761656339646261303639323665386366653533653038643931376233306637666334666331373165353433643636363638663032362f62797465636f6465616c6c69616e63652f6a636f&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/http.js#L605" title="jco/packages/preview2-shim/lib/nodejs/http.js at main · bytecodealliance/jco">jco/packages/preview2-shim/lib/nodejs/http.js at main · bytecodealliance/jco</a></div><div class="message_embed_description">JavaScript toolchain for working with WebAssembly Components - bytecodealliance/jco</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/wasmCloud/wasmCloud/blob/main/examples/typescript/components/http-hello-world/package.json" style="background-image: url(&quot;https://uploads.zulipusercontent.net/16762fc1438fdc6db4a0ad2e5782897700aa9a1f/68747470733a2f2f7265706f7369746f72792d696d616765732e67697468756275736572636f6e74656e742e636f6d2f3330343430333639322f31643761333062662d366433642d346161312d386663322d333663623031303938346463&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/wasmCloud/wasmCloud/blob/main/examples/typescript/components/http-hello-world/package.json" title="wasmCloud/examples/typescript/components/http-hello-world/package.json at main · wasmCloud/wasmCloud">wasmCloud/examples/typescript/components/http-hello-world/package.json at main · wasmCloud/wasmCloud</a></div><div class="message_embed_description">wasmCloud is an open source Cloud Native Computing Foundation (CNCF) project that enables teams to build, manage, and scale polyglot apps across any cloud, K8s, or edge. - wasmCloud/wasmCloud</div></div></div>



<a name="484429196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484429196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484429196">(Nov 26 2024 at 03:39)</a>:</h4>
<p>it looks like jco arg <code>--preview2-adapter &lt;adapter&gt;  provide a custom preview2 adapter path</code> hints that it will fulfill the shim for me, but it isnt happening</p>



<a name="484445097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445097">(Nov 26 2024 at 06:57)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="782420">@Tylr</span> sorry a bit late here, but what happens is that <code>jco types</code> will generate a type signature given the WIT interface that is specified/passed in</p>



<a name="484445227"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445227" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445227">(Nov 26 2024 at 06:58)</a>:</h4>
<p>The types that are defined there are a result of building a preview2 component, which adds relevant functionality -- the imports and usage are baked into the binary itself, and when the component is <em>run</em>, they are patched in/used.</p>



<a name="484445304"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445304" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445304">(Nov 26 2024 at 06:59)</a>:</h4>
<p>hmm, I'll keep trying some variations. I get class undefined when using jco serve, or wasmtime serve</p>



<a name="484445318"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445318" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445318">(Nov 26 2024 at 06:59)</a>:</h4>
<p>So for example, if you run <code>wasmtime serve ...</code> with a component, the wasmtime script is responsible for <em>adding</em> the implementations of preview2 APIs. </p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/main/src/commands/serve.rs#L316">https://github.com/bytecodealliance/wasmtime/blob/main/src/commands/serve.rs#L316</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/main/src/commands/serve.rs#L316" style="background-image: url(&quot;https://uploads.zulipusercontent.net/297e6f5b492b8a45ee184bf230a78ad05bfc9f97/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f626166663033353730623234356464616438633937333637313736386666636666653562393839666661393538326238366332663861356561316565336132332f62797465636f6465616c6c69616e63652f7761736d74696d65&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/main/src/commands/serve.rs#L316" title="wasmtime/src/commands/serve.rs at main · bytecodealliance/wasmtime">wasmtime/src/commands/serve.rs at main · bytecodealliance/wasmtime</a></div><div class="message_embed_description">A fast and secure runtime for WebAssembly. Contribute to bytecodealliance/wasmtime development by creating an account on GitHub.</div></div></div>



<a name="484445368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445368">(Nov 26 2024 at 06:59)</a>:</h4>
<p>Hmnn that's really odd -- could you post the error/a repo I can poke around in, if it's something you can share?</p>



<a name="484445477"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445477" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445477">(Nov 26 2024 at 07:00)</a>:</h4>
<p>yes, one sec, switching computers</p>



<a name="484445708"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484445708" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484445708">(Nov 26 2024 at 07:02)</a>:</h4>
<p>Also, doing it in pure JS might be the easiest way to start -- this is something we don't have an example for on the JCO side but it would certainly reduce complexity to start -- would be great if you could contribute that after we're done tinkering</p>



<a name="484446315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484446315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484446315">(Nov 26 2024 at 07:07)</a>:</h4>
<p>i had started with just js, but kept getting errors and the same class undefined</p>



<a name="484446412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484446412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484446412">(Nov 26 2024 at 07:08)</a>:</h4>
<p>the current state; <a href="https://github.com/tylerhjones/wasm-lambda">https://github.com/tylerhjones/wasm-lambda</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/tylerhjones/wasm-lambda" style="background-image: url(&quot;https://uploads.zulipusercontent.net/2b0eb812b8bba361e0b9daf077dad3c2138abe73/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f616266613339303665633035356166303762643432613336656231333939633930383963363131353536643837373632353232396330623464336262323231652f74796c6572686a6f6e65732f7761736d2d6c616d626461&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/tylerhjones/wasm-lambda" title="GitHub - tylerhjones/wasm-lambda">GitHub - tylerhjones/wasm-lambda</a></div><div class="message_embed_description">Contribute to tylerhjones/wasm-lambda development by creating an account on GitHub.</div></div></div>



<a name="484447463"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484447463" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484447463">(Nov 26 2024 at 07:18)</a>:</h4>
<p>i reset back to the same setup you had in the example, but ive broken / missed something still and get an error from wizer.</p>



<a name="484447592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484447592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484447592">(Nov 26 2024 at 07:19)</a>:</h4>
<p>Hey cranking on it right now</p>



<a name="484447611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484447611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484447611">(Nov 26 2024 at 07:19)</a>:</h4>
<p>Will have a PR up to your repo soon that details how to get everything set up!</p>



<a name="484449079"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484449079" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484449079">(Nov 26 2024 at 07:32)</a>:</h4>
<p>appreciate  the help, but ive gotta sleep <span aria-label="smiling face with tear" class="emoji emoji-1f972" role="img" title="smiling face with tear">:smiling_face_with_tear:</span> ill have to check in again in the morning</p>



<a name="484449131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484449131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484449131">(Nov 26 2024 at 07:32)</a>:</h4>
<p>No worries! Will make the PR and put it up to your repo :)</p>



<a name="484451712"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484451712" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484451712">(Nov 26 2024 at 07:52)</a>:</h4>
<p>Not sure if you're still up but done:</p>
<p><a href="https://github.com/tylerhjones/wasm-lambda/pull/1">https://github.com/tylerhjones/wasm-lambda/pull/1</a></p>
<p>Works on my machine <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/tylerhjones/wasm-lambda/pull/1" style="background-image: url(&quot;https://uploads.zulipusercontent.net/07bb54edc7588554825fce12c261f1efb3177af2/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f613834393166343335613631653033663336313137616663383262353765336233613863346633373835363364326336313633383731333765643239643031352f74796c6572686a6f6e65732f7761736d2d6c616d6264612f70756c6c2f31&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/tylerhjones/wasm-lambda/pull/1" title="refactor: fill out working example by vados-cosmonic · Pull Request #1 · tylerhjones/wasm-lambda">refactor: fill out working example by vados-cosmonic · Pull Request #1 · tylerhjones/wasm-lambda</a></div><div class="message_embed_description">This commit adds a working example of a HTTP handler and some docs to go with it.</div></div></div>



<a name="484614392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484614392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484614392">(Nov 26 2024 at 23:42)</a>:</h4>
<p>When i try to componentize the js target I get an error about a duplicate export,</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">js_wasm_lambda</span><span class="o">@</span><span class="mf">1.0.0</span><span class="w"> </span><span class="n">build</span><span class="p">:</span><span class="nc">js</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">jco</span><span class="w"> </span><span class="n">componentize</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">wit</span><span class="o">/</span><span class="w"> </span><span class="o">--</span><span class="n">world</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">dist</span><span class="o">/</span><span class="n">component</span><span class="p">.</span><span class="n">wasm</span><span class="w"> </span><span class="n">dist</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">js</span>

<span class="p">(</span><span class="n">jco</span><span class="w"> </span><span class="n">componentize</span><span class="p">)</span><span class="w"> </span><span class="n">ComponentError</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">module</span>
<span class="cp">$failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">validate</span><span class="w"> </span><span class="n">component</span><span class="w"> </span><span class="n">output</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span><span class="p">:</span>
<span class="w">    </span><span class="nc">duplicate</span><span class="w"> </span><span class="n">export</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="err">`</span><span class="mi">39</span><span class="err">`</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="p">(</span><span class="n">at</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="mh">0xab351c</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">componentNew</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">:</span><span class="sd">///app/node_modules/@bytecodealliance/jco/obj/wasm-tools.js:3618:11)</span>
</code></pre></div>



<a name="484616471"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484616471" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484616471">(Nov 27 2024 at 00:04)</a>:</h4>
<p>If I add code to the jco src/api.js <code>componentNew</code> function and have it write the given binary to a file and use wasm-tools after to inspect the binary it received as an argument, I see the following exports.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"memory"</span><span class="w"> </span><span class="p">(</span><span class="n">memory</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"wizer.initialize"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">145</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"wizer.resume"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">146</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"cabi_realloc"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">5062</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"wasi:cli/run@0.2.2#run"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">260</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"wasi:http/incoming-handler@0.2.2#handle"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">261</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"cabi_realloc_adapter"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">5061</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"check_init"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="mi">5068</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"wasi:http/incoming-handler@0.2.0#handle"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="cp">$wasi</span><span class="p">:</span><span class="nc">http</span><span class="o">/</span><span class="n">incoming</span><span class="o">-</span><span class="n">handler</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">#</span><span class="n">handle</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="n">export</span><span class="w"> </span><span class="s">"cabi_post_wasi:http/incoming-handler@0.2.0#handle"</span><span class="w"> </span><span class="p">(</span><span class="n">func</span><span class="w"> </span><span class="cp">$post_wasi</span><span class="p">:</span><span class="nc">http</span><span class="o">/</span><span class="n">incoming</span><span class="o">-</span><span class="n">handler</span><span class="o">@</span><span class="mf">0.2.0</span><span class="p">#</span><span class="n">handle</span><span class="p">))</span>
</code></pre></div>
<p>im guessing the conflicts is from this cabi_post_wasi? Im not sure what else would be in conflict.</p>



<a name="484635689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484635689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484635689">(Nov 27 2024 at 03:47)</a>:</h4>
<p>Are we componentizing with exactly the same code and getting different output? Did you add some code to what the PR had?</p>



<a name="484636043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484636043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484636043">(Nov 27 2024 at 03:51)</a>:</h4>
<p>I'm using what is on master, which again can see is the exact same</p>



<a name="484735945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484735945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484735945">(Nov 27 2024 at 14:37)</a>:</h4>
<p>again* -&gt; afaict</p>



<a name="484736250"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484736250" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484736250">(Nov 27 2024 at 14:38)</a>:</h4>
<p>I'll check again this morning, maybe I've changed a line accidentally in merge</p>



<a name="484743059"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743059" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743059">(Nov 27 2024 at 15:11)</a>:</h4>
<p>Oh you know what -- what version of node are you using? Could you post your Node and NPM versions?</p>



<a name="484743325"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743325" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743325">(Nov 27 2024 at 15:12)</a>:</h4>
<p>And also if you're running on windows or not -- it shouldn't matter too much but I'm just assuming macbook + some version of Node &amp; NPM</p>



<a name="484743334"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743334" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743334">(Nov 27 2024 at 15:12)</a>:</h4>
<p>23<br>
<a href="https://github.com/tylerhjones/wasm-lambda/blob/main/Dockerfile#L2">https://github.com/tylerhjones/wasm-lambda/blob/main/Dockerfile#L2</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/tylerhjones/wasm-lambda/blob/main/Dockerfile#L2" style="background-image: url(&quot;https://uploads.zulipusercontent.net/ccc426e6215b354c620e88df62bd37ace1d54046/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f376335393266643966343534623466663264323536373963383032643036353665376136326434313163303331653366613135366132353865303330633134382f74796c6572686a6f6e65732f7761736d2d6c616d626461&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/tylerhjones/wasm-lambda/blob/main/Dockerfile#L2" title="wasm-lambda/Dockerfile at main · tylerhjones/wasm-lambda">wasm-lambda/Dockerfile at main · tylerhjones/wasm-lambda</a></div><div class="message_embed_description">Contribute to tylerhjones/wasm-lambda development by creating an account on GitHub.</div></div></div>



<a name="484743476"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743476" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743476">(Nov 27 2024 at 15:13)</a>:</h4>
<p>That is your problem! Please try using stable node!</p>



<a name="484743541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743541">(Nov 27 2024 at 15:13)</a>:</h4>
<p><span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>oh</p>



<a name="484743548"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743548" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743548">(Nov 27 2024 at 15:13)</a>:</h4>
<p>I think I saw this during wasmcon/kubecon just last week -- please try Node 22 -- if you're using <code>nvm</code> then the <code>.nvmrc</code>in there</p>



<a name="484743755"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743755" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743755">(Nov 27 2024 at 15:14)</a>:</h4>
<p>I'll try with 22.<br>
I have nvm, but wanted to keep with docker so I can use the image as a build agent on Jenkins.</p>



<a name="484743758"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743758" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743758">(Nov 27 2024 at 15:14)</a>:</h4>
<p>Don't worry -- this is absolutely a new failure mode, I <em>think</em> this is what I saw just a week or two ago in person and me (and the person who ran into it) were VERY stumped. We were getting weird errors from <code>npm</code> itself about not detecting terminal colors right, and there were odd errors -- even versions of <code>node</code> are stable, so if you wouldn't mind trying that it <em>might just work</em></p>



<a name="484743805"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743805" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743805">(Nov 27 2024 at 15:14)</a>:</h4>
<p>Ah you can use docker as well, that's totally fine -- as long as you use Node 22 however you'd like!</p>



<a name="484743946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484743946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484743946">(Nov 27 2024 at 15:15)</a>:</h4>
<p>if it solves the issue we might have to do something upstream to try and prevent/control this -- we've had this discussion before and were expecting node to be pretty good about maintaining compat/stuff not breaking underneath us... But if it has, then we've just run into an exception case very quickly :)</p>



<a name="484744068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484744068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484744068">(Nov 27 2024 at 15:16)</a>:</h4>
<p>I'll swap it out and try in abt 20min, not by the computer right now.</p>



<a name="484764236"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484764236" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484764236">(Nov 27 2024 at 17:02)</a>:</h4>
<p>had some other delays, but I swapped to node 22 and it didn't fix it.<br>
i switched to <code>pnpm</code> instead of using <code>npm</code>, rm'd the node_modules and lock file and it worked.<br>
There is some dependency resolution difference from pnpm and npm, but im not seeing in from the pnpm-lock vs package-lock</p>



<a name="484764373"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484764373" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484764373">(Nov 27 2024 at 17:03)</a>:</h4>
<p>ill evaluate the two files in more detail later today and see which versions do not match</p>



<a name="484764829"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484764829" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484764829">(Nov 27 2024 at 17:06)</a>:</h4>
<p>ah,</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">      </span><span class="o">'@</span><span class="n">bytecodealliance</span><span class="o">/</span><span class="n">jco</span><span class="o">'</span><span class="p">:</span>
<span class="w">        </span><span class="nc">specifier</span><span class="p">:</span><span class="w"> </span><span class="o">^</span><span class="mf">1.7.0</span>
<span class="w">        </span><span class="n">version</span><span class="p">:</span><span class="w"> </span><span class="mf">1.8.1</span>
</code></pre></div>
<p>while npm picked</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="s">"node_modules/@bytecodealliance/jco"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s">"version"</span><span class="p">:</span><span class="w"> </span><span class="s">"1.7.2"</span><span class="p">,</span>
</code></pre></div>



<a name="484765546"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484765546" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484765546">(Nov 27 2024 at 17:10)</a>:</h4>
<p>so for this example, jco must be ^1.8</p>



<a name="484765723"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484765723" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484765723">(Nov 27 2024 at 17:11)</a>:</h4>
<p>Ah OK, so an old JCO version was the issue? thanks for debugging this!</p>



<a name="484766251"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/484766251" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tylr <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#484766251">(Nov 27 2024 at 17:14)</a>:</h4>
<p>thanks for the example and help.<br>
yes an older jco version is the issue. If I update the pkg json to specify ^1.8<br>
<code>"@bytecodealliance/jco": "^1.8.1",</code><br>
the example works with npm and node 22 (didnt rebuild image with 23, ill stay with 22 as its the 'active' version <a href="https://nodejs.org/en/about/previous-releases">https://nodejs.org/en/about/previous-releases</a>)</p>
<div class="message_embed"><a class="message_embed_image" href="https://nodejs.org/en/about/previous-releases" style="background-image: url(&quot;https://uploads.zulipusercontent.net/ae7c6e7ccee49fbeb73ebc4050341b98ce19a179/68747470733a2f2f6e6f64656a732e6f72672f656e2f6e6578742d646174612f6f672f616e6e6f756e63656d656e742f52756e2532304a61766153637269707425323045766572797768657265&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://nodejs.org/en/about/previous-releases" title="Node.js — Node.js Releases">Node.js — Node.js Releases</a></div><div class="message_embed_description">Node.js® is a JavaScript runtime built on Chrome's V8 JavaScript engine.</div></div></div>



<a name="490280389"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/490280389" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Wang <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#490280389">(Dec 21 2024 at 08:40)</a>:</h4>
<p>Hello! I'm having trouble using <code>fetch</code> in a wasm component that is invoked in the browser. Have any of y'all been able to do this successfully with the <a href="https://github.com/bytecodealliance/jco/blob/fe90d2ff0af2fc43d42002373e3edb9f892d7f53/packages/preview2-shim/lib/browser/http.js#L35-L45">brower wasi-preview2 shim</a>?</p>
<p>Roughly, here's what I have</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// world.wit</span>
<span class="n">package</span><span class="w"> </span><span class="n">jcofetch</span><span class="p">:</span><span class="nc">hello</span><span class="p">;</span>

<span class="n">world</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">ping</span><span class="p">:</span><span class="w"> </span><span class="nc">func</span><span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="w"> </span><span class="nc">string</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>And my component written in js which I componentize and transpile using <code>jco transpile --map 'wasi-*=@bytecodealliance/preview2-shim/*'</code>.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">ping</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="s">"https://jsonplaceholder.typicode.com/posts/1"</span><span class="p">);</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)).</span><span class="n">json</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="err">`</span><span class="n">hello</span><span class="p">:</span><span class="cp">$</span><span class="p">{</span><span class="n">s</span><span class="p">},</span><span class="w"> </span><span class="n">r</span><span class="p">:</span><span class="w"> </span><span class="cp">$</span><span class="p">{</span><span class="n">JSON</span><span class="p">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">r</span><span class="p">)}</span><span class="err">`</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>My entrypoint <code>index.js</code>:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ping</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">"../gen/hello/hello.component.js"</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ping</span><span class="p">(</span><span class="s2">"ping"</span><span class="p">));</span>
</code></pre></div>
<p>Which gets bundled using esbuild and embeded in my <code>index.html</code> with</p>
<div class="codehilite" data-code-language="HTML"><pre><span></span><code>  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"module"</span> <span class="na">src</span><span class="o">=</span><span class="s">"bundle.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>
<p>I get the following error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">bundle</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">992</span><span class="w"> </span><span class="n">Uncaught</span><span class="w"> </span><span class="n">TypeError</span><span class="p">:</span><span class="w"> </span><span class="nc">Fields</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">constructor</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">trampoline7</span><span class="w"> </span><span class="p">(</span><span class="n">bundle</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">992</span><span class="p">:</span><span class="mi">15</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x227f6</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x58cdd</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x4dca8</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x253c4c</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x24d4a7</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x24544f</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x253b12</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x25487d</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">component</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x2d4bef</span>
</code></pre></div>
<p>I wonder if there's something missing in the wasi preview2-shim for the browser... <a href="https://github.com/bytecodealliance/jco/blob/fe90d2ff0af2fc43d42002373e3edb9f892d7f53/packages/preview2-shim/lib/browser/http.js#L35-L45">https://github.com/bytecodealliance/jco/blob/fe90d2ff0af2fc43d42002373e3edb9f892d7f53/packages/preview2-shim/lib/browser/http.js#L35-L45</a></p>
<p>Any help (or pointers for how I can contribute upstream) would be really appreciated! <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/blob/fe90d2ff0af2fc43d42002373e3edb9f892d7f53/packages/preview2-shim/lib/browser/http.js#L35-L45" style="background-image: url(&quot;https://uploads.zulipusercontent.net/14b57f268bfd1f3d518146f94a35e10021faf29d/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333431303262636237643033626633396530343763626265653830316639643136386532313937343535613538613437333361323639346666333537636562382f62797465636f6465616c6c69616e63652f6a636f&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/blob/fe90d2ff0af2fc43d42002373e3edb9f892d7f53/packages/preview2-shim/lib/browser/http.js#L35-L45" title="jco/packages/preview2-shim/lib/browser/http.js at fe90d2ff0af2fc43d42002373e3edb9f892d7f53 · bytecodealliance/jco">jco/packages/preview2-shim/lib/browser/http.js at fe90d2ff0af2fc43d42002373e3edb9f892d7f53 · bytecodealliance/jco</a></div><div class="message_embed_description">JavaScript toolchain for working with WebAssembly Components - bytecodealliance/jco</div></div></div>



<a name="490280670"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Basic%20hello-wasi-http-js%20sample%20from%20ground%20up/near/490280670" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Wang <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Basic.20hello-wasi-http-js.20sample.20from.20ground.20up.html#490280670">(Dec 21 2024 at 08:45)</a>:</h4>
<p>FWIW I got a different pure "cowsay" component (no wasi imports) to run in the browser using this bundler setup, so I suspect it's an underlying issue in the shim</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>