<html>
<head><meta charset="utf-8"><title>✔ OCaml version needed for fuzzing · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html">✔ OCaml version needed for fuzzing</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="289747552"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/289747552" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#289747552">(Jul 15 2022 at 16:05)</a>:</h4>
<p>Hi.  I'm trying to get <code>cargo +nightly fuzz run api_calls</code> working in wasmtime and having trouble determining which OCaml version(s) are compatible with the spec interpreter.  <a href="https://github.com/conrad-watt/spec/tree/master/interpreter">The repo README.md</a> claims OCaml 4.07 or higher will work, but using 4.07 gives:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span>: <span class="nc">syntax</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">cmi</span><span class="w"></span>
<span class="w">       </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">OCaml</span><span class="p">.</span><span class="w"></span>
<span class="n">It</span><span class="w"> </span><span class="n">seems</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">OCaml</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<p>While using the latest (4.14) gives:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span>: <span class="nc">syntax</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">cmi</span><span class="w"></span>
<span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">OCaml</span><span class="p">.</span><span class="w"></span>
<span class="n">It</span><span class="w"> </span><span class="n">seems</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">newer</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">OCaml</span><span class="p">.</span><span class="w"></span>
</code></pre></div>
<p>(Aside: I sure wish it would tell me which version to use).  I've just started a binary search for the right version (4.10.1 is also too old, apparently), but if someone knows offhand, it would save me some time.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/conrad-watt/spec/tree/master/interpreter" style="background-image: url(https\:\/\/uploads\.zulipusercontent\.net\/a50e37d8fa5dc19dc8598b00635cbb60b5820c2f\/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323036386163626466643636306134633062383633316634653933383834346431306638303432373536666535343564326532633634356134343638383238332f636f6e7261642d776174742f73706563)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/conrad-watt/spec/tree/master/interpreter" title="spec/interpreter at master · conrad-watt/spec">spec/interpreter at master · conrad-watt/spec</a></div><div class="message_embed_description">WebAssembly specification, reference interpreter, and test suite. - spec/interpreter at master · conrad-watt/spec</div></div></div>



<a name="289749482"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/289749482" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#289749482">(Jul 15 2022 at 16:21)</a>:</h4>
<p>Conclusion: 4.13.1 works.  I guess I could regenerate the cmi files with 4.14, but I don't necessarily want to force others to upgrade, so I'll just use 4.13.1.</p>



<a name="289749489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/289749489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#289749489">(Jul 15 2022 at 16:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="509936">Joel Dice</span> has marked this topic as resolved.</p>



<a name="289749710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/289749710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#289749710">(Jul 15 2022 at 16:23)</a>:</h4>
<p>You can also build fuzzers with <code>--no-default-features</code> to disable building the ocaml-needing fuzzers</p>



<a name="289750008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/289750008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#289750008">(Jul 15 2022 at 16:25)</a>:</h4>
<p>Thanks, Alex.</p>
<p>BTW, I accidentally reversed the error messages when pasting them into my post above, but I can't edit it anymore -- just an FYI in case it's confusing.</p>



<a name="290140618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/290140618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Conrad Watt <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#290140618">(Jul 19 2022 at 18:24)</a>:</h4>
<p>I'm sorry for the confusion! I've now updated the readme of my fork with more helpful information regarding the OCaml build.</p>



<a name="290142338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/%E2%9C%94%20OCaml%20version%20needed%20for%20fuzzing/near/290142338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Conrad Watt <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/.E2.9C.94.20OCaml.20version.20needed.20for.20fuzzing.html#290142338">(Jul 19 2022 at 18:38)</a>:</h4>
<p>It's normal to need to regenerate cmi files locally when the OCaml version is switched, but 4.07 compilation will fail with the fuzzing version of the interpreter for other reasons, and might leave partially built things around that cause unhelpful error messages</p>
<p>I've updated the docs to clarify that OCaml 4.11.2 is the preferred version, although later ones should also work</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>