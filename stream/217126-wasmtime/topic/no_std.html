<html>
<head><meta charset="utf-8"><title>no_std · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html">no_std</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="203819217"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203819217" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203819217">(Jul 14 2020 at 10:44)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> question about <a href="https://github.com/bytecodealliance/wasm-tools/pull/41">wasm-tools/41</a>: would <a href="https://crates.io/crates/no-std-compat">no-std-compat</a> help with this, by any chance?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasm-tools/pull/41" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasm-tools/pull/41" title="wast/wat: Make the crates useable in no_std environments by athei · Pull Request #41 · bytecodealliance/wasm-tools">wast/wat: Make the crates useable in no_std environments by athei · Pull Request #41 · bytecodealliance/wasm-tools</a></div><div class="message_embed_description">This PR adds the default enabled feature std to the wast and wat crate. Disabling it makes the crate perform in a no_std mode.
Motivation
We need to compile wat -&gt; wasm in a no_std environment a...</div></div></div>



<a name="203819252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203819252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203819252">(Jul 14 2020 at 10:45)</a>:</h4>
<p>it might but it depends on the goal</p>



<a name="203819256"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203819256" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203819256">(Jul 14 2020 at 10:45)</a>:</h4>
<p>if we were to commit to no_std suport then something like that probably makes sense</p>



<a name="203819269"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203819269" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203819269">(Jul 14 2020 at 10:45)</a>:</h4>
<p>but I still feel somewhat strongly that we should not at all commit to no_std because I don't understand why we should</p>



<a name="203819814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203819814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203819814">(Jul 14 2020 at 10:54)</a>:</h4>
<p>one reason would be that there's increasing interest in Wasm in embedded environments. I think I understand the issues well enough to see why just no_std support doesn't really solve much, but if we could support it without bending over backwards in the implementation code of affected crates themselves, then it might be tenable?</p>



<a name="203819865"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203819865" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203819865">(Jul 14 2020 at 10:54)</a>:</h4>
<p>my, potentially wrong, understanding of no-std-compat is that it would allow us to do just that, no?</p>



<a name="203820735"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203820735" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203820735">(Jul 14 2020 at 11:07)</a>:</h4>
<p>yes I don't want to block anything arbitrarily, and I understand that embedded folks are interested in no_std, but I really really don't want to just blindly follow where everyone else wants us to go</p>



<a name="203820758"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203820758" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203820758">(Jul 14 2020 at 11:07)</a>:</h4>
<p>I think we're on the same page, but no one has yet to present me (in my opinion at least) a compelling reason to support no_std</p>



<a name="203820814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203820814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203820814">(Jul 14 2020 at 11:08)</a>:</h4>
<p>like no one has a target where wasm/wasmtime actually make sense on the target, <em>and</em> the target has a really good reason to not support std</p>



<a name="203820994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203820994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203820994">(Jul 14 2020 at 11:10)</a>:</h4>
<p>it's also worth pointing out that <code>no-std-compat</code> is a giant wad of code we would need to very carefully audit, and AFAIK no one's done that</p>



<a name="203821020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821020">(Jul 14 2020 at 11:10)</a>:</h4>
<p>naturally we're not just gonna blindly use it because it sounds nice, and right off the bat the usage of <code>spin</code> is inappropriate for us</p>



<a name="203821062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821062">(Jul 14 2020 at 11:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> <a href="#narrow/stream/217126-wasmtime/topic/no_std/near/203820814">said</a>:</p>
<blockquote>
<p>like no one has a target where wasm/wasmtime actually make sense on the target, <em>and</em> the target has a really good reason to not support std</p>
</blockquote>
<p>yeah, I agree that we should only support no_std if there really is a compelling argument for it. Not sure if Tomaka's use case for Redshirt qualifies, but at least <a href="https://twitter.com/tomaka17/status/1277708249249316865">they think it does</a>, AIUI</p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/tomaka17/status/1277708249249316865"><img class="twitter-avatar" src="https://pbs.twimg.com/profile_images/854056528898347009/S4Ek_Kmx_normal.jpg"></a><p>While `wasmi`, the Wasm interpreter, is very slow, I'd like to switch to `wasmtime` at some point. I have a branch with `wasmtime` working, but I can't merge it before I add support for running on bare metal.

(8/10)</p><span>- tomaka (@tomaka17)</span></div></div>



<a name="203821154"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821154" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821154">(Jul 14 2020 at 11:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> <a href="#narrow/stream/217126-wasmtime/topic/no_std/near/203820994">said</a>:</p>
<blockquote>
<p>it's also worth pointing out that <code>no-std-compat</code> is a giant wad of code we would need to very carefully audit, and AFAIK no one's done that</p>
</blockquote>
<p>good point!</p>



<a name="203821174"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821174" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821174">(Jul 14 2020 at 11:13)</a>:</h4>
<p>Of course yeah I don't want to rule anything out, but I don't want us to get into the mindset of "oh if we <code>#![no_std]</code> everything we run everywhere!"</p>



<a name="203821183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821183">(Jul 14 2020 at 11:13)</a>:</h4>
<p>that's a fallacy which will lead us to writing a bunch of spaghetti code</p>



<a name="203821196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821196">(Jul 14 2020 at 11:13)</a>:</h4>
<p>like does tomakas platform actually support <code>mmap</code>? and writable pages? (etc)</p>



<a name="203821292"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821292" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821292">(Jul 14 2020 at 11:14)</a>:</h4>
<p>makes sense, yes</p>



<a name="203821294"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821294" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821294">(Jul 14 2020 at 11:14)</a>:</h4>
<p>basically what I'm saying is that supporting every target under the sun requires more careful planning than "let's blindly <code>#![no_std]</code> everything and play whack-a-mole until everything compiles"</p>



<a name="203821315"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821315" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821315">(Jul 14 2020 at 11:15)</a>:</h4>
<p>we shouldn't do it just for doing it, but of course actually supporting these targets is fine</p>



<a name="203821328"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821328" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821328">(Jul 14 2020 at 11:15)</a>:</h4>
<p>AFAIK we just don't have a story to actually support any of these targets other than "we wish we could"</p>



<a name="203821343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821343">(Jul 14 2020 at 11:15)</a>:</h4>
<p>like if tomaka's platform only supports interpreters then that's probably a better thing to design first than slapping <code>#![no_std]</code> everywhere</p>



<a name="203821399"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821399" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821399">(Jul 14 2020 at 11:16)</a>:</h4>
<p>I also want to push back <em>really</em> hard on that <em>if</em> you have a <code>libc</code> (or some OS equivalent) then your platform really should support <code>std</code></p>



<a name="203821407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821407">(Jul 14 2020 at 11:16)</a>:</h4>
<p>and I'm more than happy to do any work upstream necessary to make that a reality</p>



<a name="203821411"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821411" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821411">(Jul 14 2020 at 11:16)</a>:</h4>
<p><code>std</code> is <code>core</code> + <code>libc</code>, and that's basically it</p>



<a name="203821424"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203821424" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203821424">(Jul 14 2020 at 11:16)</a>:</h4>
<p>and if your platform really truly only has <code>core</code> then you're like a microcontroller with 8k of rame</p>



<a name="203822457"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203822457" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203822457">(Jul 14 2020 at 11:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> <a href="#narrow/stream/217126-wasmtime/topic/no_std/near/203821424">said</a>:</p>
<blockquote>
<p>and if your platform really truly only has <code>core</code> then you're like a microcontroller with 8k of rame</p>
</blockquote>
<p>heh, fair</p>



<a name="203822594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203822594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203822594">(Jul 14 2020 at 11:33)</a>:</h4>
<p>to be clear, we definitely shouldn't do the work of creating this support, or even the story for supporting more esoteric platforms. What I do think would be good is to have documentation of our position on this that people can read to understand what they'd need to do to upstream changes supporting their platform</p>



<a name="203824083"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203824083" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203824083">(Jul 14 2020 at 11:54)</a>:</h4>
<p>for sure yeah, and if needed I'd be happy to write up at least my own personal point of view</p>



<a name="203829427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/no_std/near/203829427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/no_std.html#203829427">(Jul 14 2020 at 12:56)</a>:</h4>
<p>I think that'd be great! Perhaps as part of the book, with a direct link from the main README.md?</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>