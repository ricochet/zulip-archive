<html>
<head><meta charset="utf-8"><title>heads-up: API change for Module::new() · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/heads-up.3A.20API.20change.20for.20Module.3A.3Anew.28.29.html">heads-up: API change for Module::new()</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="198945035"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/heads-up%3A%20API%20change%20for%20Module%3A%3Anew%28%29/near/198945035" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/heads-up.3A.20API.20change.20for.20Module.3A.3Anew.28.29.html#198945035">(May 27 2020 at 20:01)</a>:</h4>
<p>So <a href="https://github.com/bytecodealliance/wasmtime/pull/1761">https://github.com/bytecodealliance/wasmtime/pull/1761</a> also proposes API change on what we store in <code>Module</code>. It drastically changes how <code>Module::new</code>and <code>Instance::new</code> works: now Instance needs directly hold <code>Store</code>and <code>Module</code> don't. On bright side, we can send <code>Module</code> across the threads \m/</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/1761" style="background-image: url(https://avatars0.githubusercontent.com/u/54038801?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/1761" title="Disconnects `Store` state fields from `Compiler` by yurydelendik · Pull Request #1761 · bytecodealliance/wasmtime">Disconnects `Store` state fields from `Compiler` by yurydelendik · Pull Request #1761 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">To make wasmtime more threads friendly, this PR:

Moves CodeMemory, VMInterrupts and SignatureRegistry from Compiler
CompiledModule holds CodeMemory and GdbJitImageRegistration
Store keeps track of...</div></div></div>



<a name="198945850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/heads-up%3A%20API%20change%20for%20Module%3A%3Anew%28%29/near/198945850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/heads-up.3A.20API.20change.20for.20Module.3A.3Anew.28.29.html#198945850">(May 27 2020 at 20:07)</a>:</h4>
<p>While here, can we remove the <code>module</code> field from <code>Instance</code>?</p>



<a name="198953875"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/heads-up%3A%20API%20change%20for%20Module%3A%3Anew%28%29/near/198953875" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/heads-up.3A.20API.20change.20for.20Module.3A.3Anew.28.29.html#198953875">(May 27 2020 at 21:10)</a>:</h4>
<p>We will be there after this PR, perhaps :)</p>



<a name="198954618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/heads-up%3A%20API%20change%20for%20Module%3A%3Anew%28%29/near/198954618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yury Delendik <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/heads-up.3A.20API.20change.20for.20Module.3A.3Anew.28.29.html#198954618">(May 27 2020 at 21:17)</a>:</h4>
<p><span class="user-mention" data-user-id="254083">@Dan Gohman</span> yeah, this change will not drive API change. I think removing <code>module</code> requires better <code>CodeMemory</code> ownership management than we have now.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>