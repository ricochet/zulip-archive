<html>
<head><meta charset="utf-8"><title>Compiling wasmtime on OpenBSD 7.5 · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Compiling.20wasmtime.20on.20OpenBSD.207.2E5.html">Compiling wasmtime on OpenBSD 7.5</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="447564814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Compiling%20wasmtime%20on%20OpenBSD%207.5/near/447564814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Rehwinkel <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Compiling.20wasmtime.20on.20OpenBSD.207.2E5.html#447564814">(Jun 27 2024 at 19:24)</a>:</h4>
<p>Tried to do a 'cargo install wasmtime-cli' on an OpenBSD 7.5 where I have cargo (cargo 1.76.0) and even cargo-component (cargo-component 0.13.2 (wasi:040ec92)) compiled. But as OpenBSD is not an OS that is compiled for very often, no surprise it didn't work. Any suggestions how I should proceed given this first error?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">wasmtime</span><span class="o">-</span><span class="n">wasi</span><span class="w"> </span><span class="n">v22</span><span class="p">.</span><span class="mf">0.0</span>
<span class="n">error</span><span class="p">[</span><span class="n">E0425</span><span class="p">]:</span><span class="w"> </span><span class="nc">cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="err">`</span><span class="n">set_tcp_keepidle</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">sockopt</span><span class="err">`</span>
<span class="w">    </span><span class="o">-</span><span class="p">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">frank</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">crates</span><span class="p">.</span><span class="n">io</span><span class="o">-</span><span class="mi">6</span><span class="n">f17d22bba15001f</span><span class="o">/</span><span class="n">wasmtime</span><span class="o">-</span><span class="n">wasi</span><span class="o">-</span><span class="mf">22.0.0</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="n">network</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">409</span><span class="p">:</span><span class="mi">18</span>
<span class="w">     </span><span class="o">|</span>
<span class="mi">409</span><span class="w">  </span><span class="o">|</span><span class="w">         </span><span class="n">sockopt</span><span class="p">::</span><span class="n">set_tcp_keepidle</span><span class="p">(</span>
<span class="w">     </span><span class="o">|</span><span class="w">                  </span><span class="o">^^^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">sockopt</span><span class="err">`</span>
<span class="w">     </span><span class="o">|</span>
<span class="n">note</span><span class="p">:</span><span class="w"> </span><span class="nc">found</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">out</span>
<span class="w">    </span><span class="o">-</span><span class="p">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">frank</span><span class="o">/</span><span class="p">.</span><span class="n">cargo</span><span class="o">/</span><span class="n">registry</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">crates</span><span class="p">.</span><span class="n">io</span><span class="o">-</span><span class="mi">6</span><span class="n">f17d22bba15001f</span><span class="o">/</span><span class="n">rustix</span><span class="o">-</span><span class="mf">0.38.34</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">net</span><span class="o">/</span><span class="n">sockopt</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1192</span><span class="p">:</span><span class="mi">8</span>
<span class="w">     </span><span class="o">|</span>
<span class="mi">1192</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">set_tcp_keepidle</span><span class="o">&lt;</span><span class="n">Fd</span><span class="p">:</span><span class="w"> </span><span class="nc">AsFd</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fd</span><span class="p">:</span><span class="w"> </span><span class="nc">Fd</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="nc">Duration</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">io</span><span class="p">::</span><span class="nb">Result</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="o">|</span><span class="w">        </span><span class="o">^^^^^^^^^^^^^^^^</span>
<span class="n">help</span><span class="p">:</span><span class="w"> </span><span class="nc">consider</span><span class="w"> </span><span class="n">importing</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">function</span>
<span class="w">     </span><span class="o">|</span>
<span class="mi">221</span><span class="w">  </span><span class="o">+</span><span class="w">     </span><span class="k">use</span><span class="w"> </span><span class="k">crate</span><span class="p">::</span><span class="n">host</span><span class="p">::</span><span class="n">network</span><span class="p">::</span><span class="n">util</span><span class="p">::</span><span class="n">set_tcp_keepidle</span><span class="p">;</span>
<span class="w">     </span><span class="o">|</span>
<span class="n">help</span><span class="p">:</span><span class="w"> </span><span class="nc">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="err">`</span><span class="n">set_tcp_keepidle</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">directly</span>
<span class="w">     </span><span class="o">|</span>
<span class="mi">409</span><span class="w">  </span><span class="o">-</span><span class="w">         </span><span class="n">sockopt</span><span class="p">::</span><span class="n">set_tcp_keepidle</span><span class="p">(</span>
<span class="mi">409</span><span class="w">  </span><span class="o">+</span><span class="w">         </span><span class="n">set_tcp_keepidle</span><span class="p">(</span>
<span class="w">     </span><span class="o">|</span>
</code></pre></div>



<a name="447565722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Compiling%20wasmtime%20on%20OpenBSD%207.5/near/447565722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Compiling.20wasmtime.20on.20OpenBSD.207.2E5.html#447565722">(Jun 27 2024 at 19:29)</a>:</h4>
<p>you'll probably want a <code>#[cfg]</code> on that line in wasmtime-wasi to return an error on OpenBSD</p>



<a name="447566001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Compiling%20wasmtime%20on%20OpenBSD%207.5/near/447566001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Compiling.20wasmtime.20on.20OpenBSD.207.2E5.html#447566001">(Jun 27 2024 at 19:31)</a>:</h4>
<p>and in general the path I took when I bulldozed through and got openbsd working at one point was to either add the relevant syscall support in the rustix/cap-std universe of crates, or conditionalize more as Alex says</p>



<a name="447566074"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Compiling%20wasmtime%20on%20OpenBSD%207.5/near/447566074" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Compiling.20wasmtime.20on.20OpenBSD.207.2E5.html#447566074">(Jun 27 2024 at 19:31)</a>:</h4>
<p>modern wasmtime has more in its default config, e.g. <code>wasmtime serve</code>, that might make this a bit harder; if needed you could build without those features as well</p>



<a name="447566329"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Compiling%20wasmtime%20on%20OpenBSD%207.5/near/447566329" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Rehwinkel <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Compiling.20wasmtime.20on.20OpenBSD.207.2E5.html#447566329">(Jun 27 2024 at 19:32)</a>:</h4>
<p>Good point. I should start with a minimal feature set and see if it can compile, and then add features to get a lay of the land.</p>



<hr><p>Last updated: Jan 20 2025 at 06:04 UTC</p>
</html>